/*! For license information please see kaltura-ovp-player.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.KalturaPlayer=t():e.KalturaPlayer=t()}(self,(()=>(()=>{var __webpack_modules__={693:(module,e,t)=>{var r,n,a,i;function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}module=t.nmd(module),self,i=function(e){return function(){var t={"./node_modules/@babel/runtime/helpers/arrayLikeToArray.js":function(module){module.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}},"./node_modules/@babel/runtime/helpers/arrayWithHoles.js":function(module){module.exports=function(e){if(Array.isArray(e))return e}},"./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/arrayLikeToArray.js");module.exports=function(e){if(Array.isArray(e))return r(e)}},"./node_modules/@babel/runtime/helpers/assertThisInitialized.js":function(module){module.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},"./node_modules/@babel/runtime/helpers/classCallCheck.js":function(module){module.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},"./node_modules/@babel/runtime/helpers/createClass.js":function(module){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}module.exports=function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}},"./node_modules/@babel/runtime/helpers/defineProperty.js":function(module){module.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},"./node_modules/@babel/runtime/helpers/extends.js":function(module){function e(){return module.exports=e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e.apply(this,arguments)}module.exports=e},"./node_modules/@babel/runtime/helpers/getPrototypeOf.js":function(module){function e(t){return module.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e(t)}module.exports=e},"./node_modules/@babel/runtime/helpers/inherits.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/setPrototypeOf.js");module.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},"./node_modules/@babel/runtime/helpers/iterableToArray.js":function(module){module.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},"./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js":function(module){module.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}}},"./node_modules/@babel/runtime/helpers/nonIterableRest.js":function(module){module.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},"./node_modules/@babel/runtime/helpers/nonIterableSpread.js":function(module){module.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},"./node_modules/@babel/runtime/helpers/objectWithoutProperties.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js");module.exports=function(e,t){if(null==e)return{};var n,a,i=r(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}},"./node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js":function(module){module.exports=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}},"./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/typeof.js"),n=t("./node_modules/@babel/runtime/helpers/assertThisInitialized.js");module.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?n(e):t}},"./node_modules/@babel/runtime/helpers/setPrototypeOf.js":function(module){function e(t,r){return module.exports=e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e(t,r)}module.exports=e},"./node_modules/@babel/runtime/helpers/slicedToArray.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/arrayWithHoles.js"),n=t("./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js"),a=t("./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js"),i=t("./node_modules/@babel/runtime/helpers/nonIterableRest.js");module.exports=function(e,t){return r(e)||n(e,t)||a(e,t)||i()}},"./node_modules/@babel/runtime/helpers/toConsumableArray.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js"),n=t("./node_modules/@babel/runtime/helpers/iterableToArray.js"),a=t("./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js"),i=t("./node_modules/@babel/runtime/helpers/nonIterableSpread.js");module.exports=function(e){return r(e)||n(e)||a(e)||i()}},"./node_modules/@babel/runtime/helpers/typeof.js":function(module){function e(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?module.exports=e=function(e){return typeof e}:module.exports=e=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}module.exports=e},"./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/arrayLikeToArray.js");module.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},"./src/components/active-preset/active-preset.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ActivePreset:function(){return S}});var n,a,i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./node_modules/react-redux/es/index.js"),_=r("./src/utils/index.ts"),k=r("./src/reducers/shell.ts"),E=r("./src/utils/logger.ts");function b(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?T(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var S=(0,r("./src/components/event-dispatcher/index.ts").withEventDispatcher)("ActivePreset")(n=(0,v.connect)((function(e){return{state:{shell:e.shell,engine:{adBreak:e.engine.adBreak,isLive:e.engine.isLive,hasError:e.engine.hasError,isIdle:e.engine.isIdle,isVr:e.engine.isVr,isImg:e.engine.isImg,isDocument:e.engine.isDocument,playlist:e.engine.playlist}},config:e.config}}),(0,_.bindActions)(k.actions))((a=function(e){c()(r,e);var t=A(r);function r(){var e;return o()(this,r),e=t.call(this),r.logger=(0,E.default)("ActivePreset"),e}return l()(r,[{key:"getMatchedUI",value:function(e,t){var r,n,a=b(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(void 0===i.condition||i.condition(t)){r=i;break}}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"render",value:function(e){var t,n=this.props,a=n.uis,i=n.state.shell.activePresetName;if(a.length>0){var o=(t=this.getMatchedUI(a,e.state))?t.template(e):a[a.length-1].template(e),s=o&&o.type.displayName||"";return i!==s&&(e.notifyChange({from:i,to:s}),e.updateActivePresetName(s),e.updatePresetSettings(null),r.logger.debug("update active preset to '".concat(i,"' and reset preset settings"))),o}}}]),r}(y.Component),g()(a,"logger",void 0),n=a))||n)||n},"./src/components/active-preset/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ActivePreset:function(){return n.ActivePreset}});var n=r("./src/components/active-preset/active-preset.tsx")},"./src/components/ad-learn-more/ad-learn-more.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdLearnMore:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/react-redux/es/index.js"),v=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k=(0,y.connect)((function(e){return{url:e.engine.adUrl}}))(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"render",value:function(e){return(0,g.h)("a",{href:e.url,target:"_blank",rel:"noreferrer",className:[m().btn,m().btnDarkTransparent,m().learnMore].join(" ")},(0,g.h)(v.Text,{id:"ads.learn_more"}))}}]),r}(g.Component))||n;k.displayName="AdLearnMore"},"./src/components/ad-learn-more/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdLearnMore:function(){return n.AdLearnMore}});var n=r("./src/components/ad-learn-more/ad-learn-more.tsx")},"./src/components/ad-left-controls/ad-left-controls.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdLeftControls:function(){return v}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/preact/dist/preact.module.js"),m=r("./node_modules/react-redux/es/index.js"),g=r("./src/components/ad-notice/index.tsx");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var v=(0,m.connect)((function(e){return{isBumper:e.engine.adIsBumper}}))(n=function(e){u()(r,e);var t=y(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"render",value:function(){return this.props.isBumper?null:(0,f.h)(g.AdNotice,null)}}]),r}(f.Component))||n;v.displayName="AdLeftControls"},"./src/components/ad-left-controls/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdLeftControls:function(){return n.AdLeftControls}});var n=r("./src/components/ad-left-controls/ad-left-controls.tsx")},"./src/components/ad-notice/ad-notice.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdNotice:function(){return v}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./src/styles/style.scss"),f=r.n(h),m=r("./node_modules/preact/dist/preact.module.js"),g=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var v=function(e){l()(r,e);var t=y(r);function r(){return a()(this,r),t.apply(this,arguments)}return o()(r,[{key:"render",value:function(){return(0,m.h)("span",{className:f().adNotice},(0,m.h)(g.Text,{id:"ads.ad_notice"}))}}]),r}(m.Component);v.displayName="AdNotice"},"./src/components/ad-notice/index.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdNotice:function(){return n.AdNotice}});var n=r("./src/components/ad-notice/ad-notice.tsx")},"./src/components/ad-skip/ad-skip.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdSkip:function(){return w}});var n,a,i,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/react-redux/es/index.js"),A=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),S=r("./src/components/player/index.ts"),C=r("./src/components/logger/index.ts");function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var x="AdSkip",w=(n=(0,T.connect)((function(e){return{currentTime:e.engine.adProgress.currentTime,duration:e.engine.adProgress.duration,adSkipTimeOffset:e.engine.adSkipTimeOffset,adSkippableState:e.engine.adSkippableState}})),a=(0,C.withLogger)(x),n(i=(0,S.withPlayer)(i=a(i=function(e){h()(r,e);var t=P(r);function r(){var e;s()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(d()(e),"skipAd",(function(){var t;null===(t=e.props.player.ads)||void 0===t||t.skipAd()})),e}return u()(r,[{key:"getSkipTimeOffset",value:function(){return Math.ceil(this.props.adSkipTimeOffset-this.props.currentTime)}},{key:"render",value:function(){return this.props.adSkippableState?this.getSkipTimeOffset()<=0?(0,b.h)(A.Localizer,null,(0,b.h)("a",{className:[E().btn,E().btnBranded,E().btnSkipAd].join(" "),onClick:this.skipAd},(0,b.h)(A.Text,{id:"ads.skip_ad"}))):(0,b.h)(A.Localizer,null,(0,b.h)("span",{className:E().skipAd},(0,b.h)(A.Text,{id:"ads.skip_in"})," "+this.getSkipTimeOffset())):void 0}}]),r}(b.Component))||i)||i)||i);w.displayName=x},"./src/components/ad-skip/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdSkip:function(){return n.AdSkip}});var n=r("./src/components/ad-skip/ad-skip.tsx")},"./src/components/advanced-audio-desc-toggle/advanced-audio-desc-toggle.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdvancedAudioDescToggle:function(){return x}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),k=r("./node_modules/react-redux/es/index.js"),E=r("./src/utils/index.ts"),b=r("./src/reducers/settings.ts"),T=r("./src/components/index.ts"),A=r("./src/components/icon/index.ts"),S=r("./src/components/event-dispatcher/index.ts");function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var P="AdvancedAudioDescToggle",x=(0,k.connect)((function(e){return{isAdvancedAudioDescChecked:e.settings.advancedAudioDesc}}),(0,E.bindActions)(b.actions))(n=(0,S.withEventDispatcher)(P)(n=(0,_.withText)({advancedAudioText:"settings.advancedAudioDescription"})(n=function(e){d()(r,e);var t=C(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"onAdvancedAudioClick",(function(t){e.props.updateAdvancedAudioDesc(t),e.props.notifyClick({type:"AdvancedAudioDescription",checked:t})})),e}return s()(r,[{key:"render",value:function(e){return(0,v.h)(T.SmartContainerItem,{pushRef:function(t){e.pushRef(t)},icon:A.IconType.AdvancedAudioDescription,label:e.advancedAudioText,isChecked:e.isAdvancedAudioDescChecked,onMenuChosen:this.onAdvancedAudioClick})}}]),r}(v.Component))||n)||n)||n;x.displayName=P},"./src/components/advanced-audio-desc-toggle/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdvancedAudioDescToggle:function(){return n.AdvancedAudioDescToggle}});var n=r("./src/components/advanced-audio-desc-toggle/advanced-audio-desc-toggle.tsx")},"./src/components/advanced-audio-desc/advanced-audio-desc.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AdvancedAudioDesc:function(){return F}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),S=r("./src/components/icon/index.ts"),C=r("./src/components/event-dispatcher/index.ts"),P=r("./src/components/tooltip/index.ts"),x=r("./src/components/button/index.ts"),w=r("./node_modules/react-redux/es/index.js"),I=r("./src/components/button-control/index.ts"),M=r("./src/utils/index.ts"),R=r("./src/reducers/settings.ts"),D=r("./src/components/bottom-bar/index.ts"),O=r("./src/index.ts"),L=r("./src/components/player/index.ts");function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var B="AdvancedAudioDesc",F=(n=(0,w.connect)((function(e){return{showAdvancedAudioDescToggle:e.config.settings.showAdvancedAudioDescToggle}}),(0,M.bindActions)(R.actions)),a=(0,C.withEventDispatcher)(B),i=(0,A.withText)({AdvancedAudioDescText:"settings.advancedAudioDescription"}),n(o=(0,L.withPlayer)(o=a(o=i(o=function(e){f()(r,e);var t=j(r);function r(e){var n;return l()(this,r),n=t.call(this),k()(p()(n),"getComponentText",(function(){return n.props.AdvancedAudioDescText})),k()(p()(n),"getSvgIcon",(function(){return{type:O.redux.useStore().getState().settings.advancedAudioDesc?S.IconType.AdvancedAudioDescriptionActive:S.IconType.AdvancedAudioDescription}})),k()(p()(n),"onClick",(function(){n.setState((function(e){return n.props.updateAdvancedAudioDesc(!e.toggle),n.props.notifyClick({type:"AdvancedAudioDescription",checked:!e.toggle}),{toggle:!e.toggle}}))})),n.state={toggle:!1},(0,D.registerToBottomBar)(B,e.player,(function(){return n.registerComponent()})),n}return c()(r,[{key:"registerComponent",value:function(){var e=this;return{ariaLabel:function(){return e.getComponentText()},displayName:B,order:5,svgIcon:function(){return e.getSvgIcon()},onClick:function(){return e.onClick()},component:function(){return V(U(U({},e.props),{},{classNames:[b().upperBarIcon]}))},shouldHandleOnClick:!1}}},{key:"_shouldRender",value:function(){return this.props.showAdvancedAudioDescToggle}},{key:"render",value:function(e){var t=e.AdvancedAudioDescText,r=e.innerRef;return this._shouldRender()?(0,T.h)(I.ButtonControl,{name:B,className:[b().noIdleControl,this.props.classNames?this.props.classNames.join(" "):""].join(" ")},(0,T.h)(P.Tooltip,{label:t},(0,T.h)(x.Button,{tabIndex:"0","aria-label":t,className:"".concat(b().controlButton),ref:r,onClick:this.onClick},(0,T.h)(S.Icon,{type:this.state.toggle?S.IconType.AdvancedAudioDescriptionActive:S.IconType.AdvancedAudioDescription})))):void 0}}]),r}(T.Component))||o)||o)||o)||o),V=function(e){return(0,T.h)(F,e)};F.displayName=B},"./src/components/advanced-audio-desc/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdvancedAudioDesc:function(){return n.AdvancedAudioDesc}});var n=r("./src/components/advanced-audio-desc/advanced-audio-desc.tsx")},"./src/components/audio-entry-details/audio-entry-details.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AudioEntryDetails:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./src/styles/style.scss"),o=r.n(i),s=r("./node_modules/react-redux/es/index.js"),l=r("./node_modules/preact/dist/preact.module.js"),u=r("./node_modules/preact/hooks/dist/hooks.module.js"),c=r("./src/components/shell/shell.tsx"),d=r("./src/components/player/index.ts"),p=r("./src/components/expandable-text/index.ts"),h=r("./src/components/scrollable/index.ts"),f=r("./src/event/index.ts"),m=(0,s.connect)((function(e){return{isAudio:e.engine.isAudio,playerSize:e.shell.playerSize}}))((0,f.withEventManager)((0,d.withPlayer)((function(e){var t,r,n,i=function(e){return g.parseFromString(e,"text/html").body.textContent||""},s=(0,u.useRef)(null),d=(0,u.useRef)(null),f=(0,u.useState)(null),m=a()(f,2),g=m[0],y=m[1],v=(0,u.useState)(!1),_=a()(v,2),k=_[0],E=_[1],b=(0,u.useState)(!1),T=a()(b,2),A=T[0],S=T[1],C=(0,u.useState)(!1),P=a()(C,2),x=P[0],w=P[1],I=(0,u.useState)(!1),M=a()(I,2),R=M[0],D=M[1];if((0,u.useLayoutEffect)((function(){var e,t,r,n;(null==s?void 0:s.current)&&(null==d?void 0:d.current)&&(S(!0),w((null==s||null===(e=s.current)||void 0===e?void 0:e.getBoundingClientRect().height)>(null==d||null===(t=d.current)||void 0===t?void 0:t.getBoundingClientRect().height))),R||D((null==s||null===(r=s.current)||void 0===r?void 0:r.getBoundingClientRect().height)>(null==d||null===(n=d.current)||void 0===n?void 0:n.getBoundingClientRect().height))})),(0,u.useLayoutEffect)((function(){e.eventManager.listen(e.player,e.player.Event.CHANGE_SOURCE_STARTED,(function(){E(!1)})),e.eventManager.listen(e.player,e.player.Event.CHANGE_SOURCE_ENDED,(function(){E(!0)})),y(new DOMParser)}),[]),!k||!e.isAudio||!(null===(t=e.player.sources)||void 0===t||null===(r=t.metadata)||void 0===r?void 0:r.name)&&!(null===(n=e.player.sources)||void 0===n?void 0:n.metadata.description))return null;var O=e.player.sources.metadata,L=O.name,N=void 0===L?"":L,U=O.description,j=void 0===U?"":U;N=i(N),j=i(j);var B=function(e){switch(e){case c.PLAYER_SIZE.EXTRA_LARGE:case c.PLAYER_SIZE.LARGE:return o().audioEntryL;case c.PLAYER_SIZE.MEDIUM:return o().audioEntryM;default:return o().audioEntryT}}(e.playerSize),F="".concat(o().audioEntryTitle," ").concat(x?o().audioEntryTitleTrimmed:""),V=x?"":o().audioEntryExpanded;return(0,l.h)("div",{className:"".concat(o().audioEntryBackdrop," ").concat(V)},(0,l.h)("div",{className:"".concat(o().audioEntryDetails," ").concat(B)},(0,l.h)(h.Scrollable,{isVertical:!0},(0,l.h)("div",{className:o().audioEntryContent},(0,l.h)("div",{ref:s,className:F},N),A?void 0:(0,l.h)("div",{ref:d,className:"".concat(o().audioEntryTitle," ").concat(o().audioEntryTitleTrimmed)},N),(0,l.h)("div",{className:o().audioEntryDescription},(0,l.h)(p.ExpandableText,{text:j,lines:3,onClick:function(){w(!x)},forceShowMore:R},j))))))}))));m.displayName="AudioEntryDetails"},"./src/components/audio-entry-details/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AudioEntryDetails:function(){return n.AudioEntryDetails}});var n=r("./src/components/audio-entry-details/audio-entry-details.tsx")},"./src/components/audio-menu/audio-menu.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{AudioMenu:function(){return x}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./src/utils/index.ts"),E=r("./src/reducers/settings.ts"),b=r("./src/components/index.ts"),T=r("./src/components/icon/index.ts"),A=r("./src/components/player/index.ts"),S=r("./src/components/event-dispatcher/index.ts");function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var P="AudioMenu",x=(n=(0,_.connect)((function(e){return{audioTracks:e.engine.audioTracks}}),(0,k.bindActions)(E.actions)),a=(0,S.withEventDispatcher)(P),i=(0,v.withText)({audioLabelText:"settings.audio"}),n(o=(0,A.withPlayer)(o=a(o=i(o=function(e){p()(r,e);var t=C(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"onAudioChange",value:function(e){this.props.updateAudio(e),this.props.player.selectTrack(e),this.props.notifyClick({type:this.props.player.Track.AUDIO,track:e})}},{key:"render",value:function(e){var t=this,r=e.audioTracks.filter((function(e){return e.label||e.language})).map((function(e){return{label:e.label||e.language,active:e.active,value:e}}));return(0,y.h)(b.SmartContainerItem,{pushRef:function(t){e.pushRef(t)},icon:T.IconType.Audio,label:this.props.audioLabelText,options:r,onMenuChosen:function(e){return t.onAudioChange(e)}})}}]),r}(y.Component))||o)||o)||o)||o);x.displayName=P},"./src/components/audio-menu/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AudioMenu:function(){return n.AudioMenu}});var n=r("./src/components/audio-menu/audio-menu.tsx")},"./src/components/base.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{BaseComponent:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./src/utils/logger.ts"),_=r("./src/middlewares/event-dispatcher.ts"),k=r("@playkit-js/playkit-js");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var b=function(e){c()(r,e);var t=E(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{config:{}};return a()(this,r),e=t.call(this),g()(l()(e),"player",void 0),g()(l()(e),"name",void 0),g()(l()(e),"config",void 0),g()(l()(e),"logger",void 0),g()(l()(e),"eventManager",void 0),e.name=n.name,e.config=n.config,e.player=n.player,e.eventManager=new k.EventManager,e.logger=(0,v.default)("UI ".concat(e.name)),e.logger.debug("Initialized"),e}return o()(r,[{key:"notifyClick",value:function(e){this.context.store.dispatch({type:_.types.COMPONENT_CLICKED,name:this.name,payload:e})}},{key:"notifyChange",value:function(e){this.context.store.dispatch({type:_.types.COMPONENT_CHANGED,name:this.name,payload:e})}},{key:"componentWillUnmount",value:function(){this.eventManager.removeAll()}},{key:"render",value:function(e,t,r){}}]),r}(y.Component);g()(b,"defaultProps",{}),t.default=b},"./src/components/bottom-bar/bettom-bar-utils.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{calculateControlsSize:function(){return u},filterControlsByPriority:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),a=r.n(n),i=r("./src/components/index.ts");function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l={TimeDisplayPlaybackContainer:107};function u(e,t,r,n){var a,s=0,u=0,c=o(e);try{for(c.s();!(a=c.n()).done;){var d=a.value;d in l?u=l[d]:d===i.PlaybackControls.displayName?r>i.PLAYER_BREAK_POINTS.SMALL&&(u=n?3*t:t):u=t,s+=u}}catch(e){c.e(e)}finally{c.f()}return s}function c(e,t,r,n){var i=Math.ceil((e-t)/r),o=n.flat().slice(0,i),s=a()(n).reverse().find((function(e){return e.length>1}));return o[o.length-1]===(null==s?void 0:s[0])&&o.push(s[1]),o}},"./src/components/bottom-bar/bottom-bar-registry-manager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{BottomBarRegistryManager:function(){return u},bottomBarRegistryManager:function(){return c},registerToBottomBar:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),l=r.n(s),u=function(){function e(){a()(this,e),l()(this,"_registry",void 0),this._registry=new Map}return o()(e,[{key:"register",value:function(e,t){this.getComponentItem(e)||this._registry.set(e,t)}},{key:"unregister",value:function(e){this.getComponentItem(e)&&this._registry.delete(e)}},{key:"getComponentItem",value:function(e){return this._registry.get(e)}},{key:"clear",value:function(){this._registry.clear()}}]),e}(),c="bottomBarRegistryManager",d=function(e,t,r){var n=(null==t?void 0:t.getService(c))||void 0;n&&!n.getComponentItem(e)&&n.register(e,r())}},"./src/components/bottom-bar/bottom-bar.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{BottomBar:function(){return U}});var n,a,i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./src/styles/style.scss"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./src/utils/bind-actions.ts"),T=r("./src/reducers/shell.ts"),A=r("./src/reducers/bottom-bar.ts"),S=r("./node_modules/react-redux/es/index.js"),C=r("./src/components/player-area/index.ts"),P=r("./src/components/index.ts"),x=r("./src/event/index.ts"),w=r("./src/components/player/index.ts"),I=r("./src/components/bottom-bar/bettom-bar-utils.ts"),M=r("./src/components/bottom-bar/bottom-bar-registry-manager.ts");function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){v()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var L=[["PictureInPicture"],["VrStereo"],["TimeDisplayPlaybackContainer"],["AdvancedAudioDesc"],["ClosedCaptions"],["CaptionsControl"],["Cast"]],N="TimeDisplayPlaybackContainer",U=(n=(0,S.connect)((function(e){return{isCasting:e.engine.isCasting,isPlaybackEnded:e.engine.isPlaybackEnded,guiClientRect:e.shell.guiClientRect,playerSize:e.shell.playerSize,playlist:e.engine.playlist}}),(0,b.bindActions)(O(O({},T.actions),A.actions))),(0,w.withPlayer)(a=(0,x.withEventManager)(a=n(a=function(e){p()(r,e);var t=R(r);function r(e){var n;return o()(this,r),n=t.call(this),v()(c()(n),"bottomBarContainerRef",(0,E.createRef)()),v()(c()(n),"presetControls",{}),v()(c()(n),"currentBarWidth",0),v()(c()(n),"resizeObserver",void 0),v()(c()(n),"onToggleControl",(function(e,t){e in n.state.activeControls&&n.state.activeControls[e]!==t&&n.setState((function(r){return{activeControls:O(O({},r.activeControls),v()({},e,t))}}))})),e.leftControls=e.leftControls||[],e.rightControls=e.rightControls||[],e.leftControls.concat(e.rightControls).map((function(e){return e.displayName})).forEach((function(e){return n.presetControls[e]=!0})),n.state={fitInControls:n.presetControls,activeControls:n.presetControls},e.player.registerService(M.bottomBarRegistryManager,new M.BottomBarRegistryManager),n}return l()(r,[{key:"componentDidMount",value:function(){var e=this;this.resizeObserver=new ResizeObserver((function(t){return e.onBarWidthChange(t)})),this.resizeObserver.observe(this.bottomBarContainerRef.current)}},{key:"componentWillUnmount",value:function(){this.resizeObserver.disconnect()}},{key:"onBarWidthChange",value:function(e){var t=this,r=e[0].contentRect.width;if(r!==this.currentBarWidth){var n=Object.keys(this.state.activeControls).filter((function(e){return t.state.activeControls[e]})),a=this.props.guiClientRect.width<=P.PLAYER_BREAK_POINTS.SMALL?38:44,i=(0,I.calculateControlsSize)(n,a,this.props.guiClientRect.width,this.props.playlist),o=L.filter((function(e){return t.state.activeControls[e[0]]}));this.currentBarWidth=r,this.filterControls(r,i,a,o)}}},{key:"filterControls",value:function(e,t,r,n){if(t>=e){var a=(0,I.filterControlsByPriority)(t,e,r,n),i={};a.forEach((function(e){return i[e]=!1})),this.props.updateControlsToMove(a),this.setState({fitInControls:O(O({},this.presetControls),i)})}else this.setState({fitInControls:O({},this.presetControls)}),this.props.updateControlsToMove([])}},{key:"render",value:function(e){var t=this,r=[k().bottomBar];e.isCasting&&e.isPlaybackEnded&&r.push(k().hide);var n=this.presetControls[N]&&!this.state.fitInControls[N];return(0,E.h)("div",{className:r.join(" ")},(0,E.h)("div",{className:k().bottomBarArea},(0,E.h)(C.PlayerArea,{shouldUpdate:!0,name:"BottomBar"},n&&(0,E.h)(P.TimeDisplayPlaybackContainer,null),e.children)),(0,E.h)("div",{ref:this.bottomBarContainerRef,className:k().controlsContainer},(0,E.h)("div",{className:k().leftControls},(0,E.h)(C.PlayerArea,{shouldUpdate:!0,name:"BottomBarLeftControls"},e.leftControls&&e.leftControls.map((function(e){return t.presetControls[e.displayName]&&t.state.fitInControls[e.displayName]&&(0,E.h)(e,{key:e.displayName,onToggle:t.onToggleControl})})))),(0,E.h)("div",{className:k().rightControls},(0,E.h)(C.PlayerArea,{shouldUpdate:!0,name:"BottomBarRightControls"},e.rightControls&&e.rightControls.map((function(e){return t.presetControls[e.displayName]&&t.state.fitInControls[e.displayName]&&(0,E.h)(e,{key:e.displayName,onToggle:t.onToggleControl})}))))))}}]),r}(E.Component))||a)||a)||a);U.displayName="BottomBar"},"./src/components/bottom-bar/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{BottomBar:function(){return n.BottomBar},BottomBarRegistryManager:function(){return a.BottomBarRegistryManager},bottomBarRegistryManager:function(){return a.bottomBarRegistryManager},registerToBottomBar:function(){return a.registerToBottomBar}});var n=r("./src/components/bottom-bar/bottom-bar.tsx"),a=r("./src/components/bottom-bar/bottom-bar-registry-manager.ts")},"./src/components/button-control/button-control.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ButtonControl:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),o=r.n(i),s=r("./node_modules/preact/dist/preact.module.js"),l=r("./src/styles/style.scss"),u=r.n(l),c=(0,r("./node_modules/preact/compat/dist/compat.module.js").forwardRef)((function(e,t){var r=e.className,n=e.children,i=e.name,l=o()(e,["className","children","name"]),c=[u().controlButtonContainer,"".concat("playkit","-control-").concat(d(i))];if(r){var p=Array.isArray(r)?r:[r];c=c.concat(p)}return(0,s.h)("div",a()({className:c.join(" "),ref:t},l),n)})),d=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase()}},"./src/components/button-control/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ButtonControl:function(){return n.ButtonControl}});var n=r("./src/components/button-control/button-control.tsx")},"./src/components/button/button.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Button:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/preact/dist/preact.module.js"),o=(0,r("./node_modules/preact/compat/dist/compat.module.js").forwardRef)((function(e,t){return(0,i.h)("button",a()({type:"button",ref:t},e))}));o.displayName="Button"},"./src/components/button/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Button:function(){return n.Button}});var n=r("./src/components/button/button.tsx")},"./src/components/captions-control/captions-control-mini.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionsControlMini:function(){return E}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./node_modules/preact/compat/dist/compat.module.js"),o=r("./src/components/bottom-bar/index.ts"),s=r("./src/index.ts"),l=r("./src/components/icon/index.ts"),u=r("./node_modules/preact/dist/preact.module.js"),c=r("./src/components/button-control/index.ts"),d=r("./src/components/tooltip/index.ts"),p=r("./src/components/button/index.ts"),h=r("./src/components/cvaa-overlay/index.ts"),f=r("./node_modules/preact/hooks/dist/hooks.module.js"),m=r("./node_modules/react-redux/es/index.js"),g=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),y=r("./src/components/captions-menu/index.ts"),v=r("./src/components/smart-container/index.ts"),_=r("./src/components/captions-control/captions-control.tsx"),k="CaptionsControlMini",E=(0,m.connect)((function(e){return{controlsToMove:e.bottomBar.controlsToMove}}))((function(e,t){var r=(0,f.useState)(!1),n=a()(r,2),m=n[0],E=n[1],T=t.player,A=e.controlsToMove,S=document.getElementById(T.config.targetId)||document,C=null;(0,f.useEffect)((function(){(0,o.registerToBottomBar)(_.CaptionsControl.displayName,T,(function(){return P()}))}),[]);var P=function(){return{ariaLabel:e.captionsLabelText,displayName:k,order:5,svgIcon:{type:l.IconType.ClosedCaptionsOn},onClick:function(){return I()},component:function(){return b(e)},shouldHandleOnClick:!1}};(0,f.useEffect)((function(){E(A.includes(_.CaptionsControl.displayName))}),[A]);var x=function(){C&&(C(),C=null)},w=function(){x(),C=T.ui.addComponent({label:"cvaa-overlay",area:"GuiArea",presets:[s.ReservedPresetNames.Playback,s.ReservedPresetNames.Live],get:function(){return(0,i.createPortal)((0,u.h)(h.CVAAOverlay,{onClose:function(){return x()}}),S.querySelector(".overlay-portal"))}})},I=function(){C=T.ui.addComponent({label:"captions-overlay",area:"GuiArea",presets:[s.ReservedPresetNames.Playback,s.ReservedPresetNames.Live],get:function(){return(0,u.h)(v.SmartContainer,{targetId:T.config.targetId,onClose:function(){return x()},title:(0,u.h)(g.Text,{id:"controls.language"})},(0,u.h)(y.CaptionsMenu,{asDropdown:!1,onAdvancedCaptionsClick:w}))}})};return m?(0,u.h)(c.ButtonControl,{name:k,className:s.style.upperBarIcon},(0,u.h)(d.Tooltip,{label:e.captionsLabelText},(0,u.h)(p.Button,{tabIndex:"0","aria-label":e.captionsLabelText,"aria-haspopup":"true",className:s.style.controlButton,onClick:I},(0,u.h)(l.Icon,{type:s.redux.useStore().getState().settings.isCaptionsEnabled?l.IconType.ClosedCaptionsOn:l.IconType.ClosedCaptionsOff})))):void 0})),b=function(e){return(0,u.h)(E,e)};E.displayName=k},"./src/components/captions-control/captions-control.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionsControl:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./node_modules/preact/dist/preact.module.js"),o=r("./node_modules/react-redux/es/index.js"),s=r("./src/components/captions-menu/index.ts"),l=r("./src/components/button-control/index.ts"),u=r("./src/components/tooltip/index.ts"),c=r("./src/components/button/index.ts"),d=r("./src/styles/style.scss"),p=r.n(d),h=r("./src/components/icon/index.ts"),f=r("./src/components/smart-container/index.ts"),m=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),g=r("./node_modules/preact/hooks/dist/hooks.module.js"),y=r("./src/utils/index.ts"),v=r("./node_modules/preact/compat/dist/compat.module.js"),_=r("./src/components/cvaa-overlay/index.ts"),k=r("./src/components/captions-control/captions-control-mini.tsx"),E="CaptionsControl",b=(0,o.connect)((function(e){return{textTracks:e.engine.textTracks,showCCButton:e.config.showCCButton,openMenuFromCCButton:e.config.openMenuFromCCButton,isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize,isCVAAOverlayOpen:e.shell.isCVAAOverlayOpen}}))((0,m.withText)({captionsLabelText:"captions.captions"})((function(e,t){var r=(0,g.useState)(!1),n=a()(r,2),o=n[0],d=n[1],b=(0,g.useState)(!1),T=a()(b,2),A=T[0],S=T[1],C=(0,g.useState)(!1),P=a()(C,2),x=P[0],w=P[1],I=(0,g.useRef)(null),M=(0,g.useRef)(null),R=t.player,D=e.isSmallSize,O=e.isMobile,L=e.textTracks,N=L.find((function(e){return e.active})),U=function(e,t){d((function(e){return!e})),t&&o&&(0,y.focusElement)(I.current)},j=function(){S((function(e){return!e}))},B=function(e){O||D||!M.current||M.current.contains(e.target)||d(!1)};(0,g.useEffect)((function(){return document.addEventListener("click",B),function(){return document.removeEventListener("click",B)}}),[D,O]),(0,g.useEffect)((function(){w("off"!==(null==N?void 0:N.language))}),[N]);var F=!!(null==L?void 0:L.length)&&e.showCCButton&&e.openMenuFromCCButton;if(e.onToggle(E,F),F){var V=document.getElementById(R.config.targetId)||document;return(0,i.h)(i.Fragment,null,(0,i.h)(l.ButtonControl,{name:E,ref:M},(0,i.h)(u.Tooltip,{label:e.captionsLabelText},(0,i.h)(c.Button,{ref:I,tabIndex:"0","aria-label":e.captionsLabelText,"aria-haspopup":"true",className:[p().controlButton,o?p().active:""].join(" "),onClick:U},(0,i.h)(h.Icon,{type:x?h.IconType.ClosedCaptionsOn:h.IconType.ClosedCaptionsOff}))),o&&!A&&(0,i.h)(f.SmartContainer,{targetId:R.config.targetId,onClose:function(){return d(!1)},title:(0,i.h)(m.Text,{id:"controls.language"})},(0,i.h)(s.CaptionsMenu,{asDropdown:!1,onAdvancedCaptionsClick:j})),A?(0,v.createPortal)((0,i.h)(_.CVAAOverlay,{onClose:function(e,t){j(),U(0,t)}}),V.querySelector(".overlay-portal")):(0,i.h)("div",null)),(0,i.h)(k.CaptionsControlMini,e))}})));b.displayName=E},"./src/components/captions-control/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionsControl:function(){return n.CaptionsControl}});var n=r("./src/components/captions-control/captions-control.tsx")},"./src/components/captions-menu/captions-menu.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionsMenu:function(){return j}});var n,a,i,o,s,l,u=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/createClass.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),T=r("./node_modules/react-redux/es/index.js"),A=r("./src/utils/index.ts"),S=r("./src/reducers/cvaa.ts"),C=r("./src/components/smart-container/smart-container-item.tsx"),P=r("./src/components/icon/index.ts"),x=r("./src/components/player/index.ts"),w=r("./src/event/index.ts"),I=r("./src/components/logger/index.ts"),M=r("./src/components/event-dispatcher/index.ts"),R=r("./src/components/keyboard/index.ts"),D=r("./src/components/menu/index.ts");function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}var U="CaptionsMenu",j=(n=(0,T.connect)((function(e){return{textTracks:e.engine.textTracks,isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize,showAdvancedCaptionsMenu:e.config.settings.showAdvancedCaptionsMenu}}),(0,A.bindActions)(S.actions)),a=(0,R.withKeyboardEvent)(U),i=(0,I.withLogger)(U),o=(0,M.withEventDispatcher)(U),s=(0,b.withText)({captionsLabelText:"captions.captions",advancedCaptionsSettingsText:"captions.advanced_captions_settings"}),n(l=(0,x.withPlayer)(l=(0,w.withEventManager)(l=a(l=i(l=o(l=s(l=function(e){g()(r,e);var t=N(r);function r(){return p()(this,r),t.apply(this,arguments)}return f()(r,[{key:"onCaptionsChange",value:function(e){e!==this.props.advancedCaptionsSettingsText?(this.props.player.selectTrack(e),this.props.notifyClick({type:this.props.player.Track.TEXT,track:e})):this.props.onAdvancedCaptionsClick()}},{key:"render",value:function(e){var t=this,r=e.textTracks.map((function(e){return{label:e.label||e.language,active:e.active,value:e}})).map((function(e){return L(L({},e),{},{label:e.label.charAt(0).toUpperCase()+e.label.slice(1)})})).sort((function(e,t){return e.label>t.label||"Off"===e.label?1:-1}));return e.showAdvancedCaptionsMenu&&r.push({label:e.advancedCaptionsSettingsText,value:e.advancedCaptionsSettingsText,active:!1,isAdvanced:!0}),this.props.asDropdown?(0,E.h)(C.SmartContainerItem,{pushRef:function(t){e.pushRef(t)},icon:P.IconType.Captions,label:this.props.captionsLabelText,options:r,onMenuChosen:function(e){return t.onCaptionsChange(e)}}):(0,E.h)(D.Menu,{options:r,onMenuChosen:function(e){return t.onCaptionsChange(e)},onClose:function(){}})}}]),r}(E.Component))||l)||l)||l)||l)||l)||l)||l);j.displayName=U},"./src/components/captions-menu/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionsMenu:function(){return n.CaptionsMenu}});var n=r("./src/components/captions-menu/captions-menu.tsx")},"./src/components/cast-on-tv/cast-after-play.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CastAfterPlay:function(){return R}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/components/icon/index.ts"),C=r("./src/components/icon/icon.tsx"),P=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),x=r("./src/components/player/index.ts"),w=r("./src/components/logger/index.ts");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var M="CastAfterPlay",R=(n=(0,A.connect)((function(e){return{isPlaybackEnded:e.engine.isPlaybackEnded,isCasting:e.engine.isCasting}}),null),a=(0,w.withLogger)(M),n(i=(0,x.withPlayer)(i=a((o=function(e){f()(r,e);var t=I(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"_timeoutId",null),k()(p()(e),"onClick",(function(t){t.stopPropagation(),e.props.player.stopCasting()})),e}return c()(r,[{key:"componentDidMount",value:function(){var e=this;this._timeoutId=setTimeout((function(){e.setState({show:!0})}),700)}},{key:"componentWillUnmount",value:function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)}},{key:"render",value:function(e){if(e.isCasting&&e.isPlaybackEnded){var t=[b().castOnTvButtonContainer];return this.state.show&&t.push(b().showCastOnTv),(0,T.h)("div",null,(0,T.h)("div",{className:t.join(" "),onClick:this.onClick},(0,T.h)("a",{className:[b().btn,b().btnDarkTransparent,b().castOnTvButton].join(" ")},(0,T.h)("div",{className:b().castOnTvIconContainer},(0,T.h)(C.Icon,{type:e.icon})),(0,T.h)(P.Localizer,null,(0,T.h)("span",null,(0,T.h)(P.Text,{id:"cast.disconnect_from_tv"}))))))}}}]),r}(T.Component),k()(o,"defaultProps",{icon:S.IconType.CastBrand}),i=o))||i)||i)||i);R.displayName=M},"./src/components/cast-on-tv/cast-before-play.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CastBeforePlay:function(){return O}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/components/icon/index.ts"),C=r("./src/components/icon/icon.tsx"),P=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),x=r("./src/components/player/index.ts"),w=r("./src/components/logger/index.ts"),I=r("./src/components/button/index.ts"),M=r("./src/components/cast/index.ts");function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var D="CastBeforePlay",O=(n=(0,A.connect)((function(e){return{isPlaybackEnded:e.engine.isPlaybackEnded,prePlayback:e.engine.prePlayback,loading:e.loading.show,isCastAvailable:e.engine.isCastAvailable}})),a=(0,w.withLogger)(D),n(i=(0,x.withPlayer)(i=a((o=function(e){f()(r,e);var t=R(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"_timeoutId",null),k()(p()(e),"onClick",(function(){e.props.player.startCasting(M.RemotePlayerType.CHROMECAST)})),e}return c()(r,[{key:"componentDidMount",value:function(){var e=this;this._timeoutId=setTimeout((function(){e.setState({show:!0})}),700)}},{key:"componentWillUnmount",value:function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)}},{key:"render",value:function(e){if(e.isCastAvailable&&!e.loading&&e.prePlayback){var t=[b().castOnTvButtonContainer];return this.state.show&&t.push(b().showCastOnTv),(0,T.h)("div",{className:t.join(" ")},(0,T.h)(P.Localizer,null,(0,T.h)(I.Button,{tabIndex:"0","aria-label":(0,T.h)(P.Text,{id:"cast.play_on_tv"}),onClick:this.onClick,className:[b().btn,b().btnDarkTransparent,b().castOnTvButton].join(" ")},(0,T.h)("div",{className:b().castOnTvIconContainer},(0,T.h)(C.Icon,{type:e.icon})),(0,T.h)("span",null,(0,T.h)(P.Text,{id:"cast.play_on_tv"})))))}}}]),r}(T.Component),k()(o,"defaultProps",{icon:S.IconType.Cast}),i=o))||i)||i)||i);O.displayName=D},"./src/components/cast-on-tv/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CastAfterPlay:function(){return a.CastAfterPlay},CastBeforePlay:function(){return n.CastBeforePlay}});var n=r("./src/components/cast-on-tv/cast-before-play.tsx"),a=r("./src/components/cast-on-tv/cast-after-play.tsx")},"./src/components/cast-overlay/cast-overlay.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CastOverlay:function(){return P}});var n,a,i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("./src/styles/style.scss"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./node_modules/react-redux/es/index.js"),E=r("./src/components/icon/index.ts"),b=r("./src/components/icon/icon.tsx"),T=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),A=r("./src/components/logger/index.ts");function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var C="CastOverlay",P=(0,k.connect)((function(e){return{poster:e.engine.poster,castSession:e.engine.castSession,isIdle:e.engine.isIdle,isPlaying:e.engine.isPlaying,isPlaybackEnded:e.engine.isPlaybackEnded,isPaused:e.engine.isPaused,isChangingSource:e.engine.isChangingSource}}))(n=(0,A.withLogger)(C)((a=function(e){c()(r,e);var t=S(r);function r(){return o()(this,r),t.apply(this,arguments)}return l()(r,[{key:"getStatus",value:function(){return this.props.isPlaying||this.props.isPaused?(0,_.h)(T.Text,{id:"cast.status.playing_on"}):this.props.isPlaybackEnded||this.props.isChangingSource||this.props.castSession.resuming?(0,_.h)(T.Text,{id:"cast.status.connected_to"}):(0,_.h)(T.Text,{id:"cast.status.connecting_to"})}},{key:"getIcon",value:function(){return this.props.isPlaying||this.props.isPaused||this.props.isPlaybackEnded||this.props.isChangingSource||this.props.castSession.resuming?(0,_.h)(b.Icon,{type:this.props.icon}):(0,_.h)("div",{className:v().castConnectingSpinner})}},{key:"render",value:function(e){if(e.castSession){var t={},r=[v().castPoster];e.poster&&(t={backgroundImage:e.isChangingSource?"":"url(".concat(e.poster,")"),backgroundSize:"contain"},r.push(v().hasPoster));var n=this.getStatus(),a=this.getIcon();return(0,_.h)("div",null,(0,_.h)("div",{className:v().castOverlay},(0,_.h)("div",{className:r.join(" "),style:t,onMouseOver:function(e){return e.stopPropagation()}}),(0,_.h)("div",{className:v().castBlackCover})),(0,_.h)("div",{className:v().castBox},(0,_.h)("div",{className:v().castIcon},a),(0,_.h)("div",{className:v().castText},(0,_.h)(T.Localizer,null,(0,_.h)("span",{className:v().castStatus},n)),(0,_.h)("br",null),(0,_.h)("span",{className:v().castDevice},e.castSession.deviceFriendlyName))))}}}]),r}(_.Component),g()(a,"defaultProps",{icon:E.IconType.Cast}),n=a))||n)||n;P.displayName=C},"./src/components/cast-overlay/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CastOverlay:function(){return n.CastOverlay}});var n=r("./src/components/cast-overlay/cast-overlay.tsx")},"./src/components/cast/cast.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Cast:function(){return O}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/utils/index.ts"),C=r("./src/components/player/index.ts"),P=r("./src/event/index.ts"),x=r("./src/components/logger/index.ts"),w=r("./src/components/tooltip/index.ts"),I=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),M=r("./src/components/cast/remote-player-type.ts");function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var D="Cast",O=(n=(0,A.connect)((function(e){return{isCasting:e.engine.isCasting,isCastAvailable:e.engine.isCastAvailable}})),a=(0,x.withLogger)(D),i=(0,I.withText)({castText:"cast.play_on_tv"}),n(o=(0,C.withPlayer)(o=(0,P.withEventManager)(o=a(o=i(o=function(e){f()(r,e);var t=R(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"onClick",(function(){e.props.player.setIsCastInitiator(M.RemotePlayerType.CHROMECAST,!0),e.props.eventManager.listenOnce(e.props.player,e.props.player.Event.Cast.CAST_SESSION_START_FAILED,(function(){return e.props.player.setIsCastInitiator(M.RemotePlayerType.CHROMECAST,!1)}))})),k()(p()(e),"onKeyDown",(function(t){t.keyCode===S.KeyMap.ENTER&&e.props.player.startCasting(M.RemotePlayerType.CHROMECAST)})),e}return c()(r,[{key:"_shouldRender",value:function(){var e=this.props.isCasting||this.props.isCastAvailable;return this.props.onToggle(D,e),e}},{key:"render",value:function(e){if(this._shouldRender()){var t=e.isCasting?"".concat(b().castButton," ").concat(b().castButtonActive):b().castButton;return(0,T.h)("div",{role:"button","aria-label":this.props.castText,className:b().controlButtonContainer,onClick:this.onClick,onKeyDown:this.onKeyDown},(0,T.h)(w.Tooltip,{label:this.props.castText},(0,T.h)("google-cast-launcher",{className:t,tabIndex:"0"})))}}}]),r}(T.Component))||o)||o)||o)||o)||o);O.displayName=D},"./src/components/cast/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Cast:function(){return n.Cast},RemotePlayerType:function(){return a.RemotePlayerType}});var n=r("./src/components/cast/cast.tsx"),a=r("./src/components/cast/remote-player-type.ts")},"./src/components/cast/remote-player-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{RemotePlayerType:function(){return n}});var n={CHROMECAST:"chromecast"}},"./src/components/closed-captions/closed-captions.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ClosedCaptions:function(){return A}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),o=r.n(i),s=r("./src/styles/style.scss"),l=r.n(s),u=r("./node_modules/preact/dist/preact.module.js"),c=r("./node_modules/preact/hooks/dist/hooks.module.js"),d=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),p=r("./src/components/icon/index.ts"),h=r("./node_modules/react-redux/es/index.js"),f=r("./src/components/event-dispatcher/index.ts"),m=r("./src/components/logger/index.ts"),g=r("./src/components/tooltip/index.ts"),y=r("./src/components/button/index.ts"),v=r("./src/components/button-control/index.ts"),_=r("./src/components/bottom-bar/index.ts"),k=r("./src/index.ts");function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var T="ClosedCaptions",A=(0,h.connect)((function(e){return{textTracks:e.engine.textTracks,showCCButton:e.config.showCCButton,openMenuFromCCButton:e.config.openMenuFromCCButton}}))((0,m.withLogger)(T)((0,f.withEventDispatcher)(T)((0,d.withText)({closedCaptionsOnText:"controls.closedCaptionsOn",closedCaptionsOffText:"controls.closedCaptionsOff"})((function(e,t){var r=(0,c.useState)(!1),n=o()(r,2),a=n[0],i=n[1],s=e.textTracks,d=t.player,h=s.find((function(e){return e.active}));(0,c.useEffect)((function(){i("off"!==(null==h?void 0:h.language))}),[h]),(0,c.useEffect)((function(){(0,_.registerToBottomBar)(T,d,(function(){return f()}))}),[]);var f=function(){return{ariaLabel:function(){return E()},displayName:T,order:5,svgIcon:function(){return A()},onClick:function(){return C()},component:function(){return S(b(b({},e),{},{classNames:[l().upperBarIcon]}))},shouldHandleOnClick:!1}},m=function(){return k.redux.useStore().getState().settings.isCaptionsEnabled},E=function(){return m()?e.closedCaptionsOnText:e.closedCaptionsOffText},A=function(){return{type:m()?p.IconType.ClosedCaptionsOn:p.IconType.ClosedCaptionsOff}},C=function(){var t=m();e.notifyClick(t),t?d.hideTextTrack():d.showTextTrack()},P=!!(null==s?void 0:s.length)&&e.showCCButton&&!e.openMenuFromCCButton;if(e.onToggle(T,P),P)return(0,u.h)(v.ButtonControl,{name:T,className:e.classNames?e.classNames.join(" "):""},a?(0,u.h)(g.Tooltip,{label:e.closedCaptionsOnText},(0,u.h)(y.Button,{tabIndex:0,"aria-label":e.closedCaptionsOnText,className:[l().controlButton,l().ccOn].join(" "),onClick:function(){e.notifyClick(!0),d.hideTextTrack()}},(0,u.h)(p.Icon,{type:p.IconType.ClosedCaptionsOn}))):(0,u.h)(g.Tooltip,{label:e.closedCaptionsOffText},(0,u.h)(y.Button,{tabIndex:0,"aria-label":e.closedCaptionsOffText,className:l().controlButton,onClick:function(){e.notifyClick(!1),d.showTextTrack()}},(0,u.h)(p.Icon,{type:p.IconType.ClosedCaptionsOff}))))}))))),S=function(e){return(0,u.h)(A,e)};A.displayName=T},"./src/components/closed-captions/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ClosedCaptions:function(){return n.ClosedCaptions}});var n=r("./src/components/closed-captions/closed-captions.tsx")},"./src/components/copy-button/copy-button.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CopyButton:function(){return w}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("./src/styles/style.scss"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./src/components/icon/index.ts"),E=r("./src/components/icon/icon.tsx"),b=r("./src/components/tooltip/index.ts"),T=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),A=r("./src/utils/index.ts"),S=r("./src/components/index.ts");function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var P="CopyButton",x=[{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7 4C5.89543 4 5 4.89543 5 6V13C5 14.1046 5.89543 15 7 15H11C12.1046 15 13 14.1046 13 13V6C13 4.89543 12.1046 4 11 4H7ZM7 6H11V13H7V6Z"},{d:"M15 11H16V18H12V17.2H10V18.1C10 19.2458 10.9971 20 12 20H16C17.0029 20 18 19.2458 18 18.1V10.9C18 9.75416 17.0029 9 16 9H15V11Z"}],w=function(e){c()(r,e);var t=C(r);function r(e){var n;return a()(this,r),n=t.call(this,e),g()(l()(n),"_timeoutId",null),g()(l()(n),"copy",(function(){try{n.props.copy(),n.setState({copySuccess:!0}),n._timeoutId=setTimeout((function(){n.setState({copySuccess:!1})}),2e3)}catch(e){n.setState({copySuccess:!1})}})),g()(l()(n),"onKeyDown",(function(e){e.keyCode===A.KeyMap.ENTER&&n.copy()})),n.setState({copySuccess:!1}),n}return o()(r,[{key:"componentWillUnmount",value:function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)}},{key:"render",value:function(e){var t=[v().btnCopyUrl,v().btnBorderless,v().onlyIcon].join(" ");return t+=this.state.copySuccess?" "+v().copied:"",(0,_.h)(T.Localizer,null,(0,_.h)(S.ButtonControl,{name:P},(0,_.h)(b.Tooltip,{label:(0,_.h)(T.Text,{id:"copy.button"})},(0,_.h)(S.Button,{tabIndex:"0",ref:function(t){e.addAccessibleChild&&e.addAccessibleChild(t)},className:t,onClick:this.copy,onKeyDown:this.onKeyDown},(0,_.h)(E.Icon,{id:"copy",color:"#fff",path:x,width:"24",height:"24",viewBox:"0 0 24 24"}),(0,_.h)(E.Icon,{type:k.IconType.Check})))))}}]),r}(_.Component);g()(w,"defaultProps",{icon:k.IconType.Copy}),w.displayName=P},"./src/components/copy-button/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CopyButton:function(){return n.CopyButton}});var n=r("./src/components/copy-button/copy-button.tsx")},"./src/components/cvaa-overlay/custom-captions-window.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CustomCaptionsWindow:function(){return x}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./src/styles/style.scss"),k=r.n(_),E=r("./src/utils/key-map.ts"),b=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),T=r("./src/components/cvaa-overlay/drop-down-captions-style.tsx"),A=r("./src/components/cvaa-overlay/slider-captions-style.tsx");function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var x=(0,r("./src/components/player/index.ts").withPlayer)(n=function(e){d()(r,e);var t=P(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"changeCaptionsStyle",(function(){e.props.changeCaptionsStyle(e.props.customTextStyle)})),y()(u()(e),"transitionToState",(function(){e.props.transitionToState(e.props.cvaaOverlayState.Main)})),y()(u()(e),"onKeyDown",(function(t){t.keyCode===E.KeyMap.ENTER&&e.changeCaptionsStyle()})),e}return s()(r,[{key:"componentDidMount",value:function(){this.props.focusOnDefault()}},{key:"render",value:function(e){var t=this,r=this.props.player,n=r.TextStyle.FontFamily,a=r.TextStyle.EdgeStyles,i=r.TextStyle.StandardColors,o=r.TextStyle.FontSizes.map((function(t){return{value:t.label,label:t.label,active:e.customTextStyle.fontSize===t.label}})),s=Object.keys(i).map((function(t){return{value:i[t],label:t.charAt(0).toUpperCase()+t.toLowerCase().slice(1),active:e.customTextStyle.fontColor.every((function(e,r){return e===i[t][r]}))}})),l=Object.keys(n).map((function(t){return{value:n[t],label:n[t],active:e.customTextStyle.fontFamily===n[t]}})),u=Object.keys(a).map((function(t){return{value:a[t],label:t.charAt(0).toUpperCase()+t.toLowerCase().slice(1),active:e.customTextStyle.fontEdge===a[t]}})),c=Object.keys(i).map((function(t){return{value:i[t],label:t.charAt(0).toUpperCase()+t.toLowerCase().slice(1),active:e.customTextStyle.backgroundColor.every((function(e,r){return e===i[t][r]}))}})),d=r.TextStyle.FontAlignment.map((function(t){return C(C({},t),{},{active:e.customTextStyle.textAlign===t.value})}));return(0,v.h)("div",{className:[k().overlayScreen,k().active].join(" ")},(0,v.h)("form",{className:[k().form,k().customCaptionForm].join(" ")},(0,v.h)(T.DropDownCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.size_label",options:o,classNames:[k().formGroupRow,k().fontSize],styleName:"fontSize",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(T.DropDownCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_alignment_label",options:d,classNames:[k().formGroupRow,k().fontAlignment],styleName:"textAlign",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(T.DropDownCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_color_label",options:s,classNames:[k().formGroupRow,k().fontColor],styleName:"fontColor",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(T.DropDownCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_family_label",options:l,classNames:[k().formGroupRow,k().fontFamily],styleName:"fontFamily",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(T.DropDownCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_style_label",options:u,classNames:[k().formGroupRow,k().fontStyle],styleName:"fontEdge",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(A.SliderCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.font_opacity_label",value:e.customTextStyle.fontOpacity,classNames:[k().formGroupRow,k().fontOpacity],styleName:"fontOpacity",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(T.DropDownCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.background_color_label",options:c,classNames:[k().formGroupRow,k().backgroundColor],styleName:"backgroundColor",changeCustomStyle:e.changeCustomStyle}),(0,v.h)(A.SliderCaptionsStyle,{addAccessibleChild:e.addAccessibleChild,labelId:"cvaa.background_opacity_label",value:e.customTextStyle.backgroundOpacity,classNames:[k().formGroupRow,k().backgroundOpacity],styleName:"backgroundOpacity",changeCustomStyle:e.changeCustomStyle}),(0,v.h)("div",{className:k().formGroupRow},(0,v.h)("a",{role:"button",tabIndex:0,ref:function(t){e.addAccessibleChild(t)},onClick:function(){t.changeCaptionsStyle(),t.transitionToState()},onKeyDown:this.onKeyDown,className:[k().btn,k().btnBranded,k().btnBlock].join(" ")},(0,v.h)(b.Text,{id:"cvaa.apply"}))),(0,v.h)("div",{className:k().previewContainer},(0,v.h)("span",{style:e.getPreviewStyle()},(0,v.h)(b.Text,{id:"cvaa.caption_preview"})))))}}]),r}(v.Component))||n},"./src/components/cvaa-overlay/cvaa-overlay.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{CVAAOverlay:function(){return H}});var n,a,i,o,s,l=r("./node_modules/@babel/runtime/helpers/extends.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/createClass.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/inherits.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),_=r.n(v),k=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),E=r.n(k),b=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),T=r.n(b),A=r("./node_modules/preact/dist/preact.module.js"),S=r("./node_modules/react-redux/es/index.js"),C=r("./src/utils/index.ts"),P=r("./src/reducers/cvaa.ts"),x=r("./src/reducers/shell.ts"),w=r("./src/components/overlay/index.ts"),I=r("./src/components/player/index.ts"),M=r("./src/components/event-dispatcher/index.ts"),R=r("./src/components/logger/index.ts"),D=r("./src/components/cvaa-overlay/main-captions_window.tsx"),O=r("./src/components/cvaa-overlay/custom-captions-window.tsx"),L=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),N=r("@playkit-js/playkit-js");function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var a=E()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _()(this,r)}}function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){T()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F={Main:"main",CustomCaptions:"custom-captions"},V="CVAAOverlay",H=(n=(0,S.connect)((function(e){return{style:e.cvaa.style}}),(0,C.bindActions)(B(B({},P.actions),x.actions))),a=(0,R.withLogger)(V),i=(0,M.withEventDispatcher)(V),o=(0,L.withText)({cvvaDialogText:"cvaa.title",cvvaSetCustomCaptionsText:"cvaa.set_custom_caption"}),n(s=(0,I.withPlayer)(s=a(s=i(s=(0,C.withKeyboardA11y)(s=o(s=function(e){y()(r,e);var t=U(r);function r(){var e;d()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),T()(m()(e),"transitionToState",(function(t){e.setState({activeWindow:t})})),T()(m()(e),"changeCaptionsStyle",(function(t){e.props.notifyClick({textStyle:t}),e.props.updateCaptionsStyle(t),e.props.player.textStyle=t})),T()(m()(e),"getPreviewStyle",(function(){var t=100*e.state.customTextStyle.implicitFontScale+"%",r=e.state.customTextStyle.toCSS();return"font-size: ".concat(t,"!important; ").concat(r)})),T()(m()(e),"changeCustomStyle",(function(t){e.setState((function(e){var r=e.customTextStyle.clone();return{customTextStyle:Object.assign(r,t)}}))})),e}return h()(r,[{key:"componentWillUnmount",value:function(){this.setState({activeWindow:F.Main})}},{key:"componentWillMount",value:function(){var e=this.props.player;this.setState({activeWindow:F.Main,customTextStyle:e.textStyle}),this.props.setIsModal(!0)}},{key:"render",value:function(e){e.clearAccessibleChildren();var t=this.state.activeWindow===F.Main,r="captions_title_".concat(N.Utils.Generator.guid()),n=t?{ariaLabelledBy:r}:{ariaLabel:this.props.cvvaSetCustomCaptionsText};return(0,A.h)(w.Overlay,u()({open:!0,handleKeyDown:this.props.handleKeyDown,addAccessibleChild:this.props.addAccessibleChild,onClose:e.onClose,type:"cvaa"},n),this.state.activeWindow===F.Main?(0,A.h)(D.MainCaptionsWindow,{captionsTitleId:r,cvaaOverlayState:F,addAccessibleChild:e.addAccessibleChild,captionsStyleDefault:this.captionsStyleDefault,captionsStyleBlackBG:this.captionsStyleBlackBG,captionsStyleYellow:this.captionsStyleYellow,changeCaptionsStyle:this.changeCaptionsStyle,transitionToState:this.transitionToState,customTextStyle:this.state.customTextStyle}):(0,A.h)(O.CustomCaptionsWindow,{addAccessibleChild:e.addAccessibleChild,focusOnDefault:this.props.focusOnDefault,changeCaptionsStyle:this.changeCaptionsStyle,changeCustomStyle:this.changeCustomStyle,getPreviewStyle:this.getPreviewStyle,customTextStyle:this.state.customTextStyle,transitionToState:this.transitionToState,cvaaOverlayState:F}))}}]),r}(A.Component))||s)||s)||s)||s)||s)||s);H.displayName=V},"./src/components/cvaa-overlay/drop-down-captions-style.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{DropDownCaptionsStyle:function(){return o}});var n=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),a=r("./src/components/dropdown/index.ts"),i=r("./node_modules/preact/dist/preact.module.js"),o=function(e){return(0,i.h)("div",{className:e.classNames.join(" ")},(0,i.h)("label",{id:e.styleName},(0,i.h)(n.Text,{id:e.labelId})),(0,i.h)(a.DropDown,{name:e.styleName,pushRef:function(t){e.addAccessibleChild(t)},tabbable:!0,onMenuChosen:function(t){var r={};r[e.styleName]=t,e.changeCustomStyle(r)},options:e.options}))}},"./src/components/cvaa-overlay/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CVAAOverlay:function(){return n.CVAAOverlay}});var n=r("./src/components/cvaa-overlay/cvaa-overlay.tsx")},"./src/components/cvaa-overlay/main-captions_window.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{MainCaptionsWindow:function(){return C}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./src/styles/style.scss"),k=r.n(_),E=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),b=r("./src/utils/key-map.ts"),T=r("./src/components/icon/index.ts"),A=r("./src/components/cvaa-overlay/sample-captions-style-button.tsx");function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var C=(0,r("./src/components/player/index.ts").withPlayer)(n=function(e){d()(r,e);var t=S(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"captionsStyleDefault",void 0),y()(u()(e),"captionsStyleYellow",void 0),y()(u()(e),"captionsStyleBlackBG",void 0),y()(u()(e),"transitionToState",(function(){e.props.transitionToState(e.props.cvaaOverlayState.CustomCaptions)})),y()(u()(e),"onKeyDown",(function(t){t.keyCode===b.KeyMap.ENTER&&e.transitionToState()})),e}return s()(r,[{key:"componentWillMount",value:function(){var e=this.props.player;this.captionsStyleDefault=e.TextStyle.fromJson({backgroundOpacity:e.TextStyle.StandardOpacities.TRANSPARENT}),this.captionsStyleYellow=e.TextStyle.fromJson({backgroundOpacity:e.TextStyle.StandardOpacities.TRANSPARENT,fontColor:e.TextStyle.StandardColors.YELLOW}),this.captionsStyleBlackBG=e.TextStyle.fromJson({backgroundColor:e.TextStyle.StandardColors.BLACK,fontColor:e.TextStyle.StandardColors.WHITE})}},{key:"render",value:function(e){var t=this;return(0,v.h)("div",{className:[k().overlayScreen,k().active].join(" ")},(0,v.h)("h2",{className:k().title,id:this.props.captionsTitleId},(0,v.h)(E.Text,{id:"cvaa.title"})),(0,v.h)("div",{role:"group"},(0,v.h)(A.SampleCaptionsStyleButton,{addAccessibleChild:e.addAccessibleChild,classNames:[k().sample],changeCaptionsStyle:function(){return e.changeCaptionsStyle(t.captionsStyleDefault)},isActive:e.player.textStyle.isEqual(this.captionsStyleDefault)},(0,v.h)(E.Text,{id:"cvaa.sample_caption_tag",fields:{number:"1"}})),(0,v.h)(A.SampleCaptionsStyleButton,{addAccessibleChild:e.addAccessibleChild,classNames:[k().sample,k().blackBg],changeCaptionsStyle:function(){return e.changeCaptionsStyle(t.captionsStyleBlackBG)},isActive:e.player.textStyle.isEqual(this.captionsStyleBlackBG)},(0,v.h)(E.Text,{id:"cvaa.sample_caption_tag",fields:{number:"2"}})),(0,v.h)(A.SampleCaptionsStyleButton,{addAccessibleChild:e.addAccessibleChild,classNames:[k().sample,k().yellowText],changeCaptionsStyle:function(){return e.changeCaptionsStyle(t.captionsStyleYellow)},isActive:e.player.textStyle.isEqual(this.captionsStyleYellow)},(0,v.h)(E.Text,{id:"cvaa.sample_caption_tag",fields:{number:"3"}}))),this.isAdvancedStyleApplied()?(0,v.h)("div",{className:k().customCaptionsApplied},(0,v.h)("div",{className:[k().sample,k().custom].join(" "),style:e.customTextStyle.toCSS()},(0,v.h)(E.Text,{id:"cvaa.sample_custom_caption_tag"}),(0,v.h)("div",{className:k().activeTick},(0,v.h)(T.Icon,{type:T.IconType.Check}))),(0,v.h)("a",{role:"button",tabIndex:0,"aria-haspopup":"true",onClick:this.transitionToState,ref:function(t){e.addAccessibleChild(t)},onKeyDown:this.onKeyDown},(0,v.h)(E.Text,{id:"cvaa.edit_caption"}))):(0,v.h)("a",{role:"button","aria-haspopup":"true",tabIndex:0,className:k().buttonSaveCvaa,onClick:this.transitionToState,ref:function(t){e.addAccessibleChild(t)},onKeyDown:this.onKeyDown},(0,v.h)(E.Text,{id:"cvaa.set_custom_caption"})))}},{key:"isAdvancedStyleApplied",value:function(){var e=this.props.player;return!e.textStyle.isEqual(this.captionsStyleDefault)&&!e.textStyle.isEqual(this.captionsStyleBlackBG)&&!e.textStyle.isEqual(this.captionsStyleYellow)}}]),r}(v.Component))||n},"./src/components/cvaa-overlay/sample-captions-style-button.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SampleCaptionsStyleButton:function(){return u}});var n=r("./src/utils/index.ts"),a=r("./src/styles/style.scss"),i=r.n(a),o=r("./src/components/icon/index.ts"),s=r("./node_modules/preact/dist/preact.module.js"),l=r("./node_modules/preact/compat/dist/compat.module.js"),u=function(e){var t=(0,l.useRef)(null);return(0,l.useEffect)((function(){e.isActive&&t.focus()}),[]),(0,s.h)("div",{role:"menuitemradio",tabIndex:0,"aria-checked":e.isActive?"true":"false",ref:function(r){t=r,e.addAccessibleChild(r)},className:e.classNames.join(" "),onClick:e.changeCaptionsStyle,onKeyDown:function(t){t.keyCode===n.KeyMap.ENTER&&e.changeCaptionsStyle()}},e.children,e.isActive?(0,s.h)("div",{className:i().activeTick},(0,s.h)(o.Icon,{type:o.IconType.Check})):void 0)}},"./src/components/cvaa-overlay/slider-captions-style.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SliderCaptionsStyle:function(){return o}});var n=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),a=r("./node_modules/preact/dist/preact.module.js"),i=r("./src/components/slider/index.ts"),o=function(e){return(0,a.h)("div",{className:e.classNames.join(" ")},(0,a.h)("label",{id:e.styleName},(0,a.h)(n.Text,{id:e.labelId})),(0,a.h)(i.Slider,{name:e.styleName,pushRef:function(t){e.addAccessibleChild(t)},min:0,max:100,value:100*e.value,onChange:function(t){var r={};r[e.styleName]=t/100,e.changeCustomStyle(r)}}))}},"./src/components/dropdown/dropdown.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{DropDown:function(){return C}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./src/styles/style.scss"),_=r.n(v),k=r("./node_modules/preact/dist/preact.module.js"),E=r("./node_modules/react-redux/es/index.js"),b=r("./src/components/menu/index.ts"),T=r("./src/components/icon/index.ts"),A=r("./src/utils/key-map.ts");function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var C=(0,E.connect)((function(e){return{isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize}}))(n=function(e){d()(r,e);var t=S(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"_el",void 0),y()(u()(e),"onMenuChosen",(function(t){e.props.onMenuChosen(t),e.setState({dropMenuActive:!1})})),y()(u()(e),"onClick",(function(){e.state.dropMenuActive||setTimeout((function(){return e.toggleDropDown()}))})),y()(u()(e),"onKeyDown",(function(t){switch(t.keyCode){case A.KeyMap.ENTER:e.onClick();break;case A.KeyMap.SPACE:t.preventDefault(),e.onClick();break;case A.KeyMap.ESC:e.state.dropMenuActive&&(e.onClose(),t.stopPropagation())}})),y()(u()(e),"onClose",(function(){e.setState({dropMenuActive:!1})})),e}return s()(r,[{key:"componentWillMount",value:function(){this.setState({dropMenuActive:!1})}},{key:"componentDidMount",value:function(){this.props.registerParentSelectedCallback&&this.props.registerParentSelectedCallback(this.toggleDropDown.bind(this))}},{key:"isSelected",value:function(e){return e.active}},{key:"getActiveOption",value:function(){var e=this.props.options.find((function(e){return e.active}));return e||this.props.options[0]||{label:"Unlabled"}}},{key:"renderNativeSelect",value:function(e){return(0,k.h)(b.Menu,{labelledby:e,pushRef:this.props.pushRef,options:this.props.options,onMenuChosen:this.onMenuChosen,onClose:this.onClose})}},{key:"render",value:function(e){var t,r,n=this,a=e.name+"Active",i=this.getActiveOption(),o=(null==i||null===(t=i.dropdownOptions)||void 0===t?void 0:t.label)||i.label,s=T.BadgeType[i.badgeType||(null==i||null===(r=i.dropdownOptions)||void 0===r?void 0:r.badgeType)];return e.isMobile||e.isSmallSize?this.renderNativeSelect(e.name):(0,k.h)("div",{name:e.name,className:this.state.dropMenuActive?[_().dropdown,_().active].join(" "):_().dropdown,ref:function(e){return e?n._el=e:void 0}},(0,k.h)("div",{tabIndex:e.tabbable?0:-1,ref:function(t){e.pushRef&&e.pushRef(t)},role:"menuitem","aria-haspopup":"true","aria-expanded":this.state.dropMenuActive?"true":"false","aria-labelledby":[e.name,a].join(" "),className:_().dropdownButton,onClick:this.onClick,onKeyDown:this.onKeyDown},(0,k.h)("span",{id:a,className:s?[_().labelBadge,s].join(" "):""},o),(0,k.h)(T.Icon,{type:T.IconType.ArrowDown}),this.state.dropMenuActive?(0,k.h)(b.Menu,{parentEl:this._el,options:e.options,onMenuChosen:this.onMenuChosen,onClose:this.onClose}):void 0))}},{key:"toggleDropDown",value:function(){this.setState((function(e){return{dropMenuActive:!e.dropMenuActive}}))}}]),r}(k.Component))||n;C.displayName="DropDown"},"./src/components/dropdown/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{DropDown:function(){return n.DropDown}});var n=r("./src/components/dropdown/dropdown.tsx")},"./src/components/engine-connector/engine-connector.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineConnector:function(){return L}});var n,a,i,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./src/utils/index.ts"),E=r("./src/reducers/engine.ts"),b=r("./src/reducers/loading.ts"),T=r("./src/reducers/shell.ts"),A=r("./src/reducers/seekbar.ts"),S=r("./src/reducers/settings.ts"),C=r("./src/components/player/index.ts"),P=r("./src/event/index.ts"),x=r("./src/components/logger/index.ts");function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var R=A.actions.updateCurrentTime,D=S.actions.updateIsCaptionsEnabled,O="EngineConnector",L=(n=(0,_.connect)(E.default,(0,k.bindActions)(M(M(M(M({},E.actions),b.actions),T.actions),{},{seekbarUpdateCurrentTime:R,updateIsCaptionsEnabled:D}))),a=(0,x.withLogger)(O),n(i=(0,C.withPlayer)(i=(0,P.withEventManager)(i=a(i=function(e){d()(r,e);var t=w(r);function r(){return s()(this,r),t.apply(this,arguments)}return u()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.player,n=t.eventManager,a=r.Track;this.props.updatePrePlayback(!r.config.playback.autoplay),n.listen(r,r.Event.Core.PLAYER_RESET,(function(t){e.props.updateCurrentTime(0),e.props.seekbarUpdateCurrentTime(0),t.payload.isChangeMedia||e.props.updateIsIdle(!0),e.props.updateIsPlaybackStarted(!1),e.props.updateDataLoadingStatus(!1)})),n.listen(r,r.Event.Core.SOURCE_SELECTED,(function(){e.props.updateIsCastAvailable(r.isCastAvailable()),e.props.updateIsLive(r.isLive()),e.props.updateIsVr(r.isVr()),e.props.updateIsImg(r.isUntimedImg()),e.props.updateIsDocument(r.isUntimedDocument()),e.props.updateIsAudio(r.isAudio()),e.props.updateIsInPictureInPicture(r.isInPictureInPicture()),r.config.playback.autoplay?e.props.updateLoadingSpinnerState(!0):e.props.updateLoadingSpinnerState(!1)})),n.listen(r,r.Event.Core.CHANGE_SOURCE_STARTED,(function(){e.props.updatePrePlayback(!r.config.playback.autoplay&&!e.props.engine.isPlaybackStarted),e.props.updateIsChangingSource(!0),e.props.updateFallbackToMutedAutoPlay(!1),e.props.updateAdBreak(!1),e.props.updateAdIsPlaying(!1),e.props.updateIsPlaying(!1),e.props.updateIsEnded(!1),e.props.updateIsPlaybackEnded(!1),e.props.updateLastSeekPoint(0),e.props.updateIsPaused(!1),e.props.engine.isCasting&&e.props.updateLoadingSpinnerState(!0)})),n.listen(r,r.Event.Core.CHANGE_SOURCE_ENDED,(function(){e.props.updateIsChangingSource(!1),e.props.updatePlayerPoster(r.poster),e.props.updateIsIdle(!1)})),n.listen(r,r.Event.Core.PLAYER_STATE_CHANGED,(function(t){e.props.updatePlayerState(t.payload.oldState.type,t.payload.newState.type)})),n.listen(r,r.Event.Core.TIME_UPDATE,(function(){e.props.updateCurrentTime(r.currentTime)})),n.listen(r,r.Event.Core.DURATION_CHANGE,(function(){e.props.updateDuration(r.isLive()?r.liveDuration:r.duration)})),n.listen(r,r.Event.Core.LOADED_DATA,(function(){e.props.updateDuration(r.isLive()?r.liveDuration:r.duration),e.props.updatePictureInPictureSupport(r.isPictureInPictureSupported()),e.props.updateDataLoadingStatus(!0)})),n.listen(r,r.Event.Core.LOADED_METADATA,(function(){e.props.updateMuted(r.muted),e.props.updateMetadataLoadingStatus(!0),e.props.updateIsLive(r.isLive()),e.props.updateIsDvr(r.isDvr()),e.props.updatePlayerPoster(r.poster)})),n.listen(r,r.Event.Core.VOLUME_CHANGE,(function(){e.props.updateVolume(r.volume)})),n.listen(r,r.Event.Core.MUTE_CHANGE,(function(){e.props.updateMuted(r.muted),e.props.engine.fallbackToMutedAutoPlay&&e.props.updateFallbackToMutedAutoPlay(r.muted)})),n.listen(r,r.Event.Core.PLAYBACK_START,(function(){e.props.updatePrePlayback(!1),e.props.updateIsPlaybackStarted(!0),e.props.updateLoadingSpinnerState(!0)})),n.listen(r,r.Event.Core.AUTOPLAY_FAILED,(function(){e.props.updatePrePlayback(!0)})),n.listen(r,r.Event.Core.FIRST_PLAY,(function(){e.props.updatePrePlayback(!1)})),n.listen(r,r.Event.Core.PLAY,(function(){e.props.updateIsPlaying(!0),e.props.updateIsEnded(!1),e.props.updateIsPaused(!1),e.props.updateIsPlaybackEnded(!1)})),n.listen(r,r.Event.Core.PAUSE,(function(){e.props.updateIsPlaying(!1),e.props.updateIsPaused(!0)})),n.listen(r,r.Event.Core.SEEKING,(function(){e.props.updateIsSeeking(!0)})),n.listen(r,r.Event.Core.SEEKED,(function(){e.props.updateIsSeeking(!1),e.props.updateLastSeekPoint(r.currentTime),e.props.updateIsPlaybackEnded(!1)})),n.listen(r,r.Event.Core.ENDED,(function(){e.props.updateIsEnded(!0),e.props.updateIsPlaying(!1),e.props.updateIsPaused(!0)})),n.listen(r,r.Event.Core.PLAYBACK_ENDED,(function(){e.props.updateIsPlaybackEnded(!0)})),n.listen(r,r.Event.Core.TRACKS_CHANGED,(function(){var t=r.getTracks(a.AUDIO),n=r.getTracks(a.VIDEO),i=r.getTracks(a.TEXT);e.props.updateAudioTracks(t),e.props.updateVideoTracks(n),e.props.updateTextTracks(i)})),n.listen(r,r.Event.Core.TEXT_TRACK_CHANGED,(function(){var t,n=r.getTracks(a.TEXT);e.props.updateTextTracks(n),e.props.updateIsCaptionsEnabled("off"!==(null===(t=n.find((function(e){return e.active})))||void 0===t?void 0:t.language))})),n.listen(r,r.Event.Core.AUDIO_TRACK_CHANGED,(function(){var t=r.getTracks(a.AUDIO);e.props.updateAudioTracks(t)})),n.listen(r,r.Event.Core.VIDEO_TRACK_CHANGED,(function(){var t=r.getTracks(a.VIDEO);e.props.updateVideoTracks(t)})),n.listen(r,r.Event.Core.AD_BREAK_START,(function(){e.props.updateHasError(!1),e.props.updateAdBreak(!0)})),n.listen(r,r.Event.Core.AD_BREAK_END,(function(){e.props.updateAdBreak(!1)})),n.listen(r,r.Event.Core.ALL_ADS_COMPLETED,(function(){e.props.updateAdBreak(!1)})),n.listen(r,r.Event.Core.AD_PROGRESS,(function(t){var r=t.payload.adProgress.currentTime,n=t.payload.adProgress.duration;e.props.updateAdBreakProgress(r,n)})),n.listen(r,r.Event.Core.AD_COMPLETED,(function(){e.props.updateAdBreakCompleted()})),n.listen(r,r.Event.Core.AD_STARTED,(function(t){var r=t.payload.ad;e.props.updateLoadingSpinnerState(!1),e.props.updateAdIsPlaying(!0),e.props.updatePrePlayback(!1),e.props.updateAdIsBumper(r.bumper),e.props.updateAdContentType(r.contentType)})),n.listen(r,r.Event.Core.AD_RESUMED,(function(){e.props.updateAdIsPlaying(!0)})),n.listen(r,r.Event.Core.AD_PAUSED,(function(){e.props.updateAdIsPlaying(!1)})),n.listen(r,r.Event.Core.AD_ERROR,(function(t){t.payload.severity===r.Error.Severity.CRITICAL&&e.props.updateAdBreak(!1)})),n.listen(r,r.Event.Core.FALLBACK_TO_MUTED_AUTOPLAY,(function(){e.props.updateFallbackToMutedAutoPlay(!0)})),n.listen(r,r.Event.Core.AD_LOADED,(function(t){var r=t.payload.ad;e.props.updateAdIsLinear(r.linear),e.props.updateAdIsBumper(r.bumper),e.props.updateAdClickUrl(r.clickThroughUrl),e.props.updateAdSkipTimeOffset(r.skipOffset),e.props.updateAdSkippableState(r.skippable)})),n.listen(r,r.Event.Core.VR_STEREO_MODE_CHANGED,(function(t){e.props.updateVrStereoMode(t.payload.mode)})),n.listen(r,r.Event.Core.ERROR,(function(t){var n,a;t.payload.severity===r.Error.Severity.CRITICAL&&(e.props.updateIsIdle(!1),e.props.updateHasError(!0),e.props.updateErrorDetails(t.payload.category||void 0,null===(n=t.payload.errorDetails)||void 0===n?void 0:n.errorTitle,null===(a=t.payload.errorDetails)||void 0===a?void 0:a.errorMessage))})),n.listen(r,r.Event.Cast.CAST_SESSION_STARTED,(function(t){var r=t.payload.session;e.props.updateIsCasting(!0),e.props.updateCastSession(r),r.resuming&&e.props.updateLoadingSpinnerState(!1)})),n.listen(r,r.Event.Cast.CAST_SESSION_ENDED,(function(){e.props.updateIsCasting(!1),e.props.updateCastSession(null)})),n.listen(r,r.Event.Cast.CAST_AVAILABLE,(function(t){var r=t.payload.available;e.props.updateIsCastAvailable(r)})),n.listen(r,r.Event.Playlist.PLAYLIST_ITEM_CHANGED,(function(){e.props.updatePlaylist({next:r.playlist.next,prev:r.playlist.prev})})),n.listen(r,r.Event.Core.ENTER_PICTURE_IN_PICTURE,(function(){e.props.updateIsInPictureInPicture(!0)})),n.listen(r,r.Event.Core.LEAVE_PICTURE_IN_PICTURE,(function(){e.props.updateIsInPictureInPicture(!1)})),n.listen(r,r.Event.Core.PRESENTATION_MODE_CHANGED,(function(){e.props.updateIsInPictureInPicture(r.isInPictureInPicture()),e.props.updateFullscreen(r.isFullscreen())})),n.listen(r,r.Event.Core.ENTER_FULLSCREEN,(function(){e.props.updateFullscreen(!0)})),n.listen(r,r.Event.Core.EXIT_FULLSCREEN,(function(){e.props.updateFullscreen(!1)}))}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return(0,v.h)("span",null)}}]),r}(v.Component))||i)||i)||i)||i);L.displayName=O},"./src/components/engine-connector/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineConnector:function(){return n.EngineConnector}});var n=r("./src/components/engine-connector/engine-connector.tsx")},"./src/components/error-overlay/error-message-provider.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{getErrorDetailsByCategory:function(){return i}});var n=new Map([[1,{title:"network_error_title",message:"network_error_message"}],[2,{title:"text_error_title",message:"text_error_message"}],[3,{title:"media_error_title",message:"media_error_message"}],[4,{title:"manifest_error_title",message:"manifest_error_message"}],[5,{title:"streaming_error_title",message:"streaming_error_message"}],[6,{title:"media_unavailable_error_title",message:"drm_error_message"}],[7,{title:"default_error_title",message:"default_error_message"}],[8,{title:"default_error_title",message:"default_error_message"}],[9,{title:"default_error_title",message:"default_error_message"}],[12,{title:"media_not_ready_error_title",message:"media_not_ready_error_message"}],[13,{title:"geo_location_error_title",message:"geo_location_error_message"}],[14,{title:"media_unavailable_error_title",message:"media_unavailable_error_message"}]]),a={title:"default_error_title",message:"default_error_message"},i=function(e){return n.get(e)||a}},"./src/components/error-overlay/error-overlay.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ErrorOverlay:function(){return L}});var n,a,i,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/react-redux/es/index.js"),A=r("./src/components/overlay/index.ts"),S=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),C=r("./src/utils/bind-actions.ts"),P=r("./src/reducers/engine.ts"),x=r("./src/components/copy-button/index.ts"),w=r("./src/components/logger/index.ts"),I=r("./src/components/player/index.ts"),M=r("./src/components/button/index.ts"),R=r("./src/components/error-overlay/error-message-provider.ts");function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var O="ErrorOverlay",L=(n=(0,T.connect)((function(e){var t;return{hasError:e.engine.hasError,errorOverlaConfig:null===(t=e.config.components)||void 0===t?void 0:t.errorOverlay,errorDetails:e.engine.errorDetails}}),(0,C.bindActions)(P.actions)),a=(0,w.withLogger)(O),n(i=(0,I.withPlayer)(i=a(i=function(e){h()(r,e);var t=D(r);function r(){var e;s()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(d()(e),"sessionEl",void 0),_()(d()(e),"copyError",(function(){var t=window.getSelection(),r=document.createRange();r.selectNode(e.sessionEl),t.removeAllRanges(),t.addRange(r),document.execCommand("copy")})),_()(d()(e),"handleClick",(function(){var t=e.props.player.getMediaInfo();e.props.player.loadMedia(t)})),_()(d()(e),"getBackgroundUrl",(function(){var t=e.props.errorOverlaConfig;return null==t?void 0:t.backgroundUrl})),e}return u()(r,[{key:"renderSessionID",value:function(){var e=this,t=this.props.player,r=t&&t.config&&t.config.session&&t.config.session.id;return r?(0,b.h)("div",{className:E().linkOptionsContainer},(0,b.h)("div",{className:E().copyUrlRow},(0,b.h)("div",{ref:function(t){return t?e.sessionEl=t:void 0},className:E().errorSession},(0,b.h)(S.Text,{id:"error.default_session_text"})," "," "+r),(0,b.h)(x.CopyButton,{copy:this.copyError}))):void 0}},{key:"renderRetryButton",value:function(){if(this.props.player.getMediaInfo()){var e=Boolean(this.getBackgroundUrl());return(0,b.h)("div",{className:E().controlButtonContainer,onClick:this.handleClick},(0,b.h)(M.Button,{className:[e?E().btnTranslucent:E().btnBorderless,E().retryBtn].join(" ")},(0,b.h)(S.Text,{id:"error.retry"})))}}},{key:"renderErrorHead",value:function(){var e=this.props.errorDetails,t=e.errorCategory,r=e.errorTitle,n=e.errorMessage,a="",i="";if(r&&n)a=r,i=n;else{var o=(0,R.getErrorDetailsByCategory)(t);a=(0,b.h)(S.Text,{id:"error.".concat(o.title)}),i=(0,b.h)(S.Text,{id:"error.".concat(o.message)})}return(0,b.h)("div",{className:E().headline},(0,b.h)("div",{className:E().errorTitle},this.props.errorHead||a),i?(0,b.h)("div",{className:E().errorMessage},i):void 0)}},{key:"render",value:function(){if(this.props&&this.props.hasError||this.props.permanent){var e=this.getBackgroundUrl(),t=e?{backgroundImage:"url(".concat(e,")")}:void 0;return(0,b.h)("div",{className:["overlay-portal",e?E().customErrorSlate:""].join(" ")},(0,b.h)(A.Overlay,{open:!0,permanent:!0,type:"error"},(0,b.h)("div",{className:E().errorOverlay,style:t},(0,b.h)("p",{className:E().errorText}),this.renderErrorHead(),this.renderSessionID(),this.renderRetryButton())))}}}]),r}(b.Component))||i)||i)||i);L.displayName=O},"./src/components/error-overlay/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ErrorOverlay:function(){return n.ErrorOverlay}});var n=r("./src/components/error-overlay/error-overlay.tsx")},"./src/components/event-dispatcher/event-dispatcher-provider.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{EventDispatcherProvider:function(){return D}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("@playkit-js/playkit-js"),_=r("./src/event/index.ts"),k=r("./src/event/events/audio-selected-event.ts"),E=r("./src/event/events/caption-selected-event.ts"),b=r("./src/event/events/quality-selected-event.ts"),T=r("./src/event/events/seeked-event.ts"),A=r("./src/event/events/speed-selected-event.ts"),S=r("./src/event/events/ui-visibility-changed-event.ts"),C=r("./src/event/events/rewind-clicked.ts"),P=r("./src/event/events/forward-clicked.ts"),x=r("./src/event/events/volume-changed.ts"),w=r("./src/utils/index.ts"),I=r("./src/utils/is-equal.ts"),M=r("./node_modules/preact/dist/preact.module.js");function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var D=function(e){d()(r,e);var t=R(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"_notifyClick",(function(t){return function(e,t,r){switch(t.name){case"Keyboard":j[t.payload.key](e,t,r);break;case"OverlayAction":!function(e,t,r){"PlayPause"===t.payload.type?O(e,0,r):"Fullscreen"===t.payload.type&&N(0,0,r)}(e,t,r);break;case"CVAAOverlay":!function(e,t,r){var n,a=r.textStyle,i=null===(n=t.payload)||void 0===n?void 0:n.textStyle;[{key:"fontSize",eventType:_.EventType.USER_SELECTED_CAPTIONS_SIZE},{key:"textAlign",eventType:_.EventType.USER_SELECTED_CAPTIONS_ALIGNMENT},{key:"fontFamily",eventType:_.EventType.USER_SELECTED_CAPTIONS_FONT_FAMILY},{key:"fontOpacity",eventType:_.EventType.USER_SELECTED_CAPTIONS_FONT_OPACITY},{key:"backgroundOpacity",eventType:_.EventType.USER_SELECTED_CAPTIONS_BACKGROUND_OPACITY},{key:"backgroundColor",eventType:_.EventType.USER_SELECTED_CAPTIONS_BACKGROUND_COLOR,collection:r.TextStyle.StandardColors},{key:"fontColor",eventType:_.EventType.USER_SELECTED_CAPTIONS_FONT_COLOR,collection:r.TextStyle.StandardColors},{key:"fontEdge",eventType:_.EventType.USER_SELECTED_CAPTIONS_FONT_STYLE,collection:r.TextStyle.EdgeStyles}].map((function(e){var t=e.key,n=e.eventType,o=e.collection;o&&!(0,I.default)(null==a?void 0:a[t],null==i?void 0:i[t])?Object.keys(o).some((function(e){if((0,I.default)(o[e],null==i?void 0:i[t]))return r.dispatchEvent(new v.FakeEvent(n,e.toLowerCase())),!0})):(null==a?void 0:a[t])!==(null==i?void 0:i[t])&&r.dispatchEvent(new v.FakeEvent(n,null==i?void 0:i[t]))}))}(0,t,r);break;case"Fullscreen":N(0,0,r);break;case"CaptionsMenu":!function(e,t,r){t.payload.type===r.Track.TEXT&&r.dispatchEvent(new E.CaptionSelectedEvent(t.payload.track))}(0,t,r);break;case"AudioMenu":!function(e,t,r){t.payload.type===r.Track.AUDIO&&r.dispatchEvent(new k.AudioSelectedEvent(t.payload.track))}(0,t,r);break;case"QualityMenu":!function(e,t,r){t.payload.type===r.Track.VIDEO&&r.dispatchEvent(new b.QualitySelectedEvent(t.payload.track))}(0,t,r);break;case"SpeedMenu":!function(e,t,r){"speed"===t.payload.type&&r.dispatchEvent(new A.SpeedSelectedEvent(t.payload.speed))}(0,t,r);break;case"AdvancedAudioDescToggle":case"AdvancedAudioDesc":!function(e,t,r){"AdvancedAudioDescription"===t.payload.type&&r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_ADVANCED_AUDIO_DESCRIPTION,t.payload))}(0,t,r);break;case"Shell":r.dispatchEvent(new v.FakeEvent(_.EventType.UI_CLICKED));break;case"Rewind":r.dispatchEvent(new C.RewindClickedEvent(t.payload.from,t.payload.to));break;case"Forward":r.dispatchEvent(new P.ForwardClickedEvent(t.payload.from,t.payload.to));break;case"LiveTag":r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_LIVE_TAG));break;case"Logo":r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_LOGO,t.payload));break;case"PrePlaybackPlayOverlay":case"PlayPause":O(e,0,r);break;case"Volume":L(e,0,r);break;case"PictureInPicture":U(0,0,r);break;case"ClosedCaptions":!function(e,t,r){var n=t.payload;n?r.dispatchEvent(new v.FakeEvent(_.EventType.USER_HID_CAPTIONS)):r.dispatchEvent(new v.FakeEvent(_.EventType.USER_SHOWED_CAPTIONS))}(0,t,r)}}(e.props.store,t,e.props.player)})),y()(u()(e),"_notifyChange",(function(t){return function(e,t,r){switch(t.name){case"Volume":r.dispatchEvent(new x.VolumeChangedEvent(t.payload.volume));break;case"SeekBarPlaybackContainer":case"SeekBarLivePlaybackContainer":r.dispatchEvent(new T.SeekedEvent(t.payload.from,t.payload.to));break;case"ActivePreset":r.dispatchEvent(new v.FakeEvent(_.EventType.UI_PRESET_CHANGE,t.payload))}}(e.props.store,t,e.props.player)})),y()(u()(e),"_notifyHoverChange",(function(t){return r=e.props.store,n=t,a=e.props.player,i=r.getState().engine,o=r.getState().shell,void(!i.adBreak&&i.isPlaying&&o.playerHover!==n.payload.hover&&a.dispatchEvent(new S.UIVisibilityChangedEvent(n.payload.hover)));var r,n,a,i,o})),e}return s()(r,[{key:"getChildContext",value:function(){return{notifyClick:this._notifyClick,notifyChange:this._notifyChange,notifyHoverChange:this._notifyHoverChange}}},{key:"render",value:function(){return this.props.children&&(0,M.toChildArray)(this.props.children)[0]||null}}]),r}(M.Component);function O(e,t,r){var n=e.getState().engine;n.adBreak?n.adIsPlaying?r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_PAUSE)):r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_PLAY)):n.isPlaying?r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_PAUSE)):r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_PLAY))}function L(e,t,r){e.getState().engine.muted?r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_MUTE)):r.dispatchEvent(new v.FakeEvent(_.EventType.USER_CLICKED_UNMUTE))}function N(e,t,r){r.isFullscreen()?r.dispatchEvent(new v.FakeEvent(_.EventType.USER_EXITED_FULL_SCREEN)):r.dispatchEvent(new v.FakeEvent(_.EventType.USER_ENTERED_FULL_SCREEN))}function U(e,t,r){r.isInPictureInPicture()?r.dispatchEvent(new v.FakeEvent(_.EventType.USER_EXITED_PICTURE_IN_PICTURE)):r.dispatchEvent(new v.FakeEvent(_.EventType.USER_ENTERED_PICTURE_IN_PICTURE))}var j=(n={},y()(n,w.KeyMap.SPACE,(function(e,t,r){O(e,0,r)})),y()(n,w.KeyMap.UP,(function(e,t,r){r.dispatchEvent(new x.VolumeChangedEvent(t.payload.volume))})),y()(n,w.KeyMap.DOWN,(function(e,t,r){r.dispatchEvent(new x.VolumeChangedEvent(t.payload.volume))})),y()(n,w.KeyMap.F,(function(e,t,r){N(0,0,r)})),y()(n,w.KeyMap.P,(function(e,t,r){U(0,0,r)})),y()(n,w.KeyMap.ESC,(function(e,t,r){N(0,0,r)})),y()(n,w.KeyMap.LEFT,(function(e,t,r){r.dispatchEvent(new T.SeekedEvent(t.payload.from,t.payload.to))})),y()(n,w.KeyMap.RIGHT,(function(e,t,r){r.dispatchEvent(new T.SeekedEvent(t.payload.from,t.payload.to))})),y()(n,w.KeyMap.HOME,(function(e,t,r){r.dispatchEvent(new T.SeekedEvent(t.payload.from,t.payload.to))})),y()(n,w.KeyMap.END,(function(e,t,r){r.dispatchEvent(new T.SeekedEvent(t.payload.from,t.payload.to))})),y()(n,w.KeyMap.M,(function(e,t,r){L(e,0,r)})),y()(n,w.KeyMap.SEMI_COLON,(function(e,t,r){r.dispatchEvent(new A.SpeedSelectedEvent(t.payload.speed))})),y()(n,w.KeyMap.PERIOD,(function(e,t,r){r.dispatchEvent(new A.SpeedSelectedEvent(t.payload.speed))})),y()(n,w.KeyMap.COMMA,(function(e,t,r){r.dispatchEvent(new A.SpeedSelectedEvent(t.payload.speed))})),y()(n,w.KeyMap.C,(function(e,t,r){r.dispatchEvent(new E.CaptionSelectedEvent(t.payload.track))})),n)},"./src/components/event-dispatcher/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EventDispatcherProvider:function(){return n.EventDispatcherProvider},withEventDispatcher:function(){return a.withEventDispatcher}});var n=r("./src/components/event-dispatcher/event-dispatcher-provider.tsx"),a=r("./src/components/event-dispatcher/with-event-dispatcher.tsx")},"./src/components/event-dispatcher/with-event-dispatcher.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withEventDispatcher:function(){return y}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/preact/dist/preact.module.js");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var y=function(e){return function(t){return function(r){c()(i,r);var n=g(i);function i(){return o()(this,i),n.apply(this,arguments)}return l()(i,[{key:"notifyClick",value:function(t){this.context.notifyClick({name:e,payload:t})}},{key:"notifyChange",value:function(t){this.context.notifyChange({name:e,payload:t})}},{key:"notifyHoverChange",value:function(t){this.context.notifyHoverChange({name:e,payload:t})}},{key:"render",value:function(){var e=this;return(0,m.h)(t,a()({},this.props,{notifyHoverChange:function(t){return e.notifyHoverChange(t)},notifyChange:function(t){return e.notifyChange(t)},notifyClick:function(t){return e.notifyClick(t)}}))}}]),i}(m.Component)}}},"./src/components/expandable-text/expandable-text.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ExpandableText:function(){return v}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/extends.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),l=r.n(s),u=r("./node_modules/preact/dist/preact.module.js"),c=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),d=r("./node_modules/preact/hooks/dist/hooks.module.js"),p=r("./src/utils/index.ts"),h=r("./src/styles/style.scss"),f=r.n(h),m=p.KeyMap.ENTER,g=p.KeyMap.SPACE,y=function(e){var t=e.isTextExpanded,r=e.readLessLabel,n=e.readMoreLabel,a=e.onClick,i=e.onKeyDown,s=l()(e,["isTextExpanded","readLessLabel","readMoreLabel","onClick","onKeyDown"]);return(0,u.h)("div",o()({className:f().moreButtonText,onClick:a,onKeyDown:i},s),t?r:n)},v=(0,c.withText)({readMoreLabel:"controls.readMore",readLessLabel:"controls.readLess"})((function(e){var t=(0,d.useState)(!1),r=a()(t,2),n=r[0],i=r[1],s=(0,d.useState)(!1),l=a()(s,2),c=l[0],p=l[1],h=(0,d.useState)(!1),v=a()(h,2),_=v[0],k=v[1],E=(0,d.useRef)(null),b=(0,d.useRef)(null);(0,d.useLayoutEffect)((function(){var e,t;(null==b?void 0:b.current)&&(null==E?void 0:E.current)&&(k(!0),p((null==b||null===(e=b.current)||void 0===e?void 0:e.getBoundingClientRect().height)<(null==E||null===(t=E.current)||void 0===t?void 0:t.getBoundingClientRect().height)))}),[_]);var T=function(t){e.onClick&&e.onClick(t),i((function(t){var r=!t;return e.onExpand&&e.onExpand(r),r}))};return c||e.forceShowMore?(0,u.h)("div",{className:[e.className,n?e.classNameExpanded:""].join(" ")},n?e.children:(0,u.h)("div",{className:f().expandableText,style:{"-webkit-line-clamp":e.lines}},e.text),(0,u.h)(y,o()({onClick:function(e){T(e)},onKeyDown:function(e){e.keyCode!==g&&e.keyCode!==m||T(e)},isTextExpanded:n,readLessLabel:e.readLessLabel,readMoreLabel:e.readMoreLabel},e.buttonProps))):(0,u.h)("div",{className:f().contentText},(0,u.h)("div",{className:f().titleWrapper},(0,u.h)("div",{ref:b,style:{"-webkit-line-clamp":e.lines},className:f().expandableText},e.text),_?void 0:(0,u.h)("div",{ref:E,style:{"-webkit-line-clamp":e.lines+1},className:f().expandableText},e.text)))}));v.defaultProps={buttonProps:{}},v.displayName="ExpandableText"},"./src/components/expandable-text/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ExpandableText:function(){return n.ExpandableText}});var n=r("./src/components/expandable-text/expandable-text.tsx")},"./src/components/forward/forward.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{FORWARD_DEFAULT_STEP:function(){return j},Forward:function(){return B}});var n,a,i,o,s,l,u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),C=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),P=r("./src/components/icon/index.ts"),x=r("./src/utils/with-animation.tsx"),w=r("./src/components/player/index.ts"),I=r("./src/components/event-dispatcher/index.ts"),M=r("./src/components/logger/index.ts"),R=r("./src/components/tooltip/index.ts"),D=r("./src/components/button/index.ts"),O=r("./node_modules/react-redux/es/index.js"),L=r("./src/components/button-control/index.ts");function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}var U="Forward",j=10,B=(n=(0,O.connect)((function(e){return{isDvr:e.engine.isDvr,isLive:e.engine.isLive}})),a=(0,M.withLogger)(U),i=(0,I.withEventDispatcher)(U),o=(0,x.withAnimation)(A().reverseRotate),s=(0,C.withText)((function(e){return{forwardText:(0,S.h)(C.Text,{id:"controls.secondsForward",fields:{seconds:e.step||j}})}})),n(l=(0,w.withPlayer)(l=a(l=i(l=o(l=s(l=function(e){g()(r,e);var t=N(r);function r(){var e;c()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(f()(e),"onClick",(function(){var t,r=e.props.player;e.props.animate();var n=e.props.step||j,a=r.currentTime,i=r.isLive()?r.liveDuration:r.duration;r.currentTime+n>i?r.isOnLiveEdge()||(t=i):t=r.currentTime+n,r.currentTime=t,e.props.notifyClick({from:a,to:t})})),e}return p()(r,[{key:"_shouldRender",value:function(){var e=!(this.props.isLive&&!this.props.isDvr);return this.props.onToggle(U,e),e}},{key:"render",value:function(e){var t=e.step,r=e.forwardText,n=e.innerRef;return this._shouldRender()?(0,S.h)(L.ButtonControl,{name:U,className:A().noIdleControl},(0,S.h)(R.Tooltip,{label:r},(0,S.h)(D.Button,{tabIndex:"0","aria-label":r,className:"".concat(A().controlButton),ref:n,onClick:this.onClick},(0,S.h)(P.Icon,{type:t&&t!==j?P.IconType.Forward:P.IconType.Forward10})))):void 0}}]),r}(S.Component))||l)||l)||l)||l)||l)||l);B.displayName=U},"./src/components/forward/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Forward:function(){return n.Forward}});var n=r("./src/components/forward/forward.tsx")},"./src/components/fullscreen/fullscreen.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Fullscreen:function(){return B}});var n,a,i,o,s,l,u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),C=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),P=r("./node_modules/react-redux/es/index.js"),x=r("./src/utils/key-map.ts"),w=r("./src/components/icon/index.ts"),I=r("./src/components/player/index.ts"),M=r("./src/components/keyboard/index.ts"),R=r("./src/components/logger/index.ts"),D=r("./src/components/tooltip/index.ts"),O=r("./src/components/event-dispatcher/index.ts"),L=r("./src/components/button/index.ts"),N=r("./src/components/button-control/index.ts");function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}var j="Fullscreen",B=(n=(0,P.connect)((function(e){return{isInFullscreen:e.engine.fullscreen}})),a=(0,R.withLogger)(j),i=(0,M.withKeyboardEvent)(j),o=(0,O.withEventDispatcher)(j),s=(0,C.withText)({fullscreenText:"controls.fullscreen",fullscreenExitText:"controls.fullscreenExit"}),n(l=(0,I.withPlayer)(l=a(l=i(l=o(l=s(l=function(e){g()(r,e);var t=U(r);function r(){var e;c()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(f()(e),"_keyboardEventHandlers",[{key:{code:x.KeyMap.ENTER},action:function(t){e.handleKeydown(t)}},{key:{code:x.KeyMap.F},action:function(t){e.handleKeydown(t)}},{key:{code:x.KeyMap.ESC},action:function(t){e.handleKeydown(t)}}]),b()(f()(e),"toggleFullscreen",(function(){var t=e.props,r=t.logger,n=t.player;r.debug("Toggle fullscreen"),n.isFullscreen()?n.exitFullscreen():n.enterFullscreen(),e.props.notifyClick()})),e}return p()(r,[{key:"componentDidMount",value:function(){this.props.registerKeyboardEvents(this._keyboardEventHandlers)}},{key:"handleKeydown",value:function(e){switch(e.keyCode){case x.KeyMap.ENTER:e.repeat||this.toggleFullscreen();case x.KeyMap.F:this.props.player.isFullscreen()||this.toggleFullscreen();break;case x.KeyMap.ESC:this.props.player.isFullscreen()&&this.toggleFullscreen()}}},{key:"render",value:function(){return(0,S.h)(N.ButtonControl,{name:j},(0,S.h)(D.Tooltip,{label:this.props.isInFullscreen?this.props.fullscreenExitText:this.props.fullscreenText},(0,S.h)(L.Button,{tabIndex:"0","aria-label":this.props.isInFullscreen?this.props.fullscreenExitText:this.props.fullscreenText,className:this.props.isInFullscreen?[A().controlButton,A().isFullscreen].join(" "):A().controlButton,onClick:this.toggleFullscreen},(0,S.h)(w.Icon,{type:w.IconType.Maximize}),(0,S.h)(w.Icon,{type:w.IconType.Minimize}))))}}]),r}(S.Component))||l)||l)||l)||l)||l)||l);B.displayName=j},"./src/components/fullscreen/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Fullscreen:function(){return n.Fullscreen}});var n=r("./src/components/fullscreen/fullscreen.tsx")},"./src/components/gui-area/gui-area.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{GuiArea:function(){return A}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./src/components/player-area/index.ts"),E=r("./src/styles/style.scss"),b=r.n(E);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var A=(0,_.connect)((function(e){return{guiStyles:e.shell.layoutStyles.gui}}))(n=function(e){d()(r,e);var t=T(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"_ref",void 0),y()(u()(e),"_setRef",(function(t){t&&(e._ref=t,e.setState((function(e){return{render:!e.render}})))})),e}return s()(r,[{key:"shouldComponentUpdate",value:function(e,t){return e.guiStyles!==this.props.guiStyles||t.render!==this.state.render}},{key:"render",value:function(){var e=this.props,t=e.guiStyles,r=e.children,n=(0,v.toChildArray)(r),a=n[0],i=n[1];return(0,v.h)("div",{ref:this._setRef,style:t,className:b().guiArea},(0,v.h)("div",{style:{pointerEvents:"auto"}},(0,v.h)(k.PlayerArea,{name:"GuiArea"},a)),"function"==typeof i?i({containerRef:this._ref}):i)}}]),r}(v.Component))||n},"./src/components/gui-area/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{GuiArea:function(){return n.GuiArea}});var n=r("./src/components/gui-area/gui-area.tsx")},"./src/components/icon/icon.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{BadgeType:function(){return P},Icon:function(){return w},IconState:function(){return x},IconType:function(){return C}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./src/styles/style.scss"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./src/index.ts");function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){v()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var C={Maximize:"maximize",Minimize:"minimize",Play:"play",Pause:"pause",VolumeBase:"volume-base",VolumeWaves:"volume-waves",VolumeWave:"volume-wave",VolumeMute:"volume-mute",Close:"close",Settings:"settings",Check:"check",CheckActive:"check-active",Language:"language",Quality:"quality",Captions:"captions",Speed:"speed",SpeedDown:"speed-down",SpeedUp:"speed-up",Audio:"audio",ArrowDown:"arrow-down",StartOver:"start-over",SeekEnd:"seek-end",Rewind:"rewind",Rewind10:"rewind10",Forward:"forward",Forward10:"forward10",vrStereo:"vr-stereo",vrStereoFull:"vr-stereo-full",Cast:"cast",CastBrand:"cast-brand",Next:"next",Prev:"prev",PictureInPictureStart:"picture-in-picture-start",PictureInPictureStop:"picture-in-picture-stop",ClosedCaptionsOn:"closed-captions-on",ClosedCaptionsOff:"closed-captions-off",AdvancedAudioDescription:"advanced-audio-description",AdvancedAudioDescriptionActive:"advanced-audio-description-active"},P={qualityHd:"".concat(k().badgeIcon," ").concat(k().iconQualityHd),qualityHdActive:"".concat(k().badgeIcon," ").concat(k().iconQualityHdActive),quality4k:"".concat(k().badgeIcon," ").concat(k().iconQuality4K),quality4kActive:"".concat(k().badgeIcon," ").concat(k().iconQuality4KActive),quality8k:"".concat(k().badgeIcon," ").concat(k().iconQuality8K),quality8kActive:"".concat(k().badgeIcon," ").concat(k().iconQuality8KActive)},x={INACTIVE:0,ACTIVE:1},w=function(e){p()(r,e);var t=S(r);function r(e){var n;o()(this,r),n=t.call(this,e),v()(c()(n),"_defaultColor",k().white),v()(c()(n),"_activeColor",k().brandColor),v()(c()(n),"_className",""),v()(c()(n),"createDynamicIconClass",(function(e){var t=e.path,r=e.state,a=e.color,i=e.activeColor,o=e.width,s=e.height,l=e.viewBox,u=e.fillRule,c=n.getFillColor(r,a,i),d=n.getPathTag(t,c),p=n.getSVGUrl(d,o,s,l,u),h=".".concat(n._className," { background-image: ").concat(p,"; }"),f=document.getElementById(b.NAME);f&&f.appendChild(document.createTextNode(h))})),v()(c()(n),"getSVGUrl",(function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:36,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:36,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"nonzero",a='<svg xmlns="http://www.w3.org/2000/svg"  xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="'.concat(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"0 0 1024 1024",'" width="').concat(t,'" height="').concat(r,'" fill-rule="').concat(n,'">').concat(e,"</svg>"),i=[['"',"'"],["%","%25"],["&","%26"],["#","%23"],["{","%7B"],["}","%7D"],["<","%3C"],[">","%3E"]],o=2e3,s=Math.ceil(a.length/o),l=0,u="",c=0;c<s;c++){for(var d=a.slice(l,l+o-1),p=0;p<i.length;p++)d=d.split(i[p][0]).join(i[p][1]);u="".concat(u).concat(d),l+=o}return'url("data:image/svg+xml,'.concat(u,'")')})),v()(c()(n),"getFillColor",(function(e,t,r){return e===x.ACTIVE?r||n._activeColor:t||n._defaultColor})),v()(c()(n),"getPathTag",(function(e,t){return Array.isArray(e)||(e=[e]),e.map((function(e){var r="string"==typeof e?{d:e,fill:t}:A(A({},e),{},{fill:t}),n=Object.keys(r).map((function(e){return"".concat(e,'="').concat(r[e],'"')})).join(" ");return"<path ".concat(n," />")})).join(" ")}));var a=e.path,i=e.id;if(a&&i){n._className="playkit-icon-".concat(i);var s=Array.from(document.styleSheets).find((function(e){return e.ownerNode.id===b.NAME}));s&&Array.from(s.rules).find((function(e){return e.selectorText===".".concat(n._className)}))||n.createDynamicIconClass(e)}return n}return l()(r,[{key:"componentWillUpdate",value:function(e){this._className&&this.props.state!==e.state&&this.createDynamicIconClass(e)}},{key:"render",value:function(e){if(this._className)return(0,E.h)("i",a()({className:[k().icon,this._className].join(" ")},e.hidden?{"aria-hidden":"true"}:{}));switch(e.type){case C.Maximize:return(0,E.h)("i",{className:[k().icon,k().iconMaximize].join(" "),"aria-hidden":"true"});case C.Minimize:return(0,E.h)("i",{className:[k().icon,k().iconMinimize].join(" "),"aria-hidden":"true"});case C.Play:return(0,E.h)("i",{className:[k().icon,k().iconPlay].join(" "),"aria-hidden":"true"});case C.Pause:return(0,E.h)("i",{className:[k().icon,k().iconPause].join(" "),"aria-hidden":"true"});case C.VolumeBase:return(0,E.h)("i",{className:[k().icon,k().iconVolumeBase].join(" "),"aria-hidden":"true"});case C.VolumeWaves:return(0,E.h)("i",{className:[k().icon,k().iconVolumeWaves].join(" "),"aria-hidden":"true"});case C.VolumeWave:return(0,E.h)("i",{className:[k().icon,k().iconVolumeWave].join(" "),"aria-hidden":"true"});case C.VolumeMute:return(0,E.h)("i",{className:[k().icon,k().iconVolumeMute].join(" "),"aria-hidden":"true"});case C.Close:return(0,E.h)("i",{className:[k().icon,k().iconClose].join(" "),"aria-hidden":"true"});case C.Settings:return(0,E.h)("i",{className:[k().icon,k().iconSettings].join(" "),"aria-hidden":"true"});case C.Check:return(0,E.h)("i",{className:[k().icon,k().iconCheck].join(" ")});case C.CheckActive:return(0,E.h)("i",{className:[k().icon,k().iconCheckActive].join(" ")});case C.Language:return(0,E.h)("i",{className:[k().icon,k().iconLanguage].join(" "),"aria-hidden":"true"});case C.Quality:return(0,E.h)("i",{className:[k().icon,k().iconQuality].join(" ")});case C.Captions:return(0,E.h)("i",{className:[k().icon,k().iconCaptions].join(" ")});case C.Speed:return(0,E.h)("i",{className:[k().icon,k().iconSpeed].join(" ")});case C.SpeedDown:return(0,E.h)("i",{className:[k().icon,k().iconSpeedDown].join(" ")});case C.SpeedUp:return(0,E.h)("i",{className:[k().icon,k().iconSpeedUp].join(" ")});case C.Audio:return(0,E.h)("i",{className:[k().icon,k().iconAudio].join(" ")});case C.ArrowDown:return(0,E.h)("i",{className:[k().icon,k().iconArrowDown].join(" ")});case C.StartOver:return(0,E.h)("i",{className:[k().icon,k().iconStartOver].join(" ")});case C.SeekEnd:return(0,E.h)("i",{className:[k().icon,k().iconSeekEnd].join(" ")});case C.Rewind:return(0,E.h)("i",{className:[k().icon,k().iconRewind].join(" "),"aria-hidden":"true"});case C.Rewind10:return(0,E.h)("i",{className:[k().icon,k().iconRewind10].join(" "),"aria-hidden":"true"});case C.Forward:return(0,E.h)("i",{className:[k().icon,k().iconForward].join(" "),"aria-hidden":"true"});case C.Forward10:return(0,E.h)("i",{className:[k().icon,k().iconForward10].join(" "),"aria-hidden":"true"});case C.vrStereo:return(0,E.h)("i",{className:[k().icon,k().iconVrStereo].join(" ")});case C.vrStereoFull:return(0,E.h)("i",{className:[k().icon,k().iconVrStereoFull].join(" ")});case C.Cast:return(0,E.h)("i",{className:[k().icon,k().iconChromecast].join(" ")});case C.CastBrand:return(0,E.h)("i",{className:[k().icon,k().iconChromecastBrand].join(" ")});case C.Next:return(0,E.h)("i",{className:[k().icon,k().iconNext].join(" ")});case C.Prev:return(0,E.h)("i",{className:[k().icon,k().iconPrev].join(" ")});case C.PictureInPictureStart:return(0,E.h)("i",{className:[k().icon,k().iconPictureInPictureStart].join(" "),"aria-hidden":"true"});case C.PictureInPictureStop:return(0,E.h)("i",{className:[k().icon,k().iconPictureInPictureStop].join(" "),"aria-hidden":"true"});case C.ClosedCaptionsOn:return(0,E.h)("i",{className:[k().icon,k().iconClosedCaptionsOn].join(" "),"aria-hidden":"true"});case C.ClosedCaptionsOff:return(0,E.h)("i",{className:[k().icon,k().iconClosedCaptionsOff].join(" "),"aria-hidden":"true"});case C.AdvancedAudioDescription:return(0,E.h)("i",{className:[k().icon,k().iconAdvancedAudioDescription].join(" ")});case C.AdvancedAudioDescriptionActive:return(0,E.h)("i",{className:[k().icon,k().iconAdvancedAudioDescriptionActive].join(" ")})}}}]),r}(E.Component);t.default=w},"./src/components/icon/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{BadgeType:function(){return n.BadgeType},Icon:function(){return n.Icon},IconState:function(){return n.IconState},IconType:function(){return n.IconType}});var n=r("./src/components/icon/icon.tsx");t.default=n.default},"./src/components/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdLearnMore:function(){return h.AdLearnMore},AdNotice:function(){return m.AdNotice},AdSkip:function(){return f.AdSkip},AdvancedAudioDesc:function(){return ue.AdvancedAudioDesc},AdvancedAudioDescToggle:function(){return le.AdvancedAudioDescToggle},AudioMenu:function(){return ae.AudioMenu},BadgeType:function(){return A.BadgeType},BaseComponent:function(){return g.BaseComponent},BottomBar:function(){return y.BottomBar},Button:function(){return re.Button},ButtonControl:function(){return te.ButtonControl},CVAAOverlay:function(){return v.CVAAOverlay},CaptionsControl:function(){return _e.CaptionsControl},CaptionsMenu:function(){return ie.CaptionsMenu},Cast:function(){return n.Cast},CastAfterPlay:function(){return Y.CastAfterPlay},CastBeforePlay:function(){return Y.CastBeforePlay},CastControl:function(){return n.Cast},CastOverlay:function(){return q.CastOverlay},ClosedCaptions:function(){return p.ClosedCaptions},ClosedCaptionsControl:function(){return p.ClosedCaptions},CopyButton:function(){return ee.CopyButton},DropDown:function(){return _.DropDown},EngineConnector:function(){return k.EngineConnector},ErrorOverlay:function(){return E.ErrorOverlay},EventDispatcherProvider:function(){return b.EventDispatcherProvider},ExpandableText:function(){return ce.ExpandableText},Forward:function(){return s.Forward},ForwardControl:function(){return s.Forward},Fullscreen:function(){return a.Fullscreen},FullscreenControl:function(){return a.Fullscreen},GuiArea:function(){return ge.GuiArea},HeightResolution:function(){return se.HeightResolution},Icon:function(){return A.Icon},IconState:function(){return A.IconState},IconType:function(){return A.IconType},InteractiveArea:function(){return ye.InteractiveArea},Keyboard:function(){return T.Keyboard},KeyboardControl:function(){return T.Keyboard},KeyboardEventProvider:function(){return T.KeyboardEventProvider},LiveTag:function(){return S.LiveTag},Loading:function(){return C.Loading},Logo:function(){return z.Logo},Menu:function(){return P.Menu},Overlay:function(){return x.Overlay},OverlayAction:function(){return w.OverlayAction},OverlayPortal:function(){return I.OverlayPortal},PLAYER_BREAK_POINTS:function(){return N.PLAYER_BREAK_POINTS},PLAYER_SIZE:function(){return N.PLAYER_SIZE},PictureInPicture:function(){return Q.PictureInPicture},PlayPause:function(){return i.PlayPause},PlayPauseControl:function(){return i.PlayPause},PlaybackControls:function(){return J.PlaybackControls},PlayerArea:function(){return fe.PlayerArea},PlayerProvider:function(){return M.PlayerProvider},PlaylistButton:function(){return X.PlaylistButton},PlaylistNextScreen:function(){return Z.PlaylistNextScreen},PrePlaybackPlayOverlay:function(){return R.PrePlaybackPlayOverlay},PrevNext:function(){return X.PrevNext},ProgressIndicator:function(){return pe.ProgressIndicator},QualityMenu:function(){return se.QualityMenu},Remove:function(){return fe.Remove},Rewind:function(){return o.Rewind},RewindControl:function(){return o.Rewind},Scrollable:function(){return de.Scrollable},SeekBar:function(){return l.SeekBar},SeekBarControl:function(){return l.SeekBar},SeekBarLivePlaybackContainer:function(){return D.SeekBarLivePlaybackContainer},SeekBarPlaybackContainer:function(){return O.SeekBarPlaybackContainer},SeekBarPreview:function(){return he.SeekBarPreview},Settings:function(){return u.Settings},SettingsControl:function(){return u.Settings},Shell:function(){return N.Shell},SidePanel:function(){return ve.SidePanel},Slider:function(){return U.Slider},SmartContainer:function(){return j.SmartContainer},SmartContainerItem:function(){return j.SmartContainerItem},SpeedMenu:function(){return oe.SpeedMenu},TimeDisplay:function(){return B.TimeDisplay},TimeDisplayAdsContainer:function(){return F.TimeDisplayAdsContainer},TimeDisplayPlaybackContainer:function(){return V.TimeDisplayPlaybackContainer},ToggleSwitch:function(){return ne.ToggleSwitch},ToolTipType:function(){return H.ToolTipType},Tooltip:function(){return H.Tooltip},TopBar:function(){return G.TopBar},UnmuteIndication:function(){return $.UnmuteIndication},VideoArea:function(){return me.VideoArea},VideoPlayer:function(){return K.VideoPlayer},Volume:function(){return c.Volume},VolumeControl:function(){return c.Volume},VrStereo:function(){return d.VrStereo},VrStereoControl:function(){return d.VrStereo},Watermark:function(){return W.Watermark},getLabelBadgeType:function(){return se.getLabelBadgeType},withEventDispatcher:function(){return b.withEventDispatcher},withKeyboardEvent:function(){return T.withKeyboardEvent},withLogger:function(){return L.withLogger},withPlayer:function(){return M.withPlayer},withPlayerPreset:function(){return fe.withPlayerPreset}});var n=r("./src/components/cast/index.ts"),a=r("./src/components/fullscreen/index.ts"),i=r("./src/components/play-pause/index.ts"),o=r("./src/components/rewind/index.ts"),s=r("./src/components/forward/index.ts"),l=r("./src/components/seekbar/index.ts"),u=r("./src/components/settings/index.ts"),c=r("./src/components/volume/index.ts"),d=r("./src/components/vr-stereo/index.ts"),p=r("./src/components/closed-captions/index.ts"),h=r("./src/components/ad-learn-more/index.ts"),f=r("./src/components/ad-skip/index.ts"),m=r("./src/components/ad-notice/index.tsx"),g=r("./src/components/base.tsx"),y=r("./src/components/bottom-bar/index.ts"),v=r("./src/components/cvaa-overlay/index.ts"),_=r("./src/components/dropdown/index.ts"),k=r("./src/components/engine-connector/index.ts"),E=r("./src/components/error-overlay/index.ts"),b=r("./src/components/event-dispatcher/index.ts"),T=r("./src/components/keyboard/index.ts"),A=r("./src/components/icon/index.ts"),S=r("./src/components/live-tag/index.ts"),C=r("./src/components/loading/index.ts"),P=r("./src/components/menu/index.ts"),x=r("./src/components/overlay/index.ts"),w=r("./src/components/overlay-action/index.ts"),I=r("./src/components/overlay-portal/index.ts"),M=r("./src/components/player/index.ts"),R=r("./src/components/pre-playback-play-overlay/index.ts"),D=r("./src/components/seekbar-live-playback-container/index.ts"),O=r("./src/components/seekbar-playback-container/index.ts"),L=r("./src/components/logger/index.ts"),N=r("./src/components/shell/index.ts"),U=r("./src/components/slider/index.ts"),j=r("./src/components/smart-container/index.ts"),B=r("./src/components/time-display/index.ts"),F=r("./src/components/time-display-ads-container/index.ts"),V=r("./src/components/time-display-playback-container/index.ts"),H=r("./src/components/tooltip/index.ts"),G=r("./src/components/top-bar/index.ts"),$=r("./src/components/unmute-indication/index.ts"),K=r("./src/components/video-player/index.ts"),W=r("./src/components/watermark/index.ts"),z=r("./src/components/logo/index.ts"),q=r("./src/components/cast-overlay/index.ts"),Y=r("./src/components/cast-on-tv/index.ts"),X=r("./src/components/playlist-button/index.ts"),Z=r("./src/components/playlist-next-screen/index.ts"),Q=r("./src/components/picture-in-picture/index.ts"),J=r("./src/components/playback-controls/index.ts"),ee=r("./src/components/copy-button/index.ts"),te=r("./src/components/button-control/index.ts"),re=r("./src/components/button/index.ts"),ne=r("./src/components/toggle-switch/index.ts"),ae=r("./src/components/audio-menu/index.ts"),ie=r("./src/components/captions-menu/index.ts"),oe=r("./src/components/speed-menu/index.ts"),se=r("./src/components/quality-menu/index.ts"),le=r("./src/components/advanced-audio-desc-toggle/index.ts"),ue=r("./src/components/advanced-audio-desc/index.ts"),ce=r("./src/components/expandable-text/index.ts"),de=r("./src/components/scrollable/index.ts"),pe=r("./src/components/progress-indicator/index.ts"),he=r("./src/components/seekbar-preview/index.ts"),fe=r("./src/components/player-area/index.ts"),me=r("./src/components/video-area/index.ts"),ge=r("./src/components/gui-area/index.ts"),ye=r("./src/components/interactive-area/index.ts"),ve=r("./src/components/side-panel/index.ts"),_e=r("./src/components/captions-control/index.ts")},"./src/components/interactive-area/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{InteractiveArea:function(){return n.InteractiveArea}});var n=r("./src/components/interactive-area/interactive-area.tsx")},"./src/components/interactive-area/interactive-area.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{InteractiveArea:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/preact/dist/preact.module.js"),m=r("./src/components/player/index.ts"),g=r("./src/styles/style.scss"),y=r.n(g),v=r("./src/components/player-area/index.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k=(0,m.withPlayer)(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var e=this.props.children;return(0,f.h)("div",{className:y().interactiveArea},(0,f.h)("div",{style:{pointerEvents:"auto"}},(0,f.h)(v.PlayerArea,{name:"InteractiveArea"},e)))}}]),r}(f.Component))||n},"./src/components/keyboard/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Keyboard:function(){return n.Keyboard},KeyboardEventProvider:function(){return i.KeyboardEventProvider},withKeyboardEvent:function(){return a.withKeyboardEvent}});var n=r("./src/components/keyboard/keyboard.tsx"),a=r("./src/components/keyboard/with-keyboard-event.tsx"),i=r("./src/components/keyboard/keyboard-event-provider.tsx")},"./src/components/keyboard/keyboard-event-provider.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{KEYBOARD_EVENTS:function(){return S},KeyboardEventProvider:function(){return C}});var n,a,i,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./node_modules/preact/dist/preact.module.js"),E=r("./src/event/with-event-manager.tsx"),b=r("./src/components/logger/index.ts"),T=r("./node_modules/react-redux/es/index.js");function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var S=["keydown","keyup"],C=(n=(0,T.connect)((function(e){return{playerNav:e.shell.playerNav,overlayOpen:e.overlay.isOpen}})),a=(0,b.withLogger)("KEYBOARD_PROVIDER"),n(i=(0,E.withEventManager)(i=a(i=function(e){h()(r,e);var t=A(r);function r(){for(var e,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return s()(this,r),e=t.call.apply(t,[this].concat(a)),_()(d()(e),"_keyboardListeners",[]),_()(d()(e),"_isKeyboardEnable",!1),_()(d()(e),"_componentToHandle",null),_()(d()(e),"keyEventHandler",void 0),_()(d()(e),"_addKeyboardHandler",(function(t,r,n,a){var i=e._createKeyCode(r,n);e._keyboardListeners[i]?e.props.logger.warn("Combination of key ".concat(n.code," altKey ").concat((!!n.altKey).toString()," ctrlKey ").concat((!!n.ctrlKey).toString(),"\n      metaKey ").concat((!!n.metaKey).toString()," shiftKey ").concat((!!n.shiftKey).toString()," already exist")):e._keyboardListeners[i]={callback:a,componentName:t}})),_()(d()(e),"_removeKeyboardHandler",(function(t,r){var n=e._createKeyCode(t,r);e._keyboardListeners[n]&&delete e._keyboardListeners[n]})),_()(d()(e),"_updateIsKeyboardEnabled",(function(t){e._isKeyboardEnable=t})),_()(d()(e),"_setKeyboardEventToScope",(function(t){e._componentToHandle=t})),e}return u()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.eventManager,n=t.playerContainer;this.keyEventHandler=this._keyEventHandler.bind(this),S.forEach((function(t){r.listen(n,t,e.keyEventHandler)}))}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"_keyEventHandler",value:function(e){var t=this._createKeyCode(e.type,{code:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey}),r=e.target instanceof Node&&e.target.nodeName||"";-1!==["INPUT","SELECT","TEXTAREA"].indexOf(r)||!this._shouldHandleKeyboardEvents()||!this._keyboardListeners[t]||"function"!=typeof this._keyboardListeners[t].callback||this._componentToHandle&&this._keyboardListeners[t].componentName!==this._componentToHandle||(e.preventDefault(),e.stopPropagation(),this._keyboardListeners[t].callback(e))}},{key:"_shouldHandleKeyboardEvents",value:function(){return this._isKeyboardEnable&&!this.props.playerNav&&!this.props.overlayOpen}},{key:"_createKeyCode",value:function(e,t){var r=S.indexOf(e),n=t.altKey?1:0,a=t.ctrlKey?1:0,i=t.metaKey?1:0,o=t.shiftKey?1:0;return parseInt(""+r+t.code+n+a+i+o)}},{key:"getChildContext",value:function(){return{addKeyboardHandler:this._addKeyboardHandler,removeKeyboardHandler:this._removeKeyboardHandler,updateIsKeyboardEnabled:this._updateIsKeyboardEnabled,setKeyboardEventToScope:this._setKeyboardEventToScope}}},{key:"render",value:function(){return this.props.children&&(0,k.toChildArray)(this.props.children)[0]||null}}]),r}(k.Component))||i)||i)||i)},"./src/components/keyboard/keyboard.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{KEYBOARD_DEFAULT_SEEK_JUMP:function(){return O},KEYBOARD_DEFAULT_VOLUME_JUMP:function(){return L},Keyboard:function(){return j}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./node_modules/react-redux/es/index.js"),T=r("./src/reducers/shell.ts"),A=r("./src/reducers/overlay-action.ts"),S=r("./src/utils/bind-actions.ts"),C=r("./src/utils/key-map.ts"),P=r("./src/components/icon/index.ts"),x=r("./src/reducers/getters.ts"),w=r("./src/components/player/index.ts"),I=r("./src/components/event-dispatcher/index.ts"),M=r("./src/components/logger/index.ts");function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var O=5,L=5,N="Keyboard",U={preventDefault:!1,payload:null},j=(n=(0,b.connect)((function(e){return{isPlayingAdOrPlayback:(0,x.isPlayingAdOrPlayback)(e.engine),playerNav:e.shell.playerNav,textTracks:e.engine.textTracks,overlayOpen:e.overlay.isOpen}}),(0,S.bindActions)(Object.assign({},T.actions,A.actions))),a=(0,M.withLogger)(N),i=(0,I.withEventDispatcher)(N),n(o=(0,w.withPlayer)(o=a(o=i(o=function(e){f()(r,e);var t=D(r);function r(e){var n,a;l()(this,r),a=t.call(this),k()(p()(a),"_lastActiveTextLanguage",""),k()(p()(a),"_hoverTimeout",null),k()(p()(a),"keyboardHandlers",(n={},k()(n,C.KeyMap.SPACE,(function(){return a.props.isPlayingAdOrPlayback?(a.props.player.pause(),a.props.updateOverlayActionIcon(P.IconType.Pause)):(a.props.player.play(),a.props.updateOverlayActionIcon(P.IconType.Play)),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:!0}})),k()(n,C.KeyMap.UP,(function(){var e=(Math.round(100*a.props.player.volume)+L)/100;return e=e>1?1:e,a.props.logger.debug("Changing volume. ".concat(a.props.player.volume," => ").concat(e)),a.props.player.muted&&(a.props.player.muted=!1),a.props.player.volume=e,a.props.updateOverlayActionIcon([P.IconType.VolumeBase,P.IconType.VolumeWaves]),{preventDefault:!0,payload:{volume:a.props.player.volume}}})),k()(n,C.KeyMap.DOWN,(function(){var e=(Math.round(100*a.props.player.volume)-L)/100;return e=e<0?0:e,a.props.logger.debug("Changing volume. ".concat(a.props.player.volume," => ").concat(e)),a.props.player.volume=e,0===e?(a.props.player.muted=!0,a.props.updateOverlayActionIcon([P.IconType.VolumeBase,P.IconType.VolumeMute])):a.props.updateOverlayActionIcon([P.IconType.VolumeBase,P.IconType.VolumeWave]),{preventDefault:!0,payload:{volume:a.props.player.volume}}})),k()(n,C.KeyMap.F,(function(){return a.props.player.isFullscreen()?{preventDefault:!0,payload:null}:(a.props.logger.debug("Enter fullscreen"),a.props.player.enterFullscreen(),{preventDefault:!0,payload:!0})})),k()(n,C.KeyMap.P,(function(){return a.props.player.isInPictureInPicture()?(a.props.logger.debug("Exit Picture In Picture"),a.props.player.exitPictureInPicture()):(a.props.logger.debug("Enter Picture In Picture"),a.props.player.enterPictureInPicture()),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:!0}})),k()(n,C.KeyMap.ESC,(function(){return a.props.player.isFullscreen()?(a.props.logger.debug("Exit fullscreen"),a.props.player.exitFullscreen(),{preventDefault:!0,payload:!0}):{preventDefault:!0,payload:null}})),k()(n,C.KeyMap.LEFT,(function(){if((!a.props.player.ads||!a.props.player.ads.isAdBreak())&&(!a.props.player.isLive()||a.props.player.isDvr())){var e=a.props.player.currentTime-O,t=a.props.player.currentTime,r=e>0?e:0;return a.props.logger.debug("Seek. ".concat(t," => ").concat(r)),a.props.player.currentTime=r,a.props.updateOverlayActionIcon(P.IconType.Rewind),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:{from:t,to:r}}}return{preventDefault:!0,payload:null}})),k()(n,C.KeyMap.RIGHT,(function(){if((!a.props.player.ads||!a.props.player.ads.isAdBreak())&&(!a.props.player.isLive()||a.props.player.isDvr())){var e=a.props.player.currentTime+O,t=a.props.player.currentTime,r=e>a.props.player.duration?a.props.player.duration:e;return a.props.logger.debug("Seek. ".concat(t," => ").concat(r)),a.props.player.currentTime=e>a.props.player.duration?a.props.player.duration:e,a.props.updateOverlayActionIcon(P.IconType.Forward),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:{from:t,to:r}}}return{preventDefault:!0,payload:null}})),k()(n,C.KeyMap.HOME,(function(){if((!a.props.player.ads||!a.props.player.ads.isAdBreak())&&(!a.props.player.isLive()||a.props.player.isDvr())){var e=a.props.player.currentTime;return a.props.logger.debug("Seek. ".concat(e," => ").concat(0)),a.props.player.currentTime=0,a.props.updateOverlayActionIcon(P.IconType.StartOver),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:{from:e,to:0}}}return{preventDefault:!0,payload:null}})),k()(n,C.KeyMap.END,(function(){if((!a.props.player.ads||!a.props.player.ads.isAdBreak())&&(!a.props.player.isLive()||a.props.player.isDvr())){var e=a.props.player.currentTime,t=a.props.player.duration;return a.props.logger.debug("Seek. ".concat(e," => ").concat(t)),a.props.player.currentTime=t,a.props.updateOverlayActionIcon(P.IconType.SeekEnd),a.props.updatePlayerHoverState(!0),{preventDefault:!0,payload:{from:e,to:t}}}return{preventDefault:!0,payload:null}})),k()(n,C.KeyMap.M,(function(){return a.props.logger.debug(a.props.player.muted?"Umnute":"Mute"),a.props.player.muted=!a.props.player.muted,a.props.player.muted?a.props.updateOverlayActionIcon([P.IconType.VolumeBase,P.IconType.VolumeMute]):a.props.updateOverlayActionIcon([P.IconType.VolumeBase,P.IconType.VolumeWaves]),{preventDefault:!0,payload:!0}})),k()(n,C.KeyMap.SEMI_COLON,(function(e){return e.shiftKey?a.props.player.playbackRate!==a.props.player.defaultPlaybackRate?(a.props.logger.debug("Changing playback rate. ".concat(a.props.player.playbackRate," => ").concat(a.props.player.defaultPlaybackRate)),a.props.player.playbackRate=a.props.player.defaultPlaybackRate,a.props.updateOverlayActionIcon(P.IconType.Speed),{preventDefault:!0,payload:{speed:a.props.player.defaultPlaybackRate}}):{preventDefault:!0,payload:null}:U})),k()(n,C.KeyMap.PERIOD,(function(e){if(e.shiftKey){var t=a.props.player.playbackRate,r=a.props.player.playbackRates.indexOf(t);return r<a.props.player.playbackRates.length-1?(a.props.logger.debug("Changing playback rate. ".concat(t," => ").concat(a.props.player.playbackRates[r+1])),a.props.player.playbackRate=a.props.player.playbackRates[r+1],a.props.updateOverlayActionIcon(P.IconType.SpeedUp),{preventDefault:!0,payload:{speed:a.props.player.playbackRates[r+1]}}):{preventDefault:!0,payload:null}}return U})),k()(n,C.KeyMap.COMMA,(function(e){if(e.shiftKey){var t=a.props.player.playbackRate,r=a.props.player.playbackRates.indexOf(t);return r>0?(a.props.logger.debug("Changing playback rate. ".concat(t," => ").concat(a.props.player.playbackRates[r-1])),a.props.player.playbackRate=a.props.player.playbackRates[r-1],a.props.updateOverlayActionIcon(P.IconType.SpeedDown),{preventDefault:!0,payload:{speed:a.props.player.playbackRates[r-1]}}):{preventDefault:!0,payload:null}}return U})),k()(n,C.KeyMap.C,(function(e){var t=a.props.player.getActiveTracks().text;if(e.altKey||e.shiftKey||e.ctrlKey||e.metaKey)return U;if(t){if("off"===t.language&&a._lastActiveTextLanguage){a.props.logger.debug("Changing text track to language",a._lastActiveTextLanguage);var r=a.props.player.getTracks("text").find((function(e){return e.language===a._lastActiveTextLanguage}));return a.props.player.selectTrack(r),{preventDefault:!0,payload:{track:r}}}"off"===t.language||a._lastActiveTextLanguage||(a.props.logger.debug("Hiding text track"),a._lastActiveTextLanguage=t.language,a.props.player.hideTextTrack())}return{preventDefault:!0,payload:null}})),n));var i=document.getElementById(e.config.targetId);return i?(i.onkeydown=function(e){var t=e.target instanceof Node&&e.target.nodeName||"";if(-1===["INPUT","SELECT","TEXTAREA"].indexOf(t)&&!a.props.overlayOpen&&!a.props.playerNav&&"function"==typeof a.keyboardHandlers[e.keyCode]){a.props.logger.debug("KeyDown -> keyName: ".concat((0,C.getKeyName)(e.keyCode),", shiftKey: ").concat(e.shiftKey.toString()));var r=a.keyboardHandlers[e.keyCode](e),n=r.preventDefault,i=r.payload;n&&e.preventDefault(),i&&a.props.notifyClick(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({key:e.keyCode},i))}},a):g()(a)}return c()(r,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.textTracks.find((function(e){return e.active})),r=e.textTracks.find((function(e){return e.active}));t&&"off"!==t.language&&r&&"off"===r.language?this._lastActiveTextLanguage=t.language:r&&"off"!==r.language&&(this._lastActiveTextLanguage="")}},{key:"render",value:function(){}}]),r}(E.Component))||o)||o)||o)||o)},"./src/components/keyboard/with-keyboard-event.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withKeyboardEvent:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./src/components/keyboard/keyboard-event-provider.tsx");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var b=function(e){return function(t){return function(r){p()(i,r);var n=E(i);function i(){var t;o()(this,i);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return t=n.call.apply(n,[this].concat(a)),v()(c()(t),"keyboardEventHandlers",[]),v()(c()(t),"_updateIsKeyboardEnabled",(function(e){t.context.updateIsKeyboardEnabled(e)})),v()(c()(t),"_setKeyboardEventToScope",(function(r){r?t.context.setKeyboardEventToScope(e):t.context.setKeyboardEventToScope(null)})),t}return l()(i,[{key:"componentDidMount",value:function(){var t=this;this.keyboardEventHandlers.forEach((function(r){var n=r.eventType?r.eventType:k.KEYBOARD_EVENTS[0];t._addKeyboardHandler(e,n,r.key,r.action)}))}},{key:"componentWillUnmount",value:function(){var e=this;this.keyboardEventHandlers.forEach((function(t){var r=t.eventType?t.eventType:k.KEYBOARD_EVENTS[0];e._removeKeyboardHandler(r,t.key)}))}},{key:"registerKeyboardEvents",value:function(e){this.keyboardEventHandlers=e}},{key:"_addKeyboardHandler",value:function(e,t,r,n){this.context.addKeyboardHandler(e,t,r,n)}},{key:"_removeKeyboardHandler",value:function(e,t){this.context.removeKeyboardHandler(e,t)}},{key:"render",value:function(){var e=this;return(0,_.h)(t,a()({},this.props,{setKeyboardEventToScope:function(t){return e._setKeyboardEventToScope(t)},updateIsKeyboardEnabled:function(t){return e._updateIsKeyboardEnabled(t)},registerKeyboardEvents:function(t){return e.registerKeyboardEvents(t)}}))}}]),i}(_.Component)}}},"./src/components/live-tag/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{LiveTag:function(){return n.LiveTag}});var n=r("./src/components/live-tag/live-tag.tsx")},"./src/components/live-tag/live-tag.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{LiveTag:function(){return R}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/utils/key-map.ts"),C=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),P=r("./src/components/player/index.ts"),x=r("./src/components/event-dispatcher/index.ts"),w=r("./src/components/logger/index.ts");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var M="LiveTag",R=(n=(0,A.connect)((function(e){return{isLive:e.engine.isLive,isDvr:e.engine.isDvr,currentTime:e.engine.currentTime,duration:e.engine.duration}})),a=(0,w.withLogger)(M),i=(0,x.withEventDispatcher)(M),n(o=(0,P.withPlayer)(o=a(o=i(o=function(e){f()(r,e);var t=I(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"onKeyDown",(function(t){t.keyCode===S.KeyMap.ENTER&&e.onClick()})),k()(p()(e),"onClick",(function(){e.isOnLiveEdge()||(e.props.player.seekToLiveEdge(),e.props.player.paused&&e.props.player.play()),e.props.notifyClick()})),e}return c()(r,[{key:"isOnLiveEdge",value:function(){return this.props.player.isOnLiveEdge()}},{key:"render",value:function(e){var t=[b().liveTag];return e.isDvr&&!this.isOnLiveEdge()&&t.push(b().nonLivePlayhead),(0,T.h)("div",{tabIndex:0,className:t.join(" "),onClick:this.onClick,onKeyDown:this.onKeyDown},(0,T.h)(C.Text,{id:"controls.live"}))}}]),r}(T.Component))||o)||o)||o)||o);R.displayName=M},"./src/components/loading/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Loading:function(){return n.Loading}});var n=r("./src/components/loading/loading.tsx")},"./src/components/loading/loading.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Loading:function(){return I}});var n,a,i,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./src/styles/style.scss"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./src/utils/index.ts"),E=r("./src/reducers/loading.ts"),b=r("./src/components/player/index.ts"),T=r("./src/event/index.ts"),A=r("./src/components/logger/index.ts"),S=r("./src/components/player-area/index.ts"),C=r("./src/components/spinner/index.ts"),P=r("./src/reducers/shell.ts");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var w="Loading",I=(n=(0,_.connect)((function(e){return{show:e.loading.show,isMobile:e.shell.isMobile,adBreak:e.engine.adBreak,adIsLinear:e.engine.adIsLinear}}),(0,k.bindActions)(E.actions)),a=(0,A.withLogger)(w),n(i=(0,b.withPlayer)(i=(0,T.withEventManager)(i=a(i=function(e){d()(r,e);var t=x(r);function r(){return s()(this,r),t.call(this)}return u()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.player,n=t.eventManager;n.listen(r,r.Event.PLAYER_STATE_CHANGED,(function(t){var n=r.State;t.payload.newState.type===n.IDLE||t.payload.newState.type===n.PLAYING||t.payload.newState.type===n.PAUSED?e.props.updateLoadingSpinnerState(!1):e.props.updateLoadingSpinnerState(!0)})),n.listen(r,r.Event.AD_BREAK_START,(function(){e.props.updateLoadingSpinnerState(!0)})),n.listen(r,r.Event.AD_PROGRESS,(function(){e.props.updateLoadingSpinnerState(!1)})),n.listen(r,r.Event.AD_STARTED,(function(){e.props.adIsLinear&&e.props.updateLoadingSpinnerState(!1)})),n.listen(r,r.Event.ALL_ADS_COMPLETED,(function(){e.props.updateLoadingSpinnerState(!1)})),n.listen(r,r.Event.AUTOPLAY_FAILED,(function(){e.props.updateLoadingSpinnerState(!1)})),n.listen(r,r.Event.PLAYING,(function(){e.props.updateLoadingSpinnerState(!1)}))}},{key:"render",value:function(e){if(e.show)return(0,v.h)("div",{className:[y().loadingBackdrop,y().show].join(" ")},(0,v.h)("div",{className:y().spinnerContainer},(0,v.h)(S.PlayerArea,{name:P.ReservedPresetAreas.LoadingSpinner},(0,v.h)(C.Spinner,null))))}}]),r}(v.Component))||i)||i)||i)||i);I.displayName=w},"./src/components/logger/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{withLogger:function(){return n.withLogger}});var n=r("./src/components/logger/with-logger.tsx")},"./src/components/logger/with-logger.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withLogger:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./src/utils/logger.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var b=function(e){return function(t){return function(r){p()(i,r);var n=E(i);function i(t){var r;return o()(this,i),r=n.call(this),v()(c()(r),"logger",void 0),r.logger=(0,k.default)("UI ".concat(e)),r.logger.debug("Initialized"),r}return l()(i,[{key:"render",value:function(){return(0,_.h)(t,a()({},this.props,{logger:this.logger}))}}]),i}(_.Component)}}},"./src/components/logo/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Logo:function(){return n.Logo}});var n=r("./src/components/logo/logo.tsx")},"./src/components/logo/logo.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Logo:function(){return O}});var n,a,i,o,s,l=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/inherits.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_=r.n(v),k=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=r.n(k),b=r("./src/styles/style.scss"),T=r.n(b),A=r("./node_modules/preact/dist/preact.module.js"),S=r("./node_modules/react-redux/es/index.js"),C=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),P=r("./src/components/player/index.ts"),x=r("./src/components/logger/index.ts"),w=r("./src/event/index.ts"),I=r("./src/components/event-dispatcher/index.ts");function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_()(e);if(t){var a=_()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return y()(this,r)}}var R="Logo",D="{entryId}",O=(n=(0,S.connect)((function(e){return{isMobile:e.shell.isMobile,playerSize:e.shell.playerSize,config:e.config.components.logo}})),a=(0,x.withLogger)(R),i=(0,I.withEventDispatcher)(R),o=(0,C.withText)({logoText:"controls.logo"}),n(s=(0,P.withPlayer)(s=(0,w.withEventManager)(s=a(s=i(s=o(s=function(e){m()(r,e);var t=M(r);function r(e){var n;return u()(this,r),n=t.call(this,e),E()(h()(n),"_handleOnClick",(function(){n.props.notifyClick({logoUrl:n.state.urlLink})})),n.setState({isUrlClickable:"string"==typeof e.config.url,urlLink:e.config.url}),n}return d()(r,[{key:"componentDidMount",value:function(){this._handleLogoUrl()}},{key:"_handleLogoUrl",value:function(){var e=this,t=this.props.config.url;if(t&&-1!==t.indexOf(D)){var r=this.props,n=r.player,a=r.eventManager;this._setLogoUrlWithEntryId(t)||a.listen(n,n.Event.MEDIA_LOADED,(function(){e._setLogoUrlWithEntryId(t)}))}}},{key:"_setLogoUrlWithEntryId",value:function(e){var t=this.props.player.sources.id;return"string"==typeof t?(this.setState({urlLink:e.replace(D,t),isUrlClickable:!0}),!0):(this.props.logger.debug("Logo url was not replaced; entry id was not found."),this.setState({isUrlClickable:!1}),!1)}},{key:"_shouldRender",value:function(){var e=!(0===Object.keys(this.props.config).length&&this.props.config.constructor===Object)&&this.props.config.img;return this.props.onToggle(R,e),e}},{key:"render",value:function(e){if(this._shouldRender())return(0,A.h)("div",{className:[T().controlButtonContainer,e.config.url&&this.state.isUrlClickable?"":T().emptyUrl].join(" "),title:e.config.text},(0,A.h)("a",{onClick:this._handleOnClick,className:T().controlButton,href:this.state.urlLink,"aria-label":e.config.text||e.logoText,target:"_blank",rel:"noopener noreferrer",tabIndex:0},(0,A.h)("img",{className:T().icon,src:e.config.img})))}}]),r}(A.Component))||s)||s)||s)||s)||s)||s);O.displayName=R},"./src/components/menu/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Menu:function(){return n.Menu}});var n=r("./src/components/menu/menu.tsx")},"./src/components/menu/menu.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Menu:function(){return x}});var n,a=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./src/components/icon/index.ts"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/utils/index.ts"),C=r("./src/event/index.ts");function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var x=(0,A.connect)((function(e){return{isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize,guiClientRect:e.shell.guiClientRect}}))(n=(0,C.withEventManager)(n=(0,S.withKeyboardA11y)(n=function(e){h()(r,e);var t=P(r);function r(){var e;s()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(d()(e),"_menuElement",void 0),_()(d()(e),"handleClickOutside",(function(t){e.props.isMobile||e.props.isSmallSize||!e._menuElement||e._menuElement.contains(t.target)||e.props.onClose()})),_()(d()(e),"onChange",(function(t){e.onSelect(e.props.options[t.target.value])})),e}return u()(r,[{key:"componentWillMount",value:function(){this.setState({position:[E().top,E().left]})}},{key:"componentDidMount",value:function(){this.props.eventManager.listen(document,"click",this.handleClickOutside),this.props.isMobile||this.props.isSmallSize||this.setState({position:this.getPosition()})}},{key:"getPosition",value:function(){var e=this._menuElement.getBoundingClientRect(),t=this.props.guiClientRect;return e.top>=t.top?[E().top,E().left]:e.bottom+e.height<t.bottom?[E().bottom,E().left]:(this._menuElement.style.maxHeight=.8*t.height+"px",[E().stickBottom,E().left])}},{key:"isSelected",value:function(e){return e.active}},{key:"onSelect",value:function(e){this.props.onMenuChosen(e.value),this.props.options.filter((function(e){return e.active})).forEach((function(e){e.active=!1})),this.props.options.filter((function(t){return t.value===e.value}))[0].active=!0}},{key:"renderNativeSelect",value:function(e){var t=this,r=this.props.hideSelect?E().mobileHiddenSelect:"";return r+=" ".concat(E().dropdown),(0,b.h)("select",{"aria-labelledby":e,role:"listbox",ref:function(e){t.props.pushRef&&t.props.pushRef(e)},className:r,onChange:this.onChange},this.props.options.map((function(e,r){return(0,b.h)("option",{role:"option","aria-selected":t.isSelected(e),selected:t.isSelected(e),value:r,key:r},e.label)})))}},{key:"render",value:function(e){var t=this;return e.clearAccessibleChildren(),e.isMobile||e.isSmallSize?this.renderNativeSelect(e.labelledby):(0,b.h)("div",{role:"menu",onKeyDown:e.handleKeyDown,ref:function(e){return e?t._menuElement=e:void 0},className:[E().dropdownMenu].concat(i()(this.state.position)).join(" ")},e.options.map((function(r,n){return(0,b.h)(w,{setDefaultFocusedElement:e.setDefaultFocusedElement,addAccessibleChild:e.addAccessibleChild,isSelected:t.isSelected,onSelect:function(e){t.onSelect(e)},key:n,data:r,role:(null==r?void 0:r.isAdvanced)?"menuitem":"menuitemradio"})})))}}]),r}(b.Component))||n)||n)||n;x.displayName="Menu";var w=function(e){h()(r,e);var t=P(r);function r(){var e;s()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(d()(e),"onClick",(function(t){t.stopPropagation(),e.props.onSelect(e.props.data)})),_()(d()(e),"onKeyDown",(function(t){t.keyCode===S.KeyMap.ENTER&&(e.props.onSelect(e.props.data),t.stopPropagation())})),e}return u()(r,[{key:"render",value:function(e){var t=this,r=e.data.badgeType&&!e.isSelected(e.data)?T.BadgeType[e.data.badgeType]:T.BadgeType[e.data.badgeType+"Active"];return(0,b.h)("div",{role:null==e?void 0:e.role,tabIndex:-1,"aria-checked":e.isSelected(e.data)?"true":"false",ref:function(r){t.props.addAccessibleChild(r),e.isSelected(e.data)&&setTimeout((function(){return e.setDefaultFocusedElement(r)}))},className:e.isSelected(e.data)?[E().dropdownMenuItem,E().active].join(" "):E().dropdownMenuItem,onClick:this.onClick,onKeyDown:this.onKeyDown},(0,b.h)("span",{className:r?[E().labelBadge,r].join(" "):""},e.data.label),(0,b.h)("span",{className:[E().menuIconContainer,E().active].join(" ")},(0,b.h)(T.default,{type:T.IconType.CheckActive})))}}]),r}(b.Component)},"./src/components/overlay-action/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{OverlayAction:function(){return n.OverlayAction}});var n=r("./src/components/overlay-action/overlay-action.tsx")},"./src/components/overlay-action/overlay-action.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{OVERLAY_ACTION_DEFAULT_TIMEOUT:function(){return N},OverlayAction:function(){return j}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./src/styles/style.scss"),T=r.n(b),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/utils/index.ts"),C=r("./src/reducers/overlay-action.ts"),P=r("./src/reducers/shell.ts"),x=r("./src/components/icon/index.ts"),w=r("./src/reducers/getters.ts"),I=r("./src/components/player/index.ts"),M=r("./src/components/event-dispatcher/index.ts"),R=r("./src/components/logger/index.ts");function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var N=300,U="OverlayAction",j=(n=(0,A.connect)((function(e){return{isPlayingAdOrPlayback:(0,w.isPlayingAdOrPlayback)(e.engine),iconType:e.overlayAction.iconType,playerHover:e.shell.playerHover,isMobile:e.shell.isMobile,guiStyles:e.shell.layoutStyles.gui,isSmartContainerOpen:e.shell.smartContainerOpen,fullscreenConfig:e.config.components.fullscreen,seekbarDraggingActive:e.seekbar.draggingActive}}),(0,S.bindActions)(L(L({},C.actions),P.actions))),a=(0,R.withLogger)(U),i=(0,M.withEventDispatcher)(U),n(o=(0,I.withPlayer)(o=a(o=i(o=function(e){f()(r,e);var t=D(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"_iconTimeout",null),k()(p()(e),"_pointerDownPosX",NaN),k()(p()(e),"_pointerDownPosY",NaN),k()(p()(e),"_firstClickTime",0),k()(p()(e),"_clickTimeout",null),k()(p()(e),"togglePlayPause",(function(){e.props.isPlayingAdOrPlayback?(e.props.player.pause(),e.props.updateOverlayActionIcon(x.IconType.Pause)):(e.props.player.play(),e.props.updateOverlayActionIcon(x.IconType.Play)),e.props.updatePlayerHoverState(!0),e.props.notifyClick({type:"PlayPause"})})),k()(p()(e),"onOverlayPointerDown",(function(t){e._pointerDownPosX=t.clientX||t.changedTouches&&t.changedTouches[0]&&t.changedTouches[0].clientX,e._pointerDownPosY=t.clientY||t.changedTouches&&t.changedTouches[0]&&t.changedTouches[0].clientY})),k()(p()(e),"onOverlayMouseUp",(function(t){e.isDragging(t)||e.overlayClick()})),k()(p()(e),"onOverlayTouchEnd",(function(t){t.preventDefault(),e.props.playerHover&&!e.isDragging(t)&&e.togglePlayPause()})),e}return c()(r,[{key:"componentWillUnmount",value:function(){this.cancelClickTimeout(),this.cancelIconTimeout()}},{key:"toggleFullscreen",value:function(){this.props.player.isFullscreen()?(this.props.logger.debug("Exit fullscreen"),this.props.player.exitFullscreen()):(this.props.logger.debug("Enter fullscreen"),this.props.player.enterFullscreen()),this.props.notifyClick({type:"Fullscreen"})}},{key:"isDragging",value:function(e){var t=e.clientX||e.changedTouches&&e.changedTouches[0]&&e.changedTouches[0].clientX,r=e.clientY||e.changedTouches&&e.changedTouches[0]&&e.changedTouches[0].clientY;return this.props.seekbarDraggingActive||Math.abs(t-this._pointerDownPosX)>5||Math.abs(r-this._pointerDownPosY)>5}},{key:"overlayClick",value:function(){var e=this;if(!this.props.isSmartContainerOpen){if(!this.props.fullscreenConfig.disableDoubleClick){var t=Date.now();if(t-this._firstClickTime<200)return this.cancelClickTimeout(),void this.toggleFullscreen();if(t-this._firstClickTime<500)return this.cancelClickTimeout(),this.togglePlayPause(),this.toggleFullscreen(),void(this._firstClickTime=0);this._firstClickTime=t}this._clickTimeout=setTimeout((function(){e._clickTimeout=null,e.togglePlayPause()}),200)}}},{key:"cancelClickTimeout",value:function(){this._clickTimeout&&(clearTimeout(this._clickTimeout),this._clickTimeout=null)}},{key:"cancelIconTimeout",value:function(){this._iconTimeout&&(clearTimeout(this._iconTimeout),this._iconTimeout=null)}},{key:"shouldComponentUpdate",value:function(e){return e.iconType&&this.toggleOverlayActionIcon(e.iconType),!0}},{key:"toggleOverlayActionIcon",value:function(e){var t=this,r=function(){t.setState({animation:!0,iconType:e},(function(){t._iconTimeout=setTimeout((function(){t._iconTimeout=null,t.setState({animation:!1})}),N)}))};null!==this._iconTimeout?(this.cancelIconTimeout(),this.setState({animation:!1},(function(){t.forceUpdate(),r()}))):r()}},{key:"render",value:function(){var e=this.props.guiStyles;return(0,E.h)("div",{style:e,className:"".concat(T().overlayAction," ").concat(this.state.animation?T().in:""),onMouseDown:this.onOverlayPointerDown,onTouchStart:this.onOverlayPointerDown,onMouseUp:this.onOverlayMouseUp,onTouchEnd:this.onOverlayTouchEnd},this.state.animation?this.renderIcons():void 0)}},{key:"renderIcons",value:function(){return Array.isArray(this.state.iconType)?this.state.iconType.map((function(e,t){return(0,E.h)(x.default,{key:t,type:e})})):(0,E.h)(x.default,{type:this.state.iconType})}},{key:"componentDidUpdate",value:function(){this.state.animation&&this.props.updateOverlayActionIcon(null)}}]),r}(E.Component))||o)||o)||o)||o);j.displayName=U},"./src/components/overlay-portal/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{OverlayPortal:function(){return n.OverlayPortal}});var n=r("./src/components/overlay-portal/overlay-portal.tsx")},"./src/components/overlay-portal/overlay-portal.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{OverlayPortal:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./node_modules/preact/dist/preact.module.js");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var m=function(e){l()(r,e);var t=f(r);function r(){return a()(this,r),t.apply(this,arguments)}return o()(r,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(e){return(0,h.h)("div",{className:"overlay-portal","aria-live":"polite"},e.children)}}]),r}(h.Component);m.displayName="OverlayPortal"},"./src/components/overlay/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Overlay:function(){return n.Overlay}});var n=r("./src/components/overlay/overlay.tsx")},"./src/components/overlay/overlay.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Overlay:function(){return R}});var n,a=r("./node_modules/@babel/runtime/helpers/extends.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/utils/index.ts"),C=r("./src/reducers/overlay.ts"),P=r("./src/reducers/shell.ts"),x=r("./src/components/icon/index.ts");function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){_()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var R=(0,A.connect)((function(e){return{overlayOpen:e.overlay.isOpen}}),(0,S.bindActions)(M(M({},P.actions),C.actions)))(n=function(e){h()(r,e);var t=w(r);function r(){var e;s()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(d()(e),"_timeoutId",null),_()(d()(e),"onCloseButtonKeyDown",(function(t){t.keyCode!==S.KeyMap.ENTER&&t.keyCode!==S.KeyMap.SPACE||(t.preventDefault(),e.props.onClose(t,!0))})),_()(d()(e),"onKeyDown",(function(t){e.props.handleKeyDown&&e.props.handleKeyDown(t)})),e}return u()(r,[{key:"componentDidMount",value:function(){var e=this;this._timeoutId=setTimeout((function(){return e.props.addPlayerClass(E().overlayActive)}),0)}},{key:"componentWillUnmount",value:function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null),this.props.removePlayerClass(E().overlayActive)}},{key:"renderCloseButton",value:function(e){return e.permanent?void 0:(0,b.h)(T.Localizer,null,(0,b.h)("a",{role:"button",ref:function(t){e.addAccessibleChild&&e.addAccessibleChild(t)},tabIndex:0,onClick:function(){e.updateOverlay(!1),e.onClose()},onKeyDown:this.onCloseButtonKeyDown,"aria-label":(0,b.h)(T.Text,{id:"overlay.close"}),className:E().closeOverlay},(0,b.h)(x.default,{type:x.IconType.Close})))}},{key:"render",value:function(e){var t=e.type,r=e.open,n=e.ariaLabel,a=e.ariaLabelledBy,o=a?{"aria-labelledby":a}:{"aria-label":n},s=[E().overlay];if(t){var l=E()[t+"-overlay"]?E()[t+"-overlay"]:t+"-overlay";s.push(l)}return r&&(this.props.updateOverlay(r),s.push(E().active)),(0,b.h)("div",i()({tabIndex:-1,className:s.join(" "),role:"dialog",onKeyDown:this.onKeyDown},o),(0,b.h)("div",{className:E().overlayContents},this.props.children),this.renderCloseButton(this.props))}}]),r}(b.Component))||n;R.displayName="Overlay"},"./src/components/picture-in-picture-overlay/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PictureInPictureOverlay:function(){return n.PictureInPictureOverlay}});var n=r("./src/components/picture-in-picture-overlay/picture-in-picture-overlay.tsx")},"./src/components/picture-in-picture-overlay/picture-in-picture-overlay.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PictureInPictureOverlay:function(){return S}});var n,a,i,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./src/styles/style.scss"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),E=r("./src/components/player/index.ts"),b=r("./src/components/logger/index.ts");function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var A="PictureInPictureOverlay",S=(n=(0,_.connect)((function(e){return{poster:e.engine.poster,isInPictureInPicture:e.engine.isInPictureInPicture,isChangingSource:e.engine.isChangingSource}})),a=(0,b.withLogger)(A),n(i=(0,E.withPlayer)(i=a(i=function(e){d()(r,e);var t=T(r);function r(){return s()(this,r),t.apply(this,arguments)}return u()(r,[{key:"_handleClick",value:function(){this.props.player.exitPictureInPicture()}},{key:"render",value:function(){if(this.props.isInPictureInPicture){var e={},t=[y().pictureInPicturePoster];return this.props.poster&&(e={backgroundImage:this.props.isChangingSource?"":"url(".concat(this.props.poster,")"),backgroundSize:"contain"},t.push(y().hasPoster)),(0,v.h)("div",null,(0,v.h)("div",{className:y().pictureInPictureOverlay},(0,v.h)("div",{className:t.join(" "),style:e,onMouseOver:function(e){return e.stopPropagation()}},(0,v.h)("div",{className:y().darkLayer})),(0,v.h)("div",{className:y().pictureInPictureControl},(0,v.h)(k.Localizer,null,(0,v.h)("span",{className:y().pictureInPictureText},(0,v.h)(k.Text,{id:"pictureInPicture.overlay_text"}))))))}}}]),r}(v.Component))||i)||i)||i);S.displayName=A},"./src/components/picture-in-picture/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PictureInPicture:function(){return n.PictureInPicture}});var n=r("./src/components/picture-in-picture/picture-in-picture.tsx")},"./src/components/picture-in-picture/picture-in-picture.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PictureInPicture:function(){return G}});var n,a,i,o,s,l,u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),C=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),P=r("./src/components/icon/index.ts"),x=r("./node_modules/react-redux/es/index.js"),w=r("./src/components/player/index.ts"),I=r("./src/components/logger/index.ts"),M=r("./src/utils/index.ts"),R=r("./src/components/keyboard/index.ts"),D=r("./src/components/event-dispatcher/index.ts"),O=r("./src/components/tooltip/index.ts"),L=r("./src/components/button/index.ts"),N=r("./src/reducers/shell.ts"),U=r("./src/components/button-control/index.ts"),j=r("./src/components/bottom-bar/index.ts");function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){b()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}var H="PictureInPicture",G=(n=(0,x.connect)((function(e){return{isPictureInPictureSupported:e.engine.isPictureInPictureSupported,isInPictureInPicture:e.engine.isInPictureInPicture,playerSize:e.shell.playerSize}}),(0,M.bindActions)(N.actions)),a=(0,R.withKeyboardEvent)(H),i=(0,I.withLogger)(H),o=(0,D.withEventDispatcher)(H),s=(0,C.withText)({pictureInPictureText:"controls.pictureInPicture",pictureInPictureExitText:"controls.pictureInPictureExit"}),n(l=(0,w.withPlayer)(l=a(l=i(l=o(l=s(l=function(e){g()(r,e);var t=V(r);function r(e){var n;return c()(this,r),n=t.call(this,e),b()(f()(n),"_keyboardEventHandlers",[{key:{code:M.KeyMap.P},action:function(){n.togglePip(),n.props.updatePlayerHoverState(!0)}}]),b()(f()(n),"getSvgIcon",(function(){return{type:n.props.player.isInPictureInPicture()?P.IconType.PictureInPictureStop:P.IconType.PictureInPictureStart}})),b()(f()(n),"getComponentText",(function(){return n.props.player.isInPictureInPicture()?n.props.pictureInPictureExitText:n.props.pictureInPictureText})),b()(f()(n),"togglePip",(function(){var e=n.props.player;e.isInPictureInPicture()?(n.props.logger.debug("Exit Picture In Picture"),n.props.notifyClick(),e.exitPictureInPicture()):(n.props.logger.debug("Enter Picture In Picture"),n.props.notifyClick(),e.enterPictureInPicture())})),(0,j.registerToBottomBar)(H,e.player,(function(){return n.registerComponent()})),n}return p()(r,[{key:"registerComponent",value:function(){var e=this;return{ariaLabel:function(){return e.getComponentText()},displayName:H,order:5,svgIcon:function(){return e.getSvgIcon()},onClick:function(){return e.togglePip()},component:function(){return $(F(F({},e.props),{},{classNames:[A().upperBarIcon]}))},shouldHandleOnClick:!1}}},{key:"componentDidMount",value:function(){this.props.registerKeyboardEvents(this._keyboardEventHandlers)}},{key:"_shouldRender",value:function(){var e=!(void 0!==this.props.isPictureInPictureSupported&&!this.props.isPictureInPictureSupported);return this.props.onToggle(H,e),e}},{key:"render",value:function(){if(this._shouldRender())return(0,S.h)(U.ButtonControl,{name:H,className:this.props.classNames?this.props.classNames.join(" "):""},(0,S.h)(O.Tooltip,{label:this.props.isInPictureInPicture?this.props.pictureInPictureExitText:this.props.pictureInPictureText},(0,S.h)(L.Button,{tabIndex:"0","aria-label":this.props.isInPictureInPicture?this.props.pictureInPictureExitText:this.props.pictureInPictureText,className:this.props.isInPictureInPicture?[A().controlButton,A().isInPictureInPicture].join(" "):A().controlButton,onClick:this.togglePip},(0,S.h)(P.default,{type:P.IconType.PictureInPictureStart}),(0,S.h)(P.default,{type:P.IconType.PictureInPictureStop}))))}}]),r}(S.Component))||l)||l)||l)||l)||l)||l),$=function(e){return(0,S.h)(G,e)};G.displayName=H},"./src/components/play-pause/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayPause:function(){return n.PlayPause}});var n=r("./src/components/play-pause/play-pause.tsx")},"./src/components/play-pause/play-pause.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayPause:function(){return $}});var n,a,i,o,s,l=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/inherits.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_=r.n(v),k=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=r.n(k),b=r("./src/styles/style.scss"),T=r.n(b),A=r("./node_modules/preact/dist/preact.module.js"),S=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),C=r("./node_modules/react-redux/es/index.js"),P=r("./src/components/icon/index.ts"),x=r("./src/reducers/getters.ts"),w=r("./src/components/player/index.ts"),I=r("./src/components/event-dispatcher/index.ts"),M=r("./src/components/logger/index.ts"),R=r("./src/utils/index.ts"),D=r("./src/reducers/settings.ts"),O=r("./src/reducers/overlay-action.ts"),L=r("./src/components/tooltip/index.ts"),N=r("./src/components/button/index.ts"),U=r("./src/reducers/shell.ts"),j=r("./src/components/button-control/index.ts"),B=r("./src/event/index.ts");function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_()(e);if(t){var a=_()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return y()(this,r)}}function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){E()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var G="PlayPause",$=(n=(0,C.connect)((function(e){return{isPlayingAdOrPlayback:(0,x.isPlayingAdOrPlayback)(e.engine),isPlaying:e.engine.isPlaying,adBreak:e.engine.adBreak,isPlaybackEnded:e.engine.isPlaybackEnded}}),(0,R.bindActions)(H(H(H({},U.actions),D.actions),O.actions))),a=(0,M.withLogger)(G),i=(0,I.withEventDispatcher)(G),o=(0,S.withText)({startOverText:"controls.startOver",pauseText:"controls.pause",playText:"controls.play"}),n(s=(0,w.withPlayer)(s=a(s=i(s=(0,B.withEventManager)(s=o(s=function(e){m()(r,e);var t=F(r);function r(){var e;u()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),E()(h()(e),"_playPauseButtonRef",void 0),E()(h()(e),"togglePlayPause",(function(){e.props.logger.debug("Toggle play"),e.props.isPlayingAdOrPlayback?e.props.player.pause():e.props.player.play(),e.props.notifyClick()})),E()(h()(e),"handleSpaceKey",(function(t){"Space"===t.code&&(e.togglePlayPause(),t.preventDefault())})),e}return d()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.eventManager,n=t.player;r.listenOnce(n,n.Event.UI.USER_CLICKED_PLAY,(function(){r.listenOnce(n,n.Event.Core.FIRST_PLAY,(function(){var t;null===(t=e._playPauseButtonRef)||void 0===t||t.focus()}))}));var a=document.getElementById(this.props.player.config.targetId)||document;r.listen(a,"keydown",this.handleSpaceKey)}},{key:"render",value:function(e){var t=this,r=this.props.isPlayingAdOrPlayback?[T().controlButton,T().isPlaying].join(" "):T().controlButton,n=e.isPlaybackEnded&&!this.props.adBreak,a=this.props.isPlayingAdOrPlayback?this.props.pauseText:this.props.playText,i=n?this.props.startOverText:a;return(0,A.h)(j.ButtonControl,{name:G},(0,A.h)(L.Tooltip,{label:i},(0,A.h)(N.Button,{tabIndex:"0","aria-label":i,className:r,onClick:this.togglePlayPause,ref:function(e){t._playPauseButtonRef=e}},n?(0,A.h)(P.default,{type:P.IconType.StartOver}):(0,A.h)("div",null,(0,A.h)(P.default,{type:P.IconType.Play}),(0,A.h)(P.default,{type:P.IconType.Pause})))))}}]),r}(A.Component))||s)||s)||s)||s)||s)||s);$.displayName=G},"./src/components/playback-controls/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaybackControls:function(){return n.PlaybackControls}});var n=r("./src/components/playback-controls/playback-controls.tsx")},"./src/components/playback-controls/playback-controls.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaybackControls:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/react-redux/es/index.js"),v=r("./src/components/playlist-button/index.ts"),_=r("./src/components/play-pause/index.ts"),k=r("./src/components/player-area/index.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var b=(0,y.connect)((function(e){return{playlist:e.engine.playlist}}))(n=function(e){u()(r,e);var t=E(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"componentDidMount",value:function(){this.setState({shouldUpdate:!1})}},{key:"componentDidUpdate",value:function(e){!!e.playlist!=!!this.props.playlist&&this.setState({shouldUpdate:!0})}},{key:"render",value:function(e){var t=e.showPreview,r=void 0===t||t,n=e.playlist,a=e.className,i=this.state.shouldUpdate;return i&&this.setState({shouldUpdate:!1}),(0,g.h)("div",{className:[m().playbackControls,a].join(" ")},(0,g.h)(k.PlayerArea,{name:"BottomBarPlaybackControls",shouldUpdate:i},n?(0,g.h)(g.Fragment,null,(0,g.h)(v.PlaylistButton,{type:"prev",showPreview:r}),(0,g.h)(_.PlayPause,null),(0,g.h)(v.PlaylistButton,{type:"next",showPreview:r})):(0,g.h)(_.PlayPause,null)))}}]),r}(g.Component))||n;b.displayName="PlaybackControls"},"./src/components/player-area/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerArea:function(){return n.PlayerArea},PlayerAreaProvider:function(){return a.PlayerAreaProvider},Remove:function(){return n.Remove},withPlayerPreset:function(){return i.withPlayerPreset}});var n=r("./src/components/player-area/player-area.tsx"),a=r("./src/components/player-area/player-area-provider.tsx"),i=r("./src/components/player-area/with-player-preset.tsx")},"./src/components/player-area/player-area-provider.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerAreaProvider:function(){return T}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./src/components/logger/index.ts"),E=r("./src/components/player-area/styles-store-adapter.tsx");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var T=(0,k.withLogger)("PlayerAreaProvider")(n=(0,_.connect)((function(e){return{activePresetName:e.shell.activePresetName}}))(n=function(e){d()(r,e);var t=b(r);function r(){var e;return i()(this,r),e=t.call(this),y()(u()(e),"_listeners",void 0),y()(u()(e),"_componentsByPreset",void 0),y()(u()(e),"_validateComponentData",(function(t){var r=t.container||t.area;return!!(t.get&&t.presets&&r)||(e.props.logger.warn("component data with label '".concat(t.label||"","' is invalid (did you remember to set 'get', 'presets' and 'area'?)")),!1)})),y()(u()(e),"_addNewComponentAndUpdateListeners",(function(t){return e._addNewComponent(t,!0)})),y()(u()(e),"_addNewComponent",(function(t,r){var n=Object.assign({},t);if(n.container&&(n.area=n.area||n.container,delete n.container),!e._validateComponentData(n))return function(){};var a=n.area;return n.presets.forEach((function(t){if((e._componentsByPreset[t]||(e._componentsByPreset[t]=[])).push(n),r){var i=e._findListeners(a,t);e._emitListeners(i)}})),function(){e._removeNewComponent(n)}})),y()(u()(e),"_removeNewComponent",(function(t){e._validateComponentData(t)&&t.presets.forEach((function(r){var n=e._componentsByPreset[r]||[],a=n.indexOf(t);if(-1!==a){n.splice(a,1);var i=e._findListeners(t.area,t.presetName);e._emitListeners(i)}}))})),y()(u()(e),"_findListeners",(function(t,r){return t?e._listeners.filter((function(e){return(!r||e.presetName===r)&&e.areaName===t})):[]})),y()(u()(e),"_listen",(function(t,r,n){if(!t||!r||!n)return function(){};var a=e._findListeners(r,t);a&&a.length>0&&(e.props.logger.warn("Another component is already registered to updates for player area '".concat(r,"' in preset '").concat(t,"'. Unlisten to previous listener")),a.forEach((function(t){e._unlisten(t)})));var i={presetName:t,areaName:r,callback:n};return e._listeners.push(i),e._emitListeners([i]),function(){e._unlisten(i)}})),y()(u()(e),"_unlisten",(function(t){var r=e._listeners.indexOf(t);-1!==r&&e._listeners.splice(r,1)})),y()(u()(e),"_getAreaComponents",(function(t,r){if(!r||!t)return[];var n=e._componentsByPreset[t];return(n?n.filter((function(e){return e.area===r})):[])||[]})),e._listeners=[],e._componentsByPreset={},e}return s()(r,[{key:"_initializePlayerComponents",value:function(){var e=this;this.props.uiComponents&&this.props.uiComponents.length>0&&(this.props.uiComponents.forEach((function(t){return e._addNewComponent(t)})),this._emitAllListeners())}},{key:"_emitListeners",value:function(e){var t=this,r=this.props.activePresetName;(e||[]).forEach((function(e){var n=e.presetName===r?t._getAreaComponents(r,e.areaName):[];try{e.callback(n)}catch(r){t.props.logger.error("Error occurred when handling player area ".concat(e.areaName," of preset ").concat(e.presetName,"."),r)}}))}},{key:"_emitAllListeners",value:function(){this._emitListeners(this._listeners)}},{key:"componentDidMount",value:function(){this.props.setApi(this._addNewComponentAndUpdateListeners),this._initializePlayerComponents()}},{key:"componentDidUpdate",value:function(e){e.activePresetName!==this.props.activePresetName&&this._emitAllListeners()}},{key:"getChildContext",value:function(){return{playerAreaComponentsStore:{listen:this._listen,addNewComponent:this._addNewComponentAndUpdateListeners,getAreaComponents:this._getAreaComponents}}}},{key:"render",value:function(e){return(0,v.h)(v.Fragment,null,(0,v.h)(E.StylesStoreAdapter,null),e.children)}}]),r}(v.Component))||n)||n},"./src/components/player-area/player-area.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerArea:function(){return x},Remove:function(){return S}});var n,a,i=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./node_modules/react-redux/es/index.js"),T=r("./src/components/logger/index.ts");function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}var S="remove";function C(e,t){return e[t]=e[t]||{before:[],after:[],replace:null},e[t]}var P={playerAreaComponents:null,hasPositionedComponents:!1,presetComponentsOnlyMode:!0},x=(0,T.withLogger)("PlayerArea")(n=(0,b.connect)((function(e){return{activePresetName:e.shell.activePresetName}}))((a=function(e){f()(r,e);var t=A(r);function r(){var e;l()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),k()(p()(e),"_unregisterListenerCallback",void 0),k()(p()(e),"_actualChildren",void 0),k()(p()(e),"_updateAreaComponents",(function(t){var r=e.props,n=r.activePresetName,a=r.name;e.props.logger.debug("Player area '".concat(a,"' in preset '").concat(n,"' - update children components"));var i={},o={appendedComponents:[],positionedComponentMap:i},s=!1;t.forEach((function(e){e.beforeComponent?(C(i,e.beforeComponent).before.push(e),s=!0):e.afterComponent?(C(i,e.afterComponent).after.push(e),s=!0):e.replaceComponent?(C(i,e.replaceComponent).replace=e,s=!0):o.appendedComponents.push(e)})),e.setState({playerAreaComponents:o,hasPositionedComponents:s,presetComponentsOnlyMode:!1})})),e}return c()(r,[{key:"shouldComponentUpdate",value:function(e,t){return e.shouldUpdate||this.state.playerAreaComponents!==t.playerAreaComponents||e.activePresetName!==this.props.activePresetName}},{key:"componentDidUpdate",value:function(e){e.activePresetName!==this.props.activePresetName&&this._registerListener()}},{key:"_unregisterListener",value:function(){this.props.logger.debug("Player area '".concat(this.props.name,"' - unregister to changes")),"function"==typeof this._unregisterListenerCallback&&(this._unregisterListenerCallback(),this._unregisterListenerCallback=null)}},{key:"_registerListener",value:function(){var e=this.props,t=e.activePresetName,r=e.name;this._unregisterListener(),t&&r&&(this.props.logger.debug("Player area '".concat(r,"' in preset '").concat(t,"' - register to changes")),this._unregisterListenerCallback=this.context.playerAreaComponentsStore.listen(t,r,this._updateAreaComponents))}},{key:"componentDidMount",value:function(){this.props.logger.debug("Player area '".concat(this.props.name,"' - handle did mount")),this.setState(P),this._registerListener(),this._actualChildren=[]}},{key:"componentWillUpdate",value:function(e){var t=e.children;this._actualChildren=t&&t.type===E.Fragment?t.props.children:t}},{key:"componentWillUnmount",value:function(){var e=this.props.name;this.props.logger.debug("Player area '".concat(e,"' - handle will unmount")),this._unregisterListener()}},{key:"_renderUIComponent",value:function(e){return e.get?(0,E.h)(e.get,e.props):null}},{key:"renderContent",value:function(e){return(0,E.h)(E.Fragment,null,e)}},{key:"_getPositionedComponents",value:function(e){var t=this,r=this.state.playerAreaComponents,n=[];return(0,E.toChildArray)(e).forEach((function(e){if("div"===e.type||e.type===E.Fragment)return e.props.children=t._getPositionedComponents(e.props.children),void n.push(e);var a,i=(a=e)&&a.type?a.type.displayName:null;if(i){var o=r.positionedComponentMap[i];if(o){var s=o.replace,l=o.before,u=o.after;if(s){if(s.get===S)return;return"string"!=typeof s.get&&(s.props=s.props||{},s.props.replacedComponentProps=e.props),void n.push(t._renderUIComponent(s))}l.length&&l.forEach((function(e){n.push(t._renderUIComponent(e))})),n.push(e),u.length&&u.forEach((function(e){n.push(t._renderUIComponent(e))}))}else n.push(e)}else n.push(e)})),n}},{key:"render",value:function(){var e,t=this,r=this.props.show,n=this.state,a=n.playerAreaComponents,i=n.hasPositionedComponents;if(n.presetComponentsOnlyMode)return this.renderContent(this._actualChildren);if(!a||!r)return null;var s,l=[];i?l=this._getPositionedComponents(this._actualChildren):(s=l).push.apply(s,o()((0,E.toChildArray)(this._actualChildren)));var u=a.appendedComponents.map((function(e){return t._renderUIComponent(e)})),c=l.length;return(e=l).splice.apply(e,[c,0].concat(o()(u))),this.renderContent(l)}}]),r}(E.Component),k()(a,"defaultProps",{show:!0}),n=a))||n)||n},"./src/components/player-area/player-areas-utils.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{calculateGuiContainerStyles:function(){return p},calculateSidePanelStyles:function(){return h},calculateVideoContainerStyles:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n),i=r("./src/reducers/shell.ts"),o=r("./src/components/shell/shell.tsx");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e){var t,r=e.sidePanelsSizes,n=e.sidePanelsModes,a=e.playerClientRect,s=e.isVideo,l=r[i.SidePanelOrientation.VERTICAL],u=a.width,c=Math.max(l.min,Math.min(l.max,u*l.ratio)),d=n[i.SidePanelPositions.LEFT],p=n[i.SidePanelPositions.RIGHT],h=u-(t=s?d===i.SidePanelModes.ALONGSIDE&&p===i.SidePanelModes.ALONGSIDE?2:1:d!==i.SidePanelModes.HIDDEN&&p!==i.SidePanelModes.HIDDEN?2:1)*c;return u<o.PLAYER_BREAK_POINTS.SMALL&&(h=u,c=u),{verticalPanelWidth:c,videoWidth:h,verticalPanelCount:t}}function c(e){var t,r=e.sidePanelsSizes,n=e.sidePanelsModes,a=e.playerClientRect,s=e.isVideo,l=r[i.SidePanelOrientation.HORIZONTAL],u=a.height,c=Math.max(l.min,Math.min(l.max,u*l.ratio)),d=n[i.SidePanelPositions.TOP],p=n[i.SidePanelPositions.BOTTOM],h=u-(t=s?d===i.SidePanelModes.ALONGSIDE&&p===i.SidePanelModes.ALONGSIDE?2:1:d!==i.SidePanelModes.HIDDEN&&p!==i.SidePanelModes.HIDDEN?2:1)*c;return a.width<o.PLAYER_BREAK_POINTS.SMALL&&(h=u,c=u),{horizontalPanelHeight:c,videoHeight:h,horizontalPanelCount:t}}function d(e){var t=e.sidePanelsModes,r=e.allowSidePanels,n={position:"absolute",left:0,right:0,top:0,bottom:0},a=r?t[i.SidePanelPositions.LEFT]:i.SidePanelModes.HIDDEN,s=r?t[i.SidePanelPositions.RIGHT]:i.SidePanelModes.HIDDEN,d=r?t[i.SidePanelPositions.TOP]:i.SidePanelModes.HIDDEN,p=r?t[i.SidePanelPositions.BOTTOM]:i.SidePanelModes.HIDDEN;if(e.playerClientRect.width>o.PLAYER_BREAK_POINTS.SMALL){if(a===i.SidePanelModes.ALONGSIDE||s===i.SidePanelModes.ALONGSIDE){var h=u(l(l({},e),{},{isVideo:!0})),f=h.verticalPanelWidth,m=h.videoWidth;n.left=a===i.SidePanelModes.ALONGSIDE?f:0,n.right=s===i.SidePanelModes.ALONGSIDE?f:0,n.width=m,n.position="absolute"}if(d===i.SidePanelModes.ALONGSIDE||p===i.SidePanelModes.ALONGSIDE){var g=c(l(l({},e),{},{isVideo:!0})),y=g.horizontalPanelHeight,v=g.videoHeight;n.top=d===i.SidePanelModes.ALONGSIDE?y:0,n.bottom=p===i.SidePanelModes.ALONGSIDE?y:0,n.height=v,n.position="absolute"}}return n}function p(e){var t=e.sidePanelsModes,r=e.playerClientRect,n=e.allowSidePanels,a={position:"absolute",left:0,right:0,top:0,bottom:0},s=r.width,l=r.height,d=n?t[i.SidePanelPositions.LEFT]:i.SidePanelModes.HIDDEN,p=n?t[i.SidePanelPositions.RIGHT]:i.SidePanelModes.HIDDEN,h=n?t[i.SidePanelPositions.TOP]:i.SidePanelModes.HIDDEN,f=n?t[i.SidePanelPositions.BOTTOM]:i.SidePanelModes.HIDDEN;if(r.width>o.PLAYER_BREAK_POINTS.SMALL){if(d!==i.SidePanelModes.HIDDEN||p!==i.SidePanelModes.HIDDEN){var m=u(e).verticalPanelWidth;d!==i.SidePanelModes.HIDDEN&&(a.left=m),p!==i.SidePanelModes.HIDDEN&&(a.right=m)}if(h!==i.SidePanelModes.HIDDEN||f!==i.SidePanelModes.HIDDEN){var g=c(e).horizontalPanelHeight;h!==i.SidePanelModes.HIDDEN&&(a.top=g),f!==i.SidePanelModes.HIDDEN&&(a.bottom=g)}s=s-a.right-a.left,l=l-a.top-a.bottom}var y=r.left+(d!==i.SidePanelModes.HIDDEN?a.left:0),v=r.top+(h!==i.SidePanelModes.HIDDEN?a.top:0);return{style:a,rect:{x:y,y:v,width:s,height:l,top:v,right:r.right+(p!==i.SidePanelModes.HIDDEN?a.right:0),bottom:r.bottom+(f!==i.SidePanelModes.HIDDEN?a.bottom:0),left:y}}}function h(e){var t=e.position,r=e.sidePanelsModes,n=r[i.SidePanelPositions.LEFT],a=r[i.SidePanelPositions.RIGHT],o=r[i.SidePanelPositions.TOP],s=r[i.SidePanelPositions.BOTTOM];if(-1!==[i.SidePanelPositions.RIGHT,i.SidePanelPositions.LEFT].indexOf(t)){var l={},d=u(e).verticalPanelWidth;return l.width=d,t===i.SidePanelPositions.RIGHT?(a===i.SidePanelModes.HIDDEN?(l.right=-d,l.opacity=0):(l.right=0,l.opacity=1),l):(n===i.SidePanelModes.HIDDEN?(l.left=-d,l.opacity=0):(l.left=0,l.opacity=1),l)}var p={},h=c(e).horizontalPanelHeight,f=u(e).verticalPanelWidth;return p.height=h,n!==i.SidePanelModes.HIDDEN&&(p.left=f),a!==i.SidePanelModes.HIDDEN&&(p.right=f),t===i.SidePanelPositions.TOP?(o===i.SidePanelModes.HIDDEN?(p.top=-h,p.opacity=0):(p.top=0,p.opacity=1),p):(s===i.SidePanelModes.HIDDEN?(p.bottom=-h,p.opacity=0):(p.bottom=0,p.opacity=1),p)}},"./src/components/player-area/styles-store-adapter.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{StylesStoreAdapter:function(){return S}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/react-redux/es/index.js"),v=r("./src/reducers/shell.ts"),_=r("./src/utils/index.ts"),k=r("./src/components/player-area/player-areas-utils.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e){var t,r;return e.allowSidePanels?(t={},m()(t,v.SidePanelPositions.TOP,k.calculateSidePanelStyles(T(T({},e),{},{position:v.SidePanelPositions.TOP}))),m()(t,v.SidePanelPositions.BOTTOM,k.calculateSidePanelStyles(T(T({},e),{},{position:v.SidePanelPositions.BOTTOM}))),m()(t,v.SidePanelPositions.RIGHT,k.calculateSidePanelStyles(T(T({},e),{},{position:v.SidePanelPositions.RIGHT}))),m()(t,v.SidePanelPositions.LEFT,k.calculateSidePanelStyles(T(T({},e),{},{position:v.SidePanelPositions.LEFT}))),t):(r={},m()(r,v.SidePanelPositions.TOP,{}),m()(r,v.SidePanelPositions.BOTTOM,{}),m()(r,v.SidePanelPositions.RIGHT,{}),m()(r,v.SidePanelPositions.LEFT,{}),r)}var S=(0,y.connect)((function(e){return{sidePanelsModes:e.shell.sidePanelsModes,sidePanelsSizes:e.shell.sidePanelsSizes,allowSidePanels:e.shell.presetSettings.allowSidePanels,playerClientRect:e.shell.playerClientRect}}),(0,_.bindActions)(v.actions))(n=function(e){u()(r,e);var t=E(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,r=t.sidePanelsModes,n=t.sidePanelsSizes,a=t.allowSidePanels,i=t.playerClientRect,o=e.sidePanelsModes,s=e.sidePanelsSizes,l=e.allowSidePanels,u=e.playerClientRect;return!(r===o&&n===s&&a===l&&i===u)}},{key:"componentDidUpdate",value:function(){var e={sidePanelsModes:this.props.sidePanelsModes,sidePanelsSizes:this.props.sidePanelsSizes,playerClientRect:this.props.playerClientRect,allowSidePanels:this.props.allowSidePanels},t=k.calculateGuiContainerStyles(e),r=t.style,n=t.rect;this.props.updateLayoutStyles({gui:r,video:k.calculateVideoContainerStyles(e),sidePanels:A(e)}),this.props.updateGuiClientRect(n)}},{key:"render",value:function(){return null}}]),r}(g.Component))||n},"./src/components/player-area/with-player-preset.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withPlayerPreset:function(){return _}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./node_modules/preact/dist/preact.module.js"),f=r("./node_modules/react-redux/es/index.js"),m=r("./src/reducers/shell.ts"),g=r("./src/utils/index.ts");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var v={allowSidePanels:!1,allowPlayerArea:!1},_=function(e){return function(t){var r,n=(0,f.connect)(null,(0,g.bindActions)(m.actions))(r=function(r){l()(i,r);var n=y(i);function i(){return a()(this,i),n.apply(this,arguments)}return o()(i,[{key:"componentDidMount",value:function(){var t=Object.assign({},v,e),r=t.allowSidePanels,n=t.allowPlayerArea;this.props.updatePresetSettings({allowSidePanels:r,allowPlayerArea:n})}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(e){return(0,h.h)(t,e)}}]),i}(h.Component))||r;return n}}},"./src/components/player-gui/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerGUI:function(){return n.PlayerGUI}});var n=r("./src/components/player-gui/player-gui.tsx")},"./src/components/player-gui/player-gui.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerGUI:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/preact/dist/preact.module.js"),m=r("./node_modules/react-redux/es/index.js"),g=r("./src/components/active-preset/index.ts"),y=r("./src/components/player-area/index.ts"),v=r("./src/reducers/shell.ts"),_=r("./src/components/side-panel/index.ts"),k=r("./src/utils/index.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var b=(0,m.connect)((function(e){return{allowSidePanels:e.shell.presetSettings.allowSidePanels,allowPlayerArea:e.shell.presetSettings.allowPlayerArea,sidePanelsConfig:e.config.components.sidePanels}}),(0,k.bindActions)(v.actions))(n=function(e){u()(r,e);var t=E(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"componentDidUpdate",value:function(){var e=this.props.sidePanelsConfig,t=e.verticalSizes,r=e.horizontalSizes;t&&this.props.updateSidePanelSize(v.SidePanelOrientation.VERTICAL,t),r&&this.props.updateSidePanelSize(v.SidePanelOrientation.HORIZONTAL,r)}},{key:"render",value:function(){var e=this.props,t=e.uis,r=e.playerContainer,n=e.allowSidePanels,a=e.allowPlayerArea;return(0,f.h)(f.Fragment,null,(0,f.h)(g.ActivePreset,{uis:t,playerContainer:r}),n?(0,f.h)(f.Fragment,null,(0,f.h)(_.SidePanel,{position:v.SidePanelPositions.RIGHT}),(0,f.h)(_.SidePanel,{position:v.SidePanelPositions.LEFT}),(0,f.h)(_.SidePanel,{position:v.SidePanelPositions.TOP}),(0,f.h)(_.SidePanel,{position:v.SidePanelPositions.BOTTOM})):void 0,a?(0,f.h)(y.PlayerArea,{name:"PlayerArea"}):void 0)}}]),r}(f.Component))||n},"./src/components/player/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerProvider:function(){return n.PlayerProvider},withPlayer:function(){return a.withPlayer}});var n=r("./src/components/player/player-provider.tsx"),a=r("./src/components/player/with-player.tsx")},"./src/components/player/player-provider.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerProvider:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./node_modules/preact/dist/preact.module.js");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var m=function(e){l()(r,e);var t=f(r);function r(){return a()(this,r),t.apply(this,arguments)}return o()(r,[{key:"getChildContext",value:function(){return{player:this.props.player}}},{key:"render",value:function(){return this.props.children&&(0,h.toChildArray)(this.props.children)[0]||null}}]),r}(h.Component)},"./src/components/player/with-player.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withPlayer:function(){return y}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/preact/dist/preact.module.js");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var y=function(e){return function(t){c()(n,t);var r=g(n);function n(e){return o()(this,n),r.call(this)}return l()(n,[{key:"render",value:function(){var t=this.context.player;return(0,m.h)(e,a()({},this.props,{player:t}))}}]),n}(m.Component)}},"./src/components/playlist-button/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaylistButton:function(){return n.PlaylistButton},PrevNext:function(){return a.PrevNext}});var n=r("./src/components/playlist-button/playlist-button.tsx"),a=r("./src/components/playlist-button/prev-next.tsx")},"./src/components/playlist-button/playlist-button.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaylistButton:function(){return T}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),y=r.n(g),v=r("./node_modules/preact/dist/preact.module.js"),_=r("./node_modules/react-redux/es/index.js"),k=r("./src/components/player/index.ts"),E=r("./src/components/playlist-button/prev-next.tsx");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var T=(0,_.connect)((function(e){return{playlist:e.engine.playlist}}))(n=(0,k.withPlayer)(n=function(e){d()(r,e);var t=b(r);function r(){var e;i()(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),y()(u()(e),"onClick",(function(){"prev"===e.props.type?e.props.player.playlist.playPrev():e.props.player.playlist.playNext()})),e}return s()(r,[{key:"render",value:function(e){var t=e.playlist[e.type];return(0,v.h)(E.PrevNext,{type:e.type,item:t,onClick:this.onClick.bind(this),showPreview:e.showPreview})}}]),r}(v.Component))||n)||n;T.displayName="PlaylistButton"},"./src/components/playlist-button/prev-next.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PrevNext:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),v=r("./src/components/button/index.ts"),_=r("./src/components/tooltip/index.ts"),k=r("./src/components/icon/index.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var b=(0,y.withText)({prevControlsText:"controls.prev",nextControlsText:"controls.next",playlistPrevText:"playlist.prev",playlistUpNextText:"playlist.up_next"})(n=function(e){u()(r,e);var t=E(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"render",value:function(e){var t,r,n=e.type,a=e.item,i=e.onClick,o="next"===n?k.IconType.Next:k.IconType.Prev,s=e["".concat(e.type,"ControlsText")],l="prev"===n?this.props.playlistPrevText:this.props.playlistUpNextText,u=null==a||null===(t=a.sources)||void 0===t?void 0:t.poster,c=(null==a||null===(r=a.sources)||void 0===r?void 0:r.metadata)?a.sources.metadata.name:"",d=(0,g.h)(v.Button,{disabled:!a,tabIndex:"0","aria-label":s,className:"".concat(m().controlButton),onClick:i},(0,g.h)("div",null,(0,g.h)(k.default,{type:o})));return(0,g.h)("div",{className:[m().controlButtonContainer,m().controlPlaylistButton].join(" ")},e.showPreview&&(u||c)?(0,g.h)(g.Fragment,null,(0,g.h)("div",{className:m().posterPreview},u?(0,g.h)("div",{className:m().posterPreviewImg,style:"background-image: url(".concat(u,");")}):void 0,(0,g.h)("div",{className:m().posterPreviewText},(0,g.h)("div",{className:m().posterPreviewTextTitle},l),(0,g.h)("div",{className:m().posterPreviewTextName},"".concat(c||"")))),d):(0,g.h)(_.Tooltip,{label:s},d))}}]),r}(g.Component))||n},"./src/components/playlist-countdown/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaylistCountdown:function(){return n.PlaylistCountdown}});var n=r("./src/components/playlist-countdown/playlist-countdown.tsx")},"./src/components/playlist-countdown/playlist-countdown.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaylistCountdown:function(){return O}});var n,a,i,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),A=r("./src/components/icon/index.ts"),S=r("./src/utils/index.ts"),C=r("./node_modules/react-redux/es/index.js"),P=r("./src/components/player/index.ts"),x=r("./src/components/logger/index.ts"),w=r("./src/reducers/playlist.ts"),I=r("./src/event/index.ts"),M=r("./src/components/button/index.ts");function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var D="PlaylistCountdown",O=(n=(0,C.connect)((function(e){return{playlist:e.engine.playlist,currentTime:e.engine.currentTime,duration:e.engine.duration,lastSeekPoint:e.engine.lastSeekPoint,isSeeking:e.engine.isSeeking,isPlaybackEnded:e.engine.isPlaybackEnded,countdownCanceled:e.playlist.countdownCanceled}}),(0,S.bindActions)(w.actions)),a=(0,x.withLogger)(D),n(i=(0,P.withPlayer)(i=(0,I.withEventManager)(i=a(i=function(e){h()(r,e);var t=R(r);function r(e){var n;return s()(this,r),n=t.call(this,e),_()(d()(n),"focusElement",void 0),_()(d()(n),"nextShown",void 0),_()(d()(n),"onClick",(function(){n.props.player.playlist.playNext()})),_()(d()(n),"cancelNext",(function(e){n.props.logger.debug("Cancel auto play next item"),e.stopPropagation(),n.props.updatePlaylistCountdownCanceled(!0)})),_()(d()(n),"onKeyDown",(function(e){switch(e.keyCode){case S.KeyMap.ENTER:n.onClick();break;case S.KeyMap.ESC:n.cancelNext(e)}})),_()(d()(n),"onCancelButtonKeyDown",(function(e){e.keyCode===S.KeyMap.ENTER&&n.cancelNext(e)})),n.setState({focusable:!1}),n}return u()(r,[{key:"_shouldRender",value:function(e){return this.state.timeToShow&&e.playlist&&e.playlist.next&&e.playlist.next.sources&&e.player.playlist.countdown.showing&&(e.player.playlist.options.autoContinue||e.player.playlist.options.loop)}},{key:"_getTimeToShow",value:function(){var e=this.props.player.playlist.countdown,t=this.props.duration-e.duration;return e.timeToShow>=0&&e.timeToShow<=this.props.duration&&(t=Math.max(e.timeToShow,this.props.lastSeekPoint)),Math.max(0,Math.min(t,this.props.duration))}},{key:"componentWillUpdate",value:function(e){var t=this._getTimeToShow();e.currentTime>=t?this.setState({timeToShow:!0}):(this.setState({timeToShow:!1}),this.props.updatePlaylistCountdownCanceled(!1))}},{key:"isHidden",value:function(e){return!e.timeToShow||this.props.player.playlist.countdown.duration>=this.props.duration}},{key:"isCanceled",value:function(){return this.props.countdownCanceled}},{key:"isShown",value:function(e){return!this.isHidden(e)&&!this.isCanceled()}},{key:"componentDidUpdate",value:function(e,t){var r=this;if(this._shouldRender(e)){var n=this._getTimeToShow(),a=this.props.player.playlist.countdown;e.isSeeking||this.props.countdownCanceled||!(this.props.isPlaybackEnded||this.props.currentTime>=n+a.duration&&this.props.currentTime<this.props.duration)||this.props.player.playlist.playNext()}!t.shown&&this.state.shown?this.focusElement&&this.props.eventManager.listenOnce(this.focusElement,"animationend",(function(){r.isShown(r.state)&&(r.focusElement.focus(),r.setState({focusable:!0}))})):t.shown&&!this.state.shown&&this.setState({focusable:!1}),this.isShown(this.state)!==this.state.shown&&this.setState((function(e){return{shown:r.isShown(e)}}))}},{key:"shouldComponentUpdate",value:function(e){return this.props.duration>0&&!e.isSeeking&&!this.props.isPlaybackEnded}},{key:"render",value:function(e){var t=this;if(this._shouldRender(e)&&(this.isShown(this.state)&&(this.nextShown=e.playlist.next),e.playlist.next&&e.playlist.next.sources&&this.nextShown)){var r=this.props.player.playlist.countdown,n=this._getTimeToShow(),a=e.currentTime-n,i=Math.min(r.duration,e.duration-n),o=Math.ceil(i-(a>0?a:0)),s=[E().playlistCountdown];return this.isHidden(this.state)?s.push(E().hidden):this.isCanceled()?s.push(E().canceled):s.push(E().slideIn),(0,b.h)("div",{role:"button","aria-labelledby":"playlistCountdownTextId",ref:function(e){return e?t.focusElement=e:void 0},tabIndex:this.state.focusable?0:-1,className:s.join(" "),onKeyDown:this.onKeyDown,onClick:this.onClick},(0,b.h)("div",{className:E().playlistCountdownPoster,style:"background-image: url(".concat(this.nextShown.sources.poster,");")}),(0,b.h)("div",{className:E().playlistCountdownContentPlaceholder},(0,b.h)("div",{className:E().playlistCountdownContentBackground},(0,b.h)("div",{className:E().playlistCountdownContent},(0,b.h)(T.Localizer,null,(0,b.h)("div",{id:"playlistCountdownTextId",className:E().playlistCountdownText},(0,b.h)("div",{className:E().playlistCountdownTextTitle},(0,b.h)(T.Text,{id:"playlist.up_next_in"}),(0,b.h)("div",{className:E().playlistCountdownTimeLeft},o)),(0,b.h)("div",{className:E().playlistCountdownTextName},"".concat(this.nextShown.sources.metadata?this.nextShown.sources.metadata.name:"")))),(0,b.h)("div",{className:[E().controlButtonContainer,E().playlistCountdownCancel].join(" ")},(0,b.h)(T.Localizer,null,(0,b.h)(M.Button,{tabIndex:this.state.focusable?0:-1,"aria-label":(0,b.h)(T.Text,{id:"playlist.cancel"}),className:[E().controlButton,E().playlistCountdownCancelButton].join(" "),onClick:this.cancelNext,onKeyDown:this.onCancelButtonKeyDown},(0,b.h)(A.default,{type:A.IconType.Close}))))))))}}}]),r}(b.Component))||i)||i)||i)||i);O.displayName=D},"./src/components/playlist-next-screen/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaylistNextScreen:function(){return n.PlaylistNextScreen}});var n=r("./src/components/playlist-next-screen/playlist-next-screen.tsx")},"./src/components/playlist-next-screen/playlist-next-screen.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PlaylistNextScreen:function(){return M}});var n,a,i,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/components/icon/index.ts"),C=r("./src/utils/index.ts"),P=r("./src/components/player/index.ts"),x=r("./src/components/logger/index.ts");function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var I="PlaylistNextScreen",M=(n=(0,A.connect)((function(e){return{playlist:e.engine.playlist,isPlaybackEnded:e.engine.isPlaybackEnded}})),a=(0,x.withLogger)(I),n(i=(0,P.withPlayer)(i=a(i=function(e){h()(r,e);var t=w(r);function r(){var e;s()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(d()(e),"focusElement",void 0),_()(d()(e),"onPosterClick",(function(){e.props.player.playlist.playNext()})),_()(d()(e),"onKeyDown",(function(t){t.keyCode!==C.KeyMap.ENTER&&t.keyCode!==C.KeyMap.SPACE||(t.preventDefault(),e.onPosterClick())})),e}return u()(r,[{key:"componentDidUpdate",value:function(e){!this._shouldRender(e)&&this._shouldRender(this.props)&&this.focusElement&&this.focusElement.focus()}},{key:"_shouldRender",value:function(e){return!(!(e.playlist&&e.playlist.next&&e.playlist.next.sources&&e.isPlaybackEnded)||e.player.playlist.options.autoContinue)}},{key:"_getPosterUrl",value:function(){var e=this.props.playlist.next;return e.sources.poster?e.sources.poster.indexOf("entry_id/".concat(e.sources.id))>-1&&-1===e.sources.poster.indexOf("/width/")?"".concat(e.sources.poster,"/width/").concat(384):e.sources.poster:""}},{key:"render",value:function(e){var t=this;if(this._shouldRender(e)){var r=e.playlist.next;return(0,b.h)("div",{className:E().playlistNextScreenOverlay},(0,b.h)("div",{className:E().playlistNextScreenContent},(0,b.h)("div",{id:"playlistNextScreenTextId",className:E().playlistNextScreenText},(0,b.h)(T.Localizer,null,(0,b.h)("div",{className:E().playlistNextScreenTextTitle},(0,b.h)(T.Text,{id:"playlist.next"}))),(0,b.h)("div",{className:E().playlistNextScreenTextName},"".concat(r.sources.metadata?r.sources.metadata.name:""))),(0,b.h)("div",{className:E().playlistNextScreenPosterPlaceholder},(0,b.h)("div",{className:E().playlistNextScreenPosterAspectRatio},(0,b.h)("div",{role:"button","aria-labelledby":"playlistNextScreenTextId",ref:function(e){return e?t.focusElement=e:void 0},tabIndex:0,className:E().playlistNextScreenPoster,onClick:this.onPosterClick,onKeyDown:this.onKeyDown},(0,b.h)("div",{className:E().playlistNextScreenPosterImg,style:"background-image: url(".concat(this._getPosterUrl(),");")}),(0,b.h)(S.default,{type:S.IconType.Play}))))))}}}]),r}(b.Component))||i)||i)||i);M.displayName=I},"./src/components/pre-playback-play-overlay/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PrePlaybackPlayOverlay:function(){return n.PrePlaybackPlayOverlay}});var n=r("./src/components/pre-playback-play-overlay/pre-playback-play-overlay.tsx")},"./src/components/pre-playback-play-overlay/pre-playback-play-overlay.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PrePlaybackPlayOverlay:function(){return U}});var n,a,i,o,s,l=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/inherits.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_=r.n(v),k=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=r.n(k),b=r("./src/styles/style.scss"),T=r.n(b),A=r("./node_modules/preact/dist/preact.module.js"),S=r("./node_modules/react-redux/es/index.js"),C=r("./src/utils/index.ts"),P=r("./src/components/icon/index.ts"),x=r("./src/reducers/loading.ts"),w=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),I=r("./src/components/player/index.ts"),M=r("./src/components/event-dispatcher/index.ts"),R=r("./src/components/logger/index.ts"),D=r("./src/components/tooltip/index.ts"),O=r("./src/components/button/index.ts");function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_()(e);if(t){var a=_()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return y()(this,r)}}var N="PrePlaybackPlayOverlay",U=(n=(0,S.connect)((function(e){return{prePlayback:e.engine.prePlayback,isPlaybackEnded:e.engine.isPlaybackEnded,playlist:e.engine.playlist,loading:e.loading.show}}),(0,C.bindActions)(x.actions)),a=(0,R.withLogger)(N),i=(0,M.withEventDispatcher)(N),o=(0,w.withText)({startOverText:"controls.startOver",playText:"controls.play"}),n(s=(0,I.withPlayer)(s=a(s=i(s=o(s=function(e){m()(r,e);var t=L(r);function r(){var e;u()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),E()(h()(e),"handleClick",(function(){e.props.playlist&&e.props.isPlaybackEnded?e.props.player.playlist.playNext():e.props.player.play(),e.props.notifyClick()})),E()(h()(e),"onKeyDown",(function(t){t.keyCode===C.KeyMap.ENTER&&e.handleClick()})),E()(h()(e),"onMouseOver",(function(e){e.stopPropagation()})),e}return d()(r,[{key:"render",value:function(e){var t=e.isPlaybackEnded&&!e.player.config.playback.loop&&!(e.playlist&&e.playlist.next);if((e.prePlayback||t)&&!e.loading){var r=e.isPlaybackEnded?e.startOverText:e.playText;return(0,A.h)("div",{className:T().prePlaybackPlayOverlay,onMouseOver:this.onMouseOver,onClick:this.handleClick},(0,A.h)(O.Button,{className:T().prePlaybackPlayButton,tabIndex:"0","aria-label":r,onKeyDown:this.onKeyDown},(0,A.h)(D.Tooltip,{label:r},e.isPlaybackEnded?(0,A.h)(P.default,{type:P.IconType.StartOver}):(0,A.h)(P.default,{type:P.IconType.Play}))))}}}]),r}(A.Component))||s)||s)||s)||s)||s);U.displayName=N},"./src/components/progress-indicator/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ProgressIndicator:function(){return n.ProgressIndicator}});var n=r("./src/components/progress-indicator/progress-indicator.tsx")},"./src/components/progress-indicator/progress-indicator.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ProgressIndicator:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/preact/dist/preact.module.js"),m=r("./src/styles/style.scss"),g=r.n(m),y=r("./node_modules/react-redux/es/index.js"),v=r("./src/components/player/index.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k=(0,y.connect)((function(e){return{dataLoaded:e.engine.dataLoaded,currentTime:e.seekbar.currentTime,duration:e.engine.duration,isMobile:e.shell.isMobile,adBreak:e.engine.adBreak}}))(n=(0,v.withPlayer)(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"getBufferedPercent",value:function(){var e=this.props.player;if(this.props.duration>0&&e.buffered.length>0){var t=(e.isLive()?e.buffered.end(0)-e.getStartTimeOfDvrWindow():e.buffered.end(0))/this.props.duration*100;return t<100?t:100}return 0}},{key:"render",value:function(e){var t="".concat(Math.round(this.getBufferedPercent()),"%"),r="".concat(e.player.isLive()&&e.player.isOnLiveEdge()?100:e.currentTime/e.duration*100,"%");return(0,f.h)(f.Fragment,null,(0,f.h)("div",{className:g().buffered,style:{width:t}}),e.dataLoaded?(0,f.h)("div",{className:g().progress,style:{width:r}}):void 0)}}]),r}(f.Component))||n)||n;k.displayName="ProgressIndicator"},"./src/components/quality-menu/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{HeightResolution:function(){return n.HeightResolution},QualityMenu:function(){return n.QualityMenu},getLabelBadgeType:function(){return n.getLabelBadgeType}});var n=r("./src/components/quality-menu/quality-menu.tsx")},"./src/components/quality-menu/quality-menu.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{HeightResolution:function(){return w},QualityMenu:function(){return D},getLabelBadgeType:function(){return I}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),E=r("./node_modules/react-redux/es/index.js"),b=r("./src/utils/index.ts"),T=r("./src/reducers/settings.ts"),A=r("./src/components/index.ts"),S=r("./src/components/icon/index.ts"),C=r("./src/components/player/index.ts"),P=r("./src/components/event-dispatcher/index.ts");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var w={HD:1080,UHD_4K:2160,UHD_8K:4320};function I(e){var t=Object.keys(A.BadgeType),r=v()(t,5),n=r[0],a=r[2],i=r[4];return e>=w.HD&&e<w.UHD_4K?n:e>=w.UHD_4K&&e<w.UHD_8K?a:e>=w.UHD_8K?i:null}var M=["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"],R="QualityMenu",D=(n=(0,E.connect)((function(e){return{videoTracks:e.engine.videoTracks}}),(0,b.bindActions)(T.actions)),a=(0,P.withEventDispatcher)(R),i=(0,k.withText)({qualityLabelText:"settings.quality",qualityAutoLabelText:"settings.qualityAuto"}),n(o=(0,C.withPlayer)(o=a(o=i(o=function(e){p()(r,e);var t=x(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"onQualityChange",value:function(e){this.props.updateQuality(e);var t=this.props.player;"auto"===e?t.enableAdaptiveBitrate():t.selectTrack(e),this.props.notifyClick({type:t.Track.VIDEO,track:e})}},{key:"filterUniqueQualities",value:function(e,t){var r=e.length-1,n=e[r];return r>-1&&t.label===n.label?(t.bandwidth>n.bandwidth&&(e[r]=t),e[r].active=t.active||n.active):e.push(t),e}},{key:"render",value:function(e){var t=this,r=e.videoTracks.sort((function(e,t){return e.height<t.height?1:-1})).filter((function(e){return e.bandwidth||e.height})).reduce(this.filterUniqueQualities,[]).map((function(t){return{label:t.label,active:!e.player.isAdaptiveBitrateEnabled()&&t.active,value:t,badgeType:I(t.height)}}));if(r.length>1&&"progressive"!==e.player.streamType){var n,a,i=null===(n=r.find((function(e){return!0===e.value.active})))||void 0===n?void 0:n.value,o=(null==i?void 0:i.label)||"".concat(360,"p");a=M.includes(this.props.player._localPlayer._config.ui.locale)?o+" - "+this.props.qualityAutoLabelText:this.props.qualityAutoLabelText+" - "+o,r.unshift({label:this.props.qualityAutoLabelText,dropdownOptions:{label:a,badgeType:I((null==i?void 0:i.height)||360)},active:e.player.isAdaptiveBitrateEnabled(),value:"auto"})}return(0,_.h)(A.SmartContainerItem,{pushRef:function(t){e.pushRef(t)},icon:S.IconType.Quality,label:e.qualityLabelText,options:r,onMenuChosen:function(e){return t.onQualityChange(e)}})}}]),r}(_.Component))||o)||o)||o)||o);D.displayName=R},"./src/components/rewind/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Rewind:function(){return n.Rewind}});var n=r("./src/components/rewind/rewind.tsx")},"./src/components/rewind/rewind.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{REWIND_DEFAULT_STEP:function(){return j},Rewind:function(){return B}});var n,a,i,o,s,l,u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),C=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),P=r("./src/components/icon/index.ts"),x=r("./src/utils/with-animation.tsx"),w=r("./src/components/player/index.ts"),I=r("./src/components/event-dispatcher/index.ts"),M=r("./src/components/logger/index.ts"),R=r("./src/components/tooltip/index.ts"),D=r("./src/components/button/index.ts"),O=r("./node_modules/react-redux/es/index.js"),L=r("./src/components/button-control/index.ts");function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}var U="Rewind",j=10,B=(n=(0,O.connect)((function(e){return{isDvr:e.engine.isDvr,isLive:e.engine.isLive}})),a=(0,M.withLogger)(U),i=(0,I.withEventDispatcher)(U),o=(0,x.withAnimation)(A().rotate),s=(0,C.withText)((function(e){return{rewindText:(0,S.h)(C.Text,{id:"controls.secondsRewind",fields:{seconds:e.step||j}})}})),n(l=(0,w.withPlayer)(l=a(l=i(l=o(l=s(l=function(e){g()(r,e);var t=N(r);function r(){var e;c()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(f()(e),"onClick",(function(){var t,r=e.props.player;e.props.animate();var n=e.props.step||j,a=r.currentTime,i=r.isLive()?r.getStartTimeOfDvrWindow():0;r.currentTime-n<i?e.props.isDvr||(t=i):t=r.currentTime-n,r.currentTime=t,e.props.notifyClick({from:a,to:t})})),e}return p()(r,[{key:"_shouldRender",value:function(){var e=!(this.props.isLive&&!this.props.isDvr);return this.props.onToggle(U,e),e}},{key:"render",value:function(e){var t=e.step,r=e.rewindText,n=e.innerRef;return this._shouldRender()?(0,S.h)(L.ButtonControl,{name:U,className:A().noIdleControl},(0,S.h)(R.Tooltip,{label:r},(0,S.h)(D.Button,{tabIndex:"0","aria-label":r,className:"".concat(A().controlButton),ref:n,onClick:this.onClick},(0,S.h)(P.default,{type:t&&t!==j?P.IconType.Rewind:P.IconType.Rewind10})))):void 0}}]),r}(S.Component))||l)||l)||l)||l)||l)||l);B.displayName=U},"./src/components/scrollable/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Scrollable:function(){return n.Scrollable}});var n=r("./src/components/scrollable/scrollable.tsx")},"./src/components/scrollable/scrollable.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Scrollable:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),o=r.n(i),s=r("./node_modules/preact/dist/preact.module.js"),l=r("./node_modules/preact/hooks/dist/hooks.module.js"),u=r("./src/styles/style.scss"),c=r.n(u),d=function(e){var t=e.children,r=e.isVertical,n=(0,l.useRef)(null),i=(0,l.useRef)(null),u=(0,l.useState)(!1),d=o()(u,2),p=d[0],h=d[1],f=(0,l.useState)(-1),m=o()(f,2),g=m[0],y=m[1],v=(0,l.useState)(-1),_=o()(v,2),k=_[0],E=_[1],b=function(){clearTimeout(g),h(!0),y(window.setTimeout((function(){h(!1)}),250))},T=function(e){e.preventDefault(),(null==n?void 0:n.current)&&(n.current.scrollLeft+=e.deltaY,b())};(0,l.useLayoutEffect)((function(){if(r&&(null==n?void 0:n.current)&&(null==i?void 0:i.current)){var e,t=n.current,a=null===(e=t.parentElement)||void 0===e?void 0:e.clientHeight;if(a){var o=getComputedStyle(t.parentElement),s=a-(parseFloat(o.paddingTop)+parseFloat(o.paddingBottom));i.current.clientHeight>s?E(s):-1!==k&&E(-1)}}}));var A=(0,l.useMemo)((function(){return r?{onScroll:b}:{onWheel:T,ref:n}}),[r]);return(0,s.h)("div",a()({className:"".concat(c().scrollable," ").concat(p?c().scrolling:""," ").concat(r?c().vertical:c().horizontal),style:"".concat(r&&k>-1?"height: ".concat(k,"px"):""),ref:n},A),(0,s.h)("div",{className:c().itemsContainer,ref:i},t))}},"./src/components/seekbar-live-playback-container/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBarLivePlaybackContainer:function(){return n.SeekBarLivePlaybackContainer}});var n=r("./src/components/seekbar-live-playback-container/seekbar-live-playback-container.tsx")},"./src/components/seekbar-live-playback-container/seekbar-live-playback-container.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBarLivePlaybackContainer:function(){return x}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./node_modules/react-redux/es/index.js"),_=r("./src/utils/index.ts"),k=r("./src/reducers/seekbar.ts"),E=r("./src/components/seekbar/index.ts"),b=r("./src/components/player/index.ts"),T=r("./src/event/index.ts"),A=r("./src/components/logger/index.ts"),S=r("./src/components/event-dispatcher/index.ts");function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var P="SeekBarLivePlaybackContainer",x=(n=(0,v.connect)((function(e){return{currentTime:e.seekbar.currentTime,virtualTime:e.seekbar.virtualTime,isDraggingActive:e.seekbar.draggingActive,isMobile:e.shell.isMobile,poster:e.engine.poster,isDvr:e.engine.isDvr,dataLoaded:e.engine.dataLoaded}}),(0,_.bindActions)(k.actions)),a=(0,S.withEventDispatcher)(P),i=(0,A.withLogger)(P),n(o=(0,b.withPlayer)(o=(0,T.withEventManager)(o=a(o=i(o=function(e){p()(r,e);var t=C(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.eventManager,r=e.player,n=e.isDraggingActive,a=e.updateCurrentTime;t.listen(r,r.Event.TIME_UPDATE,(function(){n||a(Math.max(r.normalizedCurrentTime,0))})),t.listen(r,r.Event.LOADED_DATA,(function(){a(Math.max(r.normalizedCurrentTime,0))}))}},{key:"render",value:function(e){var t=this;if(e.isDvr)return(0,y.h)(E.SeekBar,{playerElement:this.props.playerContainer,showFramePreview:this.props.showFramePreview,showTimeBubble:this.props.showTimeBubble,changeCurrentTime:function(e){t.props.player.isOnLiveEdge()&&e===t.duration||(t.props.player.normalizedCurrentTime=e)},playerPoster:this.props.poster,updateSeekbarDraggingStatus:function(e){return t.props.updateSeekbarDraggingStatus(e)},updateSeekbarHoverActive:function(e){return t.props.updateSeekbarHoverActive(e)},updateSeekbarClientRect:function(e){return t.props.updateSeekbarClientRect(e)},updateCurrentTime:function(e){return t.props.updateCurrentTime(e)},updateVirtualTime:function(e){return t.props.updateVirtualTime(e)},isDvr:this.props.isDvr,currentTime:this.currentTime,virtualTime:this.props.virtualTime,duration:this.duration,isDraggingActive:this.props.isDraggingActive,isMobile:this.props.isMobile,notifyChange:function(e){return t.props.notifyChange(e)},forceFullProgress:this.props.player.isOnLiveEdge(),dataLoaded:this.props.dataLoaded})}},{key:"currentTime",get:function(){return Math.min(this.props.currentTime,this.duration)}},{key:"duration",get:function(){return this.props.player.normalizedDuration}}]),r}(y.Component))||o)||o)||o)||o)||o);x.displayName=P},"./src/components/seekbar-playback-container/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBarPlaybackContainer:function(){return n.SeekBarPlaybackContainer}});var n=r("./src/components/seekbar-playback-container/seekbar-playback-container.tsx")},"./src/components/seekbar-playback-container/seekbar-playback-container.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBarPlaybackContainer:function(){return x}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./node_modules/react-redux/es/index.js"),_=r("./src/utils/index.ts"),k=r("./src/reducers/seekbar.ts"),E=r("./src/components/seekbar/index.ts"),b=r("./src/components/player/index.ts"),T=r("./src/event/index.ts"),A=r("./src/components/logger/index.ts"),S=r("./src/components/event-dispatcher/index.ts");function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var P="SeekBarPlaybackContainer",x=(n=(0,v.connect)((function(e){return{currentTime:e.seekbar.currentTime,virtualTime:e.seekbar.virtualTime,duration:e.engine.duration,isDraggingActive:e.seekbar.draggingActive,isMobile:e.shell.isMobile,poster:e.engine.poster,dataLoaded:e.engine.dataLoaded}}),(0,_.bindActions)(k.actions)),a=(0,A.withLogger)(P),i=(0,S.withEventDispatcher)(P),n(o=(0,b.withPlayer)(o=(0,T.withEventManager)(o=a(o=i(o=function(e){p()(r,e);var t=C(r);function r(){return l()(this,r),t.apply(this,arguments)}return c()(r,[{key:"componentDidMount",value:function(){var e=this;this.props.eventManager.listen(this.props.player,this.props.player.Event.TIME_UPDATE,(function(){e.props.isDraggingActive||e.props.updateCurrentTime(e.props.player.currentTime)}))}},{key:"render",value:function(){var e=this;return(0,y.h)(E.SeekBar,{playerElement:this.props.playerContainer,showFramePreview:this.props.showFramePreview,showTimeBubble:this.props.showTimeBubble,changeCurrentTime:function(t){return e.props.player.currentTime=t},playerPoster:this.props.poster,updateSeekbarDraggingStatus:function(t){return e.props.updateSeekbarDraggingStatus(t)},updateSeekbarHoverActive:function(t){return e.props.updateSeekbarHoverActive(t)},updateSeekbarClientRect:function(t){return e.props.updateSeekbarClientRect(t)},updateCurrentTime:function(t){return e.props.updateCurrentTime(t)},updateVirtualTime:function(t){return e.props.updateVirtualTime(t)},currentTime:this.props.currentTime,virtualTime:this.props.virtualTime,duration:this.props.duration,isDraggingActive:this.props.isDraggingActive,isMobile:this.props.isMobile,notifyChange:function(t){return e.props.notifyChange(t)},dataLoaded:this.props.dataLoaded})}}]),r}(y.Component))||o)||o)||o)||o)||o);x.displayName=P},"./src/components/seekbar-preview/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBarPreview:function(){return n.SeekBarPreview}});var n=r("./src/components/seekbar-preview/seekbar-preview.tsx")},"./src/components/seekbar-preview/seekbar-preview.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBarPreview:function(){return E}});var n,a,i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./src/styles/style.scss"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./node_modules/react-redux/es/index.js"),_=r("./src/components/player/index.ts");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var E=(n=(0,v.connect)((function(e){return{duration:e.engine.duration}})),(0,_.withPlayer)(a=n(a=function(e){c()(r,e);var t=k(r);function r(){return o()(this,r),t.apply(this,arguments)}return l()(r,[{key:"_getFramePreviewImgStyle",value:function(e){var t="background: url(".concat(e.url,");");return t+="background-position: -".concat(e.x,"px -").concat(e.y,"px;")}},{key:"_getFramePreviewImgContainerStyle",value:function(e){return{height:"".concat(e.height+4,"px"),width:"".concat(e.width+4,"px")}}},{key:"render",value:function(){var e=this.props.player.getThumbnail(this.props.virtualTime);if(e)return(0,y.h)("div",{style:this._getFramePreviewImgContainerStyle(e),className:[g().framePreviewImgContainer,g().nonSticky].join(" ")},(0,y.h)("div",{className:g().framePreviewImg,style:this._getFramePreviewImgStyle(e)}))}}]),r}(y.Component))||a)||a);E.displayName="SeekBarPreview"},"./src/components/seekbar/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBar:function(){return n.SeekBar}});var n=r("./src/components/seekbar/seekbar.tsx")},"./src/components/seekbar/seekbar.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekBar:function(){return H}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),C=r("./src/utils/index.ts"),P=r("./node_modules/react-redux/es/index.js"),x=r("./src/reducers/shell.ts"),w=r("./src/components/player/index.ts"),I=r("./src/components/keyboard/index.ts"),M=r("./src/reducers/overlay-action.ts"),R=r("./src/components/icon/index.ts"),D=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),O=r("./src/components/player-area/index.ts"),L=r("./src/event/index.ts"),N=r("./src/components/seekbar-preview/index.ts"),U=r("./src/components/progress-indicator/index.ts");function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){b()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var V="SeekBar",H=(n=(0,P.connect)((function(e){return{config:e.config.components.seekbar,isMobile:e.shell.isMobile,previewHoverActive:e.seekbar.previewHoverActive,hidePreview:e.seekbar.hidePreview,hideTimeBubble:e.seekbar.hideTimeBubble,segments:e.seekbar.segments,seekbarClasses:e.seekbar.seekbarClasses,isPreventSeek:e.seekbar.isPreventSeek}}),(0,C.bindActions)(F(F({},x.actions),M.actions))),a=(0,I.withKeyboardEvent)(V),i=(0,D.withText)({sliderAriaLabel:"controls.seekBarSlider"}),n(o=(0,w.withPlayer)(o=(0,L.withEventManager)(o=a(o=i(o=function(e){g()(r,e);var t=j(r);function r(){var e;c()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(f()(e),"_seekBarElement",void 0),b()(f()(e),"_framePreviewElement",void 0),b()(f()(e),"_timeBubbleElement",void 0),b()(f()(e),"_keyboardEventHandlers",[{key:{code:C.KeyMap.LEFT},action:function(t){e.handleKeydown(t,!1)}},{key:{code:C.KeyMap.RIGHT},action:function(t){e.handleKeydown(t,!1)}},{key:{code:C.KeyMap.HOME},action:function(t){e.handleKeydown(t,!1)}},{key:{code:C.KeyMap.END},action:function(t){e.handleKeydown(t,!1)}}]),b()(f()(e),"onSeekbarMouseDown",(function(t){if(!e.props.isMobile&&!e.props.previewHoverActive&&(t.preventDefault(),t.stopPropagation(),e.props.updateSeekbarDraggingStatus(!0),e.props.isDraggingActive)){var r=e.getTime(t);e.updateSeekBarProgress(r,e.props.duration)}})),b()(f()(e),"onPlayerMouseUp",(function(t){if(!e.props.isMobile&&!e.props.previewHoverActive&&e.props.isDraggingActive){var r=e.props.currentTime,n=e.getTime(t);e.props.changeCurrentTime(n),e.updateSeekBarProgress(n,e.props.duration),e.props.updateSeekbarDraggingStatus(!1),e.props.notifyChange({from:r,to:n})}})),b()(f()(e),"onPlayerMouseMove",(function(t){if(!e.props.isMobile&&e.props.isDraggingActive){var r=e.getTime(t);e.updateSeekBarProgress(r,e.props.duration),e.updateSeekBarProgress(r,e.props.duration,!0)}})),b()(f()(e),"onSeekbarMouseMove",(function(t){if(!e.props.isMobile&&!e.props.previewHoverActive){var r=e.getTime(t);e.updateSeekBarProgress(r,e.props.duration,!0)}})),b()(f()(e),"onSeekbarTouchStart",(function(t){if(e.props.updateSeekbarDraggingStatus(!0),e.props.isDraggingActive){var r=e.getTime(t);e.updateSeekBarProgress(r,e.props.duration)}})),b()(f()(e),"onSeekbarTouchMove",(function(t){var r=e.getTime(t);e.updateSeekBarProgress(r,e.props.duration,!0),e.props.isDraggingActive&&e.updateSeekBarProgress(r,e.props.duration),t.preventDefault()})),b()(f()(e),"onKeyDown",(function(t){switch(t.keyCode){case C.KeyMap.LEFT:case C.KeyMap.RIGHT:e.handleKeydown(t,!0);break;case C.KeyMap.ENTER:case C.KeyMap.SPACE:t.preventDefault(),e.togglePlayPause()}})),b()(f()(e),"togglePlayPause",(function(){e.props.player.paused?e.props.player.play():e.props.player.pause()})),b()(f()(e),"onSeekbarTouchEnd",(function(t){if(e.props.isDraggingActive){var r=e.getTime(t),n=e.props.currentTime,a=r;e.props.changeCurrentTime(a),e.updateSeekBarProgress(a,e.props.duration),e.props.notifyChange({from:n,to:a})}e.props.updateSeekbarDraggingStatus(!1)})),b()(f()(e),"onSeekbarMouseOver",(function(){e.props.isMobile||e.props.updateSeekbarHoverActive(!0)})),b()(f()(e),"onSeekbarMouseLeave",(function(){e.props.isMobile||e.props.updateSeekbarHoverActive(!1)})),e}return p()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.player,n=t.eventManager,a=this._seekBarElement.getBoundingClientRect();this.props.updateSeekbarClientRect(a),n.listen(r,L.EventType.GUI_RESIZE,(function(){e.setState({resizing:!0}),setTimeout((function(){var t=e._seekBarElement.getBoundingClientRect();e.props.updateSeekbarClientRect(t),e.setState({resizing:!1})}),Number(A().defaultTransitionTime))})),document.addEventListener("mouseup",this.onPlayerMouseUp),document.addEventListener("mousemove",this.onPlayerMouseMove),this.props.registerKeyboardEvents(this._keyboardEventHandlers)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseup",this.onPlayerMouseUp),document.removeEventListener("mousemove",this.onPlayerMouseMove)}},{key:"handleKeydown",value:function(e,t){var r=this,n=this.props,a=n.duration,i=n.currentTime,o=function(e,t){r.props.changeCurrentTime(t),r.updateSeekBarProgress(t,a,!0),r.props.notifyChange({from:e,to:t})};switch(this.props.updatePlayerHoverState(!0),e.keyCode){case C.KeyMap.LEFT:t||this.props.updateOverlayActionIcon(R.IconType.Rewind),o(i,i-5>0?i-5:0);break;case C.KeyMap.RIGHT:t||this.props.updateOverlayActionIcon(R.IconType.Forward),o(i,i+5>a?a:i+5);break;case C.KeyMap.HOME:t||this.props.updateOverlayActionIcon(R.IconType.StartOver),o(i,0);break;case C.KeyMap.END:t||this.props.updateOverlayActionIcon(R.IconType.SeekEnd),o(i,a)}}},{key:"updateSeekBarProgress",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.props.updateVirtualTime(e):this.props.updateCurrentTime(e)}},{key:"getOffset",value:function(e){for(var t=0,r=0;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)t+=e.offsetLeft-e.scrollLeft+this._getTransformX(e),r+=e.offsetTop-e.scrollTop,e=e.offsetParent;return this.props.player.isFullscreen()&&(t=0),{top:r,left:t}}},{key:"_getTransformX",value:function(e){var t=getComputedStyle(e),r=(t.getPropertyValue("transform")||t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")).match(/-?\d+/g),n=0;return r&&r.length>0&&(n=parseFloat(r[4])),n}},{key:"getTime",value:function(e){var t,r=("number"==typeof e.clientX?e.clientX:null==e||null===(t=e.changedTouches[0])||void 0===t?void 0:t.clientX)-this._seekBarElement.getBoundingClientRect().left,n=parseFloat((this.props.duration/this._seekBarElement.offsetWidth*r).toFixed(2));return n<0?0:n>this.props.duration?this.props.duration:n}},{key:"getFramePreviewOffset",value:function(){if(this._seekBarElement&&this._framePreviewElement){var e=this.props.virtualTime/this.props.duration*this._seekBarElement.clientWidth-this._framePreviewElement.clientWidth/2;return e<0?0:e>this._seekBarElement.clientWidth-this._framePreviewElement.clientWidth?this._seekBarElement.clientWidth-this._framePreviewElement.clientWidth:e}return 0}},{key:"getTimeBubbleOffset",value:function(){if(this._timeBubbleElement){var e=this.props.virtualTime/this.props.duration*this._seekBarElement.clientWidth-this._timeBubbleElement.clientWidth/2;return e<0?0:e>this._seekBarElement.clientWidth-this._timeBubbleElement.clientWidth?this._seekBarElement.clientWidth-this._timeBubbleElement.clientWidth:e}return 0}},{key:"renderFramePreview",value:function(){var e=this;if(this.props.showFramePreview&&!this.props.isMobile&&!this.props.isPreventSeek)return(0,S.h)("div",{className:this.props.hidePreview?[A().framePreview,A().hideFramePreview].join(" "):A().framePreview,style:this._getFramePreviewStyle(),ref:function(t){return t?e._framePreviewElement=t:void 0}},(0,S.h)(N.SeekBarPreview,{virtualTime:this.props.virtualTime}))}},{key:"_getFramePreviewStyle",value:function(){return"left: ".concat(this.getFramePreviewOffset(),"px;")}},{key:"renderTimeBubble",value:function(){var e=this;if(!this.props.hideTimeBubble&&this.props.showTimeBubble&&!this.props.isMobile){var t="left: ".concat(this.getTimeBubbleOffset(),"px"),r=this.props.isDvr?"-"+(0,C.toHHMMSS)(this.props.duration-this.props.virtualTime):(0,C.toHHMMSS)(this.props.virtualTime);return(0,S.h)("div",{className:A().timePreview,style:t,ref:function(t){return t?e._timeBubbleElement=t:void 0}},r)}}},{key:"render",value:function(e,t){var r,n=this,a="".concat(e.virtualTime/e.duration*100,"%"),i="".concat(e.currentTime/e.duration*(null===(r=this._seekBarElement)||void 0===r?void 0:r.clientWidth),"px"),o=[A().seekBar].concat(l()(e.seekbarClasses));return e.adBreak&&o.push(A().adBreak),e.isDvr&&o.push(A().live),e.isMobile&&o.push(A().hover),e.isDraggingActive&&o.push(A().hover),t.resizing&&o.push(A().resizing),(0,S.h)("div",{tabIndex:0,className:o.join(" "),ref:function(e){return e?n._seekBarElement=e:void 0},role:"slider","aria-label":e.sliderAriaLabel,"aria-valuemin":0,"aria-valuemax":Math.round(this.props.duration),"aria-valuenow":Math.round(this.props.currentTime),"aria-valuetext":"".concat((0,C.toHHMMSS)(this.props.currentTime)," of ").concat((0,C.toHHMMSS)(this.props.duration)),onMouseOver:this.onSeekbarMouseOver,onMouseLeave:this.onSeekbarMouseLeave,onMouseMove:this.onSeekbarMouseMove,onMouseDown:this.onSeekbarMouseDown,onTouchStart:this.onSeekbarTouchStart,onTouchMove:this.onSeekbarTouchMove,onTouchEnd:this.onSeekbarTouchEnd,onKeyDown:this.onKeyDown},(0,S.h)("div",{className:A().progressBar},(0,S.h)(O.PlayerArea,{name:"SeekBar",shouldUpdate:!0},this.renderFramePreview(),this.renderTimeBubble(),(0,S.h)(U.ProgressIndicator,null),e.adBreak?void 0:(0,S.h)("div",{id:"scrubber-container",style:"transform: translateX(".concat(i,")")},(0,S.h)("div",{id:"scrubber",className:A().scrubber})),(0,S.h)("div",{className:A().virtualProgress,style:{width:a}},(0,S.h)("div",{className:A().virtualProgressIndicator})))))}}]),r}(S.Component))||o)||o)||o)||o)||o);H.displayName=V},"./src/components/settings/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Settings:function(){return n.Settings}});var n=r("./src/components/settings/settings.tsx")},"./src/components/settings/settings.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Settings:function(){return K}});var n,a,i,o,s,l=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/inherits.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_=r.n(v),k=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=r.n(k),b=r("./src/styles/style.scss"),T=r.n(b),A=r("./node_modules/preact/dist/preact.module.js"),S=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),C=r("./node_modules/react-redux/es/index.js"),P=r("./src/utils/index.ts"),x=r("./src/reducers/settings.ts"),w=r("./src/components/index.ts"),I=r("./src/components/icon/index.ts"),M=r("./src/components/player/index.ts"),R=r("./src/event/index.ts"),D=r("./src/reducers/overlay-action.ts"),O=r("./src/components/tooltip/index.ts"),L=r("./src/components/button/index.ts"),N=r("./src/components/button-control/index.ts"),U=r("./node_modules/preact/compat/dist/compat.module.js"),j=r("./src/components/keyboard/index.ts"),B=r("./src/components/logger/index.ts"),F=r("./src/event/events/speed-selected-event.ts");function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_()(e);if(t){var a=_()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return y()(this,r)}}function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){E()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var $="Settings",K=(n=(0,C.connect)((function(e){return{audioTracks:e.engine.audioTracks,textTracks:e.engine.textTracks,videoTracks:e.engine.videoTracks,isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize,isLive:e.engine.isLive,isAudio:e.engine.isAudio,showQualityMenu:e.config.settings.showQualityMenu,showAudioMenu:e.config.settings.showAudioMenu,showCaptionsMenu:e.config.settings.showCaptionsMenu,showSpeedMenu:e.config.settings.showSpeedMenu,showAdvancedAudioDescToggle:e.config.settings.showAdvancedAudioDescToggle}}),(0,P.bindActions)(G(G({},x.actions),D.actions))),a=(0,S.withText)((function(){return{buttonLabel:(0,A.h)(S.Text,{id:"controls.settings"},"Settings"),qualityHdLabel:(0,A.h)(S.Text,{id:"settings.qualityHdLabel"},"Quality is HD"),quality4kLabel:(0,A.h)(S.Text,{id:"settings.quality4kLabel"},"Quality is 4k"),quality8kLabel:(0,A.h)(S.Text,{id:"settings.quality8kLabel"},"Quality is 8k")}})),i=(0,j.withKeyboardEvent)($),o=(0,B.withLogger)($),n(s=a(s=(0,M.withPlayer)(s=(0,R.withEventManager)(s=i(s=o(s=function(e){m()(r,e);var t=V(r);function r(){var e;u()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),E()(h()(e),"_controlSettingsElement",void 0),E()(h()(e),"_buttonRef",null),E()(h()(e),"_lastActiveTextLanguage",""),E()(h()(e),"_keyboardEventHandlers",[{key:{code:P.KeyMap.C},action:function(){var t=e.props,r=t.player,n=t.logger,a=r.getActiveTracks().text;if(a)if("off"===a.language&&e._lastActiveTextLanguage){n.debug("Changing text track to language",e._lastActiveTextLanguage);var i=r.getTracks("text").find((function(t){return t.language===e._lastActiveTextLanguage}));r.selectTrack(i)}else"off"===a.language||e._lastActiveTextLanguage||(n.debug("Hiding text track"),e._lastActiveTextLanguage=a.language,r.hideTextTrack())}},{key:{code:P.KeyMap.PERIOD,shiftKey:!0},action:function(t){e.handleKeydown(t)}},{key:{code:P.KeyMap.SEMI_COLON,shiftKey:!0},action:function(t){e.handleKeydown(t)}},{key:{code:P.KeyMap.COMMA,shiftKey:!0},action:function(t){e.handleKeydown(t)}}]),E()(h()(e),"onControlButtonClick",(function(t,r){e.setState((function(e){return{smartContainerOpen:!e.smartContainerOpen}})),r&&e.state.smartContainerOpen&&(0,P.focusElement)(e._buttonRef)})),E()(h()(e),"setButtonRef",(function(t){e._buttonRef=t})),E()(h()(e),"toggleCVAAOverlay",(function(){e.setState((function(e){return{cvaaOverlay:!e.cvaaOverlay}}))})),E()(h()(e),"onCVAAOverlayClose",(function(t,r){e.toggleCVAAOverlay(),e.onControlButtonClick(t,r)})),e}return d()(r,[{key:"componentWillMount",value:function(){this.setState({smartContainerOpen:!1,cvaaOverlay:!1})}},{key:"componentDidMount",value:function(){var e=this;this.props.eventManager.listen(document,"click",(function(t){return e.handleClickOutside(t)})),this.props.registerKeyboardEvents(this._keyboardEventHandlers)}},{key:"handleKeydown",value:function(e){var t,r,n=this.props,a=n.player,i=n.logger;switch(e.keyCode){case P.KeyMap.PERIOD:t=a.playbackRate,(r=a.playbackRates.indexOf(t))<a.playbackRates.length-1&&(i.debug("Changing playback rate. ".concat(t," => ").concat(a.playbackRates[r+1])),a.playbackRate=a.playbackRates[r+1],this.props.updateOverlayActionIcon(I.IconType.SpeedUp),a.dispatchEvent(new F.SpeedSelectedEvent(a.playbackRate)));break;case P.KeyMap.SEMI_COLON:a.playbackRate!==a.defaultPlaybackRate&&(i.debug("Changing playback rate. ".concat(a.playbackRate," => ").concat(a.defaultPlaybackRate)),a.playbackRate=a.defaultPlaybackRate,this.props.updateOverlayActionIcon(I.IconType.Speed),a.dispatchEvent(new F.SpeedSelectedEvent(a.playbackRate)));break;case P.KeyMap.COMMA:t=a.playbackRate,(r=a.playbackRates.indexOf(t))>0&&(i.debug("Changing playback rate. ".concat(t," => ").concat(a.playbackRates[r-1])),a.playbackRate=a.playbackRates[r-1],this.props.updateOverlayActionIcon(I.IconType.SpeedDown),a.dispatchEvent(new F.SpeedSelectedEvent(a.playbackRate)))}}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.textTracks.find((function(e){return e.active})),r=e.textTracks.find((function(e){return e.active}));t&&"off"!==t.language&&r&&"off"===r.language?this._lastActiveTextLanguage=t.language:r&&"off"!==r.language&&(this._lastActiveTextLanguage="")}},{key:"handleClickOutside",value:function(e){this.state.cvaaOverlay||this.props.isMobile||this.props.isSmallSize||!this._controlSettingsElement||this._controlSettingsElement.contains(e.target)||!this.state.smartContainerOpen||this.setState({smartContainerOpen:!1})}},{key:"getButtonBadgeType",value:function(){var e,t,r=null===(e=this.props.player.getActiveTracks())||void 0===e||null===(t=e.video)||void 0===t?void 0:t.height;return r?(0,w.getLabelBadgeType)(r):null}},{key:"getQualityLabel",value:function(e){switch(e){case"qualityHd":return this.props.qualityHdLabel;case"quality4k":return this.props.quality4kLabel;case"quality8k":return this.props.quality8kLabel;default:return""}}},{key:"render",value:function(e){var t=this,r=e.showAudioMenu&&e.audioTracks.length>1,n=e.showAdvancedAudioDescToggle,a=e.showCaptionsMenu&&e.textTracks.length>1,i=e.showQualityMenu&&!e.isAudio&&e.videoTracks.length>1,o=e.showSpeedMenu&&e.player.playbackRates.length>1&&!e.isLive;if((r||a||i||o)&&(!(e.isLive&&e.videoTracks.length<=1)||r||a)){var s=this.getButtonBadgeType()||"",l=document.getElementById(this.props.player.config.targetId)||document,u=e.buttonLabel+" "+this.getQualityLabel(s);return(0,A.h)(N.ButtonControl,{name:$,ref:function(e){return e?t._controlSettingsElement=e:void 0}},(0,A.h)(O.Tooltip,{label:e.buttonLabel},(0,A.h)(L.Button,{ref:this.setButtonRef,tabIndex:"0","aria-label":u,"aria-haspopup":"true",className:[T().controlButton,T().buttonBadge,I.BadgeType[s+"Active"],this.state.smartContainerOpen?T().active:""].join(" "),onClick:this.onControlButtonClick},(0,A.h)(I.default,{type:I.IconType.Settings}))),this.state.smartContainerOpen&&!this.state.cvaaOverlay&&(0,A.h)(w.SmartContainer,{targetId:e.player.config.targetId,title:(0,A.h)(S.Text,{id:"settings.title"}),onClose:this.onControlButtonClick},n&&(0,A.h)(w.AdvancedAudioDescToggle,null),r&&(0,A.h)(w.AudioMenu,null),a&&(0,A.h)(w.CaptionsMenu,{asDropdown:!0,onAdvancedCaptionsClick:this.toggleCVAAOverlay}),i&&(0,A.h)(w.QualityMenu,null),o&&(0,A.h)(w.SpeedMenu,null)),this.state.cvaaOverlay?(0,U.createPortal)((0,A.h)(w.CVAAOverlay,{onClose:this.onCVAAOverlayClose}),l.querySelector(".overlay-portal")):(0,A.h)("div",null))}}}]),r}(A.Component))||s)||s)||s)||s)||s)||s);K.displayName=$},"./src/components/shell/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PLAYER_BREAK_POINTS:function(){return n.PLAYER_BREAK_POINTS},PLAYER_SIZE:function(){return n.PLAYER_SIZE},Shell:function(){return n.Shell}});var n=r("./src/components/shell/shell.tsx")},"./src/components/shell/shell.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{PLAYER_BREAK_POINTS:function(){return V},PLAYER_SIZE:function(){return F},Shell:function(){return G}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),C=r("./node_modules/react-redux/es/index.js"),P=r("./src/utils/index.ts"),x=r("./src/reducers/shell.ts"),w=r("./src/reducers/engine.ts"),I=r("./src/components/player/index.ts"),M=r("./src/event/index.ts"),R=r("./src/components/event-dispatcher/index.ts"),D=r("./src/components/logger/index.ts"),O=r("./src/utils/resize-watcher.ts"),L=r("./src/utils/debounce.ts");function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){b()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var B=100,F={TINY:"tiny",EXTRA_SMALL:"extrasmall",SMALL:"small",MEDIUM:"medium",LARGE:"large",EXTRA_LARGE:"extralarge"},V={TINY:280,EXTRA_SMALL:380,SMALL:480,MEDIUM:768,LARGE:1024},H="Shell",G=(n=(0,C.connect)((function(e){return{targetId:e.config.targetId,forceTouchUI:e.config.forceTouchUI,hoverTimeout:e.config.hoverTimeout,metadataLoaded:e.engine.metadataLoaded,currentState:e.engine.playerState.currentState,playerClasses:e.shell.playerClasses,isMobile:e.shell.isMobile,playerSize:e.shell.playerSize,isCasting:e.engine.isCasting,guiClientRect:e.shell.guiClientRect,playerHover:e.shell.playerHover,playerNav:e.shell.playerNav,seekbarDraggingActive:e.seekbar.draggingActive,seekbarHoverActive:e.seekbar.hoverActive,volumeHoverActive:e.volume.hover,adBreak:e.engine.adBreak,prePlayback:e.engine.prePlayback,smartContainerOpen:e.shell.smartContainerOpen,fullscreen:e.engine.fullscreen,fallbackToMutedAutoPlay:e.engine.fallbackToMutedAutoPlay,playlist:e.engine.playlist}}),(0,P.bindActions)(j(j({},x.actions),w.actions))),a=(0,D.withLogger)(H),i=(0,R.withEventDispatcher)(H),n(o=(0,I.withPlayer)(o=(0,M.withEventManager)(o=a(o=i(o=function(e){g()(r,e);var t=N(r);function r(){var e;c()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(f()(e),"hoverTimeout",null),b()(f()(e),"_environmentClasses",void 0),b()(f()(e),"_playerResizeWatcher",void 0),b()(f()(e),"_playerRef",null),b()(f()(e),"onMouseLeave",(function(t){Object.prototype.hasOwnProperty.call(t,"toElement")&&(e.props.isMobile||e.state.hover&&e._updatePlayerHover(!1))})),b()(f()(e),"onMouseMove",(function(){e.props.isMobile||(e.state.nav&&(e.setState({nav:!1}),e.props.updatePlayerNavState(!1)),e._updatePlayerHoverState())})),b()(f()(e),"onMouseUp",(function(){e.unMuteFallback(),e.props.notifyClick(),e._startHoverTimeout()})),b()(f()(e),"onTouchEnd",(function(t){e.props.prePlayback||(e.props.fallbackToMutedAutoPlay&&(e.props.player.muted=!1),e.state.hover||t.stopPropagation(),e._updatePlayerHoverState())})),b()(f()(e),"onKeyDown",(function(t){e.state.nav||t.keyCode!==P.KeyMap.TAB||(e.setState({nav:!0}),e.props.updatePlayerNavState(!0)),!e.state.nav||t.keyCode!==P.KeyMap.ENTER&&t.keyCode!==P.KeyMap.SPACE||(e.unMuteFallback(),t.srcElement.contains(e._playerRef)&&(t.preventDefault(),e.props.player.paused?e.props.player.play():e.props.player.pause()))})),b()(f()(e),"_handleClickOutside",(function(t){var r,n=t.target,a=e.props,i=a.isMobile,o=a.isSmallSize,s=a.updatePlayerNavState;i||o||(null===(r=e._playerRef)||void 0===r?void 0:r.contains(n))||!e.state.nav||(e.setState({nav:!1}),s(!1))})),b()(f()(e),"_onWindowResize",(function(){e._updatePlayerClientRect(),document.body&&e.props.updateDocumentWidth(document.body.clientWidth)})),b()(f()(e),"_updatePlayerClientRect",(function(){var t=document.getElementById(e.props.targetId);t&&e.props.updatePlayerClientRect(t.getBoundingClientRect())})),e}return p()(r,[{key:"unMuteFallback",value:function(){this.props.fallbackToMutedAutoPlay&&(this.props.player.muted=!1)}},{key:"componentWillMount",value:function(){var e=this.props,t=e.player,r=e.forceTouchUI;this._environmentClasses=["".concat("playkit","-").concat(t.env.os.name.replace(/ /g,"-")),"".concat("playkit","-").concat(t.env.browser.name.replace(/ /g,"-"))];var n=t.env,a=n.isIPadOS,i=n.isTablet,o=n.isMobile;this.props.updateIsMobile(a||i||o||r)}},{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.player,n=t.eventManager;n.listen(window,"resize",(0,L.debounce)(this._onWindowResize,B)),n.listen(document,"scroll",(0,L.debounce)(this._updatePlayerClientRect,B)),n.listen(document,"click",(0,L.debounce)(this._handleClickOutside,B)),this._playerResizeWatcher=new O.ResizeWatcher,this._playerResizeWatcher.init(document.getElementById(this.props.targetId)),n.listen(this._playerResizeWatcher,M.EventType.RESIZE,(0,L.debounce)(this._onWindowResize,B)),n.listen(r,r.Event.FIRST_PLAY,(function(){return e._onWindowResize()})),this._onWindowResize()}},{key:"componentWillUnmount",value:function(){this._clearHoverTimeout(),this._playerResizeWatcher.destroy()}},{key:"_updatePlayerHoverState",value:function(){this.props.prePlayback||(this.state.hover||this._updatePlayerHover(!0),this._startHoverTimeout())}},{key:"_updatePlayerHover",value:function(e){this.props.updatePlayerHoverState(e),this.props.notifyHoverChange({hover:e}),this.setState({hover:e})}},{key:"_canEndHoverState",value:function(){return!this.props.seekbarDraggingActive&&!this.props.seekbarHoverActive&&!this.props.volumeHoverActive&&!this.props.smartContainerOpen&&(!this.props.player.paused||this.props.adBreak)}},{key:"_startHoverTimeout",value:function(){var e=this;this._clearHoverTimeout(),this.props.hoverTimeout&&(this.hoverTimeout=setTimeout((function(){e._canEndHoverState()&&e._updatePlayerHover(!1)}),this.props.hoverTimeout))}},{key:"_clearHoverTimeout",value:function(){this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null)}},{key:"componentDidUpdate",value:function(e){(this.state.hover!==this.props.playerHover||"playing"===this.props.currentState&&"paused"===e.currentState||!this.props.prePlayback&&e.prePlayback||!this.props.adBreak&&e.adBreak||this.props.adBreak&&!e.adBreak)&&(this.state.hover!==this.props.playerHover&&this.props.notifyHoverChange({hover:this.props.playerHover}),this._updatePlayerHoverState())}},{key:"render",value:function(e){var t=this,r=[A().player,A().skinDefault].concat(l()(this._environmentClasses)).concat(e.playerClasses);this.props.prePlayback&&r.push(A().prePlayback),this.props.isCasting&&r.push("".concat("playkit","-casting")),this.props.isMobile&&r.push(A().touch),this.props.playerNav&&r.push(A().nav),(this.props.playerHover||this.props.playerNav)&&r.push(A().hover),this.props.metadataLoaded&&r.push(A().metadataLoaded),this.props.adBreak&&r.push(A().adBreak),this.props.metadataLoaded&&r.push(A()["state-"+this.props.currentState]),this.props.seekbarDraggingActive&&r.push(A().hover),this.props.fullscreen&&r.push(A().fullscreen),this.props.playlist&&r.push(A().playlist),this.props.guiClientRect&&(this.props.guiClientRect.width<=V.TINY?(r.push(A().sizeTy),this.props.updatePlayerSize(F.TINY)):this.props.guiClientRect.width<=V.EXTRA_SMALL?(r.push(A().sizeXs),this.props.updatePlayerSize(F.EXTRA_SMALL)):this.props.guiClientRect.width<=V.SMALL?(r.push(A().sizeSm),this.props.updatePlayerSize(F.SMALL)):this.props.guiClientRect.width<=V.MEDIUM?(r.push(A().sizeMd),this.props.updatePlayerSize(F.MEDIUM)):this.props.guiClientRect.width<=V.LARGE?(r.push(A().sizeLg),this.props.updatePlayerSize(F.LARGE)):this.props.updatePlayerSize(F.EXTRA_LARGE),this.props.updateIsSmallSize([F.SMALL,F.EXTRA_SMALL].includes(this.props.playerSize))),r.push("notranslate");var n=r.join(" ");return(0,S.h)("div",{tabIndex:-1,ref:function(e){return t._playerRef=e},className:n,onTouchEnd:this.onTouchEnd,onMouseUp:this.onMouseUp,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,onKeyDown:this.onKeyDown},e.children)}}]),r}(S.Component))||o)||o)||o)||o)||o)},"./src/components/side-panel/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SidePanel:function(){return n.SidePanel}});var n=r("./src/components/side-panel/side-panel.tsx")},"./src/components/side-panel/side-panel.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SidePanel:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./src/components/player-area/index.ts"),v=r("./src/reducers/shell.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k=(0,r("./node_modules/react-redux/es/index.js").connect)((function(e){return{sidePanelsStyles:e.shell.layoutStyles.sidePanels,playerClientRect:e.shell.playerClientRect,isSmallSize:e.shell.isSmallSize}}))(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,r=t.sidePanelsStyles,n=t.position,a=t.isSmallSize,i=e.sidePanelsStyles,o=e.position;return r[n]!==i[o]||a!==e.isSmallSize}},{key:"render",value:function(e){var t=e.position,r=e.sidePanelsStyles,n=-1!==[v.SidePanelPositions.RIGHT,v.SidePanelPositions.LEFT].indexOf(t)?"verticalSidePanel":"horizontalSidePanel",a=[m().sidePanel,m()[n]];e.isSmallSize&&a.push(m().smallSize);var i="SidePanel".concat(t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()),o=r[t];return(0,g.h)("div",{style:o,className:a.join(" ")},(0,g.h)("div",{className:m().sidePanelContent},(0,g.h)(y.PlayerArea,{name:i})))}}]),r}(g.Component))||n},"./src/components/slider/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Slider:function(){return n.Slider}});var n=r("./src/components/slider/slider.tsx")},"./src/components/slider/slider.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Slider:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("./src/styles/style.scss"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./src/utils/index.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var b=function(e){c()(r,e);var t=E(r);function r(){var e;a()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),g()(l()(e),"sliderWidth",void 0),g()(l()(e),"_sliderElement",void 0),g()(l()(e),"_sliderElementOffsetLeft",void 0),g()(l()(e),"mouseDownHandler",(function(t){e._sliderElementOffsetLeft=e._sliderElement.getBoundingClientRect().left,e.state.dragging||e.setState((function(r){return{dragging:!0,value:e.mouseEventToValue(t,r)}}),(function(){e.props.onChange(e.mouseEventToValue(t,e.state))}))})),g()(l()(e),"onKeyDown",(function(t){t.keyCode!==k.KeyMap.LEFT&&t.keyCode!==k.KeyMap.RIGHT||e.onKeyboardDragging(t)})),g()(l()(e),"mouseMoveHandler",(function(t){e.state.dragging&&e.setState((function(r){return{value:e.mouseEventToValue(t,r)}}),(function(){e.props.onChange(e.mouseEventToValue(t,e.state))}))})),g()(l()(e),"mouseUpHandler",(function(t){e.state.dragging&&e.setState((function(r){return{value:e.mouseEventToValue(t,r),dragging:!1}}),(function(){e.props.onChange(e.mouseEventToValue(t,e.state))}))})),e}return o()(r,[{key:"componentWillMount",value:function(){this.setState({value:this.props.value||0,min:this.props.min||0,max:this.props.max||100,dragging:!1}),document.addEventListener("mouseup",this.mouseUpHandler),document.addEventListener("mousemove",this.mouseMoveHandler),document.addEventListener("touchend",this.mouseUpHandler),document.addEventListener("touchmove",this.mouseMoveHandler)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseup",this.mouseUpHandler),document.removeEventListener("mousemove",this.mouseMoveHandler),document.removeEventListener("touchend",this.mouseUpHandler),document.removeEventListener("touchmove",this.mouseMoveHandler)}},{key:"componentDidMount",value:function(){this.sliderWidth=this._sliderElement.clientWidth,this._sliderElementOffsetLeft=this._sliderElement.getBoundingClientRect().left}},{key:"onKeyboardDragging",value:function(e){var t=this;e.stopPropagation(),this._sliderElementOffsetLeft=this._sliderElement.getBoundingClientRect().left;var r=this.props.value;switch(e.keyCode){case k.KeyMap.RIGHT:(r+=5)>this.state.max&&(r=this.state.max);break;case k.KeyMap.LEFT:(r-=5)<this.state.min&&(r=this.state.min)}this.setState({value:r,dragging:!1},(function(){t.props.onChange(r)}))}},{key:"mouseEventToValue",value:function(e,t){var r=(e.touches&&e.touches.length>0?e.touches[0].clientX:e.changedTouches?e.changedTouches[0].pageX:e.clientX)-this._sliderElement.getBoundingClientRect().left,n=Math.round(r/this._sliderElement.clientWidth*100);return this.getValueByPersentage(n)<t.min?t.min:this.getValueByPersentage(n)>t.max?t.max:this.getValueByPersentage(n)}},{key:"getValueByPersentage",value:function(e){return this.state.max/100*e}},{key:"getPercentageByValue",value:function(){return Math.round(this.state.value/this.state.max*100)}},{key:"render",value:function(e){var t=this;return(0,_.h)("div",{role:"slider","aria-valuemin":this.state.min,"aria-valuenow":this.state.value,"aria-valuemax":this.state.max,"aria-labelledby":e.name,tabIndex:0,ref:function(r){r&&(t._sliderElement=r,e.pushRef&&e.pushRef(r))},className:v().slider,onMouseDown:this.mouseDownHandler,onTouchStart:this.mouseDownHandler,onKeyDown:this.onKeyDown},(0,_.h)("div",{className:v().progress,style:{width:this.getPercentageByValue()+"%"}},(0,_.h)("div",{className:v().handle,onMouseDown:this.mouseDownHandler,onTouchStart:this.mouseDownHandler})))}}]),r}(_.Component);b.displayName="Slider"},"./src/components/smart-container/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SmartContainer:function(){return n.SmartContainer},SmartContainerItem:function(){return a.SmartContainerItem}});var n=r("./src/components/smart-container/smart-container.tsx"),a=r("./src/components/smart-container/smart-container-item.tsx")},"./src/components/smart-container/smart-container-item.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SmartContainerItem:function(){return k}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./src/styles/style.scss"),f=r.n(h),m=r("./node_modules/preact/dist/preact.module.js"),g=r("./src/components/dropdown/index.ts"),y=r("./src/components/icon/index.ts"),v=r("./src/components/index.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var k=function(e){l()(r,e);var t=_(r);function r(){return a()(this,r),t.apply(this,arguments)}return o()(r,[{key:"render",value:function(e){var t=e.label&&e.label.toLowerCase();return(0,m.h)("div",{className:[f().smartContainerItem,f().selectMenuItem].join(" ")},(0,m.h)("label",{id:t,htmlFor:t},e.icon?(0,m.h)("div",{className:f().labelIcon},(0,m.h)(y.default,{type:e.icon})):void 0,e.label),e.options&&e.options.length?(0,m.h)(g.DropDown,{pushRef:function(t){e.pushRef(t)},name:t,onMenuChosen:function(t){return e.onMenuChosen(t)},options:e.options}):(0,m.h)("div",{style:{paddingLeft:"20px"}},(0,m.h)(v.ToggleSwitch,{pushRef:function(t){e.pushRef(t)},name:t,isChecked:e.isChecked,onMenuChosen:function(t){return e.onMenuChosen(t)}})))}}]),r}(m.Component);k.displayName="SmartContainerItem"},"./src/components/smart-container/smart-container.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SmartContainer:function(){return w}});var n,a,i,o=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./src/styles/style.scss"),_=r.n(v),k=r("./node_modules/preact/dist/preact.module.js"),E=r("./node_modules/react-redux/es/index.js"),b=r("./src/utils/index.ts"),T=r("./src/reducers/shell.ts"),A=r("./node_modules/preact/compat/dist/compat.module.js"),S=r("./src/components/overlay/index.ts"),C=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js");function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var w=(n=(0,E.connect)((function(e){return{isMobile:e.shell.isMobile,isSmallSize:e.shell.isSmallSize}}),(0,b.bindActions)(T.actions)),a=(0,C.withText)({settingsText:"settings.title"}),n(i=(0,b.withKeyboardA11y)(i=a(i=function(e){h()(r,e);var t=x(r);function r(){return u()(this,r),t.apply(this,arguments)}return d()(r,[{key:"componentWillMount",value:function(){this.props.addPlayerClass(_().smartContainerOpen),this.props.updateSmartContainerOpen(!0)}},{key:"componentWillUnmount",value:function(){this.props.removePlayerClass(_().smartContainerOpen),this.props.updateSmartContainerOpen(!1)}},{key:"componentDidMount",value:function(){this.props.setIsModal(this.isPortal)}},{key:"render",value:function(e){var t=document.getElementById(this.props.targetId)||document;return e.clearAccessibleChildren(),this.isPortal?(0,A.createPortal)((0,k.h)(S.Overlay,{open:!0,onClose:e.onClose,handleKeyDown:this.props.handleKeyDown,addAccessibleChild:this.props.addAccessibleChild,label:e.settingsText},(0,k.h)("div",{className:_().title},e.title),this.renderChildren(e)),t.querySelector(".overlay-portal")):(0,k.h)("div",{onKeyDown:e.handleKeyDown,tabIndex:-1,role:"menu",className:[_().smartContainer,_().top,_().left].join(" ")},this.renderChildren(e))}},{key:"renderChildren",value:function(e){var t=this,r=(0,k.toChildArray)(e.children).map((function(r){if(r)return(0,k.cloneElement)(r,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({pushRef:function(t){e.addAccessibleChild(t)}},t.props))}));return r}},{key:"isPortal",get:function(){return this.props.isMobile||this.props.isSmallSize}}]),r}(k.Component))||i)||i)||i);w.displayName="SmartContainer"},"./src/components/speed-menu/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SpeedMenu:function(){return n.SpeedMenu}});var n=r("./src/components/speed-menu/speed-menu.tsx")},"./src/components/speed-menu/speed-menu.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{SpeedMenu:function(){return O}});var n,a,i,o,s,l=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/inherits.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),_=r.n(v),k=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),A=r("./node_modules/react-redux/es/index.js"),S=r("./src/utils/index.ts"),C=r("./src/reducers/settings.ts"),P=r("./src/components/index.ts"),x=r("./src/components/icon/index.ts"),w=r("./src/components/player/index.ts"),I=r("./src/components/logger/index.ts"),M=r("./src/components/event-dispatcher/index.ts");function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_()(e);if(t){var a=_()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return y()(this,r)}}var D="SpeedMenu",O=(n=(0,A.connect)(null,(0,S.bindActions)(C.actions)),a=(0,I.withLogger)(D),i=(0,M.withEventDispatcher)(D),o=(0,T.withText)({speedLabelText:"settings.speed",speedNormalLabelText:"settings.speedNormal"}),n(s=(0,w.withPlayer)(s=a(s=i(s=o(s=function(e){m()(r,e);var t=R(r);function r(){var e;u()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),E()(h()(e),"onSpeedChange",(function(t){e.props.updateSpeed(t),e.props.player.playbackRate=t,e.props.notifyClick({type:"speed",speed:t})})),e}return d()(r,[{key:"render",value:function(e){var t=e.optionsRenderer?e.optionsRenderer(e.player.playbackRates):e.player.playbackRates.reduce((function(t,r){var n={value:r,label:1===r?e.speedNormalLabelText:r,active:!1};return r===e.player.playbackRate&&(n.active=!0),t.push(n),t}),[]);return(0,b.h)(P.SmartContainerItem,{pushRef:function(t){e.pushRef(t)},icon:x.IconType.Speed,label:e.speedLabelText,options:t,onMenuChosen:this.onSpeedChange})}}]),r}(b.Component))||s)||s)||s)||s)||s);O.displayName=D},"./src/components/spinner/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Spinner:function(){return n.Spinner}});var n=r("./src/components/spinner/spinner.tsx")},"./src/components/spinner/spinner.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Spinner:function(){return y}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./src/styles/style.scss"),f=r.n(h),m=r("./node_modules/preact/dist/preact.module.js");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var y=function(e){l()(r,e);var t=g(r);function r(){return a()(this,r),t.apply(this,arguments)}return o()(r,[{key:"render",value:function(){return(0,m.h)("div",{className:f().spinner},Array(8).fill(0).map((function(e,t){return(0,m.h)("span",{key:t+1})})))}}]),r}(m.Component);y.displayName="Spinner"},"./src/components/time-display-ads-container/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TimeDisplayAdsContainer:function(){return n.TimeDisplayAdsContainer}});var n=r("./src/components/time-display-ads-container/time-display-ads-container.tsx")},"./src/components/time-display-ads-container/time-display-ads-container.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{TimeDisplayAdsContainer:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/extends.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/react-redux/es/index.js"),v=r("./src/components/time-display/index.ts"),_=r("./src/components/logger/index.ts");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var E="TimeDisplayAdsContainer",b=(0,y.connect)((function(e){return{adProgress:e.engine.adProgress}}))(n=(0,_.withLogger)(E)(n=function(e){d()(r,e);var t=k(r);function r(){return s()(this,r),t.apply(this,arguments)}return u()(r,[{key:"render",value:function(e){return(0,g.h)(v.TimeDisplay,i()({currentTime:Math.round(e.adProgress.currentTime),duration:Math.round(e.adProgress.duration)},e))}}]),r}(g.Component))||n)||n;b.displayName=E},"./src/components/time-display-playback-container/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TimeDisplayPlaybackContainer:function(){return n.TimeDisplayPlaybackContainer}});var n=r("./src/components/time-display-playback-container/time-display-playback-container.tsx")},"./src/components/time-display-playback-container/time-display-playback-container.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{TimeDisplayPlaybackContainer:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/extends.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/react-redux/es/index.js"),v=r("./src/components/time-display/index.ts"),_=r("./src/components/logger/index.ts");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m()(e);if(t){var a=m()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return h()(this,r)}}var E="TimeDisplayPlaybackContainer",b=(0,y.connect)((function(e){return{currentTime:e.engine.currentTime,duration:e.engine.duration}}))(n=(0,_.withLogger)(E)(n=function(e){d()(r,e);var t=k(r);function r(){return s()(this,r),t.apply(this,arguments)}return u()(r,[{key:"render",value:function(e){return(0,g.h)(v.TimeDisplay,i()({currentTime:e.currentTime,duration:e.duration},e))}}]),r}(g.Component))||n)||n;b.displayName=E},"./src/components/time-display/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TimeDisplay:function(){return n.TimeDisplay}});var n=r("./src/components/time-display/time-display.tsx")},"./src/components/time-display/time-display.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{TimeDisplay:function(){return v}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=r.n(d),h=r("./src/styles/style.scss"),f=r.n(h),m=r("./node_modules/preact/dist/preact.module.js"),g=r("./src/utils/index.ts");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p()(e);if(t){var a=p()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return c()(this,r)}}var v=function(e){l()(r,e);var t=y(r);function r(){return a()(this,r),t.apply(this,arguments)}return o()(r,[{key:"getTimeDisplay",value:function(e,t,r){var n=r||"current / total",a=(0,g.toHHMMSS)(e),i=(0,g.toHHMMSS)(t),o=(0,g.toHHMMSS)(t-e);return n=(n=(n=n.replace(/current/g,a)).replace(/total/g,i)).replace(/left/g,o)}},{key:"render",value:function(e){var t=e.currentTime,r=e.duration,n=e.format,a=void 0===n?"current / total":n;return(0,m.h)("div",{className:f().timeDisplay},(0,m.h)("span",null,this.getTimeDisplay(t,r,a)))}}]),r}(m.Component);v.displayName="TimeDisplay"},"./src/components/toggle-switch/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ToggleSwitch:function(){return n.ToggleSwitch}});var n=r("./src/components/toggle-switch/toggle-switch.tsx")},"./src/components/toggle-switch/toggle-switch.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ToggleSwitch:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("./node_modules/preact/dist/preact.module.js"),v=r("./src/utils/index.ts"),_=r("./src/styles/style.scss"),k=r.n(_);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var b=function(e){c()(r,e);var t=E(r);function r(){var e;a()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),g()(l()(e),"onChange",(function(t){e.props.onMenuChosen(t)})),g()(l()(e),"handleOnKeyDown",(function(t){t.keyCode!==v.KeyMap.ENTER&&t.keyCode!==v.KeyMap.SPACE||(t.preventDefault(),e.onChange(!e.props.isChecked))})),e}return o()(r,[{key:"render",value:function(e){var t=this;return(0,y.h)("label",{onKeyDown:function(e){return t.handleOnKeyDown(e)},className:k().switch,ref:function(t){e.pushRef&&e.pushRef(t)},"aria-label":e.name,role:"switch","aria-checked":e.isChecked,tabIndex:-1},(0,y.h)("input",{name:e.name,className:k().toggleInput,type:"checkbox",checked:e.isChecked,onChange:function(e){return t.onChange(e.target.checked)}}),(0,y.h)("span",{className:k().slider}))}}]),r}(y.Component);b.displayName="ToggleSwitch"},"./src/components/tooltip/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ToolTipType:function(){return n.ToolTipType},Tooltip:function(){return n.Tooltip}});var n=r("./src/components/tooltip/tooltip.tsx")},"./src/components/tooltip/tooltip.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ToolTipType:function(){return S},Tooltip:function(){return C}});var n,a,i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./src/styles/style.scss"),k=r.n(_),E=r("./node_modules/preact/dist/preact.module.js"),b=r("./node_modules/react-redux/es/index.js"),T=r("./src/event/index.ts");function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var S={Top:"top",Bottom:"bottom",TopRight:"top-right",TopLeft:"top-left",BottomRight:"bottom-right",BottomLeft:"bottom-left",Left:"left",Right:"right"},C=(0,b.connect)((function(e){return{playerClientRect:e.shell.playerClientRect,guiClientRect:e.shell.guiClientRect,isMobile:e.shell.isMobile}}))(n=(0,T.withEventManager)((a=function(e){p()(r,e);var t=A(r);function r(){var e;o()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),v()(c()(e),"_hoverTimeout",null),v()(c()(e),"textElement",void 0),v()(c()(e),"tooltipElement",void 0),v()(c()(e),"lastAlternativeTypeIndex",-1),v()(c()(e),"showTooltip",(function(){e.setState({showTooltip:!0})})),v()(c()(e),"hideTooltip",(function(){e.setState({showTooltip:!1})})),v()(c()(e),"handleFocusOnChildren",(function(){var t=e.props.children.props.onFocus;e.showTooltip(),t&&t()})),v()(c()(e),"handleBlurOnChildren",(function(){var t=e.props.children.props.onBlur;e.hideTooltip(),t&&t()})),v()(c()(e),"onMouseOver",(function(){e._clearHoverTimeout(),e._hoverTimeout=setTimeout((function(){e.showTooltip()}),750)})),v()(c()(e),"onMouseLeave",(function(){e.hideTooltip(),e._clearHoverTimeout()})),e}return l()(r,[{key:"_clearHoverTimeout",value:function(){this._hoverTimeout&&(clearTimeout(this._hoverTimeout),this._hoverTimeout=null)}},{key:"getAlternateType",value:function(){var e=this;return Object.values(S).find((function(t,r){return r>e.lastAlternativeTypeIndex&&t!=e.props.type&&(e.lastAlternativeTypeIndex=r,!0)}))}},{key:"isToolTipInBoundaries",value:function(){if(this.props.strictPosition)return!0;var e=this.textElement.getBoundingClientRect(),t=this.props.playerClientRect;return e.top>t.top+5&&e.bottom<t.bottom-5&&e.right<t.right-5&&e.left>t.left+5}},{key:"componentWillMount",value:function(){this.setState({valid:!1,type:this.props.type})}},{key:"componentDidMount",value:function(){var e=this;this.props.eventManager.listen(document,"click",(function(t){return e.handleClickOutside(t)}))}},{key:"handleClickOutside",value:function(e){var t;!(null===(t=this.tooltipElement)||void 0===t?void 0:t.contains(e.target))&&this.state.showTooltip&&this.hideTooltip()}},{key:"componentDidUpdate",value:function(e){if(this.props.guiClientRect!==e.guiClientRect)this.lastAlternativeTypeIndex=-1,this.setState({valid:!1,type:this.props.type});else if(this.state.showTooltip)if(this.isToolTipInBoundaries())this.state.valid||this.setState({valid:!0});else{var t=this.getAlternateType();t&&this.setState({valid:!1,type:t})}}},{key:"componentWillUnmount",value:function(){this._clearHoverTimeout()}},{key:"render",value:function(e){var t=this,r=[k().tooltipLabel,k()["tooltip-".concat(this.state.type)]];if(e.className&&r.push(e.className),this.state.showTooltip&&this.state.valid?r.push(k().show):r.push(k().hide),e.isMobile)return(0,E.toChildArray)(e.children)[0];var n=(0,E.cloneElement)(e.children,{onFocus:this.handleFocusOnChildren,onBlur:this.handleBlurOnChildren});return(0,E.h)("div",{className:k().tooltip,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,ref:function(e){return e?t.tooltipElement=e:void 0}},n,(0,E.h)("span",{style:{maxWidth:e.maxWidth},ref:function(e){return e?t.textElement=e:void 0},className:r.join(" ")},e.label))}}]),r}(E.Component),v()(a,"defaultProps",{type:S.Top,maxWidth:"240px",strictPosition:!1}),n=a))||n)||n},"./src/components/top-bar/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TopBar:function(){return n.TopBar}});var n=r("./src/components/top-bar/top-bar.tsx")},"./src/components/top-bar/top-bar.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{TopBar:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./node_modules/react-redux/es/index.js"),v=r("./src/components/player-area/index.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k=(0,y.connect)((function(e){return{isCasting:e.engine.isCasting,isPlaybackEnded:e.engine.isPlaybackEnded}}))(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"render",value:function(e){var t=e.disabled,r=e.isPlaybackEnded,n=e.isCasting,a=e.leftControls,i=e.rightControls,o=[m().topBar];return t&&o.push(m().disabled),n&&r&&o.push(m().hide),(0,g.h)("div",{className:o.join(" ")},(0,g.h)("div",{className:m().topBarArea},(0,g.h)(v.PlayerArea,{name:"TopBar"})),e.children,(0,g.h)("div",{className:m().leftControls},(0,g.h)(v.PlayerArea,{name:"TopBarLeftControls"},a)),(0,g.h)("div",{className:m().rightControls},(0,g.h)(v.PlayerArea,{name:"TopBarRightControls"},i)))}}]),r}(g.Component))||n;k.displayName="TopBar"},"./src/components/unmute-indication/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{UnmuteIndication:function(){return n.UnmuteIndication}});var n=r("./src/components/unmute-indication/unmute-indication.tsx")},"./src/components/unmute-indication/unmute-indication.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{MUTED_AUTOPLAY_ICON_ONLY_DEFAULT_TIMEOUT:function(){return M},UnmuteIndication:function(){return D}});var n,a,i,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/react-redux/es/index.js"),A=r("./src/components/icon/index.ts"),S=r("./src/utils/index.ts"),C=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),P=r("./src/components/player/index.ts"),x=r("./src/event/index.ts"),w=r("./src/components/logger/index.ts");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var M=3e3,R="UnmuteIndication",D=(n=(0,T.connect)((function(e){return{fallbackToMutedAutoPlay:e.engine.fallbackToMutedAutoPlay}}),null),a=(0,w.withLogger)(R),n(i=(0,P.withPlayer)(i=(0,x.withEventManager)(i=a(i=function(e){h()(r,e);var t=I(r);function r(){var e;s()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),_()(d()(e),"_iconTimeout",null),_()(d()(e),"onKeyDown",(function(t){t.keyCode===S.KeyMap.ENTER&&(e.props.player.muted=!e.props.player.muted)})),_()(d()(e),"onMouseOver",(function(){return e.setState({iconOnly:!1})})),_()(d()(e),"onMouseOut",(function(){return e.setState({iconOnly:!0})})),_()(d()(e),"onMouseUp",(function(){return e.props.player.muted=!e.props.player.muted})),_()(d()(e),"onTouchEnd",(function(e){return e.stopImmediatePropagation()})),e}return u()(r,[{key:"componentDidUpdate",value:function(e){var t=this;!e.fallbackToMutedAutoPlay&&this.props.fallbackToMutedAutoPlay&&(this.props.eventManager.listenOnce(this.props.player,this.props.player.Event.PLAYING,(function(){return t._iconOnlyTimeout()})),this.props.eventManager.listenOnce(this.props.player,this.props.player.Event.AD_STARTED,(function(){return t._iconOnlyTimeout()})))}},{key:"componentWillUnmount",value:function(){this._iconTimeout&&(clearTimeout(this._iconTimeout),this._iconTimeout=null)}},{key:"_iconOnlyTimeout",value:function(){var e=this;this._iconTimeout=setTimeout((function(){e.setState({iconOnly:!0})}),M)}},{key:"render",value:function(e){if(this.props.fallbackToMutedAutoPlay){var t=[E().unmuteButtonContainer];return e.hasTopBar&&t.push(E().hasTopBar),this.state.iconOnly&&t.push(E().showIconOnly),(0,b.h)(C.Localizer,null,(0,b.h)("div",{tabIndex:0,"aria-label":(0,b.h)(C.Text,{id:"controls.unmute"}),className:t.join(" "),onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd,onKeyDown:this.onKeyDown},(0,b.h)("a",{className:[E().btn,E().btnDarkTransparent,E().unmuteButton].join(" ")},(0,b.h)("div",{className:E().unmuteIconContainer},(0,b.h)(A.default,{type:A.IconType.VolumeBase}),(0,b.h)(A.default,{type:A.IconType.VolumeMute})),(0,b.h)("span",null,(0,b.h)(C.Text,{id:"unmute.unmute"})))))}}}]),r}(b.Component))||i)||i)||i)||i);D.displayName=R},"./src/components/video-area/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{VideoArea:function(){return n.VideoArea}});var n=r("./src/components/video-area/video-area.tsx")},"./src/components/video-area/video-area.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{VideoArea:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/preact/dist/preact.module.js"),m=r("./node_modules/react-redux/es/index.js"),g=r("./src/components/player-area/index.ts"),y=r("./src/styles/style.scss"),v=r.n(y);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k=(0,m.connect)((function(e){return{videoStyles:e.shell.layoutStyles.video}}))(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"shouldComponentUpdate",value:function(e){return e.videoStyles!==this.props.videoStyles}},{key:"render",value:function(){var e=this.props,t=e.videoStyles,r=e.children;return(0,f.h)("div",{style:t,className:v().videoArea},(0,f.h)("div",{style:{pointerEvents:"auto"}},(0,f.h)(g.PlayerArea,{name:"VideoArea"},r)))}}]),r}(f.Component))||n},"./src/components/video-player/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{VideoPlayer:function(){return n.VideoPlayer}});var n=r("./src/components/video-player/video-player.tsx")},"./src/components/video-player/video-player.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{VideoPlayer:function(){return I}});var n,a,i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./src/utils/resize-watcher.ts"),k=r("./node_modules/preact/dist/preact.module.js"),E=r("./node_modules/react-redux/es/index.js"),b=r("./src/reducers/shell.ts"),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./src/utils/index.ts"),C=r("./src/components/player/index.ts"),P=r("./src/event/index.ts"),x=r("./src/components/player-area/index.ts");function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var I=(n=(0,E.connect)((function(e){return{videoStyles:e.shell.layoutStyles.video,targetId:e.config.targetId}}),(0,S.bindActions)(b.actions)),(0,C.withPlayer)(a=(0,P.withEventManager)(a=n(a=function(e){p()(r,e);var t=w(r);function r(){var e;o()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),v()(c()(e),"_el",void 0),v()(c()(e),"_videoResizeWatcher",void 0),v()(c()(e),"_onVideoResize",(function(){var t=e.props.player.getVideoElement();t&&e.props.updateVideoClientRect(t.getBoundingClientRect())})),v()(c()(e),"_setRef",(function(t){e._videoResizeWatcher&&(e.props.eventManager.unlisten(e._videoResizeWatcher,P.EventType.RESIZE,e._onVideoResize),e._videoResizeWatcher.destroy()),t&&(e._el=t),e._el?e._el.appendChild(e.props.player.getView()):e.props.updateVideoClientRect({x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0})})),e}return l()(r,[{key:"shouldComponentUpdate",value:function(e){return e.videoStyles!==this.props.videoStyles}},{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.eventManager,n=t.player;r.listen(n,n.Event.SOURCE_SELECTED,(function(){return e._onVideoResize()}));var a=new _.ResizeWatcher;a.init(this._el),this._videoResizeWatcher=a,this.props.eventManager.listen(this._videoResizeWatcher,P.EventType.RESIZE,this._onVideoResize)}},{key:"componentWillUnmount",value:function(){this._videoResizeWatcher.destroy()}},{key:"render",value:function(){var e=this.props,t=e.videoStyles,r=e.targetId;return(0,k.h)("div",{id:"".concat(r,"-video"),className:A().videoPlayer,style:t,ref:this._setRef},(0,k.h)(x.PlayerArea,{name:"VideoContainer"}))}}]),r}(k.Component))||a)||a)||a)},"./src/components/volume/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Volume:function(){return n.Volume}});var n=r("./src/components/volume/volume.tsx")},"./src/components/volume/volume.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Volume:function(){return K}});var n,a,i,o,s,l,u=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/createClass.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),k=r.n(_),E=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),b=r.n(E),T=r("./src/styles/style.scss"),A=r.n(T),S=r("./node_modules/preact/dist/preact.module.js"),C=r("./node_modules/react-redux/es/index.js"),P=r("./src/utils/index.ts"),x=r("./src/reducers/volume.ts"),w=r("./src/reducers/engine.ts"),I=r("./src/components/icon/index.ts"),M=r("./src/components/player/index.ts"),R=r("./src/event/index.ts"),D=r("./src/components/logger/index.ts"),O=r("./src/components/event-dispatcher/index.ts"),L=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),N=r("./src/components/keyboard/index.ts"),U=r("./src/reducers/overlay-action.ts"),j=r("./src/components/tooltip/index.ts"),B=r("./src/components/button/index.ts"),F=r("./src/components/button-control/index.ts");function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k()(e);if(t){var a=k()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return v()(this,r)}}function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){b()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var $="Volume",K=(n=(0,C.connect)((function(e){return{isDraggingActive:e.volume.draggingActive,volume:e.engine.volume,muted:e.engine.muted,isMobile:e.shell.isMobile}}),(0,P.bindActions)(G(G(G({},x.actions),w.actions),U.actions))),a=(0,N.withKeyboardEvent)($),i=(0,D.withLogger)($),o=(0,O.withEventDispatcher)($),s=(0,L.withText)((function(e){return{volumeLabel:e.muted?(0,S.h)(L.Text,{id:"controls.unmute"},"Unmute"):(0,S.h)(L.Text,{id:"controls.mute"},"Mute"),sliderAriaLabel:(0,S.h)(L.Text,{id:"volume.volume_slider_aria_label"},"Volume control, use the arrows to control the volume")}})),n(l=(0,M.withPlayer)(l=(0,R.withEventManager)(l=a(l=i(l=o(l=s(l=function(e){g()(r,e);var t=V(r);function r(){var e;c()(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(f()(e),"_volumeControlElement",void 0),b()(f()(e),"_volumeProgressBarElement",void 0),b()(f()(e),"_keyboardEventHandlers",[{key:{code:P.KeyMap.UP},action:function(t){e.handleKeydown(t)}},{key:{code:P.KeyMap.DOWN},action:function(t){e.handleKeydown(t)}},{key:{code:P.KeyMap.M},action:function(t){e.handleKeydown(t)}}]),b()(f()(e),"onVolumeProgressBarMouseDown",(function(){e.props.updateVolumeDraggingStatus(!0)})),b()(f()(e),"onVolumeProgressBarMouseMove",(function(t){e.props.isDraggingActive&&e.changeVolume(t)})),b()(f()(e),"onMouseOver",(function(){e.props.isMobile||(e.props.updateVolumeHover(!0),e.setState({hover:!0}))})),b()(f()(e),"onMouseOut",(function(){e.props.isMobile||(e.props.updateVolumeHover(!1),e.setState({hover:!1}))})),b()(f()(e),"onKeyDown",(function(t){switch(t.keyCode){case P.KeyMap.UP:case P.KeyMap.DOWN:case P.KeyMap.ENTER:case P.KeyMap.SPACE:t.preventDefault(),t.stopPropagation(),e.handleKeydown(t);break;case P.KeyMap.TAB:break;default:e.setState({hover:!1})}})),b()(f()(e),"onFocus",(function(){e.props.isMobile||e.state.hover||e.setState({hover:!0})})),b()(f()(e),"onTouchEnd",(function(e){e.stopImmediatePropagation()})),b()(f()(e),"onVolumeProgressBarMouseUp",(function(t){e.props.isDraggingActive&&(e.props.updateVolumeDraggingStatus(!1),e.changeVolume(t))})),b()(f()(e),"toggleMute",(function(){var t=e.props.player;0===t.volume?(e.props.logger.debug("Toggle mute. Volume is 0, set mute to false & volume to 0.5"),t.muted=!1,t.volume=.5):(e.props.logger.debug("Toggle mute. ".concat(t.muted," => ").concat(!t.muted)),t.muted=!t.muted),e.props.notifyClick()})),b()(f()(e),"onProgressBarKeyDown",(function(t){t.keyCode===P.KeyMap.TAB?e.setState({hover:!1}):(t.preventDefault(),t.stopPropagation(),e.handleKeydown(t,!0))})),e}return p()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props.player;this.props.eventManager.listen(t,t.Event.LOADED_METADATA,(function(){e.props.updateVolume(t.volume),e.props.updateMuted(t.muted)})),this.props.eventManager.listen(t,t.Event.VOLUME_CHANGE,(function(){e.props.updateMuted(t.muted),e.props.updateVolume(t.volume)})),this.props.eventManager.listen(document,"mouseup",this.onVolumeProgressBarMouseUp),this.props.eventManager.listen(document,"mousemove",this.onVolumeProgressBarMouseMove),this.props.eventManager.listen(document,"click",(function(t){return e.handleClickOutside(t)})),this.props.registerKeyboardEvents(this._keyboardEventHandlers)}},{key:"_shouldRender",value:function(){var e=!(this.props.player.isImage()||this.props.player.isDocument());return this.props.onToggle($,e),e}},{key:"handleClickOutside",value:function(e){!this.props.isMobile&&this._volumeControlElement&&!this._volumeControlElement.contains(e.target)&&this.state.hover&&this.setState({hover:!1})}},{key:"getVolumeProgressHeight",value:function(){return this.props.muted?"0%":Math.round(100*this.props.volume)+"%"}},{key:"handleKeydown",value:function(e){var t,r=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.props.player,i=function(e){e===a.volume||e>100||e<0||(a.muted=e<5,a.volume=e/100,r.props.notifyChange({volume:a.volume}))};switch(e.keyCode){case P.KeyMap.UP:this.props.updateOverlayActionIcon([I.IconType.VolumeBase,I.IconType.VolumeWaves]),i(t=Math.min(Math.round(100*a.volume)+5,100));break;case P.KeyMap.DOWN:0===(t=Math.max(Math.round(100*a.volume)-5,0))?this.props.updateOverlayActionIcon([I.IconType.VolumeBase,I.IconType.VolumeMute]):this.props.updateOverlayActionIcon([I.IconType.VolumeBase,I.IconType.VolumeWave]),i(t);break;case P.KeyMap.M:a.muted?this.props.updateOverlayActionIcon([I.IconType.VolumeBase,I.IconType.VolumeWaves]):this.props.updateOverlayActionIcon([I.IconType.VolumeBase,I.IconType.VolumeMute]),this.toggleMute();break;case P.KeyMap.ENTER:case P.KeyMap.SPACE:n||this.toggleMute()}}},{key:"changeVolume",value:function(e){var t,r=this.props.player,n=this._volumeProgressBarElement.getBoundingClientRect();t=n.height>n.width?this._getVerticalVolume(n,e):this._getHorizontalVolume(n,e),(t=parseFloat(t.toFixed(2)))<=1&&t>=0&&(this.props.logger.debug("Change volume from ".concat(r.volume," => ").concat(t)),r.volume=t,this.props.muted&&(r.muted=!1),this.props.notifyChange({volume:r.volume}))}},{key:"_getHorizontalVolume",value:function(e,t){var r=e.width,n=e.left,a=t.clientX;return 0!=r?(a-n)/r:0}},{key:"_getVerticalVolume",value:function(e,t){var r=e.height,n=e.top,a=t.clientY;return 0!=r?1-(a-n)/r:0}},{key:"render",value:function(){var e=this;if(this._shouldRender){var t=this.props,r=t.player,n=t.isDraggingActive,a=t.muted,i=t.volume,o=t.smartContainerOpen,s=[A().volumeControl];n&&s.push(A().draggingActive),(a||0===i)&&s.push(A().isMuted),this.state.hover&&!o&&s.push(A().hover);var l=Math.round(100*r.volume);return(0,S.h)(F.ButtonControl,{name:$,ref:function(t){return t?e._volumeControlElement=t:void 0},className:s,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut},(0,S.h)(j.Tooltip,{label:this.props.volumeLabel,type:this.props.toolTipType?this.props.toolTipType:j.ToolTipType.Left},(0,S.h)(B.Button,{tabIndex:"0","aria-live":"polite","aria-label":"".concat(this.props.volumeLabel,". ").concat(this.props.sliderAriaLabel),className:A().controlButton,onMouseUp:this.toggleMute,onTouchEnd:this.onTouchEnd,onKeyDown:this.onKeyDown},(0,S.h)(I.Icon,{type:I.IconType.VolumeBase}),(0,S.h)(I.Icon,{type:I.IconType.VolumeWaves}),(0,S.h)(I.Icon,{type:I.IconType.VolumeMute}))),(0,S.h)("div",{tabIndex:0,"aria-orientation":"vertical","aria-label":this.props.sliderAriaLabel,onKeyDown:this.onProgressBarKeyDown,className:A().volumeControlBar,onFocus:this.onFocus,role:"slider","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":l,"aria-valuetext":"".concat(l,"% volume ").concat(r.muted?"muted":"")},(0,S.h)("div",{className:A().bar,ref:function(t){return t?e._volumeProgressBarElement=t:void 0},onMouseDown:this.onVolumeProgressBarMouseDown},(0,S.h)("div",{className:A().progress,style:{height:this.getVolumeProgressHeight()}}))))}}}]),r}(S.Component))||l)||l)||l)||l)||l)||l)||l);K.displayName=$},"./src/components/vr-stereo/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{VrStereo:function(){return n.VrStereo}});var n=r("./src/components/vr-stereo/vr-stereo.tsx")},"./src/components/vr-stereo/vr-stereo.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{VrStereo:function(){return V}});var n,a,i,o,s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/inherits.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),v=r.n(y),_=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),k=r.n(_),E=r("./src/styles/style.scss"),b=r.n(E),T=r("./node_modules/preact/dist/preact.module.js"),A=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),S=r("./src/components/icon/index.ts"),C=r("./src/utils/index.ts"),P=r("./src/reducers/engine.ts"),x=r("./node_modules/react-redux/es/index.js"),w=r("./src/reducers/shell.ts"),I=r("./src/components/player/index.ts"),M=r("./src/components/logger/index.ts"),R=r("./src/components/tooltip/index.ts"),D=r("./src/components/button/index.ts"),O=r("./src/components/button-control/index.ts"),L=r("./src/components/bottom-bar/index.ts"),N=r("./src/index.ts");function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var a=v()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return g()(this,r)}}function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F="VrStereo",V=(n=(0,x.connect)((function(e){return{isVr:e.engine.isVr,vrStereoMode:e.engine.vrStereoMode,config:e.config.components.vrStereo}}),(0,C.bindActions)(B(B({},w.actions),P.actions))),a=(0,M.withLogger)(F),i=(0,A.withText)({vrStereoText:"controls.vrStereo"}),n(o=(0,I.withPlayer)(o=a(o=i(o=function(e){f()(r,e);var t=U(r);function r(e){var n;return l()(this,r),n=t.call(this,e),k()(p()(n),"getComponentText",(function(){return n.props.vrStereoText})),k()(p()(n),"onClick",(function(){n.props.player.toggleVrStereoMode(),n.props.updateVrStereoMode(!n.props.vrStereoMode)})),k()(p()(n),"onKeyDown",(function(e){e.keyCode===C.KeyMap.ENTER&&n.onClick()})),(0,L.registerToBottomBar)(F,e.player,(function(){return n.registerComponent()})),n}return c()(r,[{key:"registerComponent",value:function(){var e=this;return{ariaLabel:function(){return e.getComponentText()},displayName:F,order:5,svgIcon:function(){return e.getSvgIcon()},onClick:function(){return e.onClick()},component:function(){return H(B(B({},e.props),{},{classNames:[b().upperBarIcon]}))},shouldHandleOnClick:!1}}},{key:"getSvgIcon",value:function(){return{type:N.redux.useStore().getState().engine.vrStereoMode?S.IconType.vrStereoFull:S.IconType.vrStereo}}},{key:"_shouldRender",value:function(){var e=this.props.config,t=this.props.isVr&&!(0===Object.keys(e).length&&e.constructor===Object);return this.props.onToggle(F,t),t}},{key:"componentWillMount",value:function(){this.props.updateVrStereoMode(this.props.config.vrStereoMode)}},{key:"render",value:function(){return this._shouldRender()?(0,T.h)(O.ButtonControl,{name:F,className:this.props.classNames?this.props.classNames.join(" "):""},(0,T.h)(R.Tooltip,{label:this.props.vrStereoText},(0,T.h)(D.Button,{tabIndex:"0","aria-label":this.props.vrStereoText,className:this.props.vrStereoMode?[b().controlButton,b().vrStereoMode].join(" "):b().controlButton,onClick:this.onClick,onKeyDown:this.onKeyDown},(0,T.h)(S.default,{type:S.IconType.vrStereo}),(0,T.h)(S.default,{type:S.IconType.vrStereoFull})))):void 0}}]),r}(T.Component))||o)||o)||o)||o),H=function(e){return(0,T.h)(V,e)};V.displayName=F},"./src/components/watermark/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Watermark:function(){return n.Watermark}});var n=r("./src/components/watermark/watermark.tsx")},"./src/components/watermark/watermark.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{Watermark:function(){return I}});var n,a,i,o=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/inherits.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=r.n(f),g=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=r.n(g),v=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),_=r.n(v),k=r("./src/styles/style.scss"),E=r.n(k),b=r("./node_modules/preact/dist/preact.module.js"),T=r("./node_modules/react-redux/es/index.js"),A=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),S=r("./src/components/player/index.ts"),C=r("./src/event/index.ts"),P=r("./src/components/logger/index.ts");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var a=y()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return m()(this,r)}}var w="Watermark",I=(n=(0,T.connect)((function(e){return{config:Object.assign({placement:"top-left",timeout:0},e.config.components.watermark)}})),a=(0,P.withLogger)(w),n(i=(0,S.withPlayer)(i=(0,C.withEventManager)(i=a(i=function(e){h()(r,e);var t=x(r);function r(){var e;return s()(this,r),e=t.call(this),_()(d()(e),"_timeoutId",null),e.setState({show:!0}),e}return u()(r,[{key:"componentDidMount",value:function(){var e=this,t=function(){e.props.config.timeout>0&&(e._timeoutId=setTimeout((function(){return e.setState({show:!1})}),e.props.config.timeout))},r=this.props.player;this.props.eventManager.listenOnce(r,r.Event.PLAYING,t),this.props.eventManager.listen(r,r.Event.CHANGE_SOURCE_ENDED,(function(){e.setState({show:!0}),e.props.eventManager.listenOnce(r,r.Event.PLAYING,t)}))}},{key:"componentWillUnmount",value:function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)}},{key:"render",value:function(e){if(e.config.img){var t=[E().watermark];return e.config.placement.split("-").forEach((function(e){t.push(E()[e])})),e.config.url||t.push(E().emptyUrl),this.state.show||t.push(E().hideWatermark),(0,b.h)("div",{className:t.join(" ")},(0,b.h)("a",{href:e.config.url,target:"_blank",rel:"noopener noreferrer"},(0,b.h)(A.Localizer,null,(0,b.h)("img",{src:e.config.img,alt:(0,b.h)(A.Text,{id:"watermark.watermark_alt_text"})}))))}}}]),r}(b.Component))||i)||i)||i)||i);I.displayName=w},"./src/event/event-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EventType:function(){return a}});var n="playkit-ui",a={UI_CLICKED:"".concat(n,"-uiclicked"),UI_VISIBILITY_CHANGED:"".concat(n,"-uivisibilitychanged"),GUI_RESIZE:"".concat(n,"-guiresize"),PLAYER_RESIZE:"".concat(n,"-playerresize"),VIDEO_RESIZE:"".concat(n,"-videoresize"),UI_PRESET_CHANGE:"".concat(n,"-uipresetchange"),USER_CLICKED_PLAY:"".concat(n,"-userclickedplay"),USER_CLICKED_PAUSE:"".concat(n,"-userclickedpause"),USER_CLICKED_REWIND:"".concat(n,"-userclickedrewind"),USER_CLICKED_FORWARD:"".concat(n,"-userclickedforward"),USER_CLICKED_LIVE_TAG:"".concat(n,"-userclickedlivetag"),USER_CLICKED_LOGO:"".concat(n,"-userclickedlogo"),USER_CLICKED_MUTE:"".concat(n,"-userclickedmute"),USER_CLICKED_UNMUTE:"".concat(n,"-userclickedunmute"),USER_CLICKED_ADVANCED_AUDIO_DESCRIPTION:"".concat(n,"-userclickedadvancedaudiodescription"),USER_CHANGED_VOLUME:"".concat(n,"-userchangedvolume"),USER_SELECTED_CAPTION_TRACK:"".concat(n,"-userselectedcaptiontrack"),USER_SHOWED_CAPTIONS:"".concat(n,"-usershowedcaptions"),USER_HID_CAPTIONS:"".concat(n,"-userhidcaptions"),USER_SELECTED_AUDIO_TRACK:"".concat(n,"-userselectedaudiotrack"),USER_SELECTED_QUALITY_TRACK:"".concat(n,"-userselectedqualitytrack"),USER_ENTERED_FULL_SCREEN:"".concat(n,"-userenteredfullscreen"),USER_EXITED_FULL_SCREEN:"".concat(n,"-userexitedfullscreen"),USER_ENTERED_PICTURE_IN_PICTURE:"".concat(n,"-userenteredpictureinpicture"),USER_EXITED_PICTURE_IN_PICTURE:"".concat(n,"-userexitedpictureinpicture"),USER_SELECTED_CAPTIONS_STYLE:"".concat(n,"-userselectedcaptionsstyle"),USER_SELECTED_SPEED:"".concat(n,"-userselectedspeed"),USER_SEEKED:"".concat(n,"-userseeked"),RESIZE:"".concat(n,"-resize"),USER_SELECTED_CAPTIONS_SIZE:"".concat(n,"-userselectedcaptionssize"),USER_SELECTED_CAPTIONS_ALIGNMENT:"".concat(n,"-userselectedcaptionsalignment"),USER_SELECTED_CAPTIONS_FONT_COLOR:"".concat(n,"-userselectedcaptionsfontcolor"),USER_SELECTED_CAPTIONS_FONT_FAMILY:"".concat(n,"-userselectedcaptionsfontfamily"),USER_SELECTED_CAPTIONS_FONT_STYLE:"".concat(n,"-userselectedcaptionsfontstyle"),USER_SELECTED_CAPTIONS_FONT_OPACITY:"".concat(n,"-userselectedcaptionsfontopacity"),USER_SELECTED_CAPTIONS_BACKGROUND_COLOR:"".concat(n,"-userselectedcaptionsbackgroundcolor"),USER_SELECTED_CAPTIONS_BACKGROUND_OPACITY:"".concat(n,"-userselectedcaptionsbackgroundopacity")}},"./src/event/events/audio-selected-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AudioSelectedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.USER_SELECTED_AUDIO_TRACK)).payload={audioTrack:e},n}return r}(d.FakeEvent)},"./src/event/events/caption-selected-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionSelectedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.USER_SELECTED_CAPTION_TRACK)).payload={captionTrack:e},n}return r}(d.FakeEvent)},"./src/event/events/captions-style-selected-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CaptionsStyleSelectedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.USER_SELECTED_CAPTIONS_STYLE)).payload={captionsStyle:e},n}return r}(d.FakeEvent)},"./src/event/events/forward-clicked.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ForwardClickedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e,n){var i;return a()(this,r),(i=t.call(this,p.EventType.USER_CLICKED_FORWARD)).payload={from:e,to:n},i}return r}(d.FakeEvent)},"./src/event/events/gui-resize-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{GuiResizeEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.GUI_RESIZE)).payload={guiSize:e},n}return r}(d.FakeEvent)},"./src/event/events/player-resize-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PlayerResizeEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.PLAYER_RESIZE)).payload={playerSize:e},n}return r}(d.FakeEvent)},"./src/event/events/quality-selected-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{QualitySelectedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.USER_SELECTED_QUALITY_TRACK)).payload={qualityTrack:e},n}return r}(d.FakeEvent)},"./src/event/events/rewind-clicked.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{RewindClickedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e,n){var i;return a()(this,r),(i=t.call(this,p.EventType.USER_CLICKED_REWIND)).payload={from:e,to:n},i}return r}(d.FakeEvent)},"./src/event/events/seeked-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SeekedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e,n){var i;return a()(this,r),(i=t.call(this,p.EventType.USER_SEEKED)).payload={from:e,to:n},i}return r}(d.FakeEvent)},"./src/event/events/speed-selected-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{SpeedSelectedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.USER_SELECTED_SPEED)).payload={speed:e},n}return r}(d.FakeEvent)},"./src/event/events/ui-visibility-changed-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{UIVisibilityChangedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.UI_VISIBILITY_CHANGED)).payload={visible:e},n}return r}(d.FakeEvent)},"./src/event/events/video-resize-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{VideoResizeEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.VIDEO_RESIZE)).payload={videoSize:e},n}return r}(d.FakeEvent)},"./src/event/events/volume-changed.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{VolumeChangedEvent:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/inherits.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),c=r.n(u),d=r("@playkit-js/playkit-js"),p=r("./src/event/event-type.ts");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c()(e);if(t){var a=c()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l()(this,r)}}var f=function(e){o()(r,e);var t=h(r);function r(e){var n;return a()(this,r),(n=t.call(this,p.EventType.USER_CHANGED_VOLUME)).payload={volume:e},n}return r}(d.FakeEvent)},"./src/event/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EventType:function(){return a.EventType},withEventManager:function(){return n.withEventManager}});var n=r("./src/event/with-event-manager.tsx"),a=r("./src/event/event-type.ts")},"./src/event/with-event-manager.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withEventManager:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("@playkit-js/playkit-js");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var b=function(e){return function(t){p()(n,t);var r=E(n);function n(){var e;o()(this,n);for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];return e=r.call.apply(r,[this].concat(a)),v()(c()(e),"eventManager",new k.EventManager),e}return l()(n,[{key:"componentWillUnmount",value:function(){this.eventManager&&(this.eventManager.destroy(),this.eventManager=null)}},{key:"render",value:function(){return(0,_.h)(e,a()({},this.props,{eventManager:this.eventManager}))}}]),n}(_.Component)}},"./src/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Components:function(){return c},Event:function(){return m},EventType:function(){return g.EventType},NAME:function(){return _},Presets:function(){return u},Reducers:function(){return l},ReservedPresetAreas:function(){return f.ReservedPresetAreas},ReservedPresetNames:function(){return f.ReservedPresetNames},SidePanelModes:function(){return f.SidePanelModes},SidePanelPositions:function(){return f.SidePanelPositions},UIEventType:function(){return g.EventType},UIManager:function(){return n.UIManager},Utils:function(){return d},VERSION:function(){return v},components:function(){return c},createPortal:function(){return y.createPortal},h:function(){return a.h},preact:function(){return a},preactHooks:function(){return s},preacti18n:function(){return o},presets:function(){return u},reducers:function(){return l},redux:function(){return i},style:function(){return k},utils:function(){return d}});var n=r("./src/ui-manager.tsx"),a=r("./node_modules/preact/dist/preact.module.js"),i=r("./node_modules/react-redux/es/index.js"),o=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),s=r("./node_modules/preact/hooks/dist/hooks.module.js"),l=r("./src/reducers/index.ts"),u=r("./src/ui-presets/index.ts"),c=r("./src/components/index.ts"),d=r("./src/utils/index.ts"),p=r("./src/styles/style.scss"),h=r.n(p),f=r("./src/reducers/shell.ts"),m=r("./src/event/index.ts"),g=r("./src/event/event-type.ts"),y=r("./node_modules/preact/compat/dist/compat.module.js"),v=(r("./src/types/index.ts"),"0.79.6"),_="@playkit-js/playkit-js-ui",k=h()},"./src/middlewares/debounce-middleware.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{debounceMiddleware:function(){return o}});var n=r("./src/reducers/shell.ts"),a=null,i=null,o=function(){return function(e){return function(e){return function(t){t.type===n.types.UPDATE_IS_SMALL_SIZE?(i=t,a&&clearTimeout(a),a=setTimeout((function(){a=null,e(i)}),150)):e(t)}}}}},"./src/middlewares/event-dispatcher.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{eventDispatcherMiddleware:function(){return S},types:function(){return A}});var n,a=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),i=r.n(a),o=r("@playkit-js/playkit-js"),s=r("./src/reducers/shell.ts"),l=r("./src/event/events/audio-selected-event.ts"),u=r("./src/event/events/caption-selected-event.ts"),c=r("./src/event/events/captions-style-selected-event.ts"),d=r("./src/event/events/quality-selected-event.ts"),p=r("./src/event/events/seeked-event.ts"),h=r("./src/event/events/speed-selected-event.ts"),f=r("./src/event/events/player-resize-event.ts"),m=r("./src/event/events/gui-resize-event.ts"),g=r("./src/event/events/video-resize-event.ts"),y=r("./src/event/events/ui-visibility-changed-event.ts"),v=r("./src/event/events/rewind-clicked.ts"),_=r("./src/event/events/forward-clicked.ts"),k=r("./src/event/events/volume-changed.ts"),E=r("./src/utils/index.ts"),b=r("./src/event/index.ts"),T="event-dispatcher-middleware",A={COMPONENT_CLICKED:"".concat(T,"/COMPONENT_CLICKED"),COMPONENT_CHANGED:"".concat(T,"/COMPONENT_CHANGED")},S=function(e){return function(t){return function(r){return function(n){switch(n.type){case A.COMPONENT_CLICKED:!function(e,t,r){switch(t.name){case"Keyboard":w[t.payload.key](e,t,r);break;case"OverlayAction":!function(e,t,r){"PlayPause"===t.payload.type?C(e,0,r):"Fullscreen"===t.payload.type&&x(0,0,r)}(e,t,r);break;case"CaptionsMenu":!function(e,t,r){t.payload.type===r.Track.TEXT&&r.dispatchEvent(new u.CaptionSelectedEvent(t.payload.track))}(0,t,r);break;case"AudioMenu":!function(e,t,r){t.payload.type===r.Track.AUDIO&&r.dispatchEvent(new l.AudioSelectedEvent(t.payload.track))}(0,t,r);break;case"QualityMenu":!function(e,t,r){t.payload.type===r.Track.VIDEO&&r.dispatchEvent(new d.QualitySelectedEvent(t.payload.track))}(0,t,r);break;case"SpeedMenu":!function(e,t,r){"speed"===t.payload.type&&r.dispatchEvent(new h.SpeedSelectedEvent(t.payload.speed))}(0,t,r);break;case"AdvancedAudioDescToggle":!function(e,t,r){"AdvancedAudioDescription"===t.payload.type&&r.dispatchEvent(new o.FakeEvent(b.EventType.USER_CLICKED_ADVANCED_AUDIO_DESCRIPTION,t.payload))}(0,t,r);break;case"CVAAOverlay":r.dispatchEvent(new c.CaptionsStyleSelectedEvent(t.payload.textStyle));break;case"Fullscreen":x(0,0,r);break;case"Shell":r.dispatchEvent(new o.FakeEvent(b.EventType.UI_CLICKED));break;case"Rewind":r.dispatchEvent(new v.RewindClickedEvent(t.payload.from,t.payload.to));break;case"Forward":r.dispatchEvent(new _.ForwardClickedEvent(t.payload.from,t.payload.to));break;case"LiveTag":r.dispatchEvent(new o.FakeEvent(b.EventType.USER_CLICKED_LIVE_TAG));break;case"PrePlaybackPlayOverlay":case"PlayPause":C(e,0,r);break;case"Volume":P(e,0,r)}}(t,n,e);break;case A.COMPONENT_CHANGED:!function(e,t,r){switch(t.name){case"Volume":r.dispatchEvent(new k.VolumeChangedEvent(t.payload.volume));break;case"SeekBarPlaybackContainer":r.dispatchEvent(new p.SeekedEvent(t.payload.from,t.payload.to));break;case"ActivePreset":r.dispatchEvent(new o.FakeEvent(b.EventType.UI_PRESET_CHANGE,t.payload))}}(0,n,e);break;case s.types.UPDATE_PLAYER_HOVER_STATE:!function(e,t,r){var n=e.getState().engine,a=e.getState().shell;!n.adBreak&&n.isPlaying&&a.playerHover!==t.hover&&r.dispatchEvent(new y.UIVisibilityChangedEvent(t.hover))}(t,n,e)}switch(r(n),n.type){case s.types.UPDATE_GUI_CLIENT_RECT:!function(e,t,r){var n=e.getState().shell.guiClientRect;r.dispatchEvent(new m.GuiResizeEvent(n))}(t,0,e);break;case s.types.UPDATE_PLAYER_CLIENT_RECT:!function(e,t,r){var n=e.getState().shell.playerClientRect;r.dispatchEvent(new f.PlayerResizeEvent(n))}(t,0,e);break;case s.types.UPDATE_VIDEO_CLIENT_RECT:!function(e,t,r){var n=e.getState().shell.videoClientRect;r.dispatchEvent(new g.VideoResizeEvent(n))}(t,0,e)}}}}};function C(e,t,r){var n=e.getState().engine;n.adBreak?n.adIsPlaying?r.dispatchEvent(new o.FakeEvent(b.EventType.USER_CLICKED_PAUSE)):r.dispatchEvent(new o.FakeEvent(b.EventType.USER_CLICKED_PLAY)):n.isPlaying?r.dispatchEvent(new o.FakeEvent(b.EventType.USER_CLICKED_PAUSE)):r.dispatchEvent(new o.FakeEvent(b.EventType.USER_CLICKED_PLAY))}function P(e,t,r){e.getState().engine.muted?r.dispatchEvent(new o.FakeEvent(b.EventType.USER_CLICKED_MUTE)):r.dispatchEvent(new o.FakeEvent(b.EventType.USER_CLICKED_UNMUTE))}function x(e,t,r){r.isFullscreen()?r.dispatchEvent(new o.FakeEvent(b.EventType.USER_EXITED_FULL_SCREEN)):r.dispatchEvent(new o.FakeEvent(b.EventType.USER_ENTERED_FULL_SCREEN))}var w=(n={},i()(n,E.KeyMap.SPACE,(function(e,t,r){C(e,0,r)})),i()(n,E.KeyMap.UP,(function(e,t,r){r.dispatchEvent(new k.VolumeChangedEvent(t.payload.volume))})),i()(n,E.KeyMap.DOWN,(function(e,t,r){r.dispatchEvent(new k.VolumeChangedEvent(t.payload.volume))})),i()(n,E.KeyMap.F,(function(e,t,r){x(0,0,r)})),i()(n,E.KeyMap.P,(function(e,t,r){!function(e,t,r){r.isInPictureInPicture()?r.dispatchEvent(new o.FakeEvent(b.EventType.USER_EXITED_PICTURE_IN_PICTURE)):r.dispatchEvent(new o.FakeEvent(b.EventType.USER_ENTERED_PICTURE_IN_PICTURE))}(0,0,r)})),i()(n,E.KeyMap.ESC,(function(e,t,r){x(0,0,r)})),i()(n,E.KeyMap.LEFT,(function(e,t,r){r.dispatchEvent(new p.SeekedEvent(t.payload.from,t.payload.to))})),i()(n,E.KeyMap.RIGHT,(function(e,t,r){r.dispatchEvent(new p.SeekedEvent(t.payload.from,t.payload.to))})),i()(n,E.KeyMap.HOME,(function(e,t,r){r.dispatchEvent(new p.SeekedEvent(t.payload.from,t.payload.to))})),i()(n,E.KeyMap.END,(function(e,t,r){r.dispatchEvent(new p.SeekedEvent(t.payload.from,t.payload.to))})),i()(n,E.KeyMap.M,(function(e,t,r){P(e,0,r)})),i()(n,E.KeyMap.SEMI_COLON,(function(e,t,r){r.dispatchEvent(new h.SpeedSelectedEvent(t.payload.speed))})),i()(n,E.KeyMap.PERIOD,(function(e,t,r){r.dispatchEvent(new h.SpeedSelectedEvent(t.payload.speed))})),i()(n,E.KeyMap.COMMA,(function(e,t,r){r.dispatchEvent(new h.SpeedSelectedEvent(t.payload.speed))})),i()(n,E.KeyMap.C,(function(e,t,r){r.dispatchEvent(new u.CaptionSelectedEvent(t.payload.track))})),n)},"./src/middlewares/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{middleware:function(){return s}});var n=r("./node_modules/redux/es/redux.js"),a=r("./src/middlewares/event-dispatcher.ts"),i=r("./src/middlewares/logger.ts"),o=r("./src/middlewares/debounce-middleware.ts"),s=function(e,t){return(0,n.applyMiddleware)((0,i.loggerMiddleware)(t),(0,a.eventDispatcherMiddleware)(e),(0,o.debounceMiddleware)())}},"./src/middlewares/logger.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{loggerMiddleware:function(){return i}});var n,a=r("./src/utils/logger.ts"),i=function(e){return function(t){return function(t){return function(r){n||(n=(0,a.default)("UILoggerMiddleware")),e.debugActions&&n.debug("Action fired",r),t(r)}}}}},"./src/reducers/bottom-bar.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={UPDATE_CONTROLS_TO_MOVE:"bottom-bar/UPDATE_CONTROLS_TO_MOVE"},l={controlsToMove:[]};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return t.type===s.UPDATE_CONTROLS_TO_MOVE?o(o({},e),{},{controlsToMove:t.controlsToMove}):e};var u={updateControlsToMove:function(e){return{type:s.UPDATE_CONTROLS_TO_MOVE,controlsToMove:e}}}},"./src/reducers/config.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return c},initialState:function(){return u},types:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n),i=r("./src/utils/merge-deep.ts");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l={UPDATE:"config/UPDATE",UPDATE_COMPONENT:"config/UPDATE_COMPONENT",RESET:"config/RESET"},u={targetId:void 0,forceTouchUI:!1,showCCButton:!0,openMenuFromCCButton:!1,settings:{showAudioMenu:!0,showCaptionsMenu:!0,showQualityMenu:!0,showSpeedMenu:!0,showAdvancedAudioDescToggle:!1,showAdvancedCaptionsMenu:!0},hoverTimeout:3e3,components:{watermark:{},seekbar:{},vrStereo:{},logo:{},fullscreen:{},sidePanels:{}}};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.UPDATE:var r=(0,i.mergeDeep)({},e,t.config);return s(s({},e),r);case l.UPDATE_COMPONENT:return s(s({},e),{},{components:s(s({},e.components),{},a()({},t.componentAlias,(0,i.mergeDeep)({},e.components[t.componentAlias],t.config)))});default:return e}};var c={updateConfig:function(e){return{type:l.UPDATE,config:e}},updateComponentConfig:function(e,t){return{type:l.UPDATE_COMPONENT,componentAlias:e,config:t}}}},"./src/reducers/cvaa.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={UPDATE_CAPTIONS_STYLE:"cvaa/UPDATE_CAPTIONS_STYLE"},l={style:"default"};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return t.type===s.UPDATE_CAPTIONS_STYLE?o(o({},e),{},{style:t.style}):e};var u={updateCaptionsStyle:function(e){return{type:s.UPDATE_CAPTIONS_STYLE,style:e}}}},"./src/reducers/engine.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return p},initialState:function(){return d},types:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n),i=r("./src/utils/component-config.ts"),o=r("./src/reducers/config.ts");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u="engine",c={UPDATE_PLAYER_STATE:"".concat(u,"/UPDATE_PLAYER_STATE"),UPDATE_PRE_PLAYBACK:"".concat(u,"/UPDATE_PRE_PLAYBACK"),UPDATE_IS_PLAYING:"".concat(u,"/UPDATE_IS_PLAYING"),UPDATE_IS_PAUSED:"".concat(u,"/UPDATE_IS_PAUSED"),UPDATE_IS_SEEKING:"".concat(u,"/UPDATE_IS_SEEKING"),UPDATE_LAST_SEEK_POINT:"".concat(u,"/UPDATE_LAST_SEEK_POINT"),UPDATE_IS_CHANGING_SOURCE:"".concat(u,"/UPDATE_IS_CHANGING_SOURCE"),UPDATE_IS_ENDED:"".concat(u,"/UPDATE_IS_ENDED"),UPDATE_IS_PLAYBACK_STARTED:"".concat(u,"/UPDATE_IS_PLAYBACK_STARTED"),UPDATE_IS_PLAYBACK_ENDED:"".concat(u,"/UPDATE_IS_PLAYBACK_ENDED"),UPDATE_CURRENT_TIME:"".concat(u,"/UPDATE_CURRENT_TIME"),UPDATE_DURATION:"".concat(u,"/UPDATE_DURATION"),UPDATE_VOLUME:"".concat(u,"/UPDATE_VOLUME"),UPDATE_MUTED:"".concat(u,"/UPDATE_MUTED"),UPDATE_METADATA_LOADING_STATUS:"".concat(u,"/UPDATE_METADATA_LOADING_STATUS"),UPDATE_DATA_LOADING_STATUS:"".concat(u,"/UPDATE_DATA_LOADING_STATUS"),UPDATE_AUDIO_TRACKS:"".concat(u,"/UPDATE_AUDIO_TRACKS"),UPDATE_VIDEO_TRACKS:"".concat(u,"/UPDATE_VIDEO_TRACKS"),UPDATE_TEXT_TRACKS:"".concat(u,"/UPDATE_TEXT_TRACKS"),UPDATE_AD_BREAK:"".concat(u,"/UPDATE_AD_BREAK"),UPDATE_AD_BREAK_PROGRESS:"".concat(u,"/UPDATE_AD_BREAK_PROGRESS"),UPDATE_AD_BREAK_COMPLETED:"".concat(u,"/UPDATE_AD_BREAK_COMPLETED"),UPDATE_AD_IS_PLAYING:"".concat(u,"/UPDATE_AD_IS_PLAYING"),UPDATE_AD_SKIP_TIME_OFFSET:"".concat(u,"/UPDATE_AD_SKIP_TIME_OFFSET"),UPDATE_AD_SKIPPABLE_STATE:"".concat(u,"/UPDATE_AD_SKIPPABLE_STATE"),UPDATE_AD_URL:"".concat(u,"/UPDATE_AD_URL"),UPDATE_AD_IS_LINEAR:"".concat(u,"/UPDATE_AD_IS_LINEAR"),UPDATE_AD_IS_BUMPER:"".concat(u,"/UPDATE_AD_IS_BUMPER"),UPDATE_AD_CONTENT_TYPE:"".concat(u,"/UPDATE_AD_CONTENT_TYPE"),UPDATE_PLAYER_POSTER:"".concat(u,"/UPDATE_PLAYER_POSTER"),UPDATE_IS_AUDIO:"".concat(u,"/UPDATE_IS_AUDIO"),UPDATE_IS_LIVE:"".concat(u,"/UPDATE_IS_LIVE"),UPDATE_IS_DVR:"".concat(u,"/UPDATE_IS_DVR"),UPDATE_IS_IMG:"".concat(u,"/UPDATE_IS_IMG"),UPDATE_IS_DOCUMENT:"".concat(u,"/UPDATE_IS_DOCUMENT"),UPDATE_ERROR:"".concat(u,"/ERROR"),UPDATE_ERROR_DETAILS:"".concat(u,"/ERROR_DETAILS"),UPDATE_IS_IDLE:"".concat(u,"/UPDATE_IS_IDLE"),UPDATE_FALLBACK_TO_MUTED_AUTOPLAY:"".concat(u,"/UPDATE_FALLBACK_TO_MUTED_AUTOPLAY"),UPDATE_IS_VR:"".concat(u,"/UPDATE_IS_VR"),UPDATE_VR_STEREO_MODE:"".concat(u,"/UPDATE_VR_STEREO_MODE"),UPDATE_IS_CASTING:"".concat(u,"/UPDATE_IS_CASTING"),UPDATE_CAST_SESSION:"".concat(u,"/UPDATE_CAST_SESSION"),UPDATE_IS_CAST_AVAILABLE:"".concat(u,"/UPDATE_IS_CAST_AVAILABLE"),UPDATE_PLAYLIST:"".concat(u,"/UPDATE_PLAYLIST"),UPDATE_PICTURE_IN_PICTURE_SUPPORTED:"".concat(u,"/UPDATE_PICTURE_IN_PICTURE_SUPPORTED"),UPDATE_PICTURE_IN_PICTURE_MODE:"".concat(u,"/UPDATE_PICTURE_IN_PICTURE_MODE"),UPDATE_FULLSCREEN:"".concat(u,"/UPDATE_FULLSCREEN")},d={isIdle:!1,isPlaying:!1,isPaused:!0,isSeeking:!1,isEnded:!1,isPlaybackStarted:!1,isPlaybackEnded:!1,isChangingSource:!1,prePlayback:!0,metadataLoaded:!1,dataLoaded:!1,playerState:{previousState:"",currentState:""},fallbackToMutedAutoPlay:!1,poster:"",currentTime:0,lastSeekPoint:0,duration:0,volume:1,muted:!1,videoTracks:[],audioTracks:[],textTracks:[],adIsLinear:!1,adBreak:!1,adIsPlaying:!1,adSkipTimeOffset:0,adSkippableState:!1,adIsBumper:!1,adContentType:null,isLive:!1,isDvr:!1,isImg:!1,isDocument:!1,isAudio:!1,adProgress:{currentTime:0,duration:0},adUrl:"",hasError:!1,errorDetails:{errorCategory:void 0,errorTitle:void 0,errorMessage:void 0},isVr:!1,vrStereoMode:!1,isCasting:!1,castSession:null,isCastAvailable:!1,pictureInPictureSupported:!1,isInPictureInPicture:!1,playlist:null,fullscreen:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.types.UPDATE:return(0,i.getComponentStateFromConfig)(u,e,t);case o.types.UPDATE_COMPONENT:return(0,i.getComponentStateFromComponentConfig)(u,e,t);case c.UPDATE_ERROR:return l(l({},e),{},{hasError:t.hasError});case c.UPDATE_ERROR_DETAILS:return l(l({},e),{},{errorDetails:t.errorDetails});case c.UPDATE_PLAYER_STATE:return l(l({},e),{},{playerState:t.playerState});case c.UPDATE_PRE_PLAYBACK:return l(l({},e),{},{prePlayback:t.prePlayback});case c.UPDATE_IS_PLAYING:return l(l({},e),{},{isPlaying:t.isPlaying});case c.UPDATE_IS_PAUSED:return l(l({},e),{},{isPaused:t.isPaused});case c.UPDATE_IS_SEEKING:return l(l({},e),{},{isSeeking:t.isSeeking});case c.UPDATE_LAST_SEEK_POINT:return l(l({},e),{},{lastSeekPoint:t.lastSeekPoint});case c.UPDATE_IS_ENDED:return l(l({},e),{},{isEnded:t.isEnded});case c.UPDATE_IS_PLAYBACK_STARTED:return l(l({},e),{},{isPlaybackStarted:t.isPlaybackStarted});case c.UPDATE_IS_PLAYBACK_ENDED:return l(l({},e),{},{isPlaybackEnded:t.isPlaybackEnded});case c.UPDATE_CURRENT_TIME:return l(l({},e),{},{currentTime:t.currentTime});case c.UPDATE_DURATION:return l(l({},e),{},{duration:t.duration});case c.UPDATE_VOLUME:return l(l({},e),{},{volume:t.volume});case c.UPDATE_MUTED:return l(l({},e),{},{muted:t.muted});case c.UPDATE_METADATA_LOADING_STATUS:return l(l({},e),{},{metadataLoaded:t.metadataLoaded});case c.UPDATE_DATA_LOADING_STATUS:return l(l({},e),{},{dataLoaded:t.dataLoaded});case c.UPDATE_AUDIO_TRACKS:return l(l({},e),{},{audioTracks:t.tracks});case c.UPDATE_VIDEO_TRACKS:return l(l({},e),{},{videoTracks:t.tracks});case c.UPDATE_TEXT_TRACKS:return l(l({},e),{},{textTracks:t.tracks});case c.UPDATE_AD_BREAK:return l(l({},e),{},{adBreak:t.adBreak});case c.UPDATE_AD_BREAK_PROGRESS:return l(l({},e),{},{adProgress:t.adProgress});case c.UPDATE_AD_BREAK_COMPLETED:return l(l({},e),{},{adProgress:{currentTime:e.adProgress.duration,duration:e.adProgress.duration}});case c.UPDATE_AD_IS_PLAYING:return l(l({},e),{},{adIsPlaying:t.adIsPlaying});case c.UPDATE_AD_IS_LINEAR:return l(l({},e),{},{adIsLinear:t.adIsLinear});case c.UPDATE_AD_SKIP_TIME_OFFSET:return l(l({},e),{},{adSkipTimeOffset:t.adSkipTimeOffset});case c.UPDATE_AD_SKIPPABLE_STATE:return l(l({},e),{},{adSkippableState:t.adSkippableState});case c.UPDATE_AD_URL:return l(l({},e),{},{adUrl:t.adUrl});case c.UPDATE_AD_IS_BUMPER:return l(l({},e),{},{adIsBumper:t.adIsBumper});case c.UPDATE_AD_CONTENT_TYPE:return l(l({},e),{},{adContentType:t.adContentType});case c.UPDATE_PLAYER_POSTER:return l(l({},e),{},{poster:t.poster});case c.UPDATE_IS_AUDIO:return l(l({},e),{},{isAudio:t.isAudio});case c.UPDATE_IS_LIVE:return l(l({},e),{},{isLive:t.isLive});case c.UPDATE_IS_DVR:return l(l({},e),{},{isDvr:t.isDvr});case c.UPDATE_IS_IMG:return l(l({},e),{},{isImg:t.isImg});case c.UPDATE_IS_DOCUMENT:return l(l({},e),{},{isDocument:t.isDocument});case c.UPDATE_IS_IDLE:return l(l({},e),{},{isIdle:t.IsIdle});case c.UPDATE_FALLBACK_TO_MUTED_AUTOPLAY:return l(l({},e),{},{fallbackToMutedAutoPlay:t.fallback});case c.UPDATE_IS_VR:return l(l({},e),{},{isVr:t.isVr});case c.UPDATE_VR_STEREO_MODE:return l(l({},e),{},{vrStereoMode:t.vrStereoMode});case c.UPDATE_IS_CASTING:return l(l({},e),{},{isCasting:t.isCasting});case c.UPDATE_CAST_SESSION:return l(l({},e),{},{castSession:t.castSession});case c.UPDATE_IS_CAST_AVAILABLE:return l(l({},e),{},{isCastAvailable:t.isCastAvailable});case c.UPDATE_IS_CHANGING_SOURCE:return l(l({},e),{},{isChangingSource:t.isChangingSource});case c.UPDATE_PLAYLIST:return l(l({},e),{},{playlist:t.playlist});case c.UPDATE_PICTURE_IN_PICTURE_SUPPORTED:return l(l({},e),{},{isPictureInPictureSupported:t.isPictureInPictureSupported});case c.UPDATE_PICTURE_IN_PICTURE_MODE:return l(l({},e),{},{isInPictureInPicture:t.isInPictureInPicture});case c.UPDATE_FULLSCREEN:return l(l({},e),{},{fullscreen:t.fullscreen});default:return e}};var p={updateHasError:function(e){return{type:c.UPDATE_ERROR,hasError:e}},updateErrorDetails:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{type:c.UPDATE_ERROR_DETAILS,errorDetails:{errorCategory:e,errorTitle:t,errorMessage:r}}},updatePlayerState:function(e,t){return{type:c.UPDATE_PLAYER_STATE,playerState:{prevoiusState:e,currentState:t}}},updatePrePlayback:function(e){return{type:c.UPDATE_PRE_PLAYBACK,prePlayback:e}},updateIsPlaying:function(e){return{type:c.UPDATE_IS_PLAYING,isPlaying:e}},updateIsPaused:function(e){return{type:c.UPDATE_IS_PAUSED,isPaused:e}},updateIsSeeking:function(e){return{type:c.UPDATE_IS_SEEKING,isSeeking:e}},updateLastSeekPoint:function(e){return{type:c.UPDATE_LAST_SEEK_POINT,lastSeekPoint:e}},updateIsEnded:function(e){return{type:c.UPDATE_IS_ENDED,isEnded:e}},updateIsPlaybackStarted:function(e){return{type:c.UPDATE_IS_PLAYBACK_STARTED,isPlaybackStarted:e}},updateIsPlaybackEnded:function(e){return{type:c.UPDATE_IS_PLAYBACK_ENDED,isPlaybackEnded:e}},updateCurrentTime:function(e){return{type:c.UPDATE_CURRENT_TIME,currentTime:e}},updateDuration:function(e){return{type:c.UPDATE_DURATION,duration:e}},updateVolume:function(e){return{type:c.UPDATE_VOLUME,volume:e}},updateMuted:function(e){return{type:c.UPDATE_MUTED,muted:e}},updateMetadataLoadingStatus:function(e){return{type:c.UPDATE_METADATA_LOADING_STATUS,metadataLoaded:e}},updateDataLoadingStatus:function(e){return{type:c.UPDATE_DATA_LOADING_STATUS,dataLoaded:e}},updateAudioTracks:function(e){return{type:c.UPDATE_AUDIO_TRACKS,tracks:e}},updateVideoTracks:function(e){return{type:c.UPDATE_VIDEO_TRACKS,tracks:e}},updateTextTracks:function(e){return{type:c.UPDATE_TEXT_TRACKS,tracks:e}},updateAdBreak:function(e){return{type:c.UPDATE_AD_BREAK,adBreak:e}},updateAdBreakProgress:function(e,t){return{type:c.UPDATE_AD_BREAK_PROGRESS,adProgress:{currentTime:e,duration:t}}},updateAdBreakCompleted:function(){return{type:c.UPDATE_AD_BREAK_COMPLETED}},updateAdIsPlaying:function(e){return{type:c.UPDATE_AD_IS_PLAYING,adIsPlaying:e}},updateAdSkipTimeOffset:function(e){return{type:c.UPDATE_AD_SKIP_TIME_OFFSET,adSkipTimeOffset:e}},updateAdSkippableState:function(e){return{type:c.UPDATE_AD_SKIPPABLE_STATE,adSkippableState:e}},updateAdClickUrl:function(e){return{type:c.UPDATE_AD_URL,adUrl:e}},updateAdIsLinear:function(e){return{type:c.UPDATE_AD_IS_LINEAR,adIsLinear:e}},updateAdIsBumper:function(e){return{type:c.UPDATE_AD_IS_BUMPER,adIsBumper:e}},updateAdContentType:function(e){return{type:c.UPDATE_AD_CONTENT_TYPE,adContentType:e}},updatePlayerPoster:function(e){return{type:c.UPDATE_PLAYER_POSTER,poster:e}},updateIsAudio:function(e){return{type:c.UPDATE_IS_AUDIO,isAudio:e}},updateIsLive:function(e){return{type:c.UPDATE_IS_LIVE,isLive:e}},updateIsDvr:function(e){return{type:c.UPDATE_IS_DVR,isDvr:e}},updateIsImg:function(e){return{type:c.UPDATE_IS_IMG,isImg:e}},updateIsDocument:function(e){return{type:c.UPDATE_IS_DOCUMENT,isDocument:e}},updateIsIdle:function(e){return{type:c.UPDATE_IS_IDLE,IsIdle:e}},updateFallbackToMutedAutoPlay:function(e){return{type:c.UPDATE_FALLBACK_TO_MUTED_AUTOPLAY,fallback:e}},updateIsVr:function(e){return{type:c.UPDATE_IS_VR,isVr:e}},updateVrStereoMode:function(e){return{type:c.UPDATE_VR_STEREO_MODE,vrStereoMode:e}},updateIsCasting:function(e){return{type:c.UPDATE_IS_CASTING,isCasting:e}},updateCastSession:function(e){return{type:c.UPDATE_CAST_SESSION,castSession:e}},updateIsCastAvailable:function(e){return{type:c.UPDATE_IS_CAST_AVAILABLE,isCastAvailable:e}},updateIsChangingSource:function(e){return{type:c.UPDATE_IS_CHANGING_SOURCE,isChangingSource:e}},updatePlaylist:function(e){return{type:c.UPDATE_PLAYLIST,playlist:e}},updatePictureInPictureSupport:function(e){return{type:c.UPDATE_PICTURE_IN_PICTURE_SUPPORTED,isPictureInPictureSupported:e}},updateIsInPictureInPicture:function(e){return{type:c.UPDATE_PICTURE_IN_PICTURE_MODE,isInPictureInPicture:e}},updateFullscreen:function(e){return{type:c.UPDATE_FULLSCREEN,fullscreen:e}}}},"./src/reducers/getters.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{isPlayingAdOrPlayback:function(){return n}});var n=function(e){return e.adBreak&&e.adIsPlaying||!e.adBreak&&e.isPlaying}},"./src/reducers/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{bottomBar:function(){return m},config:function(){return n},cvaa:function(){return a},engine:function(){return i},getters:function(){return o},loading:function(){return s},overlay:function(){return f},overlayAction:function(){return l},playlist:function(){return u},seekbar:function(){return c},setting:function(){return d},shell:function(){return p},volume:function(){return h}});var n=r("./src/reducers/config.ts"),a=r("./src/reducers/cvaa.ts"),i=r("./src/reducers/engine.ts"),o=r("./src/reducers/getters.ts"),s=r("./src/reducers/loading.ts"),l=r("./src/reducers/overlay-action.ts"),u=r("./src/reducers/playlist.ts"),c=r("./src/reducers/seekbar.ts"),d=r("./src/reducers/settings.ts"),p=r("./src/reducers/shell.ts"),h=r("./src/reducers/volume.ts"),f=r("./src/reducers/overlay.ts"),m=r("./src/reducers/bottom-bar.ts")},"./src/reducers/loading.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return p},initialState:function(){return d},types:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n),i=r("./src/reducers/config.ts"),o=r("./src/utils/component-config.ts");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u="loading",c={UPDATE_LOADING_SPINNER_STATE:"".concat(u,"/UPDATE_LOADING_SPINNER_STATE")},d={show:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.types.UPDATE:return(0,o.getComponentStateFromConfig)(u,e,t);case i.types.UPDATE_COMPONENT:return(0,o.getComponentStateFromComponentConfig)(u,e,t);case c.UPDATE_LOADING_SPINNER_STATE:return l(l({},e),{},{show:t.show});default:return e}};var p={updateLoadingSpinnerState:function(e){return{type:c.UPDATE_LOADING_SPINNER_STATE,show:e}}}},"./src/reducers/overlay-action.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={UPDATE_ACTION_ICON:"overlay-action/UPDATE_ACTION_ICON"},l={iconType:null};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return t.type===s.UPDATE_ACTION_ICON?o(o({},e),{},{iconType:t.iconType}):e};var u={updateOverlayActionIcon:function(e){return{type:s.UPDATE_ACTION_ICON,iconType:e}}}},"./src/reducers/overlay.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={UPDATE_OVERLAY:"overlay/UPDATE_OVERLAY"},l={isOpen:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return t.type===s.UPDATE_OVERLAY?o(o({},e),{},{isOpen:t.isOpen}):e};var u={updateOverlay:function(e){return{type:s.UPDATE_OVERLAY,isOpen:e}}}},"./src/reducers/playlist.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={UPDATE_PLAYLIST_COUNTDOWN_CANCELED:"playlist-countdown/UPDATE_PLAYLIST_COUNTDOWN_CANCELED"},l={countdownCanceled:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;return t.type===s.UPDATE_PLAYLIST_COUNTDOWN_CANCELED?o(o({},e),{},{countdownCanceled:t.countdownCanceled}):e};var u={updatePlaylistCountdownCanceled:function(e){return{type:s.UPDATE_PLAYLIST_COUNTDOWN_CANCELED,countdownCanceled:e}}}},"./src/reducers/seekbar.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return p},initialState:function(){return d},types:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=r.n(i);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u="seekbar",c={UPDATE_SEEKBAR_DRAGGING_STATUS:"".concat(u,"/UPDATE_SEEKBAR_DRAGGING_STATUS"),UPDATE_SEEKBAR_HOVER_ACTIVE:"".concat(u,"/UPDATE_SEEKBAR_HOVER_ACTIVE"),UPDATE_SEEKBAR_PREVIEW_HOVER_ACTIVE:"".concat(u,"/UPDATE_SEEKBAR_PREVIEW_HOVER_ACTIVE"),UPDATE_SEEKBAR_CLIENT_RECT:"".concat(u,"/UPDATE_SEEKBAR_CLIENT_RECT"),UPDATE_HIDE_SEEKBAR_PREVIEW:"".concat(u,"/UPDATE_HIDE_SEEKBAR_PREVIEW"),UPDATE_HIDE_SEEKBAR_TIME_BUBBLE:"".concat(u,"/UPDATE_HIDE_SEEKBAR_TIME_BUBBLE"),UPDATE_CURRENT_TIME:"".concat(u,"/UPDATE_CURRENT_TIME"),UPDATE_VIRTUAL_TIME:"".concat(u,"/UPDATE_VIRTUAL_TIME"),UPDATE_HOVERED_SEGMENT:"".concat(u,"/UPDATE_HOVERED_SEGMENT"),UPDATE_SEEKBAR_SEGMENTS:"".concat(u,"/UPDATE_SEEKBAR_SEGMENTS"),UPDATE_SEGMENT_END_TIME:"".concat(u,"/UPDATE_SEGMENT_END_TIME"),ADD_SEEKBAR_CLASS:"".concat(u,"/ADD_SEEKBAR_CLASS"),REMOVE_SEEKBAR_CLASS:"".concat(u,"/REMOVE_SEEKBAR_CLASS"),UPDATE_PREVENT_SEEK:"".concat(u,"/UPDATE_PREVENT_SEEK")},d={currentTime:0,virtualTime:0,draggingActive:!1,hoverActive:!1,previewHoverActive:!1,clientRect:{x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0},hidePreview:!1,hideTimeBubble:!1,segments:[],seekbarClasses:[],isPreventSeek:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.UPDATE_SEEKBAR_DRAGGING_STATUS:return l(l({},e),{},{draggingActive:t.draggingActive});case c.UPDATE_SEEKBAR_HOVER_ACTIVE:return l(l({},e),{},{hoverActive:t.hoverActive});case c.UPDATE_SEEKBAR_PREVIEW_HOVER_ACTIVE:return l(l({},e),{},{previewHoverActive:t.previewHoverActive});case c.UPDATE_SEEKBAR_CLIENT_RECT:return l(l({},e),{},{clientRect:t.clientRect});case c.UPDATE_HIDE_SEEKBAR_PREVIEW:return l(l({},e),{},{hidePreview:t.hidePreview});case c.UPDATE_HIDE_SEEKBAR_TIME_BUBBLE:return l(l({},e),{},{hideTimeBubble:t.hideTimeBubble});case c.UPDATE_CURRENT_TIME:return l(l({},e),{},{currentTime:t.currentTime});case c.UPDATE_VIRTUAL_TIME:return l(l({},e),{},{virtualTime:t.virtualTime});case c.UPDATE_HOVERED_SEGMENT:return l(l({},e),{},{segments:e.segments.map((function(e){return e.id===t.id?l(l({},e),{},{isHovered:t.isHovered}):e}))});case c.UPDATE_SEEKBAR_SEGMENTS:return l(l({},e),{},{segments:t.segments});case c.UPDATE_SEGMENT_END_TIME:return l(l({},e),{},{segments:e.segments.map((function(e){return e.id===t.id?l(l({},e),{},{endTime:t.endTime}):e}))});case c.ADD_SEEKBAR_CLASS:return e.seekbarClasses.includes(t.className)?e:l(l({},e),{},{seekbarClasses:[].concat(a()(e.seekbarClasses),[t.className])});case c.REMOVE_SEEKBAR_CLASS:return l(l({},e),{},{seekbarClasses:e.seekbarClasses.filter((function(e){return e!==t.className}))});case c.UPDATE_PREVENT_SEEK:return l(l({},e),{},{isPreventSeek:t.isPreventSeek});default:return e}};var p={updateSeekbarDraggingStatus:function(e){return{type:c.UPDATE_SEEKBAR_DRAGGING_STATUS,draggingActive:e}},updateSeekbarHoverActive:function(e){return{type:c.UPDATE_SEEKBAR_HOVER_ACTIVE,hoverActive:e}},updateSeekbarPreviewHoverActive:function(e){return{type:c.UPDATE_SEEKBAR_PREVIEW_HOVER_ACTIVE,previewHoverActive:e}},updateSeekbarClientRect:function(e){return{type:c.UPDATE_SEEKBAR_CLIENT_RECT,clientRect:e}},updateHideSeekbarPreview:function(e){return{type:c.UPDATE_HIDE_SEEKBAR_PREVIEW,hidePreview:e}},updateHideSeekbarTimeBubble:function(e){return{type:c.UPDATE_HIDE_SEEKBAR_TIME_BUBBLE,hideTimeBubble:e}},updateCurrentTime:function(e){return{type:c.UPDATE_CURRENT_TIME,currentTime:e}},updateVirtualTime:function(e){return{type:c.UPDATE_VIRTUAL_TIME,virtualTime:e}},updateHoveredSegment:function(e,t){return{type:c.UPDATE_HOVERED_SEGMENT,id:e,isHovered:t}},updateSegmentEndTime:function(e,t){return{type:c.UPDATE_SEGMENT_END_TIME,id:e,endTime:t}},updateSeekbarSegments:function(e){return{type:c.UPDATE_SEEKBAR_SEGMENTS,segments:e}},addSeekbarClass:function(e){return{type:c.ADD_SEEKBAR_CLASS,className:e}},removeSeekbarClass:function(e){return{type:c.REMOVE_SEEKBAR_CLASS,className:e}},updatePreventSeek:function(e){return{type:c.UPDATE_PREVENT_SEEK,isPreventSeek:e}}}},"./src/reducers/settings.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={UPDATE_QUALITY:"settings/UPDATE_QUALITY",UPDATE_SPEED:"settings/UPDATE_SPEED",UPDATE_AUDIO:"settings/UPDATE_AUDIO",UPDATE_ADVANCED_AUDIO_DESC:"settings/UPDATE_ADVANCED_AUDIO_DESC",UPDATE_IS_CAPTIONS_ENABLED:"settings/UPDATE_IS_CAPTIONS_ENABLED"},l={quality:1,speed:2,advancedAudioDesc:!1,isCaptionsEnabled:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s.UPDATE_QUALITY:return o(o({},e),{},{quality:t.quality});case s.UPDATE_SPEED:return o(o({},e),{},{speed:t.speed});case s.UPDATE_AUDIO:return o(o({},e),{},{audio:t.audio});case s.UPDATE_ADVANCED_AUDIO_DESC:return o(o({},e),{},{advancedAudioDesc:t.isChecked});case s.UPDATE_IS_CAPTIONS_ENABLED:return o(o({},e),{},{isCaptionsEnabled:t.isCaptionsEnabled});default:return e}};var u={updateQuality:function(e){return{type:s.UPDATE_QUALITY,quality:e}},updateSpeed:function(e){return{type:s.UPDATE_SPEED,speed:e}},updateAudio:function(e){return{type:s.UPDATE_AUDIO,audio:e}},updateAdvancedAudioDesc:function(e){return{type:s.UPDATE_ADVANCED_AUDIO_DESC,isChecked:e}},updateIsCaptionsEnabled:function(e){return{type:s.UPDATE_IS_CAPTIONS_ENABLED,isCaptionsEnabled:e}}}},"./src/reducers/shell.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ReservedPresetAreas:function(){return v},ReservedPresetNames:function(){return y},SidePanelModes:function(){return g},SidePanelOrientation:function(){return f},SidePanelPositions:function(){return m},actions:function(){return b},initialState:function(){return E},types:function(){return h}});var n,a,i,o=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),u=r.n(l),c=r("./src/utils/is-equal.ts");function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h={ADD_PLAYER_CLASS:"shell/ADD_PLAYER_CLASS",REMOVE_PLAYER_CLASS:"shell/REMOVE_PLAYER_CLASS",UPDATE_IS_MOBILE:"shell/UPDATE_IS_MOBILE",UPDATE_PLAYER_SIZE:"shell/UPDATE_PLAYER_SIZE",UPDATE_IS_SMALL_SIZE:"shell/UPDATE_IS_SMALL_SIZE",UPDATE_GUI_CLIENT_RECT:"shell/UPDATE_GUI_CLIENT_RECT",UPDATE_PLAYER_CLIENT_RECT:"shell/UPDATE_PLAYER_CLIENT_RECT",UPDATE_VIDEO_CLIENT_RECT:"shell/UPDATE_VIDEO_CLIENT_RECT",UPDATE_DOCUMENT_WIDTH:"shell/UPDATE_DOCUMENT_WIDTH",UPDATE_PLAYER_HOVER_STATE:"shell/UPDATE_PLAYER_HOVER_STATE",UPDATE_PLAYER_NAV_STATE:"shell/UPDATE_PLAYER_NAV_STATE",UPDATE_SMART_CONTAINER_OPEN:"shell/UPDATE_SMART_CONTAINER_OPEN",UPDATE_ACTIVE_PRESET_NAME:"shell/UPDATE_ACTIVE_PRESET_NAME",UPDATE_SIDE_PANEL_MODE:"shell/UPDATE_SIDE_PANEL_MODE",UPDATE_SIDE_PANEL_SIZE:"shell/UPDATE_SIDE_PANEL_SIZE",UPDATE_PRESET_SETTINGS:"shell/UPDATE_PRESET_SETTINGS",UPDATE_LAYOUT_STYLES:"shell/UPDATE_LAYOUT_STYLES"},f={VERTICAL:"vertical",HORIZONTAL:"horizontal"},m={LEFT:"left",TOP:"top",BOTTOM:"bottom",RIGHT:"right"},g={ALONGSIDE:"alongside",HIDDEN:"hidden",OVER:"over"},y={Playback:"Playback",Live:"Live",Ads:"Ads",Error:"Error",Idle:"Idle",Img:"Img",Document:"Document",MiniAudioUI:"MiniAudioUI"},v={PlayerArea:"PlayerArea",PresetArea:"PresetArea",InteractiveArea:"InteractiveArea",VideoArea:"VideoArea",GuiArea:"GuiArea",TopBar:"TopBar",BottomBar:"BottomBar",PresetFloating:"PresetFloating",TopBarLeftControls:"TopBarLeftControls",TopBarRightControls:"TopBarRightControls",BottomBarLeftControls:"BottomBarLeftControls",BottomBarRightControls:"BottomBarRightControls",SidePanelTop:"SidePanelTop",SidePanelLeft:"SidePanelLeft",SidePanelRight:"SidePanelRight",SidePanelBottom:"SidePanelBottom",SeekBar:"SeekBar",LoadingSpinner:"LoadingSpinner"},_={x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0},k={position:"absolute",left:0,right:0,top:0,bottom:0},E={playerClasses:[],guiClientRect:_,playerClientRect:_,videoClientRect:_,layoutStyles:{video:k,gui:k,sidePanels:(n={},u()(n,m.LEFT,{}),u()(n,m.RIGHT,{}),u()(n,m.TOP,{}),u()(n,m.BOTTOM,{}),n)},playerHover:!1,playerNav:!1,smartContainerOpen:!1,activePresetName:"",sidePanelsModes:(a={},u()(a,m.LEFT,g.HIDDEN),u()(a,m.RIGHT,g.HIDDEN),u()(a,m.TOP,g.HIDDEN),u()(a,m.BOTTOM,g.HIDDEN),a),sidePanelsSizes:(i={},u()(i,f.VERTICAL,{min:240,max:480,ratio:.33}),u()(i,f.HORIZONTAL,{min:144,max:288,ratio:.33}),i),presetSettings:{allowSidePanels:!1,allowPlayerArea:!1}};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.ADD_PLAYER_CLASS:return e.playerClasses.includes(t.className)?e:p(p({},e),{},{playerClasses:[].concat(s()(e.playerClasses),[t.className])});case h.REMOVE_PLAYER_CLASS:return p(p({},e),{},{playerClasses:e.playerClasses.filter((function(e){return e!==t.className}))});case h.UPDATE_IS_MOBILE:return p(p({},e),{},{isMobile:t.isMobile});case h.UPDATE_PLAYER_SIZE:return p(p({},e),{},{playerSize:t.playerSize});case h.UPDATE_IS_SMALL_SIZE:return p(p({},e),{},{isSmallSize:t.isSmallSize});case h.UPDATE_GUI_CLIENT_RECT:return p(p({},e),{},{guiClientRect:t.guiClientRect});case h.UPDATE_PLAYER_CLIENT_RECT:return p(p({},e),{},{playerClientRect:t.playerClientRect});case h.UPDATE_LAYOUT_STYLES:var r,n=e.layoutStyles,a=n.sidePanels,i=n.video,o=n.gui,l=t.layoutStyles,d=l.sidePanels,f=l.video,g=l.gui;return p(p({},e),{},{layoutStyles:{sidePanels:(r={},u()(r,m.LEFT,(0,c.default)(a[m.LEFT],d[m.LEFT])?a[m.LEFT]:d[m.LEFT]),u()(r,m.RIGHT,(0,c.default)(a[m.RIGHT],d[m.RIGHT])?a[m.RIGHT]:d[m.RIGHT]),u()(r,m.TOP,(0,c.default)(a[m.TOP],d[m.TOP])?a[m.TOP]:d[m.TOP]),u()(r,m.BOTTOM,(0,c.default)(a[m.BOTTOM],d[m.BOTTOM])?a[m.BOTTOM]:d[m.BOTTOM]),r),video:(0,c.default)(i,f)?i:f,gui:(0,c.default)(o,g)?o:g}});case h.UPDATE_VIDEO_CLIENT_RECT:return p(p({},e),{},{videoClientRect:t.videoClientRect});case h.UPDATE_DOCUMENT_WIDTH:return p(p({},e),{},{documentWidth:t.documentWidth});case h.UPDATE_PLAYER_HOVER_STATE:return p(p({},e),{},{playerHover:t.hover});case h.UPDATE_PLAYER_NAV_STATE:return p(p({},e),{},{playerNav:t.nav});case h.UPDATE_SMART_CONTAINER_OPEN:return p(p({},e),{},{smartContainerOpen:t.open});case h.UPDATE_ACTIVE_PRESET_NAME:return p(p({},e),{},{activePresetName:t.activePresetName});case h.UPDATE_SIDE_PANEL_MODE:return p(p({},e),{},{sidePanelsModes:p(p({},e.sidePanelsModes),{},u()({},t.position,t.sidePanelMode))});case h.UPDATE_SIDE_PANEL_SIZE:var y=t.options,v=y.ratio,_=y.min,k=y.max,b=e.sidePanelsSizes[t.orientation],T={ratio:"number"==typeof v&&v<=1?v:b.ratio,min:"number"==typeof _?_:b.min,max:"number"==typeof k?k:b.max};return p(p({},e),{},{sidePanelsSizes:p(p({},e.sidePanelsSizes),{},u()({},t.orientation,T))});case h.UPDATE_PRESET_SETTINGS:return p(p({},e),{},{presetSettings:p(p({},{allowSidePanels:!1,allowPlayerArea:!1}),t.presetSettings||{})});default:return e}};var b={addPlayerClass:function(e){return{type:h.ADD_PLAYER_CLASS,className:e}},removePlayerClass:function(e){return{type:h.REMOVE_PLAYER_CLASS,className:e}},updateIsMobile:function(e){return{type:h.UPDATE_IS_MOBILE,isMobile:e}},updatePlayerSize:function(e){return{type:h.UPDATE_PLAYER_SIZE,playerSize:e}},updateIsSmallSize:function(e){return{type:h.UPDATE_IS_SMALL_SIZE,isSmallSize:e}},updateGuiClientRect:function(e){return{type:h.UPDATE_GUI_CLIENT_RECT,guiClientRect:e}},updatePlayerClientRect:function(e){return{type:h.UPDATE_PLAYER_CLIENT_RECT,playerClientRect:e}},updateVideoClientRect:function(e){return{type:h.UPDATE_VIDEO_CLIENT_RECT,videoClientRect:e}},updateDocumentWidth:function(e){return{type:h.UPDATE_DOCUMENT_WIDTH,documentWidth:e}},updatePlayerHoverState:function(e){return{type:h.UPDATE_PLAYER_HOVER_STATE,hover:e}},updatePlayerNavState:function(e){return{type:h.UPDATE_PLAYER_NAV_STATE,nav:e}},updateSmartContainerOpen:function(e){return{type:h.UPDATE_SMART_CONTAINER_OPEN,open:e}},updateActivePresetName:function(e){return{type:h.UPDATE_ACTIVE_PRESET_NAME,activePresetName:e}},updateSidePanelMode:function(e,t){return{type:h.UPDATE_SIDE_PANEL_MODE,position:e,sidePanelMode:t}},updateSidePanelSize:function(e,t){return{type:h.UPDATE_SIDE_PANEL_SIZE,orientation:e,options:t}},updatePresetSettings:function(e){return{type:h.UPDATE_PRESET_SETTINGS,presetSettings:e}},updateLayoutStyles:function(e){return{type:h.UPDATE_LAYOUT_STYLES,layoutStyles:e}}}},"./src/reducers/volume.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{actions:function(){return u},initialState:function(){return l},types:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={UPDATE_VOLUME_DRAGGING_STATUS:"volume/UPDATE_VOLUME_DRAGGING_STATUS",UPDATE_HOVER:"volume/UPDATE_HOVER"},l={draggingActive:!1,hover:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s.UPDATE_VOLUME_DRAGGING_STATUS:return o(o({},e),{},{draggingActive:t.draggingActive});case s.UPDATE_HOVER:return o(o({},e),{},{hover:t.hover});default:return e}};var u={updateVolumeDraggingStatus:function(e){return{type:s.UPDATE_VOLUME_DRAGGING_STATUS,draggingActive:e}},updateVolumeHover:function(e){return{type:s.UPDATE_HOVER,hover:e}}}},"./src/store.ts":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/redux/es/redux.js"),a=r("./src/reducers/config.ts"),i=r("./src/reducers/engine.ts"),o=r("./src/reducers/shell.ts"),s=r("./src/reducers/seekbar.ts"),l=r("./src/reducers/volume.ts"),u=r("./src/reducers/loading.ts"),c=r("./src/reducers/cvaa.ts"),d=r("./src/reducers/settings.ts"),p=r("./src/reducers/overlay-action.ts"),h=r("./src/reducers/playlist.ts"),f=r("./src/reducers/overlay.ts"),m=r("./src/reducers/bottom-bar.ts"),g=(0,n.combineReducers)({config:a.default,engine:i.default,shell:o.default,seekbar:s.default,volume:l.default,loading:u.default,cvaa:c.default,settings:d.default,overlayAction:p.default,playlist:h.default,overlay:f.default,bottomBar:m.default});t.default=g},"./src/types/components-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/event-handler-option.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/fullscreen-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/index.ts":function(e,t,r){"use strict";r.r(t),r("./src/types/components-config.ts"),r("./src/types/event-handler-option.ts"),r("./src/types/fullscreen-config.ts"),r("./src/types/keyboard-event-handlers.ts"),r("./src/types/keyboard-key.ts"),r("./src/types/logo-config.ts"),r("./src/types/side-panels-config.ts"),r("./src/types/ui-options.ts"),r("./src/types/ui-preset.ts"),r("./src/types/user-theme.ts"),r("./src/types/vr-stereo-config.ts"),r("./src/types/watermark-config.ts"),r("./src/types/reducers/root-state.ts"),r("./src/types/ui-component.ts"),r("./src/types/ui-component-options.ts")},"./src/types/keyboard-event-handlers.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/keyboard-key.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/logo-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/reducers/root-state.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/side-panels-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/ui-component-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/ui-component.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/ui-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/ui-preset.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/user-theme.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/vr-stereo-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/watermark-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/ui-manager.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{UIManager:function(){return M}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/createClass.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),p=r.n(d),h=r("./node_modules/preact/dist/preact.module.js"),f=r("./node_modules/react-redux/es/index.js"),m=r("./node_modules/preact-i18n/dist/preact-i18n.esm.js"),g=r("./node_modules/redux/es/redux.js"),y=r("./src/utils/copy-deep.ts"),v=r("./src/utils/merge-deep.ts"),_=r("./src/utils/logger.ts"),k=r("./src/event/index.ts"),E=r("./src/utils/key-map.ts"),b=r("./src/components/player-area/index.ts"),T=r("./src/store.ts"),A=r("./translations/en.i18n.json"),S=r("./src/reducers/config.ts"),C=r("./src/components/index.ts"),P=r("./src/components/player-gui/index.ts"),x=r("./src/ui-presets/index.ts"),w=r("./src/middlewares/index.ts"),I=(r("./src/styles/style.scss"),r("./src/utils/themes-manager.ts")),M=function(){function e(t,r){l()(this,e),p()(this,"player",void 0),p()(this,"targetId",void 0),p()(this,"store",void 0),p()(this,"container",void 0),p()(this,"_translations",{en:A.en}),p()(this,"_locale","en"),p()(this,"_uiComponents",void 0),p()(this,"_themesManager",void 0),(0,_.setLogger)(r.logger),this._uiComponents=o()(r.uiComponents||[]),this.player=t,this.targetId=r.targetId,this._createStore(r),this.setConfig(r),this._setLocaleTranslations(r),this._themesManager=new I.ThemesManager(t,r.userTheme,r.targetId),(0,E.setEnv)(this.player.env)}return c()(e,[{key:"setConfig",value:function(e,t){t?this.store.dispatch(S.actions.updateComponentConfig(t,e)):this.store.dispatch(S.actions.updateConfig(e))}},{key:"addComponent",value:function(e){return function(){}}},{key:"buildDefaultUI",value:function(){var e=[{template:function(e){return x.idleUI(e)},condition:function(e){return e.engine.isIdle}},{template:function(e){return x.errorUI(e)},condition:function(e){return e.engine.hasError}},{template:function(e){return x.adsUI(e)},condition:function(e){return e.engine.adBreak}},{template:function(e){return x.liveUI(e)},condition:function(e){return e.engine.isLive}},{template:function(e){return x.imgUI(e)},condition:function(e){return e.engine.isImg}},{template:function(e){return x.docUI(e)},condition:function(e){return e.engine.isDocument}},{template:function(e){return x.playbackUI(e)}}];this._buildUI(e),this._themesManager.applyUserTheme()}},{key:"buildCustomUI",value:function(e){if(e.length>0)this._buildUI(e);else{var t=[{template:function(e){return x.playbackUI(e)}}];this._buildUI(t)}this._themesManager.applyUserTheme()}},{key:"_setLocaleTranslations",value:function(e){var t=this;e.translations&&Object.entries(e.translations).forEach((function(e){var r=a()(e,2),n=r[0],i=r[1];i=(0,v.mergeDeep)({},t._translations.en,i),t._translations[n]=i})),e.locale&&this._translations[e.locale]&&(this._locale=e.locale)}},{key:"_createStore",value:function(e){var t=window.__REDUX_DEVTOOLS_EXTENSION__;this.store=(0,g.createStore)(T.default,(0,g.compose)((0,w.middleware)(this.player,e),t?t({trace:!1}):function(e){return e}))}},{key:"_buildUI",value:function(e){var t=this;if(this.player&&(this.container=document.getElementById(this.targetId),this.container)){var r=(0,h.h)(f.Provider,{store:this.store},(0,h.h)(b.PlayerAreaProvider,{uiComponents:this._uiComponents,setApi:function(e){e&&(t.addComponent=e)}},(0,h.h)(m.IntlProvider,{definition:this._translations[this._locale]},(0,h.h)(C.PlayerProvider,{player:this.player},(0,h.h)(C.EventDispatcherProvider,{player:this.player,store:this.store},(0,h.h)(C.KeyboardEventProvider,{playerContainer:this.container},(0,h.h)(C.Shell,null,(0,h.h)(C.EngineConnector,null),(0,h.h)(C.VideoPlayer,null),(0,h.h)(P.PlayerGUI,{uis:e,playerContainer:this.container}))))))));(0,h.render)(r,this.container)}}},{key:"destroy",value:function(){this.container&&(this.container.prepend(this.player.getView()),(0,h.render)("",this.container))}},{key:"getLogLevel",value:function(e){return(0,_.getLogLevel)(e)}},{key:"setLogLevel",value:function(e,t){(0,_.setLogLevel)(e,t)}},{key:"getCSSVariable",value:function(e){return this._themesManager.getCSSVariable(e)}},{key:"setCSSVariable",value:function(e,t){this._themesManager.setCSSVariable(e,t)}},{key:"config",get:function(){return(0,y.copyDeep)(this.store.getState().config)}},{key:"LogLevel",get:function(){return _.LogLevel}},{key:"Event",get:function(){return k.EventType}}]),e}()},"./src/ui-presets/ads.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{adsUI:function(){return c}});var n=r("./src/styles/style.scss"),a=r.n(n),i=r("./node_modules/preact/dist/preact.module.js"),o=r("./node_modules/react-redux/es/index.js"),s=r("./src/components/index.ts"),l=r("./src/components/ad-left-controls/index.ts"),u=(0,o.connect)((function(e){return{state:{shell:e.shell,engine:{adIsLinear:e.engine.adIsLinear,adContentType:e.engine.adContentType}}}}))((0,s.withKeyboardEvent)("Ads")((function(e,t){if(e.updateIsKeyboardEnabled(!0),function(e,t){var r=e.state.shell.isMobile&&!t.player.env.isIPadOS,n=!1;try{var a=t.player.config.plugins.ima.adsRenderingSettings;n=a&&a.useStyledLinearAds}catch(e){}return r||n}(e,t))return(0,i.h)("div",{className:a().adGuiWrapper},(0,i.h)(s.PlayerArea,{name:"PresetArea"},(0,i.h)("div",{className:a().playerGui,id:"player-gui"},(0,i.h)(s.GuiArea,null,(0,i.h)(i.Fragment,null,(0,i.h)(s.Loading,null),(0,i.h)(s.UnmuteIndication,{hasTopBar:!0})),(0,i.h)(i.Fragment,null,(0,i.h)(s.TopBar,{disabled:!0,leftControls:(0,i.h)(l.AdLeftControls,null)}))))));var r={learnMoreButton:!1,skipButton:!1},n=(0,i.h)(s.BottomBar,{leftControls:[s.PlaybackControls,s.TimeDisplayAdsContainer],rightControls:[s.Volume,s.Fullscreen]}),o=(0,i.h)(s.BottomBar,{rightControls:[s.Fullscreen]});return(0,i.h)("div",{className:a().adGuiWrapper},(0,i.h)(s.PlayerArea,{name:"PresetArea"},(0,i.h)("div",{className:a().playerGui,id:"player-gui"},(0,i.h)(s.GuiArea,null,(0,i.h)(i.Fragment,null,(0,i.h)(s.Loading,null),(0,i.h)(s.UnmuteIndication,{hasTopBar:!0}),r.skipButton?(0,i.h)(s.AdSkip,null):void 0,(0,i.h)(s.PlaybackControls,{name:"OverlayPlaybackControls",className:a().centerPlaybackControls})),(0,i.h)(i.Fragment,null,(0,i.h)(s.TopBar,{disabled:!0,leftControls:(0,i.h)(l.AdLeftControls,null),rightControls:r.learnMoreButton?(0,i.h)(s.AdLearnMore,null):void 0}),function(e){var t=e.state.engine,r=t.adIsLinear,n=t.adContentType;return!(r&&n&&!n.startsWith("video"))}(e)?n:o)))))})));function c(e){return(0,i.h)(u,e)}u.displayName="Ads"},"./src/ui-presets/doc.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{docUI:function(){return E}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./src/components/index.ts");function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var _="Document",k=(0,y.withPlayerPreset)({allowSidePanels:!0,allowPlayerArea:!0})(n=(0,y.withKeyboardEvent)(_)(n=function(e){u()(r,e);var t=v(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"componentDidMount",value:function(){this.props.updateIsKeyboardEnabled(!0)}},{key:"render",value:function(){return(0,g.h)("div",{className:m().playbackGuiWrapper},(0,g.h)(y.PlayerArea,{name:"PresetArea"},(0,g.h)("div",{className:m().playerGui,id:"player-gui"},(0,g.h)(y.VideoArea,null),(0,g.h)(y.GuiArea,null,(0,g.h)(g.Fragment,null,(0,g.h)(y.UnmuteIndication,null),(0,g.h)(y.Loading,null),(0,g.h)(y.OverlayPortal,null),(0,g.h)(y.PlaybackControls,{name:"OverlayPlaybackControls",className:m().centerPlaybackControls}),(0,g.h)(y.CastBeforePlay,null)),(function(){return(0,g.h)(g.Fragment,null,(0,g.h)(y.TopBar,null),(0,g.h)(y.InteractiveArea,null,(0,g.h)(y.Watermark,null)),(0,g.h)(y.BottomBar,{rightControls:[y.VrStereo,y.Cast,y.Fullscreen,y.Logo],leftControls:[]}))})))))}}]),r}(g.Component))||n)||n;function E(e){return(0,g.h)(k,e)}k.displayName=_},"./src/ui-presets/error.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{ErrorUI:function(){return u},errorUI:function(){return c}});var n=r("./src/styles/style.scss"),a=r.n(n),i=r("./node_modules/preact/dist/preact.module.js"),o=r("./src/components/error-overlay/index.ts"),s=r("./src/components/player-area/index.ts"),l=r("./src/components/gui-area/index.ts");function u(){return(0,i.h)("div",{className:a().playbackGuiWrapper},(0,i.h)(s.PlayerArea,{name:"PresetArea"},(0,i.h)(l.GuiArea,null,(0,i.h)(i.Fragment,null,(0,i.h)(o.ErrorOverlay,null)))))}function c(e){return(0,i.h)(u,e)}u.displayName="Error"},"./src/ui-presets/idle.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{idleUI:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/preact/dist/preact.module.js"),m=r("./src/styles/style.scss"),g=r.n(m),y=r("./src/components/index.ts");function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var _=(0,y.withPlayerPreset)({allowSidePanels:!0,allowPlayerArea:!0})(n=function(e){u()(r,e);var t=v(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"render",value:function(){return(0,f.h)("div",{className:g().playbackGuiWrapper},(0,f.h)(y.PlayerArea,{name:"PresetArea"},(0,f.h)(y.GuiArea,null,(0,f.h)(y.Loading,null))))}}]),r}(f.Component))||n;function k(e){return(0,f.h)(_,e)}_.displayName="Idle"},"./src/ui-presets/img.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{imgUI:function(){return k}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./src/components/index.ts");function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var _=(0,y.withPlayerPreset)({allowSidePanels:!0,allowPlayerArea:!0})(n=(0,y.withKeyboardEvent)("Img")(n=function(e){u()(r,e);var t=v(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"componentDidMount",value:function(){this.props.updateIsKeyboardEnabled(!0)}},{key:"render",value:function(){return(0,g.h)("div",{className:m().playbackGuiWrapper},(0,g.h)(y.PlayerArea,{name:"PresetArea"},(0,g.h)("div",{className:m().playerGui,id:"player-gui"},(0,g.h)(y.VideoArea,null),(0,g.h)(y.GuiArea,null,(0,g.h)(g.Fragment,null,(0,g.h)(y.UnmuteIndication,null),(0,g.h)(y.Loading,null),(0,g.h)(y.OverlayPortal,null),(0,g.h)(y.PlaybackControls,{name:"OverlayPlaybackControls",className:m().centerPlaybackControls}),(0,g.h)(y.CastBeforePlay,null)),(function(){return(0,g.h)(g.Fragment,null,(0,g.h)(y.TopBar,null),(0,g.h)(y.InteractiveArea,null,(0,g.h)(y.Watermark,null)),(0,g.h)(y.BottomBar,{rightControls:[y.VrStereo,y.Cast,y.Fullscreen,y.Logo],leftControls:[]}))})))))}}]),r}(g.Component))||n)||n;function k(e){return(0,g.h)(_,e)}_.displayName="Img"},"./src/ui-presets/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{adsUI:function(){return i.adsUI},docUI:function(){return u.docUI},errorUI:function(){return o.errorUI},idleUI:function(){return n.idleUI},imgUI:function(){return l.imgUI},liveUI:function(){return s.liveUI},playbackUI:function(){return a.playbackUI}});var n=r("./src/ui-presets/idle.tsx"),a=r("./src/ui-presets/playback.tsx"),i=r("./src/ui-presets/ads.tsx"),o=r("./src/ui-presets/error.tsx"),s=r("./src/ui-presets/live.tsx"),l=r("./src/ui-presets/img.tsx"),u=r("./src/ui-presets/doc.tsx")},"./src/ui-presets/live.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{liveUI:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./src/components/index.ts"),v=r("./src/components/picture-in-picture-overlay/index.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var k="Live",E=(0,y.withPlayerPreset)({allowSidePanels:!0,allowPlayerArea:!0})(n=(0,y.withKeyboardEvent)(k)(n=function(e){u()(r,e);var t=_(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"componentDidMount",value:function(){this.props.updateIsKeyboardEnabled(!0)}},{key:"render",value:function(){return(0,g.h)("div",{className:m().playbackGuiWrapper},(0,g.h)(y.PlayerArea,{name:"PresetArea"},(0,g.h)("div",{className:m().playerGui,id:"player-gui"},(0,g.h)(y.OverlayAction,null),(0,g.h)(y.VideoArea,null),(0,g.h)(y.GuiArea,null,(0,g.h)(g.Fragment,null,(0,g.h)(y.Loading,null),(0,g.h)(y.OverlayPortal,null),(0,g.h)(v.PictureInPictureOverlay,null),(0,g.h)(y.PlaybackControls,{name:"OverlayPlaybackControls",className:m().centerPlaybackControls}),(0,g.h)(y.PrePlaybackPlayOverlay,null),(0,g.h)(y.CastBeforePlay,null)),(function(e){var t=e.containerRef;return(0,g.h)(g.Fragment,null,(0,g.h)(y.TopBar,null),(0,g.h)(y.InteractiveArea,null,(0,g.h)(y.Watermark,null),(0,g.h)(y.UnmuteIndication,null)),(0,g.h)(y.BottomBar,{leftControls:[y.PlaybackControls,y.Rewind,y.Forward,y.LiveTag],rightControls:[y.VrStereo,y.Volume,y.ClosedCaptions,y.CaptionsControl,y.Settings,y.Cast,y.PictureInPicture,y.Fullscreen,y.Logo]},(0,g.h)(y.SeekBarLivePlaybackContainer,{showFramePreview:!0,showTimeBubble:!0,playerContainer:t})))})))))}}]),r}(g.Component))||n)||n;function b(e){return(0,g.h)(E,e)}E.displayName=k},"./src/ui-presets/playback.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{playbackUI:function(){return A}});var n,a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),s=r.n(o),l=r("./node_modules/@babel/runtime/helpers/inherits.js"),u=r.n(l),c=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(c),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./src/styles/style.scss"),m=r.n(f),g=r("./node_modules/preact/dist/preact.module.js"),y=r("./src/components/index.ts"),v=r("./src/components/playlist-countdown/index.ts"),_=r("./src/components/picture-in-picture-overlay/index.ts"),k=r("./src/components/audio-entry-details/index.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var a=h()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d()(this,r)}}var b="Playback",T=(0,y.withPlayerPreset)({allowSidePanels:!0,allowPlayerArea:!0})(n=(0,y.withKeyboardEvent)(b)(n=function(e){u()(r,e);var t=E(r);function r(){return i()(this,r),t.apply(this,arguments)}return s()(r,[{key:"componentDidMount",value:function(){this.props.updateIsKeyboardEnabled(!0)}},{key:"render",value:function(){return(0,g.h)("div",{className:m().playbackGuiWrapper},(0,g.h)(y.PlayerArea,{name:"PresetArea"},(0,g.h)("div",{className:m().playerGui,id:"player-gui"},(0,g.h)(y.OverlayAction,null),(0,g.h)(y.VideoArea,null),(0,g.h)(y.GuiArea,null,(0,g.h)(g.Fragment,null,(0,g.h)(k.AudioEntryDetails,null),(0,g.h)(y.UnmuteIndication,null),(0,g.h)(y.Loading,null),(0,g.h)(y.OverlayPortal,null),(0,g.h)(_.PictureInPictureOverlay,null),(0,g.h)(y.PlaybackControls,{name:"OverlayPlaybackControls",className:m().centerPlaybackControls}),(0,g.h)(y.PlaylistNextScreen,null),(0,g.h)(y.PrePlaybackPlayOverlay,null),(0,g.h)(y.CastBeforePlay,null)),(function(e){var t=e.containerRef;return(0,g.h)(g.Fragment,null,(0,g.h)(y.TopBar,null),(0,g.h)(y.InteractiveArea,null,(0,g.h)(y.Watermark,null),(0,g.h)(v.PlaylistCountdown,null)),(0,g.h)(y.BottomBar,{leftControls:[y.PlaybackControls,y.Rewind,y.Forward,y.TimeDisplayPlaybackContainer],rightControls:[y.VrStereo,y.Volume,y.AdvancedAudioDesc,y.ClosedCaptions,y.CaptionsControl,y.Settings,y.Cast,y.PictureInPicture,y.Fullscreen,y.Logo]},(0,g.h)(y.SeekBarPlaybackContainer,{showFramePreview:!0,showTimeBubble:!0,playerContainer:t})))})))))}}]),r}(g.Component))||n)||n;function A(e){return(0,g.h)(T,e)}T.displayName=b},"./src/utils/bind-actions.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{bindActions:function(){return a}});var n=r("./node_modules/redux/es/redux.js");function a(e){return function(t){return(0,n.bindActionCreators)(e,t)}}},"./src/utils/color-format-convertors.ts":function(e,t,r){"use strict";function n(e){var t=e.toString().match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var r=t[0];3===t[0].length&&(r=r.split("").map((function(e){return e+e})).join(""));var n=parseInt(r,16);return[n>>16&255,n>>8&255,255&n]}function a(e){var t,r=e[0]/255,n=e[1]/255,a=e[2]/255,i=Math.min(r,n,a),o=Math.max(r,n,a),s=o-i;o===i?t=0:r===o?t=(n-a)/s:n===o?t=2+(a-r)/s:a===o&&(t=4+(r-n)/s),(t=Math.min(60*t,360))<0&&(t+=360);var l=(i+o)/2;return[t,100*(o===i?0:l<=.5?s/(o+i):s/(2-o-i)),100*l]}function i(e){return a(n(e))}function o(e,t,r){t/=100,r/=100;var n=(1-Math.abs(2*r-1))*t,a=n*(1-Math.abs(e/60%2-1)),i=r-n/2,o=0,s=0,l=0;return 0<=e&&e<60?(o=n,s=a,l=0):60<=e&&e<120?(o=a,s=n,l=0):120<=e&&e<180?(o=0,s=n,l=a):180<=e&&e<240?(o=0,s=a,l=n):240<=e&&e<300?(o=a,s=0,l=n):300<=e&&e<360&&(o=n,s=0,l=a),o=Math.round(255*(o+i)).toString(16),s=Math.round(255*(s+i)).toString(16),l=Math.round(255*(l+i)).toString(16),1==o.length&&(o="0"+o),1==s.length&&(s="0"+s),1==l.length&&(l="0"+l),"#"+o+s+l}r.r(t),r.d(t,{hexToHsl:function(){return i},hexToRgb:function(){return n},hslToHex:function(){return o},rgbToHsl:function(){return a}})},"./src/utils/component-config.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{getComponentStateFromComponentConfig:function(){return i},getComponentStateFromConfig:function(){return a}});var n=r("./src/utils/merge-deep.ts");function a(e,t,r){var a=r.config.components&&r.config.components[e];return a?(0,n.mergeDeep)(t,a):t}function i(e,t,r){return r.componentAlias===e?(0,n.mergeDeep)(t,r.config):t}},"./src/utils/copy-deep.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{copyDeep:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/typeof.js"),a=r.n(n);function i(e){var t;return Array.isArray(e)?(t=e.length>0?e.slice(0):[]).forEach((function(e,r){("object"===a()(e)||Array.isArray(e)&&e.length>0)&&(t[r]=i(e))})):"object"===a()(e)?(t=Object.assign({},e),Object.keys(t).forEach((function(e){("object"===a()(t[e])||Array.isArray(t[e])&&t[e].length>0)&&(t[e]=i(t[e]))}))):t=e,t}},"./src/utils/debounce.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{debounce:function(){return n}});var n=function(e,t){var r,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];var s=void 0;n&&!r&&e.apply(s,i),clearTimeout(r),r=setTimeout((function(){r=null,n||e.apply(s,i)}),t)}}},"./src/utils/focus-element.ts":function(e,t,r){"use strict";function n(e){var t=setInterval((function(){e&&"hidden"!==getComputedStyle(e).visibility&&(e.focus(),clearInterval(t))}),arguments.length>1&&void 0!==arguments[1]?arguments[1]:100)}r.r(t),r.d(t,{focusElement:function(){return n}})},"./src/utils/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KeyCode:function(){return i.KeyCode},KeyMap:function(){return i.KeyMap},bindActions:function(){return n.bindActions},focusElement:function(){return a.focusElement},formatOnlyNumbersInput:function(){return l.formatOnlyNumbersInput},getLogger:function(){return o.default},toHHMMSS:function(){return l.toHHMMSS},toSecondsFromHHMMSS:function(){return l.toSecondsFromHHMMSS},withKeyboardA11y:function(){return s.withKeyboardA11y}});var n=r("./src/utils/bind-actions.ts"),a=r("./src/utils/focus-element.ts"),i=r("./src/utils/key-map.ts"),o=r("./src/utils/logger.ts"),s=r("./src/utils/popup-keyboard-accessibility.tsx"),l=r("./src/utils/time-format.ts")},"./src/utils/is-equal.ts":function(e,t,r){"use strict";r.r(t),t.default=function(e,t){var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=0;a<r.length;a++)if(e[r[a]]!==t[r[a]])return!1;return!0}},"./src/utils/key-map.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{KeyCode:function(){return a},KeyMap:function(){return n},getKeyName:function(){return o},isEnter:function(){return l},isEsc:function(){return u},isTab:function(){return s},setEnv:function(){return i}});var n={TAB:9,ENTER:13,ESC:27,SPACE:32,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,P:80,C:67,F:70,M:77,SEMI_COLON:186,COMMA:188,PERIOD:190},a={Backspace:"Backspace",Tab:"Tab",Enter:"Enter",ShiftLeft:"ShiftLeft",ShiftRight:"ShiftRight",ControlLeft:"ControlLeft",ControlRight:"ControlRight",AltLeft:"AltLeft",AltRight:"AltRight",Pause:"Pause",CapsLock:"CapsLock",Escape:"Escape",Space:"Space",PageUp:"PageUp",PageDown:"PageDown",End:"End",Home:"Home",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Insert:"Insert",Delete:"Delete",KeyP:"KeyP",KeyC:"KeyC",KeyF:"KeyF",KeyM:"KeyM",Numpad0:"Numpad0",Semicolon:"Semicolon",Equal:"Equal",Comma:"Comma",Minus:"Minus",Period:"Period",Slash:"Slash"};function i(e){n.SEMI_COLON="firefox"===e.browser.name.toLowerCase()?59:186}function o(e){for(var t in n)if(n[t]===e)return t;return"NOT_FOUND"}function s(e){return c(e,n.TAB)}function l(e){return c(e,n.ENTER)}function u(e){return c(e,n.ESC)}function c(e,t){return e===t}},"./src/utils/logger.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{LogLevel:function(){return a},getLogLevel:function(){return s},setLogLevel:function(){return l},setLogger:function(){return i}});var n={get:function(e){return{VERSION:"",DEBUG:{value:"",name:""},ERROR:{value:"",name:""},INFO:{value:"",name:""},OFF:{value:"",name:""},TIME:{value:"",name:""},TRACE:{value:"",name:""},WARN:{value:"",name:""},createDefaultHandler:function(){},debug:function(){},enabledFor:function(){},error:function(){},get:function(){},getLevel:function(){},info:function(){},log:function(){},setHandler:function(){},setLevel:function(){},time:function(){},timeEnd:function(){},trace:function(){},useDefaults:function(){},warn:function(){}}}},a={};function i(e){e&&"function"==typeof e.getLogger&&(n.get=e.getLogger),e&&e.LogLevel&&(a=e.LogLevel)}function o(e){return n.get(e)}function s(e){return o(e).getLevel()}function l(e,t){o(t).setLevel(e)}t.default=o},"./src/utils/merge-deep.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{isObject:function(){return s},mergeDeep:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/typeof.js"),o=r.n(i);function s(e){return e&&"object"===o()(e)&&!Array.isArray(e)}function l(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(!r.length)return e;var i=r.shift();if(s(e)&&s(i))for(var o in i)s(i[o])?(e[o]||Object.assign(e,a()({},o,{})),l(e[o],i[o])):Object.assign(e,a()({},o,i[o]));return l.apply(void 0,[e].concat(r))}},"./src/utils/popup-keyboard-accessibility.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withKeyboardA11y:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./src/utils/key-map.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var b=function(e){return function(t){p()(n,t);var r=E(n);function n(){var e;o()(this,n);for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];return e=r.call.apply(r,[this].concat(a)),v()(c()(e),"_defaultFocusedElement",void 0),v()(c()(e),"_accessibleChildren",[]),v()(c()(e),"_previouslyActiveElement",void 0),v()(c()(e),"_isModal",!1),v()(c()(e),"onKeyDown",(function(t){switch(t.keyCode){case k.KeyMap.ESC:e.props.onClose&&(e.props.onClose(),t.stopPropagation());break;case k.KeyMap.DOWN:case k.KeyMap.UP:if(document.activeElement&&!e._isModal){var r=e._accessibleChildren.indexOf(document.activeElement);r=(r+(t.keyCode==k.KeyMap.DOWN?1:-1)+e._accessibleChildren.length)%e._accessibleChildren.length,e._accessibleChildren[r].focus(),t.preventDefault(),t.stopPropagation()}break;case k.KeyMap.TAB:e._isModal?t.shiftKey||document.activeElement!==e._accessibleChildren[e._accessibleChildren.length-1]?t.shiftKey&&document.activeElement===e._accessibleChildren[0]&&(e._accessibleChildren[e._accessibleChildren.length-1].focus(),t.preventDefault(),t.stopPropagation()):(e._accessibleChildren[0].focus(),t.preventDefault(),t.stopPropagation()):(e._previouslyActiveElement=null,e.props.onClose&&e.props.onClose())}})),v()(c()(e),"setDefaultFocusedElement",(function(t){t&&(e._defaultFocusedElement=t)})),v()(c()(e),"addAccessibleChild",(function(t,r){t&&-1==e._accessibleChildren.indexOf(t)&&(r?e._accessibleChildren.unshift(t):e._accessibleChildren.push(t))})),v()(c()(e),"clearAccessibleChildren",(function(){e._accessibleChildren=[]})),v()(c()(e),"focusOnDefault",(function(){var t=e._defaultFocusedElement||e._accessibleChildren.length&&e._accessibleChildren[0];t&&(e._previouslyActiveElement=document.activeElement,t.focus())})),v()(c()(e),"setIsModel",(function(t){e.isModal=t})),e}return l()(n,[{key:"componentDidMount",value:function(){this.focusOnDefault()}},{key:"componentWillUnmount",value:function(){this._previouslyActiveElement&&this._previouslyActiveElement.focus()}},{key:"render",value:function(t){return(0,_.h)(e,a()({},t,{setDefaultFocusedElement:this.setDefaultFocusedElement,focusOnDefault:this.focusOnDefault,addAccessibleChild:this.addAccessibleChild,clearAccessibleChildren:this.clearAccessibleChildren,handleKeyDown:this.onKeyDown,setIsModal:this.setIsModel}))}},{key:"isModal",set:function(e){this._isModal=e}}]),n}(_.Component)}},"./src/utils/resize-watcher.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ResizeWatcher:function(){return k}});var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/createClass.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/inherits.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),g=r.n(m),y=r("@playkit-js/playkit-js"),v=r("./src/event/index.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var a=f()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return p()(this,r)}}var k=function(e){c()(r,e);var t=_(r);function r(){var e;a()(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),g()(l()(e),"_observer",void 0),g()(l()(e),"_el",void 0),e}return o()(r,[{key:"destroy",value:function(){this._observer&&this._observer.disconnect(),this._observer=null,this._el=null}},{key:"init",value:function(e){this._observer||(this._el=e,ResizeObserver?this._createNativeObserver():this._createIframeObserver(),this._el instanceof HTMLElement&&this._observer&&this._observer.observe(this._el))}},{key:"_createNativeObserver",value:function(){var e=this;this._observer=new ResizeObserver((function(t){t.forEach((function(){e._triggerResize()}))}))}},{key:"_createIframeObserver",value:function(){this._observer=new E(this._triggerResize.bind(this))}},{key:"_triggerResize",value:function(){this.dispatchEvent(new y.FakeEvent(v.EventType.RESIZE))}}]),r}(y.FakeEventTarget),E=function(){function e(t){a()(this,e),g()(this,"_observersStore",{}),g()(this,"_onChangeCallback",void 0),this._onChangeCallback=t}return o()(e,[{key:"observe",value:function(e){var t=this,r=this._createIframe(),n=e.getAttribute("id");this._observersStore[n]=r,e.appendChild(r),r.contentWindow.onresize=function(){return t._onChangeCallback()}}},{key:"disconnect",value:function(){for(var e in this._observersStore){var t=document.getElementById(e),r=this._observersStore[e];r.onresize=null,t&&(t.removeChild(r),delete this._observersStore[t.getAttribute("id")])}}},{key:"_createIframe",value:function(){var e=document.createElement("iframe");return e.className="playkit-size-iframe",e}}]),e}()},"./src/utils/themes-manager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ThemesManager:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),c=r.n(u),d=r("./src/utils/color-format-convertors.ts"),p=r("./src/styles/style.scss"),h=r.n(p),f="playkit",m="--".concat(f,"-{name}-color"),g="--".concat(f,"-{name}-hsl-hue"),y="--".concat(f,"-{name}-hsl-saturation"),v="--".concat(f,"-{name}-hsl-lightness"),_={colors:{live:"--playkit-live-color",playerBackground:"--playkit-player-background-color",paperSurface:"--playkit-paper-color",elevatedSurface:"--playkit-elevated-color",protectionSurface:"--playkit-protection-color",tone1:"--playkit-tone-1-color",tone2:"--playkit-tone-2-color",tone3:"--playkit-tone-3-color",tone4:"--playkit-tone-4-color",tone5:"--playkit-tone-5-color",tone6:"--playkit-tone-6-color",tone7:"--playkit-tone-7-color",tone8:"--playkit-tone-8-color",tone1RGB:"--playkit-tone-1-color-rgb",tone2RGB:"--playkit-tone-2-color-rgb",tone3RGB:"--playkit-tone-3-color-rgb",tone4RGB:"--playkit-tone-4-color-rgb",tone5RGB:"--playkit-tone-5-color-rgb",tone6RGB:"--playkit-tone-6-color-rgb",tone7RGB:"--playkit-tone-7-color-rgb",tone8RGB:"--playkit-tone-8-color-rgb"}},k=["primary","secondary","success","danger","warning"],E=["--playkit-icon-data-url","--playkit-icon-chromecast-url","--playkit-icon-quality-HD-active-url","--playkit-icon-quality-4K-active-url","--playkit-icon-quality-8K-active-url"],b=function(){function e(t,r,n){o()(this,e),c()(this,"player",void 0),c()(this,"config",void 0),c()(this,"playerContainerElement",void 0),this.player=t,this.config=r,this.playerContainerElement=document.querySelector("#".concat(n))}return l()(e,[{key:"applyUserTheme",value:function(){this.config&&this.setColors(this.config)}},{key:"makeTextContrastColor",value:function(e){var t=(0,d.hexToHsl)(e),r=t[0],n=t[1],a=t[2];return(r<30||r>205)&&(a=a<70?100:0),r>30&&r<205&&(a=a<40?100:0),(0,d.hslToHex)(r,n,a)}},{key:"setColors",value:function(e){for(var t in e.colors.primary&&this.setSvgFillColor(e.colors.primary),e.colors)if(k.includes(t)){var r=e.colors[t];this.setAccentOrAcknowledgementColor("".concat(t,"-").concat("text-contrast"),this.makeTextContrastColor(r)),this.setAccentOrAcknowledgementColor(t,r)}else this.setColor(_.colors[t],e.colors[t])}},{key:"setAccentOrAcknowledgementColor",value:function(e,t){var r=(0,d.hexToHsl)(t),n=a()(r,3),i=n[0],o=n[1],s=n[2];this.setCSSVariable(m.replace("{name}",e),t),this.setCSSVariable(g.replace("{name}",e),"".concat(Math.round(i),"deg")),this.setCSSVariable(y.replace("{name}",e),"".concat(Math.round(o),"%")),this.setCSSVariable(v.replace("{name}",e),"".concat(Math.round(s),"%"))}},{key:"setColor",value:function(e,t){this.setCSSVariable(e,t)}},{key:"setSvgFillColor",value:function(e){for(var t=0,r=E;t<r.length;t++){var n=r[t],a=this.getCSSVariable(n),i=e.replace("#","%23");this.setCSSVariable(n,a.replace(/fill='%23([a-f0-9]{3}){1,2}\b'/,"fill='".concat(i,"'")))}}},{key:"getCSSVariable",value:function(e){return getComputedStyle(this.playerContainerElement.querySelector(".".concat(h().player))).getPropertyValue(e)||""}},{key:"setCSSVariable",value:function(e,t){this.playerContainerElement.querySelector(".".concat(h().player)).style.setProperty(e,t)}}]),e}()},"./src/utils/time-format.ts":function(e,t,r){"use strict";function n(e){var t=parseInt(e,10),r=Math.floor(t/3600),n=Math.floor((t-3600*r)/60),a=t-3600*r-60*n,i=r,o=n,s=a;return r<10&&(i="0"+r),n<10&&(o="0"+n),a<10&&(s="0"+a),"".concat("00"!==i?i+":":"").concat(o,":").concat(s)}function a(e){for(var t=e.split(":"),r=0,n=1,a=t.length-1;a>=0;a--){var i=parseInt(t[a]);if(isNaN(i)||i>59){r=0;break}r+=i*n,n*=60}return r}function i(e){var t=parseInt(e);return t<10?"00:0"+e:t<=59?"00:"+e:n(t)}r.r(t),r.d(t,{formatOnlyNumbersInput:function(){return i},toHHMMSS:function(){return n},toSecondsFromHHMMSS:function(){return a}})},"./src/utils/with-animation.tsx":function(e,t,r){"use strict";r.r(t),r.d(t,{withAnimation:function(){return b}});var n=r("./node_modules/@babel/runtime/helpers/extends.js"),a=r.n(n),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=r.n(i),s=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(s),u=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=r.n(u),d=r("./node_modules/@babel/runtime/helpers/inherits.js"),p=r.n(d),h=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(h),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),g=r.n(m),y=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),v=r.n(y),_=r("./node_modules/preact/dist/preact.module.js"),k=r("./src/event/index.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var a=g()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f()(this,r)}}var b=function(e){return function(t){return(0,k.withEventManager)(function(r){p()(i,r);var n=E(i);function i(){var t;o()(this,i);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return t=n.call.apply(n,[this].concat(a)),v()(c()(t),"ref",(0,_.createRef)()),v()(c()(t),"animate",(function(){t.ref.current&&(t.ref.current.classList.add(e),t.props.eventManager.listenOnce(t.ref.current,"animationend",(function(){t.ref.current.classList.remove(e)})))})),t}return l()(i,[{key:"render",value:function(){return(0,_.h)(t,a()({},this.props,{innerRef:this.ref,animate:this.animate}))}}]),i}(_.Component))}}},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[1].use[1]!./node_modules/sass-loader/dist/cjs.js!./src/styles/style.scss":function(module,e,t){(e=t("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([module.id,"@charset \"UTF-8\";\n.playkit-player {\n  --playkit-primary-hsl-hue: 214deg;\n  --playkit-secondary-hsl-hue: 40deg;\n  --playkit-success-hsl-hue: 135deg;\n  --playkit-danger-hsl-hue: 354deg;\n  --playkit-warning-hsl-hue: 21deg;\n  --playkit-primary-hsl-saturation: 100%;\n  --playkit-secondary-hsl-saturation: 100%;\n  --playkit-success-hsl-saturation: 57%;\n  --playkit-danger-hsl-saturation: 76%;\n  --playkit-warning-hsl-saturation: 81%;\n  --playkit-primary-hsl-lightness: 49%;\n  --playkit-secondary-hsl-lightness: 50%;\n  --playkit-success-hsl-lightness: 30%;\n  --playkit-danger-hsl-lightness: 51%;\n  --playkit-warning-hsl-lightness: 53%;\n  --playkit-primary-color: hsl(var(--playkit-primary-hsl-hue) var(--playkit-primary-hsl-saturation) var(--playkit-primary-hsl-lightness));\n  --playkit-primary-darker-color: hsl(\n    var(--playkit-primary-hsl-hue) var(--playkit-primary-hsl-saturation) calc(var(--playkit-primary-hsl-lightness) - 15%)\n  );\n  --playkit-primary-brighter-color: hsl(\n    var(--playkit-primary-hsl-hue) var(--playkit-primary-hsl-saturation) calc(var(--playkit-primary-hsl-lightness) + 15%)\n  );\n  --playkit-primary-text-contrast-color: #ffffff;\n  --playkit-secondary-color: hsl(var(--playkit-secondary-hsl-hue) var(--playkit-secondary-hsl-saturation) var(--playkit-secondary-hsl-lightness));\n  --playkit-secondary-darker-color: hsl(\n    var(--playkit-secondary-hsl-hue) var(--playkit-secondary-hsl-saturation) calc(var(--playkit-secondary-hsl-lightness) - 15%)\n  );\n  --playkit-secondary-brighter-color: hsl(\n    var(--playkit-secondary-hsl-hue) var(--playkit-secondary-hsl-saturation) calc(var(--playkit-secondary-hsl-lightness) + 15%)\n  );\n  --playkit-secondary-text-contrast-color: #ffffff;\n  --playkit-success-color: hsl(var(--playkit-success-hsl-hue) var(--playkit-success-hsl-saturation) var(--playkit-success-hsl-lightness));\n  --playkit-success-darker-color: hsl(\n    var(--playkit-success-hsl-hue) var(--playkit-success-hsl-saturation) calc(var(--playkit-success-hsl-lightness) - 15%)\n  );\n  --playkit-success-brighter-color: hsl(\n    var(--playkit-success-hsl-hue) var(--playkit-success-hsl-saturation) calc(var(--playkit-success-hsl-lightness) + 15%)\n  );\n  --playkit-success-text-contrast-color: #ffffff;\n  --playkit-danger-color: hsl(var(--playkit-danger-hsl-hue) var(--playkit-danger-hsl-saturation) var(--playkit-danger-hsl-lightness));\n  --playkit-danger-darker-color: hsl(\n    var(--playkit-danger-hsl-hue) var(--playkit-danger-hsl-saturation) calc(var(--playkit-danger-hsl-lightness) - 15%)\n  );\n  --playkit-danger-brighter-color: hsl(\n    var(--playkit-danger-hsl-hue) var(--playkit-danger-hsl-saturation) calc(var(--playkit-danger-hsl-lightness) + 15%)\n  );\n  --playkit-danger-text-contrast-color: #ffffff;\n  --playkit-warning-color: hsl(var(--playkit-warning-hsl-hue) var(--playkit-warning-hsl-saturation) var(--playkit-warning-hsl-lightness));\n  --playkit-warning-darker-color: hsl(\n    var(--playkit-warning-hsl-hue) var(--playkit-warning-hsl-saturation) calc(var(--playkit-warning-hsl-lightness) - 15%)\n  );\n  --playkit-warning-brighter-color: hsl(\n    var(--playkit-warning-hsl-hue) var(--playkit-warning-hsl-saturation) calc(var(--playkit-warning-hsl-lightness) + 15%)\n  );\n  --playkit-warning-text-contrast-color: #ffffff;\n  --playkit-tone-1-color: #ffffff;\n  --playkit-tone-2-color: #cccccc;\n  --playkit-tone-3-color: #999999;\n  --playkit-tone-4-color: #666666;\n  --playkit-tone-5-color: #525252;\n  --playkit-tone-6-color: #383838;\n  --playkit-tone-7-color: #212121;\n  --playkit-tone-8-color: #000000;\n  --playkit-tone-1-color-rgb: 255, 255, 255;\n  --playkit-tone-2-color-rgb: 204, 204, 204;\n  --playkit-tone-3-color-rgb: 153, 153, 153;\n  --playkit-tone-4-color-rgb: 102, 102, 102;\n  --playkit-tone-5-color-rgb: 82, 82, 82;\n  --playkit-tone-6-color-rgb: 56, 56, 56;\n  --playkit-tone-7-color-rgb: 33, 33, 33;\n  --playkit-tone-8-color-rgb: 0, 0, 0;\n  --playkit-live-color: #e12437;\n  --playkit-player-background-color: #000000;\n  --playkit-tab-focus-color: var(--playkit-primary-color);\n  --playkit-tooltip-background-color: var(--playkit-tone-1-color);\n  --playkit-tooltip-color: var(--playkit-tone-7-color);\n  --playkit-ads-color: var(--playkit-secondary-color);\n  --playkit-background-color: #121212;\n  --playkit-elevated-color: #333333;\n  --playkit-paper-color: #242424;\n  --playkit-protection-color: #222222;\n}\n\n.playkit-row {\n  display: block;\n}\n.playkit-row:after {\n  content: \"\";\n  clear: both;\n  display: block;\n}\n\n.playkit-d-inline-block {\n  display: inline-block;\n}\n\n.playkit-mobile-hidden-select {\n  display: block;\n  opacity: 0;\n  position: absolute;\n  top: 0;\n  left: 0px;\n  width: 100%;\n  height: 100%;\n}\n\n.playkit-font-size-base, .playkit-ad-notice {\n  font-size: 15px;\n}\n\n.playkit-player .playkit-form-group {\n  margin: 10px 0;\n  position: relative;\n  max-width: 100%;\n}\n.playkit-player .playkit-form-group.playkit-has-error .playkit-form-control {\n  border-color: var(--playkit-danger-color);\n}\n.playkit-player .playkit-form-group.playkit-has-error .playkit-form-control:focus {\n  border-color: #fff;\n}\n.playkit-player .playkit-form-group.playkit-has-icon .playkit-form-control {\n  padding-left: 34px;\n}\n.playkit-player .playkit-form-group .playkit-icon {\n  position: absolute;\n  top: 2px;\n  left: 2px;\n  width: 32px;\n  height: 32px;\n  fill: rgba(255, 255, 255, 0.4);\n}\n.playkit-player .playkit-form-control {\n  height: 32px;\n  width: 100%;\n  min-width: 72px;\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n  background-color: rgba(0, 0, 0, 0.4);\n  font-size: 15px;\n  line-height: 18px;\n  color: #fff;\n  padding: 8px 10px;\n  text-overflow: ellipsis;\n}\n.playkit-player .playkit-form-control::-webkit-input-placeholder {\n  color: rgba(255, 255, 255, 0.6);\n}\n.playkit-player .playkit-form-control:focus {\n  background-color: #fff;\n  border-color: #fff;\n  color: var(--playkit-tone-7-color);\n}\n.playkit-player .playkit-form-control:focus::-webkit-input-placeholder {\n  color: var(--playkit-tone-2-color);\n}\n.playkit-player .playkit-form-control:focus + .playkit-icon {\n  fill: var(--playkit-tone-3-color);\n}\n.playkit-player textarea.playkit-form-control {\n  min-height: 72px;\n}\n.playkit-player select {\n  font-size: 15px;\n  color: #fff;\n  -webkit-appearance: none;\n  border: 0;\n  background: url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23FFFFFF' viewBox='0 0 1024 1024'><path d='M301.255 338.745c-24.994-24.994-65.516-24.994-90.51 0s-24.994 65.516 0 90.51l256 256c24.994 24.994 65.516 24.994 90.51 0l256-256c24.994-24.994 24.994-65.516 0-90.51s-65.516-24.994-90.51 0l-210.745 210.745-210.745-210.745z' /></svg>\") no-repeat;\n  background-size: 16px;\n  background-position: 100% center;\n  background-repeat: no-repeat;\n  padding-right: 24px;\n}\n\n.playkit-checkbox {\n  font-size: 15px;\n  position: relative;\n}\n.playkit-checkbox input {\n  display: none;\n}\n.playkit-checkbox label:before {\n  height: 16px;\n  width: 16px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n  background-color: rgba(0, 0, 0, 0.4);\n  margin-right: 8px;\n  display: inline-block;\n  content: \"\";\n  vertical-align: middle;\n}\n.playkit-checkbox input:checked + label:before {\n  content: \"✔\";\n  text-align: center;\n  font-size: 14px;\n}\n\n.playkit-form-group-row {\n  font-size: 15px;\n  margin: 24px 0;\n}\n.playkit-form-group-row:after {\n  clear: both;\n  content: \" \";\n  display: block;\n}\n.playkit-form-group-row label {\n  float: left;\n  color: rgba(244, 244, 244, 0.8);\n}\n.playkit-form-group-row .playkit-dropdown {\n  float: right;\n}\n\n.playkit-btn {\n  text-decoration: none;\n  height: 36px;\n  border-radius: 18px;\n  color: #fff;\n  line-height: 36px;\n  font-weight: bold;\n  cursor: pointer;\n  display: inline-block;\n  padding: 0 24px;\n}\n.playkit-btn.playkit-btn-block {\n  display: block;\n}\n.playkit-btn.playkit-btn-dark-transparent {\n  background-color: rgba(0, 0, 0, 0.5);\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  line-height: 32px;\n}\n.playkit-btn.playkit-btn-dark-transparent:hover {\n  color: #fff;\n  border: 2px solid rgba(255, 255, 255, 0.4);\n}\n.playkit-btn.playkit-btn-branded {\n  background-color: var(--playkit-primary-color);\n}\n.playkit-btn.playkit-btn-branded:hover {\n  color: #fff;\n}\n\n.playkit-btn-rounded {\n  height: 36px;\n  width: 36px;\n  min-width: 36px;\n  min-height: 36px;\n  border-radius: 18px;\n  background-color: rgba(0, 0, 0, 0.4);\n  display: inline-block;\n  padding: 2px;\n}\n\n.playkit-player button:focus {\n  outline: none;\n}\n\n.playkit-btn-borderless {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  border-radius: 4px;\n  border: none;\n  padding: 8px 12px 8px 8px;\n  width: 82px;\n  height: 40px;\n  background-color: transparent;\n  cursor: pointer;\n}\n.playkit-btn-borderless.playkit-only-icon {\n  padding: 4px;\n  width: 40px;\n  height: 40px;\n}\n.playkit-btn-borderless.playkit-only-label {\n  padding: 8px;\n  width: 50px;\n  height: 40px;\n}\n.playkit-btn-borderless i {\n  width: 32px;\n  height: 32px;\n}\n.playkit-btn-borderless label {\n  color: var(--playkit-tone-1-color);\n}\n.playkit-btn-borderless:hover {\n  background-color: var(--playkit-tone-5-color);\n}\n\n.playkit-btn-translucent {\n  background-color: rgba(0, 0, 0, 0.6);\n}\n.playkit-btn-translucent:hover {\n  background-color: rgba(0, 0, 0, 0.7);\n}\n\n.playkit-player.playkit-size-sm .playkit-btn-borderless,\n.playkit-player.playkit-size-xs .playkit-btn-borderless {\n  height: 32px;\n}\n.playkit-player.playkit-size-sm .playkit-btn-borderless i,\n.playkit-player.playkit-size-xs .playkit-btn-borderless i {\n  width: 24px;\n  height: 24px;\n}\n.playkit-player.playkit-size-sm .playkit-btn-borderless.playkit-only-icon,\n.playkit-player.playkit-size-xs .playkit-btn-borderless.playkit-only-icon {\n  padding: 4px;\n  width: 32px;\n  height: 32px;\n}\n.playkit-player.playkit-size-sm .playkit-btn-borderless.playkit-only-label,\n.playkit-player.playkit-size-xs .playkit-btn-borderless.playkit-only-label {\n  padding: 8px;\n  width: 50px;\n  height: 32px;\n}\n\n.playkit-icon {\n  display: inline-block;\n  font-size: 0;\n  width: 100%;\n  height: 100%;\n  margin: 0 auto;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: 50% 50%;\n  filter: drop-shadow(0px 0px 2px rgba(0, 0, 0, 0.7));\n}\n\n.playkit-badge-icon:after {\n  content: \"\";\n  position: absolute;\n  height: 16px;\n  width: 16px;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: 50% 50%;\n}\n\n.playkit-player {\n  --playkit-icon-vr-stereo-full-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M864 255.996c53.019 0 96 42.981 96 96v384.004c0 53.019-42.981 96-96 96h-219.764c-33.721 0-64.97-17.693-82.319-46.608l-49.917-83.195-49.917 83.195c-17.349 28.916-48.598 46.608-82.319 46.608h-219.764c-53.019 0-96-42.981-96-96v-384.003c0-53.019 42.981-96 96-96h704zM304 624c44.183 0 80-35.817 80-80s-35.817-80-80-80c-44.183 0-80 35.817-80 80s35.817 80 80 80zM720 624c44.183 0 80-35.817 80-80s-35.817-80-80-80c-44.183 0-80 35.817-80 80s35.817 80 80 80z'%3E%3C/path%3E%3C/svg%3E\");\n  --playkit-icon-chromecast-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M160 704v96h96c0-53.12-42.88-96-96-96zM160 576v64c88.32 0 160 71.68 160 160h64c0-123.84-100.16-224-224-224zM736 352h-448v52.16c126.72 40.96 226.88 141.12 267.84 267.84h180.16v-320zM160 448v64c159.040 0 288 128.96 288 288h64c0-194.56-157.76-352-352-352zM800 224h-576c-35.2 0-64 28.8-64 64v96h64v-96h576v448h-224v64h224c35.2 0 64-28.8 64-64v-448c0-35.2-28.8-64-64-64z'%3E%3C/path%3E%3C/svg%3E\");\n  --playkit-icon-quality-HD-active-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M3.73939861,5 L2,5 L2,11 L3.73939861,11 L3.73918396,8.56940659 L5.96845644,8.56940659 L5.9691596,11 L7.69930609,11 L7.69930609,5 L5.9691596,5 L5.96845644,7.32457143 L3.73918396,7.32457143 L3.73939861,5 Z M10.849653,5 L8.65690054,5 L8.65690054,11 L10.8774094,11 L11.1387878,10.9921562 C11.5670397,10.9660102 11.9583976,10.8744992 12.3128614,10.7176232 L12.3128614,10.7176232 L12.4919044,10.6311813 L12.686671,10.5199596 C13.0639309,10.2858264 13.3675515,9.98155416 13.5975328,9.60714286 C13.827514,9.23273155 13.9589319,8.81088809 13.9917864,8.34161247 L13.9917864,8.34161247 L14,8.10302198 L14,7.9010989 L13.9917864,7.66145717 C13.9589319,7.19033135 13.827514,6.76815149 13.5975328,6.39491758 C13.3292213,5.95947802 12.9583655,5.61813187 12.4849653,5.37087912 C12.0791937,5.15894819 11.6207417,5.03784481 11.1096093,5.00756896 L11.1096093,5.00756896 L10.849653,5 Z M10.849653,6.24862637 C11.154973,6.24862637 11.4101773,6.30906593 11.615266,6.42994505 C11.8203547,6.55082418 11.9745567,6.73282967 12.077872,6.97596154 C12.1605243,7.17046703 12.2101157,7.40497253 12.2266461,7.67947802 L12.2266461,7.67947802 L12.232845,7.89285714 L12.232845,8.10302198 L12.2265536,8.31796703 C12.2097764,8.59445055 12.1594449,8.83049451 12.075559,9.0260989 C11.9707016,9.2706044 11.8180416,9.4532967 11.617579,9.57417582 C11.4572089,9.67087912 11.2672321,9.7289011 11.0476484,9.74824176 L11.0476484,9.74824176 L10.8774094,9.75549451 L10.3957366,9.75600879 L10.3957366,6.24937143 Z'%3E%3C/path%3E%3C/svg%3E\");\n  --playkit-icon-quality-4K-active-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M6.52117789,5 L4.77853973,5 L4.7778117,5.01381978 L2,8.80769231 L2.10649455,9.76785714 L4.7778117,9.76866813 L4.77853973,11 L6.52117789,11 L6.52063574,9.76866813 L7.19402985,9.76785714 L7.19402985,8.5728022 L6.52063574,8.57362637 L6.52117789,5 Z M9.81282775,5 L7.99273901,5 L7.99273901,11 L9.81282775,11 L9.8119758,9.5061978 L10.4712352,8.88589011 L11.8313836,11 L13.9806374,11 L11.6856603,7.6629978 L14,5 L11.7587737,5 L10.3549818,6.78434066 L9.8119758,7.5229011 L9.81282775,5 Z M4.7778117,7.01905934 L4.7778117,8.57362637 L3.65066559,8.5728022 L4.69624849,7.13873626 L4.7778117,7.01905934 Z'%3E%3C/path%3E%3C/svg%3E\");\n  --playkit-icon-quality-8K-active-url: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23006bff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M4.5,5 C4.04427083,5 3.6389974,5.06279225 3.28417969,5.18837675 C2.92936198,5.31396126 2.65104167,5.499666 2.44921875,5.74549098 C2.24739583,5.99131597 2.14648438,6.29458918 2.14648438,6.65531062 C2.14648438,6.96259185 2.24820964,7.23112892 2.45166016,7.46092184 C2.58729384,7.61411712 2.75692636,7.74445187 2.96055773,7.85192607 L2.96055773,7.85192607 L3.07972656,7.90981323 L3.04817708,7.92134269 L2.87890625,8.000668 C2.71614583,8.08483634 2.57291667,8.18353373 2.44921875,8.29676019 L2.44921875,8.29676019 L2.33203125,8.41482966 L2.24394133,8.52320968 C2.08131378,8.74602266 2,9.00515316 2,9.3006012 C2,9.67735471 2.10986328,9.99131597 2.32958984,10.242485 C2.54931641,10.493654 2.84879557,10.6826987 3.22802734,10.8096192 C3.60725911,10.9365397 4.03613281,11 4.51464844,11 C4.99641927,11 5.42366536,10.9365397 5.79638672,10.8096192 C6.16910807,10.6826987 6.46289063,10.493654 6.67773438,10.242485 C6.89257813,9.99131597 7,9.67735471 7,9.3006012 C7,8.95591182 6.89176432,8.66065464 6.67529297,8.41482966 L6.67529297,8.41482966 L6.56041124,8.29676019 C6.3983742,8.14579158 6.20089157,8.02065242 5.96796332,7.92134269 L5.96796332,7.92134269 L5.94,7.911 L6.06141493,7.85192607 L6.20532227,7.76703407 C6.29701063,7.70758183 6.38019929,7.64241446 6.45488824,7.57153195 L6.45488824,7.57153195 L6.56054688,7.46092184 L6.65155707,7.3427967 C6.78945132,7.14054034 6.85839844,6.91137831 6.85839844,6.65531062 C6.85839844,6.29458918 6.75830078,5.99131597 6.55810547,5.74549098 C6.35791016,5.499666 6.08121745,5.31396126 5.72802734,5.18837675 C5.37483724,5.06279225 4.96549479,5 4.5,5 Z M9.8178888,5 L8,5 L8,11 L9.8178888,11 L9.81771088,9.5061978 L10.4751832,8.88673407 L11.8340048,11 L13.9806608,11 L11.6891307,7.6629978 L14,5 L11.7614827,5 L10.3593876,6.78434066 L9.81771088,7.5229011 L9.8178888,5 Z M4.50488281,8.51903808 C4.6546224,8.51903808 4.78401693,8.54375418 4.89306641,8.59318637 C5.00211589,8.64261857 5.0867513,8.71543086 5.14697266,8.81162325 C5.20719401,8.90781563 5.23730469,9.02805611 5.23730469,9.17234469 C5.23730469,9.30861723 5.20800781,9.4261857 5.14941406,9.5250501 C5.09082031,9.6239145 5.0069987,9.7007348 4.89794922,9.75551102 C4.78889974,9.81028724 4.66113281,9.83767535 4.51464844,9.83767535 C4.36490885,9.83767535 4.23388672,9.81028724 4.12158203,9.75551102 C4.00927734,9.7007348 3.92220052,9.6239145 3.86035156,9.5250501 C3.7985026,9.4261857 3.76757812,9.30861723 3.76757812,9.17234469 C3.76757812,9.02805611 3.7985026,8.90781563 3.86035156,8.81162325 C3.92220052,8.71543086 4.00846354,8.64261857 4.11914062,8.59318637 C4.22981771,8.54375418 4.35839844,8.51903808 4.50488281,8.51903808 Z M4.5,6.16232465 C4.63671875,6.16232465 4.74902344,6.18570474 4.83691406,6.23246493 C4.92480469,6.27922512 4.99072266,6.34535738 5.03466797,6.43086172 C5.07861328,6.51636607 5.10058594,6.62057448 5.10058594,6.74348697 C5.10058594,6.86372745 5.08024089,6.96993988 5.03955078,7.06212425 C4.99886068,7.15430862 4.93538411,7.22645291 4.84912109,7.27855711 C4.76285807,7.33066132 4.65136719,7.35671343 4.51464844,7.35671343 C4.37792969,7.35671343 4.2648112,7.33066132 4.17529297,7.27855711 C4.08577474,7.22645291 4.01985677,7.15430862 3.97753906,7.06212425 C3.93522135,6.96993988 3.9140625,6.86372745 3.9140625,6.74348697 C3.9140625,6.62057448 3.93522135,6.51636607 3.97753906,6.43086172 C4.01985677,6.34535738 4.08496094,6.27922512 4.17285156,6.23246493 C4.26074219,6.18570474 4.36979167,6.16232465 4.5,6.16232465 Z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-maximize {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M800 269.255v114.745c0 17.673 14.327 32 32 32s32-14.327 32-32v-192c0-17.673-14.327-32-32-32h-192c-17.673 0-32 14.327-32 32s14.327 32 32 32h114.745l-137.373 137.373c-12.497 12.497-12.497 32.758 0 45.255s32.758 12.497 45.255 0l137.373-137.373z' /%3E %3Cpath fill='%23fff' d='M224 754.745v-114.745c0-17.673-14.327-32-32-32s-32 14.327-32 32v192c0 17.673 14.327 32 32 32h192c17.673 0 32-14.327 32-32s-14.327-32-32-32h-114.745l137.373-137.373c12.497-12.497 12.497-32.758 0-45.255s-32.758-12.497-45.255 0l-137.373 137.373z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-minimize {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M672 306.745v-114.745c0-17.673-14.327-32-32-32s-32 14.327-32 32v192c0 17.673 14.327 32 32 32h192c17.673 0 32-14.327 32-32s-14.327-32-32-32h-114.745l137.373-137.373c12.497-12.497 12.497-32.758 0-45.255s-32.758-12.497-45.255 0l-137.373 137.373z' /%3E%3Cpath fill='%23fff' d='M352 717.255v114.745c0 17.673 14.327 32 32 32s32-14.327 32-32v-192c0-17.673-14.327-32-32-32h-192c-17.673 0-32 14.327-32 32s14.327 32 32 32h114.745l-137.373 137.373c-12.497 12.497-12.497 32.758 0 45.255s32.758 12.497 45.255 0l137.373-137.373z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-play {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M796.806 461.202c44.919 28.075 44.739 73.706 0 101.668l-459.472 287.171c-44.919 28.075-81.334 7.915-81.334-45.305v-585.4c0-53.096 36.595-73.266 81.334-45.305l459.472 287.171z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-pause {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M256 287.843c0-35.259 28.407-63.843 64-63.843 35.346 0 64 28.564 64 63.843v448.314c0 35.259-28.407 63.843-64 63.843-35.346 0-64-28.564-64-63.843v-448.314zM640 287.843c0-35.259 28.407-63.843 64-63.843 35.346 0 64 28.564 64 63.843v448.314c0 35.259-28.407 63.843-64 63.843-35.346 0-64-28.564-64-63.843v-448.314z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-volume-base {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M128 416v192h96v-192h-96zM64 383.853c0-17.592 14.012-31.853 32.094-31.853h159.813c17.725 0 32.094 14.581 32.094 31.853v256.295c0 17.592-14.012 31.853-32.094 31.853h-159.813c-17.725 0-32.094-14.581-32.094-31.853v-256.295z' /%3E%3Cpath fill='%23fff' d='M288 634.342l160 88.889v-422.462l-160 88.889v244.684zM224 352l231.787-128.771c31.046-17.248 56.213-2.487 56.213 32.476v512.589c0 35.184-25.054 49.786-56.213 32.476l-231.787-128.771v-320z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-volume-waves {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M802.017 837.177c82.359-86.627 129.183-201.774 129.183-324.26 0-123.976-47.976-240.409-132.127-327.329-12.293-12.697-32.552-13.025-45.249-0.732s-13.025 32.552-0.732 45.249c72.692 75.084 114.109 175.597 114.109 282.812 0 105.928-40.422 205.331-111.566 280.162-12.177 12.808-11.666 33.063 1.143 45.24s33.063 11.666 45.24-1.143z' /%3E%3Cpath fill='%23fff' d='M667.436 743.221c67.761-60.884 107.273-147.888 107.273-241.233 0-87.318-34.552-169.203-94.836-229.446-12.501-12.493-32.762-12.486-45.255 0.015s-12.486 32.762 0.015 45.255c48.375 48.342 76.075 113.989 76.075 184.176 0 75.021-31.679 144.776-86.048 193.627-13.146 11.812-14.227 32.044-2.416 45.19s32.044 14.227 45.19 2.416z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-volume-wave {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M667.436 743.221c67.761-60.884 107.273-147.888 107.273-241.233 0-87.318-34.552-169.203-94.836-229.446-12.501-12.493-32.762-12.486-45.255 0.015s-12.486 32.762 0.015 45.255c48.375 48.342 76.075 113.989 76.075 184.176 0 75.021-31.679 144.776-86.048 193.627-13.146 11.812-14.227 32.044-2.416 45.19s32.044 14.227 45.19 2.416z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-volume-mute {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M768 466.745l-67.986-67.986c-12.213-12.213-32.654-12.393-45.151 0.104-12.584 12.584-12.543 32.711-0.104 45.151l67.986 67.986-67.986 67.986c-12.213 12.213-12.393 32.654 0.104 45.151 12.584 12.584 32.711 12.543 45.151 0.104l67.986-67.986 67.986 67.986c12.213 12.213 32.654 12.393 45.151-0.104 12.584-12.584 12.543-32.711 0.104-45.151l-67.986-67.986 67.986-67.986c12.213-12.213 12.393-32.654-0.104-45.151-12.584-12.584-32.711-12.543-45.151-0.104l-67.986 67.986z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-close {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M573.162 512l214.269-214.269c16.772-16.772 16.688-44.071-0.202-60.96-17.007-17.007-44.182-16.98-60.96-0.202l-214.269 214.269-214.269-214.269c-16.772-16.772-44.071-16.688-60.96 0.202-17.007 17.007-16.98 44.182-0.202 60.96l214.269 214.269-214.269 214.269c-16.772 16.772-16.688 44.071 0.202 60.96 17.007 17.007 44.182 16.98 60.96 0.202l214.269-214.269 214.269 214.269c16.772 16.772 44.071 16.688 60.96-0.202 17.007-17.007 16.98-44.182 0.202-60.96l-214.269-214.269z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-settings {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M803.451 546.033c2.552-22.107 2.552-44.408 0.246-64.81-1.084-6.208-6.499-10.721-12.535-10.671-30.286 0.533-57.727-17.773-68.866-45.941s-3.64-60.291 18.795-80.593c3.935-3.569 4.416-9.583 0.92-13.959-13.595-17.35-29.146-33.073-46.311-46.83-4.23-3.38-10.359-2.886-14.783 1.966-14.421 14.721-34.212 22.938-54.434 22.761-9.009 0.041-17.942-1.652-26.865-5.212-28.414-11.992-46.226-40.546-44.49-71.542 0.335-5.319-3.547-9.972-8.785-10.588-21.926-2.538-44.068-2.595-65.961-0.176-5.349 0.6-9.341 5.207-9.175 10.514 1.027 30.384-16.802 58.251-45.764 70.431-8.238 3.138-16.993 4.701-25.207 4.609-20.599 0.206-40.395-7.982-55.482-23.363-2.014-2.187-4.849-3.435-7.553-3.445-2.441 0.015-4.811 0.83-6.513 2.139-17.541 13.798-33.455 29.547-47.262 46.729-3.418 4.337-2.922 10.575 0.97 14.162 22.816 20.692 30.19 53.479 17.807 83.351-13.035 27.396-41.135 44.394-71.446 43.222-5.112-0.197-9.499 3.606-10.086 9.179-2.673 22.023-2.673 44.289-0.212 64.867 1.080 6.27 6.559 10.824 13.309 10.737l2.225 0.006c28.935 0.604 54.726 18.391 65.634 45.374 11.22 28.205 3.921 60.407-18.565 81.204-3.866 3.509-4.341 9.418-0.895 13.742 13.545 17.354 29.027 33.106 46.042 46.867 4.303 3.449 10.547 2.954 14.986-1.907 14.414-14.76 34.226-23.001 54.43-22.82 9.070-0.052 18.063 1.668 27.041 5.299 28.19 12.071 45.891 40.41 44.347 71.468-0.342 5.312 3.536 9.962 8.802 10.578 21.915 2.548 44.049 2.605 65.929 0.176 5.364-0.604 9.364-5.227 9.191-10.598-0.997-30.358 16.84-58.183 45.452-70.201 8.263-3.256 17.070-4.908 25.521-4.865 20.676-0.206 40.533 8.070 55.398 23.38 2.039 2.195 4.898 3.446 7.673 3.455 2.268-0.011 4.468-0.776 6.321-2.228 17.625-13.724 33.599-29.444 47.415-46.611 3.426-4.348 2.928-10.6-0.863-14.097-22.358-20.082-30.057-51.85-19.372-79.939s37.55-46.71 67.745-46.857h5.229c5.12-0.026 9.413-3.875 9.996-8.962zM861.733 552.735c-3.961 34.572-33.157 60.748-68.129 60.926h-5.235c-5.803 0.028-10.991 3.624-13.054 9.048s-0.577 11.558 4.020 15.69c26.602 24.519 29.853 65.381 7.275 94.034-16.847 20.934-36.063 39.845-57.197 56.302-12.034 9.427-26.861 14.584-42.368 14.658-19.254-0.051-37.623-8.090-50.269-21.718-3.221-3.315-7.66-5.165-12.712-5.118-1.425-0.007-2.839 0.258-3.554 0.532-5.581 2.346-9.136 7.892-8.937 13.966 1.152 35.958-25.509 66.771-61.307 70.804-26.332 2.923-52.909 2.854-79.246-0.208-36.286-4.245-62.897-36.157-60.576-72.186 0.304-6.123-3.235-11.788-8.302-13.964-1.328-0.536-2.748-0.808-4.606-0.8-4.651-0.041-9.118 1.817-11.635 4.367-24.544 27.036-65.886 30.311-94.481 7.394-20.587-16.65-39.207-35.595-55.308-56.226-22.552-28.277-19.261-69.208 7.317-93.334 4.474-4.138 5.939-10.604 3.748-16.115-2.052-5.076-6.932-8.442-11.794-8.55-36.436 0.464-66.759-24.741-72.949-60.89-3.243-26.718-3.243-53.731-0.055-79.964 3.744-35.827 34.642-62.605 70.642-61.219 6.877 0.266 13.251-3.59 15.584-8.401 2.309-5.59 0.861-12.028-3.789-16.247-26.603-24.51-29.856-65.368-7.293-93.994 16.767-20.868 35.856-39.76 57.129-56.491 12.099-9.322 26.921-14.42 42.463-14.513 19.308 0.059 37.717 8.166 50.145 21.684 3.263 3.322 7.737 5.172 12.994 5.126 1.471 0.015 2.933-0.245 3.363-0.39 5.601-2.359 9.165-7.93 8.957-14.077-1.126-35.941 25.542-66.721 61.322-70.731 26.322-2.909 52.889-2.84 79.251 0.212 36.244 4.265 62.828 36.125 60.546 72.343-0.339 6.047 3.159 11.654 8.186 13.782 1.381 0.55 2.855 0.829 4.726 0.823 4.663 0.040 9.142-1.819 11.615-4.312 24.439-26.99 65.656-30.312 94.137-7.557 20.721 16.607 39.456 35.549 55.655 56.225 22.667 28.35 19.38 69.439-7.531 93.846-4.33 3.918-5.776 10.112-3.628 15.542s7.438 8.96 13.543 8.854c34.999-0.298 65.076 24.766 71.337 60.925 3.065 26.552 3.065 53.368 0 79.92zM511.956 589.951c43.215-0.108 78.137-35.17 78.072-78.385 0-31.732-19.132-60.334-48.461-72.448s-63.068-5.35-85.461 17.133c-22.393 22.483-29.022 56.249-16.791 85.529s40.909 48.298 72.641 48.171zM512.146 648.617c-55.438 0.221-105.58-33.029-126.965-84.224s-9.796-110.233 29.358-149.543c39.153-39.31 98.144-51.136 149.424-29.956s84.731 71.189 84.732 126.627c0.114 75.549-60.999 136.907-136.548 137.096z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-check {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M342.481 563.894c-12.577-12.416-32.838-12.285-45.254 0.292s-12.285 32.838 0.292 45.254l118.857 117.333c13.275 13.105 34.901 12.123 46.933-2.131l297.143-352c11.4-13.505 9.694-33.694-3.811-45.094s-33.694-9.694-45.094 3.811l-274.828 325.566-94.238-93.030z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-check-active {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M342.481 563.894c-12.577-12.416-32.838-12.285-45.254 0.292s-12.285 32.838 0.292 45.254l118.857 117.333c13.275 13.105 34.901 12.123 46.933-2.131l297.143-352c11.4-13.505 9.694-33.694-3.811-45.094s-33.694-9.694-45.094 3.811l-274.828 325.566-94.238-93.030z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-language {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M512 800c159.058 0 288-128.942 288-288s-128.942-288-288-288c-159.058 0-288 128.942-288 288s128.942 288 288 288zM512 864c-194.404 0-352-157.596-352-352s157.596-352 352-352c194.404 0 352 157.596 352 352s-157.596 352-352 352z' /%3E%3Cpath fill='%23fff' d='M441.231 173.324c-76.632 84.62-121.231 207.208-121.231 338.676 0 134.304 46.556 259.282 126.083 343.936l46.646-43.82c-68.041-72.429-108.728-181.651-108.728-300.116 0-116.001 39.001-223.203 104.669-295.716l-47.438-42.96z' /%3E%3Cpath fill='%23fff' d='M584.297 173.324c76.632 84.62 121.231 207.208 121.231 338.676 0 134.304-46.556 259.282-126.083 343.936l-46.646-43.82c68.041-72.429 108.728-181.651 108.728-300.116 0-116.001-39.001-223.203-104.669-295.716l47.438-42.96z' /%3E%3Cpath fill='%23fff' d='M840.432 419.786c-81.65-22.637-200.551-35.786-328.432-35.786-128.056 0-247.103 13.185-328.758 35.876l17.136 61.663c75.47-20.972 188.938-33.539 311.622-33.539 122.521 0 235.854 12.533 311.334 33.459l17.099-61.674z' /%3E%3Cpath fill='%23fff' d='M840.432 605.754c-81.65 22.637-200.551 35.786-328.432 35.786-128.056 0-247.103-13.185-328.758-35.876l17.136-61.663c75.47 20.972 188.938 33.539 311.622 33.539 122.521 0 235.854-12.533 311.334-33.459l17.099 61.674z' /%3E%3Cpath fill='%23fff' d='M480 192h64v640h-64v-640z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-quality {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M159.904 192h288.234c17.277 0 31.862 14.323 31.862 31.992 0 17.792-14.261 31.993-31.853 31.994l-288.147 0.014v544.174c-0.017-0.18 704-0.174 704-0.174v-128.006c0-17.795 14.327-31.994 32-31.994 17.796 0 32 14.34 32 32.029v128.145c0 35.25-28.639 63.826-63.904 63.826h-704.192c-35.293 0-63.904-28.875-63.904-63.826v-544.348c0-35.25 28.639-63.826 63.904-63.826zM501.818 378.182c108.449 0 196.364-87.915 196.364-196.364 0-29.091 43.636-29.091 43.636 0 0 108.449 87.915 196.364 196.364 196.364 29.091 0 29.091 43.636 0 43.636-108.449 0-196.364 87.915-196.364 196.364 0 29.091-43.636 29.091-43.636 0 0-108.449-87.915-196.364-196.364-196.364-29.091 0-29.091-43.636 0-43.636z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-captions {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M160 771.213c-0.017-0.172 704-0.166 704-0.166v-518.261c0.017 0.172-704 0.166-704 0.166v518.261zM96 252.787c0-33.572 28.639-60.787 63.904-60.787h704.192c35.293 0 63.904 27.5 63.904 60.787v518.427c0 33.572-28.639 60.787-63.904 60.787h-704.192c-35.293 0-63.904-27.5-63.904-60.787v-518.427z' /%3E%3Cpath fill='%23fff' d='M490.583 568.655c0 7.729-2.311 15.987-6.933 24.777s-11.668 17.162-21.14 25.118c-9.471 7.956-21.405 14.358-35.801 19.208s-30.611 7.274-48.644 7.274c-38.34 0-68.268-11.176-89.787-33.528s-32.278-52.319-32.278-89.901c0-25.459 4.925-47.962 14.775-67.511s24.095-34.665 42.734-45.348c18.639-10.684 40.916-16.025 66.829-16.025 16.063 0 30.8 2.349 44.212 7.047s24.777 10.759 34.096 18.185c9.32 7.425 16.442 15.343 21.367 23.754s7.388 16.253 7.388 23.527c0 7.425-2.766 13.714-8.297 18.867s-12.237 7.729-20.117 7.729c-5.152 0-9.433-1.326-12.843-3.978s-7.236-6.933-11.479-12.843c-7.577-11.517-15.495-20.155-23.754-25.913s-18.753-8.638-31.482-8.638c-18.336 0-33.111 7.16-44.325 21.481s-16.821 33.907-16.821 58.759c0 11.669 1.44 22.39 4.319 32.164s7.047 18.109 12.502 25.004c5.455 6.895 12.047 12.123 19.776 15.684s16.215 5.342 25.459 5.342c12.426 0 23.072-2.879 31.937-8.638s16.707-14.548 23.527-26.368c3.789-6.971 7.88-12.426 12.275-16.366s9.774-5.91 16.139-5.91c7.577 0 13.866 2.879 18.867 8.638s7.501 11.896 7.501 18.412zM767.219 568.655c0 7.729-2.311 15.987-6.933 24.777s-11.668 17.162-21.14 25.118c-9.471 7.956-21.405 14.358-35.801 19.208s-30.611 7.274-48.644 7.274c-38.34 0-68.268-11.176-89.787-33.528s-32.278-52.319-32.278-89.901c0-25.459 4.925-47.962 14.775-67.511s24.095-34.665 42.734-45.348c18.639-10.684 40.916-16.025 66.829-16.025 16.063 0 30.8 2.349 44.212 7.047s24.777 10.759 34.096 18.185c9.32 7.425 16.442 15.343 21.367 23.754s7.388 16.253 7.388 23.527c0 7.425-2.766 13.714-8.297 18.867s-12.237 7.729-20.117 7.729c-5.152 0-9.433-1.326-12.843-3.978s-7.236-6.933-11.479-12.843c-7.577-11.517-15.495-20.155-23.754-25.913s-18.753-8.638-31.482-8.638c-18.336 0-33.111 7.16-44.325 21.481s-16.821 33.907-16.821 58.759c0 11.669 1.44 22.39 4.319 32.164s7.047 18.109 12.502 25.004c5.455 6.895 12.047 12.123 19.776 15.684s16.215 5.342 25.459 5.342c12.426 0 23.072-2.879 31.937-8.638s16.707-14.548 23.527-26.368c3.789-6.971 7.88-12.426 12.275-16.366s9.774-5.91 16.139-5.91c7.577 0 13.866 2.879 18.867 8.638s7.501 11.896 7.501 18.412z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-speed {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M512 832c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64zM480.239 643.971c-0.158-1.272-0.239-2.566-0.239-3.876v-192.19c0-17.621 14.204-31.905 32-31.905 17.673 0 32 14.497 32 31.905v192.19c0 1.313-0.079 2.607-0.232 3.878 55.325 14.128 96.232 64.301 96.232 124.027 0 70.692-57.308 128-128 128s-128-57.308-128-128c0-59.729 40.91-109.903 96.239-124.029zM928 576c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-194.404-157.596-352-352-352s-352 157.596-352 352c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-229.75 186.25-416 416-416s416 186.25 416 416z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-speed-down {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M512 800c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64zM401.852 670.758c-1.056-0.826-2.077-1.728-3.055-2.706l-113.005-113.005c-12.533-12.533-12.65-32.737-0.066-45.321 12.497-12.497 32.536-12.719 45.321 0.066l113.005 113.005c0.976 0.976 1.876 1.998 2.701 3.059 19.106-11.343 41.416-17.855 65.248-17.855 70.692 0 128 57.308 128 128s-57.308 128-128 128c-70.692 0-128-57.308-128-128 0-23.829 6.511-46.137 17.852-65.242zM928 576c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-194.404-157.596-352-352-352s-352 157.596-352 352c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-229.75 186.25-416 416-416s416 186.25 416 416z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-speed-up {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M512 800c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64zM546.516 612.708c0.524-1.23 1.129-2.446 1.819-3.64l79.906-138.402c8.862-15.35 28.348-20.692 43.76-11.794 15.305 8.837 20.707 28.135 11.666 43.794l-79.906 138.402c-0.693 1.201-1.451 2.34-2.268 3.416 23.761 23.238 38.508 55.655 38.508 91.516 0 70.692-57.308 128-128 128s-128-57.308-128-128c0-70.692 57.308-128 128-128 11.959 0 23.535 1.64 34.516 4.708zM928 576c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-194.404-157.596-352-352-352s-352 157.596-352 352c0 17.673-14.327 32-32 32s-32-14.327-32-32c0-229.75 186.25-416 416-416s416 186.25 416 416z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-audio {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M768 625.124v-354.531l-352 135.385v330.022c0 70.692-57.308 128-128 128s-128-57.308-128-128c0-70.692 57.308-128 128-128 23.314 0 45.173 6.233 64 17.124v-241.124c0-13.241 8.155-25.114 20.513-29.867l416-160c20.96-8.062 43.487 7.41 43.487 29.867v512c0 70.692-57.308 128-128 128s-128-57.308-128-128c0-70.692 57.308-128 128-128 23.314 0 45.173 6.233 64 17.124zM288 800c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64zM704 800c35.346 0 64-28.654 64-64s-28.654-64-64-64c-35.346 0-64 28.654-64 64s28.654 64 64 64z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-arrow-down {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M301.255 338.745c-24.994-24.994-65.516-24.994-90.51 0s-24.994 65.516 0 90.51l256 256c24.994 24.994 65.516 24.994 90.51 0l256-256c24.994-24.994 24.994-65.516 0-90.51s-65.516-24.994-90.51 0l-210.745 210.745-210.745-210.745z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-start-over {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M255.271 339.053c94.182-126.513 270.298-165.203 410.222-84.418 150.758 87.040 202.411 279.813 115.371 430.571s-279.813 202.411-430.571 115.371c-61.424-35.463-107.948-89.4-134.169-153.673-7.677-18.818-29.156-27.85-47.974-20.173s-27.85 29.156-20.173 47.974c32.339 79.269 89.818 145.906 165.517 189.611 185.96 107.364 423.747 43.649 531.111-142.311s43.649-423.747-142.311-531.111c-172.433-99.554-389.428-52.014-505.682 103.69l-27.226-78.49c-6.66-19.202-27.626-29.368-46.828-22.708s-29.368 27.626-22.708 46.828l52.434 151.164c5.36 15.452 20.275 25.513 36.61 24.694l159.799-8.011c20.299-1.018 35.929-18.298 34.911-38.596s-18.298-35.929-38.596-34.911l-89.738 4.499z' /%3E%3C/svg%3E\");\n}\n\n.playkit-icon-seek-end {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M742.494 323.053c-94.182-126.513-270.298-165.203-410.222-84.418-150.758 87.040-202.411 279.813-115.371 430.571s279.813 202.411 430.571 115.371c61.424-35.463 107.948-89.4 134.169-153.673 7.677-18.818 29.156-27.85 47.974-20.173s27.85 29.156 20.173 47.974c-32.339 79.269-89.818 145.906-165.517 189.611-185.96 107.364-423.747 43.649-531.111-142.311s-43.649-423.747 142.311-531.111c172.433-99.554 389.428-52.014 505.682 103.69l27.226-78.49c6.66-19.202 27.626-29.368 46.828-22.708s29.368 27.626 22.708 46.828l-52.434 151.164c-5.36 15.452-20.275 25.513-36.61 24.694l-159.799-8.011c-20.299-1.018-35.929-18.298-34.911-38.596s18.298-35.929 38.596-34.911l89.738 4.499z'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-rewind {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' opacity='0.5' d='M258.471 323.053c94.182-126.513 270.298-165.203 410.222-84.418 150.758 87.040 202.411 279.813 115.371 430.571s-279.813 202.411-430.571 115.371c-61.424-35.463-107.948-89.4-134.169-153.673-7.677-18.818-29.156-27.85-47.974-20.173s-27.85 29.156-20.173 47.974c32.339 79.269 89.818 145.906 165.517 189.611 185.96 107.364 423.747 43.649 531.111-142.311s43.649-423.747-142.311-531.111c-172.433-99.554-389.428-52.014-505.682 103.69l-27.226-78.49c-6.66-19.202-27.626-29.368-46.828-22.708s-29.368 27.626-22.708 46.828l52.434 151.164c5.36 15.452 20.275 25.513 36.61 24.694l159.799-8.011c20.299-1.018 35.929-18.298 34.911-38.596s-18.298-35.929-38.596-34.911l-89.738 4.499z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M816.068 431.974c-20.553-78.699-71.369-149.456-147.375-193.338-139.923-80.785-316.040-42.095-410.222 84.418l89.738-4.499c20.299-1.018 37.579 14.613 38.596 34.911s-14.613 37.579-34.911 38.596l-159.799 8.011c-16.335 0.819-31.25-9.242-36.61-24.694l-52.434-151.164c-6.66-19.202 3.506-40.167 22.708-46.828s40.167 3.506 46.828 22.708l27.226 78.49c116.254-155.703 333.248-203.244 505.682-103.69 91.184 52.645 152.976 136.648 179.618 230.523l-69.044 26.555z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-rewind-10 {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M258.471 323.053c94.182-126.513 270.298-165.203 410.222-84.418 150.758 87.040 202.411 279.813 115.371 430.571s-279.813 202.411-430.571 115.371c-61.424-35.463-107.948-89.4-134.169-153.673-7.677-18.818-29.156-27.85-47.974-20.173s-27.85 29.156-20.173 47.974c32.339 79.269 89.818 145.906 165.517 189.611 185.96 107.364 423.747 43.649 531.111-142.311s43.649-423.747-142.311-531.111c-172.433-99.554-389.428-52.014-505.682 103.69l-27.226-78.49c-6.66-19.202-27.626-29.368-46.828-22.708s-29.368 27.626-22.708 46.828l52.434 151.164c5.36 15.452 20.275 25.513 36.61 24.694l159.799-8.011c20.299-1.018 35.929-18.298 34.911-38.596s-18.298-35.929-38.596-34.911l-89.738 4.499z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M413.327 636.083h67.358v-252.083h-48.527c-2.173 7.358-4.949 13.589-8.329 18.693s-7.726 9.139-13.037 12.106c-5.311 2.967-11.709 5.103-19.193 6.409s-16.417 1.958-26.798 1.958v41.302h48.527v171.616zM596.807 554.192c0 17.803 1.569 29.849 4.708 36.139s8.208 9.435 15.21 9.435c7.001 0 12.071-3.145 15.21-9.435s4.708-18.336 4.708-36.139v-83.316c0-17.803-1.569-29.849-4.708-36.139s-8.208-9.435-15.21-9.435c-7.001 0-12.071 3.145-15.21 9.435s-4.708 18.336-4.708 36.139v83.316zM529.449 512.534c0-25.398 1.75-46.405 5.251-63.021s8.812-29.789 15.934-39.522c7.122-9.732 16.176-16.497 27.16-20.295s23.962-5.697 38.93-5.697c14.969 0 27.945 1.899 38.93 5.697s20.038 10.563 27.16 20.295c7.122 9.732 12.433 22.906 15.934 39.522s5.251 37.622 5.251 63.021c0 25.636-1.75 46.702-5.251 63.199s-8.812 29.552-15.934 39.166c-7.122 9.613-16.176 16.2-27.16 19.761s-23.962 5.341-38.93 5.341c-14.969 0-27.945-1.78-38.93-5.341s-20.038-10.147-27.16-19.761c-7.122-9.613-12.433-22.668-15.934-39.166s-5.251-37.563-5.251-63.199z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-forward {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' opacity='0.5' d='M765.529 323.053c-94.182-126.513-270.298-165.203-410.222-84.418-150.758 87.040-202.411 279.813-115.371 430.571s279.813 202.411 430.571 115.371c61.424-35.463 107.948-89.4 134.169-153.673 7.677-18.818 29.156-27.85 47.974-20.173s27.85 29.156 20.173 47.974c-32.339 79.269-89.818 145.906-165.517 189.611-185.96 107.364-423.747 43.649-531.111-142.311s-43.649-423.747 142.311-531.111c172.433-99.554 389.428-52.014 505.682 103.69l27.226-78.49c6.66-19.202 27.626-29.368 46.828-22.708s29.368 27.626 22.708 46.828l-52.434 151.164c-5.36 15.452-20.275 25.513-36.61 24.694l-159.799-8.011c-20.299-1.018-35.929-18.298-34.911-38.596s18.298-35.929 38.596-34.911l89.738 4.499z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M207.932 431.974c20.553-78.699 71.369-149.456 147.375-193.338 139.923-80.785 316.040-42.095 410.222 84.418l-89.738-4.499c-20.299-1.018-37.579 14.613-38.596 34.911s14.613 37.579 34.911 38.596l159.799 8.011c16.335 0.819 31.25-9.242 36.61-24.694l52.434-151.164c6.66-19.202-3.506-40.167-22.708-46.828s-40.167 3.506-46.828 22.708l-27.226 78.49c-116.254-155.703-333.248-203.244-505.682-103.69-91.184 52.645-152.976 136.648-179.618 230.523l69.044 26.555z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-forward-10 {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M765.529 323.053c-94.182-126.513-270.298-165.203-410.222-84.418-150.758 87.040-202.411 279.813-115.371 430.571s279.813 202.411 430.571 115.371c61.424-35.463 107.948-89.4 134.169-153.673 7.677-18.818 29.156-27.85 47.974-20.173s27.85 29.156 20.173 47.974c-32.339 79.269-89.818 145.906-165.517 189.611-185.96 107.364-423.747 43.649-531.111-142.311s-43.649-423.747 142.311-531.111c172.433-99.554 389.428-52.014 505.682 103.69l27.226-78.49c6.66-19.202 27.626-29.368 46.828-22.708s29.368 27.626 22.708 46.828l-52.434 151.164c-5.36 15.452-20.275 25.513-36.61 24.694l-159.799-8.011c-20.299-1.018-35.929-18.298-34.911-38.596s18.298-35.929 38.596-34.911l89.738 4.499z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M365.327 636.083h67.358v-252.083h-48.527c-2.173 7.358-4.949 13.589-8.329 18.693s-7.726 9.139-13.037 12.106c-5.311 2.967-11.709 5.103-19.193 6.409s-16.417 1.958-26.798 1.958v41.302h48.527v171.616zM548.807 554.192c0 17.803 1.569 29.849 4.708 36.139s8.208 9.435 15.21 9.435c7.001 0 12.071-3.145 15.21-9.435s4.708-18.336 4.708-36.139v-83.316c0-17.803-1.569-29.849-4.708-36.139s-8.208-9.435-15.21-9.435c-7.001 0-12.071 3.145-15.21 9.435s-4.708 18.336-4.708 36.139v83.316zM481.449 512.534c0-25.398 1.75-46.405 5.251-63.021s8.812-29.789 15.934-39.522c7.122-9.732 16.176-16.497 27.16-20.295s23.962-5.697 38.93-5.697c14.969 0 27.945 1.899 38.93 5.697s20.038 10.563 27.16 20.295c7.122 9.732 12.433 22.906 15.934 39.522s5.251 37.622 5.251 63.021c0 25.636-1.75 46.702-5.251 63.199s-8.812 29.552-15.934 39.166c-7.122 9.613-16.176 16.2-27.16 19.761s-23.962 5.341-38.93 5.341c-14.969 0-27.945-1.78-38.93-5.341s-20.038-10.147-27.16-19.761c-7.122-9.613-12.433-22.668-15.934-39.166s-5.251-37.563-5.251-63.199z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-vr-stereo {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M864 255.996c53.019 0 96 42.981 96 96v384.004c0 53.019-42.981 96-96 96h-219.764c-33.721 0-64.97-17.693-82.319-46.608l-49.917-83.195-49.917 83.195c-17.349 28.916-48.598 46.608-82.319 46.608h-219.764c-53.019 0-96-42.981-96-96v-384.003c0-53.019 42.981-96 96-96h704zM128 351.997v384.003c0 17.673 14.327 32 32 32h219.764c11.24 0 21.657-5.898 27.44-15.536l49.917-83.195c5.405-9.008 12.944-16.547 21.952-21.952 30.309-18.185 69.622-8.357 87.807 21.952l49.917 83.195c5.783 9.639 16.199 15.536 27.44 15.536h219.764c17.673 0 32-14.327 32-32v-384.004c0-17.673-14.327-32-32-32h-704c-17.673 0-32 14.327-32 32zM304 624c-44.183 0-80-35.817-80-80s35.817-80 80-80c44.183 0 80 35.817 80 80s-35.817 80-80 80zM720 624c-44.183 0-80-35.817-80-80s35.817-80 80-80c44.183 0 80 35.817 80 80s-35.817 80-80 80z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-vr-stereo-full {\n  background-image: var(--playkit-icon-vr-stereo-full-url);\n}\n\n.playkit-icon-chromecast {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M160 704v96h96c0-53.12-42.88-96-96-96zM160 576v64c88.32 0 160 71.68 160 160h64c0-123.84-100.16-224-224-224zM736 352h-448v52.16c126.72 40.96 226.88 141.12 267.84 267.84h180.16v-320zM160 448v64c159.040 0 288 128.96 288 288h64c0-194.56-157.76-352-352-352zM800 224h-576c-35.2 0-64 28.8-64 64v96h64v-96h576v448h-224v64h224c35.2 0 64-28.8 64-64v-448c0-35.2-28.8-64-64-64z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-chromecast-brand {\n  background-image: var(--playkit-icon-chromecast-url);\n}\n\n.playkit-icon-next {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M640 549.333l-264.982 154.573c-30.386 17.725-55.018 3.388-55.018-32.094v-319.625c0-35.45 24.605-49.835 55.018-32.094l264.982 154.573v-154.448c0-17.794 14.204-32.219 32-32.219 17.673 0 32 14.398 32 32.219v383.562c0 17.794-14.204 32.219-32 32.219-17.673 0-32-14.398-32-32.219v-154.448z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-prev {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M384 549.333l264.982 154.573c30.386 17.725 55.018 3.388 55.018-32.094v-319.625c0-35.45-24.605-49.835-55.018-32.094l-264.982 154.573v-154.448c0-17.794-14.204-32.219-32-32.219-17.673 0-32 14.398-32 32.219v383.562c0 17.794 14.204 32.219 32 32.219 17.673 0 32-14.398 32-32.219v-154.448z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-picture-in-picture-start {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M224 256c-17.673 0-32 14.327-32 32v448c0 17.673 14.327 32 32 32h576c17.673 0 32-14.327 32-32v-448c0-17.673-14.327-32-32-32h-576zM224 192h576c53.019 0 96 42.981 96 96v448c0 53.019-42.981 96-96 96h-576c-53.019 0-96-42.981-96-96v-448c0-53.019 42.981-96 96-96z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M544 512h192c17.673 0 32 14.327 32 32v128c0 17.673-14.327 32-32 32h-192c-17.673 0-32-14.327-32-32v-128c0-17.673 14.327-32 32-32z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-picture-in-picture-stop {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1024 1024' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M800 192c51.126 0 92.917 39.965 95.837 90.359l0.163 5.641v448c0 51.126-39.965 92.917-90.359 95.837l-5.641 0.163h-576c-51.126 0-92.917-39.965-95.837-90.359l-0.163-5.641v-64c0-17.673 14.327-32 32-32 16.411 0 29.936 12.353 31.785 28.268l0.215 3.732v64c0 16.411 12.353 29.936 28.268 31.785l3.732 0.215h576c16.411 0 29.936-12.353 31.785-28.268l0.215-3.732v-448c0-16.411-12.353-29.936-28.268-31.785l-3.732-0.215h-192c-17.673 0-32-14.327-32-32 0-16.411 12.353-29.936 28.268-31.785l3.732-0.215h192z'%3E%3C/path%3E%3Cpath fill='%23fff' d='M416 192c17.673 0 32 14.327 32 32 0 16.411-12.353 29.936-28.268 31.785l-3.732 0.215-178.752-0.032 202.711 202.736c12.497 12.497 12.497 32.758 0 45.255-11.535 11.535-29.687 12.423-42.24 2.662l-3.015-2.662-202.704-202.679v178.72c0 16.411-12.353 29.936-28.268 31.785l-3.732 0.215c-16.411 0-29.936-12.353-31.785-28.268l-0.215-3.732v-256l0.005-0.588c0.014-0.757 0.054-1.514 0.122-2.268l-0.127 2.856c0-1.62 0.12-3.212 0.353-4.767 0.083-0.544 0.182-1.101 0.295-1.656 0.141-0.705 0.307-1.399 0.495-2.084 0.14-0.5 0.288-0.992 0.449-1.482 0.204-0.629 0.434-1.262 0.684-1.885 0.227-0.568 0.466-1.121 0.722-1.669 0.311-0.661 0.644-1.314 0.998-1.954 0.212-0.388 0.439-0.779 0.676-1.166 0.503-0.818 1.040-1.614 1.61-2.382 0.174-0.238 0.351-0.47 0.532-0.7 1.588-2.021 3.42-3.854 5.45-5.446l-2.891 2.563c1.133-1.133 2.329-2.163 3.578-3.090 0.774-0.571 1.569-1.108 2.389-1.609 0.386-0.239 0.777-0.466 1.171-0.685 0.633-0.348 1.285-0.681 1.951-0.993 0.544-0.255 1.098-0.495 1.656-0.718 0.632-0.253 1.265-0.483 1.907-0.694 0.476-0.154 0.969-0.302 1.464-0.438 0.69-0.192 1.384-0.359 2.086-0.502 0.557-0.111 1.115-0.209 1.674-0.293 0.327-0.051 0.672-0.097 1.019-0.137l0.876-0.088c0.755-0.067 1.511-0.108 2.268-0.122l0.588-0.005h256z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-advanced-audio-description {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 24 24' width='24' height='24' fill-rule='nonzero'%3E%3Cpath d='M6.647 12.958h1.547V10.81l-1.547 2.147ZM12.226 10.408c.99 0 1.787.717 1.787 1.595 0 .881-.798 1.598-1.787 1.598h-.467v-3.193h.467Z' fill='%23fff'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M3.536 4C2.688 4 2 4.68 2 5.52v12.96c0 .832.688 1.52 1.536 1.52h16.928c.848 0 1.536-.68 1.536-1.52V5.52C22 4.688 21.312 4 20.464 4H3.536Zm15.335 5h.826c.83.87 1.303 1.982 1.303 3.14a4.504 4.504 0 0 1-1.033 2.837h-.792c.745-.793 1.165-1.792 1.165-2.838 0-1.178-.537-2.311-1.47-3.139ZM8.185 15h1.47V9.004H7.819L3 15h2.158l.566-.793h2.461V15Zm4.223-.003c1.851 0 3.357-1.343 3.357-2.994 0-1.657-1.49-2.997-3.341-2.997h-2.075v5.993h2.059v-.002ZM18.008 9h-.826c.932.828 1.47 1.961 1.47 3.14 0 1.045-.421 2.044-1.166 2.837h.787a4.48 4.48 0 0 0 1.038-2.838c0-1.157-.472-2.27-1.303-3.139Zm-2.515 0h.82c.837.87 1.304 1.982 1.304 3.14a4.474 4.474 0 0 1-1.033 2.837h-.787c.74-.793 1.16-1.792 1.16-2.838 0-1.178-.532-2.311-1.464-3.139Z' fill='%23fff'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-advanced-audio-description-active {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 24 24' width='24' height='24' fill-rule='nonzero'%3E%3Cpath d='M6.647 12.958h1.547V10.81l-1.547 2.147ZM12.226 10.408c.99 0 1.787.717 1.787 1.595 0 .881-.798 1.598-1.787 1.598h-.467v-3.193h.467Z' fill='%23006efa'/%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M3.536 4C2.688 4 2 4.68 2 5.52v12.96c0 .832.688 1.52 1.536 1.52h16.928c.848 0 1.536-.68 1.536-1.52V5.52C22 4.688 21.312 4 20.464 4H3.536Zm15.335 5h.826c.83.87 1.303 1.982 1.303 3.14a4.504 4.504 0 0 1-1.033 2.837h-.792c.745-.793 1.165-1.792 1.165-2.838 0-1.178-.537-2.311-1.47-3.139ZM8.185 15h1.47V9.004H7.819L3 15h2.158l.566-.793h2.461V15Zm4.223-.003c1.851 0 3.357-1.343 3.357-2.994 0-1.657-1.49-2.997-3.341-2.997h-2.075v5.993h2.059v-.002ZM18.008 9h-.826c.932.828 1.47 1.961 1.47 3.14 0 1.045-.421 2.044-1.166 2.837h.787a4.48 4.48 0 0 0 1.038-2.838c0-1.157-.472-2.27-1.303-3.139Zm-2.515 0h.82c.837.87 1.304 1.982 1.304 3.14a4.474 4.474 0 0 1-1.033 2.837h-.787c.74-.793 1.16-1.792 1.16-2.838 0-1.178-.532-2.311-1.464-3.139Z' fill='%23006efa'/%3E%3C/svg%3E\");\n}\n\n.playkit-icon-quality-hd:after {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M3.73939861,5 L2,5 L2,11 L3.73939861,11 L3.73918396,8.56940659 L5.96845644,8.56940659 L5.9691596,11 L7.69930609,11 L7.69930609,5 L5.9691596,5 L5.96845644,7.32457143 L3.73918396,7.32457143 L3.73939861,5 Z M10.849653,5 L8.65690054,5 L8.65690054,11 L10.8774094,11 L11.1387878,10.9921562 C11.5670397,10.9660102 11.9583976,10.8744992 12.3128614,10.7176232 L12.3128614,10.7176232 L12.4919044,10.6311813 L12.686671,10.5199596 C13.0639309,10.2858264 13.3675515,9.98155416 13.5975328,9.60714286 C13.827514,9.23273155 13.9589319,8.81088809 13.9917864,8.34161247 L13.9917864,8.34161247 L14,8.10302198 L14,7.9010989 L13.9917864,7.66145717 C13.9589319,7.19033135 13.827514,6.76815149 13.5975328,6.39491758 C13.3292213,5.95947802 12.9583655,5.61813187 12.4849653,5.37087912 C12.0791937,5.15894819 11.6207417,5.03784481 11.1096093,5.00756896 L11.1096093,5.00756896 L10.849653,5 Z M10.849653,6.24862637 C11.154973,6.24862637 11.4101773,6.30906593 11.615266,6.42994505 C11.8203547,6.55082418 11.9745567,6.73282967 12.077872,6.97596154 C12.1605243,7.17046703 12.2101157,7.40497253 12.2266461,7.67947802 L12.2266461,7.67947802 L12.232845,7.89285714 L12.232845,8.10302198 L12.2265536,8.31796703 C12.2097764,8.59445055 12.1594449,8.83049451 12.075559,9.0260989 C11.9707016,9.2706044 11.8180416,9.4532967 11.617579,9.57417582 C11.4572089,9.67087912 11.2672321,9.7289011 11.0476484,9.74824176 L11.0476484,9.74824176 L10.8774094,9.75549451 L10.3957366,9.75600879 L10.3957366,6.24937143 Z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-quality-hd-active:after {\n  background-image: var(--playkit-icon-quality-HD-active-url);\n}\n\n.playkit-icon-quality-4k:after {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M6.52117789,5 L4.77853973,5 L4.7778117,5.01381978 L2,8.80769231 L2.10649455,9.76785714 L4.7778117,9.76866813 L4.77853973,11 L6.52117789,11 L6.52063574,9.76866813 L7.19402985,9.76785714 L7.19402985,8.5728022 L6.52063574,8.57362637 L6.52117789,5 Z M9.81282775,5 L7.99273901,5 L7.99273901,11 L9.81282775,11 L9.8119758,9.5061978 L10.4712352,8.88589011 L11.8313836,11 L13.9806374,11 L11.6856603,7.6629978 L14,5 L11.7587737,5 L10.3549818,6.78434066 L9.8119758,7.5229011 L9.81282775,5 Z M4.7778117,7.01905934 L4.7778117,8.57362637 L3.65066559,8.5728022 L4.69624849,7.13873626 L4.7778117,7.01905934 Z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-quality-4k-active:after {\n  background-image: var(--playkit-icon-quality-4K-active-url);\n}\n\n.playkit-icon-quality-8k:after {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 16 16' width='16' height='16' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M13.9931545,4 C14.5492199,4 15,4.45303631 15,4.99703014 L15,11.0029699 C15,11.5536144 14.5500512,12 13.9931545,12 L2.00684547,12 C1.45078007,12 1,11.5469637 1,11.0029699 L1,4.99703014 C1,4.4463856 1.44994876,4 2.00684547,4 L13.9931545,4 Z M4.5,5 C4.04427083,5 3.6389974,5.06279225 3.28417969,5.18837675 C2.92936198,5.31396126 2.65104167,5.499666 2.44921875,5.74549098 C2.24739583,5.99131597 2.14648438,6.29458918 2.14648438,6.65531062 C2.14648438,6.96259185 2.24820964,7.23112892 2.45166016,7.46092184 C2.58729384,7.61411712 2.75692636,7.74445187 2.96055773,7.85192607 L2.96055773,7.85192607 L3.07972656,7.90981323 L3.04817708,7.92134269 L2.87890625,8.000668 C2.71614583,8.08483634 2.57291667,8.18353373 2.44921875,8.29676019 L2.44921875,8.29676019 L2.33203125,8.41482966 L2.24394133,8.52320968 C2.08131378,8.74602266 2,9.00515316 2,9.3006012 C2,9.67735471 2.10986328,9.99131597 2.32958984,10.242485 C2.54931641,10.493654 2.84879557,10.6826987 3.22802734,10.8096192 C3.60725911,10.9365397 4.03613281,11 4.51464844,11 C4.99641927,11 5.42366536,10.9365397 5.79638672,10.8096192 C6.16910807,10.6826987 6.46289063,10.493654 6.67773438,10.242485 C6.89257813,9.99131597 7,9.67735471 7,9.3006012 C7,8.95591182 6.89176432,8.66065464 6.67529297,8.41482966 L6.67529297,8.41482966 L6.56041124,8.29676019 C6.3983742,8.14579158 6.20089157,8.02065242 5.96796332,7.92134269 L5.96796332,7.92134269 L5.94,7.911 L6.06141493,7.85192607 L6.20532227,7.76703407 C6.29701063,7.70758183 6.38019929,7.64241446 6.45488824,7.57153195 L6.45488824,7.57153195 L6.56054688,7.46092184 L6.65155707,7.3427967 C6.78945132,7.14054034 6.85839844,6.91137831 6.85839844,6.65531062 C6.85839844,6.29458918 6.75830078,5.99131597 6.55810547,5.74549098 C6.35791016,5.499666 6.08121745,5.31396126 5.72802734,5.18837675 C5.37483724,5.06279225 4.96549479,5 4.5,5 Z M9.8178888,5 L8,5 L8,11 L9.8178888,11 L9.81771088,9.5061978 L10.4751832,8.88673407 L11.8340048,11 L13.9806608,11 L11.6891307,7.6629978 L14,5 L11.7614827,5 L10.3593876,6.78434066 L9.81771088,7.5229011 L9.8178888,5 Z M4.50488281,8.51903808 C4.6546224,8.51903808 4.78401693,8.54375418 4.89306641,8.59318637 C5.00211589,8.64261857 5.0867513,8.71543086 5.14697266,8.81162325 C5.20719401,8.90781563 5.23730469,9.02805611 5.23730469,9.17234469 C5.23730469,9.30861723 5.20800781,9.4261857 5.14941406,9.5250501 C5.09082031,9.6239145 5.0069987,9.7007348 4.89794922,9.75551102 C4.78889974,9.81028724 4.66113281,9.83767535 4.51464844,9.83767535 C4.36490885,9.83767535 4.23388672,9.81028724 4.12158203,9.75551102 C4.00927734,9.7007348 3.92220052,9.6239145 3.86035156,9.5250501 C3.7985026,9.4261857 3.76757812,9.30861723 3.76757812,9.17234469 C3.76757812,9.02805611 3.7985026,8.90781563 3.86035156,8.81162325 C3.92220052,8.71543086 4.00846354,8.64261857 4.11914062,8.59318637 C4.22981771,8.54375418 4.35839844,8.51903808 4.50488281,8.51903808 Z M4.5,6.16232465 C4.63671875,6.16232465 4.74902344,6.18570474 4.83691406,6.23246493 C4.92480469,6.27922512 4.99072266,6.34535738 5.03466797,6.43086172 C5.07861328,6.51636607 5.10058594,6.62057448 5.10058594,6.74348697 C5.10058594,6.86372745 5.08024089,6.96993988 5.03955078,7.06212425 C4.99886068,7.15430862 4.93538411,7.22645291 4.84912109,7.27855711 C4.76285807,7.33066132 4.65136719,7.35671343 4.51464844,7.35671343 C4.37792969,7.35671343 4.2648112,7.33066132 4.17529297,7.27855711 C4.08577474,7.22645291 4.01985677,7.15430862 3.97753906,7.06212425 C3.93522135,6.96993988 3.9140625,6.86372745 3.9140625,6.74348697 C3.9140625,6.62057448 3.93522135,6.51636607 3.97753906,6.43086172 C4.01985677,6.34535738 4.08496094,6.27922512 4.17285156,6.23246493 C4.26074219,6.18570474 4.36979167,6.16232465 4.5,6.16232465 Z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-quality-8k-active:after {\n  background-image: var(--playkit-icon-quality-8K-active-url);\n}\n\n.playkit-icon-closed-captions-on {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 32 32' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M15.114 18.545c0.144-0.275 0.217-0.533 0.217-0.774 0-0.204-0.078-0.395-0.234-0.575s-0.353-0.27-0.59-0.27c-0.199 0-0.367 0.061-0.504 0.185s-0.265 0.294-0.384 0.511c-0.213 0.369-0.458 0.644-0.735 0.824s-0.61 0.27-0.998 0.27c-0.289 0-0.554-0.056-0.796-0.167s-0.447-0.275-0.618-0.49c-0.171-0.215-0.301-0.476-0.391-0.781s-0.135-0.64-0.135-1.005c0-0.777 0.175-1.389 0.526-1.836s0.812-0.671 1.385-0.671c0.398 0 0.726 0.090 0.984 0.27s0.505 0.45 0.742 0.81c0.133 0.185 0.252 0.318 0.359 0.401s0.24 0.124 0.401 0.124c0.246 0 0.456-0.081 0.629-0.242s0.259-0.357 0.259-0.59c0-0.227-0.077-0.472-0.231-0.735s-0.377-0.51-0.668-0.742c-0.291-0.232-0.646-0.421-1.066-0.568s-0.88-0.22-1.382-0.22c-0.81 0-1.506 0.167-2.088 0.501s-1.028 0.806-1.335 1.417-0.462 1.314-0.462 2.11c0 1.174 0.336 2.111 1.009 2.809s1.608 1.048 2.806 1.048c0.564 0 1.070-0.076 1.52-0.227s0.823-0.352 1.119-0.6c0.296-0.249 0.516-0.51 0.661-0.785z'%3E%3C/path%3E %3Cpath fill='%23fff' d='M23.759 18.545c0.145-0.275 0.217-0.533 0.217-0.774 0-0.204-0.078-0.395-0.234-0.575s-0.353-0.27-0.59-0.27c-0.199 0-0.367 0.061-0.504 0.185s-0.265 0.294-0.384 0.511c-0.213 0.369-0.458 0.644-0.735 0.824s-0.61 0.27-0.998 0.27c-0.289 0-0.554-0.056-0.796-0.167s-0.448-0.275-0.618-0.49c-0.17-0.215-0.301-0.476-0.391-0.781s-0.135-0.64-0.135-1.005c0-0.777 0.175-1.389 0.526-1.836s0.812-0.671 1.385-0.671c0.398 0 0.726 0.090 0.984 0.27s0.506 0.45 0.742 0.81c0.133 0.185 0.252 0.318 0.359 0.401s0.24 0.124 0.401 0.124c0.246 0 0.456-0.081 0.629-0.242s0.259-0.357 0.259-0.59c0-0.227-0.077-0.472-0.231-0.735s-0.377-0.51-0.668-0.742c-0.291-0.232-0.646-0.421-1.066-0.568s-0.88-0.22-1.382-0.22c-0.81 0-1.506 0.167-2.088 0.501s-1.028 0.806-1.335 1.417-0.462 1.314-0.462 2.11c0 1.174 0.336 2.111 1.009 2.809s1.608 1.048 2.806 1.048c0.564 0 1.070-0.076 1.52-0.227s0.823-0.352 1.119-0.6 0.516-0.51 0.661-0.785z'%3E%3C/path%3E %3Cpath fill='%23fff' d='M3 7.9c0-1.049 0.895-1.9 1.997-1.9h22.006c1.103 0 1.997 0.859 1.997 1.9v16.201c0 1.049-0.895 1.9-1.997 1.9h-22.006c-1.103 0-1.997-0.859-1.997-1.9v-16.201zM5 24.1c-0.001-0.005 22-0.005 22-0.005v-16.196c0 0.005-22 0.005-22 0.005v16.196z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n.playkit-icon-closed-captions-off {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 32 32' width='36' height='36' fill-rule='nonzero'%3E%3Cpath fill='%23fff' d='M30.133 6.838l-1.143 0.863c0.007 0.065 0.011 0.131 0.011 0.198v16.201c0 1.049-0.895 1.9-1.997 1.9h-22.006c-0.080 0-0.159-0.005-0.236-0.013l-1.128 0.851c-0.463 0.349-1.121 0.257-1.471-0.206s-0.257-1.121 0.206-1.471l26.5-20c0.463-0.349 1.121-0.257 1.471 0.206s0.257 1.121-0.206 1.471zM27 9.202l-4.619 3.486c0.222 0.109 0.421 0.233 0.596 0.373 0.291 0.232 0.514 0.479 0.668 0.742s0.231 0.508 0.231 0.735c0 0.232-0.086 0.429-0.259 0.59s-0.382 0.242-0.629 0.242c-0.161 0-0.295-0.041-0.401-0.124s-0.226-0.217-0.359-0.401c-0.237-0.36-0.484-0.63-0.742-0.81-0.164-0.114-0.357-0.193-0.578-0.234l-2.249 1.697c-0.045 0.237-0.068 0.495-0.068 0.774 0 0.365 0.045 0.7 0.135 1.005s0.22 0.566 0.391 0.781c0.171 0.215 0.377 0.379 0.618 0.49s0.507 0.167 0.796 0.167c0.388 0 0.721-0.090 0.998-0.27s0.522-0.455 0.735-0.824c0.118-0.218 0.246-0.388 0.384-0.511s0.305-0.185 0.504-0.185c0.237 0 0.433 0.090 0.59 0.27s0.234 0.372 0.234 0.575c0 0.241-0.072 0.5-0.217 0.774s-0.365 0.536-0.661 0.785-0.669 0.449-1.119 0.6c-0.45 0.152-0.957 0.227-1.52 0.227-1.198 0-2.133-0.349-2.806-1.048-0.536-0.557-0.858-1.265-0.967-2.123l-1.382 1.043c-0.033 0.165-0.096 0.337-0.19 0.516-0.145 0.275-0.365 0.536-0.661 0.785s-0.669 0.449-1.119 0.6c-0.246 0.083-0.508 0.143-0.788 0.18l-5.283 3.987c5.615-0.003 19.737-0.003 19.737-0.003v-14.893z'%3E%3C/path%3E %3Cpath fill='%23fff' d='M4.997 6h19.546l-2.492 1.903c-6.487 0.002-17.051 0.002-17.051 0.002v13.019l-2 1.527v-14.551c0-1.049 0.895-1.9 1.997-1.9z'%3E%3C/path%3E %3Cpath fill='%23fff' d='M12.841 14.034c0.179 0.125 0.353 0.293 0.521 0.504l1.399-1.068c-0.121-0.141-0.264-0.277-0.428-0.409-0.291-0.232-0.646-0.421-1.066-0.568s-0.88-0.22-1.382-0.22c-0.81 0-1.506 0.167-2.088 0.501s-1.028 0.806-1.335 1.417-0.462 1.314-0.462 2.11c0 0.77 0.144 1.437 0.433 2.002l1.598-1.22c-0.056-0.252-0.085-0.522-0.085-0.81 0-0.777 0.175-1.389 0.526-1.836s0.812-0.671 1.385-0.671c0.398 0 0.726 0.090 0.984 0.27z'%3E%3C/path%3E%3C/svg%3E\");\n}\n\n@keyframes playkit-openDropmenu {\n  from {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n.playkit-dropdown {\n  position: relative;\n  font-size: 15px;\n}\n.playkit-dropdown .playkit-label-badge {\n  position: relative;\n}\n.playkit-dropdown .playkit-label-badge:after {\n  top: -5px;\n  right: -18px;\n}\n.playkit-dropdown.playkit-active .playkit-dropdown-menu {\n  display: block;\n  opacity: 1;\n}\n.playkit-dropdown.playkit-active .playkit-dropdown-button .playkit-icon-arrow-down {\n  transform: rotate(180deg);\n}\n.playkit-dropdown .playkit-dropdown-button {\n  font-weight: bold;\n  line-height: 18px;\n  color: #fff;\n  cursor: pointer;\n  padding-left: 20px;\n  display: flex;\n}\n.playkit-dropdown .playkit-dropdown-button .playkit-icon {\n  width: 16px;\n  height: 16px;\n  vertical-align: middle;\n  margin-left: 6px;\n  transition: 150ms transform;\n  will-change: transform;\n}\n.playkit-dropdown .playkit-dropdown-button > .playkit-label-badge.playkit-badge-icon {\n  margin-right: 13px;\n}\n\n.playkit-dropdown-menu {\n  display: block;\n  opacity: 1;\n  position: absolute;\n  background-color: #333333;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.3);\n  border-radius: 4px;\n  padding: 8px 0;\n  z-index: 5;\n  animation: playkit-openDropmenu 100ms ease-out forwards;\n  max-height: 220px;\n  overflow-y: auto;\n  font-size: 15px;\n  text-align: left;\n  font-weight: normal;\n}\n.playkit-dropdown-menu.playkit-top {\n  margin-bottom: 10px;\n  bottom: 100%;\n}\n.playkit-dropdown-menu.playkit-bottom {\n  margin-top: 10px;\n  top: 100%;\n}\n.playkit-dropdown-menu.playkit-right {\n  left: 0;\n}\n.playkit-dropdown-menu.playkit-left {\n  right: 0;\n}\n.playkit-dropdown-menu.playkit-stick-bottom {\n  bottom: -95px;\n  margin: 5px 0;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 4px 12px;\n  margin: 4px;\n  white-space: nowrap;\n  min-height: 30px;\n  cursor: pointer;\n  border-radius: 4px;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item:hover, .playkit-dropdown-menu .playkit-dropdown-menu-item:focus {\n  background-color: var(--playkit-tone-6-color);\n  color: #fff;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item.playkit-active .playkit-menu-icon-container {\n  opacity: 1;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item .playkit-icon-check-active {\n  display: inline-block;\n  margin-left: 16px;\n  vertical-align: middle;\n  width: 24px;\n  height: 24px;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item .playkit-menu-icon-container {\n  opacity: 0;\n}\n.playkit-dropdown-menu .playkit-dropdown-menu-item > .playkit-label-badge.playkit-badge-icon {\n  margin-right: 5px;\n}\n\n.playkit-player .playkit-control-button {\n  width: 32px;\n  height: 32px;\n  border-radius: 4px;\n  background: transparent;\n  display: inline-block;\n  opacity: 0.8;\n  border: none;\n  padding: 0;\n  cursor: pointer;\n}\n.playkit-player .playkit-control-button.playkit-button-badge {\n  position: relative;\n}\n.playkit-player .playkit-control-button.playkit-button-badge:after {\n  top: -4px;\n  right: -1px;\n}\n.playkit-player .playkit-control-button i {\n  width: 32px;\n  height: 32px;\n}\n.playkit-player .playkit-control-button.playkit-active {\n  opacity: 1;\n}\n.playkit-player .playkit-control-button:disabled {\n  opacity: 0.4;\n  cursor: default;\n}\n.playkit-player .playkit-control-button.playkit-control-button-rounded {\n  width: 36px;\n  height: 36px;\n  padding: 2px;\n}\n\n.playkit-player:not(.playkit-touch) .playkit-control-button:not(:disabled):hover {\n  opacity: 1;\n}\n.playkit-player:not(.playkit-touch) .playkit-control-button:not(:disabled).playkit-control-button-rounded:hover {\n  background-color: rgba(0, 0, 0, 0.4);\n  border-radius: 18px;\n}\n\n.playkit-player .playkit-control-button-container {\n  display: inline-block;\n  position: relative;\n  vertical-align: top;\n}\n\n.playkit-player.playkit-touch .playkit-player .playkit-control-button-container {\n  position: static;\n}\n.playkit-player.playkit-touch .playkit-control-button {\n  position: relative;\n}\n\n.playkit-player.playkit-state-idle .playkit-no-idle-control {\n  display: none;\n}\n\n.playkit-rotate {\n  -moz-animation: playkit-spin 0.3s 1 linear;\n  -o-animation: playkit-spin 0.3s 1 linear;\n  -webkit-animation: playkit-spin 0.3s 1 linear;\n  animation: playkit-spin 0.3s 1 linear;\n}\n\n.playkit-reverse-rotate {\n  -moz-animation: playkit-reverse-spin 0.3s 1 linear;\n  -o-animation: playkit-reverse-spin 0.3s 1 linear;\n  -webkit-animation: playkit-reverse-spin 0.3s 1 linear;\n  animation: playkit-reverse-spin 0.3s 1 linear;\n}\n\n@-webkit-keyframes playkit-spin {\n  0% {\n    -webkit-transform: rotate(359deg);\n  }\n  100% {\n    -webkit-transform: rotate(0deg);\n  }\n}\n@-moz-keyframes playkit-spin {\n  0% {\n    -moz-transform: rotate(359deg);\n  }\n  100% {\n    -moz-transform: rotate(0deg);\n  }\n}\n@-o-keyframes playkit-spin {\n  0% {\n    -o-transform: rotate(359deg);\n  }\n  100% {\n    -o-transform: rotate(0deg);\n  }\n}\n@-ms-keyframes playkit-spin {\n  0% {\n    -ms-transform: rotate(359deg);\n  }\n  100% {\n    -ms-transform: rotate(0deg);\n  }\n}\n@keyframes playkit-spin {\n  0% {\n    transform: rotate(359deg);\n  }\n  100% {\n    transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes playkit-reverse-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(359deg);\n  }\n}\n@-moz-keyframes playkit-reverse-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(359deg);\n  }\n}\n@-o-keyframes playkit-reverse-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(359deg);\n  }\n}\n@-ms-keyframes playkit-reverse-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(359deg);\n  }\n}\n@keyframes playkit-reverse-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(359deg);\n  }\n}\n.playkit-upper-bar-icon {\n  width: 36px;\n  height: 36px;\n  border-radius: 4px;\n  padding: 2px;\n  cursor: pointer;\n  color: var(--playkit-tone-1-color);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 0.8;\n  border: none;\n  background-color: transparent;\n  margin: 0 4px;\n}\n.playkit-upper-bar-icon:hover {\n  background-color: var(--playkit-tone-4-color);\n  opacity: 1;\n}\n.playkit-upper-bar-icon:active {\n  background-color: var(--playkit-tone-6-color);\n  opacity: 1;\n}\n.playkit-upper-bar-icon:disabled {\n  opacity: 0.4;\n}\n\n.playkit-player a {\n  font-size: 15px;\n  line-height: 18px;\n  cursor: pointer;\n  --primary-hover-color: hsl(var(--playkit-primary-hsl-hue) var(--playkit-hsl-saturation) calc(var(--playkit-hsl-lightness) - 10%));\n}\n.playkit-player a:hover {\n  color: var(--primary-hover-color);\n}\n.playkit-player a:active {\n  opacity: 0.7;\n}\n\n.playkit-emptyUrl a {\n  cursor: auto;\n  pointer-events: none;\n}\n\n.playkit-player {\n  overflow: hidden;\n  user-select: none;\n  width: 100%;\n  height: 100%;\n  position: relative;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n  cursor: none;\n  font-family: Lato, Helvetica Neue, Segoe UI, sans-serif;\n}\n.playkit-player:-webkit-full-screen {\n  width: 100%;\n  height: 100%;\n  max-width: none;\n}\n.playkit-player * {\n  box-sizing: border-box;\n  outline: none;\n}\n.playkit-player ::selection {\n  background-color: rgba(0, 0, 0, 0.1);\n}\n.playkit-player video {\n  width: 100%;\n  left: 0;\n}\n.playkit-player video::-webkit-media-controls-panel-container, .playkit-player video::-webkit-media-controls {\n  display: none !important;\n  -webkit-appearance: none;\n}\n.playkit-player video::-webkit-media-controls-start-playback-button {\n  display: none !important;\n  -webkit-appearance: none;\n}\n.playkit-player .playkit-player-gui {\n  overflow: hidden;\n  font-size: 0;\n}\n.playkit-player .playkit-player-gui label {\n  margin-bottom: 0;\n}\n.playkit-player .overlay-portal {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n}\n.playkit-player.playkit-overlay-active .overlay-portal {\n  z-index: 11;\n  pointer-events: initial;\n}\n\n.playkit-player.playkit-nav *:focus {\n  outline: 1px solid var(--playkit-tab-focus-color) !important;\n}\n\n.playkit-player [id^=\"playkit-ads-container\"] {\n  transition: transform 100ms;\n}\n.playkit-player [id^=\"playkit-ads-container\"][data-adtype=\"overlay\"] {\n  z-index: 1;\n}\n\n.playkit-player:not(.playkit-ad-break).playkit-metadata-loaded.playkit-hover [id^=\"playkit-ads-container\"], .playkit-player:not(.playkit-ad-break).playkit-metadata-loaded.playkit-state-paused [id^=\"playkit-ads-container\"], .playkit-player:not(.playkit-ad-break).playkit-metadata-loaded.playkit-state-idle [id^=\"playkit-ads-container\"] {\n  transform: translateY(-60px);\n  -webkit-transform: translateY(-60px);\n  -ms-transform: translateY(-60px);\n}\n\n.playkit-player.playkit-pre-playback, .playkit-player.playkit-casting, .playkit-player.playkit-metadata-loaded.playkit-hover, .playkit-player.playkit-state-paused, .playkit-player.playkit-state-idle, .playkit-player.playkit-ad-break, .playkit-player.playkit-menu-active, .playkit-player.playkit-overlay-active {\n  cursor: auto;\n}\n\n.playkit-player video::-webkit-media-text-track-container {\n  max-height: none;\n}\n.playkit-player.playkit-iOS video::-webkit-media-text-track-container {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n.playkit-player.playkit-state-paused video::-webkit-media-text-track-container, .playkit-player.playkit-state-idle video::-webkit-media-text-track-container, .playkit-player.playkit-hover video::-webkit-media-text-track-container {\n  padding: 0 0 50px 0;\n}\n.playkit-player.playkit-state-paused.playkit-Safari video::-webkit-media-text-track-container, .playkit-player.playkit-state-paused.playkit-iOS video::-webkit-media-text-track-container, .playkit-player.playkit-state-idle.playkit-Safari video::-webkit-media-text-track-container, .playkit-player.playkit-state-idle.playkit-iOS video::-webkit-media-text-track-container, .playkit-player.playkit-hover.playkit-Safari video::-webkit-media-text-track-container, .playkit-player.playkit-hover.playkit-iOS video::-webkit-media-text-track-container {\n  padding: initial;\n  max-height: calc(100% - 50px);\n}\n.playkit-player.playkit-state-paused.playkit-fullscreen.playkit-iOS video::-webkit-media-text-track-display, .playkit-player.playkit-state-idle.playkit-fullscreen.playkit-iOS video::-webkit-media-text-track-display, .playkit-player.playkit-hover.playkit-fullscreen.playkit-iOS video::-webkit-media-text-track-display {\n  transform: translateY(-50px);\n  -webkit-transform: translateY(-50px);\n  -ms-transform: translateY(-50px);\n}\n.playkit-player.playkit-fullscreen.playkit-iOS video::-webkit-media-text-track-container {\n  max-height: none;\n}\n.playkit-player.playkit-overlay-active .playkit-subtitles {\n  visibility: hidden;\n}\n.playkit-player .playkit-subtitles {\n  top: 50px;\n  transform: translateY(0px);\n  -webkit-transform: translateY(0px);\n  -ms-transform: translateY(0px);\n  transition: ease-in 100ms;\n}\n.playkit-player:not(.playkit-overlay-active).playkit-state-paused .playkit-subtitles, .playkit-player:not(.playkit-overlay-active).playkit-state-idle .playkit-subtitles, .playkit-player:not(.playkit-overlay-active).playkit-hover .playkit-subtitles {\n  transform: translateY(-50px);\n  -webkit-transform: translateY(-50px);\n  -ms-transform: translateY(-50px);\n}\n.playkit-player:not(.playkit-overlay-active).playkit-fullscreen.playkit-iOS .playkit-subtitles {\n  transform: translateY(0px);\n  -webkit-transform: translateY(0px);\n  -ms-transform: translateY(0px);\n}\n\n.playkit-video-player {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: var(--playkit-player-background-color);\n  transition: all 500ms;\n  transition-property: left, right, bottom, top, width, height;\n  display: flex;\n}\n.playkit-overlay-active .playkit-video-player {\n  filter: blur(16px);\n}\n\n@keyframes playkit-openOverlay {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n.playkit-overlay {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  display: none;\n  opacity: 0;\n  animation: playkit-openOverlay 100ms ease-in-out forwards;\n  z-index: 11;\n}\n.playkit-overlay.playkit-active {\n  display: block;\n  opacity: 1;\n}\n.playkit-overlay .playkit-overlay-contents {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.7);\n  z-index: 4;\n  text-align: center;\n  color: #fff;\n  padding: 60px 20px 30px 20px;\n  overflow-y: auto;\n}\n.playkit-overlay .playkit-title {\n  font-size: 24px;\n  font-weight: bold;\n  line-height: 29px;\n  margin-bottom: 60px;\n  margin-top: 0px;\n}\n.playkit-overlay .playkit-close-overlay {\n  position: absolute;\n  top: 48px;\n  right: 48px;\n  z-index: 5;\n  cursor: pointer;\n}\n.playkit-overlay .playkit-close-overlay .playkit-icon-close {\n  width: 24px;\n  height: 24px;\n}\n.playkit-overlay .playkit-overlay-screen {\n  display: none;\n}\n.playkit-overlay .playkit-overlay-screen.playkit-active {\n  display: block;\n}\n\n.playkit-player.playkit-size-md .playkit-overlay .playkit-overlay-contents {\n  padding: 36px 20px;\n}\n.playkit-player.playkit-size-md .playkit-overlay .playkit-close-overlay {\n  top: 38px;\n}\n.playkit-player.playkit-size-md .playkit-overlay .playkit-title {\n  margin-bottom: 24px;\n  margin-top: 0px;\n}\n\n.playkit-player.playkit-size-sm .playkit-overlay .playkit-overlay-contents, .playkit-player.playkit-size-xs .playkit-overlay .playkit-overlay-contents {\n  padding: 16px 24px;\n}\n.playkit-player.playkit-size-sm .playkit-overlay .playkit-close-overlay, .playkit-player.playkit-size-xs .playkit-overlay .playkit-close-overlay {\n  top: 15px;\n  right: 24px;\n}\n.playkit-player.playkit-size-sm .playkit-overlay .playkit-title, .playkit-player.playkit-size-xs .playkit-overlay .playkit-title {\n  font-size: 20px;\n  line-height: 19px;\n  margin-bottom: 24px;\n  margin-top: 0px;\n}\n\n@keyframes playkit-openSmartContainer {\n  from {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n@keyframes playkit-closeSmartContainer {\n  from {\n    opacity: 1;\n    transform: translateY(0);\n  }\n  to {\n    opacity: 0;\n    transform: translateY(10px);\n  }\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container {\n  background-color: #222222;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.3);\n  border-radius: 4px;\n  position: absolute;\n  right: 0px;\n  min-width: 193px;\n  font-size: 15px;\n  z-index: 10;\n  display: block;\n  animation: playkit-openSmartContainer 100ms ease-out forwards;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-leaving {\n  animation: playkit-closeSmartContainer 100ms ease-out forwards;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-top {\n  bottom: 100%;\n  margin-bottom: 6px;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-top:before {\n  display: block;\n  content: \" \";\n  position: absolute;\n  bottom: -6px;\n  left: 0;\n  width: 100%;\n  height: 6px;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-bottom {\n  top: 100%;\n  margin-top: 6px;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-right {\n  left: 0px;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container.playkit-left {\n  right: 0px;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item {\n  margin: 16px;\n  color: rgba(244, 244, 244, 0.8);\n  white-space: nowrap;\n  display: flex;\n  justify-content: space-between;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item label .playkit-label-icon {\n  display: none;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown,\n.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item select {\n  align-self: flex-end;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown span:not(.playkit-badge-icon) {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  vertical-align: middle;\n}\n.playkit-player:not(.playkit-touch) .playkit-smart-container .playkit-smart-container-item.playkit-select-menu-item select {\n  text-align-last: right;\n}\n\n.playkit-player.playkit-touch .playkit-smart-container-item, .playkit-player.playkit-size-sm .playkit-smart-container-item, .playkit-player.playkit-size-xs .playkit-smart-container-item {\n  width: 300px;\n  max-width: 100%;\n  margin: 16px auto;\n  color: rgba(244, 244, 244, 0.8);\n  white-space: nowrap;\n  text-align: left;\n  display: flex;\n  justify-content: space-between;\n}\n.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item label, .playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item label, .playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item label {\n  font-size: 16px;\n  color: rgba(255, 255, 255, 0.8);\n  margin-right: 20px;\n}\n.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item label .playkit-label-icon, .playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item label .playkit-label-icon, .playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item label .playkit-label-icon {\n  width: 24px;\n  height: 24px;\n  display: inline-block;\n  vertical-align: middle;\n  margin-right: 16px;\n}\n.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown,\n.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item select, .playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown,\n.playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item select, .playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item .playkit-dropdown,\n.playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item select {\n  align-self: flex-end;\n}\n.playkit-player.playkit-touch .playkit-smart-container-item.playkit-select-menu-item select, .playkit-player.playkit-size-sm .playkit-smart-container-item.playkit-select-menu-item select, .playkit-player.playkit-size-xs .playkit-smart-container-item.playkit-select-menu-item select {\n  text-align-last: right;\n  min-width: 1px;\n  line-height: 24px;\n}\n.playkit-player.playkit-touch.playkit-Windows select option, .playkit-player.playkit-size-sm.playkit-Windows select option, .playkit-player.playkit-size-xs.playkit-Windows select option {\n  color: black;\n  background-color: white;\n}\n\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample {\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n  font-size: 16px;\n  font-weight: bold;\n  line-height: 36px;\n  text-align: center;\n  padding: 0 31px;\n  display: inline-block;\n  margin: 0 12px;\n  position: relative;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample:not(.playkit-custom) {\n  cursor: pointer;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample.playkit-black-bg {\n  background-color: #000;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample.playkit-yellow-text {\n  color: #faff00;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample .playkit-active-tick {\n  height: 16px;\n  width: 16px;\n  border-radius: 8px;\n  background-color: var(--playkit-primary-color);\n  position: absolute;\n  top: -5px;\n  right: -5px;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample .playkit-active-tick .playkit-icon {\n  vertical-align: top;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-sample span {\n  font-size: 16px !important;\n  line-height: 1;\n  vertical-align: middle;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-button-save-cvaa {\n  margin-top: 50px;\n  height: 40px;\n  width: 400px;\n  max-width: 100%;\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n  font-size: 16px;\n  font-weight: bold;\n  line-height: 38px;\n  text-align: center;\n  display: inline-block;\n  color: #fff;\n  text-decoration: none;\n  cursor: pointer;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-custom-captions-applied {\n  margin-top: 50px;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-custom-captions-applied a {\n  color: var(--playkit-primary-brighter-color);\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form {\n  width: 300px;\n  max-width: 100%;\n  margin: 0 auto;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form a {\n  color: white;\n  line-height: 36px;\n  text-decoration: none;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form a:hover, .playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form a:focus {\n  text-decoration: underline;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-custom-caption-form .playkit-slider {\n  float: right;\n  width: 100px;\n  margin-top: 5px;\n}\n.playkit-overlay.playkit-cvaa-overlay .playkit-preview-container {\n  width: 100%;\n  text-align: center;\n  font-size: 16px;\n}\n\n.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-sample {\n  width: 30%;\n  margin: 2.33%;\n  padding: 0;\n}\n.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-sample:first-child {\n  margin-left: 0;\n}\n.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-sample:last-child {\n  margin-right: 0;\n}\n.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-sample.playkit-custom {\n  width: auto;\n  padding: 0 10px;\n}\n.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-button-save-cvaa,\n.playkit-player.playkit-size-sm .playkit-overlay.playkit-cvaa-overlay .playkit-custom-captions-applied {\n  margin-top: 20px;\n}\n\n.playkit-font-size,\n.playkit-font-alignment,\n.playkit-font-color,\n.playkit-font-family,\n.playkit-font-style,\n.playkit-font-opacity,\n.playkit-background-color,\n.playkit-background-opacity {\n  background: initial;\n}\n\n.playkit-loading-backdrop {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transition: 100ms opacity;\n  opacity: 0;\n  z-index: 5;\n}\n.playkit-loading-backdrop.playkit-show {\n  opacity: 1;\n}\n.playkit-loading-backdrop.playkit-show .playkit-spinner-container {\n  display: block;\n}\n.playkit-loading-backdrop .playkit-spinner-container {\n  display: none;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate3d(-50%, -50%, 0);\n}\n\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button {\n  transition: 400ms transform;\n}\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button .playkit-icon-pause {\n  transition: 400ms opacity;\n  opacity: 0;\n  display: none;\n}\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button .playkit-icon-play {\n  transition: 400ms opacity;\n  opacity: 1;\n  display: block;\n}\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button.playkit-is-playing {\n  transform: rotate(360deg);\n}\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button.playkit-is-playing .playkit-icon-pause {\n  opacity: 1;\n  display: block;\n}\n.playkit-control-button-container.playkit-control-play-pause .playkit-control-button.playkit-is-playing .playkit-icon-play {\n  opacity: 0;\n  display: none;\n}\n\n.playkit-control-button-container.playkit-control-volume, .playkit-control-button-container.playkit-volume-control {\n  display: inline-block !important;\n}\n.playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-volume-control-bar, .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-volume-control-bar {\n  display: block !important;\n  opacity: 1;\n  height: 112px;\n  padding: 6px;\n}\n.playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-volume-control-bar:before, .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-volume-control-bar:before {\n  height: 14px;\n}\n.playkit-control-button-container.playkit-control-volume.playkit-is-muted .playkit-icon-volume-waves, .playkit-control-button-container.playkit-volume-control.playkit-is-muted .playkit-icon-volume-waves {\n  opacity: 0;\n  -webkit-transform: translateX(-5px);\n  -ms-transform: translateX(-5px);\n  transform: translateX(-5px);\n}\n.playkit-control-button-container.playkit-control-volume.playkit-is-muted .playkit-icon-volume-mute, .playkit-control-button-container.playkit-volume-control.playkit-is-muted .playkit-icon-volume-mute {\n  opacity: 1;\n  -webkit-transform: scale(1);\n  -ms-transform: scale(1);\n  transform: scale(1);\n}\n.playkit-control-button-container.playkit-control-volume.playkit-dragging-active .playkit-volume-control-bar, .playkit-control-button-container.playkit-volume-control.playkit-dragging-active .playkit-volume-control-bar {\n  display: block !important;\n  opacity: 1;\n  height: 112px;\n  padding: 6px;\n}\n.playkit-control-button-container.playkit-control-volume.playkit-dragging-active .playkit-volume-control-bar:before, .playkit-control-button-container.playkit-volume-control.playkit-dragging-active .playkit-volume-control-bar:before {\n  height: 14px;\n}\n.playkit-control-button-container.playkit-control-volume .playkit-icon-volume-waves, .playkit-control-button-container.playkit-volume-control .playkit-icon-volume-waves {\n  -webkit-transform: translateX(0px);\n  -ms-transform: translateX(0px);\n  transform: translateX(0px);\n}\n.playkit-control-button-container.playkit-control-volume .playkit-icon-volume-mute, .playkit-control-button-container.playkit-volume-control .playkit-icon-volume-mute {\n  opacity: 1;\n  -webkit-transform: scale(0);\n  -ms-transform: scale(0);\n  transform: scale(0);\n}\n.playkit-control-button-container.playkit-control-volume .playkit-icon-volume-waves,\n.playkit-control-button-container.playkit-control-volume .playkit-icon-volume-mute, .playkit-control-button-container.playkit-volume-control .playkit-icon-volume-waves,\n.playkit-control-button-container.playkit-volume-control .playkit-icon-volume-mute {\n  transition: 300ms transform, 300ms opacity;\n}\n.playkit-control-button-container.playkit-control-volume i, .playkit-control-button-container.playkit-volume-control i {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n.playkit-volume-control-bar {\n  position: absolute;\n  z-index: 2;\n  bottom: 38px;\n  left: 0;\n  height: 0px;\n  width: 34px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.3);\n  background-color: #333333;\n  padding: 0px;\n  opacity: 0;\n}\n.playkit-volume-control-bar:before {\n  position: absolute;\n  width: 34px;\n  height: 0px;\n  bottom: -8px;\n  left: 0;\n  content: \" \";\n  display: block;\n}\n.playkit-volume-control-bar .playkit-bar {\n  background-color: #424242;\n  height: 100%;\n  position: relative;\n  cursor: pointer;\n}\n.playkit-volume-control-bar .playkit-progress {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  border-radius: 0 0 2px 2px;\n  background-color: var(--playkit-tone-1-color);\n}\n\n.playkit-player.playkit-smart-container-open .playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-control-volume-bar, .playkit-player.playkit-smart-container-open .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-control-volume-bar {\n  display: none !important;\n}\n\n.playkit-size-ty .playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-control-volume-bar, .playkit-size-ty .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-control-volume-bar {\n  display: none !important;\n}\n\n.playkit-touch .playkit-control-button-container.playkit-control-volume.playkit-hover .playkit-control-volume-bar, .playkit-touch .playkit-control-button-container.playkit-volume-control.playkit-hover .playkit-control-volume-bar {\n  display: none !important;\n}\n\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button {\n  transition: 100ms transform;\n  transform: scale(1);\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button .playkit-icon-minimize {\n  display: none;\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button.playkit-is-fullscreen .playkit-icon-maximize {\n  display: none;\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button.playkit-is-fullscreen .playkit-icon-minimize {\n  display: block;\n}\n\n.playkit-player:not(.playkit-touch) .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button:hover {\n  transform: scale(1.1);\n}\n\n.playkit-player .playkit-seek-bar {\n  padding: 12px 0 12px 0;\n  cursor: pointer;\n  position: relative;\n  z-index: 1;\n}\n.playkit-player .playkit-seek-bar:hover .playkit-time-preview,\n.playkit-player .playkit-seek-bar:hover .playkit-frame-preview:not(.playkit-hide-frame-preview), .playkit-player .playkit-seek-bar.playkit-hover .playkit-time-preview,\n.playkit-player .playkit-seek-bar.playkit-hover .playkit-frame-preview:not(.playkit-hide-frame-preview) {\n  display: block;\n}\n.playkit-player .playkit-seek-bar:hover .playkit-progress-bar .playkit-scrubber, .playkit-player .playkit-seek-bar.playkit-hover .playkit-progress-bar .playkit-scrubber {\n  transform: scale(1);\n}\n.playkit-player .playkit-seek-bar:hover .playkit-progress-bar .playkit-virtual-progress, .playkit-player .playkit-seek-bar.playkit-hover .playkit-progress-bar .playkit-virtual-progress {\n  display: block;\n}\n.playkit-player .playkit-seek-bar.playkit-ad-break {\n  cursor: initial;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar {\n  width: 100%;\n  height: 4px;\n  background-color: rgba(255, 255, 255, 0.3);\n  border-radius: 2px;\n  position: absolute;\n  transition: height 200ms ease, transform 200ms ease;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar.playkit-chapters {\n  background-color: transparent;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar.playkit-chapters .playkit-virtual-progress-indicator {\n  height: 8px;\n  transform: translateY(-2px);\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-virtual-progress {\n  display: none;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-virtual-progress {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  border-radius: inherit;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-virtual-progress-indicator {\n  width: 1px;\n  height: 100%;\n  background-color: var(--playkit-tone-1-color);\n  float: right;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-scrubber {\n  position: absolute;\n  cursor: pointer;\n  display: block;\n  top: -6px;\n  left: -6px;\n  border-radius: 8px;\n  height: 16px;\n  width: 16px;\n  background-color: var(--playkit-tone-1-color);\n  box-shadow: 0 0 31px 0 rgba(0, 0, 0, 0.3);\n  transform: scale(0);\n  transition: 100ms transform;\n  z-index: 1;\n  pointer-events: none;\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-scrubber:active {\n  opacity: 1;\n  cursor: grabbing;\n}\n.playkit-player .playkit-seek-bar .playkit-frame-preview {\n  position: absolute;\n  bottom: 20px;\n  left: 0;\n}\n.playkit-player .playkit-seek-bar .playkit-time-preview {\n  position: absolute;\n  bottom: 26px;\n  left: 0;\n  height: 22px;\n  min-width: 48px;\n  padding: 0 3px;\n  text-align: center;\n  border-radius: 3px;\n  background-color: rgba(0, 0, 0, 0.7);\n  font-size: 13px;\n  font-weight: bold;\n  line-height: 22px;\n  color: #fff;\n  z-index: 1;\n  pointer-events: none;\n}\n.playkit-player .playkit-seek-bar .playkit-time-preview,\n.playkit-player .playkit-seek-bar .playkit-frame-preview {\n  display: none;\n}\n.playkit-player .playkit-seek-bar .playkit-non-sticky:hover {\n  display: none;\n}\n\n.playkit-player:not(.playkit-touch):not(.playkit-size-ty) .playkit-seek-bar:hover .playkit-progress-bar:not(.playkit-chapters), .playkit-player:not(.playkit-touch):not(.playkit-size-ty) .playkit-seek-bar.playkit-hover .playkit-progress-bar:not(.playkit-chapters) {\n  height: 8px;\n  border-radius: 4px;\n  transform: translateY(-2px);\n}\n.playkit-player:not(.playkit-touch):not(.playkit-size-ty) .playkit-seek-bar:hover .playkit-progress-bar:not(.playkit-chapters) .playkit-scrubber, .playkit-player:not(.playkit-touch):not(.playkit-size-ty) .playkit-seek-bar.playkit-hover .playkit-progress-bar:not(.playkit-chapters) .playkit-scrubber {\n  top: -4px;\n}\n\n.playkit-player.playkit-touch .playkit-seek-bar .playkit-progress-bar .playkit-virtual-progress,\n.playkit-player.playkit-touch .playkit-seek-bar .playkit-progress-bar .playkit-time-preview,\n.playkit-player.playkit-touch .playkit-seek-bar .playkit-progress-bar .playkit-frame-preview {\n  display: none;\n}\n\n.playkit-player.playkit-size-ty .playkit-seek-bar {\n  padding: 12px 0;\n  cursor: pointer;\n  position: relative;\n  float: left;\n  width: calc(100% - 45px);\n  margin: 1px 0;\n}\n.playkit-player.playkit-size-ty .playkit-seek-bar .playkit-frame-preview {\n  display: none;\n}\n.playkit-player.playkit-size-ty .playkit-seek-bar .playkit-time-preview {\n  bottom: 16px;\n}\n\n.playkit-player .playkit-seek-bar.playkit-ad-break {\n  cursor: initial;\n}\n.playkit-player .playkit-seek-bar.playkit-ad-break .playkit-progress-bar .playkit-progress {\n  background-color: var(--playkit-ads-color);\n}\n.playkit-player .playkit-seek-bar.playkit-live .playkit-progress-bar .playkit-progress {\n  background-color: var(--playkit-live-color);\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-progress {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  border-radius: inherit;\n  background-color: var(--playkit-primary-color);\n}\n.playkit-player .playkit-seek-bar .playkit-progress-bar .playkit-buffered {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  border-radius: inherit;\n  background-color: rgba(255, 255, 255, 0.3);\n}\n\n.playkit-frame-preview .playkit-frame-preview-img-container {\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n}\n.playkit-frame-preview .playkit-frame-preview-img-container .playkit-frame-preview-img {\n  background-size: auto 100% !important;\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n\n.playkit-player .playkit-time-display {\n  display: inline-block;\n  line-height: 32px;\n  vertical-align: top;\n  font-size: 14px;\n  padding: 0 23px;\n  font-weight: bold;\n  filter: drop-shadow(0px 0px 2px rgba(0, 0, 0, 0.7));\n}\n\n.playkit-touch .playkit-time-display {\n  padding-left: 0;\n}\n\n.playkit-player.playkit-size-md .playkit-time-display, .playkit-player.playkit-size-sm .playkit-time-display, .playkit-player.playkit-size-xs .playkit-time-display {\n  padding: 0 12px;\n}\n\n.playkit-player .playkit-video-playing-title {\n  font-size: 15px;\n  font-weight: bold;\n  line-height: 18px;\n  padding: 6px 0;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.playkit-player .playkit-bottom-bar {\n  color: #fff;\n  height: auto;\n  width: 100%;\n  margin-top: auto;\n  bottom: 0;\n  left: 0;\n  z-index: 1;\n  pointer-events: auto;\n  position: absolute;\n  padding: 0;\n  opacity: 0;\n  max-height: 60px;\n  transition: 100ms opacity ease-in-out, 0ms padding linear 100ms;\n}\n.playkit-player .playkit-bottom-bar.playkit-hide {\n  display: none;\n}\n.playkit-player .playkit-bottom-bar .playkit-controls-container {\n  width: 100%;\n  position: relative;\n  z-index: 1;\n}\n.playkit-player .playkit-bottom-bar .playkit-controls-container .playkit-left-controls {\n  float: left;\n  text-align: left;\n  pointer-events: none;\n}\n.playkit-player .playkit-bottom-bar .playkit-controls-container .playkit-left-controls .playkit-control-button-container:first-child {\n  margin-left: 0px;\n}\n.playkit-player .playkit-bottom-bar .playkit-controls-container .playkit-right-controls {\n  float: right;\n  text-align: left;\n  pointer-events: none;\n}\n.playkit-player .playkit-bottom-bar .playkit-controls-container .playkit-right-controls .playkit-control-button-container:last-child {\n  margin-right: 0px;\n}\n.playkit-player .playkit-bottom-bar .playkit-bottom-bar-area {\n  position: relative;\n  pointer-events: none;\n}\n.playkit-player .playkit-bottom-bar .playkit-bottom-bar-area .playkit-time-display {\n  padding: 0;\n  position: absolute;\n  bottom: 20px;\n  font-size: 12px;\n  line-height: normal;\n  font-weight: 400;\n}\n.playkit-player .playkit-bottom-bar .playkit-control-button-container {\n  margin: 0 6px;\n}\n\n.playkit-player.playkit-size-ty .playkit-left-controls {\n  display: none;\n}\n.playkit-player.playkit-size-ty .playkit-control-button-container {\n  display: none;\n  margin: 0;\n}\n.playkit-player.playkit-size-xs .playkit-control-button-container:not(.playkit-upper-bar-icon), .playkit-player.playkit-size-sm .playkit-control-button-container:not(.playkit-upper-bar-icon) {\n  margin: 0 3px;\n}\n\n.playkit-player.playkit-casting:not(.playkit-overlay-active) .playkit-video-filter:after,\n.playkit-player.playkit-metadata-loaded.playkit-hover:not(.playkit-overlay-active) .playkit-video-filter:after,\n.playkit-player.playkit-state-paused:not(.playkit-overlay-active) .playkit-video-filter:after,\n.playkit-player.playkit-state-idle:not(.playkit-overlay-active) .playkit-video-filter:after,\n.playkit-player.playkit-ad-break:not(.playkit-overlay-active) .playkit-video-filter:after,\n.playkit-player.playkit-menu-active:not(.playkit-overlay-active) .playkit-video-filter:after {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 50%;\n  max-height: 200px;\n  opacity: 1;\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.8) 100%);\n  content: \"\";\n}\n.playkit-player.playkit-casting:not(.playkit-overlay-active) .playkit-bottom-bar,\n.playkit-player.playkit-metadata-loaded.playkit-hover:not(.playkit-overlay-active) .playkit-bottom-bar,\n.playkit-player.playkit-state-paused:not(.playkit-overlay-active) .playkit-bottom-bar,\n.playkit-player.playkit-state-idle:not(.playkit-overlay-active) .playkit-bottom-bar,\n.playkit-player.playkit-ad-break:not(.playkit-overlay-active) .playkit-bottom-bar,\n.playkit-player.playkit-menu-active:not(.playkit-overlay-active) .playkit-bottom-bar {\n  position: relative;\n  opacity: 1;\n  padding: 0 16px 4px;\n  transition: 100ms opacity ease-in-out;\n}\n\n.playkit-player.playkit-size-sm .playkit-playback-controls + .playkit-time-display, .playkit-player.playkit-size-xs .playkit-playback-controls + .playkit-time-display {\n  padding-left: 0;\n}\n\n.playkit-player.playkit-size-sm .playkit-bottom-bar {\n  padding: 0 8px 4px;\n}\n\n.playkit-player .playkit-bottom-bar .playkit-left-controls > *,\n.playkit-player .playkit-bottom-bar .playkit-right-controls > *,\n.playkit-player .playkit-bottom-bar .playkit-bottom-bar-area > * {\n  pointer-events: auto;\n}\n\n.playkit-video-filter:after {\n  transition: 100ms opacity ease-in-out;\n  opacity: 0;\n}\n\n.playkit-player .playkit-top-bar {\n  color: #fff;\n  visibility: hidden;\n  position: relative;\n  height: auto;\n  min-height: 60px;\n  max-height: 60px;\n  margin-top: -60px;\n  transition: 100ms visibility ease-in-out, 100ms margin-top ease-in-out, 100ms min-height ease-in-out;\n  width: 100%;\n  top: 0;\n  left: 0;\n  z-index: 2;\n  pointer-events: auto;\n}\n.playkit-player .playkit-top-bar .playkit-top-bar-area {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: calc(100% - 28px);\n  width: calc(100% - 32px);\n  margin: 14px 16px;\n  pointer-events: none;\n}\n.playkit-player .playkit-top-bar .playkit-top-bar-area:empty {\n  margin: 0;\n  height: 0;\n  width: 0;\n}\n.playkit-player .playkit-top-bar.playkit-disabled {\n  pointer-events: none;\n}\n.playkit-player .playkit-top-bar.playkit-hide {\n  display: none;\n}\n.playkit-player .playkit-top-bar .playkit-left-controls {\n  float: left;\n  text-align: left;\n  min-width: 0;\n  margin: 14px 0 14px 16px;\n  pointer-events: none;\n}\n.playkit-player .playkit-top-bar .playkit-left-controls:empty {\n  margin: 0;\n}\n.playkit-player .playkit-top-bar .playkit-right-controls {\n  float: right;\n  text-align: left;\n  margin: 14px 16px 14px 0;\n  pointer-events: none;\n}\n.playkit-player .playkit-top-bar .playkit-right-controls:empty {\n  margin: 0;\n}\n.playkit-player .playkit-top-bar .playkit-right-controls .playkit-control-button-container:not(.playkit-upper-bar-icon) {\n  margin: 0 6px;\n}\n.playkit-player .playkit-top-bar .playkit-right-controls .playkit-control-button-container:not(.playkit-upper-bar-icon):last-child {\n  margin-right: 0;\n}\n\n.playkit-player.playkit-casting:not(.playkit-overlay-active) .playkit-video-filter:before,\n.playkit-player.playkit-metadata-loaded.playkit-hover:not(.playkit-overlay-active) .playkit-video-filter:before,\n.playkit-player.playkit-state-paused:not(.playkit-overlay-active) .playkit-video-filter:before,\n.playkit-player.playkit-state-idle:not(.playkit-overlay-active) .playkit-video-filter:before,\n.playkit-player.playkit-ad-break:not(.playkit-overlay-active) .playkit-video-filter:before,\n.playkit-player.playkit-menu-active:not(.playkit-overlay-active) .playkit-video-filter:before {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 50%;\n  max-height: 200px;\n  opacity: 1;\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0) 100%);\n  content: \"\";\n}\n.playkit-player.playkit-casting:not(.playkit-overlay-active) .playkit-top-bar,\n.playkit-player.playkit-metadata-loaded.playkit-hover:not(.playkit-overlay-active) .playkit-top-bar,\n.playkit-player.playkit-state-paused:not(.playkit-overlay-active) .playkit-top-bar,\n.playkit-player.playkit-state-idle:not(.playkit-overlay-active) .playkit-top-bar,\n.playkit-player.playkit-ad-break:not(.playkit-overlay-active) .playkit-top-bar,\n.playkit-player.playkit-menu-active:not(.playkit-overlay-active) .playkit-top-bar {\n  visibility: visible;\n  margin-top: 0;\n  min-height: 16px;\n}\n\n.playkit-player .playkit-top-bar .playkit-left-controls > *,\n.playkit-player .playkit-top-bar .playkit-right-controls > *,\n.playkit-player .playkit-top-bar .playkit-top-bar-area > * {\n  pointer-events: auto;\n}\n\n.playkit-player .playkit-top-bar:has(.playkit-left-controls:empty + .playkit-right-controls:empty) {\n  visibility: hidden;\n}\n\n.playkit-player.playkit-size-sm .playkit-top-bar .playkit-left-controls {\n  margin: 14px 0 14px 8px;\n}\n.playkit-player.playkit-size-sm .playkit-top-bar .playkit-left-controls:empty {\n  margin: 0;\n}\n.playkit-player.playkit-size-sm .playkit-top-bar .playkit-right-controls {\n  margin: 14px 8px 14px 0;\n}\n.playkit-player.playkit-size-sm .playkit-top-bar .playkit-right-controls:empty {\n  margin: 0;\n}\n.playkit-player.playkit-size-sm .playkit-top-bar .playkit-top-bar-area {\n  width: calc(100% - 16px);\n  margin: 14px 8px;\n}\n.playkit-player.playkit-size-sm .playkit-top-bar .playkit-top-bar-area:empty {\n  margin: 0;\n}\n\n.playkit-video-filter:before {\n  transition: 100ms opacity ease-in-out;\n  opacity: 0;\n}\n\n@keyframes playkit-overlayActionIconIn {\n  0% {\n    opacity: 0;\n    transform: scale(0);\n  }\n  10% {\n    opacity: 0.1;\n    transform: scale(0.1);\n  }\n  20% {\n    opacity: 0.3;\n    transform: scale(0.2);\n  }\n  30% {\n    opacity: 0.5;\n    transform: scale(0.3);\n  }\n  40% {\n    opacity: 0.7;\n    transform: scale(0.4);\n  }\n  50% {\n    opacity: 0.9;\n    transform: scale(0.5);\n  }\n  60% {\n    opacity: 0.9;\n    transform: scale(0.5);\n  }\n  70% {\n    opacity: 0.9;\n    transform: scale(0.5);\n  }\n  75% {\n    opacity: 0.9;\n    transform: scale(0.5);\n  }\n  80% {\n    opacity: 1;\n    transform: scale(0.5);\n  }\n  85% {\n    opacity: 1;\n    transform: scale(0.5);\n  }\n  90% {\n    opacity: 1;\n    transform: scale(0.5);\n  }\n  93% {\n    opacity: 0.7;\n    transform: scale(0.5);\n  }\n  95% {\n    opacity: 0.5;\n    transform: scale(0.5);\n  }\n  98% {\n    opacity: 0.2;\n    transform: scale(0.5);\n  }\n  100% {\n    opacity: 0;\n    transform: scale(0.5);\n  }\n}\n.playkit-overlay-action .playkit-icon {\n  width: 144px;\n  height: 144px;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin: -72px 0 0 -72px;\n  opacity: 0;\n}\n\n.playkit-player:not(.playkit-touch):not(.playkit-size-sm) .playkit-overlay-action.playkit-in .playkit-icon {\n  animation: playkit-overlayActionIconIn 300ms linear forwards;\n}\n\n.playkit-pre-playback-play-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.playkit-pre-playback-play-overlay .playkit-pre-playback-play-button {\n  z-index: 2;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  height: 108px;\n  width: 108px;\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  background-color: rgba(0, 0, 0, 0.5);\n  transform: translate(-50%, -50%);\n  -webkit-transform: translate(-50%, -50%);\n  -ms-transform: translate(-50%, -50%);\n  border-radius: 54px;\n  padding: 20px;\n  cursor: pointer;\n}\n.playkit-pre-playback-play-overlay .playkit-pre-playback-play-button:hover {\n  border: 2px solid rgba(255, 255, 255, 0.4);\n}\n.playkit-pre-playback-play-overlay .playkit-pre-playback-play-button:active {\n  opacity: 0.7;\n  transform: scale(1) translate(-50%, -50%);\n}\n\n.playkit-pre-playback .playkit-bottom-bar,\n.playkit-pre-playback .playkit-top-bar {\n  opacity: 0;\n  display: none;\n}\n\n.playkit-player.playkit-size-ty .playkit-pre-playback-play-button {\n  width: 75px;\n  height: 75px;\n  padding: 12px;\n}\n.playkit-player.playkit-size-xs .playkit-pre-playback-play-button {\n  width: 85px;\n  height: 85px;\n  padding: 15px;\n}\n.playkit-player.playkit-overlay-active .playkit-gui-area .playkit-pre-playback-play-overlay {\n  opacity: 0;\n  visibility: hidden;\n}\n\n.playkit-player .playkit-btn-skip-ad {\n  font-weight: lighter;\n  position: absolute;\n  bottom: 60px;\n  right: 16px;\n  line-height: 36px;\n}\n.playkit-player .playkit-skip-ad {\n  color: #fff;\n  font-size: 20px;\n  font-weight: lighter;\n  line-height: 24px;\n  text-shadow: 0 0 6px rgba(0, 0, 0, 0.6);\n  position: absolute;\n  bottom: 66px;\n  right: 16px;\n}\n\n.playkit-row {\n  display: block;\n}\n.playkit-row:after {\n  content: \"\";\n  clear: both;\n  display: block;\n}\n\n.playkit-d-inline-block {\n  display: inline-block;\n}\n\n.playkit-mobile-hidden-select {\n  display: block;\n  opacity: 0;\n  position: absolute;\n  top: 0;\n  left: 0px;\n  width: 100%;\n  height: 100%;\n}\n\n.playkit-font-size-base, .playkit-ad-notice {\n  font-size: 15px;\n}\n\n.playkit-ad-notice {\n  pointer-events: none;\n}\n\n.playkit-live-tag {\n  display: inline-block;\n  background-color: var(--playkit-live-color);\n  color: #ffffff;\n  border-radius: 4px;\n  padding: 3px 4px;\n  margin: 5px 10px;\n  text-transform: uppercase;\n  font-size: 15px;\n  cursor: default;\n}\n.playkit-live-tag.playkit-non-live-playhead {\n  background-color: #666666;\n  cursor: pointer;\n}\n\n.playkit-player.playkit-size-sm .playkit-live-tag {\n  margin-left: 0;\n}\n\n.playkit-interactive-area .playkit-unmute-button-container {\n  top: 0;\n  left: 0;\n}\n\n.playkit-unmute-button-container {\n  display: inline-block;\n  position: absolute;\n  top: 16px;\n  left: 16px;\n  z-index: 15;\n}\n.playkit-unmute-button-container a {\n  color: #ffffff;\n}\n.playkit-unmute-button-container.playkit-show-icon-only .playkit-btn.playkit-unmute-button {\n  max-width: 64px;\n}\n.playkit-unmute-button-container.playkit-show-icon-only .playkit-btn.playkit-unmute-button span {\n  transform: translateX(10px);\n  opacity: 0;\n}\n\n.playkit-btn.playkit-unmute-button {\n  font-size: 15px;\n  max-width: 200px;\n  transition: max-width 200ms;\n  padding: 0 16px;\n  white-space: nowrap;\n}\n.playkit-btn.playkit-unmute-button span {\n  transform: translateX(0px);\n  opacity: 1;\n  transition: transform 100ms, opacity 100ms;\n  display: inline-block;\n  color: #ffffff;\n}\n.playkit-btn.playkit-unmute-button.playkit-has-top-bar {\n  transition: 100ms transform;\n}\n\n.playkit-unmute-icon-container {\n  width: 32px;\n  height: 32px;\n  display: inline-block;\n  vertical-align: top;\n  position: relative;\n  margin-right: 3px;\n}\n.playkit-unmute-icon-container i {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n.playkit-player.playkit-hover .playkit-unmute-button-container.playkit-has-top-bar,\n.playkit-player.playkit-state-paused .playkit-unmute-button-container.playkit-has-top-bar,\n.playkit-player.playkit-state-idle .playkit-unmute-button-container.playkit-has-top-bar,\n.playkit-player.playkit-menu-active .playkit-unmute-button-container.playkit-has-top-bar {\n  transform: translateY(32px);\n}\n\n.playkit-overlay.playkit-error-overlay {\n  background-color: var(--playkit-tone-7-color);\n  font-size: 0em;\n}\n\n.playkit-custom-error-slate .playkit-overlay.playkit-error-overlay .playkit-overlay-contents {\n  padding: 0;\n}\n\n.playkit-error-overlay {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  height: 100%;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n.playkit-error-overlay .playkit-copy-url-row {\n  display: flex;\n  align-items: center;\n  margin-bottom: 16px;\n}\n.playkit-error-overlay .playkit-headline {\n  color: var(--playkit-tone-1-color);\n  margin-bottom: 16px;\n}\n.playkit-error-overlay .playkit-headline .playkit-error-title {\n  font-weight: 700;\n  font-size: 20px;\n  font-style: normal;\n  line-height: 22px;\n  margin: 0 0 4px 0;\n  text-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);\n}\n.playkit-error-overlay .playkit-headline .playkit-error-message {\n  font-weight: 400;\n  font-size: 16px;\n  font-style: normal;\n  line-height: 22px;\n}\n.playkit-error-overlay .playkit-error-session {\n  font-size: 14px;\n  color: var(--playkit-tone-1-color);\n  font-style: normal;\n  font-weight: 400;\n  line-height: 18px;\n  user-select: text;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  -ms-user-select: text;\n  max-width: 310px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  text-shadow: 0px 4px 4px rgba(0, 0, 0, 0.25);\n}\n.playkit-error-overlay .playkit-retry-btn {\n  height: 32px;\n  width: auto;\n  min-width: 120px;\n  padding: 0 8px;\n  border-radius: 4px;\n  color: var(--playkit-tone-1-color);\n  border: none;\n  font-size: 14px;\n  font-weight: 700;\n  font-style: normal;\n  line-height: normal;\n  cursor: pointer;\n}\n.playkit-error-overlay .playkit-error-text {\n  height: 0px;\n  visibility: hidden;\n}\n\n.playkit-link-options-container {\n  width: auto;\n}\n.playkit-link-options-container .playkit-copy-url-row .playkit-input-copy-url {\n  margin: 0;\n}\n.playkit-link-options-container .playkit-copy-url-row .playkit-btn-copy-url {\n  margin-left: 8px;\n  height: 32px;\n  width: 32px;\n}\n.playkit-link-options-container .playkit-copy-url-row .playkit-btn-copy-url .playkit-icon {\n  height: 24px;\n  width: 24px;\n  margin-top: -3px;\n}\n\n.playkit-slider {\n  height: 8px;\n  border-radius: 4px;\n  background-color: rgba(255, 255, 255, 0.2);\n}\n.playkit-slider .playkit-progress {\n  background-color: var(--playkit-primary-color);\n  height: 8px;\n  border-radius: 4px;\n  position: relative;\n}\n.playkit-slider .playkit-progress .playkit-handle {\n  height: 12px;\n  width: 12px;\n  border-radius: 5px;\n  background-color: #ffffff;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.3);\n  position: absolute;\n  right: 0;\n  top: 0px;\n  transform: translate3d(6px, -2px, 0);\n  cursor: pointer;\n}\n\n.playkit-player .playkit-learn-more {\n  font-weight: lighter;\n}\n\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button {\n  transition: 100ms transform;\n  transform: scale(1);\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button .playkit-icon-minimize {\n  display: none;\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button.playkit-is-fullscreen .playkit-icon-maximize {\n  display: none;\n}\n.playkit-player .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button.playkit-is-fullscreen .playkit-icon-minimize {\n  display: block;\n}\n\n.playkit-player:not(.playkit-touch) .playkit-control-button-container.playkit-control-fullscreen .playkit-control-button:hover {\n  transform: scale(1.1);\n}\n\n.playkit-player .playkit-watermark {\n  position: absolute;\n  transition: visibility 0s 1s, opacity 1s linear, transform ease-out 100ms;\n}\n.playkit-player .playkit-watermark.playkit-hide-watermark {\n  visibility: hidden;\n  opacity: 0;\n}\n.playkit-player .playkit-watermark.playkit-top {\n  top: 0;\n}\n.playkit-player .playkit-watermark.playkit-bottom {\n  bottom: 0;\n}\n.playkit-player .playkit-watermark.playkit-right {\n  right: 0;\n}\n.playkit-player .playkit-watermark.playkit-left {\n  left: 0;\n}\n\n.playkit-control-button-container.playkit-control-vr-stereo .playkit-control-button .playkit-icon-vr-stereo-full {\n  display: none;\n}\n.playkit-control-button-container.playkit-control-vr-stereo .playkit-control-button.playkit-vr-stereo-mode .playkit-icon-vr-stereo {\n  display: none;\n}\n.playkit-control-button-container.playkit-control-vr-stereo .playkit-control-button.playkit-vr-stereo-mode .playkit-icon-vr-stereo-full {\n  display: block;\n}\n\n.playkit-control-button-container.playkit-control-closed-captions .playkit-control-button .playkit-icon-closed-captions-on {\n  display: none;\n}\n.playkit-control-button-container.playkit-control-closed-captions .playkit-control-button.playkit-cc-on .playkit-icon-closed-captions-off {\n  display: none;\n}\n.playkit-control-button-container.playkit-control-closed-captions .playkit-control-button.playkit-cc-on .playkit-icon-closed-captions-on {\n  display: block;\n}\n\n.playkit-player .playkit-cast-button {\n  display: block;\n  width: 32px;\n  height: 32px;\n  background-color: rgba(255, 255, 255, 0);\n  border: none;\n  cursor: pointer;\n  --connected-color: var(--playkit-tone-2-color);\n  --disconnected-color: var(--playkit-tone-2-color);\n}\n.playkit-player .playkit-cast-button:hover {\n  --connected-color: #ffffffff;\n  --disconnected-color: #ffffffff;\n}\n.playkit-player .playkit-cast-button.playkit-cast-button-active {\n  --connected-color: rgba(1, 172, 205, 0.8);\n}\n.playkit-player .playkit-cast-button.playkit-cast-button-active:hover {\n  --connected-color: var(--playkit-primary-color);\n}\n\n.playkit-player .playkit-cast-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.playkit-player .playkit-cast-overlay .playkit-cast-poster {\n  all: inherit;\n  background-size: contain;\n  background: black no-repeat center center;\n}\n.playkit-player .playkit-cast-overlay .playkit-cast-poster.playkit-has-poster {\n  background-color: #000;\n}\n.playkit-player .playkit-cast-overlay .playkit-cast-black-cover {\n  all: inherit;\n  background: linear-gradient(to top, rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0) 72%, rgba(0, 0, 0, 0) 100%);\n}\n.playkit-player .playkit-cast-box .playkit-cast-icon {\n  position: absolute;\n  bottom: 0;\n  left: 46px;\n  height: 128px;\n}\n.playkit-player .playkit-cast-box .playkit-cast-icon .playkit-icon {\n  width: 30px;\n  height: 22px;\n  color: rgba(255, 255, 255, 0.6);\n  opacity: 0.6;\n}\n.playkit-player .playkit-cast-box .playkit-cast-connecting-spinner {\n  height: 21px;\n  width: 21px;\n  -webkit-animation: playkit-spin 0.9s infinite linear;\n  border: 3px solid rgba(255, 255, 255, 0.4);\n  border-top-color: rgba(255, 255, 255, 0.8);\n  border-radius: 100%;\n}\n.playkit-player .playkit-cast-box .playkit-cast-text {\n  position: absolute;\n  bottom: 0;\n  left: 89px;\n  height: 128px;\n  font-weight: lighter;\n}\n.playkit-player .playkit-cast-box .playkit-cast-text .playkit-cast-status {\n  display: inline-block;\n  margin-top: 3px;\n  font-size: 16px;\n  color: rgba(255, 255, 255, 0.6);\n  float: left;\n  font-weight: inherit;\n}\n.playkit-player .playkit-cast-box .playkit-cast-text .playkit-cast-device {\n  left: 0;\n  display: inline-block;\n  font-weight: inherit;\n  font-size: 25px;\n  color: #ffffff;\n  line-height: 40px;\n}\n\n@keyframes playkit-castOnTVAnimation {\n  0% {\n    opacity: 0;\n    transform: rotateY(70deg);\n  }\n  33% {\n    opacity: 0.3;\n    transform: rotateY(50deg);\n  }\n  66% {\n    opacity: 0.6;\n    transform: rotateY(30deg);\n  }\n  100% {\n    opacity: 1;\n    transform: rotateY(0);\n  }\n}\n.playkit-player .playkit-cast-on-tv-button-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n}\n.playkit-player .playkit-cast-on-tv-button-container span {\n  font-weight: lighter;\n  color: white;\n}\n.playkit-player .playkit-cast-on-tv-button-container.playkit-show-cast-on-tv {\n  animation: playkit-castOnTVAnimation 300ms linear forwards;\n}\n.playkit-player .playkit-btn.playkit-cast-on-tv-button {\n  font-size: 15px;\n  max-width: 200px;\n  transition: max-width 200ms;\n  padding: 0 16px;\n  white-space: nowrap;\n  position: absolute;\n  bottom: 0;\n  transform: translate(-50%, -50%);\n  left: 50%;\n}\n.playkit-player .playkit-btn.playkit-cast-on-tv-button span {\n  transform: translateX(0px);\n  opacity: 1;\n  transition: transform 100ms, opacity 100ms;\n  display: inline-block;\n}\n.playkit-player .playkit-cast-on-tv-icon-container {\n  width: 32px;\n  height: 32px;\n  display: inline-block;\n  vertical-align: top;\n  position: relative;\n  margin-right: 3px;\n}\n.playkit-player .playkit-cast-on-tv-icon-container i {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview {\n  position: absolute;\n  bottom: 35px;\n  width: 280px;\n  height: 72px;\n  display: flex;\n  border-radius: 4px;\n  box-shadow: 0px 0px 0px 1px rgba(0, 0, 0, 0.2), 0px 8px 60px -16px rgba(0, 0, 0, 0.2);\n  opacity: 0;\n  transition: 400ms opacity;\n  pointer-events: none;\n}\n.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview:hover {\n  opacity: 0 !important;\n}\n.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview .playkit-poster-preview-img {\n  width: 128px;\n  height: inherit;\n  border-radius: 4px 0 0 4px;\n  background-size: contain;\n  background-repeat: round;\n}\n.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview .playkit-poster-preview-text {\n  width: 152px;\n  height: inherit;\n  padding: 8px;\n  background-color: rgba(0, 0, 0, 0.7);\n  border-radius: 0 4px 4px 0;\n}\n.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview .playkit-poster-preview-text .playkit-poster-preview-text-title {\n  font-size: 14px;\n  font-weight: 400;\n  margin-bottom: 3px;\n  opacity: 0.7;\n}\n.playkit-control-button-container.playkit-control-playlist-button .playkit-poster-preview .playkit-poster-preview-text .playkit-poster-preview-text-name {\n  font-size: 15px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-weight: 400;\n}\n.playkit-control-button-container.playkit-control-playlist-button:hover .playkit-poster-preview {\n  opacity: 1;\n}\n\n.playkit-icon-picture-in-picture-stop {\n  display: none;\n}\n\n.playkit-is-in-picture-in-picture .playkit-icon-picture-in-picture-start {\n  display: none;\n}\n.playkit-is-in-picture-in-picture .playkit-icon-picture-in-picture-stop {\n  display: block;\n}\n\n.playkit-player-gui > .playkit-playback-controls,\n.playkit-center-playback-controls {\n  display: none;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  -webkit-transform: translate(-50%, -50%);\n  -ms-transform: translate(-50%, -50%);\n  white-space: nowrap;\n  z-index: 1;\n}\n\n.playkit-bottom-bar .playkit-playback-controls {\n  display: inline;\n}\n\n.playkit-player.playkit-size-sm.playkit-state-idle .playkit-control-playlist-button, .playkit-player.playkit-size-xs.playkit-state-idle .playkit-control-playlist-button, .playkit-player.playkit-touch.playkit-state-idle .playkit-control-playlist-button {\n  display: none;\n}\n.playkit-player.playkit-size-sm:not(.playkit-state-idle) .playkit-bottom-bar .playkit-playback-controls, .playkit-player.playkit-size-xs:not(.playkit-state-idle) .playkit-bottom-bar .playkit-playback-controls, .playkit-player.playkit-touch:not(.playkit-state-idle) .playkit-bottom-bar .playkit-playback-controls {\n  display: none;\n}\n.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls,\n.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls, .playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls,\n.playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls, .playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls,\n.playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls {\n  display: block;\n}\n.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls .playkit-control-button,\n.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls .playkit-control-button, .playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls .playkit-control-button,\n.playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls .playkit-control-button, .playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls .playkit-control-button,\n.playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls .playkit-control-button {\n  width: auto;\n  height: auto;\n  padding: 0 16px;\n  -webkit-filter: drop-shadow(0px 0px 8px rgba(0, 0, 0, 0.5));\n  filter: drop-shadow(0px 0px 8px rgba(0, 0, 0, 0.5));\n}\n.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls .playkit-icon,\n.playkit-player.playkit-size-sm:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls .playkit-icon, .playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls .playkit-icon,\n.playkit-player.playkit-size-xs:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls .playkit-icon, .playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-player-gui > .playkit-playback-controls .playkit-icon,\n.playkit-player.playkit-touch:not(.playkit-state-idle).playkit-hover .playkit-center-playback-controls .playkit-icon {\n  width: 64px;\n  height: 64px;\n}\n.playkit-player.playkit-overlay-active .playkit-gui-area .playkit-playback-controls {\n  opacity: 0;\n  visibility: hidden;\n}\n\n@keyframes playkit-slideIn {\n  0% {\n    right: -160px;\n  }\n  100% {\n    right: 0;\n  }\n}\n.playkit-player .playkit-playlist-countdown {\n  display: flex;\n  height: 72px;\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  border-radius: 4px;\n  transition: opacity 400ms, bottom 300ms;\n  cursor: pointer;\n  box-shadow: 0px 0px 0px 1px rgba(0, 0, 0, 0.2), 0px 8px 60px -16px rgba(0, 0, 0, 0.2);\n}\n.playkit-player .playkit-playlist-countdown.playkit-slideIn {\n  right: -160px;\n  animation: playkit-slideIn 500ms 500ms forwards;\n}\n.playkit-player .playkit-playlist-countdown.playkit-hidden {\n  pointer-events: none;\n  opacity: 0;\n}\n.playkit-player .playkit-playlist-countdown.playkit-hidden .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background {\n  width: 0;\n}\n.playkit-player .playkit-playlist-countdown.playkit-hidden .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content {\n  opacity: 0;\n}\n.playkit-player .playkit-playlist-countdown.playkit-canceled {\n  bottom: -50px;\n  opacity: 0;\n}\n.playkit-player .playkit-playlist-countdown:hover .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background {\n  background-color: #000000;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-poster {\n  width: 128px;\n  height: inherit;\n  border-radius: 4px 0 0 4px;\n  background-size: contain;\n  background-repeat: round;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder {\n  width: 152px;\n  height: inherit;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background {\n  width: inherit;\n  border-radius: 0 4px 3px 0;\n  background-color: rgba(0, 0, 0, 0.7);\n  height: inherit;\n  transition: width 500ms 1000ms;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content {\n  width: inherit;\n  transition: opacity 300ms 1200ms;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text {\n  width: 100%;\n  padding: 10px;\n  font-size: 14px;\n  font-weight: 400;\n  text-align: left;\n  color: #fff;\n  float: left;\n  line-height: initial;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title {\n  margin-bottom: 12px;\n  opacity: 0.7;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title .playkit-playlist-countdown-time-left {\n  display: inline;\n  margin-left: 4px;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-name {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel {\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  width: 24px;\n  height: 24px;\n}\n.playkit-player .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel * {\n  width: inherit;\n  height: inherit;\n}\n.playkit-player.playkit-size-md .playkit-playlist-countdown {\n  height: 54px;\n}\n.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-poster {\n  width: 96px;\n}\n.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder {\n  width: 152px;\n}\n.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text {\n  padding: 8px;\n}\n.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title {\n  margin-bottom: 4px;\n}\n.playkit-player.playkit-size-md .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel {\n  top: 3px;\n  right: 3px;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown, .playkit-player.playkit-size-xs .playkit-playlist-countdown, .playkit-player.playkit-size-ty .playkit-playlist-countdown {\n  z-index: 1;\n  height: 36px;\n  margin: 8px;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-poster, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-poster, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-poster {\n  display: none;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder {\n  width: 108px;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background {\n  transition: width 500ms;\n  border-radius: 2px;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text {\n  width: 90%;\n  padding: 3px 0 0 4px;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-title {\n  font-size: 12px;\n  margin-bottom: 0;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-name, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-name, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-text .playkit-playlist-countdown-text-name {\n  font-size: 12px;\n  font-weight: 400;\n}\n.playkit-player.playkit-size-sm .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel, .playkit-player.playkit-size-xs .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel, .playkit-player.playkit-size-ty .playkit-playlist-countdown .playkit-playlist-countdown-content-placeholder .playkit-playlist-countdown-content-background .playkit-playlist-countdown-content .playkit-playlist-countdown-cancel {\n  top: 0;\n  right: 0;\n}\n\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content {\n  position: relative;\n  top: 50%;\n  transform: translateY(-50%);\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text {\n  position: absolute;\n  width: 100%;\n  top: -90px;\n  font-size: 15px;\n  color: #fff;\n  padding: 4px 8px 12px 8px;\n  text-align: center;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text .playkit-playlist-next-screen-text-title {\n  padding: 4px;\n  font-weight: 100;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text .playkit-playlist-next-screen-text-name {\n  padding: 16px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder {\n  position: relative;\n  margin: auto;\n  width: 384px;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio {\n  width: 100%;\n  padding-top: 56%;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n  cursor: pointer;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-playlist-next-screen-poster-img {\n  height: 100%;\n  border-radius: 3px;\n  background-size: contain;\n  background-repeat: round;\n}\n.playkit-player.playkit-state-idle .playkit-playlist-next-screen-overlay .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-icon {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 64px;\n  height: 64px;\n}\n.playkit-player.playkit-state-idle.playkit-size-lg .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder {\n  width: 37.5%;\n}\n.playkit-player.playkit-state-idle.playkit-size-md .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text {\n  top: -58px;\n}\n.playkit-player.playkit-state-idle.playkit-size-md .playkit-playlist-next-screen-content .playkit-playlist-next-screen-text .playkit-playlist-next-screen-text-name {\n  padding: 0;\n}\n.playkit-player.playkit-state-idle.playkit-size-md .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder {\n  width: 42%;\n}\n.playkit-player.playkit-state-idle.playkit-size-sm .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder, .playkit-player.playkit-state-idle.playkit-size-xs .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder, .playkit-player.playkit-state-idle.playkit-size-ty .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder {\n  width: 32px;\n}\n.playkit-player.playkit-state-idle.playkit-size-sm .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster, .playkit-player.playkit-state-idle.playkit-size-xs .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster, .playkit-player.playkit-state-idle.playkit-size-ty .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster {\n  border: 0;\n}\n.playkit-player.playkit-state-idle.playkit-size-sm .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-playlist-next-screen-poster-img, .playkit-player.playkit-state-idle.playkit-size-xs .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-playlist-next-screen-poster-img, .playkit-player.playkit-state-idle.playkit-size-ty .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-playlist-next-screen-poster-img {\n  display: none;\n}\n.playkit-player.playkit-state-idle.playkit-size-sm .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-icon, .playkit-player.playkit-state-idle.playkit-size-xs .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-icon, .playkit-player.playkit-state-idle.playkit-size-ty .playkit-playlist-next-screen-content .playkit-playlist-next-screen-poster-placeholder .playkit-playlist-next-screen-poster-aspect-ratio .playkit-playlist-next-screen-poster .playkit-icon {\n  width: 32px;\n  height: 32px;\n}\n\n.playkit-picture-in-picture-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-poster {\n  all: inherit;\n  background-size: contain;\n  background: black no-repeat center center;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-poster.playkit-has-poster {\n  background-color: #000;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-poster .playkit-dark-layer {\n  background-color: rgba(0, 0, 0, 0.4);\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-control {\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-control::after {\n  content: \"\";\n  flex: 3;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-control::before {\n  content: \"\";\n  flex: 1;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-text {\n  color: var(--playkit-tone-1-color);\n  font-size: 18px;\n  white-space: nowrap;\n  overflow: hidden;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-button {\n  height: 36px;\n  width: 120px;\n  border: 2px solid var(--playkit-tone-6-color);\n  border-radius: 18px;\n  background-color: var(--playkit-tone-7-color);\n  color: var(--playkit-tone-1-color);\n  font-size: 15px;\n  font-weight: bold;\n  line-height: 30px;\n  cursor: pointer;\n  margin-top: 20px;\n  align-self: center;\n}\n.playkit-picture-in-picture-overlay .playkit-picture-in-picture-button:hover {\n  background-color: var(--playkit-tone-6-color);\n}\n\n.playkit-copy-url-row .playkit-input-copy-url {\n  margin: 0;\n}\n.playkit-copy-url-row .playkit-btn-copy-url {\n  margin: 0 8px;\n}\n.playkit-copy-url-row .playkit-btn-copy-url .playkit-icon {\n  height: 24px;\n  width: 24px;\n  margin-top: -3px;\n  display: none;\n}\n.playkit-copy-url-row .playkit-btn-copy-url .playkit-icon-copy {\n  display: block;\n}\n.playkit-copy-url-row .playkit-btn-copy-url.playkit-copied .playkit-icon-copy {\n  display: none;\n}\n.playkit-copy-url-row .playkit-btn-copy-url.playkit-copied .playkit-icon-check {\n  display: block;\n}\n\n.playkit-IE.playkit-player .playkit-tooltip .playkit-tooltip-label {\n  white-space: nowrap;\n}\n\n.playkit-player .playkit-tooltip {\n  position: relative;\n  display: inline-block;\n  height: 100%;\n  width: 100%;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label {\n  visibility: hidden;\n  background-color: var(--playkit-tooltip-background-color);\n  color: var(--playkit-tooltip-color);\n  text-align: center;\n  padding: 4px 6px;\n  border-radius: 4px;\n  position: absolute;\n  line-height: normal;\n  font-weight: bold;\n  font-size: 13px;\n  opacity: 0;\n  transition: opacity 1s;\n  width: max-content;\n  display: table;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label:before {\n  content: \"\";\n  position: absolute;\n  border-width: 5px;\n  border-style: solid;\n  border-radius: 3px;\n  color: var(--playkit-tooltip-background-color);\n  z-index: -1;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label:after {\n  content: \"\";\n  position: absolute;\n  inset: -1em;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top {\n  bottom: calc(100% + 10px);\n  left: 50%;\n  transform: translate(-50%);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top:before {\n  bottom: -4px;\n  left: 50%;\n  transform: translate(-50%) rotate(45deg) skew(5deg, 5deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top-left {\n  bottom: calc(100% + 10px);\n  left: 50%;\n  transform: translate(-100%);\n  margin-left: 16px;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top-left:before {\n  bottom: -4px;\n  right: 0;\n  margin-right: 11px;\n  transform: rotate(45deg) skew(5deg, 5deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top-right {\n  bottom: calc(100% + 10px);\n  left: 50%;\n  transform: translate(-16px);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-top-right:before {\n  bottom: -4px;\n  left: 0;\n  margin-left: 11px;\n  transform: rotate(45deg) skew(5deg, 5deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom {\n  top: calc(100% + 10px);\n  left: 50%;\n  transform: translate(-50%);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom:before {\n  top: -4px;\n  left: 50%;\n  margin-left: -5px;\n  transform: rotate(45deg) skew(5deg, 5deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom-right {\n  top: calc(100% + 10px);\n  left: 50%;\n  transform: translate(-16px);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom-right:before {\n  top: -4px;\n  left: 0;\n  margin-left: 11px;\n  transform: rotate(45deg) skew(5deg, 5deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom-left {\n  top: calc(100% + 10px);\n  transform: translate(-100%);\n  left: 50%;\n  margin-left: 16px;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-bottom-left:before {\n  top: -4px;\n  right: 0;\n  margin-right: 11px;\n  transform: rotate(45deg) skew(5deg, 5deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-left {\n  top: 50%;\n  right: calc(100% + 10px);\n  transform: translate(0, -50%);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-left:before {\n  top: 50%;\n  left: 100%;\n  margin-left: -6px;\n  margin-top: -5px;\n  transform: rotate(135deg) skew(10deg, 10deg);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-right {\n  top: 50%;\n  left: calc(100% + 10px);\n  transform: translate(0, -50%);\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-tooltip-right:before {\n  top: 50%;\n  right: 100%;\n  margin-top: -5px;\n  margin-right: -6px;\n  transform: rotate(135deg) skew(10deg, 10deg);\n}\n\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-show {\n  visibility: visible;\n  opacity: 1;\n}\n.playkit-player .playkit-tooltip .playkit-tooltip-label.playkit-hide {\n  transition: opacity 0.15s ease-in-out;\n}\n\n.playkit-side-panel {\n  position: absolute;\n  transition: all 500ms;\n  transition-property: left, right, bottom, top, opacity;\n  z-index: 0;\n}\n.playkit-side-panel.playkit-small-size {\n  z-index: 2;\n}\n\n.playkit-vertical-side-panel {\n  height: 100%;\n}\n\n.playkit-horizontal-side-panel {\n  height: 0;\n  left: 0;\n  right: 0;\n}\n\n.playkit-side-panel-content {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n\n.playkit-player.playkit-overlay-active .playkit-interactive-area {\n  filter: blur(16px);\n}\n\n.playkit-interactive-area {\n  pointer-events: none;\n  position: relative;\n  top: 0;\n  margin: 16px;\n  transition: margin 100ms ease-in-out;\n  flex: 1;\n}\n\n.playkit-player.playkit-size-sm .playkit-interactive-area {\n  margin: 8px;\n}\n.playkit-player.playkit-casting:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area, .playkit-player.playkit-metadata-loaded.playkit-hover:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area, .playkit-player.playkit-state-paused:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area, .playkit-player.playkit-state-idle:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area, .playkit-player.playkit-ad-break:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area, .playkit-player.playkit-menu-active:not(.playkit-overlay-active).playkit-size-sm .playkit-interactive-area {\n  margin: 0px 8px;\n}\n.playkit-player.playkit-casting .playkit-interactive-area, .playkit-player.playkit-metadata-loaded.playkit-hover .playkit-interactive-area, .playkit-player.playkit-state-paused .playkit-interactive-area, .playkit-player.playkit-state-idle .playkit-interactive-area, .playkit-player.playkit-ad-break .playkit-interactive-area, .playkit-player.playkit-menu-active .playkit-interactive-area {\n  margin: 0px 16px;\n}\n\n.playkit-video-area {\n  pointer-events: none;\n  transition: all 500ms;\n  transition-property: left, right, bottom, top, width, height;\n}\n\n.playkit-gui-area {\n  pointer-events: none;\n  transition: all 500ms;\n  transition-property: left, right, bottom, top;\n  display: flex;\n  flex-flow: column nowrap;\n}\n\n@keyframes playkit-kaltura-spinner {\n  0% {\n    transform: rotate(0deg) scale(0.7);\n    opacity: 1;\n  }\n  70% {\n    transform: rotate(360deg) scale(0.7);\n    opacity: 1;\n  }\n  82% {\n    transform: rotate(360deg) scale(0);\n    opacity: 0;\n  }\n  87% {\n    transform: rotate(360deg) scale(0.9);\n    opacity: 1;\n  }\n  100% {\n    transform: rotate(360deg) scale(0.7);\n    opacity: 1;\n  }\n}\n.playkit-spinner {\n  width: 100px;\n  height: 100px;\n  position: relative;\n  animation: playkit-kaltura-spinner 2.5s infinite;\n}\n.playkit-spinner span {\n  width: 8px;\n  height: 8px;\n  background-color: #fff;\n  display: block;\n  border-radius: 8px;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin-top: -4px;\n  margin-left: -4px;\n}\n.playkit-spinner span:nth-child(1) {\n  transform: rotate(45deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(218, 31, 38);\n}\n.playkit-spinner span:nth-child(2) {\n  transform: rotate(90deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(6, 168, 133);\n}\n.playkit-spinner span:nth-child(3) {\n  transform: rotate(135deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(0, 147, 68);\n}\n.playkit-spinner span:nth-child(4) {\n  transform: rotate(180deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(248, 166, 26);\n}\n.playkit-spinner span:nth-child(5) {\n  transform: rotate(225deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(27, 74, 151);\n}\n.playkit-spinner span:nth-child(6) {\n  transform: rotate(270deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(0, 171, 204);\n}\n.playkit-spinner span:nth-child(7) {\n  transform: rotate(315deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(177, 210, 56);\n}\n.playkit-spinner span:nth-child(8) {\n  transform: rotate(360deg) translateX(-25px) translateY(-25px);\n  background-color: rgb(252, 210, 3);\n}\n\n.playkit-switch {\n  position: relative;\n  display: inline-block;\n  width: 32px;\n  height: 16px;\n}\n.playkit-switch .playkit-toggle-input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n.playkit-switch .playkit-toggle-input:checked + .playkit-slider {\n  background-color: #2196f3;\n}\n.playkit-switch .playkit-toggle-input:focus + .playkit-slider {\n  box-shadow: 0 0 1px #2196f3;\n}\n.playkit-switch .playkit-toggle-input:checked + .playkit-slider:before {\n  transform: translateX(14px);\n  -webkit-transform: translateX(14px);\n  -ms-transform: translateX(14px);\n}\n.playkit-switch .playkit-slider {\n  height: 100%;\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #ccc;\n  -webkit-transition: 0.4s;\n  transition: 0.4s;\n  border-radius: 34px;\n}\n.playkit-switch .playkit-slider:before {\n  position: absolute;\n  content: \"\";\n  height: 12px;\n  width: 12px;\n  left: 3px;\n  top: 2px;\n  background-color: white;\n  -webkit-transition: 0.3s;\n  transition: 0.3s;\n  border-radius: 50%;\n}\n\n.playkit-player .playkit-audio-entry-backdrop {\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.7) 100%);\n  bottom: 0;\n  left: 0;\n  position: absolute;\n  width: 100%;\n  pointer-events: none;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details {\n  margin: 128px 16px 60px 16px;\n  left: 16px;\n  color: white;\n  max-height: 100%;\n  pointer-events: auto;\n  z-index: 1;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details.playkit-audio-entry-l {\n  max-width: 600px;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details.playkit-audio-entry-m {\n  max-width: min(600px, 100%);\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details.playkit-audio-entry-t {\n  max-width: 0px;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details.playkit-audio-entry-t .playkit-audio-entry-description {\n  font-size: 0;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details .playkit-audio-entry-title {\n  font-size: 32px;\n  line-height: 38px;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details .playkit-audio-entry-title.playkit-audio-entry-title-trimmed {\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 1;\n  display: -webkit-box;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.playkit-player .playkit-audio-entry-backdrop .playkit-audio-entry-details .playkit-audio-entry-description {\n  font-size: 14px;\n  line-height: 18px;\n}\n.playkit-player .playkit-audio-entry-backdrop.playkit-audio-entry-expanded {\n  overflow: auto;\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.7) 100%);\n  height: auto;\n}\n.playkit-player .playkit-audio-entry-backdrop.playkit-audio-entry-expanded .playkit-audio-entry-details {\n  overflow: auto;\n  margin: 60px 16px;\n}\n\n.playkit-player .playkit-expandable-text {\n  text-overflow: ellipsis;\n  overflow: hidden;\n  -webkit-box-orient: vertical;\n  display: -webkit-box;\n}\n.playkit-player .playkit-more-button-text {\n  pointer-events: auto;\n  cursor: pointer;\n  position: relative;\n  z-index: 1;\n  width: fit-content;\n  outline-offset: -1px;\n}\n\n.playkit-scrollable {\n  display: flex;\n  width: 100%;\n}\n.playkit-scrollable .playkit-items-container {\n  display: flex;\n  width: 100%;\n  height: fit-content;\n}\n.playkit-scrollable.playkit-horizontal {\n  flex-direction: row;\n  overflow: auto hidden;\n}\n.playkit-scrollable.playkit-horizontal .playkit-items-container {\n  flex-direction: row;\n}\n.playkit-scrollable.playkit-vertical {\n  flex-direction: column;\n  height: 100%;\n  overflow: hidden auto;\n}\n.playkit-scrollable.playkit-vertical .playkit-items-container {\n  flex-direction: column;\n}\n.playkit-scrollable::-webkit-scrollbar {\n  height: 4px;\n  width: 4px;\n}\n.playkit-scrollable::-webkit-scrollbar-track {\n  visibility: hidden;\n}\n.playkit-scrollable::-webkit-scrollbar-thumb {\n  background-color: rgba(255, 255, 255, 0.3);\n  border-radius: 3px;\n  visibility: hidden;\n}\n.playkit-scrollable.playkit-scrolling::-webkit-scrollbar-track, .playkit-scrollable.playkit-scrolling::-webkit-scrollbar-thumb {\n  visibility: visible;\n}",""]),e.locals={primaryColor:"var(--playkit-primary-color)",primaryDarkerColor:"var(--playkit-primary-darker-color)",primaryBrighterColor:"var(--playkit-primary-brighter-color)",primaryTextContrastColor:"var(--playkit-primary-text-contrast-color)",secondaryColor:"var(--playkit-secondary-color)",secondaryDarkerColor:"var(--playkit-secondary-darker-color)",secondaryBrighterColor:"var(--playkit-secondary-brighter-color)",secondaryTextContrastColor:"var(--playkit-secondary-text-contrast-color)",successDarkerColor:"var(--playkit-success-darker-color)",successBrighterColor:"var(--playkit-success-brighter-color)",successTextContrastColor:"var(--playkit-success-text-contrast-color)",dangerColor:"var(--playkit-danger-color)",dangerDarkerColor:"var(--playkit-danger-darker-color)",dangerBrighterColor:"var(--playkit-danger-brighter-color)","danger-text-contrast-color":"var(--playkit-danger-text-contrast-color)",dangerTextContrastColor:"var(--playkit-danger-text-contrast-color)",warningColor:"var(--playkit-warning-color)",warningDarkerColor:"var(--playkit-warning-darker-color)",warningBrighterColor:"var(--playkit-warning-brighter-color)",warningTextContrastColor:"var(--playkit-warning-text-contrast-color)",tone1Color:"var(--playkit-tone-1-color)",tone2Color:"var(--playkit-tone-2-color)",tone3Color:"var(--playkit-tone-3-color)",tone4Color:"var(--playkit-tone-4-color)",tone5Color:"var(--playkit-tone-5-color)",tone6Color:"var(--playkit-tone-6-color)",tone7Color:"var(--playkit-tone-7-color)",tone8Color:"var(--playkit-tone-8-color)",liveColor:"var(--playkit-live-color)",playerBackgroundColor:"var(--playkit-player-background-color)",tabFocusColor:"var(--playkit-tab-focus-color)",tooltipBackgroundColor:"var(--playkit-tooltip-background-color)",tooltipColor:"var(--playkit-tooltip-color)",adsColor:"var(--playkit-ads-color)",progressBarHeight:"4px",progressBarBorderRadius:"2px",defaultTransitionTime:"500",bottomBarMaxHeight:"60",topBarMaxHeight:"60",brandColor:"#006bff",white:"#ffffff",player:"playkit-player",row:"playkit-row","d-inline-block":"playkit-d-inline-block",dInlineBlock:"playkit-d-inline-block","mobile-hidden-select":"playkit-mobile-hidden-select",mobileHiddenSelect:"playkit-mobile-hidden-select","font-size-base":"playkit-font-size-base",fontSizeBase:"playkit-font-size-base","ad-notice":"playkit-ad-notice",adNotice:"playkit-ad-notice","form-group":"playkit-form-group",formGroup:"playkit-form-group","has-error":"playkit-has-error",hasError:"playkit-has-error","form-control":"playkit-form-control",formControl:"playkit-form-control","has-icon":"playkit-has-icon",hasIcon:"playkit-has-icon",icon:"playkit-icon",checkbox:"playkit-checkbox","form-group-row":"playkit-form-group-row",formGroupRow:"playkit-form-group-row",dropdown:"playkit-dropdown",btn:"playkit-btn","btn-block":"playkit-btn-block",btnBlock:"playkit-btn-block","btn-dark-transparent":"playkit-btn-dark-transparent",btnDarkTransparent:"playkit-btn-dark-transparent","btn-branded":"playkit-btn-branded",btnBranded:"playkit-btn-branded","btn-rounded":"playkit-btn-rounded",btnRounded:"playkit-btn-rounded","btn-borderless":"playkit-btn-borderless",btnBorderless:"playkit-btn-borderless","only-icon":"playkit-only-icon",onlyIcon:"playkit-only-icon","only-label":"playkit-only-label",onlyLabel:"playkit-only-label","btn-translucent":"playkit-btn-translucent",btnTranslucent:"playkit-btn-translucent","size-sm":"playkit-size-sm",sizeSm:"playkit-size-sm","size-xs":"playkit-size-xs",sizeXs:"playkit-size-xs","badge-icon":"playkit-badge-icon",badgeIcon:"playkit-badge-icon","icon-maximize":"playkit-icon-maximize",iconMaximize:"playkit-icon-maximize","icon-minimize":"playkit-icon-minimize",iconMinimize:"playkit-icon-minimize","icon-play":"playkit-icon-play",iconPlay:"playkit-icon-play","icon-pause":"playkit-icon-pause",iconPause:"playkit-icon-pause","icon-volume-base":"playkit-icon-volume-base",iconVolumeBase:"playkit-icon-volume-base","icon-volume-waves":"playkit-icon-volume-waves",iconVolumeWaves:"playkit-icon-volume-waves","icon-volume-wave":"playkit-icon-volume-wave",iconVolumeWave:"playkit-icon-volume-wave","icon-volume-mute":"playkit-icon-volume-mute",iconVolumeMute:"playkit-icon-volume-mute","icon-close":"playkit-icon-close",iconClose:"playkit-icon-close","icon-settings":"playkit-icon-settings",iconSettings:"playkit-icon-settings","icon-check":"playkit-icon-check",iconCheck:"playkit-icon-check","icon-check-active":"playkit-icon-check-active",iconCheckActive:"playkit-icon-check-active","icon-language":"playkit-icon-language",iconLanguage:"playkit-icon-language","icon-quality":"playkit-icon-quality",iconQuality:"playkit-icon-quality","icon-captions":"playkit-icon-captions",iconCaptions:"playkit-icon-captions","icon-speed":"playkit-icon-speed",iconSpeed:"playkit-icon-speed","icon-speed-down":"playkit-icon-speed-down",iconSpeedDown:"playkit-icon-speed-down","icon-speed-up":"playkit-icon-speed-up",iconSpeedUp:"playkit-icon-speed-up","icon-audio":"playkit-icon-audio",iconAudio:"playkit-icon-audio","icon-arrow-down":"playkit-icon-arrow-down",iconArrowDown:"playkit-icon-arrow-down","icon-start-over":"playkit-icon-start-over",iconStartOver:"playkit-icon-start-over","icon-seek-end":"playkit-icon-seek-end",iconSeekEnd:"playkit-icon-seek-end","icon-rewind":"playkit-icon-rewind",iconRewind:"playkit-icon-rewind","icon-rewind-10":"playkit-icon-rewind-10",iconRewind10:"playkit-icon-rewind-10","icon-forward":"playkit-icon-forward",iconForward:"playkit-icon-forward","icon-forward-10":"playkit-icon-forward-10",iconForward10:"playkit-icon-forward-10","icon-vr-stereo":"playkit-icon-vr-stereo",iconVrStereo:"playkit-icon-vr-stereo","icon-vr-stereo-full":"playkit-icon-vr-stereo-full",iconVrStereoFull:"playkit-icon-vr-stereo-full","icon-chromecast":"playkit-icon-chromecast",iconChromecast:"playkit-icon-chromecast","icon-chromecast-brand":"playkit-icon-chromecast-brand",iconChromecastBrand:"playkit-icon-chromecast-brand","icon-next":"playkit-icon-next",iconNext:"playkit-icon-next","icon-prev":"playkit-icon-prev",iconPrev:"playkit-icon-prev","icon-picture-in-picture-start":"playkit-icon-picture-in-picture-start",iconPictureInPictureStart:"playkit-icon-picture-in-picture-start","icon-picture-in-picture-stop":"playkit-icon-picture-in-picture-stop",iconPictureInPictureStop:"playkit-icon-picture-in-picture-stop","icon-advanced-audio-description":"playkit-icon-advanced-audio-description",iconAdvancedAudioDescription:"playkit-icon-advanced-audio-description","icon-advanced-audio-description-active":"playkit-icon-advanced-audio-description-active",iconAdvancedAudioDescriptionActive:"playkit-icon-advanced-audio-description-active","icon-quality-hd":"playkit-icon-quality-hd",iconQualityHd:"playkit-icon-quality-hd","icon-quality-hd-active":"playkit-icon-quality-hd-active",iconQualityHdActive:"playkit-icon-quality-hd-active","icon-quality-4k":"playkit-icon-quality-4k",iconQuality4K:"playkit-icon-quality-4k","icon-quality-4k-active":"playkit-icon-quality-4k-active",iconQuality4KActive:"playkit-icon-quality-4k-active","icon-quality-8k":"playkit-icon-quality-8k",iconQuality8K:"playkit-icon-quality-8k","icon-quality-8k-active":"playkit-icon-quality-8k-active",iconQuality8KActive:"playkit-icon-quality-8k-active","icon-closed-captions-on":"playkit-icon-closed-captions-on",iconClosedCaptionsOn:"playkit-icon-closed-captions-on","icon-closed-captions-off":"playkit-icon-closed-captions-off",iconClosedCaptionsOff:"playkit-icon-closed-captions-off","label-badge":"playkit-label-badge",labelBadge:"playkit-label-badge",active:"playkit-active","dropdown-menu":"playkit-dropdown-menu",dropdownMenu:"playkit-dropdown-menu","dropdown-button":"playkit-dropdown-button",dropdownButton:"playkit-dropdown-button",openDropmenu:"playkit-openDropmenu",top:"playkit-top",bottom:"playkit-bottom",right:"playkit-right",left:"playkit-left","stick-bottom":"playkit-stick-bottom",stickBottom:"playkit-stick-bottom","dropdown-menu-item":"playkit-dropdown-menu-item",dropdownMenuItem:"playkit-dropdown-menu-item","menu-icon-container":"playkit-menu-icon-container",menuIconContainer:"playkit-menu-icon-container","control-button":"playkit-control-button",controlButton:"playkit-control-button","button-badge":"playkit-button-badge",buttonBadge:"playkit-button-badge","control-button-rounded":"playkit-control-button-rounded",controlButtonRounded:"playkit-control-button-rounded",touch:"playkit-touch","control-button-container":"playkit-control-button-container",controlButtonContainer:"playkit-control-button-container","state-idle":"playkit-state-idle",stateIdle:"playkit-state-idle","no-idle-control":"playkit-no-idle-control",noIdleControl:"playkit-no-idle-control",rotate:"playkit-rotate",spin:"playkit-spin","reverse-rotate":"playkit-reverse-rotate",reverseRotate:"playkit-reverse-rotate","reverse-spin":"playkit-reverse-spin",reverseSpin:"playkit-reverse-spin","upper-bar-icon":"playkit-upper-bar-icon",upperBarIcon:"playkit-upper-bar-icon",emptyUrl:"playkit-emptyUrl","player-gui":"playkit-player-gui",playerGui:"playkit-player-gui","overlay-active":"playkit-overlay-active",overlayActive:"playkit-overlay-active",nav:"playkit-nav","ad-break":"playkit-ad-break",adBreak:"playkit-ad-break","metadata-loaded":"playkit-metadata-loaded",metadataLoaded:"playkit-metadata-loaded",hover:"playkit-hover","state-paused":"playkit-state-paused",statePaused:"playkit-state-paused","pre-playback":"playkit-pre-playback",prePlayback:"playkit-pre-playback",casting:"playkit-casting","menu-active":"playkit-menu-active",menuActive:"playkit-menu-active",iOS:"playkit-iOS",iOs:"playkit-iOS",Safari:"playkit-Safari",safari:"playkit-Safari",fullscreen:"playkit-fullscreen","video-player":"playkit-video-player",videoPlayer:"playkit-video-player",overlay:"playkit-overlay",openOverlay:"playkit-openOverlay","overlay-contents":"playkit-overlay-contents",overlayContents:"playkit-overlay-contents",title:"playkit-title","close-overlay":"playkit-close-overlay",closeOverlay:"playkit-close-overlay","overlay-screen":"playkit-overlay-screen",overlayScreen:"playkit-overlay-screen","size-md":"playkit-size-md",sizeMd:"playkit-size-md","smart-container":"playkit-smart-container",smartContainer:"playkit-smart-container",openSmartContainer:"playkit-openSmartContainer",leaving:"playkit-leaving",closeSmartContainer:"playkit-closeSmartContainer","smart-container-item":"playkit-smart-container-item",smartContainerItem:"playkit-smart-container-item","select-menu-item":"playkit-select-menu-item",selectMenuItem:"playkit-select-menu-item","label-icon":"playkit-label-icon",labelIcon:"playkit-label-icon",Windows:"playkit-Windows",windows:"playkit-Windows","cvaa-overlay":"playkit-cvaa-overlay",cvaaOverlay:"playkit-cvaa-overlay",sample:"playkit-sample",custom:"playkit-custom","black-bg":"playkit-black-bg",blackBg:"playkit-black-bg","yellow-text":"playkit-yellow-text",yellowText:"playkit-yellow-text","active-tick":"playkit-active-tick",activeTick:"playkit-active-tick","button-save-cvaa":"playkit-button-save-cvaa",buttonSaveCvaa:"playkit-button-save-cvaa","custom-captions-applied":"playkit-custom-captions-applied",customCaptionsApplied:"playkit-custom-captions-applied","custom-caption-form":"playkit-custom-caption-form",customCaptionForm:"playkit-custom-caption-form",slider:"playkit-slider","preview-container":"playkit-preview-container",previewContainer:"playkit-preview-container","font-size":"playkit-font-size",fontSize:"playkit-font-size","font-alignment":"playkit-font-alignment",fontAlignment:"playkit-font-alignment","font-color":"playkit-font-color",fontColor:"playkit-font-color","font-family":"playkit-font-family",fontFamily:"playkit-font-family","font-style":"playkit-font-style",fontStyle:"playkit-font-style","font-opacity":"playkit-font-opacity",fontOpacity:"playkit-font-opacity","background-color":"playkit-background-color",backgroundColor:"playkit-background-color","background-opacity":"playkit-background-opacity",backgroundOpacity:"playkit-background-opacity","loading-backdrop":"playkit-loading-backdrop",loadingBackdrop:"playkit-loading-backdrop",show:"playkit-show","spinner-container":"playkit-spinner-container",spinnerContainer:"playkit-spinner-container","control-play-pause":"playkit-control-play-pause",controlPlayPause:"playkit-control-play-pause","is-playing":"playkit-is-playing",isPlaying:"playkit-is-playing","control-volume":"playkit-control-volume",controlVolume:"playkit-control-volume","volume-control":"playkit-volume-control",volumeControl:"playkit-volume-control","volume-control-bar":"playkit-volume-control-bar",volumeControlBar:"playkit-volume-control-bar","is-muted":"playkit-is-muted",isMuted:"playkit-is-muted","dragging-active":"playkit-dragging-active",draggingActive:"playkit-dragging-active",bar:"playkit-bar",progress:"playkit-progress","smart-container-open":"playkit-smart-container-open",smartContainerOpen:"playkit-smart-container-open","control-volume-bar":"playkit-control-volume-bar",controlVolumeBar:"playkit-control-volume-bar","size-ty":"playkit-size-ty",sizeTy:"playkit-size-ty","control-fullscreen":"playkit-control-fullscreen",controlFullscreen:"playkit-control-fullscreen","is-fullscreen":"playkit-is-fullscreen",isFullscreen:"playkit-is-fullscreen","seek-bar":"playkit-seek-bar",seekBar:"playkit-seek-bar","time-preview":"playkit-time-preview",timePreview:"playkit-time-preview","frame-preview":"playkit-frame-preview",framePreview:"playkit-frame-preview","hide-frame-preview":"playkit-hide-frame-preview",hideFramePreview:"playkit-hide-frame-preview","progress-bar":"playkit-progress-bar",progressBar:"playkit-progress-bar",scrubber:"playkit-scrubber","virtual-progress":"playkit-virtual-progress",virtualProgress:"playkit-virtual-progress",chapters:"playkit-chapters","virtual-progress-indicator":"playkit-virtual-progress-indicator",virtualProgressIndicator:"playkit-virtual-progress-indicator","non-sticky":"playkit-non-sticky",nonSticky:"playkit-non-sticky",live:"playkit-live",buffered:"playkit-buffered","frame-preview-img-container":"playkit-frame-preview-img-container",framePreviewImgContainer:"playkit-frame-preview-img-container","frame-preview-img":"playkit-frame-preview-img",framePreviewImg:"playkit-frame-preview-img","time-display":"playkit-time-display",timeDisplay:"playkit-time-display","video-playing-title":"playkit-video-playing-title",videoPlayingTitle:"playkit-video-playing-title","bottom-bar":"playkit-bottom-bar",bottomBar:"playkit-bottom-bar",hide:"playkit-hide","controls-container":"playkit-controls-container",controlsContainer:"playkit-controls-container","left-controls":"playkit-left-controls",leftControls:"playkit-left-controls","right-controls":"playkit-right-controls",rightControls:"playkit-right-controls","bottom-bar-area":"playkit-bottom-bar-area",bottomBarArea:"playkit-bottom-bar-area","playback-controls":"playkit-playback-controls",playbackControls:"playkit-playback-controls","top-bar":"playkit-top-bar",topBar:"playkit-top-bar","top-bar-area":"playkit-top-bar-area",topBarArea:"playkit-top-bar-area",disabled:"playkit-disabled","overlay-action":"playkit-overlay-action",overlayAction:"playkit-overlay-action",in:"playkit-in",overlayActionIconIn:"playkit-overlayActionIconIn","pre-playback-play-overlay":"playkit-pre-playback-play-overlay",prePlaybackPlayOverlay:"playkit-pre-playback-play-overlay","pre-playback-play-button":"playkit-pre-playback-play-button",prePlaybackPlayButton:"playkit-pre-playback-play-button","gui-area":"playkit-gui-area",guiArea:"playkit-gui-area","btn-skip-ad":"playkit-btn-skip-ad",btnSkipAd:"playkit-btn-skip-ad","skip-ad":"playkit-skip-ad",skipAd:"playkit-skip-ad","live-tag":"playkit-live-tag",liveTag:"playkit-live-tag","non-live-playhead":"playkit-non-live-playhead",nonLivePlayhead:"playkit-non-live-playhead","interactive-area":"playkit-interactive-area",interactiveArea:"playkit-interactive-area","unmute-button-container":"playkit-unmute-button-container",unmuteButtonContainer:"playkit-unmute-button-container","show-icon-only":"playkit-show-icon-only",showIconOnly:"playkit-show-icon-only","unmute-button":"playkit-unmute-button",unmuteButton:"playkit-unmute-button","has-top-bar":"playkit-has-top-bar",hasTopBar:"playkit-has-top-bar","unmute-icon-container":"playkit-unmute-icon-container",unmuteIconContainer:"playkit-unmute-icon-container","error-overlay":"playkit-error-overlay",errorOverlay:"playkit-error-overlay","custom-error-slate":"playkit-custom-error-slate",customErrorSlate:"playkit-custom-error-slate","copy-url-row":"playkit-copy-url-row",copyUrlRow:"playkit-copy-url-row",headline:"playkit-headline","error-title":"playkit-error-title",errorTitle:"playkit-error-title","error-message":"playkit-error-message",errorMessage:"playkit-error-message","error-session":"playkit-error-session",errorSession:"playkit-error-session","retry-btn":"playkit-retry-btn",retryBtn:"playkit-retry-btn","error-text":"playkit-error-text",errorText:"playkit-error-text","link-options-container":"playkit-link-options-container",linkOptionsContainer:"playkit-link-options-container","input-copy-url":"playkit-input-copy-url",inputCopyUrl:"playkit-input-copy-url","btn-copy-url":"playkit-btn-copy-url",btnCopyUrl:"playkit-btn-copy-url",handle:"playkit-handle","learn-more":"playkit-learn-more",learnMore:"playkit-learn-more",watermark:"playkit-watermark","hide-watermark":"playkit-hide-watermark",hideWatermark:"playkit-hide-watermark","control-vr-stereo":"playkit-control-vr-stereo",controlVrStereo:"playkit-control-vr-stereo","vr-stereo-mode":"playkit-vr-stereo-mode",vrStereoMode:"playkit-vr-stereo-mode","control-closed-captions":"playkit-control-closed-captions",controlClosedCaptions:"playkit-control-closed-captions","cc-on":"playkit-cc-on",ccOn:"playkit-cc-on","cast-button":"playkit-cast-button",castButton:"playkit-cast-button","cast-button-active":"playkit-cast-button-active",castButtonActive:"playkit-cast-button-active","cast-overlay":"playkit-cast-overlay",castOverlay:"playkit-cast-overlay","cast-poster":"playkit-cast-poster",castPoster:"playkit-cast-poster","has-poster":"playkit-has-poster",hasPoster:"playkit-has-poster","cast-black-cover":"playkit-cast-black-cover",castBlackCover:"playkit-cast-black-cover","cast-box":"playkit-cast-box",castBox:"playkit-cast-box","cast-icon":"playkit-cast-icon",castIcon:"playkit-cast-icon","cast-connecting-spinner":"playkit-cast-connecting-spinner",castConnectingSpinner:"playkit-cast-connecting-spinner","cast-text":"playkit-cast-text",castText:"playkit-cast-text","cast-status":"playkit-cast-status",castStatus:"playkit-cast-status","cast-device":"playkit-cast-device",castDevice:"playkit-cast-device","cast-on-tv-button-container":"playkit-cast-on-tv-button-container",castOnTvButtonContainer:"playkit-cast-on-tv-button-container","show-cast-on-tv":"playkit-show-cast-on-tv",showCastOnTv:"playkit-show-cast-on-tv",castOnTVAnimation:"playkit-castOnTVAnimation",castOnTvAnimation:"playkit-castOnTVAnimation","cast-on-tv-button":"playkit-cast-on-tv-button",castOnTvButton:"playkit-cast-on-tv-button","cast-on-tv-icon-container":"playkit-cast-on-tv-icon-container",castOnTvIconContainer:"playkit-cast-on-tv-icon-container","control-playlist-button":"playkit-control-playlist-button",controlPlaylistButton:"playkit-control-playlist-button","poster-preview":"playkit-poster-preview",posterPreview:"playkit-poster-preview","poster-preview-img":"playkit-poster-preview-img",posterPreviewImg:"playkit-poster-preview-img","poster-preview-text":"playkit-poster-preview-text",posterPreviewText:"playkit-poster-preview-text","poster-preview-text-title":"playkit-poster-preview-text-title",posterPreviewTextTitle:"playkit-poster-preview-text-title","poster-preview-text-name":"playkit-poster-preview-text-name",posterPreviewTextName:"playkit-poster-preview-text-name","is-in-picture-in-picture":"playkit-is-in-picture-in-picture",isInPictureInPicture:"playkit-is-in-picture-in-picture","center-playback-controls":"playkit-center-playback-controls",centerPlaybackControls:"playkit-center-playback-controls","playlist-countdown":"playkit-playlist-countdown",playlistCountdown:"playkit-playlist-countdown",slideIn:"playkit-slideIn",hidden:"playkit-hidden","playlist-countdown-content-placeholder":"playkit-playlist-countdown-content-placeholder",playlistCountdownContentPlaceholder:"playkit-playlist-countdown-content-placeholder","playlist-countdown-content-background":"playkit-playlist-countdown-content-background",playlistCountdownContentBackground:"playkit-playlist-countdown-content-background","playlist-countdown-content":"playkit-playlist-countdown-content",playlistCountdownContent:"playkit-playlist-countdown-content",canceled:"playkit-canceled","playlist-countdown-poster":"playkit-playlist-countdown-poster",playlistCountdownPoster:"playkit-playlist-countdown-poster","playlist-countdown-text":"playkit-playlist-countdown-text",playlistCountdownText:"playkit-playlist-countdown-text","playlist-countdown-text-title":"playkit-playlist-countdown-text-title",playlistCountdownTextTitle:"playkit-playlist-countdown-text-title","playlist-countdown-time-left":"playkit-playlist-countdown-time-left",playlistCountdownTimeLeft:"playkit-playlist-countdown-time-left","playlist-countdown-text-name":"playkit-playlist-countdown-text-name",playlistCountdownTextName:"playkit-playlist-countdown-text-name","playlist-countdown-cancel":"playkit-playlist-countdown-cancel",playlistCountdownCancel:"playkit-playlist-countdown-cancel","playlist-next-screen-overlay":"playkit-playlist-next-screen-overlay",playlistNextScreenOverlay:"playkit-playlist-next-screen-overlay","playlist-next-screen-content":"playkit-playlist-next-screen-content",playlistNextScreenContent:"playkit-playlist-next-screen-content","playlist-next-screen-text":"playkit-playlist-next-screen-text",playlistNextScreenText:"playkit-playlist-next-screen-text","playlist-next-screen-text-title":"playkit-playlist-next-screen-text-title",playlistNextScreenTextTitle:"playkit-playlist-next-screen-text-title","playlist-next-screen-text-name":"playkit-playlist-next-screen-text-name",playlistNextScreenTextName:"playkit-playlist-next-screen-text-name","playlist-next-screen-poster-placeholder":"playkit-playlist-next-screen-poster-placeholder",playlistNextScreenPosterPlaceholder:"playkit-playlist-next-screen-poster-placeholder","playlist-next-screen-poster-aspect-ratio":"playkit-playlist-next-screen-poster-aspect-ratio",playlistNextScreenPosterAspectRatio:"playkit-playlist-next-screen-poster-aspect-ratio","playlist-next-screen-poster":"playkit-playlist-next-screen-poster",playlistNextScreenPoster:"playkit-playlist-next-screen-poster","playlist-next-screen-poster-img":"playkit-playlist-next-screen-poster-img",playlistNextScreenPosterImg:"playkit-playlist-next-screen-poster-img","size-lg":"playkit-size-lg",sizeLg:"playkit-size-lg","picture-in-picture-overlay":"playkit-picture-in-picture-overlay",pictureInPictureOverlay:"playkit-picture-in-picture-overlay","picture-in-picture-poster":"playkit-picture-in-picture-poster",pictureInPicturePoster:"playkit-picture-in-picture-poster","dark-layer":"playkit-dark-layer",darkLayer:"playkit-dark-layer","picture-in-picture-control":"playkit-picture-in-picture-control",pictureInPictureControl:"playkit-picture-in-picture-control","picture-in-picture-text":"playkit-picture-in-picture-text",pictureInPictureText:"playkit-picture-in-picture-text","picture-in-picture-button":"playkit-picture-in-picture-button",pictureInPictureButton:"playkit-picture-in-picture-button","icon-copy":"playkit-icon-copy",iconCopy:"playkit-icon-copy",copied:"playkit-copied",IE:"playkit-IE",ie:"playkit-IE",tooltip:"playkit-tooltip","tooltip-label":"playkit-tooltip-label",tooltipLabel:"playkit-tooltip-label","tooltip-top":"playkit-tooltip-top",tooltipTop:"playkit-tooltip-top","tooltip-top-left":"playkit-tooltip-top-left",tooltipTopLeft:"playkit-tooltip-top-left","tooltip-top-right":"playkit-tooltip-top-right",tooltipTopRight:"playkit-tooltip-top-right","tooltip-bottom":"playkit-tooltip-bottom",tooltipBottom:"playkit-tooltip-bottom","tooltip-bottom-right":"playkit-tooltip-bottom-right",tooltipBottomRight:"playkit-tooltip-bottom-right","tooltip-bottom-left":"playkit-tooltip-bottom-left",tooltipBottomLeft:"playkit-tooltip-bottom-left","tooltip-left":"playkit-tooltip-left",tooltipLeft:"playkit-tooltip-left","tooltip-right":"playkit-tooltip-right",tooltipRight:"playkit-tooltip-right","side-panel":"playkit-side-panel",sidePanel:"playkit-side-panel","small-size":"playkit-small-size",smallSize:"playkit-small-size","vertical-side-panel":"playkit-vertical-side-panel",verticalSidePanel:"playkit-vertical-side-panel","horizontal-side-panel":"playkit-horizontal-side-panel",horizontalSidePanel:"playkit-horizontal-side-panel","side-panel-content":"playkit-side-panel-content",sidePanelContent:"playkit-side-panel-content","video-area":"playkit-video-area",videoArea:"playkit-video-area",spinner:"playkit-spinner","kaltura-spinner":"playkit-kaltura-spinner",kalturaSpinner:"playkit-kaltura-spinner",switch:"playkit-switch","toggle-input":"playkit-toggle-input",toggleInput:"playkit-toggle-input","audio-entry-backdrop":"playkit-audio-entry-backdrop",audioEntryBackdrop:"playkit-audio-entry-backdrop","audio-entry-details":"playkit-audio-entry-details",audioEntryDetails:"playkit-audio-entry-details","audio-entry-l":"playkit-audio-entry-l",audioEntryL:"playkit-audio-entry-l","audio-entry-m":"playkit-audio-entry-m",audioEntryM:"playkit-audio-entry-m","audio-entry-t":"playkit-audio-entry-t",audioEntryT:"playkit-audio-entry-t","audio-entry-description":"playkit-audio-entry-description",audioEntryDescription:"playkit-audio-entry-description","audio-entry-title":"playkit-audio-entry-title",audioEntryTitle:"playkit-audio-entry-title","audio-entry-title-trimmed":"playkit-audio-entry-title-trimmed",audioEntryTitleTrimmed:"playkit-audio-entry-title-trimmed","audio-entry-expanded":"playkit-audio-entry-expanded",audioEntryExpanded:"playkit-audio-entry-expanded","expandable-text":"playkit-expandable-text",expandableText:"playkit-expandable-text","more-button-text":"playkit-more-button-text",moreButtonText:"playkit-more-button-text",scrollable:"playkit-scrollable","items-container":"playkit-items-container",itemsContainer:"playkit-items-container",horizontal:"playkit-horizontal",vertical:"playkit-vertical",scrolling:"playkit-scrolling"},module.exports=e},"./node_modules/css-loader/dist/runtime/api.js":function(module){"use strict";module.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r,n,a,i=e[1]||"",o=e[3];if(!o)return i;if(t&&"function"==typeof btoa){var s=(r=o,n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(a," */")),l=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[i].concat(l).concat([s]).join("\n")}return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,n){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(n)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(a[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);n&&a[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},"./node_modules/dlv/dist/dlv.umd.js":function(module){module.exports=function(e,t,r,n,a){for(t=t.split?t.split("."):t,n=0;n<t.length;n++)e=e?e[t[n]]:a;return e===a?r:e}},"./node_modules/hoist-non-react-statics/dist/hoist-non-react-statics.cjs.js":function(module,e,t){"use strict";var r=t("./node_modules/react-is/index.js"),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function s(e){return r.isMemo(e)?i:o[e.$$typeof]||n}o[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[r.Memo]=i;var l=Object.defineProperty,u=Object.getOwnPropertyNames,c=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,h=Object.prototype;module.exports=function e(t,r,n){if("string"!=typeof r){if(h){var i=p(r);i&&i!==h&&e(t,i,n)}var o=u(r);c&&(o=o.concat(c(r)));for(var f=s(t),m=s(r),g=0;g<o.length;++g){var y=o[g];if(!(a[y]||n&&n[y]||m&&m[y]||f&&f[y])){var v=d(r,y);try{l(t,y,v)}catch(e){}}}}return t}},"./node_modules/object-assign/index.js":function(module){"use strict";var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;module.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(n,a){for(var i,o,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(n),l=1;l<arguments.length;l++){for(var u in i=Object(arguments[l]))t.call(i,u)&&(s[u]=i[u]);if(e){o=e(i);for(var c=0;c<o.length;c++)r.call(i,o[c])&&(s[o[c]]=i[o[c]])}}return s}},"./node_modules/preact-i18n/dist/preact-i18n.esm.js":function(e,t,r){"use strict";r.r(t),r.d(t,{IntlProvider:function(){return d},Localizer:function(){return E},MarkupText:function(){return b},Text:function(){return _},intl:function(){return p},withText:function(){return A}});var n=r("./node_modules/preact/dist/preact.module.js"),a=r("./node_modules/dlv/dist/dlv.umd.js"),i=r.n(a);function s(e){return null!=e}function l(e,t){for(var r in t)e[r]=t[r];return e}function u(e,t){var r=l({},e);for(var n in t)t.hasOwnProperty(n)&&(e[n]&&t[n]&&"object"===o(e[n])&&"object"===o(t[n])?r[n]=u(e[n],t[n]):r[n]=e[n]||t[n]);return r}var c=/[?&#]intl=show/,d=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getChildContext=function(){var e=this.props,t=e.scope,r=e.definition,n=e.mark,a=l({},this.context.intl||{});return t&&(a.scope=t),r&&(a.dictionary=u(a.dictionary||{},r)),(n||"undefined"!=typeof location&&String(location).match(c))&&(a.mark=!0),{intl:a}},t.prototype.render=function(e){return e.children},t}(n.Component);function p(e,t){if(arguments.length<2)return t=e,function(e){return p(e,t)};function r(r){return(0,n.h)(d,t||{},(0,n.h)(e,r))}return r.getWrappedComponent=e&&e.getWrappedComponent||function(){return e},r}var h,f={};function m(e,t){return h=t||f,e&&e.replace(/\{\{([\w.-]+)\}\}/g,g)}function g(e,t){for(var r=t.split("."),n=h,a=0;a<r.length;a++)if(null==(n=n[r[a]]))return"";return"string"==typeof n&&n.match(/\{\{/)&&(n=m(n,h)),n}function y(e,t,r,n,a,l){t&&(e=t+"."+e);var u=r&&i()(r,e);return(a||0===a)&&u&&"object"===o(u)&&(u=u.splice?u[a]||u[0]:0===a&&s(u.none)?u.none:1===a&&s(u.one||u.singular)?u.one||u.singular:u.some||u.many||u.plural||u.other||u),u&&m(u,n)||l||null}function v(e,t){var r=e.value,a=e.id,o=t.intl;if(o&&o.mark){var s="dictionary"+(o&&o.scope?"."+o.scope:"")+"."+a;return(0,n.h)("mark",{style:{background:r?i()(o,s)?"rgba(119,231,117,.5)":"rgba(229,226,41,.5)":"rgba(228,147,51,.5)"},title:a},r)}return r}function _(e,t){var r=e.id,a=e.children,i=e.plural,o=e.fields,s=t.intl,l=y(r,s&&s.scope,s&&s.dictionary,o,i,a);return(0,n.h)(v,{id:r,value:l})}function k(e,t,r){var n={};for(var a in t=t||{},e=function(e){if("string"==typeof(e=e||{})&&(e=e.split(",")),"join"in e){for(var t={},r=0;r<e.length;r++){var n=e[r].trim();n&&(t[n.split(".").pop()]=n)}return t}return e}(e))if(e.hasOwnProperty(a)&&e[a]){var i=e[a];r||"string"!=typeof i?i.type===_&&(i=l({fallback:i.props.children},i.props),n[a]=y(i.id,t.scope,t.dictionary,i.fields,i.plural,i.fallback)):n[a]=y(i,t.scope,t.dictionary)}return n}function E(e,t){var r=e.children,a=t.intl;return r&&r.length?r.map((function(e){return(0,n.cloneElement)(e,k(e.props,a,!0))})):r&&(0,n.cloneElement)(r,k(r.props,a,!0))}function b(e){return(0,n.h)(E,null,(0,n.h)(T,{html:(0,n.h)(_,e),id:e.id}))}function T(e){var t=e.html,r=e.id,a=t?"string"==typeof t?(0,n.h)("span",{dangerouslySetInnerHTML:{__html:t}}):(0,n.h)("span",null,t):t;return(0,n.h)(v,{id:r,value:a})}function A(e){return function(t){function r(r,a){var i=k("function"==typeof e?e(r,a):e,a.intl);return(0,n.h)(t,l(l({},r),i))}return r.getWrappedComponent=t&&t.getWrappedComponent||function(){return t},r}}p.intl=p,p.IntlProvider=d,p.Text=_,p.MarkupText=b,p.Localizer=E,p.withText=A,t.default=p},"./node_modules/preact/compat/dist/compat.module.js":function(e,t,r){"use strict";r.r(t),r.d(t,{Children:function(){return f},Component:function(){return a.Component},Fragment:function(){return a.Fragment},PureComponent:function(){return l},StrictMode:function(){return F},Suspense:function(){return y},SuspenseList:function(){return k},cloneElement:function(){return N},createContext:function(){return a.createContext},createElement:function(){return a.createElement},createFactory:function(){return O},createPortal:function(){return A},createRef:function(){return a.createRef},findDOMNode:function(){return j},forwardRef:function(){return p},hydrate:function(){return x},isValidElement:function(){return L},lazy:function(){return _},memo:function(){return u},render:function(){return P},unmountComponentAtNode:function(){return U},unstable_batchedUpdates:function(){return B},useCallback:function(){return n.useCallback},useContext:function(){return n.useContext},useDebugValue:function(){return n.useDebugValue},useEffect:function(){return n.useEffect},useErrorBoundary:function(){return n.useErrorBoundary},useImperativeHandle:function(){return n.useImperativeHandle},useLayoutEffect:function(){return n.useLayoutEffect},useMemo:function(){return n.useMemo},useReducer:function(){return n.useReducer},useRef:function(){return n.useRef},useState:function(){return n.useState},version:function(){return D}});var n=r("./node_modules/preact/hooks/dist/hooks.module.js"),a=r("./node_modules/preact/dist/preact.module.js");function i(e,t){for(var r in t)e[r]=t[r];return e}function s(e,t){for(var r in e)if("__source"!==r&&!(r in t))return!0;for(var n in t)if("__source"!==n&&e[n]!==t[n])return!0;return!1}var l=function(e){var t,r;function n(t){var r;return(r=e.call(this,t)||this).isPureReactComponent=!0,r}return r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,n.prototype.shouldComponentUpdate=function(e,t){return s(this.props,e)||s(this.state,t)},n}(a.Component);function u(e,t){function r(e){var r=this.props.ref,n=r==e.ref;return!n&&r&&(r.call?r(null):r.current=null),t?!t(this.props,e)||!n:s(this.props,e)}function n(t){return this.shouldComponentUpdate=r,(0,a.createElement)(e,t)}return n.prototype.isReactComponent=!0,n.displayName="Memo("+(e.displayName||e.name)+")",n.t=!0,n}var c=a.options.__b;a.options.__b=function(e){e.type&&e.type.t&&e.ref&&(e.props.ref=e.ref,e.ref=null),c&&c(e)};var d="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function p(e){function t(t,r){var n=i({},t);return delete n.ref,e(n,(r=t.ref||r)&&("object"!=o(r)||"current"in r)?r:null)}return t.$$typeof=d,t.render=t,t.prototype.isReactComponent=t.t=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var h=function(e,t){return e?(0,a.toChildArray)(e).reduce((function(e,r,n){return e.concat(t(r,n))}),[]):null},f={map:h,forEach:h,count:function(e){return e?(0,a.toChildArray)(e).length:0},only:function(e){if(1!==(e=(0,a.toChildArray)(e)).length)throw new Error("Children.only() expects only one child.");return e[0]},toArray:a.toChildArray},m=a.options.__e;function g(e){return e&&((e=i({},e)).__c=null,e.__k=e.__k&&e.__k.map(g)),e}function y(){this.__u=0,this.o=null,this.__b=null}function v(e){var t=e.__.__c;return t&&t.u&&t.u(e)}function _(e){var t,r,n;function i(i){if(t||(t=e()).then((function(e){r=e.default||e}),(function(e){n=e})),n)throw n;if(!r)throw t;return(0,a.createElement)(r,i)}return i.displayName="Lazy",i.t=!0,i}function k(){this.i=null,this.l=null}a.options.__e=function(e,t,r){if(e.then)for(var n,a=t;a=a.__;)if((n=a.__c)&&n.__c)return n.__c(e,t.__c);m(e,t,r)},(y.prototype=new a.Component).__c=function(e,t){var r=this;null==r.o&&(r.o=[]),r.o.push(t);var n=v(r.__v),a=!1,i=function(){a||(a=!0,n?n(o):o())};t.__c=t.componentWillUnmount,t.componentWillUnmount=function(){i(),t.__c&&t.__c()};var o=function(){var e;if(! --r.__u)for(r.__v.__k[0]=r.state.u,r.setState({u:r.__b=null});e=r.o.pop();)e.forceUpdate()};r.__u++||r.setState({u:r.__b=r.__v.__k[0]}),e.then(i,i)},y.prototype.render=function(e,t){return this.__b&&(this.__v.__k&&(this.__v.__k[0]=g(this.__b)),this.__b=null),[(0,a.createElement)(a.Fragment,null,t.u?null:e.children),t.u&&e.fallback]};var E=function(e,t,r){if(++r[1]===r[0]&&e.l.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.l.size))for(r=e.i;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;e.i=r=r[2]}};(k.prototype=new a.Component).u=function(e){var t=this,r=v(t.__v),n=t.l.get(e);return n[0]++,function(a){var i=function(){t.props.revealOrder?(n.push(a),E(t,e,n)):a()};r?r(i):i()}},k.prototype.render=function(e){this.i=null,this.l=new Map;var t=(0,a.toChildArray)(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var r=t.length;r--;)this.l.set(t[r],this.i=[1,0,this.i]);return e.children},k.prototype.componentDidUpdate=k.prototype.componentDidMount=function(){var e=this;e.l.forEach((function(t,r){E(e,r,t)}))};var b=function(){function e(){}var t=e.prototype;return t.getChildContext=function(){return this.props.context},t.render=function(e){return e.children},e}();function T(e){var t=this,r=e.container,n=(0,a.createElement)(b,{context:t.context},e.vnode);return t.s&&t.s!==r&&(t.v.parentNode&&t.s.removeChild(t.v),(0,a.__u)(t.h),t.p=!1),e.vnode?t.p?(r.__k=t.__k,(0,a.render)(n,r),t.__k=r.__k):(t.v=document.createTextNode(""),(0,a.hydrate)("",r),r.appendChild(t.v),t.p=!0,t.s=r,(0,a.render)(n,r,t.v),t.__k=t.v.__k):t.p&&(t.v.parentNode&&t.s.removeChild(t.v),(0,a.__u)(t.h)),t.h=n,t.componentWillUnmount=function(){t.v.parentNode&&t.s.removeChild(t.v),(0,a.__u)(t.h)},null}function A(e,t){return(0,a.createElement)(T,{vnode:e,container:t})}var S=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;a.Component.prototype.isReactComponent={};var C="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;function P(e,t,r){if(null==t.__k)for(;t.firstChild;)t.removeChild(t.firstChild);return(0,a.render)(e,t),"function"==typeof r&&r(),e?e.__c:null}function x(e,t,r){return(0,a.hydrate)(e,t),"function"==typeof r&&r(),e?e.__c:null}var w=a.options.event;function I(e,t){e["UNSAFE_"+t]&&!e[t]&&Object.defineProperty(e,t,{configurable:!1,get:function(){return this["UNSAFE_"+t]},set:function(e){this["UNSAFE_"+t]=e}})}a.options.event=function(e){w&&(e=w(e)),e.persist=function(){};var t=!1,r=!1,n=e.stopPropagation;e.stopPropagation=function(){n.call(e),t=!0};var a=e.preventDefault;return e.preventDefault=function(){a.call(e),r=!0},e.isPropagationStopped=function(){return t},e.isDefaultPrevented=function(){return r},e.nativeEvent=e};var M={configurable:!0,get:function(){return this.class}},R=a.options.vnode;a.options.vnode=function(e){e.$$typeof=C;var t=e.type,r=e.props;if(t){if(r.class!=r.className&&(M.enumerable="className"in r,null!=r.className&&(r.class=r.className),Object.defineProperty(r,"className",M)),"function"!=typeof t){var n,i,o;for(o in r.defaultValue&&void 0!==r.value&&(r.value||0===r.value||(r.value=r.defaultValue),delete r.defaultValue),Array.isArray(r.value)&&r.multiple&&"select"===t&&((0,a.toChildArray)(r.children).forEach((function(e){-1!=r.value.indexOf(e.props.value)&&(e.props.selected=!0)})),delete r.value),r)if(n=S.test(o))break;if(n)for(o in i=e.props={},r)i[S.test(o)?o.replace(/[A-Z0-9]/,"-$&").toLowerCase():o]=r[o]}!function(t){var r=e.type,n=e.props;if(n&&"string"==typeof r){var a={};for(var i in n)/^on(Ani|Tra|Tou)/.test(i)&&(n[i.toLowerCase()]=n[i],delete n[i]),a[i.toLowerCase()]=i;if(a.ondoubleclick&&(n.ondblclick=n[a.ondoubleclick],delete n[a.ondoubleclick]),a.onbeforeinput&&(n.onbeforeinput=n[a.onbeforeinput],delete n[a.onbeforeinput]),a.onchange&&("textarea"===r||"input"===r.toLowerCase()&&!/^fil|che|ra/i.test(n.type))){var o=a.oninput||"oninput";n[o]||(n[o]=n[a.onchange],delete n[a.onchange])}}}(),"function"==typeof t&&!t.m&&t.prototype&&(I(t.prototype,"componentWillMount"),I(t.prototype,"componentWillReceiveProps"),I(t.prototype,"componentWillUpdate"),t.m=!0)}R&&R(e)};var D="16.8.0";function O(e){return a.createElement.bind(null,e)}function L(e){return!!e&&e.$$typeof===C}function N(e){return L(e)?a.cloneElement.apply(null,arguments):e}function U(e){return!!e.__k&&((0,a.render)(null,e),!0)}function j(e){return e&&(e.base||1===e.nodeType&&e)||null}var B=function(e,t){return e(t)},F=a.Fragment;t.default={useState:n.useState,useReducer:n.useReducer,useEffect:n.useEffect,useLayoutEffect:n.useLayoutEffect,useRef:n.useRef,useImperativeHandle:n.useImperativeHandle,useMemo:n.useMemo,useCallback:n.useCallback,useContext:n.useContext,useDebugValue:n.useDebugValue,version:"16.8.0",Children:f,render:P,hydrate:x,unmountComponentAtNode:U,createPortal:A,createElement:a.createElement,createContext:a.createContext,createFactory:O,cloneElement:N,createRef:a.createRef,Fragment:a.Fragment,isValidElement:L,findDOMNode:j,Component:a.Component,PureComponent:l,memo:u,forwardRef:p,unstable_batchedUpdates:B,StrictMode:a.Fragment,Suspense:y,SuspenseList:k,lazy:_}},"./node_modules/preact/dist/preact.module.js":function(e,t,r){"use strict";r.r(t),r.d(t,{Component:function(){return _},Fragment:function(){return v},__u:function(){return L},cloneElement:function(){return B},createContext:function(){return F},createElement:function(){return m},createRef:function(){return y},h:function(){return m},hydrate:function(){return j},isValidElement:function(){return a},options:function(){return n},render:function(){return U},toChildArray:function(){return S}});var n,a,i,o,s,l,u,c={},d=[],p=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function h(e,t){for(var r in t)e[r]=t[r];return e}function f(e){var t=e.parentNode;t&&t.removeChild(e)}function m(e,t,r){var n,a=arguments,i={};for(n in t)"key"!==n&&"ref"!==n&&(i[n]=t[n]);if(arguments.length>3)for(r=[r],n=3;n<arguments.length;n++)r.push(a[n]);if(null!=r&&(i.children=r),"function"==typeof e&&null!=e.defaultProps)for(n in e.defaultProps)void 0===i[n]&&(i[n]=e.defaultProps[n]);return g(e,i,t&&t.key,t&&t.ref,null)}function g(e,t,r,a,i){var o={type:e,props:t,key:r,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:i};return null==i&&(o.__v=o),n.vnode&&n.vnode(o),o}function y(){return{current:null}}function v(e){return e.children}function _(e,t){this.props=e,this.context=t}function k(e,t){if(null==t)return e.__?k(e.__,e.__.__k.indexOf(e)+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?k(e):null}function E(e){var t,r;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e){e.__e=e.__c.base=r.__e;break}return E(e)}}function b(e){(!e.__d&&(e.__d=!0)&&i.push(e)&&!T.__r++||s!==n.debounceRendering)&&((s=n.debounceRendering)||o)(T)}function T(){for(var e;T.__r=i.length;)e=i.sort((function(e,t){return e.__v.__b-t.__v.__b})),i=[],e.some((function(e){var t,r,n,a,i,o,s;e.__d&&(o=(i=(t=e).__v).__e,(s=t.__P)&&(r=[],(n=h({},i)).__v=n,a=M(s,i,n,t.__n,void 0!==s.ownerSVGElement,null,r,null==o?k(i):o),R(r,i),a!=o&&E(i)))}))}function A(e,t,r,n,a,i,o,s,l,u){var p,h,m,y,_,E,b,T=n&&n.__k||d,A=T.length;for(l==c&&(l=null!=o?o[0]:A?k(n,0):null),r.__k=[],p=0;p<t.length;p++)if(null!=(y=r.__k[p]=null==(y=t[p])||"boolean"==typeof y?null:"string"==typeof y||"number"==typeof y?g(null,y,null,null,y):Array.isArray(y)?g(v,{children:y},null,null,null):null!=y.__e||null!=y.__c?g(y.type,y.props,y.key,null,y.__v):y)){if(y.__=r,y.__b=r.__b+1,null===(m=T[p])||m&&y.key==m.key&&y.type===m.type)T[p]=void 0;else for(h=0;h<A;h++){if((m=T[h])&&y.key==m.key&&y.type===m.type){T[h]=void 0;break}m=null}_=M(e,y,m=m||c,a,i,o,s,l,u),(h=y.ref)&&m.ref!=h&&(b||(b=[]),m.ref&&b.push(m.ref,null,y),b.push(h,y.__c||_,y)),null!=_?(null==E&&(E=_),l=C(e,y,m,T,o,_,l),"option"==r.type?e.value="":"function"==typeof r.type&&(r.__d=l)):l&&m.__e==l&&l.parentNode!=e&&(l=k(m))}if(r.__e=E,null!=o&&"function"!=typeof r.type)for(p=o.length;p--;)null!=o[p]&&f(o[p]);for(p=A;p--;)null!=T[p]&&L(T[p],T[p]);if(b)for(p=0;p<b.length;p++)O(b[p],b[++p],b[++p])}function S(e){return null==e||"boolean"==typeof e?[]:Array.isArray(e)?d.concat.apply([],e.map(S)):[e]}function C(e,t,r,n,a,i,o){var s,l,u;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(a==r||i!=o||null==i.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(i),s=null;else{for(l=o,u=0;(l=l.nextSibling)&&u<n.length;u+=2)if(l==i)break e;e.insertBefore(i,o),s=o}return void 0!==s?s:i.nextSibling}function P(e,t,r){"-"===t[0]?e.setProperty(t,r):e[t]="number"==typeof r&&!1===p.test(t)?r+"px":null==r?"":r}function x(e,t,r,n,a){var i,o,s,l,u;if(a?"className"===t&&(t="class"):"class"===t&&(t="className"),"style"===t)if(i=e.style,"string"==typeof r)i.cssText=r;else{if("string"==typeof n&&(i.cssText="",n=null),n)for(l in n)r&&l in r||P(i,l,"");if(r)for(u in r)n&&r[u]===n[u]||P(i,u,r[u])}else"o"===t[0]&&"n"===t[1]?(o=t!==(t=t.replace(/Capture$/,"")),s=t.toLowerCase(),t=(s in e?s:t).slice(2),r?(n||e.addEventListener(t,w,o),(e.l||(e.l={}))[t]=r):e.removeEventListener(t,w,o)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&!a&&t in e?e[t]=null==r?"":r:"function"!=typeof r&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/^xlink:?/,""))?null==r||!1===r?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):null==r||!1===r&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,r))}function w(e){this.l[e.type](n.event?n.event(e):e)}function I(e,t,r){var n,a;for(n=0;n<e.__k.length;n++)(a=e.__k[n])&&(a.__=e,a.__e&&("function"==typeof a.type&&a.__k.length>1&&I(a,t,r),t=C(r,a,a,e.__k,null,a.__e,t),"function"==typeof e.type&&(e.__d=t)))}function M(e,t,r,a,i,o,s,l,u){var c,d,p,f,m,g,y,k,E,b,T,S=t.type;if(void 0!==t.constructor)return null;(c=n.__b)&&c(t);try{e:if("function"==typeof S){if(k=t.props,E=(c=S.contextType)&&a[c.__c],b=c?E?E.props.value:c.__:a,r.__c?y=(d=t.__c=r.__c).__=d.__E:("prototype"in S&&S.prototype.render?t.__c=d=new S(k,b):(t.__c=d=new _(k,b),d.constructor=S,d.render=N),E&&E.sub(d),d.props=k,d.state||(d.state={}),d.context=b,d.__n=a,p=d.__d=!0,d.__h=[]),null==d.__s&&(d.__s=d.state),null!=S.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=h({},d.__s)),h(d.__s,S.getDerivedStateFromProps(k,d.__s))),f=d.props,m=d.state,p)null==S.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==S.getDerivedStateFromProps&&k!==f&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(k,b),!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(k,d.__s,b)||t.__v===r.__v){d.props=k,d.state=d.__s,t.__v!==r.__v&&(d.__d=!1),d.__v=t,t.__e=r.__e,t.__k=r.__k,d.__h.length&&s.push(d),I(t,l,e);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(k,d.__s,b),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(f,m,g)}))}d.context=b,d.props=k,d.state=d.__s,(c=n.__r)&&c(t),d.__d=!1,d.__v=t,d.__P=e,c=d.render(d.props,d.state,d.context),d.state=d.__s,null!=d.getChildContext&&(a=h(h({},a),d.getChildContext())),p||null==d.getSnapshotBeforeUpdate||(g=d.getSnapshotBeforeUpdate(f,m)),T=null!=c&&c.type==v&&null==c.key?c.props.children:c,A(e,Array.isArray(T)?T:[T],t,r,a,i,o,s,l,u),d.base=t.__e,d.__h.length&&s.push(d),y&&(d.__E=d.__=null),d.__e=!1}else null==o&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=D(r.__e,t,r,a,i,o,s,u);(c=n.diffed)&&c(t)}catch(e){t.__v=null,n.__e(e,t,r)}return t.__e}function R(e,t){n.__c&&n.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){n.__e(e,t.__v)}}))}function D(e,t,r,n,a,i,o,s){var l,u,p,h,f,m=r.props,g=t.props;if(a="svg"===t.type||a,null!=i)for(l=0;l<i.length;l++)if(null!=(u=i[l])&&((null===t.type?3===u.nodeType:u.localName===t.type)||e==u)){e=u,i[l]=null;break}if(null==e){if(null===t.type)return document.createTextNode(g);e=a?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,g.is&&{is:g.is}),i=null,s=!1}if(null===t.type)m!==g&&e.data!=g&&(e.data=g);else{if(null!=i&&(i=d.slice.call(e.childNodes)),p=(m=r.props||c).dangerouslySetInnerHTML,h=g.dangerouslySetInnerHTML,!s){if(null!=i)for(m={},f=0;f<e.attributes.length;f++)m[e.attributes[f].name]=e.attributes[f].value;(h||p)&&(h&&p&&h.__html==p.__html||(e.innerHTML=h&&h.__html||""))}(function(e,t,r,n,a){var i;for(i in r)"children"===i||"key"===i||i in t||x(e,i,null,r[i],n);for(i in t)a&&"function"!=typeof t[i]||"children"===i||"key"===i||"value"===i||"checked"===i||r[i]===t[i]||x(e,i,t[i],r[i],n)})(e,g,m,a,s),h?t.__k=[]:(l=t.props.children,A(e,Array.isArray(l)?l:[l],t,r,n,"foreignObject"!==t.type&&a,i,o,c,s)),s||("value"in g&&void 0!==(l=g.value)&&l!==e.value&&x(e,"value",l,m.value,!1),"checked"in g&&void 0!==(l=g.checked)&&l!==e.checked&&x(e,"checked",l,m.checked,!1))}return e}function O(e,t,r){try{"function"==typeof e?e(t):e.current=t}catch(e){n.__e(e,r)}}function L(e,t,r){var a,i,o;if(n.unmount&&n.unmount(e),(a=e.ref)&&(a.current&&a.current!==e.__e||O(a,null,t)),r||"function"==typeof e.type||(r=null!=(i=e.__e)),e.__e=e.__d=void 0,null!=(a=e.__c)){if(a.componentWillUnmount)try{a.componentWillUnmount()}catch(e){n.__e(e,t)}a.base=a.__P=null}if(a=e.__k)for(o=0;o<a.length;o++)a[o]&&L(a[o],t,r);null!=i&&f(i)}function N(e,t,r){return this.constructor(e,r)}function U(e,t,r){var a,i,o;n.__&&n.__(e,t),i=(a=r===l)?null:r&&r.__k||t.__k,e=m(v,null,[e]),o=[],M(t,(a?t:r||t).__k=e,i||c,c,void 0!==t.ownerSVGElement,r&&!a?[r]:i?null:t.childNodes.length?d.slice.call(t.childNodes):null,o,r||c,a),R(o,e)}function j(e,t){U(e,t,l)}function B(e,t){var r,n;for(n in t=h(h({},e.props),t),arguments.length>2&&(t.children=d.slice.call(arguments,2)),r={},t)"key"!==n&&"ref"!==n&&(r[n]=t[n]);return g(e.type,r,t.key||e.key,t.ref||e.ref,null)}function F(e){var t={},r={__c:"__cC"+u++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,a=this;return this.getChildContext||(n=[],this.getChildContext=function(){return t[r.__c]=a,t},this.shouldComponentUpdate=function(e){a.props.value!==e.value&&n.some((function(t){t.context=e.value,b(t)}))},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return r.Consumer.contextType=r,r.Provider.__=r,r}n={__e:function(e,t){for(var r,n;t=t.__;)if((r=t.__c)&&!r.__)try{if(r.constructor&&null!=r.constructor.getDerivedStateFromError&&(n=!0,r.setState(r.constructor.getDerivedStateFromError(e))),null!=r.componentDidCatch&&(n=!0,r.componentDidCatch(e)),n)return b(r.__E=r)}catch(t){e=t}throw e}},a=function(e){return null!=e&&void 0===e.constructor},_.prototype.setState=function(e,t){var r;r=this.__s!==this.state?this.__s:this.__s=h({},this.state),"function"==typeof e&&(e=e(r,this.props)),e&&h(r,e),null!=e&&this.__v&&(t&&this.__h.push(t),b(this))},_.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),b(this))},_.prototype.render=v,i=[],o="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,T.__r=0,l=c,u=0},"./node_modules/preact/hooks/dist/hooks.module.js":function(e,t,r){"use strict";r.r(t),r.d(t,{useCallback:function(){return E},useContext:function(){return b},useDebugValue:function(){return T},useEffect:function(){return g},useErrorBoundary:function(){return A},useImperativeHandle:function(){return _},useLayoutEffect:function(){return y},useMemo:function(){return k},useReducer:function(){return m},useRef:function(){return v},useState:function(){return f}});var n,a,i,o=r("./node_modules/preact/dist/preact.module.js"),s=0,l=[],u=o.options.__r,c=o.options.diffed,d=o.options.__c,p=o.options.unmount;function h(e,t){o.options.__h&&o.options.__h(a,e,s||t),s=0;var r=a.__H||(a.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function f(e){return s=1,m(I,e)}function m(e,t,r){var i=h(n++,2);return i.t=e,i.__c||(i.__c=a,i.__=[r?r(t):I(void 0,t),function(e){var t=i.t(i.__[0],e);i.__[0]!==t&&(i.__=[t,i.__[1]],i.__c.setState({}))}]),i.__}function g(e,t){var r=h(n++,3);!o.options.__s&&w(r.__H,t)&&(r.__=e,r.__H=t,a.__H.__h.push(r))}function y(e,t){var r=h(n++,4);!o.options.__s&&w(r.__H,t)&&(r.__=e,r.__H=t,a.__h.push(r))}function v(e){return s=5,k((function(){return{current:e}}),[])}function _(e,t,r){s=6,y((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==r?r:r.concat(e))}function k(e,t){var r=h(n++,7);return w(r.__H,t)?(r.__H=t,r.__h=e,r.__=e()):r.__}function E(e,t){return s=8,k((function(){return e}),t)}function b(e){var t=a.context[e.__c],r=h(n++,9);return r.__c=e,t?(null==r.__&&(r.__=!0,t.sub(a)),t.props.value):e.__}function T(e,t){o.options.useDebugValue&&o.options.useDebugValue(t?t(e):e)}function A(e){var t=h(n++,10),r=f();return t.__=e,a.componentDidCatch||(a.componentDidCatch=function(e){t.__&&t.__(e),r[1](e)}),[r[0],function(){r[1](void 0)}]}function S(){l.some((function(e){if(e.__P)try{e.__H.__h.forEach(P),e.__H.__h.forEach(x),e.__H.__h=[]}catch(t){return e.__H.__h=[],o.options.__e(t,e.__v),!0}})),l=[]}o.options.__r=function(e){u&&u(e),n=0;var t=(a=e.__c).__H;t&&(t.__h.forEach(P),t.__h.forEach(x),t.__h=[])},o.options.diffed=function(e){c&&c(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==l.push(t)&&i===o.options.requestAnimationFrame||((i=o.options.requestAnimationFrame)||function(e){var t,r=function(){clearTimeout(n),C&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(r,100);C&&(t=requestAnimationFrame(r))})(S))},o.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(P),e.__h=e.__h.filter((function(e){return!e.__||x(e)}))}catch(r){t.some((function(e){e.__h&&(e.__h=[])})),t=[],o.options.__e(r,e.__v)}})),d&&d(e,t)},o.options.unmount=function(e){p&&p(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(P)}catch(e){o.options.__e(e,t.__v)}};var C="function"==typeof requestAnimationFrame;function P(e){"function"==typeof e.u&&e.u()}function x(e){e.u=e.__()}function w(e,t){return!e||t.some((function(t,r){return t!==e[r]}))}function I(e,t){return"function"==typeof t?t(e):t}},"./node_modules/prop-types/checkPropTypes.js":function(module,e,t){"use strict";var r=function(){},n=t("./node_modules/prop-types/lib/ReactPropTypesSecret.js"),a={},i=Function.call.bind(Object.prototype.hasOwnProperty);function s(e,t,s,l,u){for(var c in e)if(i(e,c)){var d;try{if("function"!=typeof e[c]){var p=Error((l||"React class")+": "+s+" type `"+c+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+o(e[c])+"`.");throw p.name="Invariant Violation",p}d=e[c](t,c,l,s,null,n)}catch(e){d=e}if(!d||d instanceof Error||r((l||"React class")+": type specification of "+s+" `"+c+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+o(d)+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),d instanceof Error&&!(d.message in a)){a[d.message]=!0;var h=u?u():"";r("Failed "+s+" type: "+d.message+(null!=h?h:""))}}}r=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}},s.resetWarningCache=function(){a={}},module.exports=s},"./node_modules/prop-types/factoryWithTypeCheckers.js":function(module,e,t){"use strict";var r=t("./node_modules/react-is/index.js"),n=t("./node_modules/object-assign/index.js"),a=t("./node_modules/prop-types/lib/ReactPropTypesSecret.js"),i=t("./node_modules/prop-types/checkPropTypes.js"),s=Function.call.bind(Object.prototype.hasOwnProperty),l=function(){};function u(){return null}l=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}},module.exports=function(e,t){var c="function"==typeof Symbol&&Symbol.iterator,d="@@iterator",p="<<anonymous>>",h={array:y("array"),bool:y("boolean"),func:y("function"),number:y("number"),object:y("object"),string:y("string"),symbol:y("symbol"),any:g(u),arrayOf:function(e){return g((function(t,r,n,i,o){if("function"!=typeof e)return new m("Property `"+o+"` of component `"+n+"` has invalid PropType notation inside arrayOf.");var s=t[r];if(!Array.isArray(s))return new m("Invalid "+i+" `"+o+"` of type `"+_(s)+"` supplied to `"+n+"`, expected an array.");for(var l=0;l<s.length;l++){var u=e(s,l,n,i,o+"["+l+"]",a);if(u instanceof Error)return u}return null}))},element:g((function(t,r,n,a,i){var o=t[r];return e(o)?null:new m("Invalid "+a+" `"+i+"` of type `"+_(o)+"` supplied to `"+n+"`, expected a single ReactElement.")})),elementType:g((function(e,t,n,a,i){var o=e[t];return r.isValidElementType(o)?null:new m("Invalid "+a+" `"+i+"` of type `"+_(o)+"` supplied to `"+n+"`, expected a single ReactElement type.")})),instanceOf:function(e){return g((function(t,r,n,a,i){if(!(t[r]instanceof e)){var o=e.name||p;return new m("Invalid "+a+" `"+i+"` of type `"+((s=t[r]).constructor&&s.constructor.name?s.constructor.name:p)+"` supplied to `"+n+"`, expected instance of `"+o+"`.")}var s;return null}))},node:g((function(e,t,r,n,a){return v(e[t])?null:new m("Invalid "+n+" `"+a+"` supplied to `"+r+"`, expected a ReactNode.")})),objectOf:function(e){return g((function(t,r,n,i,o){if("function"!=typeof e)return new m("Property `"+o+"` of component `"+n+"` has invalid PropType notation inside objectOf.");var l=t[r],u=_(l);if("object"!==u)return new m("Invalid "+i+" `"+o+"` of type `"+u+"` supplied to `"+n+"`, expected an object.");for(var c in l)if(s(l,c)){var d=e(l,c,n,i,o+"."+c,a);if(d instanceof Error)return d}return null}))},oneOf:function(e){return Array.isArray(e)?g((function(t,r,n,a,i){for(var o=t[r],s=0;s<e.length;s++)if(f(o,e[s]))return null;var l=JSON.stringify(e,(function(e,t){return"symbol"===k(t)?String(t):t}));return new m("Invalid "+a+" `"+i+"` of value `"+String(o)+"` supplied to `"+n+"`, expected one of "+l+".")})):(l(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),u)},oneOfType:function(e){if(!Array.isArray(e))return l("Invalid argument supplied to oneOfType, expected an instance of array."),u;for(var t=0;t<e.length;t++){var r=e[t];if("function"!=typeof r)return l("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+E(r)+" at index "+t+"."),u}return g((function(t,r,n,i,o){for(var s=0;s<e.length;s++)if(null==(0,e[s])(t,r,n,i,o,a))return null;return new m("Invalid "+i+" `"+o+"` supplied to `"+n+"`.")}))},shape:function(e){return g((function(t,r,n,i,o){var s=t[r],l=_(s);if("object"!==l)return new m("Invalid "+i+" `"+o+"` of type `"+l+"` supplied to `"+n+"`, expected `object`.");for(var u in e){var c=e[u];if(c){var d=c(s,u,n,i,o+"."+u,a);if(d)return d}}return null}))},exact:function(e){return g((function(t,r,i,o,s){var l=t[r],u=_(l);if("object"!==u)return new m("Invalid "+o+" `"+s+"` of type `"+u+"` supplied to `"+i+"`, expected `object`.");var c=n({},t[r],e);for(var d in c){var p=e[d];if(!p)return new m("Invalid "+o+" `"+s+"` key `"+d+"` supplied to `"+i+"`.\nBad object: "+JSON.stringify(t[r],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var h=p(l,d,i,o,s+"."+d,a);if(h)return h}return null}))}};function f(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function m(e){this.message=e,this.stack=""}function g(e){var r={},n=0;function i(i,o,s,u,c,d,h){if(u=u||p,d=d||s,h!==a){if(t){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}if("undefined"!=typeof console){var g=u+":"+s;!r[g]&&n<3&&(l("You are manually calling a React.PropTypes validation function for the `"+d+"` prop on `"+u+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),r[g]=!0,n++)}}return null==o[s]?i?null===o[s]?new m("The "+c+" `"+d+"` is marked as required in `"+u+"`, but its value is `null`."):new m("The "+c+" `"+d+"` is marked as required in `"+u+"`, but its value is `undefined`."):null:e(o,s,u,c,d)}var o=i.bind(null,!1);return o.isRequired=i.bind(null,!0),o}function y(e){return g((function(t,r,n,a,i,o){var s=t[r];return _(s)!==e?new m("Invalid "+a+" `"+i+"` of type `"+k(s)+"` supplied to `"+n+"`, expected `"+e+"`."):null}))}function v(t){switch(o(t)){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(v);if(null===t||e(t))return!0;var r=function(e){var t=e&&(c&&e[c]||e[d]);if("function"==typeof t)return t}(t);if(!r)return!1;var n,a=r.call(t);if(r!==t.entries){for(;!(n=a.next()).done;)if(!v(n.value))return!1}else for(;!(n=a.next()).done;){var i=n.value;if(i&&!v(i[1]))return!1}return!0;default:return!1}}function _(e){var t=o(e);return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||!!t&&("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function k(e){if(null==e)return""+e;var t=_(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function E(e){var t=k(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return m.prototype=Error.prototype,h.checkPropTypes=i,h.resetWarningCache=i.resetWarningCache,h.PropTypes=h,h}},"./node_modules/prop-types/index.js":function(module,e,t){var r=t("./node_modules/react-is/index.js");module.exports=t("./node_modules/prop-types/factoryWithTypeCheckers.js")(r.isElement,!0)},"./node_modules/prop-types/lib/ReactPropTypesSecret.js":function(module){"use strict";module.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},"./node_modules/react-is/cjs/react-is.development.js":function(e,t){"use strict";!function(){var e="function"==typeof Symbol&&Symbol.for,r=e?Symbol.for("react.element"):60103,n=e?Symbol.for("react.portal"):60106,a=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,s=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,u=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,h=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,m=e?Symbol.for("react.memo"):60115,g=e?Symbol.for("react.lazy"):60116,y=e?Symbol.for("react.block"):60121,v=e?Symbol.for("react.fundamental"):60117,_=e?Symbol.for("react.responder"):60118,k=e?Symbol.for("react.scope"):60119;function E(e){if("object"===o(e)&&null!==e){var t=e.$$typeof;switch(t){case r:var f=e.type;switch(f){case c:case d:case a:case s:case i:case h:return f;default:var y=f&&f.$$typeof;switch(y){case u:case p:case g:case m:case l:return y;default:return t}}case n:return t}}}var b=c,T=d,A=u,S=l,C=r,P=p,x=a,w=g,I=m,M=n,R=s,D=i,O=h,L=!1;function N(e){return E(e)===d}t.AsyncMode=b,t.ConcurrentMode=T,t.ContextConsumer=A,t.ContextProvider=S,t.Element=C,t.ForwardRef=P,t.Fragment=x,t.Lazy=w,t.Memo=I,t.Portal=M,t.Profiler=R,t.StrictMode=D,t.Suspense=O,t.isAsyncMode=function(e){return L||(L=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),N(e)||E(e)===c},t.isConcurrentMode=N,t.isContextConsumer=function(e){return E(e)===u},t.isContextProvider=function(e){return E(e)===l},t.isElement=function(e){return"object"===o(e)&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return E(e)===p},t.isFragment=function(e){return E(e)===a},t.isLazy=function(e){return E(e)===g},t.isMemo=function(e){return E(e)===m},t.isPortal=function(e){return E(e)===n},t.isProfiler=function(e){return E(e)===s},t.isStrictMode=function(e){return E(e)===i},t.isSuspense=function(e){return E(e)===h},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===d||e===s||e===i||e===h||e===f||"object"===o(e)&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===u||e.$$typeof===p||e.$$typeof===v||e.$$typeof===_||e.$$typeof===k||e.$$typeof===y)},t.typeOf=E}()},"./node_modules/react-is/index.js":function(module,e,t){"use strict";module.exports=t("./node_modules/react-is/cjs/react-is.development.js")},"./node_modules/react-redux/es/components/Context.js":function(e,t,r){"use strict";r.r(t),r.d(t,{ReactReduxContext:function(){return n}});var n=r("./node_modules/preact/compat/dist/compat.module.js").default.createContext(null);n.displayName="ReactRedux",t.default=n},"./node_modules/react-redux/es/components/Provider.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/preact/compat/dist/compat.module.js"),a=r("./node_modules/prop-types/index.js"),i=r.n(a),o=r("./node_modules/react-redux/es/components/Context.js"),s=r("./node_modules/react-redux/es/utils/Subscription.js");function l(e){var t=e.store,r=e.context,a=e.children,i=(0,n.useMemo)((function(){var e=new s.default(t);return e.onStateChange=e.notifyNestedSubs,{store:t,subscription:e}}),[t]),l=(0,n.useMemo)((function(){return t.getState()}),[t]);(0,n.useEffect)((function(){var e=i.subscription;return e.trySubscribe(),l!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[i,l]);var u=r||o.ReactReduxContext;return n.default.createElement(u.Provider,{value:i},a)}l.propTypes={store:i().shape({subscribe:i().func.isRequired,dispatch:i().func.isRequired,getState:i().func.isRequired}),context:i().object,children:i().any},t.default=l},"./node_modules/react-redux/es/components/connectAdvanced.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});var n=r("./node_modules/@babel/runtime/helpers/esm/extends.js"),a=r("./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),i=r("./node_modules/hoist-non-react-statics/dist/hoist-non-react-statics.cjs.js"),o=r.n(i),s=r("./node_modules/preact/compat/dist/compat.module.js"),l=r("./node_modules/react-is/index.js"),u=r("./node_modules/react-redux/es/utils/Subscription.js"),c=r("./node_modules/react-redux/es/utils/useIsomorphicLayoutEffect.js"),d=r("./node_modules/react-redux/es/components/Context.js"),p=[],h=[null,null],f=function(e){try{return JSON.stringify(e)}catch(t){return String(e)}};function m(e,t){var r=e[1];return[t.payload,r+1]}function g(e,t,r){(0,c.useIsomorphicLayoutEffect)((function(){return e.apply(void 0,t)}),r)}function y(e,t,r,n,a,i,o){e.current=n,t.current=a,r.current=!1,i.current&&(i.current=null,o())}function v(e,t,r,n,a,i,o,s,l,u){if(e){var c=!1,d=null,p=function(){if(!c){var e,r,p=t.getState();try{e=n(p,a.current)}catch(e){r=e,d=e}r||(d=null),e===i.current?o.current||l():(i.current=e,s.current=e,o.current=!0,u({type:"STORE_UPDATED",payload:{error:r}}))}};return r.onStateChange=p,r.trySubscribe(),p(),function(){if(c=!0,r.tryUnsubscribe(),r.onStateChange=null,d)throw d}}}var _=function(){return[null,0]};function k(e,t){void 0===t&&(t={});var r=t,i=r.getDisplayName,c=void 0===i?function(e){return"ConnectAdvanced("+e+")"}:i,k=r.methodName,E=void 0===k?"connectAdvanced":k,b=r.renderCountProp,T=void 0===b?void 0:b,A=r.shouldHandleStateChanges,S=void 0===A||A,C=r.storeKey,P=void 0===C?"store":C,x=r.withRef,w=void 0!==x&&x,I=r.forwardRef,M=void 0!==I&&I,R=r.context,D=void 0===R?d.ReactReduxContext:R,O=(0,a.default)(r,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]);if(void 0!==T)throw new Error("renderCountProp is removed. render counting is built into the latest React Dev Tools profiling extension");if(w)throw new Error("withRef is removed. To access the wrapped instance, use a ref on the connected component");if("store"!==P)throw new Error("storeKey has been removed and does not do anything. To use a custom Redux store for specific components, create a custom React context with React.createContext(), and pass the context object to React Redux's Provider and specific components like: <Provider context={MyContext}><ConnectedComponent context={MyContext} /></Provider>. You may also pass a {context : MyContext} option to connect");var L=D;return function(t){if(!(0,l.isValidElementType)(t))throw new Error("You must pass a component to the function returned by "+E+". Instead received "+f(t));var r=t.displayName||t.name||"Component",i=c(r),d=(0,n.default)({},O,{getDisplayName:c,methodName:E,renderCountProp:T,shouldHandleStateChanges:S,storeKey:P,displayName:i,wrappedComponentName:r,WrappedComponent:t}),k=O.pure,b=k?s.useMemo:function(e){return e()};function A(r){var o=(0,s.useMemo)((function(){var e=r.reactReduxForwardedRef,t=(0,a.default)(r,["reactReduxForwardedRef"]);return[r.context,e,t]}),[r]),c=o[0],f=o[1],k=o[2],E=(0,s.useMemo)((function(){return c&&c.Consumer&&(0,l.isContextConsumer)(s.default.createElement(c.Consumer,null))?c:L}),[c,L]),T=(0,s.useContext)(E),A=Boolean(r.store)&&Boolean(r.store.getState)&&Boolean(r.store.dispatch),C=Boolean(T)&&Boolean(T.store);if(!A&&!C)throw new Error('Could not find "store" in the context of "'+i+'". Either wrap the root component in a <Provider>, or pass a custom React context provider to <Provider> and the corresponding React context consumer to '+i+" in connect options.");var P=A?r.store:T.store,x=(0,s.useMemo)((function(){return function(t){return e(t.dispatch,d)}(P)}),[P]),w=(0,s.useMemo)((function(){if(!S)return h;var e=new u.default(P,A?null:T.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[P,A,T]),I=w[0],M=w[1],R=(0,s.useMemo)((function(){return A?T:(0,n.default)({},T,{subscription:I})}),[A,T,I]),D=(0,s.useReducer)(m,p,_),O=D[0][0],N=D[1];if(O&&O.error)throw O.error;var U=(0,s.useRef)(),j=(0,s.useRef)(k),B=(0,s.useRef)(),F=(0,s.useRef)(!1),V=b((function(){return B.current&&k===j.current?B.current:x(P.getState(),k)}),[P,O,k]);g(y,[j,U,F,k,V,B,M]),g(v,[S,P,I,x,j,U,F,B,M,N],[P,I,x]);var H=(0,s.useMemo)((function(){return s.default.createElement(t,(0,n.default)({},V,{ref:f}))}),[f,t,V]);return(0,s.useMemo)((function(){return S?s.default.createElement(E.Provider,{value:R},H):H}),[E,H,R])}var C=k?s.default.memo(A):A;if(C.WrappedComponent=t,C.displayName=i,M){var x=s.default.forwardRef((function(e,t){return s.default.createElement(C,(0,n.default)({},e,{reactReduxForwardedRef:t}))}));return x.displayName=i,x.WrappedComponent=t,o()(x,t)}return o()(C,t)}}},"./node_modules/react-redux/es/connect/connect.js":function(e,t,r){"use strict";r.r(t),r.d(t,{createConnect:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/esm/extends.js"),a=r("./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),i=r("./node_modules/react-redux/es/components/connectAdvanced.js"),s=r("./node_modules/react-redux/es/utils/shallowEqual.js"),l=r("./node_modules/react-redux/es/connect/mapDispatchToProps.js"),u=r("./node_modules/react-redux/es/connect/mapStateToProps.js"),c=r("./node_modules/react-redux/es/connect/mergeProps.js"),d=r("./node_modules/react-redux/es/connect/selectorFactory.js");function p(e,t,r){for(var n=t.length-1;n>=0;n--){var a=t[n](e);if(a)return a}return function(t,n){throw new Error("Invalid value of type "+o(e)+" for "+r+" argument when connecting component "+n.wrappedComponentName+".")}}function h(e,t){return e===t}function f(e){var t=void 0===e?{}:e,r=t.connectHOC,o=void 0===r?i.default:r,f=t.mapStateToPropsFactories,m=void 0===f?u.default:f,g=t.mapDispatchToPropsFactories,y=void 0===g?l.default:g,v=t.mergePropsFactories,_=void 0===v?c.default:v,k=t.selectorFactory,E=void 0===k?d.default:k;return function(e,t,r,i){void 0===i&&(i={});var l=i,u=l.pure,c=void 0===u||u,d=l.areStatesEqual,f=void 0===d?h:d,g=l.areOwnPropsEqual,v=void 0===g?s.default:g,k=l.areStatePropsEqual,b=void 0===k?s.default:k,T=l.areMergedPropsEqual,A=void 0===T?s.default:T,S=(0,a.default)(l,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),C=p(e,m,"mapStateToProps"),P=p(t,y,"mapDispatchToProps"),x=p(r,_,"mergeProps");return o(E,(0,n.default)({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:C,initMapDispatchToProps:P,initMergeProps:x,pure:c,areStatesEqual:f,areOwnPropsEqual:v,areStatePropsEqual:b,areMergedPropsEqual:A},S))}}t.default=f()},"./node_modules/react-redux/es/connect/mapDispatchToProps.js":function(e,t,r){"use strict";r.r(t),r.d(t,{whenMapDispatchToPropsIsFunction:function(){return i},whenMapDispatchToPropsIsMissing:function(){return s},whenMapDispatchToPropsIsObject:function(){return l}});var n=r("./node_modules/redux/es/redux.js"),a=r("./node_modules/react-redux/es/connect/wrapMapToProps.js");function i(e){return"function"==typeof e?(0,a.wrapMapToPropsFunc)(e,"mapDispatchToProps"):void 0}function s(e){return e?void 0:(0,a.wrapMapToPropsConstant)((function(e){return{dispatch:e}}))}function l(e){return e&&"object"===o(e)?(0,a.wrapMapToPropsConstant)((function(t){return(0,n.bindActionCreators)(e,t)})):void 0}t.default=[i,s,l]},"./node_modules/react-redux/es/connect/mapStateToProps.js":function(e,t,r){"use strict";r.r(t),r.d(t,{whenMapStateToPropsIsFunction:function(){return a},whenMapStateToPropsIsMissing:function(){return i}});var n=r("./node_modules/react-redux/es/connect/wrapMapToProps.js");function a(e){return"function"==typeof e?(0,n.wrapMapToPropsFunc)(e,"mapStateToProps"):void 0}function i(e){return e?void 0:(0,n.wrapMapToPropsConstant)((function(){return{}}))}t.default=[a,i]},"./node_modules/react-redux/es/connect/mergeProps.js":function(e,t,r){"use strict";r.r(t),r.d(t,{defaultMergeProps:function(){return i},whenMergePropsIsFunction:function(){return s},whenMergePropsIsOmitted:function(){return l},wrapMergePropsFunc:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/extends.js"),a=r("./node_modules/react-redux/es/utils/verifyPlainObject.js");function i(e,t,r){return(0,n.default)({},r,{},e,{},t)}function o(e){return function(t,r){var n,i=r.displayName,o=r.pure,s=r.areMergedPropsEqual,l=!1;return function(t,r,u){var c=e(t,r,u);return l?o&&s(c,n)||(n=c):(l=!0,n=c,(0,a.default)(n,i,"mergeProps")),n}}}function s(e){return"function"==typeof e?o(e):void 0}function l(e){return e?void 0:function(){return i}}t.default=[s,l]},"./node_modules/react-redux/es/connect/selectorFactory.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s},impureFinalPropsSelectorFactory:function(){return i},pureFinalPropsSelectorFactory:function(){return o}});var n=r("./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),a=r("./node_modules/react-redux/es/connect/verifySubselectors.js");function i(e,t,r,n){return function(a,i){return r(e(a,i),t(n,i),i)}}function o(e,t,r,n,a){var i,o,s,l,u,c=a.areStatesEqual,d=a.areOwnPropsEqual,p=a.areStatePropsEqual,h=!1;function f(a,h){var f,m,g=!d(h,o),y=!c(a,i);return i=a,o=h,g&&y?(s=e(i,o),t.dependsOnOwnProps&&(l=t(n,o)),u=r(s,l,o)):g?(e.dependsOnOwnProps&&(s=e(i,o)),t.dependsOnOwnProps&&(l=t(n,o)),u=r(s,l,o)):y?(f=e(i,o),m=!p(f,s),s=f,m&&(u=r(s,l,o)),u):u}return function(a,c){return h?f(a,c):(s=e(i=a,o=c),l=t(n,o),u=r(s,l,o),h=!0,u)}}function s(e,t){var r=t.initMapStateToProps,s=t.initMapDispatchToProps,l=t.initMergeProps,u=(0,n.default)(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),c=r(e,u),d=s(e,u),p=l(e,u);return(0,a.default)(c,d,p,u.displayName),(u.pure?o:i)(c,d,p,e,u)}},"./node_modules/react-redux/es/connect/verifySubselectors.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/react-redux/es/utils/warning.js");function a(e,t,r){if(!e)throw new Error("Unexpected value for "+t+" in "+r+".");"mapStateToProps"!==t&&"mapDispatchToProps"!==t||Object.prototype.hasOwnProperty.call(e,"dependsOnOwnProps")||(0,n.default)("The selector for "+t+" of "+r+" did not specify a value for dependsOnOwnProps.")}function i(e,t,r,n){a(e,"mapStateToProps",n),a(t,"mapDispatchToProps",n),a(r,"mergeProps",n)}},"./node_modules/react-redux/es/connect/wrapMapToProps.js":function(e,t,r){"use strict";r.r(t),r.d(t,{getDependsOnOwnProps:function(){return i},wrapMapToPropsConstant:function(){return a},wrapMapToPropsFunc:function(){return o}});var n=r("./node_modules/react-redux/es/utils/verifyPlainObject.js");function a(e){return function(t,r){var n=e(t,r);function a(){return n}return a.dependsOnOwnProps=!1,a}}function i(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function o(e,t){return function(r,a){var o=a.displayName,s=function(e,t){return s.dependsOnOwnProps?s.mapToProps(e,t):s.mapToProps(e)};return s.dependsOnOwnProps=!0,s.mapToProps=function(r,a){s.mapToProps=e,s.dependsOnOwnProps=i(e);var l=s(r,a);return"function"==typeof l&&(s.mapToProps=l,s.dependsOnOwnProps=i(l),l=s(r,a)),(0,n.default)(l,o,t),l},s}}},"./node_modules/react-redux/es/hooks/useDispatch.js":function(e,t,r){"use strict";r.r(t),r.d(t,{createDispatchHook:function(){return i},useDispatch:function(){return o}});var n=r("./node_modules/react-redux/es/components/Context.js"),a=r("./node_modules/react-redux/es/hooks/useStore.js");function i(e){void 0===e&&(e=n.ReactReduxContext);var t=e===n.ReactReduxContext?a.useStore:(0,a.createStoreHook)(e);return function(){return t().dispatch}}var o=i()},"./node_modules/react-redux/es/hooks/useReduxContext.js":function(e,t,r){"use strict";r.r(t),r.d(t,{useReduxContext:function(){return i}});var n=r("./node_modules/preact/compat/dist/compat.module.js"),a=r("./node_modules/react-redux/es/components/Context.js");function i(){var e=(0,n.useContext)(a.ReactReduxContext);if(!e)throw new Error("could not find react-redux context value; please ensure the component is wrapped in a <Provider>");return e}},"./node_modules/react-redux/es/hooks/useSelector.js":function(e,t,r){"use strict";r.r(t),r.d(t,{createSelectorHook:function(){return u},useSelector:function(){return c}});var n=r("./node_modules/preact/compat/dist/compat.module.js"),a=r("./node_modules/react-redux/es/hooks/useReduxContext.js"),i=r("./node_modules/react-redux/es/utils/Subscription.js"),o=r("./node_modules/react-redux/es/utils/useIsomorphicLayoutEffect.js"),s=r("./node_modules/react-redux/es/components/Context.js"),l=function(e,t){return e===t};function u(e){void 0===e&&(e=s.ReactReduxContext);var t=e===s.ReactReduxContext?a.useReduxContext:function(){return(0,n.useContext)(e)};return function(e,r){if(void 0===r&&(r=l),!e)throw new Error("You must pass a selector to useSelector");var a=t(),s=function(e,t,r,a){var s,l=(0,n.useReducer)((function(e){return e+1}),0)[1],u=(0,n.useMemo)((function(){return new i.default(r,a)}),[r,a]),c=(0,n.useRef)(),d=(0,n.useRef)(),p=(0,n.useRef)(),h=(0,n.useRef)(),f=r.getState();try{s=e!==d.current||f!==p.current||c.current?e(f):h.current}catch(e){throw c.current&&(e.message+="\nThe error may be correlated with this previous error:\n"+c.current.stack+"\n\n"),e}return(0,o.useIsomorphicLayoutEffect)((function(){d.current=e,p.current=f,h.current=s,c.current=void 0})),(0,o.useIsomorphicLayoutEffect)((function(){function e(){try{var e=d.current(r.getState());if(t(e,h.current))return;h.current=e}catch(e){c.current=e}l()}return u.onStateChange=e,u.trySubscribe(),e(),function(){return u.tryUnsubscribe()}}),[r,u]),s}(e,r,a.store,a.subscription);return(0,n.useDebugValue)(s),s}}var c=u()},"./node_modules/react-redux/es/hooks/useStore.js":function(e,t,r){"use strict";r.r(t),r.d(t,{createStoreHook:function(){return o},useStore:function(){return s}});var n=r("./node_modules/preact/compat/dist/compat.module.js"),a=r("./node_modules/react-redux/es/components/Context.js"),i=r("./node_modules/react-redux/es/hooks/useReduxContext.js");function o(e){void 0===e&&(e=a.ReactReduxContext);var t=e===a.ReactReduxContext?i.useReduxContext:function(){return(0,n.useContext)(e)};return function(){return t().store}}var s=o()},"./node_modules/react-redux/es/index.js":function(e,t,r){"use strict";r.r(t),r.d(t,{Provider:function(){return n.default},ReactReduxContext:function(){return i.ReactReduxContext},batch:function(){return d.unstable_batchedUpdates},connect:function(){return o.default},connectAdvanced:function(){return a.default},createDispatchHook:function(){return s.createDispatchHook},createSelectorHook:function(){return l.createSelectorHook},createStoreHook:function(){return u.createStoreHook},shallowEqual:function(){return p.default},useDispatch:function(){return s.useDispatch},useSelector:function(){return l.useSelector},useStore:function(){return u.useStore}});var n=r("./node_modules/react-redux/es/components/Provider.js"),a=r("./node_modules/react-redux/es/components/connectAdvanced.js"),i=r("./node_modules/react-redux/es/components/Context.js"),o=r("./node_modules/react-redux/es/connect/connect.js"),s=r("./node_modules/react-redux/es/hooks/useDispatch.js"),l=r("./node_modules/react-redux/es/hooks/useSelector.js"),u=r("./node_modules/react-redux/es/hooks/useStore.js"),c=r("./node_modules/react-redux/es/utils/batch.js"),d=r("./node_modules/react-redux/es/utils/reactBatchedUpdates.js"),p=r("./node_modules/react-redux/es/utils/shallowEqual.js");(0,c.setBatch)(d.unstable_batchedUpdates)},"./node_modules/react-redux/es/utils/Subscription.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/react-redux/es/utils/batch.js"),a={notify:function(){}},i=function(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=a,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){var e,t,r;this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=(e=(0,n.getBatch)(),t=null,r=null,{clear:function(){t=null,r=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],r=t;r;)e.push(r),r=r.next;return e},subscribe:function(e){var n=!0,a=r={callback:e,next:null,prev:r};return a.prev?a.prev.next=a:t=a,function(){n&&null!==t&&(n=!1,a.next?a.next.prev=a.prev:r=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}))},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=a)},e}()},"./node_modules/react-redux/es/utils/batch.js":function(e,t,r){"use strict";r.r(t),r.d(t,{getBatch:function(){return i},setBatch:function(){return a}});var n=function(e){e()},a=function(e){return n=e},i=function(){return n}},"./node_modules/react-redux/es/utils/isPlainObject.js":function(e,t,r){"use strict";function n(e){if("object"!==o(e)||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var r=t;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return t===r}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/react-redux/es/utils/reactBatchedUpdates.js":function(e,t,r){"use strict";r.r(t),r.d(t,{unstable_batchedUpdates:function(){return n.unstable_batchedUpdates}});var n=r("./node_modules/preact/compat/dist/compat.module.js")},"./node_modules/react-redux/es/utils/shallowEqual.js":function(e,t,r){"use strict";function n(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function a(e,t){if(n(e,t))return!0;if("object"!==o(e)||null===e||"object"!==o(t)||null===t)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(var i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(t,r[i])||!n(e[r[i]],t[r[i]]))return!1;return!0}r.r(t),r.d(t,{default:function(){return a}})},"./node_modules/react-redux/es/utils/useIsomorphicLayoutEffect.js":function(e,t,r){"use strict";r.r(t),r.d(t,{useIsomorphicLayoutEffect:function(){return a}});var n=r("./node_modules/preact/compat/dist/compat.module.js"),a="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?n.useLayoutEffect:n.useEffect},"./node_modules/react-redux/es/utils/verifyPlainObject.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/react-redux/es/utils/isPlainObject.js"),a=r("./node_modules/react-redux/es/utils/warning.js");function i(e,t,r){(0,n.default)(e)||(0,a.default)(r+"() in "+t+" must return a plain object. Instead received "+e+".")}},"./node_modules/react-redux/es/utils/warning.js":function(e,t,r){"use strict";function n(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/redux/es/redux.js":function(e,t,r){"use strict";r.r(t),r.d(t,{__DO_NOT_USE__ActionTypes:function(){return i},applyMiddleware:function(){return y},bindActionCreators:function(){return h},combineReducers:function(){return d},compose:function(){return g},createStore:function(){return l}});var n=r("./node_modules/symbol-observable/es/index.js"),a=function(){return Math.random().toString(36).substring(7).split("").join(".")},i={INIT:"@@redux/INIT"+a(),REPLACE:"@@redux/REPLACE"+a(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+a()}};function s(e){if("object"!==o(e)||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function l(e,t,r){var a;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(l)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var u=e,c=t,d=[],p=d,h=!1;function f(){p===d&&(p=d.slice())}function m(){if(h)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return c}function g(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(h)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return f(),p.push(e),function(){if(t){if(h)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,f();var r=p.indexOf(e);p.splice(r,1),d=null}}}function y(e){if(!s(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(h)throw new Error("Reducers may not dispatch actions.");try{h=!0,c=u(c,e)}finally{h=!1}for(var t=d=p,r=0;r<t.length;r++)(0,t[r])();return e}return y({type:i.INIT}),(a={dispatch:y,subscribe:g,getState:m,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");u=e,y({type:i.REPLACE})}})[n.default]=function(){var e,t=g;return(e={subscribe:function(e){if("object"!==o(e)||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(m())}return r(),{unsubscribe:t(r)}}})[n.default]=function(){return this},e},a}function u(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}function c(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function d(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var a=t[n];void 0===e[a]&&u('No reducer provided for key "'+a+'"'),"function"==typeof e[a]&&(r[a]=e[a])}var o,l,d=Object.keys(r);o={};try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:i.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:i.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+i.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(r)}catch(e){l=e}return function(e,t){if(void 0===e&&(e={}),l)throw l;var n=function(e,t,r,n){var a=Object.keys(t),o=r&&r.type===i.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(0===a.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!s(e))return"The "+o+' has unexpected type of "'+{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1]+'". Expected argument to be an object with the following keys: "'+a.join('", "')+'"';var l=Object.keys(e).filter((function(e){return!t.hasOwnProperty(e)&&!n[e]}));return l.forEach((function(e){n[e]=!0})),r&&r.type===i.REPLACE?void 0:l.length>0?"Unexpected "+(l.length>1?"keys":"key")+' "'+l.join('", "')+'" found in '+o+'. Expected to find one of the known reducer keys instead: "'+a.join('", "')+'". Unexpected keys will be ignored.':void 0}(e,r,t,o);n&&u(n);for(var a=!1,p={},h=0;h<d.length;h++){var f=d[h],m=r[f],g=e[f],y=m(g,t);if(void 0===y){var v=c(f,t);throw new Error(v)}p[f]=y,a=a||y!==g}return(a=a||d.length!==Object.keys(e).length)?p:e}}function p(e,t){return function(){return t(e.apply(this,arguments))}}function h(e,t){if("function"==typeof e)return p(e,t);if("object"!==o(e)||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":o(e))+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var r={};for(var n in e){var a=e[n];"function"==typeof a&&(r[n]=p(a,t))}return r}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r}function g(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function y(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},a={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},i=t.map((function(e){return e(a)}));return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(r,!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r,{dispatch:n=g.apply(void 0,i)(r.dispatch)})}}}function v(){}"string"==typeof v.name&&"isCrushed"!==v.name&&u('You are currently using minified code outside of NODE_ENV === "production". This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) to ensure you have the correct code for your production build.')},"./src/styles/style.scss":function(module,e,t){var r=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),n=t("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[1].use[1]!./node_modules/sass-loader/dist/cjs.js!./src/styles/style.scss");"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[module.id,n,""]]);var a={attributes:{id:"@playkit-js/playkit-js-ui"},insert:"head",singleton:!1};r(n,a),module.exports=n.locals||{}},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":function(module,e,t){"use strict";var r,n=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),i=[];function o(e){for(var t=-1,r=0;r<i.length;r++)if(i[r].identifier===e){t=r;break}return t}function s(e,t){for(var r={},n=[],a=0;a<e.length;a++){var s=e[a],l=t.base?s[0]+t.base:s[0],u=r[l]||0,c="".concat(l," ").concat(u);r[l]=u+1;var d=o(c),p={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(i[d].references++,i[d].updater(p)):i.push({identifier:c,updater:m(p,t),references:1}),n.push(c)}return n}function l(e){var r=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var i=t.nc;i&&(n.nonce=i)}if(Object.keys(n).forEach((function(e){r.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(r);else{var o=a(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(r)}return r}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,r,n){var a=r?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=c(t,a);else{var i=document.createTextNode(a),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function p(e,t,r){var n=r.css,a=r.media,i=r.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),i&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var h=null,f=0;function m(e,t){var r,n,a;if(t.singleton){var i=f++;r=h||(h=l(t)),n=d.bind(null,r,i,!1),a=d.bind(null,r,i,!0)}else r=l(t),n=p.bind(null,r,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else a()}}module.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=n());var r=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<r.length;n++){var a=o(r[n]);i[a].references--}for(var l=s(e,t),u=0;u<r.length;u++){var c=o(r[u]);0===i[c].references&&(i[c].updater(),i.splice(c,1))}r=l}}}},"./node_modules/symbol-observable/es/index.js":function(module,e,t){"use strict";t.r(e);var r,n=t("./node_modules/symbol-observable/es/ponyfill.js");module=t.hmd(module),r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t.g?t.g:module;var a=(0,n.default)(r);e.default=a},"./node_modules/symbol-observable/es/ponyfill.js":function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.r(t),r.d(t,{default:function(){return n}})},"@playkit-js/playkit-js":function(module){"use strict";module.exports=e},"./node_modules/@babel/runtime/helpers/esm/extends.js":function(e,t,r){"use strict";function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n.apply(this,arguments)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js":function(e,t,r){"use strict";function n(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}r.r(t),r.d(t,{default:function(){return n}})},"./translations/en.i18n.json":function(module){"use strict";module.exports=JSON.parse('{"en":{"controls":{"play":"Play","pause":"Pause","language":"Language","settings":"Settings","fullscreen":"Fullscreen","fullscreenExit":"Exit fullscreen","rewind":"Seek backwards","secondsRewind":"Seek {{seconds}} seconds backwards","forward":"Seek forward","secondsForward":"Seek {{seconds}} seconds forward","vrStereo":"vrStereo","closedCaptionsOn":"Disable Captions","closedCaptionsOff":"Enable Captions","live":"Live","mute":"Mute","unmute":"Unmute","next":"Next","prev":"Prev","startOver":"Start over","pictureInPicture":"Picture in picture","pictureInPictureExit":"Exit picture in picture","logo":"Logo","seekBarSlider":"Seek bar","readLess":"Less","readMore":"More"},"unmute":{"unmute":"Unmute"},"volume":{"muted_click_to_unmute":"Muted. Click to unmute","volume_click_to_mute":"{{vol}}% volume. Click to mute","ten_percent":"ten percent","twenty_percent":"twenty percent","thirty_percent":"thirty percent","fourty_percent":"forty percent","fifty_percent":"fifty percent","sixty_percent":"sixty percent","seventy_percent":"seventy percent","eighty_percent":"eighty percent","ninety_percent":"ninety percent","one_hundred_percent":"one hundred percent","volume_slider_aria_label":"Volume control, use the arrows to control the volume"},"copy":{"button":"Copy URL"},"settings":{"title":"Settings","audio":"Audio","quality":"Quality","speed":"Speed","speedNormal":"Normal","qualityAuto":"Auto","qualityHdLabel":"Quality is HD","quality4kLabel":"Quality is 4k","quality8kLabel":"Quality is 8k","advancedAudioDescription":"Advanced Audio Description"},"captions":{"captions":"Captions","advanced_captions_settings":"Advanced captions settings"},"overlay":{"close":"Close"},"error":{"default_error_title":"Something went wrong","default_error_message":"An error occurred, please try again later.","network_error_title":"There’s a problem with your network","network_error_message":"Please check your network connection and try again.","media_unavailable_error_title":"Media unavailable","media_unavailable_error_message":"This media has been restricted. Please obtain relevant permissions to access content.","text_error_title":"Text stream error","text_error_message":"Text stream error occurred","media_error_title":"Media stream error","media_error_message":"One or more media streams have failed.","manifest_error_title":"Play manifest error","manifest_error_message":"Error processing the play manifest.","streaming_error_title":"Cannot load stream","streaming_error_message":"A streaming protocol error occurred.","drm_error_message":"You don’t have permissions to view this media.","media_not_ready_error_title":"Media is being processed","media_not_ready_error_message":"Media is processing, check back soon.","geo_location_error_title":"Geo location unavailable","geo_location_error_message":"This content is unavailable in your region.","default_session_text":"Copy for customer care: session ID","retry":"Try again"},"ads":{"ad_notice":"Advertisement","learn_more":"Learn more","skip_ad":"Skip ad","skip_in":"Skip in"},"cvaa":{"title":"Advanced captions settings","sample_caption_tag":"Sample {{number}}","sample_custom_caption_tag":"Custom captions","set_custom_caption":"Set custom caption","edit_caption":"Edit caption","size_label":"Size","font_color_label":"Font color","font_alignment_label":"Font alignment","font_family_label":"Font family","font_style_label":"Font style","font_opacity_label":"Font opacity","background_color_label":"Background color","background_opacity_label":"Background opacity","apply":"Apply","caption_preview":"This is your caption preview"},"cast":{"play_on_tv":"Play on TV","disconnect_from_tv":"Disconnect from TV","status":{"connecting_to":"Connecting to","connected_to":"Connected to","playing_on":"Playing on"}},"playlist":{"prev":"Previous","next":"Next","up_next":"Up Next","up_next_in":"Up next in","cancel":"Cancel"},"pictureInPicture":{"overlay_text":"Playing in Picture In Picture mode"},"watermark":{"watermark_alt_text":"Watermark"}}}')}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var module=r[e]={id:e,loaded:!1,exports:{}};return t[e].call(module.exports,module,module.exports,n),module.loaded=!0,module.exports}return n.n=function(module){var e=module&&module.__esModule?function(){return module.default}:function(){return module};return n.d(e,{a:e}),e},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===("undefined"==typeof globalThis?"undefined":o(globalThis)))return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===("undefined"==typeof window?"undefined":o(window)))return window}}(),n.hmd=function(module){return(module=Object.create(module)).children||(module.children=[]),Object.defineProperty(module,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+module.id)}}),module},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0,n("./src/index.ts")}()},"object"===o(e)&&"object"===o(module)?module.exports=i(t(771)):(n=[t(771)],void 0===(a="function"==typeof(r=i)?r.apply(e,n):r)||(module.exports=a))},538:(module,e,t)=>{var r,n,a,i;function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}module=t.nmd(module),self,i=function(){return function(){var e={"./src/ads/ad-break-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdBreakType:function(){return n}});var n={PRE:"preroll",MID:"midroll",POST:"postroll",OVERLAY:"overlay"}},"./src/ads/ad-error-code.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdErrorCode:function(){return n}});var n={XML_PARSING_ERROR:8100,VAST_SCHEMA_VALIDATION_ERROR:8101,VAST_RESPONSE_VERSION_NOT_SUPPORTED:8102,TRAFFICKING_ERROR:8200,VAST_UNEXPECTED_LINEARITY:8201,VAST_UNEXPECTED_DURATION_ERROR:8202,VAST_UNEXPECTED_SIZE_ERROR:8203,VAST_WRAPPER_ERROR:8300,VAST_URI_ERROR:8301,VAST_TOO_MANY_REDIRECTS:8302,NO_ADS_VAST_RESPONSE:8303,GENERAL_LINEAR_ERROR:8400,FILE_NOT_FOUND:8401,VAST_MEDIA_LOAD_TIMEOUT:8402,MEDIA_FILE_NOT_FOUND:8403,MEDIA_FILE_DISPLAY_ERROR:8405,MEZZANINE_FILE_NOT_PROVIDED:8406,MEZZANINE_DOWNLOADED_FOR_THE_FIRST_TIME:8407,VAST_RESPONSE_AD_REJECTED:8408,CREATIVE_WAS_NOT_EXECUTED:8409,CODE_REFERENCED_NOT_EXECUTED:8410,GENERAL_NON_LINEAR_AD_ERROR:8500,NON_LINEAR_CREATIVE_DIMENSIONS_NOT_ALIGN_ERROR:8501,NON_LINEAR_FETCH_ERROR:8502,NON_LINEAR_RESOURCE_NOT_FOUND:8503,GENERAL_COMPANION_ADS_ERROR:8600,COMPANION_DIMENSIONS_NOT_FIT:8601,COMPANION_CANNOT_BE_DISPLAY:8602,COMPANION_CANNOT_BE_FETCHED:8603,COMPANION_TYPE_NOT_FOUND:8604,AD_UNDEFINED_ERROR:8900,GENERAL_VPAID_ERROR:8901}},"./src/ads/ad-event-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdEventType:function(){return n}});var n={AD_CAN_SKIP:"adcanskip",AD_MANIFEST_LOADED:"admanifestloaded",AD_LOADED:"adloaded",AD_STARTED:"adstarted",AD_RESUMED:"adresumed",AD_PAUSED:"adpaused",AD_CLICKED:"adclicked",AD_SKIPPED:"adskipped",AD_COMPLETED:"adcompleted",AD_ERROR:"aderror",ADS_COMPLETED:"adscompleted",ALL_ADS_COMPLETED:"alladscompleted",AD_BREAK_START:"adbreakstart",AD_BREAK_END:"adbreakend",AD_FIRST_QUARTILE:"adfirstquartile",AD_MIDPOINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",USER_CLOSED_AD:"userclosedad",AD_VOLUME_CHANGED:"advolumechanged",AD_MUTED:"admuted",AD_PROGRESS:"adprogress",AD_BUFFERING:"adbuffering",AD_WATERFALLING:"adwaterfalling",AD_WATERFALLING_FAILED:"adwaterfallingfailed",AD_AUTOPLAY_FAILED:"adautoplayfailed"}},"./src/ads/ad-tag-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AdTagType:function(){return n}});var n={VAST:"vast",VMAP:"vmap"}},"./src/drm/drm-scheme.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{DrmScheme:function(){return n}});var n={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready",FAIRPLAY:"com.apple.fairplay"}},"./src/drm/fairplay.ts":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/drm/drm-scheme.ts"),o=(0,r("./src/utils/logger.ts").default)("FairPlay"),s=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"isConfigured",value:function(e,t){return i.DrmScheme.FAIRPLAY===t.keySystem&&!!e.find((function(e){return e.scheme===t.keySystem}))}},{key:"canPlayDrm",value:function(e){var t=e.some((function(e){return e.scheme===i.DrmScheme.FAIRPLAY}))&&!!window.WebKitMediaKeys;return o.debug("Can play DRM scheme of: ".concat(i.DrmScheme.FAIRPLAY," is ").concat(t.toString())),t}},{key:"setDrmPlayback",value:function(e,t){o.debug("Sets drm playback");var r=t.find((function(e){return e.scheme===i.DrmScheme.FAIRPLAY}));r&&(e.licenseUrl=r.licenseUrl,e.certificate=r.certificate)}}]),e}();t.default=s},"./src/engines/dropped-frames-watcher.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{DroppedFramesWatcher:function(){return y}});var n=r("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),s=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),l=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),u=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),c=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),d=r("./src/event/fake-event-target.ts"),p=r("./src/utils/logger.ts"),h=r("./src/event/event-type.ts"),f=r("./src/event/event-manager.ts"),m=r("./src/event/fake-event.ts");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}var y=function(e){(0,s.default)(r,e);var t=g(r);function r(e,n,i){var s;return(0,a.default)(this,r),s=t.call(this),(0,c.default)((0,o.default)(s),"_droppedFramesInterval",null),(0,c.default)((0,o.default)(s),"_lastDroppedFrames",0),(0,c.default)((0,o.default)(s),"_lastDecodedFrames",0),(0,c.default)((0,o.default)(s),"_lastTime",0),(0,c.default)((0,o.default)(s),"_currentBitrate",0),s._eventManager=new f.EventManager,s._mediaSourceAdapter=e,s._config=n,s._videoElement=i,s._mediaSourceAdapter.capabilities.fpsControl?(s._eventManager.listen(s._mediaSourceAdapter,h.CustomEventType.FPS_DROP,(function(e){return s._triggerFPSDrop(e.payload.data)})),(0,l.default)(s)):(-1===s._getDroppedAndDecodedFrames()[0]?r._logger.debug("Dropped frame watcher is not supported"):s._config.capLevelOnFPSDrop?(r._logger.debug("Initialized capLevelOnFPSDrop = true"),s._init()):r._logger.debug("Not Initialized"),s)}return(0,i.default)(r,[{key:"_init",value:function(){var e=this;this._eventManager.listen(this._mediaSourceAdapter,h.CustomEventType.VIDEO_TRACK_CHANGED,(function(t){return e._currentBitrate=t.payload.selectedVideoTrack.bandwidth})),this._droppedFramesInterval=setInterval((function(){return e._checkFPS()}),this._config.fpsDroppedFramesInterval)}},{key:"_triggerFPSDrop",value:function(e){this.dispatchEvent(new m.FakeEvent(h.CustomEventType.FPS_DROP,e))}},{key:"_getDroppedAndDecodedFrames",value:function(){if("function"==typeof this._videoElement.getVideoPlaybackQuality){var e=this._videoElement.getVideoPlaybackQuality();return[e.droppedVideoFrames,e.totalVideoFrames]}return"number"==typeof this._videoElement.webkitDroppedFrameCount&&"number"==typeof this._videoElement.webkitDecodedFrameCount?[this._videoElement.webkitDroppedFrameCount,this._videoElement.webkitDecodedFrameCount]:[-1,-1]}},{key:"_checkFPS",value:function(){var e=this._getDroppedAndDecodedFrames(),t=(0,n.default)(e,2),a=t[0],i=t[1];try{var o=performance.now();if(i){if(this._lastTime){var s=o-this._lastTime,l=a-this._lastDroppedFrames,u=i-this._lastDecodedFrames,c=1e3*l/s;c>0&&(r._logger.debug("checkFPS : droppedFPS/decodedFPS:"+c/(1e3*u/s)),l>this._config.fpsDroppedMonitoringThreshold*u&&(this._mediaSourceAdapter.setMaxBitrate(this._currentBitrate-1),this._triggerFPSDrop({currentDropped:l,currentDecoded:u,totalDroppedFrames:c})))}this._lastTime=o,this._lastDroppedFrames=a,this._lastDecodedFrames=i}}catch(e){r._logger.error("Error occur while trying to check dropFrames: ",e)}}},{key:"destroy",value:function(){this._droppedFramesInterval&&clearInterval(this._droppedFramesInterval),this._droppedFramesInterval=null,this._eventManager.destroy()}}]),r}(d.FakeEventTarget);(0,c.default)(y,"_logger",(0,p.default)("droppedFramesWatcher"))},"./src/engines/engine-decorator-manager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineDecoratorManager:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("./src/utils/logger.ts"),s=function(){function e(){(0,n.default)(this,e),(0,i.default)(this,"_decoratorProviders",new Map),(0,i.default)(this,"_logger",(0,o.default)("EngineDecoratorManager"))}return(0,a.default)(e,[{key:"register",value:function(e){this._decoratorProviders.has(e.getName())?this._logger.warn("decorator already registered for ".concat(e.getName())):this._decoratorProviders.set(e.getName(),e)}},{key:"createDecorators",value:function(e,t){return this._logger.debug("decorators created for ".concat(Array.from(this._decoratorProviders.keys()).toString())),Array.from(this._decoratorProviders.values(),(function(r){return r.getEngineDecorator(e,t)}))}},{key:"destroy",value:function(){this._logger.debug("decorators destroyed"),this._decoratorProviders.clear()}}]),e}()},"./src/engines/engine-decorator-provider.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineDecoratorProvider:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(t){(0,n.default)(this,e),this._name=t.getName(),this._getEngineDecorator=t.getEngineDecorator.bind(t)}return(0,a.default)(e,[{key:"getEngineDecorator",value:function(e,t){return this._getEngineDecorator(e,t)}},{key:"getName",value:function(){return this._name}}]),e}()},"./src/engines/engine-decorator.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineDecorator:function(){return h}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),o=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=r("./node_modules/@babel/runtime/helpers/esm/get.js"),u=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),c=r("./src/event/event-type.ts"),d=r("./src/event/event-manager.ts");function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var h=function(e){(0,o.default)(r,e);var t=p(r);function r(e,a){var o,p;return(0,n.default)(this,r),(p=t.call(this))._eventManager=new d.EventManager,p._pluginDecorators=a.createDecorators(e,(0,l.default)((o=(0,i.default)(p),(0,u.default)(r.prototype)),"dispatchEvent",o).bind((0,i.default)(p))),Object.values(c.EventType).forEach((function(t){return p._eventManager.listen(e,t,(function(e){return p.dispatchEvent(e)}))})),(0,s.default)(p,new Proxy(e,{get:function(e,t){"destroy"===t&&p._destroy();var r,n=p._pluginDecorators.find((function(e){return e.active}));return(r="addEventListener"===t||"removeEventListener"===t?(0,i.default)(p):n&&t in n?n:e)[t]&&"function"==typeof r[t].bind?r[t].bind(r):r[t]},set:function(e,t,r){var n=p._pluginDecorators.find((function(e){return t in e&&e.active}));return n&&t in n?n[t]=r:e[t]=r,!0}}))}return(0,a.default)(r,[{key:"dispatchEvent",value:function(e){var t=this._pluginDecorators.find((function(e){return e.active}));return t&&t.dispatchEvent?t.dispatchEvent(e):(0,l.default)((0,u.default)(r.prototype),"dispatchEvent",this).call(this,e)}},{key:"_destroy",value:function(){this._pluginDecorators=[],this._eventManager.destroy()}},{key:"active",get:function(){return!0}}]),r}(r("./src/event/fake-event-target.ts").FakeEventTarget)},"./src/engines/engine-provider.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineProvider:function(){return l},registerEngine:function(){return u},unRegisterEngine:function(){return c}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("./src/utils/logger.ts"),s=r("./src/engines/html5/html5.ts"),l=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"register",value:function(t,r){t&&!e._engineProviders[t]?(e._logger.debug("Engine <".concat(t,"> has been registered successfully")),e._engineProviders[t]=r):e._logger.debug("Engine <".concat(t,"> is already registered, do not register again"))}},{key:"unRegister",value:function(t){e._engineProviders[t]&&(e._logger.debug("Unregistered <".concat(t,"> Engine")),delete e._engineProviders[t])}},{key:"getEngines",value:function(){return Object.keys(e._engineProviders).map((function(t){return e._engineProviders[t]}))}},{key:"destroy",value:function(){e._engineProviders={}}}]),e}();(0,i.default)(l,"_logger",(0,o.default)("EngineProvider")),(0,i.default)(l,"_engineProviders",{}),s.default.isSupported()&&l.register(s.default.id,s.default);var u=l.register,c=l.unRegister},"./src/engines/engine-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EngineType:function(){return n}});var n={HTML5:"html5",FLASH:"flash",SILVERLIGHT:"silverlight",CAST:"cast",YOUTUBE:"youtube",IMAGE:"image",DOCUMENT:"document"}},"./src/engines/html5/capabilities/html5-autoplay.ts":function(e,t,r){"use strict";r.r(t);var n,a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/utils/util.ts"),l=r("./src/event/event-type.ts"),u=r("./src/utils/logger.ts"),c=r("./src/assets/encoding-sources.json"),d=(n=function(){function e(){(0,a.default)(this,e)}return(0,i.default)(e,null,[{key:"runCapability",value:function(){e._capabilities.autoplay||"boolean"==typeof e._capabilities.autoplay&&"boolean"==typeof e._capabilities.mutedAutoPlay?e._playPromiseResult=Promise.resolve(e._capabilities):(e._vid||(e._vid=s.Dom.createElement("video"),e._vid.src=c.Base64Mp4Source,e._vid.setAttribute("playsinline","")),e._playPromiseResult=new Promise((function(t){e._setMuted(!1),e._getPlayPromise().then((function(){return t({autoplay:!0,mutedAutoPlay:!0})})).catch((function(){e._setMuted(!0),e._getPlayPromise().then((function(){return t({autoplay:!1,mutedAutoPlay:!0})})).catch((function(){return t({autoplay:!1,mutedAutoPlay:!1})}))}))})))}},{key:"getCapability",value:function(){return e._playPromiseResult.then((function(t){var r;return t.autoplay?r=Promise.resolve(t):(e.runCapability(),r=e._playPromiseResult),r.then((function(t){return s.Object.mergeDeep(t,e._capabilities)}))}))}},{key:"setCapabilities",value:function(t){e._logger.debug("Set player capabilities",t);var r=t.autoplay,n=t.mutedAutoPlay;"boolean"==typeof r&&(e._capabilities.autoplay=r),"boolean"==typeof n&&(e._capabilities.mutedAutoPlay=n)}},{key:"_getPlayPromise",value:function(){return e._vid.play()||e._forcePromiseReturnValue()}},{key:"_setMuted",value:function(t){t?(e._vid.muted=!0,e._vid.setAttribute("muted","")):(e._vid.muted=!1,e._vid.removeAttribute("muted"))}},{key:"_forcePromiseReturnValue",value:function(){return new Promise((function(t,r){e._vid.addEventListener(l.Html5EventType.ERROR,(function(){r()}));var n=setTimeout((function(){e._logger.debug("Timeout ".concat(500," ms has been reached")),r()}),500);!0===e._vid.paused?(clearTimeout(n),r()):(clearTimeout(n),t())}))}}]),e}(),(0,o.default)(n,"_logger",(0,u.default)("Html5AutoPlayCapability")),(0,o.default)(n,"_capabilities",{}),n);t.default=d},"./src/engines/html5/cors-types.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CorsType:function(){return n}});var n={ANONYMOUS:"anonymous",USE_CREDENTIALS:"use-credentials"}},"./src/engines/html5/html5.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return T}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),o=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=r("./src/event/fake-event-target.ts"),d=r("./src/event/fake-event.ts"),p=r("./src/event/event-manager.ts"),h=r("./src/event/event-type.ts"),f=r("./src/engines/html5/media-source/media-source-provider.ts"),m=r("./src/track/text-track.ts"),g=r("./src/track/timed-metadata.ts"),y=r("./src/utils/util.ts"),v=r("./src/engines/html5/capabilities/html5-autoplay.ts"),_=r("./src/error/error.ts"),k=r("./src/utils/logger.ts"),E=r("./src/engines/dropped-frames-watcher.ts");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.default)(e);if(t){var a=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var T=function(e){(0,o.default)(r,e);var t=b(r);function r(e,a,o){var s;return(0,n.default)(this,r),s=t.call(this),(0,u.default)((0,i.default)(s),"_reset",!1),(0,u.default)((0,i.default)(s),"_cachedUrls",[]),s._eventManager=new p.EventManager,s._canLoadMediaSourceAdapterPromise=Promise.resolve(),s._createVideoElement(o),s._init(e,a),s}return(0,a.default)(r,[{key:"restore",value:function(e,t){this.reset(),this._init(e,t)}},{key:"reset",value:function(){var e=this;this._reset||(this._reset=!0,this._eventManager.removeAll(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=void 0),this._canLoadMediaSourceAdapterPromise=new Promise((function(t,r){var n=e._mediaSourceAdapter?e._mediaSourceAdapter.destroy():Promise.resolve();e._el&&e._el.src?n.then((function(){y.Dom.setAttribute(e._el,"src",""),y.Dom.removeAttribute(e._el,"src"),t()}),r):n.then(t,r)})),this._mediaSourceAdapter=null)}},{key:"destroy",value:function(){this.detach(),this._el&&(this.pause(),y.Dom.removeAttribute(this._el,"src"),y.Dom.removeChild(this._el.parentNode,this._el)),this._eventManager.destroy(),f.default.destroy(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=void 0),this._mediaSourceAdapter&&(this._mediaSourceAdapter.setCachedUrls([]),this._mediaSourceAdapter.destroy(),this._mediaSourceAdapter=null)}},{key:"mediaSourceAdapter",get:function(){return this._mediaSourceAdapter}},{key:"id",get:function(){return r.id}},{key:"attachMediaSource",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.attachMediaSource()}},{key:"detachMediaSource",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.detachMediaSource()}},{key:"attach",value:function(){var e=this;Object.keys(h.Html5EventType).forEach((function(t){[h.Html5EventType.ERROR,h.Html5EventType.WAITING].includes(h.Html5EventType[t])||e._eventManager.listen(e._el,h.Html5EventType[t],(function(){return e.dispatchEvent(new d.FakeEvent(h.Html5EventType[t]))}))})),this._eventManager.listen(this._el,h.Html5EventType.ERROR,(function(){return e._handleVideoError()})),this._eventManager.listen(this._el,h.Html5EventType.WAITING,(function(){return e._handleWaiting()})),this._handleMetadataTrackEvents(),this._eventManager.listen(this._el.textTracks,"addtrack",(function(t){m.PKTextTrack.isNativeTextTrack(t.track)&&e.dispatchEvent(new d.FakeEvent(h.CustomEventType.TEXT_TRACK_ADDED,{track:t.track}))}));var t=this._mediaSourceAdapter;t&&(this._eventManager.listen(t,h.CustomEventType.VIDEO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.AUDIO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.TEXT_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.IMAGE_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.TEXT_CUE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.TRACKS_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.Html5EventType.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.Html5EventType.TIME_UPDATE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.Html5EventType.PLAYING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.Html5EventType.WAITING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,h.CustomEventType.TIMED_METADATA_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,"hlsFragParsingMetadata",(function(t){return e.dispatchEvent(t)})),this._droppedFramesWatcher&&this._eventManager.listen(this._droppedFramesWatcher,h.CustomEventType.FPS_DROP,(function(t){return e.dispatchEvent(t)})))}},{key:"detach",value:function(){var e=this;Object.keys(h.Html5EventType).forEach((function(t){e._eventManager.unlisten(e._el,h.Html5EventType[t])})),this._mediaSourceAdapter&&(this._eventManager.unlisten(this._mediaSourceAdapter,h.CustomEventType.VIDEO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,h.CustomEventType.AUDIO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,h.CustomEventType.TEXT_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,h.CustomEventType.TEXT_CUE_CHANGED))}},{key:"getVideoElement",value:function(){return this._el}},{key:"selectVideoTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectVideoTrack(e)}},{key:"selectAudioTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectAudioTrack(e)}},{key:"selectTextTrack",value:function(e){this._removeCueChangeListeners(),this._mediaSourceAdapter&&this._mediaSourceAdapter.selectTextTrack(e),this.resetAllCues(),this._addCueChangeListener()}},{key:"selectImageTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectImageTrack(e)}},{key:"hideTextTrack",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.hideTextTrack(),this._removeCueChangeListeners()}},{key:"enableAdaptiveBitrate",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.enableAdaptiveBitrate()}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isAdaptiveBitrateEnabled()}},{key:"applyABRRestriction",value:function(e){if(this._mediaSourceAdapter)return this._mediaSourceAdapter.applyABRRestriction(e)}},{key:"seekToLiveEdge",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.seekToLiveEdge()}},{key:"isOnLiveEdge",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isOnLiveEdge()}},{key:"getStartTimeOfDvrWindow",value:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.getStartTimeOfDvrWindow():0}},{key:"isLive",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isLive()}},{key:"play",value:function(){var e=this,t=this._el.play();return t&&t.catch((function(t){return e.dispatchEvent(new d.FakeEvent(h.CustomEventType.PLAY_FAILED,{error:t}))})),t}},{key:"pause",value:function(){return this._el.pause()}},{key:"load",value:function(e){var t=this;return this._el.load(),this._canLoadMediaSourceAdapterPromise.then((function(){return t._mediaSourceAdapter?t._mediaSourceAdapter.load(e):Promise.resolve({})})).catch((function(e){return t.dispatchEvent(new d.FakeEvent(h.Html5EventType.ERROR,e)),Promise.reject(e)}))}},{key:"enterPictureInPicture",value:function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof this._el.requestPictureInPicture&&!this._el.disablePictureInPicture?this._el.requestPictureInPicture().catch((function(t){e.dispatchEvent(new d.FakeEvent(h.Html5EventType.ERROR,new _.default(_.default.Severity.RECOVERABLE,_.default.Category.PLAYER,_.default.Code.ENTER_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&(this._el.webkitSetPresentationMode("picture-in-picture"),setTimeout((function(){return e.dispatchEvent(new d.FakeEvent(h.Html5EventType.ENTER_PICTURE_IN_PICTURE))}),0))}catch(e){this.dispatchEvent(new d.FakeEvent(h.Html5EventType.ERROR,new _.default(_.default.Severity.RECOVERABLE,_.default.Category.PLAYER,_.default.Code.ENTER_PICTURE_IN_PICTURE_FAILED,e)))}}},{key:"exitPictureInPicture",value:function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof document.exitPictureInPicture&&this._el===document.pictureInPictureElement?document.exitPictureInPicture().catch((function(t){e.dispatchEvent(new d.FakeEvent(h.Html5EventType.ERROR,new _.default(_.default.Severity.RECOVERABLE,_.default.Category.PLAYER,_.default.Code.EXIT_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&this._el.webkitSetPresentationMode("inline")}catch(e){this.dispatchEvent(new d.FakeEvent(h.Html5EventType.ERROR,new _.default(_.default.Severity.RECOVERABLE,_.default.Category.PLAYER,_.default.Code.EXIT_PICTURE_IN_PICTURE_FAILED,e)))}}},{key:"isPictureInPictureSupported",value:function(){return"function"==typeof this._el.webkitSupportsPresentationMode?this._el.webkitSupportsPresentationMode("picture-in-picture"):!!document.pictureInPictureEnabled}},{key:"getThumbnail",value:function(e){return this._mediaSourceAdapter?this._mediaSourceAdapter.getThumbnail(e):null}},{key:"src",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.src:""},set:function(e){this._mediaSourceAdapter&&(this._mediaSourceAdapter.src=e)}},{key:"currentTime",get:function(){return this._el?this._el.currentTime:0},set:function(e){this._el&&(this._el.currentTime=e)}},{key:"duration",get:function(){return this._el.duration}},{key:"liveDuration",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.liveDuration:-1}},{key:"volume",get:function(){return this._el.volume},set:function(e){this._el.volume=e}},{key:"paused",get:function(){return this._el.paused}},{key:"seeking",get:function(){return this._el.seeking}},{key:"seekable",get:function(){return this._el.seekable}},{key:"played",get:function(){return this._el.played}},{key:"buffered",get:function(){return this._el.buffered}},{key:"muted",get:function(){return this._el.muted},set:function(e){this._el.muted=e}},{key:"defaultMuted",get:function(){return this._el.defaultMuted}},{key:"poster",get:function(){return this._el.poster},set:function(e){this._el.poster=e}},{key:"preload",get:function(){return this._el.preload},set:function(e){this._el.preload=e}},{key:"autoplay",get:function(){return this._el.autoplay},set:function(e){this._el.autoplay=e}},{key:"loop",get:function(){return this._el.loop},set:function(e){this._el.loop=e}},{key:"controls",get:function(){return this._el.controls},set:function(e){this._el.controls=e}},{key:"playbackRate",get:function(){return this._el.playbackRate},set:function(e){this._el.playbackRate=e}},{key:"defaultPlaybackRate",get:function(){return this._el.defaultPlaybackRate},set:function(e){this._el.defaultPlaybackRate=e}},{key:"ended",get:function(){return this._el.ended}},{key:"error",get:function(){return this._el.error}},{key:"networkState",get:function(){return this._el.networkState}},{key:"readyState",get:function(){return this._el.readyState}},{key:"videoHeight",get:function(){return this._el.videoHeight}},{key:"videoWidth",get:function(){return this._el.videoWidth}},{key:"playsinline",get:function(){return""===this._el.getAttribute("playsinline")},set:function(e){e?this._el.setAttribute("playsinline",""):this._el.removeAttribute("playsinline")}},{key:"crossOrigin",get:function(){return this._el.getAttribute("crossorigin")},set:function(e){"string"==typeof e?this._el.setAttribute("crossorigin",e):this._el.removeAttribute("crossorigin")}},{key:"playbackRates",get:function(){return r.PLAYBACK_RATES}},{key:"isInPictureInPicture",get:function(){return!!document.pictureInPictureElement&&null!==document.pictureInPictureElement&&this._el===document.pictureInPictureElement||!!this._el.webkitPresentationMode&&"picture-in-picture"===this._el.webkitPresentationMode}},{key:"_init",value:function(e,t){this._config=t,this._reset=!1,this._loadMediaSourceAdapter(e),this.attach()}},{key:"_createVideoElement",value:function(e){this._el=r.videoElementStore[e]||y.Dom.createElement("video"),this._el.id=y.Generator.uniqueId(5),this._el.controls=!1}},{key:"_loadMediaSourceAdapter",value:function(e){this._mediaSourceAdapter=f.default.getMediaSourceAdapter(this.getVideoElement(),e,this._config),this._mediaSourceAdapter&&(this._droppedFramesWatcher=new E.DroppedFramesWatcher(this._mediaSourceAdapter,this._config.abr,this._el),this._cachedUrls.length&&(this._mediaSourceAdapter.setCachedUrls(this._cachedUrls),this._cachedUrls=[]))}},{key:"_addCueChangeListener",value:function(){var e=this,t=Array.from(this._el.textTracks).find((function(e){return m.PKTextTrack.isNativeTextTrack(e)&&e.mode!==m.PKTextTrack.MODE.DISABLED}));t&&this._eventManager.listen(t,"cuechange",(function(t){return e._onCueChange(t)}))}},{key:"_removeCueChangeListeners",value:function(){var e=this;Array.from(this._el.textTracks).filter((function(e){return!m.PKTextTrack.isMetaDataTrack(e)})).forEach((function(t){e._eventManager.unlisten(t,"cuechange")}))}},{key:"_onCueChange",value:function(e){var t=e.currentTarget.activeCues,r=(0,m.getActiveCues)(t);this.dispatchEvent(new d.FakeEvent(h.CustomEventType.TEXT_CUE_CHANGED,{cues:r}))}},{key:"resetAllCues",value:function(){var e=Array.from(this._el.textTracks).find((function(e){return m.PKTextTrack.isNativeTextTrack(e)&&e.mode!==m.PKTextTrack.MODE.DISABLED}));if(e)for(var t=0;t<e.cues.length;t++)e.cues[t].hasBeenReset=!0}},{key:"_handleVideoError",value:function(){if(this._el.error){var e=this._el.error.code;if(e!==MediaError.MEDIA_ERR_ABORTED){var t=this._getMsExtendedError(),r=this._el.error.message;if(this._mediaSourceAdapter&&!this._mediaSourceAdapter.handleMediaError(this._el.error)){var n=new _.default(_.default.Severity.CRITICAL,_.default.Category.MEDIA,_.default.Code.VIDEO_ERROR,{code:e,extended:t,message:r});this.dispatchEvent(new d.FakeEvent(h.Html5EventType.ERROR,n))}}}}},{key:"_handleWaiting",value:function(){var e=this,t=!1;this._eventManager.listenOnce(this._el,h.Html5EventType.PLAYING,(function(){return t=!0})),setTimeout((function(){t||e.dispatchEvent(new d.FakeEvent(h.Html5EventType.WAITING))}),200)}},{key:"_getMsExtendedError",value:function(){var e=this._el.error.msExtendedCode;return e&&(e<0&&(e+=Math.pow(2,32)),e=e.toString(16)),e}},{key:"_handleMetadataTrackEvents",value:function(){var e=this,t=function(t){t.mode=m.PKTextTrack.MODE.HIDDEN,e._eventManager.listen(t,"cuechange",(function(){var t=[];Array.from(e._el.textTracks).forEach((function(e){m.PKTextTrack.isMetaDataTrack(e)&&(t=t.concat((0,m.getActiveCues)(e.activeCues)))})),t=t.sort((function(e,t){return e.startTime-t.startTime})),e.dispatchEvent(new d.FakeEvent(h.CustomEventType.TIMED_METADATA,{cues:t})),e.dispatchEvent(new d.FakeEvent(h.CustomEventType.TIMED_METADATA_CHANGE,{cues:t.map((function(e){return(0,g.createTimedMetadata)(e)}))}))}))};Array.from(this._el.textTracks).forEach((function(e){m.PKTextTrack.isMetaDataTrack(e)&&t(e)})),this._eventManager.listen(this._el.textTracks,"addtrack",(function(e){m.PKTextTrack.isMetaDataTrack(e.track)&&t(e.track)})),this._eventManager.listen(this._el.textTracks,"change",(function(){Array.from(e._el.textTracks).forEach((function(e){m.PKTextTrack.isMetaDataTrack(e)&&e.mode!==m.PKTextTrack.MODE.HIDDEN&&(e.mode=m.PKTextTrack.MODE.HIDDEN)}))}))}},{key:"targetBuffer",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.targetBuffer:NaN}},{key:"availableBuffer",get:function(){var e=0;if(this.buffered)for(var t=0;t<this.buffered.length;t++)this.buffered.start(t)<=this._el.currentTime&&this._el.currentTime<=this.buffered.end(t)&&(e=this.buffered.end(t)-this._el.currentTime);return e}},{key:"addTextTrack",value:function(e,t,r){return this._el.addTextTrack(e,t,r)}},{key:"getNativeTextTracks",value:function(){return Array.from(this._el.textTracks)}},{key:"getDrmInfo",value:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.getDrmInfo():null}},{key:"setCachedUrls",value:function(e){this._cachedUrls=e,this._mediaSourceAdapter&&(this._mediaSourceAdapter.setCachedUrls(e),this._cachedUrls=[])}}],[{key:"isSupported",value:function(){try{var e=y.Dom.createElement("video");return e.volume=.5,!!e.canPlayType}catch(e){return!1}}},{key:"createEngine",value:function(e,t,r){return new this(e,t,r)}},{key:"canPlaySource",value:function(e,t,r){return f.default.canPlaySource(e,t,r)}},{key:"runCapabilities",value:function(){r._capabilities.forEach((function(e){return e.runCapability()}))}},{key:"getCapabilities",value:function(){var e=[];return r._capabilities.forEach((function(t){return e.push(t.getCapability())})),Promise.all(e).then((function(e){var t={};return e.forEach((function(e){return Object.assign(t,e)})),(0,u.default)({},r.id,t)}))}},{key:"setCapabilities",value:function(e){r._capabilities.forEach((function(t){return t.setCapabilities(e)}))}},{key:"prepareVideoElement",value:function(e){if(!r.videoElementStore[e]){r._logger.debug("Create the video element for playing ".concat(e));var t=y.Dom.createElement("video");r.videoElementStore[e]=t}r._logger.debug("Prepare the video element for playing ".concat(e)),r.videoElementStore[e].load()}}]),r}(c.FakeEventTarget);(0,u.default)(T,"_logger",(0,k.default)("Html5")),(0,u.default)(T,"_capabilities",[v.default]),(0,u.default)(T,"id","html5"),(0,u.default)(T,"videoElementStore",{}),(0,u.default)(T,"PLAYBACK_RATES",[.5,1,1.5,2])},"./src/engines/html5/media-source/adapters/fairplay-drm-handler.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{FairPlayDrmHandler:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./src/error/error.ts"),l=r("./src/utils/logger.ts"),u=r("./src/utils/util.ts"),c=r("./src/enums/request-type.ts"),d=r("./src/drm/drm-scheme.ts"),p=r("./src/event/event-manager.ts"),h="com.apple.fps.1_0",f={NEED_KEY:"webkitneedkey",KEY_MESSAGE:"webkitkeymessage",KEY_ADDED:"webkitkeyadded",KEY_ERROR:"webkitkeyerror"},m=function(){function e(t,r,n,i){var c=this;(0,a.default)(this,e),(0,o.default)(this,"_logger",(0,l.default)("FairPlayDrmHandler")),(0,o.default)(this,"_retryLicenseRequest",4),(0,o.default)(this,"_defaultConfig",{licenseUrl:"",certificate:"",network:{responseFilter:function(t,r){var n={};try{var a=new DataView(r.data),i=(new TextDecoder).decode(a).trim();n=JSON.parse(i)}catch(e){return void c._onError(s.default.Code.BAD_FAIRPLAY_RESPONSE,{error:e,responseText:r.data})}var o=e._validateResponse(n);o.valid?r.data=e._base64DecodeUint8Array(n.ckc):c._onError(s.default.Code.BAD_FAIRPLAY_RESPONSE,o)}}}),this._config=u.Object.mergeDeep({},this._defaultConfig,r),this._errorCallback=n,this._drmResponseCallback=i,this._videoElement=t,this._onWebkitNeedKeyHandler=function(e){return c._onWebkitNeedKey(e)},this._eventManager=new p.EventManager,this._eventManager.listen(this._videoElement,f.NEED_KEY,this._onWebkitNeedKeyHandler)}return(0,i.default)(e,[{key:"_onWebkitNeedKey",value:function(t){var r=this;this._logger.debug("Webkit need key triggered");var n=t.target,a=t.initData,i=e._extractContentId(a),o=e._base64DecodeUint8Array(this._config.certificate);if(a=e._concatInitDataIdAndCertificate(a,i,o),!n.webkitKeys){var l=this._selectKeySystem();this._logger.debug("Sets media keys"),n.webkitSetMediaKeys(new WebKitMediaKeys(l))}n.webkitKeys||this._onError(s.default.Code.COULD_NOT_CREATE_MEDIA_KEYS),this._logger.debug("Creates session"),this._keySession=n.webkitKeys.createSession("video/mp4",a),this._keySession||this._onError(s.default.Code.COULD_NOT_CREATE_KEY_SESSION),this._keySession.contentId=i,this._eventManager.listen(this._keySession,f.KEY_MESSAGE,(function(e){return r._onWebkitKeyMessage(e)})),this._eventManager.listen(this._keySession,f.KEY_ADDED,(function(){return r._onWebkitKeyAdded()})),this._eventManager.listen(this._keySession,f.KEY_ERROR,(function(e){return r._onWebkitKeyError(e)}))}},{key:"getDrmInfo",value:function(){var e=this._config;return{certificate:e.certificate,licenseUrl:e.licenseUrl,scheme:d.DrmScheme.FAIRPLAY}}},{key:"destroy",value:function(){this._eventManager.destroy(),this._keySession.close(),this._keySession=null}},{key:"_onWebkitKeyMessage",value:function(t){var r=this;this._logger.debug("Webkit key message triggered");var a=t.message,i=new XMLHttpRequest;i.responseType="arraybuffer",this._eventManager.listenOnce(i,"load",(function(e){return r._licenseRequestLoaded(e)}));var o,l={url:this._config.licenseUrl,body:e._base64EncodeUint8Array(a),headers:{}},u=this._config.network.requestFilter;if(u){this._logger.debug("Apply request filter");try{o=u(c.RequestType.LICENSE,l)}catch(e){o=Promise.reject(e)}}(o=o||Promise.resolve(l)).then((function(e){i.open("POST",e.url,!0);var t=!0;e.headers&&Object.entries(e.headers).forEach((function(e){var r=(0,n.default)(e,2),a=r[0],o=r[1];"string"==typeof o&&i.setRequestHeader(a,o),t&&(t="content-type"!==a.toLowerCase())})),"boolean"==typeof e.withCredentials&&(i.withCredentials=e.withCredentials),t&&i.setRequestHeader("Content-type","application/json"),r._logger.debug("Ready for license request"),i.onerror=function(){r._onError(s.default.Code.LICENSE_REQUEST_FAILED,{status:i.status,responseText:i.responseText})},r._licenseRequestTime=Date.now(),i.send(e.body)})).catch((function(e){r._errorCallback(new s.default(s.default.Severity.CRITICAL,s.default.Category.NETWORK,s.default.Code.REQUEST_FILTER_ERROR,e)),r.destroy()}))}},{key:"_onWebkitKeyAdded",value:function(){this._logger.debug("Decryption key was added to session")}},{key:"_onWebkitKeyError",value:function(e){this._logger.error("A decryption key error was encountered",e),this._retryLicenseRequest<=0&&this._onError(s.default.Code.LICENSE_REQUEST_FAILED,e.target.error),this._retryLicenseRequest--}},{key:"_licenseRequestLoaded",value:function(e){var t=this;this._logger.debug("License request loaded");var r=e.target;if(r.status>299)this._onError(s.default.Code.LICENSE_REQUEST_FAILED,{status:r.status,error:r.responseText});else{if(this._drmResponseCallback){var n=Date.now()-this._licenseRequestTime;this._drmResponseCallback({licenseTime:n/1e3,scheme:d.DrmScheme.FAIRPLAY})}var a,i=r.responseURL,o=r.response,l={url:i,originalUrl:this._config.licenseUrl,data:o,headers:u.Http.convertHeadersToDictionary(r.getAllResponseHeaders())};this._logger.debug("Apply response filter");try{a=this._config.network.responseFilter(c.RequestType.LICENSE,l)}catch(e){a=Promise.reject(e)}(a=a||Promise.resolve(l)).then((function(e){t._keySession.update(e.data)})).catch((function(e){t._errorCallback(new s.default(s.default.Severity.CRITICAL,s.default.Category.NETWORK,s.default.Code.RESPONSE_FILTER_ERROR,e)),t.destroy()}))}}},{key:"_onError",value:function(e,t){this._errorCallback(new s.default(s.default.Severity.CRITICAL,s.default.Category.DRM,e,t))}},{key:"_selectKeySystem",value:function(){var e=null;return WebKitMediaKeys.isTypeSupported(h,"video/mp4")?e=h:this._logger.warn("Key System not supported"),e}}],[{key:"_validateResponse",value:function(e){return e.message&&e.message.indexOf("error")>0||null===e.reference||500===e.status_code?{valid:!1,details:"internal server error"}:""===e.ckc?{valid:!1,details:"ckc is missing"}:{valid:!0}}},{key:"_extractContentId",value:function(t){var r=document.createElement("a");return r.href=e._arrayToString(t),r.hostname}},{key:"_arrayToString",value:function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))}},{key:"_base64DecodeUint8Array",value:function(e){for(var t=window.atob(e),r=t.length,n=new Uint8Array(new ArrayBuffer(r)),a=0;a<r;a++)n[a]=t.charCodeAt(a);return n}},{key:"_concatInitDataIdAndCertificate",value:function(t,r,n){"string"==typeof r&&(r=e._stringToArray(r));var a=0,i=new ArrayBuffer(t.byteLength+4+r.byteLength+4+n.byteLength),o=new DataView(i);new Uint8Array(i,a,t.byteLength).set(t),a+=t.byteLength,o.setUint32(a,r.byteLength,!0),a+=4;var s=new Uint8Array(i,a,r.byteLength);return s.set(r),a+=s.byteLength,o.setUint32(a,n.byteLength,!0),a+=4,new Uint8Array(i,a,n.byteLength).set(n),new Uint8Array(i,0,i.byteLength)}},{key:"_stringToArray",value:function(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),n=0,a=e.length;n<a;n++)r[n]=e.charCodeAt(n);return r}},{key:"_base64EncodeUint8Array",value:function(e){for(var t,r,n,a,i,o,s,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;c<e.length;)a=(t=e[c++])>>2,i=(3&t)<<4|(r=c<e.length?e[c++]:Number.NaN)>>4,o=(15&r)<<2|(n=c<e.length?e[c++]:Number.NaN)>>6,s=63&n,isNaN(r)?o=s=64:isNaN(n)&&(s=64),u+=l.charAt(a)+l.charAt(i)+l.charAt(o)+l.charAt(s);return u}}]),e}();(0,o.default)(m,"WebkitEvents",f),m.WebkitEvents=f},"./src/engines/html5/media-source/adapters/native-adapter.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return I}});var n,a=r("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),i=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),o=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),s=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),l=r("./node_modules/@babel/runtime/helpers/esm/get.js"),u=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),c=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),d=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),p=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),h=r("./src/event/event-type.ts"),f=r("./src/track/video-track.ts"),m=r("./src/track/audio-track.ts"),g=r("./src/track/text-track.ts"),y=r("./src/enums/request-type.ts"),v=r("./src/engines/html5/media-source/base-media-source-adapter.ts"),_=r("./src/utils/resolution.ts"),k=r("./src/utils/restrictions.ts"),E=r("./src/utils/util.ts"),b=r("./src/drm/fairplay.ts"),T=r("./src/utils/env.ts"),A=r("./src/error/error.ts"),S=r("./src/engines/html5/media-source/adapters/native-adapter-default-config.json"),C=r("./src/engines/html5/media-source/adapters/fairplay-drm-handler.ts");function P(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,d.default)(e);if(t){var a=(0,d.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,c.default)(this,r)}}var I=function(e){(0,u.default)(r,e);var t=w(r);function r(e,n,a){var o;return(0,i.default)(this,r),o=t.call(this,e,n,a),(0,p.default)((0,s.default)(o),"_lastTimeUpdate",0),(0,p.default)((0,s.default)(o),"_waitingEventTriggered",!1),(0,p.default)((0,s.default)(o),"_segmentDuration",0),(0,p.default)((0,s.default)(o),"_startTimeOfDvrWindow",0),(0,p.default)((0,s.default)(o),"_mediaErrorRecoveryAttempts",0),(0,p.default)((0,s.default)(o),"_lastTimeDetach",NaN),(0,p.default)((0,s.default)(o),"_startTimeAttach",NaN),(0,p.default)((0,s.default)(o),"_nativeTextTracksMap",{}),(0,p.default)((0,s.default)(o),"_captionsHidden",!1),r._logger.debug("Creating adapter"),o._config=E.Object.mergeDeep({},S,o._config),o._progressiveSources=a.progressiveSources,o._liveEdge=0,o._setStarTimeOfDvrWindowInterval(),o}return(0,o.default)(r,[{key:"_dispatchErrorCallback",value:function(e){this._trigger(h.Html5EventType.ERROR,e)}},{key:"_dispatchDRMLicenseLoaded",value:function(e){this._trigger(h.CustomEventType.DRM_LICENSE_LOADED,e)}},{key:"_maybeSetDrmPlayback",value:function(){var e=this;if(r._drmProtocol&&this._sourceObj&&this._sourceObj.drmData){var t={licenseUrl:"",certificate:"",network:this._config.network};r._drmProtocol.setDrmPlayback(t,this._sourceObj.drmData),this._drmHandler=new C.FairPlayDrmHandler(this._videoElement,t,(function(t){return e._dispatchErrorCallback(t)}),(function(t){return e._dispatchDRMLicenseLoaded(t)}))}}},{key:"_setProgressiveSource",value:function(){var e=(0,_.getSuitableSourceForResolution)(this._progressiveSources,this._videoElement.offsetWidth,this._videoElement.offsetHeight);e&&(this._sourceObj=e)}},{key:"_isProgressivePlayback",value:function(){return!!this._sourceObj&&r._progressiveMimeTypes.includes(this._sourceObj.mimetype.toLowerCase())}},{key:"load",value:function(e){var t=this;return this._maybeSetDrmPlayback(),this._loadPromise||(this._loadPromise=new Promise((function(r,n){t._lastTimeUpdate=e||0;var a="number"==typeof e?e:-1,i=t._startTimeAttach||a;t._loadPromiseReject=n,t._eventManager.listenOnce(t._videoElement,h.Html5EventType.LOADED_DATA,(function(){return t._onLoadedData(r,i)})),t._eventManager.listenOnce(t._videoElement,h.Html5EventType.PLAYING,(function(){return t._onPlaying(i)})),t._eventManager.listen(t._videoElement,h.Html5EventType.TIME_UPDATE,(function(){return t._onTimeUpdate()})),t._eventManager.listen(t._videoElement,h.Html5EventType.PLAY,(function(){return t._resetHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,h.Html5EventType.PAUSE,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,h.Html5EventType.ENDED,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,h.Html5EventType.ABORT,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,h.Html5EventType.SEEKED,(function(){return t._syncCurrentTime()})),t._eventManager.listen(t._videoElement,h.Html5EventType.WAITING,(function(){return t._waitingEventTriggered=!0})),t._eventManager.listen(t._videoElement,h.Html5EventType.PLAYING,(function(){return t._waitingEventTriggered=!1})),t._eventManager.listen(window,"focus",(function(){setTimeout((function(){T.default.isIOS&&(t._videoElement.currentTime=t._videoElement.currentTime>.1?t._videoElement.currentTime-.1:0),t._syncCurrentTime()}),1e3)})),t._isProgressivePlayback()&&t._setProgressiveSource(),t._sourceObj&&t._sourceObj.url?t._setSrc().then((function(){t._trigger(h.CustomEventType.ABR_MODE_CHANGED,{mode:t._isProgressivePlayback()?"manual":"auto"}),t._videoElement.load()})):t._videoElement.load()}))),this._loadPromise}},{key:"_handleDecodeError",value:function(e){var t=this;r._logger.debug("handleDecodeError",e);var n=this._videoElement.currentTime,a=this._getActivePKAudioTrack(),i=this._getActivePKTextTrack();this._videoElement.load(),this._eventManager.listenOnce(this._videoElement,h.Html5EventType.PLAYING,(function(){t._mediaErrorRecoveryAttempts=0})),this._eventManager.listenOnce(this._videoElement,h.Html5EventType.CAN_PLAY,(function(){r._logger.debug("CAN_PLAY"),t._videoElement.currentTime=n,t._videoElement.play(),t._videoElement.pause(),a&&t.selectAudioTrack(a),i?t.selectTextTrack(i):t.disableNativeTextTracks()}))}},{key:"handleMediaError",value:function(e){return this._loadPromiseReject?(this._loadPromiseReject(new A.default(A.default.Severity.CRITICAL,A.default.Category.MEDIA,A.default.Code.NATIVE_ADAPTER_LOAD_FAILED,e)),!0):!!(e&&e.code===MediaError.MEDIA_ERR_DECODE&&(this._mediaErrorRecoveryAttempts++,this._mediaErrorRecoveryAttempts<=3))&&(this._handleDecodeError(e),!0)}},{key:"attachMediaSource",value:function(){this._startTimeAttach=this._lastTimeDetach,this._lastTimeDetach=NaN}},{key:"detachMediaSource",value:function(){this._lastTimeDetach=this._videoElement.currentTime,this._videoElement&&this._videoElement.src&&(E.Dom.setAttribute(this._videoElement,"src",""),E.Dom.removeAttribute(this._videoElement,"src")),this._loadPromise=void 0}},{key:"_setSrc",value:function(){var e,t=this,n={url:this._sourceObj?this._sourceObj.url:"",body:null,headers:{}};if("function"==typeof E.Object.getPropertyPath(this._config,"network.requestFilter"))try{r._logger.debug("Apply request filter"),e=this._config.network.requestFilter(y.RequestType.MANIFEST,n)}catch(t){e=Promise.reject(t)}return(e=e||Promise.resolve(n)).then((function(e){if(t._config.useSourceTag){var n,a=document.createElement("source"),i=(null===(n=t._sourceObj)||void 0===n?void 0:n.mimetype.toLowerCase())||"";if(a.setAttribute("src",e.url),a.setAttribute("type",i),t._config.useMediaOptionAttribute){var o={};if(t._config.mediaOptionAttribute&&(o=t._config.mediaOptionAttribute),t._config.abrEwmaDefaultEstimate){var s={start:t._config.abrEwmaDefaultEstimate};E.Object.createPropertyPath(o,"option.adaptiveStreaming.bps",s)}r._logger.debug("Setting mediaOption -",o);var l=encodeURI(JSON.stringify(o));a.setAttribute("type",i+";mediaOption="+l)}t._videoElement.appendChild(a)}else t._videoElement.src=e.url})).catch((function(e){t._trigger(h.Html5EventType.ERROR,new A.default(A.default.Severity.CRITICAL,A.default.Category.NETWORK,A.default.Code.REQUEST_FILTER_ERROR,e))})),e}},{key:"_onPlaying",value:function(e){this.isLive()&&this._setStartTime(e)}},{key:"_onLoadedData",value:function(e,t){var n=this,a=function(){n._playerTracks=n._getParsedTracks(),n._addNativeAudioTrackChangeListener(),n._addNativeTextTrackChangeListener(),n._addNativeTextTrackAddedListener(),r._logger.debug("The source has been loaded successfully"),n._loadPromiseReject=void 0,e({tracks:n._playerTracks}),n.isLive()&&n._handleLiveDurationChange()};void 0!==t&&t>-1&&(this._videoElement.currentTime=t),this._videoElement.textTracks.length>0?a():this._eventManager.listenOnce(this._videoElement,h.Html5EventType.CAN_PLAY,a.bind(this)),this._startTimeAttach=NaN}},{key:"_setStartTime",value:function(e){"number"==typeof e&&e>-1&&(this._videoElement.currentTime=e)}},{key:"_onTimeUpdate",value:function(){this._videoElement.paused||(this._videoElement.currentTime>this._lastTimeUpdate?(this._waitingEventTriggered&&(this._waitingEventTriggered=!1,this._trigger(h.Html5EventType.PLAYING)),this._resetHeartbeatTimeout()):this._videoElement.currentTime<this._lastTimeUpdate?this._syncCurrentTime():(this._waitingEventTriggered=!0,this._trigger(h.Html5EventType.WAITING))),this._handleVideoTracksChange()}},{key:"_syncCurrentTime",value:function(){this._lastTimeUpdate=this._videoElement.currentTime}},{key:"_resetHeartbeatTimeout",value:function(){var e=this;this._lastTimeUpdate=this._videoElement.currentTime,this._clearHeartbeatTimeout(),this._heartbeatTimeoutId=setTimeout((function(){e._clearHeartbeatTimeout(),e._trigger(h.Html5EventType.ERROR,new A.default(A.default.Severity.CRITICAL,A.default.Category.NETWORK,A.default.Code.TIMEOUT,"The player exceeded max buffer time of ".concat(e._config.heartbeatTimeout," ms. No progress has been done during this time.")))}),this._config.heartbeatTimeout)}},{key:"_clearHeartbeatTimeout",value:function(){this._heartbeatTimeoutId&&(clearTimeout(this._heartbeatTimeoutId),this._heartbeatTimeoutId=void 0)}},{key:"_handleVideoTracksChange",value:function(){if(!this._isProgressivePlayback()){var e=this._videoElement,t=e.videoHeight,r=e.videoWidth,n=e.videoTracks;if(!this._videoDimensions||t!==this._videoDimensions.videoHeight||r!==this._videoDimensions.videoWidth){this._videoDimensions={videoHeight:t,videoWidth:r};var a={language:"",height:t,width:r,active:!0,index:Array.from(n).findIndex((function(e){return e.selected}))};this._onTrackChanged(new f.default(a))}}}},{key:"destroy",value:function(){var e=this;return r._logger.debug("destroy"),new Promise((function(t,n){e._maybeRemoveSourceTag(),(0,l.default)((0,d.default)(r.prototype),"destroy",e).call(e).then((function(){e._drmHandler&&e._drmHandler.destroy(),e._waitingEventTriggered=!1,e._progressiveSources=[],e._loadPromise=void 0,e._nativeTextTracksMap={},e._loadPromiseReject=void 0,e._liveEdge=0,e._lastTimeUpdate=0,e._lastTimeDetach=NaN,e._startTimeAttach=NaN,e._videoDimensions=void 0,e._clearHeartbeatTimeout(),clearInterval(e._startTimeOfDvrWindowInterval),e._liveDurationChangeInterval&&(clearInterval(e._liveDurationChangeInterval),e._liveDurationChangeInterval=void 0),t()}),(function(){return n}))}))}},{key:"_maybeRemoveSourceTag",value:function(){if(this._config.useSourceTag&&this._videoElement){var e=this._videoElement.firstChild;e&&(e.setAttribute("src",""),e.removeAttribute("src"),this._videoElement.removeChild(e))}}},{key:"_getParsedTracks",value:function(){var e=this._getParsedVideoTracks(),t=this._getParsedAudioTracks(),r=this._getParsedTextTracks();return[].concat((0,a.default)(e),(0,a.default)(t),(0,a.default)(r))}},{key:"_getParsedVideoTracks",value:function(){return this._isProgressivePlayback()?this._getParsedProgressiveVideoTracks():this._getParsedAdaptiveVideoTracks()}},{key:"_getParsedProgressiveVideoTracks",value:function(){var e=this._progressiveSources,t=[];if(e)for(var r=0;r<e.length;r++){var n={id:e[r].id,bandwidth:e[r].bandwidth,width:e[r].width,height:e[r].height,active:!!this._sourceObj&&e[r].id===this._sourceObj.id,index:r};t.push(new f.default(n))}return t}},{key:"_getParsedAdaptiveVideoTracks",value:function(){var e=this._videoElement.videoTracks,t=[];if(e)for(var r=0;r<e.length;r++){var n={id:e[r].id,active:e[r].selected,label:e[r].label,language:e[r].language,index:r};t.push(new f.default(n))}return t}},{key:"_getParsedAudioTracks",value:function(){var e=this._videoElement.audioTracks,t=[];if(e)for(var r=0;r<e.length;r++){var n={id:e[r].id,active:e[r].enabled,label:e[r].label,language:e[r].language,index:r};t.push(new m.default(n))}return t}},{key:"_getParsedTextTracks",value:function(){var e=[this._config.captionsTextTrack1Label,this._config.captionsTextTrack2Label],t=[this._config.captionsTextTrack1LanguageCode,this._config.captionsTextTrack2LanguageCode],r=this._videoElement.textTracks,n=[];if(r){for(var a=0;a<r.length;a++)if(!g.default.isExternalTrack(r[a])){var i={kind:r[a].kind,active:r[a].mode===g.default.MODE.SHOWING,label:r[a].label,language:r[a].language,available:!0};if(i.kind===g.default.KIND.SUBTITLES){var o=new g.default(i);n.push(o),this._nativeTextTracksMap[o.index]=r[a]}else if(i.kind===g.default.KIND.CAPTIONS&&this._config.enableCEA708Captions){i.label=i.label||e.shift(),i.language=i.language||t.shift(),i.available=this._captionsHidden;var s=new g.default(i);n.push(s),this._nativeTextTracksMap[s.index]=r[a]}}this._captionsHidden||this._maybeShow708Captions()}return n}},{key:"_maybeShow708Captions",value:function(){var e=this,t=Array.from(this._videoElement.textTracks).filter((function(e){return e.kind===g.default.KIND.CAPTIONS})),r=t.find((function(e){return e.mode===g.default.MODE.SHOWING||e.mode===g.default.MODE.HIDDEN}))||t[0];r&&(r.mode=g.default.MODE.HIDDEN,this._captionsHidden=!0,this._eventManager.listenOnce(r,"cuechange",(function(){e._getPKTextTracks().forEach((function(e){return(e.available=!0)&&(e.mode=g.default.MODE.DISABLED)})),e._trigger(h.CustomEventType.TRACKS_CHANGED,{tracks:e._playerTracks})})))}},{key:"selectVideoTrack",value:function(e){this._isProgressivePlayback()?this._selectProgressiveVideoTrack(e):this.selectAdaptiveVideoTrack(e)}},{key:"_selectProgressiveVideoTrack",value:function(e){var t=this,r=this._progressiveSources;if(e instanceof f.default&&r&&r[e.index]){var n=this._videoElement.currentTime,a=this._videoElement.paused;e.active=!0,this._sourceObj=r[e.index],this._eventManager.listenOnce(this._videoElement,h.Html5EventType.LOADED_DATA,(function(){"Android Browser"===T.default.browser.name?(t._eventManager.listenOnce(t._videoElement,h.Html5EventType.DURATION_CHANGE,(function(){t._videoElement.currentTime=n})),t._eventManager.listenOnce(t._videoElement,h.Html5EventType.SEEKED,(function(){t._onTrackChanged(e),a&&t._videoElement.pause()})),t._videoElement.play()):(t._eventManager.listenOnce(t._videoElement,h.Html5EventType.SEEKED,(function(){t._onTrackChanged(e)})),t._videoElement.currentTime=n,a||t._videoElement.play())})),this._setSrc()}}},{key:"selectAdaptiveVideoTrack",value:function(e){var t=this._videoElement.videoTracks;e instanceof f.default&&t&&t[e.index]&&(this._disableVideoTracks(),t[e.index].selected=!0,this._onTrackChanged(e))}},{key:"selectAudioTrack",value:function(e){r._logger.debug("selectAudioTrack");var t=this._videoElement.audioTracks;e instanceof m.default&&t&&t[e.index]&&(this._removeNativeAudioTrackChangeListener(),this._switchAudioTrack(e.index),this._onTrackChanged(e),this._addNativeAudioTrackChangeListener())}},{key:"_removeNativeAudioTrackChangeListener",value:function(){this._videoElement.audioTracks&&this._eventManager.unlisten(this._videoElement.audioTracks,"change")}},{key:"_addNativeAudioTrackChangeListener",value:function(){var e=this;this._videoElement.audioTracks&&this._eventManager.listen(this._videoElement.audioTracks,"change",(function(){return e._onNativeAudioTrackChange()}))}},{key:"_getPKAudioTracks",value:function(){return this._playerTracks.filter((function(e){return e instanceof m.default}))}},{key:"_getActivePKAudioTrack",value:function(){return this._getPKAudioTracks().find((function(e){return!0===e.active}))}},{key:"_onNativeAudioTrackChange",value:function(){var e=this,t=function(){for(var t=0;t<e._videoElement.audioTracks.length;t++)if(e._videoElement.audioTracks[t].enabled)return t;return-1}(),n=this._getActivePKAudioTrack(),a=n?n.index:-1;if(t!==a){var i=this._getPKAudioTracks().find((function(e){return e.index===t}));i&&(r._logger.debug("Native selection of track, update the player audio track ("+a+" -> "+t+")"),this._onTrackChanged(i))}}},{key:"selectTextTrack",value:function(e){if(e instanceof g.default&&g.default.isNativeTextTrack(e)){this._removeNativeTextTrackChangeListener();var t=this._nativeTextTracksMap[e.index];t&&(this.disableNativeTextTracks(),t.mode=this._getDisplayTextTrackModeString(),this._onTrackChanged(e),this._addNativeTextTrackChangeListener())}}},{key:"_removeNativeTextTrackChangeListener",value:function(){this._videoElement.textTracks&&this._eventManager.unlisten(this._videoElement.textTracks,"change")}},{key:"_addNativeTextTrackChangeListener",value:function(){var e=this;this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"change",(function(){return e._onNativeTextTrackChange()}))}},{key:"_getPKTextTracks",value:function(){return this._playerTracks.filter((function(e){return e instanceof g.default}))}},{key:"_getActivePKTextTrack",value:function(){return this._getPKTextTracks().find((function(e){return!0===e.active}))}},{key:"_onNativeTextTrackChange",value:function(){var e=this,t=this._getPKTextTracks(),n=t.find((function(e){return"off"===e.language})),a=function(){for(var t in e._nativeTextTracksMap)if(e._getDisplayTextTrackModeString()===e._nativeTextTracksMap[t].mode)return Number(t);return-1}(),i=this._getActivePKTextTrack(),o=i?i.index:-1;if(a!==o)if(-1===a)n&&(r._logger.debug("Native selection of track, update the player text track ("+o+" -> off)"),this._onTrackChanged(n));else{var s=t.find((function(e){return e.index===a}));s&&(r._logger.debug("Native selection of track, update the player text track ("+o+" -> "+a+")"),this._onTrackChanged(s))}}},{key:"_getDisplayTextTrackModeString",value:function(){return this._config.displayTextTrack?g.default.MODE.SHOWING:g.default.MODE.HIDDEN}},{key:"_addNativeTextTrackAddedListener",value:function(){var e=this;!this._config.displayTextTrack&&this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"addtrack",(function(){return e._onNativeTextTrackAdded()}))}},{key:"_onNativeTextTrackAdded",value:function(){this._playerTracks=this._getParsedTracks(),this._trigger(h.CustomEventType.TRACKS_CHANGED,{tracks:this._playerTracks})}},{key:"hideTextTrack",value:function(){this.disableNativeTextTracks()}},{key:"enableAdaptiveBitrate",value:function(){r._logger.warn("Enabling adaptive bitrate is not supported for native playback")}},{key:"isAdaptiveBitrateEnabled",value:function(){return!this._isProgressivePlayback()}},{key:"applyABRRestriction",value:function(e){E.Object.createPropertyPath(this._config,"abr.restrictions",e),this._maybeApplyAbrRestrictions(e)}},{key:"_maybeApplyAbrRestrictions",value:function(e){if(this._isProgressivePlayback()){var t=this._playerTracks.filter((function(e){return e instanceof f.default})),n=(0,k.filterTracksByRestriction)(t,e);!n.find((function(e){return e.active}))&&n.length?this.selectVideoTrack(n[0]):r._logger.warn("Invalid restrictions, there are not tracks within the restriction range")}}},{key:"_disableVideoTracks",value:function(){var e=this._videoElement.videoTracks;if(e)for(var t=0;t<e.length;t++)e[t].selected=!1}},{key:"_switchAudioTrack",value:function(e){r._logger.debug("_switchAudioTracks");var t=this._videoElement.audioTracks;if(t)for(var n=0;n<t.length;n++)t[n].enabled=n===e}},{key:"_getLiveEdge",value:function(){return this._videoElement.seekable.length?this._videoElement.seekable.end(this._videoElement.seekable.length-1):this._videoElement.buffered.length?this._videoElement.buffered.end(this._videoElement.buffered.length-1):this._videoElement.duration}},{key:"liveDuration",get:function(){return this._getLiveEdge()}},{key:"seekToLiveEdge",value:function(){try{this._videoElement.currentTime=this._getLiveEdge()}catch(e){return}}},{key:"getSegmentDuration",value:function(){return this._segmentDuration}},{key:"isLive",value:function(){return this._videoElement.duration===1/0}},{key:"_handleLiveDurationChange",value:function(){var e=this;this._liveDurationChangeInterval=setInterval((function(){e._calculateSegmentDuration();var t=e._getLiveEdge();e._liveEdge!==t&&(e._liveEdge=t,e._videoElement.dispatchEvent(new Event(h.Html5EventType.DURATION_CHANGE)))}),1e3)}},{key:"_calculateSegmentDuration",value:function(){if(this._videoElement.seekable.length>0&&0===this._videoElement.seekable.start(0)){var e=this._videoElement,t=e.buffered,r=e.seekable;t.length&&r.length&&(this._segmentDuration=(t.end(t.length-1)-r.end(r.length-1))/3)}else{var n=this._getLiveEdge();this._liveEdge&&this._liveEdge!==n&&(this._segmentDuration=n-this._liveEdge)}}},{key:"_getStartTimeOfDvrWindow",value:function(){return this.isLive()&&this._videoElement.seekable.length?this._videoElement.seekable.start(0):0}},{key:"getStartTimeOfDvrWindow",value:function(){return this._startTimeOfDvrWindow}},{key:"_setStarTimeOfDvrWindowInterval",value:function(){var e=this;this._startTimeOfDvrWindowInterval=setInterval((function(){var t=e._segmentDuration;!e._waitingEventTriggered&&e._getStartTimeOfDvrWindow()&&t&&Math.abs(e._getStartTimeOfDvrWindow()-e._startTimeOfDvrWindow)<=2*t?e._startTimeOfDvrWindow+=1:e._startTimeOfDvrWindow=e._getStartTimeOfDvrWindow()}),1e3)}},{key:"getDrmInfo",value:function(){return this._drmHandler?this._drmHandler.getDrmInfo():null}}],[{key:"canPlayType",value:function(e){var t=!1;return"string"==typeof e&&(t=!!r.TEST_VIDEO.canPlayType(e.toLowerCase())),r._logger.debug("canPlayType result for mimeType:"+e+" is "+t.toString()),t}},{key:"canPlayDrm",value:function(e,t){r._drmProtocol=null;var n,a=P(r._drmProtocols);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.isConfigured(e,t)){r._drmProtocol=i;break}}}catch(e){a.e(e)}finally{a.f()}if(!r._drmProtocol){var o,s=P(r._drmProtocols);try{for(s.s();!(o=s.n()).done;){var l=o.value;l.canPlayDrm(e)&&(r._drmProtocol=l)}}catch(e){s.e(e)}finally{s.f()}}return!!r._drmProtocol}},{key:"createAdapter",value:function(e,t,n){r._logger.debug("createAdapter");var a={displayTextTrack:!1,progressiveSources:[]};if(E.Object.hasPropertyPath(n,"text.useNativeTextTrack")&&(a.displayTextTrack=E.Object.getPropertyPath(n,"text.useNativeTextTrack")),E.Object.hasPropertyPath(n,"sources.progressive")&&(a.progressiveSources=E.Object.getPropertyPath(n,"sources.progressive")),E.Object.hasPropertyPath(n,"text")&&(a.enableCEA708Captions=n.text.enableCEA708Captions,a.captionsTextTrack1Label=n.text.captionsTextTrack1Label,a.captionsTextTrack1LanguageCode=n.text.captionsTextTrack1LanguageCode,a.captionsTextTrack2Label=n.text.captionsTextTrack2Label,a.captionsTextTrack2LanguageCode=n.text.captionsTextTrack2LanguageCode),E.Object.hasPropertyPath(n,"playback")&&E.Object.hasPropertyPath(n.playback,"options.html5.native")&&E.Object.mergeDeep(a,n.playback.options.html5.native),E.Object.hasPropertyPath(n,"abr")){var i=n.abr;i.defaultBandwidthEstimate&&(a.abrEwmaDefaultEstimate=i.defaultBandwidthEstimate),i.restrictions&&E.Object.createPropertyPath(a,"abr.restrictions",i.restrictions)}return a.network=n.network,new this(e,t,a)}}]),r}(v.default);n=I,(0,p.default)(I,"id","NativeAdapter"),(0,p.default)(I,"_logger",v.default.getLogger(n.id)),(0,p.default)(I,"TEST_VIDEO",E.Dom.createElement("video")),(0,p.default)(I,"_drmProtocols",[b.default]),(0,p.default)(I,"_drmProtocol",null),(0,p.default)(I,"_progressiveMimeTypes",["video/mp4","audio/mp3"])},"./src/engines/html5/media-source/base-media-source-adapter.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var n,a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),s=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),l=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),u=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),c=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),d=r("./src/event/fake-event.ts"),p=r("./src/event/fake-event-target.ts"),h=r("./src/error/error.ts"),f=r("./src/event/event-type.ts"),m=r("./src/utils/logger.ts"),g=r("./src/track/video-track.ts"),y=r("./src/track/audio-track.ts"),v=r("./src/track/text-track.ts"),_=r("./src/event/event-manager.ts"),k=r("./src/track/image-track.ts");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}var b=function(e){(0,s.default)(r,e);var t=E(r);function r(e,n){var i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,a.default)(this,r),i=t.call(this),(0,c.default)((0,o.default)(i),"_capabilities",{fpsControl:!1}),i._videoElement=e,i._sourceObj=n,i._config=s,i._onDurationChanged=function(){i.isLive()&&i._videoElement.paused&&i._trigger(f.Html5EventType.TIME_UPDATE)},i._eventManager=new _.EventManager,i._handleLiveTimeUpdate(),i}return(0,i.default)(r,[{key:"destroy",value:function(){return this._sourceObj=void 0,this._config={},this.disableNativeTextTracks(),this._videoElement.removeEventListener(f.Html5EventType.DURATION_CHANGE,this._onDurationChanged),this._eventManager.destroy(),Promise.resolve()}},{key:"_onTrackChanged",value:function(e){e instanceof g.default?(r._logger.debug("Video track changed",e),this._trigger(f.CustomEventType.VIDEO_TRACK_CHANGED,{selectedVideoTrack:e})):e instanceof y.default?(r._logger.debug("Audio track changed",e),this._trigger(f.CustomEventType.AUDIO_TRACK_CHANGED,{selectedAudioTrack:e})):e instanceof v.default?(r._logger.debug("Text track changed",e),this._trigger(f.CustomEventType.TEXT_TRACK_CHANGED,{selectedTextTrack:e})):e instanceof k.default&&(r._logger.debug("Image track changed",e),this._trigger(f.CustomEventType.IMAGE_TRACK_CHANGED,{selectedImageTrack:e}))}},{key:"_trigger",value:function(e,t){this.dispatchEvent(new d.FakeEvent(e,t))}},{key:"applyTextTrackStyles",value:function(e,t,n,a){return r._throwNotImplementedError("applyTextTrackStyles")}},{key:"load",value:function(){return r._throwNotImplementedError("load")}},{key:"selectVideoTrack",value:function(e){return r._throwNotImplementedError("selectVideoTrack")}},{key:"selectAudioTrack",value:function(e){r._throwNotImplementedError("selectAudioTrack")}},{key:"selectTextTrack",value:function(e){r._throwNotImplementedError("selectTextTrack")}},{key:"selectImageTrack",value:function(e){}},{key:"hideTextTrack",value:function(){r._throwNotImplementedError("hideTextTrack")}},{key:"enableAdaptiveBitrate",value:function(){r._throwNotImplementedError("enableAdaptiveBitrate")}},{key:"isAdaptiveBitrateEnabled",value:function(){return r._throwNotImplementedError("isAdaptiveBitrateEnabled")}},{key:"applyABRRestriction",value:function(e){return r._throwNotImplementedError("applyABRRestriction")}},{key:"_getLiveEdge",value:function(){return r._throwNotImplementedError("_getLiveEdge")}},{key:"seekToLiveEdge",value:function(){r._throwNotImplementedError("seekToLiveEdge")}},{key:"isLive",value:function(){return r._throwNotImplementedError("isLive")}},{key:"isOnLiveEdge",value:function(){return 0===this.getSegmentDuration()||this.liveDuration-this._videoElement.currentTime<=2*this.getSegmentDuration()}},{key:"setMaxBitrate",value:function(e){}},{key:"attachMediaSource",value:function(){}},{key:"detachMediaSource",value:function(){}},{key:"_handleLiveTimeUpdate",value:function(){this._videoElement.addEventListener(f.Html5EventType.DURATION_CHANGE,this._onDurationChanged)}},{key:"disableNativeTextTracks",value:function(){Array.from(this._videoElement.textTracks).forEach((function(e){v.default.isNativeTextTrack(e)&&!v.default.isExternalTrack(e)&&(e.mode=v.default.MODE.DISABLED)}))}},{key:"handleMediaError",value:function(e){return!1}},{key:"getStartTimeOfDvrWindow",value:function(){return r._throwNotImplementedError("getStartTimeOfDvrWindow")}},{key:"getThumbnail",value:function(e){return null}},{key:"getSegmentDuration",value:function(){return r._throwNotImplementedError("getSegmentDuration")}},{key:"liveDuration",get:function(){return r._throwNotImplementedError("liveDuration")}},{key:"src",get:function(){return this._loadPromise&&this._sourceObj?this._sourceObj.url:""},set:function(e){!this._loadPromise&&this._sourceObj&&(this._sourceObj.url=e)}},{key:"capabilities",get:function(){return this._capabilities}},{key:"targetBuffer",get:function(){return NaN}},{key:"getDrmInfo",value:function(){return null}},{key:"setCachedUrls",value:function(e){}}],[{key:"isSupported",value:function(){return!0}},{key:"isMSESupported",value:function(){var e=window.MediaSource||window.WebKitMediaSource;return!!e&&"function"==typeof e.isTypeSupported}},{key:"canPlayType",value:function(e,t){return r._throwNotImplementedError("static canPlayType")}},{key:"_throwNotImplementedError",value:function(e){throw new h.default(h.default.Severity.CRITICAL,h.default.Category.PLAYER,h.default.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,e)}}]),r}(p.FakeEventTarget);n=b,(0,c.default)(b,"id","BaseAdapter"),(0,c.default)(b,"getLogger",m.default),(0,c.default)(b,"_logger",n.getLogger(n.id))},"./src/engines/html5/media-source/media-source-provider.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l},registerMediaSourceAdapter:function(){return u}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("./src/engines/html5/media-source/adapters/native-adapter.ts"),s=r("./src/utils/logger.ts"),l=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"register",value:function(t){t&&(e._mediaSourceAdapters.includes(t)?e._logger.debug("Adapter <".concat(t.id,"> is already registered, do not register again")):(e._logger.debug("Adapter <".concat(t.id,"> has been registered successfully")),e._mediaSourceAdapters.push(t)))}},{key:"unRegister",value:function(t){var r=e._mediaSourceAdapters.indexOf(t);r>-1&&(e._logger.debug("Unregistered <".concat(t.id,"> adapter")),e._mediaSourceAdapters.splice(r,1))}},{key:"canPlaySource",value:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;e._orderMediaSourceAdapters(r);var a=e._mediaSourceAdapters;if(t&&t.mimetype)for(var i=0;i<a.length;i++)if(a[i].canPlayType(t.mimetype)&&(!t.drmData||a[i].canPlayDrm(t.drmData,n)))return e._selectedAdapter=a[i],e._logger.debug("Selected adapter is <".concat(e._selectedAdapter.id,">")),!0;return!1}},{key:"_orderMediaSourceAdapters",value:function(t){e._mediaSourceAdapters=e._mediaSourceAdapters.filter((function(e){return"NativeAdapter"!==e.id})),t?e._mediaSourceAdapters.unshift(o.default):e._mediaSourceAdapters.push(o.default)}},{key:"getMediaSourceAdapter",value:function(t,r,n){return t&&r&&n?(e._selectedAdapter||e.canPlaySource(r,!0,n.drm),e._selectedAdapter?e._selectedAdapter.createAdapter(t,r,n):null):null}},{key:"destroy",value:function(){e._selectedAdapter=null}}]),e}();(0,i.default)(l,"_logger",(0,s.default)("MediaSourceProvider")),(0,i.default)(l,"_mediaSourceAdapters",[o.default]),(0,i.default)(l,"_selectedAdapter",null);var u=l.register},"./src/engines/stream-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{StreamType:function(){return n}});var n={DASH:"dash",HLS:"hls",PROGRESSIVE:"progressive",IMAGE:"image",DOCUMENT:"document"}},"./src/enums/auto-play-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AutoPlayType:function(){return n}});var n={TRUE:!0,FALSE:!1,IN_VIEW:"inview"}},"./src/enums/media-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{MediaType:function(){return n}});var n={VOD:"Vod",LIVE:"Live",AUDIO:"Audio",IMAGE:"Image",DOCUMENT:"Document",UNKNOWN:"Unknown"}},"./src/enums/mime-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{MimeType:function(){return n}});var n={HLS:["application/x-mpegurl","application/vnd.apple.mpegurl"],DASH:["application/dash+xml"],PROGRESSIVE:["video/mp4"],SMOOTH_STREAMING:["application/vnd.ms-sstr+xml"]}},"./src/enums/request-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{RequestType:function(){return n}});var n={MANIFEST:0,SEGMENT:1,LICENSE:2}},"./src/enums/screen-orientation-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ScreenOrientationType:function(){return n}});var n={NONE:"none",ANY:"any",NATURAL:"natural",LANDSCAPE:"landscape",PORTRAIT:"portrait",PORTRAIT_PRIMARY:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary",LANDSCAPE_PRIMARY:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary"}},"./src/error/category.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Category:function(){return n}});var n={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,ADS:8,STORAGE:9,CAST:10,VR:11,MEDIA_NOT_READY:12,GEO_LOCATION:13,MEDIA_UNAVAILABLE:14}},"./src/error/code.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Code:function(){return a}});var n=r("./src/ads/ad-error-code.ts"),a={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,LIVE_MANIFEST_REFRESH_ERROR:1008,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_CREATE_TEXT_CUE:2009,DASH_ADAPTER_ERROR_PARSE_ISSUE:2010,UNKNOWN_FILE_TYPE:2011,UNKNOWN_LANGUAGE:2012,INVALID_VTT_THUMBNAILS_FILE:2013,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,HLS_FATAL_MEDIA_ERROR:3018,HLS_FRAG_PARSING_ERROR:3019,HLS_BUFFER_APPEND_ISSUE:3020,HLS_BUFFER_APPENDING_ISSUE:3021,NATIVE_ADAPTER_LOAD_FAILED:3022,HLS_BUFFER_STALLED_ERROR:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_LIVE_CONTENT_NOT_SUPPORTED:4029,HLSJS_CANNOT_PARSE:4030,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,BAD_FAIRPLAY_RESPONSE:6015,COULD_NOT_CREATE_MEDIA_KEYS:6016,COULD_NOT_CREATE_KEY_SESSION:6017,LOAD_INTERRUPTED:7e3,BITRATE_SWITCH_ISSUE:7001,LOAD_FAILED:7002,RUNTIME_ERROR_NOT_REGISTERED_PLUGIN:7003,RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED:7004,RUNTIME_ERROR_NOT_VALID_HANDLER:7005,NO_SOURCE_PROVIDED:7006,NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE:7007,ENTER_PICTURE_IN_PICTURE_FAILED:7008,EXIT_PICTURE_IN_PICTURE_FAILED:7009,PLUGIN_LOAD_FAILED:7010,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,CONTENT_UNSUPPORTED_BY_BROWSER:9009,CANNOT_ADD_ITEM:9010,DOWNLOAD_FAILED:9011,COULD_NOT_GET_INFO_FROM_MEDIA_PROVIDER:9012,ENTRY_DOES_NOT_EXIST:9013,PAUSE_FAILED:9014,RESUME_FAILED:9015,RENEW_LICENSE_FAILED:9016,ENTRY_ALREADY_EXISTS:9017,REMOVE_FAILED:9018,CAST_LOAD_MEDIA_FAILED:10001,CAST_CUSTOM_MESSAGE_PARSING_ERROR:10002,CAST_EDIT_TRACKS_INFO_ERROR:10003,VR_NOT_SUPPORTED:11e3};Object.assign(a,n.AdErrorCode)},"./src/error/error.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("./src/utils/logger.ts"),s=r("./src/error/severity.ts"),l=r("./src/error/code.ts"),u=r("./src/error/category.ts"),c="Error",d=(0,n.default)((function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0;(0,a.default)(this,e),this.severity=t,this.category=r,this.code=n,this.data=i,this.errorDetails=s||{},(0,o.getLogLevel)(c)!==o.LogLevel.OFF&&e._logger.error("Category:".concat(r," | Code:").concat(n," |"),i)}));(0,i.default)(d,"Severity",s.Severity),(0,i.default)(d,"Category",u.Category),(0,i.default)(d,"Code",l.Code),(0,i.default)(d,"_logger",(0,o.default)(c))},"./src/error/severity.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Severity:function(){return n}});var n={RECOVERABLE:1,CRITICAL:2}},"./src/event/event-manager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{EventManager:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/utils/index.ts");function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l=function(){function e(){(0,n.default)(this,e),this._bindingMap=new i.MultiMap}return(0,a.default)(e,[{key:"destroy",value:function(){return this.removeAll(),this._bindingMap=null,Promise.resolve()}},{key:"listenOnce",value:function(e,t,r,n){var a=this;this.listen(e,t,(function n(i){a.unlisten(e,t,n),r.call(a,i)}),n)}},{key:"listen",value:function(e,t,r,n){var a=new u(e,t,r,n);this._bindingMap&&this._bindingMap.push(t,a)}},{key:"unlisten",value:function(e,t,r){if(this._bindingMap)for(var n=this._bindingMap.get(t),a=0;a<n.length;++a){var i=n[a];i.target!==e||i.listener!==r&&r||(i.unlisten(),this._bindingMap&&this._bindingMap.remove(t,i))}}},{key:"removeAll",value:function(){if(this._bindingMap){var e,t=o(this._bindingMap.getAll());try{for(t.s();!(e=t.n()).done;)e.value.unlisten()}catch(e){t.e(e)}finally{t.f()}this._bindingMap&&this._bindingMap.clear()}}}]),e}(),u=function(){function e(t,r,a,i){(0,n.default)(this,e),this.target=t,this.type=r,this.listener=a,this.options=i,this.target.addEventListener(r,a,!1)}return(0,a.default)(e,[{key:"unlisten",value:function(){this.target&&(this.target.removeEventListener(this.type,this.listener,this.options),this.target=null,this.listener=null,this.options=null)}}]),e}()},"./src/event/event-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{CustomEventType:function(){return l},EventType:function(){return u},Html5EventType:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=r("./src/ads/ad-event-type.ts");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture",PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},l={MEDIA_LOADED:"medialoaded",PLAYER_RESET:"playerreset",PLAYER_DESTROY:"playerdestroy",ENTER_FULLSCREEN:"enterfullscreen",EXIT_FULLSCREEN:"exitfullscreen",PLAY_FAILED:"playfailed",AUTOPLAY_FAILED:"autoplayfailed",FALLBACK_TO_MUTED_AUTOPLAY:"fallbacktomutedautoplay",CHANGE_SOURCE_STARTED:"changesourcestarted",CHANGE_SOURCE_ENDED:"changesourceended",MUTE_CHANGE:"mutechange",VIDEO_TRACK_CHANGED:"videotrackchanged",AUDIO_TRACK_CHANGED:"audiotrackchanged",TEXT_TRACK_CHANGED:"texttrackchanged",IMAGE_TRACK_CHANGED:"imagetrackchanged",TEXT_TRACK_ADDED:"texttrackadded",TEXT_CUE_CHANGED:"textcuechanged",TRACKS_CHANGED:"trackschanged",ABR_MODE_CHANGED:"abrmodechanged",PLAYER_STATE_CHANGED:"playerstatechanged",PLAYBACK_START:"playbackstart",FIRST_PLAY:"firstplay",FIRST_PLAYING:"firstplaying",PLAYBACK_ENDED:"playbackended",SOURCE_SELECTED:"sourceselected",TEXT_STYLE_CHANGED:"textstylechanged",MEDIA_RECOVERED:"mediarecovered",VR_STEREO_MODE_CHANGED:"vrstereomodechanged",FPS_DROP:"fpsdrop",BOOKMARK_ERROR:"bookmarkerror",CONCURRENCY_LIMIT:"concurrencylimit",RESIZE:"resize",TIMED_METADATA:"timedmetadata",TIMED_METADATA_CHANGE:"timedmetadatachange",TIMED_METADATA_ADDED:"timedmetadataadded",FRAG_LOADED:"fragloaded",MANIFEST_LOADED:"manifestloaded",USER_GESTURE:"usergesture",DRM_LICENSE_LOADED:"drmlicenseloaded",SOURCE_URL_SWITCHED:"sourceurlswitched"},u=o(o(o({},s),l),a.AdEventType)},"./src/event/fake-event-target.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{FakeEventTarget:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/utils/index.ts"),o=r("./src/utils/logger.ts"),s=function(){function e(){(0,n.default)(this,e),this._listeners=new i.MultiMap,this.dispatchTarget=this,this.__logger=(0,o.getLogger)("FakeEventTarget")}return(0,a.default)(e,[{key:"addEventListener",value:function(e,t){this._listeners.push(e,t)}},{key:"removeEventListener",value:function(e,t){this._listeners.remove(e,t)}},{key:"dispatchEvent",value:function(e){for(var t=this._listeners.get(e.type)||[],r=0;r<t.length;++r){e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;var n=t[r];try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(t){this.__logger.error("Error occurred when handling event: ".concat(e.type,"."),t)}if(e.stopped)break}return e.defaultPrevented}}]),e}()},"./src/event/fake-event.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{FakeEvent:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(t,r){(0,n.default)(this,e),this.bubbles=!1,this.cancelable=!1,this.defaultPrevented=!1,this.timeStamp=window.performance?window.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.currentTarget=null,this.target=null,this.stopped=!1,this.payload=r}return(0,a.default)(e,[{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.stopped=!0}},{key:"stopPropagation",value:function(){}}]),e}()},"./src/fullscreen/fullscreen-controller.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{FullscreenController:function(){return p}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("./src/event/event-manager.ts"),s=r("./src/event/fake-event.ts"),l=r("./src/utils/util.ts"),u=r("./src/enums/screen-orientation-type.ts"),c=r("./src/engines/engine-type.ts"),d="playkit-in-browser-fullscreen-mode",p=function(){function e(t){(0,n.default)(this,e),(0,i.default)(this,"_isElementInFullscreen",!1),(0,i.default)(this,"_isScreenLocked",!1),(0,i.default)(this,"_isScreenOrientationSupport",!!screen&&!!screen.orientation&&"function"==typeof screen.orientation.unlock&&"function"==typeof screen.orientation.lock),(0,i.default)(this,"_isFullscreenEventDispatched",!1),this._player=t,this._isInBrowserFullscreen=!1,this._eventManager=new o.EventManager}return(0,a.default)(e,[{key:"_isNativeDocumentFullscreen",value:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}},{key:"_isIOSFullscreen",value:function(){var e="function"==typeof this._player.getVideoElement?this._player.getVideoElement():null;return"iOS"===this._player.env.os.name&&!!e&&("fullscreen"===e.webkitPresentationMode||!e.webkitPresentationMode&&e.webkitDisplayingFullscreen)}},{key:"isFullscreen",value:function(){return this._isNativeDocumentFullscreen()&&this._isElementInFullscreen||this._isIOSFullscreen()||this._isInBrowserFullscreen}},{key:"enterFullscreen",value:function(e){if(!this.isFullscreen()){this.registerFullScreenEvents();var t=e&&l.Dom.getElementById(e),r=this._player.config.playback;if(t||(t=this._player.getView()),"iOS"===this._player.env.os.name)if(r.inBrowserFullscreen&&r.playsinline||this._player.engineType===c.EngineType.YOUTUBE)this._enterInBrowserFullscreen(t);else{var n=this._player.getVideoElement();n&&"function"==typeof n.webkitEnterFullScreen&&(this._player.isInPictureInPicture()?(setTimeout((function(){return n.webkitEnterFullScreen()}),1e3),this._player.exitPictureInPicture()):n.webkitEnterFullScreen())}else this._requestFullscreen(t)}}},{key:"exitFullscreen",value:function(){if(this.isFullscreen())if("iOS"===this._player.env.os.name)if(this._isInBrowserFullscreen||this._player.engineType===c.EngineType.YOUTUBE)this._exitInBrowserFullscreen();else{var e=this._player.getVideoElement();e&&"function"==typeof e.webkitExitFullscreen&&e.webkitExitFullscreen()}else this._requestExitFullscreen()}},{key:"_nativeEnterFullScreen",value:function(e){return"function"==typeof e.requestFullscreen?e.requestFullscreen():"function"==typeof e.mozRequestFullScreen?e.mozRequestFullScreen():"function"==typeof e.webkitRequestFullScreen?e.webkitRequestFullScreen():"function"==typeof e.msRequestFullscreen?e.msRequestFullscreen():void 0}},{key:"_requestFullscreen",value:function(e){var t=this;this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),Promise.resolve(this._nativeEnterFullScreen(e)).then((function(){t._isElementInFullscreen=!0;var e=l.Object.getPropertyPath(t._player,"config.playback.screenLockOrientionMode"),r=e!==u.ScreenOrientationType.NONE&&Object.values(u.ScreenOrientationType).includes(e);t._isScreenOrientationSupport&&r&&screen.orientation.lock(e).then((function(){return t._isScreenLocked=!0})).catch((function(){return t._isScreenLocked=!1}))}),(function(){}))}},{key:"_nativeExitFullScreen",value:function(){return"function"==typeof document.exitFullscreen?document.exitFullscreen():"function"==typeof document.webkitExitFullscreen?document.webkitExitFullscreen():"function"==typeof document.mozCancelFullScreen?document.mozCancelFullScreen():"function"==typeof document.msExitFullscreen?document.msExitFullscreen():void 0}},{key:"_requestExitFullscreen",value:function(){var e=this;Promise.resolve(this._nativeExitFullScreen()).then((function(){e._isElementInFullscreen=!1,e._isScreenOrientationSupport&&e._isScreenLocked&&(screen.orientation.unlock(),e._isScreenLocked=!1)}),(function(){}))}},{key:"_enterInBrowserFullscreen",value:function(e){this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),l.Dom.addClassName(e,d),this._isInBrowserFullscreen=!0,this._fullscreenEnterHandler(),this._player.dispatchEvent(new s.FakeEvent(this._player.Event.RESIZE))}},{key:"_exitInBrowserFullscreen",value:function(){var e=l.Dom.getElementBySelector("."+d);e&&l.Dom.removeClassName(e,d),this._isInBrowserFullscreen=!1,this._fullscreenExitHandler(),this._player.dispatchEvent(new s.FakeEvent(this._player.Event.RESIZE))}},{key:"registerFullScreenEvents",value:function(){var e=this;"iOS"===this._player.env.os.name?this._handleIosFullscreen():(this._eventManager.listen(document,"webkitfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"mozfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"fullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"MSFullscreenChange",(function(){return e._fullscreenChangeHandler()})))}},{key:"_handleIosFullscreen",value:function(){var e=this,t=function(){var t=e._player.getVideoElement();t&&(e._eventManager.listen(t,"webkitbeginfullscreen",(function(){return e._fullscreenEnterHandler()})),e._eventManager.listen(t,"webkitendfullscreen",(function(){return e._fullscreenExitHandler()})))};this._player.getVideoElement()?t():this._eventManager.listenOnce(this._player,this._player.Event.SOURCE_SELECTED,(function(){return t()}))}},{key:"_fullscreenChangeHandler",value:function(){this.isFullscreen()?this._fullscreenEnterHandler():this._fullscreenExitHandler()}},{key:"_fullscreenEnterHandler",value:function(){this.isFullscreen()&&!this._isFullscreenEventDispatched&&(this._isFullscreenEventDispatched=!0,this._player.dispatchEvent(new s.FakeEvent(this._player.Event.ENTER_FULLSCREEN)))}},{key:"_fullscreenExitHandler",value:function(){!this.isFullscreen()&&this._isFullscreenEventDispatched&&(this._isFullscreenEventDispatched=!1,this._eventManager.removeAll(),this._player.dispatchEvent(new s.FakeEvent(this._player.Event.EXIT_FULLSCREEN)))}},{key:"destroy",value:function(){this._eventManager.destroy()}}]),e}()},"./src/middleware/base-middleware.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,[{key:"callNext",value:function(e){e&&e()}}]),e}()},"./src/middleware/middleware.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("./src/utils/multi-map.ts"),s=r("./src/utils/logger.ts"),l=function(){function e(t){(0,a.default)(this,e),this._actions=t,this._middlewares=new o.MultiMap,this._logger=(0,s.default)("Middleware")}return(0,i.default)(e,[{key:"use",value:function(e){for(var t in this._actions){var r=this._actions[t];"function"==typeof e[r]&&(this._logger.debug("Register <".concat(e.id,"> for action ").concat(r)),this._middlewares.push(r,e[r].bind(e)))}}},{key:"run",value:function(e,t){var r=this;this._logger.debug("Start middleware chain for action "+e);for(var n=this._middlewares.get(e),a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];this._executeMiddleware(n,(function(){r._logger.debug("Finish middleware chain for action "+e),t.apply(void 0,arguments)}),i)}},{key:"_executeMiddleware",value:function(e,t,r){var a=r,i=function(e,t,r){var i;null!=t&&t.length&&(a=t),null!==(i=a)&&void 0!==i&&i.length?e.apply(void 0,(0,n.default)(a).concat([r])):e(r)},o=e.reduceRight((function(e,t){return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];i(t,n,e)}}),(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];i(t,r)}));o()}}]),e}()},"./src/middleware/playback-middleware.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("./src/middleware/middleware.ts"),s=function(){function e(){(0,n.default)(this,e),this._middleware=new o.default(e.Actions)}return(0,a.default)(e,[{key:"use",value:function(e){this._middleware.use(e)}},{key:"load",value:function(t){this._middleware.run(e.Actions.LOAD,t)}},{key:"play",value:function(t){this._middleware.run(e.Actions.PLAY,t)}},{key:"pause",value:function(t){this._middleware.run(e.Actions.PAUSE,t)}},{key:"setCurrentTime",value:function(t,r){this._middleware.run(e.Actions.SET_CURRENT_TIME,r,t)}}]),e}();(0,i.default)(s,"Actions",{LOAD:"load",PLAY:"play",PAUSE:"pause",SET_CURRENT_TIME:"setCurrentTime"})},"./src/player-config.js":function(e,t,r){"use strict";r.r(t),r.d(t,{DefaultConfig:function(){return n},DefaultSources:function(){return a}});var n={log:{level:"ERROR"},text:{enableCEA708Captions:!0,useNativeTextTrack:!1,forceCenter:!1,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es"},playback:{audioLanguage:"",textLanguage:"",volume:1,playsinline:!0,preload:"none",autoplay:!1,loop:!1,autopause:!1,allowMutedAutoPlay:!0,muted:!1,pictureInPicture:!0,options:{html5:{hls:{},dash:{},native:{}}},preferNative:{hls:!1,dash:!1},inBrowserFullscreen:!1,screenLockOrientionMode:r("./src/enums/screen-orientation-type.ts").ScreenOrientationType.NONE,playAdsWithMSE:!1,streamPriority:[{engine:"html5",format:"hls"},{engine:"html5",format:"dash"},{engine:"html5",format:"progressive"},{engine:"flash",format:"hls"}]},streaming:{forceBreakStall:!1},abr:{enabled:!0,fpsDroppedFramesInterval:5e3,fpsDroppedMonitoringThreshold:.2,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,restrictions:{minHeight:0,maxHeight:1/0,minWidth:0,maxWidth:1/0,minBitrate:0,maxBitrate:1/0}},drm:{keySystem:""},network:{maxStaleLevelReloads:20}},a={options:{},metadata:{}}},"./src/player.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ae}});var n=r("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),s=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),l=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),u=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),c=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),d=r("./src/utils/env.ts"),p=r("./src/event/event-manager.ts"),h=r("./src/utils/poster-manager.ts"),f=r("./src/event/fake-event.ts"),m=r("./src/event/fake-event-target.ts"),g=r("./src/event/event-type.ts"),y=r("./src/utils/util.ts"),v=r("./src/utils/locale.ts"),_=r("./src/utils/logger.ts"),k=r("./src/state/state-manager.ts"),E=r("./src/track/track.ts"),b=r("./src/track/video-track.ts"),T=r("./src/track/audio-track.ts"),A=r("./src/track/text-track.ts"),S=r("./src/track/text-style.ts"),C=r("./src/track/text-track-display.ts"),P=r("./src/state/state-type.ts"),x=r("./src/track/track-type.ts"),w=r("./src/engines/stream-type.ts"),I=r("./src/engines/engine-type.ts"),M=r("./src/enums/media-type.ts"),R=r("./src/track/abr-mode-type.ts"),D=r("./src/engines/html5/cors-types.ts"),O=r("./src/middleware/playback-middleware.ts"),L=r("./src/player-config.js"),N=(r("./src/assets/style.css"),r("./src/error/error.ts")),U=r("./src/engines/engine-provider.ts"),j=r("./src/track/external-captions-handler.ts"),B=r("./src/ads/ad-break-type.ts"),F=r("./src/ads/ad-tag-type.ts"),V=r("./src/utils/index.ts"),H=r("./src/fullscreen/fullscreen-controller.ts"),G=r("./src/engines/engine-decorator.ts"),$=r("./src/track/label-options.ts"),K=r("./src/enums/auto-play-type.ts"),W=r("./src/track/image-track.ts"),z=r("./src/engines/engine-decorator-manager.ts"),q=r("./src/utils/restrictions.ts"),Y=r("./src/thumbnail/external-thumbnails-handler.ts");function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){(0,c.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Q(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return J(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}var te="playkit-engine",re="auto",ne="off",ae=function(e){(0,s.default)(r,e);var t=ee(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.default)(this,r),e=t.call(this),(0,c.default)((0,o.default)(e),"_sources",{}),(0,c.default)((0,o.default)(e),"_activeTextCues",[]),(0,c.default)((0,o.default)(e),"_textDisplaySettings",{}),(0,c.default)((0,o.default)(e),"_playbackAttributesState",{muted:void 0,volume:void 0,rate:void 0,videoTrack:void 0,audioLanguage:"",textLanguage:"",captionsDisplay:void 0}),(0,c.default)((0,o.default)(e),"_hasUserInteracted",!1),(0,c.default)((0,o.default)(e),"_isOnLiveEdge",!1),(0,c.default)((0,o.default)(e),"_shouldLoadAfterAttach",!1),(0,c.default)((0,o.default)(e),"_cachedUrls",[]),e._setConfigLogLevel(n),e._playerId=y.Generator.uniqueId(5),e._prepareVideoElement(),r.runCapabilities(),e._env=d.default,e._tracks=[],e._firstPlay=!0,e._loadingMedia=!1,e._loading=!1,e._playbackStart=!1,e._firstPlaying=!1,e._reset=!0,e._destroyed=!1,e._fallbackToMutedAutoPlay=!1,e._config=r._defaultConfig,e._sources=y.Object.copyDeep(L.DefaultSources),e._eventManager=new p.EventManager,e._posterManager=new h.default,e._stateManager=new k.default((0,o.default)(e)),e._resizeWatcher=new V.ResizeWatcher,e._playbackMiddleware=new O.default,e._textStyle=new S.default,e._createReadyPromise(),e._createPlayerContainer(),e._appendDomElements(),e._externalCaptionsHandler=new j.ExternalCaptionsHandler((0,o.default)(e)),e._externalThumbnailsHandler=new Y.ExternalThumbnailsHandler,e._fullscreenController=new H.FullscreenController((0,o.default)(e)),e.configure(n),e}return(0,i.default)(r,[{key:"configure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setConfigLogLevel(e),y.Object.mergeDeep(this._config,e),this._applyTextTrackConfig(),this._applyABRRestriction(e)}},{key:"setSourcesMetadata",value:function(e){this._sources&&(this._sources.metadata||(this._sources.metadata={}),y.Object.mergeDeep(this._sources.metadata,e))}},{key:"setSources",value:function(e){this._hasSources(e)?(this.reset(),y.Object.mergeDeep(this._sources,e),this._resizeWatcher.init(y.Dom.getElementById(this._playerId)),r._logger.debug("Change source started"),this.dispatchEvent(new f.FakeEvent(g.CustomEventType.CHANGE_SOURCE_STARTED)),this._reset=!1,this._selectEngineByPriority()?(this.dispatchEvent(new f.FakeEvent(g.CustomEventType.SOURCE_SELECTED,{selectedSource:this._sources[this._streamType]})),this._attachMedia(),this._handlePlaybackOptions(),this._posterManager.setSrc(this._sources.poster),this._handleDimensions(),this._handlePreload(),this._handleAutoPlay(),r._logger.debug("Change source ended"),this.dispatchEvent(new f.FakeEvent(g.CustomEventType.CHANGE_SOURCE_ENDED))):(r._logger.warn("No playable engines was found to play the given sources"),this.dispatchEvent(new f.FakeEvent(g.Html5EventType.ERROR,new N.default(N.default.Severity.CRITICAL,N.default.Category.PLAYER,N.default.Code.NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE,"No Engine Found To Play The Source"))))):y.Object.mergeDeep(this._sources,e)}},{key:"ready",value:function(){return this._readyPromise?this._readyPromise:Promise.resolve()}},{key:"load",value:function(){var e=this;this.src?r._logger.debug("The source has already been loaded. load request ignored"):this._playbackMiddleware.load((function(){e._engine?e._load():e._eventManager.listenOnce(e,g.CustomEventType.SOURCE_SELECTED,(function(){return e._load()}))}))}},{key:"play",value:function(e){var t=this;e&&e.programmatic?this._autoPlay():(this._playbackStart||(this._playbackStart=!0,this.dispatchEvent(new f.FakeEvent(g.CustomEventType.PLAYBACK_START)),this.src||this._prepareVideoElement(),this.load()),this._engine?this._playbackMiddleware.play((function(){return t._play()})):this._loadingMedia?this._playbackMiddleware.play((function(){return t._playAfterAsyncMiddleware()})):this.dispatchEvent(new f.FakeEvent(g.Html5EventType.ERROR,new N.default(N.default.Severity.CRITICAL,N.default.Category.PLAYER,N.default.Code.NO_SOURCE_PROVIDED,"No Source Provided"))))}},{key:"pause",value:function(){this._engine&&this._playbackMiddleware.pause(this._pause.bind(this))}},{key:"getView",value:function(){return this._el}},{key:"getVideoElement",value:function(){if(this._engine)return this._engine.getVideoElement()}},{key:"videoHeight",get:function(){return this._engine?this._engine.videoHeight:null}},{key:"videoWidth",get:function(){return this._engine?this._engine.videoWidth:null}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._reset||(this.pause(),this._externalCaptionsHandler.reset(),this._externalThumbnailsHandler.reset(),this._posterManager.reset(),this._stateManager.reset(),this._sources=y.Object.copyDeep(L.DefaultSources),this._activeTextCues=[],this._updateTextDisplay([]),this._tracks=[],A.PKTextTrack.reset(),this._resetStateFlags(),this._engineType="",this._streamType="",this._pendingSelectedVideoTrack=void 0,this._engine&&this._engine.reset(),this.showBlackCover(),this._reset=!0,this.dispatchEvent(new f.FakeEvent(g.CustomEventType.PLAYER_RESET,{isChangeMedia:e})),this._eventManager.removeAll(),this._resizeWatcher.init(y.Dom.getElementById(this._playerId)),this._createReadyPromise(),this._isOnLiveEdge=!1,this._shouldLoadAfterAttach=!1)}},{key:"destroy",value:function(){this._destroyed||(this._externalCaptionsHandler.destroy(),this._posterManager.destroy(),this._stateManager.destroy(),this._fullscreenController.destroy(),this._activeTextCues=[],this._textDisplaySettings={},this._config={},this._tracks=[],this._engineType="",this._streamType="",this._readyPromise=void 0,this._pendingSelectedVideoTrack=void 0,this._resetStateFlags(),this._playbackAttributesState={},this._engine&&this._engine.destroy(),this._engineDecoratorManager&&this._engineDecoratorManager.destroy(),this._resizeWatcher.destroy(),this._el&&y.Dom.removeChild(this._el.parentNode,this._el),this._destroyed=!0,this.dispatchEvent(new f.FakeEvent(g.CustomEventType.PLAYER_DESTROY)),this._eventManager.destroy())}},{key:"hideBlackCover",value:function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="hidden")}},{key:"showBlackCover",value:function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="visible")}},{key:"attachMediaSource",value:function(){var e=this;this._engine&&(this._shouldLoadAfterAttach=!0,this._engine.attachMediaSource(),this._eventManager.listenOnce(this,g.Html5EventType.CAN_PLAY,(function(){"number"==typeof e._playbackAttributesState.rate&&(e.playbackRate=e._playbackAttributesState.rate)})))}},{key:"detachMediaSource",value:function(){this._engine&&(this.pause(),this.hideTextTrack(),this._shouldLoadAfterAttach=!1,this._createReadyPromise(),this._engine.detachMediaSource())}},{key:"registerEngineDecoratorProvider",value:function(e){this._engineDecoratorManager||(this._engineDecoratorManager=new z.EngineDecoratorManager),e&&this._engineDecoratorManager.register(e)}},{key:"buffered",get:function(){return this._engine?this._engine.buffered:null}},{key:"stats",get:function(){var e={targetBuffer:NaN,availableBuffer:NaN};return this._engine&&(e.targetBuffer=this._engine.targetBuffer,e.availableBuffer=this._engine.availableBuffer),e}},{key:"currentTime",get:function(){return this._engine?this._engine.currentTime:null},set:function(e){this._playbackMiddleware.setCurrentTime(e,this._setCurrentTime.bind(this))}},{key:"duration",get:function(){return this._engine?this._engine.duration:null}},{key:"liveDuration",get:function(){return this._engine?this._engine.liveDuration:null}},{key:"volume",get:function(){return this._engine?this._engine.volume:null},set:function(e){if(this._engine&&(y.Number.isFloat(e)||0===e||1===e)){var t=e;t<0&&(t=0),t>1&&(t=1),this._engine.volume=t}}},{key:"paused",get:function(){return this._engine?this._engine.paused:null}},{key:"seeking",get:function(){return this._engine?this._engine.seeking:null}},{key:"playsinline",get:function(){return this._engine?this._engine.playsinline:null},set:function(e){this._engine&&(this._engine.playsinline=e)}},{key:"muted",get:function(){return this._engine?this._engine.muted:null},set:function(e){this._engine&&(this._engine.muted=e,this.dispatchEvent(new f.FakeEvent(g.CustomEventType.MUTE_CHANGE,{mute:e})),!1===e&&(this._fallbackToMutedAutoPlay=e))}},{key:"src",get:function(){return this._engine?this._engine.src:null}},{key:"dimensions",get:function(){return{width:this._el.clientWidth,height:this._el.clientHeight}},set:function(e){var t=this._getTargetElement();if(!e||y.Object.isEmptyObject(e))this._aspectRatio=null,t.style.width=null,t.style.height=null;else{var r=y.Object.mergeDeep(this.dimensions,e),n=r.height,a=r.width;t.style.width="number"==typeof a?"".concat(a,"px"):a,t.style.height="number"==typeof n?"".concat(n,"px"):n,this._calcRatio(t,e)}}},{key:"_getTargetElement",value:function(){return y.Dom.getElementById(this._config.targetId)}},{key:"poster",get:function(){return this._posterManager.src}},{key:"playbackRate",get:function(){return this._engine?this._engine.playbackRate:null},set:function(e){this._engine&&(this._engine.playbackRate=e)}},{key:"playbackRates",get:function(){return this._playbackRates?this._playbackRates:this._engine?this._engine.playbackRates:[]}},{key:"defaultPlaybackRate",get:function(){return this._engine?this._engine.defaultPlaybackRate:1}},{key:"engineType",get:function(){return this._engineType}},{key:"streamType",get:function(){return this._streamType}},{key:"env",get:function(){return this._env}},{key:"config",get:function(){return y.Object.mergeDeep({},this._config)}},{key:"sources",get:function(){return y.Object.mergeDeep({},this._sources)}},{key:"hasUserInteracted",get:function(){return this._hasUserInteracted}},{key:"loadingMedia",set:function(e){this._loadingMedia=e}},{key:"crossOrigin",get:function(){return this._engine?this._engine.crossOrigin:null},set:function(e){this._engine&&(this._engine.crossOrigin=e)}},{key:"ended",get:function(){return this._engine?this._engine.ended:null}},{key:"playbackMiddleware",get:function(){return this._playbackMiddleware}},{key:"posterManager",get:function(){return this._posterManager}},{key:"isLive",value:function(){return!(this._sources.type===M.MediaType.VOD||!(this._sources.type===M.MediaType.LIVE||this._engine&&this._engine.isLive()))}},{key:"isAudio",value:function(){return this._sources.type===M.MediaType.AUDIO}},{key:"isOnLiveEdge",value:function(){return this._engine&&"function"==typeof this._engine.isOnLiveEdge?this._engine.isOnLiveEdge():this._isOnLiveEdge}},{key:"isDvr",value:function(){return this.isLive()&&this._sources.dvr}},{key:"seekToLiveEdge",value:function(){this._engine&&this.isLive()&&(this._engine.seekToLiveEdge(),this._isOnLiveEdge=!0)}},{key:"getStartTimeOfDvrWindow",value:function(){return this._engine?this._engine.getStartTimeOfDvrWindow():0}},{key:"getTracks",value:function(e){switch(e){case x.TrackType.VIDEO:return y.Object.copyDeep(this._getVideoTracks());case x.TrackType.AUDIO:return y.Object.copyDeep(this._getAudioTracks());case x.TrackType.TEXT:return y.Object.copyDeep(this._getTextTracks());case x.TrackType.IMAGE:return y.Object.copyDeep(this._getImageTracks());default:return y.Object.copyDeep(this._tracks)}}},{key:"getActiveTracks",value:function(){return y.Object.copyDeep({video:this._getVideoTracks().find((function(e){return e.active})),audio:this._getAudioTracks().find((function(e){return e.active})),text:this._getTextTracks().find((function(e){return e.active}))})}},{key:"selectTrack",value:function(e){this._engine&&(e instanceof b.default?(this._playbackAttributesState.videoTrack=e,this._stateManager.currentState.type===P.StateType.IDLE?this._pendingSelectedVideoTrack=e:this._engine.selectVideoTrack(e)):e instanceof T.default?this._engine.selectAudioTrack(e):e instanceof A.PKTextTrack?(this._resetTextDisplay(),e.language===ne?(this.hideTextTrack(),this._externalCaptionsHandler.hideTextTrack(),this._playbackAttributesState.captionsDisplay=!1):e.external?(this._engine.hideTextTrack(),this._externalCaptionsHandler.selectTextTrack(e)):(this._externalCaptionsHandler.hideTextTrack(),this._engine.selectTextTrack(e))):e instanceof W.default&&this._engine.selectImageTrack(e))}},{key:"hideTextTrack",value:function(){if(this._engine){this._engine.hideTextTrack(),this._resetTextDisplay();var e=this._getTextTracks(),t=e.find((function(e){return!0===e.active}));t&&t.external&&this._externalCaptionsHandler.hideTextTrack(),e.map((function(e){return e.active=!1}));var r=e.find((function(e){return e.language===ne}));r&&(r.active=!0,this.dispatchEvent(new f.FakeEvent(g.CustomEventType.TEXT_TRACK_CHANGED,{selectedTextTrack:r}))),this._playbackAttributesState.captionsDisplay=!1}}},{key:"showTextTrack",value:function(){var e=this._getTextTracks(),t=this._playbackAttributesState.textLanguage||this._getLanguage(e,re,e.find((function(e){return e.default})));this._setDefaultTrack(e,t)}},{key:"addTextTrack",value:function(e,t,r){if(this._engine&&"function"==typeof this._engine.addTextTrack)return this._engine.addTextTrack(e,t,r)}},{key:"getNativeTextTracks",value:function(){return this._engine&&"function"==typeof this._engine.getNativeTextTracks?this._engine.getNativeTextTracks():[]}},{key:"enableAdaptiveBitrate",value:function(){this._engine&&this._engine.enableAdaptiveBitrate(),this._playbackAttributesState.videoTrack=void 0}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._engine&&this._engine.isAdaptiveBitrateEnabled()}},{key:"_applyABRRestriction",value:function(e){if(y.Object.hasPropertyPath(e,"abr.restrictions")&&this._engine&&this._tracks.length){var t=this._config.abr.restrictions,n=this._tracks.filter((function(e){return e instanceof b.default})),a=(0,q.filterTracksByRestriction)(n,t);if(a.length){var i=this._tracks.filter((function(e){return e instanceof b.default&&e.available}));(i.length!==a.length||!i.every((function(e,t){return e.bandwidth===a[t].bandwidth})))&&(this._engine.applyABRRestriction(t),this._tracks.forEach((function(e){!a.includes(e)&&e instanceof b.default?(e.available=!1,e.active=!1):e.available=!0})),this.getActiveTracks().video||(a[0].active=!0),this.dispatchEvent(new f.FakeEvent(g.CustomEventType.TRACKS_CHANGED,{tracks:this._tracks.filter((function(e){return e.available}))})))}else r._logger.warn("Invalid restriction, Nothing has changed values do not meet the restriction")}}},{key:"_applyTextTrackConfig",value:function(){var e=y.Object.getPropertyPath(this._config,"text.textTrackDisplaySetting"),t=y.Object.getPropertyPath(this._config,"text.textStyle");if(e){var n=y.Object.mergeDeep({},e,{align:(null==e?void 0:e.align)||(null==t?void 0:t.textAlign)||"center"});y.Object.getPropertyPath(this._config,"text.forceCenter")&&(n.position="auto",n.align="center",n.size="100"),this.setTextDisplaySettings(n)}try{t&&(this.textStyle=S.default.fromJson(t))}catch(e){r._logger.warn(e)}}},{key:"getThumbnail",value:function(e){return this._externalThumbnailsHandler.isUsingVttThumbnails()?this._externalThumbnailsHandler.getThumbnail(e):this._engine?this._engine.getThumbnail(e):null}},{key:"setTextDisplaySettings",value:function(e){this._textDisplaySettings=y.Object.mergeDeep(this._textDisplaySettings,e),this._updateCueDisplaySettings();for(var t=0;t<this._activeTextCues.length;t++)this._activeTextCues[t].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)}},{key:"textDisplaySetting",get:function(){return y.Object.copyDeep(this._textDisplaySettings)}},{key:"textStyle",get:function(){return this._textStyle.clone()},set:function(e){if(!(e instanceof S.default))throw new Error("Style must be instance of TextStyle");(0,V.resetSubtitleStyleSheet)(this._playerId);try{this._textStyle=e,this._config.text.useNativeTextTrack?this._applyCustomSubtitleStyles():this._engine&&(this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay(this._activeTextCues)),this.dispatchEvent(new f.FakeEvent(g.CustomEventType.TEXT_STYLE_CHANGED))}catch(e){r._logger.error(e.message)}}},{key:"isFullscreen",value:function(){return this._fullscreenController.isFullscreen()}},{key:"notifyEnterFullscreen",value:function(){this.isFullscreen()&&this.dispatchEvent(new f.FakeEvent(g.CustomEventType.ENTER_FULLSCREEN))}},{key:"notifyExitFullscreen",value:function(){this.isFullscreen()||this.dispatchEvent(new f.FakeEvent(g.CustomEventType.EXIT_FULLSCREEN))}},{key:"enterFullscreen",value:function(e){this._fullscreenController.enterFullscreen(e)}},{key:"exitFullscreen",value:function(){this._fullscreenController.exitFullscreen()}},{key:"enterPictureInPicture",value:function(){this.isFullscreen()&&this.exitFullscreen(),this._engine&&!this._engine.isInPictureInPicture&&this._engine.enterPictureInPicture()}},{key:"exitPictureInPicture",value:function(){this._engine&&this._engine.isInPictureInPicture&&this._engine.exitPictureInPicture()}},{key:"isInPictureInPicture",value:function(){return!!this._engine&&this._engine.isInPictureInPicture}},{key:"isPictureInPictureSupported",value:function(){return!!this._config.playback.pictureInPicture&&this._engine.isPictureInPictureSupported()}},{key:"isVr",value:function(){return!!this._sources.vr}},{key:"getLogLevel",value:function(e){return(0,_.getLogLevel)(e)}},{key:"setLogLevel",value:function(e,t){(0,_.setLogLevel)(e,t)}},{key:"getDrmInfo",value:function(){return this._engine.getDrmInfo()}},{key:"_applyCustomSubtitleStyles",value:function(){try{var e,t=(null===(e=this._el)||void 0===e||null===(e=e.parentElement)||void 0===e?void 0:e.id)||this._playerId;if(this._config.text.useNativeTextTrack&&!this._config.text.useShakaTextTrackDisplay){var n=(0,V.getSubtitleStyleSheet)(this._playerId);j.ExternalCaptionsHandler.applyNativeTextTrackStyles(n,this._textStyle,t,te)}else if(this._config.text.useShakaTextTrackDisplay){var a,i;(0,V.resetSubtitleStyleSheet)(this._playerId);var o=(0,V.getSubtitleStyleSheet)(this._playerId);null===(a=this._engine.mediaSourceAdapter)||void 0===a||null===(i=a.applyTextTrackStyles)||void 0===i||i.call(a,o,this._textStyle,t)}}catch(e){r._logger.error("Failed to add custom text style: ".concat(e.message))}}},{key:"_resetTextDisplay",value:function(){this._activeTextCues=[],this._updateTextDisplay([])}},{key:"_prepareVideoElement",value:function(){var e=this;U.EngineProvider.getEngines().forEach((function(t){t.prepareVideoElement(e._playerId)}))}},{key:"_setConfigLogLevel",value:function(e){e.log&&e.log.level&&_.LogLevel[e.log.level]&&(0,_.setLogLevel)(_.LogLevel[e.log.level]),e.log&&"function"==typeof e.log.handler&&(0,_.setLogHandler)(e.log.handler)}},{key:"_hasSources",value:function(e){return!!e&&!!Object.values(w.StreamType).find((function(t){return e[t]&&e[t].length>0}))}},{key:"_createPlayerContainer",value:function(){var e=this._el=y.Dom.createElement("div");y.Dom.addClassName(e,"playkit-container"),y.Dom.setAttribute(e,"id",this._playerId),y.Dom.setAttribute(e,"tabindex","-1")}},{key:"_appendEngineEl",value:function(){if(this._el){var e=this._engine.getVideoElement(),t="".concat(te);y.Dom.addClassName(e,t);var r="".concat(te,"-").concat(this._engine.id);y.Dom.addClassName(e,r),y.Dom.prependTo(e,this._el),"youtube"===this._engine.id?this._el.style.zIndex="1":this._el.style.zIndex&&(this._el.style.zIndex="")}}},{key:"_appendDomElements",value:function(){var e=y.Dom.createElement("div");y.Dom.addClassName(e,"playkit-video-filter"),y.Dom.appendChild(this._el,e),this._blackCoverEl=y.Dom.createElement("div"),y.Dom.addClassName(this._blackCoverEl,"playkit-black-cover"),y.Dom.appendChild(this._el,this._blackCoverEl);var t=this._posterManager.getElement();y.Dom.addClassName(t,"playkit-poster"),y.Dom.appendChild(this._el,t),this._textDisplayEl=y.Dom.createElement("div"),y.Dom.addClassName(this._textDisplayEl,"playkit-subtitles"),y.Dom.appendChild(this._el,this._textDisplayEl)}},{key:"_createReadyPromise",value:function(){var e=this;this._readyPromise=new Promise((function(t,r){e._eventManager.listenOnce(e,g.CustomEventType.TRACKS_CHANGED,(function(){e.dispatchEvent(new f.FakeEvent(g.CustomEventType.MEDIA_LOADED)),e._handlePlaybackRate(),t()})),e._eventManager.listen(e,g.Html5EventType.ERROR,(function(e){e.payload.severity===N.default.Severity.CRITICAL&&r()}))})).catch((function(){}))}},{key:"_handlePlaybackRate",value:function(){"number"==typeof this._playbackAttributesState.rate?this.playbackRate=this._playbackAttributesState.rate:"number"==typeof this._config.playback.playbackRate&&(this.playbackRate=this._config.playback.playbackRate)}},{key:"_selectEngineByPriority",value:function(){var e,t=this,n=this._config.playback.streamPriority,a=this._config.playback.preferNative,i=this._sources,o=Q(n);try{var s,l=function(){var n=e.value,o="string"==typeof n.engine?n.engine.toLowerCase():"",s="string"==typeof n.format?n.format.toLowerCase():"",l=U.EngineProvider.getEngines().find((function(e){return e.id===o}));if(l){var u=i[s];if(u&&u.length>0){var c=u[0];if(l.canPlaySource(c,a[s],t._config.drm))return r._logger.debug("Source selected: ",u),t._loadEngine(l,c),t._engineType=o,t._streamType=s,{v:!0}}}};for(o.s();!(e=o.n()).done;)if(s=l())return s.v}catch(e){o.e(e)}finally{o.f()}return!1}},{key:"_loadEngine",value:function(e,t){this._engine?this._engine.id===e.id?this._engine.restore(t,Z(Z({},this._config),{},{sources:this._sources})):(this._engine.destroy(),this._createEngine(e,t),this._appendEngineEl()):(this._createEngine(e,t),this._appendEngineEl())}},{key:"_createEngine",value:function(e,t){var r=e.createEngine(t,Z(Z({},this._config),{},{sources:this._sources}),this._playerId);this._engine=this._engineDecoratorManager?new G.EngineDecorator(r,this._engineDecoratorManager):r,this._cachedUrls.length&&this.setCachedUrls(this._cachedUrls)}},{key:"_attachMedia",value:function(){var e=this;if(this._engine){Object.keys(g.Html5EventType).forEach((function(t){e._eventManager.listen(e._engine,g.Html5EventType[t],(function(t){return e.dispatchEvent(t)}))})),this._eventManager.listen(this._engine,g.Html5EventType.SEEKING,(function(){e.isLive()&&(e._isOnLiveEdge=!(!e.duration||!e.currentTime)&&e.currentTime>=e.duration-1&&!e.paused)})),this._eventManager.listen(this._engine,g.CustomEventType.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.IMAGE_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.TEXT_TRACK_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.VIDEO_TRACK_CHANGED,(function(t){return e._markActiveTrack(t.payload.selectedVideoTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.AUDIO_TRACK_CHANGED,(function(t){e.ready().then((function(){return e._playbackAttributesState.audioLanguage=t.payload.selectedAudioTrack.language})),e._markActiveTrack(t.payload.selectedAudioTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._engine,g.CustomEventType.TRACKS_CHANGED,(function(t){return e._onTracksChanged(t)})),this._eventManager.listen(this._engine,g.CustomEventType.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._engine,g.CustomEventType.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.TIMED_METADATA,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.TIMED_METADATA_CHANGE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.TIMED_METADATA_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.PLAY_FAILED,(function(t){e._onPlayFailed(t),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.FPS_DROP,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,g.CustomEventType.MEDIA_RECOVERED,(function(){return e._handleRecovered()})),this._eventManager.listen(this,g.CustomEventType.CHANGE_SOURCE_ENDED,(function(){return e._addTitleOnIframe()})),this._eventManager.listen(this,g.Html5EventType.PLAY,this._onPlay.bind(this)),this._eventManager.listen(this,g.Html5EventType.PAUSE,this._onPause.bind(this)),this._eventManager.listen(this,g.Html5EventType.PLAYING,this._onPlaying.bind(this)),this._eventManager.listen(this,g.Html5EventType.ENDED,this._onEnded.bind(this)),this._eventManager.listen(this,g.CustomEventType.MUTE_CHANGE,(function(t){var r;e._playbackAttributesState.muted=(null===(r=t.payload)||void 0===r?void 0:r.mute)||e.muted})),this._eventManager.listen(this,g.Html5EventType.VOLUME_CHANGE,(function(){e._playbackAttributesState.volume=e.volume})),this._eventManager.listen(this,g.Html5EventType.RATE_CHANGE,(function(){e._playbackAttributesState.rate=e.playbackRate})),this._eventManager.listen(this,g.CustomEventType.ENTER_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this,g.CustomEventType.EXIT_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this._resizeWatcher,g.CustomEventType.RESIZE,(function(t){e._resetTextCuesAndReposition(),e.dispatchEvent(t)})),this._eventManager.listen(this._externalCaptionsHandler,g.CustomEventType.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._externalCaptionsHandler,g.CustomEventType.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._externalCaptionsHandler,g.Html5EventType.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._externalThumbnailsHandler,g.Html5EventType.ERROR,(function(t){return e.dispatchEvent(t)}));var t=y.Dom.getElementBySelector("#".concat(this.config.targetId));t&&this._eventManager.listen(t,"click",(function(){e._hasUserInteracted=!0,e.dispatchEvent(new f.FakeEvent(g.CustomEventType.USER_GESTURE))}),{capture:!0})}}},{key:"_addTitleOnIframe",value:function(){if(window.self!==window.top){var e=y.Dom.getElementBySelector("head"),t=e.querySelector("title");t||(t=y.Dom.createElement("title"),e.appendChild(t)),t.innerHTML=this._sources.metadata.name?this._sources.metadata.name:""}}},{key:"_handleRecovered",value:function(){this._stateManager.currentState.type===P.StateType.PLAYING&&this.play()}},{key:"_onTextTrackChanged",value:function(e){var t=this;this.ready().then((function(){return t._playbackAttributesState.textLanguage=e.payload.selectedTextTrack.language})),this._markActiveTrack(e.payload.selectedTextTrack),this.dispatchEvent(e)}},{key:"_resetTextCuesAndReposition",value:function(){this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay([]);for(var e=0;e<this._activeTextCues.length;e++)this._activeTextCues[e].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)}},{key:"_handlePlaybackOptions",value:function(){if(this._config.playback=this._config.playback||{},"boolean"==typeof this._playbackAttributesState.muted?this.muted=this._playbackAttributesState.muted:"boolean"==typeof this._config.playback.muted&&(this.muted=this._config.playback.muted),"number"==typeof this._playbackAttributesState.volume?this.volume=this._playbackAttributesState.volume:"number"==typeof this._config.playback.volume&&(this.volume=this._config.playback.volume),"boolean"==typeof this._config.playback.playsinline&&(this.playsinline=this._config.playback.playsinline),"string"==typeof this._config.playback.crossOrigin&&(this.crossOrigin=this._config.playback.crossOrigin),Array.isArray(this._config.playback.playbackRates)){var e=this._config.playback.playbackRates.filter((function(e,t,r){return e>0&&e<=16&&r.indexOf(e)===t})).sort((function(e,t){return e-t}));e&&(this._playbackRates=e)}}},{key:"_handlePreload",value:function(){"auto"!==this._config.playback.preload||this._config.playback.autoplay||this.load()}},{key:"_autoPlay",value:function(){var e=this,t=this._config.playback.allowMutedAutoPlay;r.getCapabilities(this.engineType).then((function(r){r.autoplay?a():r.mutedAutoPlay?n()&&!e._fallbackToMutedAutoPlay?i():t?o():s():s()}));var n=function(){r._logger.debug("Checking muted value");var t="boolean"==typeof e._playbackAttributesState.muted&&e._playbackAttributesState.muted||"boolean"==typeof e._config.playback.muted&&e._config.playback.muted||e.muted;return r._logger.debug("Muted value is:",t),t},a=function(){r._logger.debug("Start autoplay"),e._fallbackToMutedAutoPlay&&(e._fallbackToMutedAutoPlay=!1,e.muted=!1),e.play()},i=function(){r._logger.debug("Start muted autoplay"),e.play()},o=function(){r._logger.debug("Fallback to muted autoplay"),e._fallbackToMutedAutoPlay=!0,e.muted=!0,e.dispatchEvent(new f.FakeEvent(g.CustomEventType.FALLBACK_TO_MUTED_AUTOPLAY)),e.play()},s=function(){r._logger.warn("Autoplay failed, pause player"),e._posterManager.show(),e.load(),e.dispatchEvent(new f.FakeEvent(g.CustomEventType.AUTOPLAY_FAILED))}}},{key:"_handleAutoPlay",value:function(){(this.isAudio()||this._config.playback.autoplay!==K.AutoPlayType.TRUE)&&this._posterManager.show(),this._config.playback.autoplay===K.AutoPlayType.TRUE&&this._autoPlay()}},{key:"_playAfterAsyncMiddleware",value:function(){var e=this;this._engine?this._play():this._eventManager.listenOnce(this,g.CustomEventType.SOURCE_SELECTED,(function(){return e._play()}))}},{key:"_load",value:function(){var e=this;if(this._engine&&!this.src&&!this._loading){this._loading=!0;var t=this._sources.startTime;this._engine.load(t).then((function(r){e.isLive()&&(-1===t||Number(t)>=Number(e.duration))&&(e._isOnLiveEdge=!0),e._updateTracks(r.tracks),e.dispatchEvent(new f.FakeEvent(g.CustomEventType.TRACKS_CHANGED,{tracks:e._tracks})),e.sources.thumbnails&&e._externalThumbnailsHandler.load(e.sources.thumbnails)})).finally((function(){e._loading=!1,e._reset=!1}))}}},{key:"_handleDimensions",value:function(){var e=this.config.dimensions;y.Object.isObject(e)&&!y.Object.isEmptyObject(e)&&(this.dimensions=e)}},{key:"_play",value:function(){var e=this;this._shouldLoadAfterAttach&&(this._load(),this._shouldLoadAfterAttach=!1),this.ready().then((function(){e._shouldPlayerSeekToLiveEdge()&&e.seekToLiveEdge(),e._engine.play()}))}},{key:"_shouldPlayerSeekToLiveEdge",value:function(){if(this.isLive()){var e=!this.isDvr()||"number"==typeof this.currentTime&&this.currentTime<0;return this._firstPlay?!!this.src&&!this.isOnLiveEdge()&&void 0===this._sources.startTime:e}return!1}},{key:"_pause",value:function(){this._engine.pause()}},{key:"_setCurrentTime",value:function(e){if(this._engine&&y.Number.isNumber(e)){var t=e;e<0&&(t=0);var r=this.isLive()?this._engine.duration:this._engine.duration-.1;t>r&&(t=r),this._engine.currentTime=t}}},{key:"_onPause",value:function(){this._isOnLiveEdge=!1}},{key:"_onPlay",value:function(){this._firstPlay&&(this._firstPlay=!1,this.dispatchEvent(new f.FakeEvent(g.CustomEventType.FIRST_PLAY)),this.hideBlackCover(),"number"==typeof this._playbackAttributesState.rate&&(this.playbackRate=this._playbackAttributesState.rate))}},{key:"_onPlaying",value:function(){this._firstPlaying||(this._firstPlaying=!0,this.isAudio()||this._posterManager.hide(),this.dispatchEvent(new f.FakeEvent(g.CustomEventType.FIRST_PLAYING))),this._engine&&this._pendingSelectedVideoTrack&&(this._engine.selectVideoTrack(this._pendingSelectedVideoTrack),this._pendingSelectedVideoTrack=void 0)}},{key:"_onPlayFailed",value:function(e){this._firstPlay&&this._config.playback.autoplay&&(this._posterManager.show(),this.dispatchEvent(new f.FakeEvent(g.CustomEventType.AUTOPLAY_FAILED,e.payload)))}},{key:"_onEnded",value:function(){this.paused||this._pause()}},{key:"_resetStateFlags",value:function(){this._loading=!1,this._firstPlay=!0,this._loadingMedia=!1,this._playbackStart=!1,this._firstPlaying=!1}},{key:"_calcRatio",value:function(e,t){if(void 0!==t.ratio&&(this._aspectRatio=t.ratio),this._aspectRatio){var r=this._aspectRatio.split(":").map((function(e){return Number(e)})),a=(0,n.default)(r,2),i=a[0],o=a[1];if(t.width||!t.width&&!t.height){var s=o/i*e.clientWidth;e.style.height="".concat(s,"px")}else if(t.height&&!t.width){var l=i/o*e.clientHeight;e.style.width="".concat(l,"px")}}}},{key:"_onTracksChanged",value:function(e){this._updateTracks(e.payload.tracks),this.dispatchEvent(e)}},{key:"_updateTracks",value:function(e){r._logger.debug("Tracks changed",e),this._tracks=null==e?void 0:e.concat(this._externalCaptionsHandler.getExternalTracks(e)),this._applyABRRestriction(this._config),this._addTextTrackOffOption(),this._maybeSetTracksLabels(),this._setDefaultTracks()}},{key:"_getTracksByType",value:function(e){return this._tracks.reduce((function(t,r){return r instanceof e&&r.available&&t.push(r),t}),[])}},{key:"_getImageTracks",value:function(){return this._getTracksByType(W.default)}},{key:"_getTextTracks",value:function(){return this._getTracksByType(A.PKTextTrack)}},{key:"_getVideoTracks",value:function(){return this._getTracksByType(b.default)}},{key:"_getAudioTracks",value:function(){return this._getTracksByType(T.default)}},{key:"_markActiveTrack",value:function(e){var t;if(e instanceof b.default?t=this._getVideoTracks():e instanceof T.default?t=this._getAudioTracks():e instanceof A.PKTextTrack&&(t=this._getTextTracks()),t)for(var r=0;r<t.length;r++)t[r].active=e.index===t[r].index}},{key:"_onCueChange",value:function(e){r._logger.debug("Text cue changed",e.payload.cues);try{this._activeTextCues=e.payload.cues.filter((function(e,t,r){var n=r[t-1];return!n||!(e.startTime===n.startTime&&e.endTime===n.endTime&&e.text.trim()===n.text.trim())}))}catch(t){this._activeTextCues=e.payload.cues}this._updateCueDisplaySettings(),this._updateTextDisplay(this._activeTextCues),this.dispatchEvent(e)}},{key:"_updateCueDisplaySettings",value:function(){for(var e=this._activeTextCues,t=this._textDisplaySettings,r=0;r<e.length;r++){var n=e[r];for(var a in t)t[a]&&(n[a]=t[a])}}},{key:"_updateTextDisplay",value:function(e){this._config.text.useShakaTextTrackDisplay&&this._applyCustomSubtitleStyles(),this._config.text.useNativeTextTrack||this._config.text.useShakaTextTrackDisplay||(0,C.processCues)(window,e,this._textDisplayEl,this._textStyle)}},{key:"_addTextTrackOffOption",value:function(){var e=this._getTextTracks();e&&e.length&&this._tracks.push(new A.PKTextTrack({active:!1,kind:A.PKTextTrack.KIND.SUBTITLES,label:"Off",language:ne}))}},{key:"_setDefaultTracks",value:function(){var e=this.getActiveTracks(),t=this._getTextTracks().find((function(e){return e.default})),r=this.config.playback,n=this._getTextTracks().find((function(e){return A.PKTextTrack.langComparer(ne,e.language)})),a=this._getLanguage(this._getTextTracks(),r.textLanguage,t),i=!this._playbackAttributesState.textLanguage||this.config.disableUserCache?a:this._playbackAttributesState.textLanguage,o=this._playbackAttributesState.audioLanguage||this._getLanguage(this._getAudioTracks(),r.audioLanguage,e.audio);r.captionsDisplay?i===r.textLanguage?this._setDefaultTrack(this._getTextTracks(),i,n,r.additionalTextLanguage):this._setDefaultTrack(this._getTextTracks(),i,n):(this._playbackAttributesState.textLanguage=a,this._setDefaultTrack(this._getTextTracks(),ne,n)),o===r.audioLanguage?this._setDefaultTrack(this._getAudioTracks(),o,e.audio,r.additionalAudioLanguage):this._setDefaultTrack(this._getAudioTracks(),o,e.audio),this._setDefaultVideoTrack()}},{key:"_getLanguage",value:function(e,t,r){var n=t;if(n===re){var a=e.find((function(e){return E.default.langComparer(v.default.language,e.language)}));a?n=a.language:r&&r.language!==ne?n=r.language:e&&e.length>0&&(n=e[0].language)}return n}},{key:"_setDefaultTrack",value:function(e,t,r,n){var a=this,i=function(e){a.selectTrack(e),a._markActiveTrack(e)},o=e.find((function(e){return E.default.langComparer(t,e.language,n,!0)}));if(o)i(o);else{var s=e.find((function(e){return E.default.langComparer(t,e.language,n,!1)}));s?i(s):r&&!r.active&&this.selectTrack(r)}}},{key:"_setDefaultVideoTrack",value:function(){var e=this,t=this._getVideoTracks().sort((function(e,t){return t.bandwidth-e.bandwidth})),r=t.find((function(t){var r;return t.label&&t.label===(null===(r=e._playbackAttributesState.videoTrack)||void 0===r?void 0:r.label)}));r||(r=t.find((function(t){var r;return t.height&&t.height===(null===(r=e._playbackAttributesState.videoTrack)||void 0===r?void 0:r.height)}))),r&&this.selectTrack(r)}},{key:"_maybeSetTracksLabels",value:function(){var e=this._config.customLabels;if(e)for(var t in e){if(!Object.prototype.hasOwnProperty.call(e,t))return;switch(t){case $.LabelOptions.QUALITIES:this._setTracksCustomLabels(this._getVideoTracks(),e[t]);break;case $.LabelOptions.AUDIO:this._setTracksCustomLabels(this._getAudioTracks(),e[t]);break;case $.LabelOptions.CAPTIONS:this._setTracksCustomLabels(this._getTextTracks(),e[t])}}}},{key:"_setTracksCustomLabels",value:function(e,t){e.forEach((function(e){var r=t(y.Object.copyDeep(e));r&&(e.label=r)}))}},{key:"Event",get:function(){return g.EventType}},{key:"TextStyle",get:function(){return S.default}},{key:"State",get:function(){return P.StateType}},{key:"Track",get:function(){return x.TrackType}},{key:"LogLevelType",get:function(){return _.LogLevelType}},{key:"LogLevel",get:function(){return _.LogLevel}},{key:"AbrMode",get:function(){return R.AbrMode}},{key:"MediaType",get:function(){return M.MediaType}},{key:"StreamType",get:function(){return w.StreamType}},{key:"EngineType",get:function(){return I.EngineType}},{key:"CorsType",get:function(){return D.CorsType}},{key:"AdBreakType",get:function(){return B.AdBreakType}},{key:"AdTagType",get:function(){return F.AdTagType}},{key:"Error",get:function(){return N.default}},{key:"setCachedUrls",value:function(e){this._cachedUrls=e,this._engine&&this._engine.setCachedUrls&&(this._engine.setCachedUrls(e),this._cachedUrls=[])}}],[{key:"runCapabilities",value:function(){r._logger.debug("Running player capabilities"),U.EngineProvider.getEngines().forEach((function(e){return e.runCapabilities()}))}},{key:"getCapabilities",value:function(e){r._logger.debug("Get player capabilities",e);var t=[];return U.EngineProvider.getEngines().forEach((function(e){return t.push(e.getCapabilities())})),Promise.all(t).then((function(t){var r={};return t.forEach((function(e){return Object.assign(r,e)})),e?r[e]:r}))}},{key:"setCapabilities",value:function(e,t){r._logger.debug("Set player capabilities",e,t);var n=U.EngineProvider.getEngines().find((function(t){return t.id===e}));n&&n.setCapabilities(t)}},{key:"_defaultConfig",get:function(){return y.Object.copyDeep(L.DefaultConfig)}}]),r}(m.FakeEventTarget);(0,c.default)(ae,"_logger",(0,_.default)("Player"))},"./src/state/state-manager.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("./src/event/event-manager.ts"),s=r("./src/state/state.ts"),l=r("./src/state/state-type.ts"),u=r("./src/event/event-type.ts"),c=r("./src/event/fake-event.ts"),d=r("./src/utils/logger.ts"),p=r("./src/utils/env.ts"),h=r("./src/error/error.ts"),f=function(){function e(t){var r,a,c,f,m,g,y=this;(0,n.default)(this,e),(0,i.default)(this,"_transitions",(g={},(0,i.default)(g,l.StateType.IDLE,(r={},(0,i.default)(r,u.Html5EventType.LOAD_START,(function(){return y._updateState(l.StateType.LOADING)})),(0,i.default)(r,u.Html5EventType.PLAY,(function(){return y._updateState(l.StateType.BUFFERING)})),(0,i.default)(r,u.Html5EventType.SEEKED,(function(){return y._updateState(l.StateType.PAUSED)})),r)),(0,i.default)(g,l.StateType.LOADING,(a={},(0,i.default)(a,u.Html5EventType.LOADED_METADATA,(function(){return y._updateState(l.StateType.PAUSED)})),(0,i.default)(a,u.Html5EventType.ERROR,(function(e){return e.payload.severity===h.default.Severity.CRITICAL&&y._updateState(l.StateType.IDLE)})),(0,i.default)(a,u.Html5EventType.SEEKED,(function(){y._prevState&&y._prevState.type===l.StateType.PLAYING&&y._updateState(l.StateType.PLAYING)})),a)),(0,i.default)(g,l.StateType.PAUSED,(c={},(0,i.default)(c,u.Html5EventType.PLAY,(function(){return y._updateState(l.StateType.PLAYING)})),(0,i.default)(c,u.Html5EventType.PLAYING,(function(){return y._updateState(l.StateType.PLAYING)})),(0,i.default)(c,u.Html5EventType.ENDED,(function(){return y._updateState(l.StateType.IDLE)})),c)),(0,i.default)(g,l.StateType.PLAYING,(f={},(0,i.default)(f,u.Html5EventType.PAUSE,(function(){return y._updateState(l.StateType.PAUSED)})),(0,i.default)(f,u.Html5EventType.WAITING,(function(){y._player.seeking?y._updateState(l.StateType.LOADING):(y._updateState(l.StateType.BUFFERING),y._lastWaitingTime=y._player.currentTime)})),(0,i.default)(f,u.Html5EventType.ENDED,(function(){return y._updateState(l.StateType.IDLE)})),(0,i.default)(f,u.Html5EventType.ERROR,(function(e){return e.payload.severity===h.default.Severity.CRITICAL&&y._updateState(l.StateType.IDLE)})),f)),(0,i.default)(g,l.StateType.BUFFERING,(m={},(0,i.default)(m,u.Html5EventType.PLAYING,(function(){return y._updateState(l.StateType.PLAYING)})),(0,i.default)(m,u.Html5EventType.PAUSE,(function(){return y._updateState(l.StateType.PAUSED)})),(0,i.default)(m,u.Html5EventType.TIME_UPDATE,(function(){"IE"===p.default.browser.name&&y._player.currentTime!==y._lastWaitingTime&&y._prevState&&y._prevState.type===l.StateType.PLAYING&&(y._lastWaitingTime=null,y._updateState(l.StateType.PLAYING))})),m)),g)),this._player=t,this._logger=(0,d.default)("StateManager"),this._eventManager=new o.EventManager,this._history=[],this._prevState=null,this._curState=new s.default(l.StateType.IDLE),this._attachListeners()}return(0,a.default)(e,[{key:"_attachListeners",value:function(){this._eventManager.listen(this._player,u.Html5EventType.ERROR,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.ENDED,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.PLAY,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.LOAD_START,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.PLAYING,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.LOADED_METADATA,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.PAUSE,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.WAITING,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.SEEKED,this._doTransition.bind(this)),this._eventManager.listen(this._player,u.Html5EventType.TIME_UPDATE,this._doTransition.bind(this))}},{key:"_doTransition",value:function(e){(e.type!==u.Html5EventType.TIME_UPDATE||this._curState===l.StateType.BUFFERING&&e.type===u.Html5EventType.TIME_UPDATE)&&this._logger.debug("Do transition request",e.type);var t=this._transitions[this._curState.type];"function"==typeof t[e.type]&&t[e.type](e)}},{key:"_updateState",value:function(e){this._curState.type!==e&&(this._curState.duration=Date.now()/1e3,this._history.push(this._curState),this._prevState=this._curState,this._curState=new s.default(e),this._logger.debug("Switch player state: from ".concat(this._prevState.type," to ").concat(this._curState.type)),this._dispatchEvent())}},{key:"_dispatchEvent",value:function(){var e=new c.FakeEvent(u.CustomEventType.PLAYER_STATE_CHANGED,{oldState:this._prevState,newState:this._curState});this._player.dispatchEvent(e)}},{key:"destroy",value:function(){this._history=[],this._eventManager.destroy()}},{key:"reset",value:function(){this._history=[]}},{key:"currentState",get:function(){return this._curState}},{key:"previousState",get:function(){return this._prevState}},{key:"history",get:function(){return this._history}}]),e}()},"./src/state/state-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{StateType:function(){return n}});var n={IDLE:"idle",LOADING:"loading",PLAYING:"playing",PAUSED:"paused",BUFFERING:"buffering"}},"./src/state/state.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(t){(0,n.default)(this,e),this.type=t,this._duration=0,this._timestamp=Date.now()/1e3}return(0,a.default)(e,[{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e-this._timestamp}}]),e}()},"./src/thumbnail/external-thumbnails-handler.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ExternalThumbnailsHandler:function(){return M}});var n=r("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),i=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),o=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),s=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),l=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),u=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),c=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),p=r("./node_modules/@babel/runtime/regenerator/index.js"),h=r.n(p),f=r("./src/event/event-manager.ts"),m=r("./src/event/fake-event-target.ts"),g=r("./src/utils/logger.ts"),y=r("./src/track/text-track-display.ts"),v=r("./src/utils/util.ts"),_=r("./src/thumbnail/thumbnail-info.ts"),k=r("./src/error/error.ts"),E=r("./src/event/fake-event.ts"),b=r("./src/event/event-type.ts");function T(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){(0,d.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,c.default)(e);if(t){var a=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,u.default)(this,r)}}var x=/#wh=/i,w=/#xywh=/i,I=new RegExp("^/[^/].+"),M=function(e){(0,l.default)(g,e);var t,r,u,c,p,m=P(g);function g(){var e;return(0,i.default)(this,g),e=m.call(this),(0,d.default)((0,s.default)(e),"_cues",[]),e._eventManager=new f.EventManager,e}return(0,o.default)(g,[{key:"load",value:(p=(0,a.default)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return g._logger.debug("start loading the vtt thumbnails"),e.next=5,this._downloadAndParseCues(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"getThumbnail",value:function(e){var t=this._findCue(e,this._cues);if(t){var r=t.imgUrl,n=t.size,a=t.coordinates;a=a||{x:0,y:0};var i=C(C({url:r},n=n||this._naturalImgSize),a);return new _.ThumbnailInfo(i)}return null}},{key:"isUsingVttThumbnails",value:function(){var e;return!(null===(e=this._cues)||void 0===e||!e.length)}},{key:"_downloadAndParseCues",value:(c=(0,a.default)(h().mark((function e(t){var r,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._downloadVttFile(t);case 3:return r=e.sent,e.next=6,this._processVtt(r);case 6:return n=e.sent,e.next=9,this._formatIntoThumbnailCues(n,t);case 9:this._cues=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.dispatchEvent(new E.FakeEvent(b.Html5EventType.ERROR,e.t0));case 15:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e){return c.apply(this,arguments)})},{key:"_downloadVttFile",value:(u=(0,a.default)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.Http.execute(t.vttUrl,{},"GET");case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),new k.default(k.default.Severity.RECOVERABLE,k.default.Category.TEXT,k.default.Code.HTTP_ERROR,e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(e){return u.apply(this,arguments)})},{key:"_processVtt",value:(r=(0,a.default)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n=new y.Parser(window,(0,y.StringDecoder)()),a=[];n.oncue=function(e){a.push(e)},n.onflush=function(){g._logger.debug("finished parsing thumbnails cues"),e(a)},n.parse(t),n.flush(),n.onparsingerror((function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"_formatIntoThumbnailCues",value:(t=(0,a.default)(h().mark((function e(t,r){var n,a,i,o,s,l;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validateThumbnailsVTTFormat(t)){e.next=4;break}throw new k.default(k.default.Severity.RECOVERABLE,k.default.Category.TEXT,k.default.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"invalid thumbnail vtt format",vttUrl:r.vttUrl});case 4:return n=this._extractCueMetadata(t[0],r),e.next=7,this.validateImgUrl(n.imgUrl);case 7:if(e.sent){e.next=11;break}throw new k.default(k.default.Severity.RECOVERABLE,k.default.Category.TEXT,k.default.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"failed loading the image - invalid image url",imgUrl:n.imgUrl});case 11:return e.next=13,this.extractImgNaturalDimensions(n.imgUrl);case 13:this._naturalImgSize=e.sent,a=[],i=T(t);try{for(i.s();!(o=i.n()).done;)s=o.value,l=this._extractCueMetadata(s,r),a.push(l)}catch(e){i.e(e)}finally{i.f()}return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"validateThumbnailsVTTFormat",value:function(e){return e.length&&e[0]instanceof VTTCue}},{key:"extractImgNaturalDimensions",value:function(e){var t=this;return new Promise((function(r){var n=new Image;n.src=e,t._eventManager.listenOnce(n,"load",(function(){r({height:n.naturalHeight,width:n.naturalWidth})})),t._eventManager.listenOnce(n,"error",(function(){return r(null)}))}))}},{key:"validateImgUrl",value:function(e){var t=this;return new Promise((function(r){var n=new Image;n.src=e,t._eventManager.listenOnce(n,"load",(function(){r(!0)})),t._eventManager.listenOnce(n,"error",(function(){return r(!1)}))}))}},{key:"_extractCueMetadata",value:function(e,t){var r,a=e.startTime,i=e.endTime,o=e.text,s=t.vttUrl.substring(0,t.vttUrl.lastIndexOf("/")),l=x.test(o),u=w.test(o),c=!1,d=null,p=null;if(l){var h=o.split(x);r=(0,n.default)(h,1)[0],g._logger.warn('vtt thumbnails in "'.concat(x,'" form - is supported but the width and height options are ignored and The images will be displayed in their natural dimensions')),c=void 0!==r}else if(u){var f=o.split(w),m=(0,n.default)(f,2);r=m[0];var y=m[1].split(",").map(Number),v=(0,n.default)(y,4),_=v[0],E=v[1],b=v[2],T=v[3];d={x:_,y:E},p={width:b,height:T},c=[_,E,b,T,r].every((function(e){return void 0!==e}))}else r=o,c=!!o;if(0!==r.indexOf("http://")&&0!==r.indexOf("https://")&&(r=I.test(r)?r.substring(1):r,r="".concat(s,"/").concat(r)),c)return{startTime:a,endTime:i,imgUrl:r,size:p,coordinates:d};throw new k.default(k.default.Severity.RECOVERABLE,k.default.Category.TEXT,k.default.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"error while parsing the vtt cues - invalid cue",parsedCue:{startTime:a,endTime:i,options:o}})}},{key:"_findCue",value:function(e,t){for(var r=0,n=t.length-1;r<=n;){var a=Math.floor((r+n)/2),i=t[a];if(e>=i.startTime&&e<i.endTime)return t[a];e<i.startTime?n=a-1:r=a+1}return null}},{key:"reset",value:function(){this._cues=[],this._eventManager.removeAll(),this._naturalImgSize={}}},{key:"destroy",value:function(){this.reset(),this._eventManager.destroy()}}]),g}(m.FakeEventTarget);(0,d.default)(M,"_logger",(0,g.default)("ExternalThumbnailsHandler"))},"./src/thumbnail/thumbnail-info.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ThumbnailInfo:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(t){(0,n.default)(this,e);var r=t.url,a=t.width,i=t.height,o=t.x,s=t.y;this._url=r,this._width=a,this._height=i,this._x=o,this._y=s}return(0,a.default)(e,[{key:"url",get:function(){return this._url}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}}]),e}()},"./src/track/abr-mode-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{AbrMode:function(){return n}});var n={MANUAL:"manual",AUTO:"auto"}},"./src/track/audio-track.ts":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),o=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),s=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js");function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var a=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var u=function(e){(0,i.default)(r,e);var t=l(r);function r(){return(0,a.default)(this,r),t.apply(this,arguments)}return(0,n.default)(r)}(r("./src/track/track.ts").default);t.default=u},"./src/track/external-captions-handler.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ExternalCaptionsHandler:function(){return C}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),o=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=r("./src/error/error.ts"),d=r("./src/utils/util.ts"),p=r("./src/track/text-track-display.ts"),h=r("./src/track/text-track.ts"),f=r("./src/track/track.ts"),m=r("./src/event/event-type.ts"),g=r("./src/event/fake-event.ts"),y=r("./src/utils/logger.ts"),v=r("./src/event/event-manager.ts"),_=r("./src/event/fake-event-target.ts");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.default)(e);if(t){var a=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var E=1,b=2,T=3,A="srt",S="vtt",C=function(e){(0,o.default)(r,e);var t=k(r);function r(e){var a;return(0,n.default)(this,r),a=t.call(this),(0,u.default)((0,i.default)(a),"_externalCueIndex",0),(0,u.default)((0,i.default)(a),"_textTrackModel",{}),(0,u.default)((0,i.default)(a),"_activeTextCues",[]),(0,u.default)((0,i.default)(a),"_isTextTrackActive",!1),(0,u.default)((0,i.default)(a),"_lastTimeUpdate",0),a._player=e,a._eventManager=new v.EventManager,a}return(0,a.default)(r,[{key:"hideTextTrack",value:function(){this._player.config.text.useNativeTextTrack?(this._removeCueChangeListeners(),this._resetExternalNativeTextTrack()):this._isTextTrackActive&&(this._eventManager.unlisten(this._player,m.Html5EventType.TIME_UPDATE),this.dispatchEvent(new g.FakeEvent(m.CustomEventType.TEXT_CUE_CHANGED,{cues:[]})),this._resetCurrentTrack())}},{key:"getExternalTracks",value:function(e){var t=this,r=this._player.sources.captions;if(!r)return[];this._player.config.text.useNativeTextTrack&&this._addNativeTextTrack();var n=e.filter((function(e){return e instanceof h.default})),a=[];return r.forEach((function(e){if(e.language){var r=t._createTextTrack(e);t._maybeAddTrack(r,e,n,a)}else{var i=new c.default(c.default.Severity.RECOVERABLE,c.default.Category.TEXT,c.default.Code.UNKNOWN_LANGUAGE,{caption:e});t.dispatchEvent(new g.FakeEvent(m.Html5EventType.ERROR,i))}})),a}},{key:"_maybeAddTrack",value:function(e,t,n,a){var i=n.find((function(e){return e.available&&f.default.langComparer(t.language,e.language)}));i?r._logger.warn("duplicated language, taking the inband option. Language: ",i.language):(a.push(e),this._updateTextTracksModel(t))}},{key:"_createTextTrack",value:function(e){return new h.default({active:!!e.default,kind:h.default.KIND.SUBTITLES,label:e.label,language:e.language,external:!0})}},{key:"_updateTextTracksModel",value:function(e){this._textTrackModel[e.language]={cuesStatus:E,cues:[],url:e.url,type:e.type}}},{key:"selectTextTrack",value:function(e){var t=this;this._textTrackModel[e.language]&&(this._textTrackModel[e.language].cuesStatus===T?this._selectTextTrack(e):this._textTrackModel[e.language].cuesStatus===E&&this._downloadAndParseCues(e).then((function(){t._textTrackModel[e.language].cuesStatus=T,t._selectTextTrack(e)})).catch((function(e){return t.dispatchEvent(new g.FakeEvent(m.Html5EventType.ERROR,e))})))}},{key:"_selectTextTrack",value:function(e){this.hideTextTrack(),this._player.config.text.useNativeTextTrack?(this._addCuesToNativeTextTrack(this._textTrackModel[e.language].cues),this._addCueChangeListener()):this._setTextTrack(e),e.active=!0,this.dispatchEvent(new g.FakeEvent(m.CustomEventType.TEXT_TRACK_CHANGED,{selectedTextTrack:e}))}},{key:"resetAllCues",value:function(){for(var e in this._textTrackModel)this._textTrackModel[e].cues.forEach((function(e){e.hasBeenReset=!0}))}},{key:"_addCueChangeListener",value:function(){var e=this,t=this._player.getVideoElement();if(t&&t.textTracks){var r=Array.from(t.textTracks).find((function(e){return h.default.isNativeTextTrack(e)&&e.mode===h.default.MODE.SHOWING}));r&&this._eventManager.listen(r,"cuechange",(function(t){return e._onCueChange(t)}))}}},{key:"_removeCueChangeListeners",value:function(){var e=this._player.getVideoElement();if(e&&e.textTracks)for(var t=0;t<e.textTracks.length;t++)this._eventManager.unlisten(e.textTracks[t],"cuechange")}},{key:"_onCueChange",value:function(e){var t=e.currentTarget.activeCues,r=(0,h.getActiveCues)(t);this.dispatchEvent(new g.FakeEvent(m.CustomEventType.TEXT_CUE_CHANGED,{cues:r}))}},{key:"reset",value:function(){this._resetCurrentTrack(),this._textTrackModel={},this._resetExternalNativeTextTrack(),this._eventManager.removeAll()}},{key:"destroy",value:function(){this._textTrackModel={},this._eventManager.destroy(),this._activeTextCues=[]}},{key:"_resetCurrentTrack",value:function(){this._activeTextCues=[],this._isTextTrackActive=!1,this._maybeSetExternalCueIndex()}},{key:"_getCuesString",value:function(e){var t=this;return new Promise((function(r,n){var a=t._textTrackModel[e.language],i=a.type||t._getFileType(a.url);[A,S].includes(i)||(t._textTrackModel[e.language].cuesStatus=E,n(new c.default(c.default.Severity.RECOVERABLE,c.default.Category.TEXT,c.default.Code.UNKNOWN_FILE_TYPE,{captionType:i}))),d.Http.execute(a.url,{},"GET").then((function(e){r(i===A?t._convertSrtToVtt(e):e)})).catch((function(){t._textTrackModel[e.language].cuesStatus=E,n(new c.default(c.default.Severity.RECOVERABLE,c.default.Category.TEXT,c.default.Code.HTTP_ERROR,{url:a.url}))}))}))}},{key:"_parseCues",value:function(e){return new Promise((function(t,n){var a=new p.Parser(window,(0,p.StringDecoder)()),i=[];a.oncue=function(e){i.push(e)},a.onflush=function(){r._logger.debug("finished parsing external cues"),t(i)},a.parse(e),a.flush(),a.onparsingerror((function(e){return n(e)}))}))}},{key:"_convertSrtToVtt",value:function(e){var t=e.replace(/(\d\d:\d\d:\d\d),(\d\d\d) --> (\d\d:\d\d:\d\d),(\d\d\d)/g,(function(e,t,r,n,a){return"".concat(t,".").concat(r," --\x3e ").concat(n,".").concat(a)}));return"WEBVTT\n\n".concat(t)}},{key:"_downloadAndParseCues",value:function(e){var t=this;return this._textTrackModel[e.language].cuesStatus=b,new Promise((function(r,n){t._getCuesString(e).then((function(e){return t._parseCues(e)})).then((function(n){t._textTrackModel[e.language].cues=n,r()})).catch((function(e){return n(e)}))}))}},{key:"_getFileType",value:function(e){return e.split(/[#?]/)[0].split(".").pop().trim()}},{key:"_handleCaptionOnTimeUpdate",value:function(e){var t=this._player.currentTime;if(t){var r=!1;this._hadSeeked()&&(this._activeTextCues=[],r=this._maybeSetExternalCueIndex());var n=this._maybeRemoveActiveCues(),a=this._maybeAddToActiveCues(e);(r||a||n)&&this.dispatchEvent(new g.FakeEvent(m.CustomEventType.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._lastTimeUpdate=t}}},{key:"_hadSeeked",value:function(){return!!this._player.currentTime&&Math.abs(this._player.currentTime-this._lastTimeUpdate)>1}},{key:"_maybeRemoveActiveCues",value:function(){var e=this._player.currentTime;if(!e)return!1;var t=this._activeTextCues.filter((function(t){return t.startTime<e&&e<t.endTime})),r=this._activeTextCues.length!==t.length;return this._activeTextCues=t,r}},{key:"_maybeAddToActiveCues",value:function(e){var t=this._player.currentTime;if(!t)return!1;for(var r=!1,n=this._textTrackModel[e.language].cues;this._externalCueIndex<n.length&&t>n[this._externalCueIndex].startTime;)t<n[this._externalCueIndex].endTime&&this._activeTextCues.push(n[this._externalCueIndex]),this._externalCueIndex++,r=!0;return r}},{key:"_maybeSetExternalCueIndex",value:function(){var e=this._player._getTextTracks().find((function(e){return e.active&&e.external}));if(e&&e.external){for(var t=this._textTrackModel[e.language]?this._textTrackModel[e.language].cues:[],r=0;r<t.length&&!(t[r].startTime<this._player.currentTime&&this._player.currentTime<t[r].endTime)&&!(t[r].endTime>this._player.currentTime&&t[r].startTime>this._player.currentTime);r++);return this._externalCueIndex=r,!0}return!1}},{key:"_resetExternalNativeTextTrack",value:function(){var e=this._player.getVideoElement();if(e&&e.textTracks){var t=Array.from(e.textTracks).find((function(e){return!!e&&h.default.isExternalTrack(e)}));t&&(t.cues&&Object.values(t.cues).forEach((function(e){return t.removeCue(e)})),t.mode=h.default.MODE.DISABLED)}}},{key:"_addCuesToNativeTextTrack",value:function(e){var t=this._player.getVideoElement();if(t&&t.textTracks){var r=Array.from(t.textTracks).find((function(e){return!!e&&h.default.isExternalTrack(e)}));r&&(r.mode=h.default.MODE.SHOWING,void 0===VTTCue?this._convertCues(e).forEach((function(e){return r.addCue(e)})):e.forEach((function(e){return r.addCue(e)})))}}},{key:"_convertCues",value:function(e){return e.map((function(e){return new TextTrackCue(e.startTime,e.endTime,e.text)}))}},{key:"_addNativeTextTrack",value:function(){var e=this._player.getVideoElement();e&&e.textTracks&&(Array.from(e.textTracks).findIndex((function(e){return!!e&&h.default.isExternalTrack(e)}))>-1?this._resetExternalNativeTextTrack():e.addTextTrack(h.default.KIND.SUBTITLES,h.default.EXTERNAL_TRACK_ID,h.default.EXTERNAL_TRACK_ID))}},{key:"_setTextTrack",value:function(e){var t=this;this._player.config.text.useNativeTextTrack||(this._isTextTrackActive=!0,r._logger.debug("External text track changed",e),this._activeTextCues=[],this._externalCueIndex=0,this.dispatchEvent(new g.FakeEvent(m.CustomEventType.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._eventManager.listen(this._player,m.Html5EventType.TIME_UPDATE,(function(){return t._handleCaptionOnTimeUpdate(e)})))}}],[{key:"applyNativeTextTrackStyles",value:function(e,t,r,n){e.insertRule("#".concat(r," video.").concat(n,"::-webkit-media-text-track-display { text-align: ").concat(t.textAlign,"!important; }"),0),e.insertRule("#".concat(r," video.").concat(n,"::cue { ").concat(t.toCSS()," }"),0)}}]),r}(_.FakeEventTarget);(0,u.default)(C,"_logger",(0,y.default)("ExternalCaptionsHandler"))},"./src/track/image-track.ts":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),o=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),s=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js");function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var a=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var u=function(e){(0,i.default)(r,e);var t=l(r);function r(e){var a;(0,n.default)(this,r),a=t.call(this,e);var i=e.url,o=e.width,s=e.height,l=e.duration,u=e.rows,c=e.cols,d=e.customData;return a._url=i,a._width=o,a._height=s,a._duration=l,a._customData=d,a._rows=u||1,a._cols=c||1,a}return(0,a.default)(r,[{key:"url",get:function(){return this._url}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"duration",get:function(){return this._duration}},{key:"rows",get:function(){return this._rows}},{key:"cols",get:function(){return this._cols}},{key:"customData",get:function(){return this._customData}},{key:"sliceWidth",get:function(){return this._width/this._cols}},{key:"sliceHeight",get:function(){return this._height/this._rows}}]),r}(r("./src/track/track.ts").default);t.default=u},"./src/track/label-options.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{LabelOptions:function(){return n}});var n={AUDIO:"audio",CAPTIONS:"captions",QUALITIES:"qualities"}},"./src/track/text-style.ts":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=function(){function e(){(0,n.default)(this,e),(0,i.default)(this,"_fontSizeIndex",2),(0,i.default)(this,"textAlign",e.FontAlignment[0].value),(0,i.default)(this,"fontFamily",e.FontFamily.SANS_SERIF),(0,i.default)(this,"fontColor",e.StandardColors.WHITE),(0,i.default)(this,"fontOpacity",e.StandardOpacities.OPAQUE),(0,i.default)(this,"backgroundColor",e.StandardColors.BLACK),(0,i.default)(this,"backgroundOpacity",e.StandardOpacities.OPAQUE),(0,i.default)(this,"fontEdge",e.EdgeStyles.NONE)}return(0,a.default)(e,[{key:"fontSize",get:function(){return e.FontSizes[this._fontSizeIndex].label},set:function(t){var r=e.FontSizes.findIndex((function(e){return e.label===t}));-1!==r&&(this._fontSizeIndex=r)}},{key:"fontScale",get:function(){return e.FontSizes[this._fontSizeIndex].value},set:function(t){var r=e.FontSizes.findIndex((function(e){return e.value===t}));-1!==r&&(this._fontSizeIndex=r)}},{key:"getTextShadow",value:function(){for(var t=[],r=0;r<this.fontEdge.length;r++){var n=this.fontEdge[r].slice(0,3),a=this.fontEdge[r].slice(3,6);t.push(e.toRGBA(n,this.fontOpacity)+" "+a.join("px ")+"px")}return t.join(",")}},{key:"toCSS",value:function(){var t=[];return t.push("text-align: "+this.textAlign),t.push("font-family: "+this.fontFamily),t.push("color: "+e.toRGBA(this.fontColor,this.fontOpacity)),t.push("background: linear-gradient(0deg, ".concat(e.toRGBA(this.backgroundColor,this.backgroundOpacity),", ").concat(e.toRGBA(this.backgroundColor,this.backgroundOpacity),")")),t.push("font-size: "+this.fontSize),t.push("text-shadow: "+this.getTextShadow()),t.join("!important; ")}},{key:"clone",value:function(){return e.fromJson(e.toJson(this))}},{key:"isEqual",value:function(t){return JSON.stringify(e.toJson(this))===JSON.stringify(e.toJson(t))}},{key:"implicitFontScale",get:function(){return.25*e.FontSizes[this._fontSizeIndex].value+1}}],[{key:"toRGBA",value:function(e,t){return"rgba("+e.concat(t).join(",")+")"}},{key:"fromJson",value:function(t){var r=function(e,t){return null!=e?e:t},n=new e;return n.fontEdge=r(t.fontEdge,n.fontEdge),n.fontSize=r(t.fontSize,n.fontSize),n.textAlign=r(t.textAlign,n.textAlign),n.fontScale=r(t.fontScale,n.fontScale),n.fontColor=r(t.fontColor,n.fontColor),n.fontOpacity=r(t.fontOpacity,n.fontOpacity),n.backgroundColor=r(t.backgroundColor,n.backgroundColor),n.backgroundOpacity=r(t.backgroundOpacity,n.backgroundOpacity),n.fontFamily=r(t.fontFamily,n.fontFamily),n}},{key:"toJson",value:function(e){return{fontEdge:e.fontEdge,fontSize:e.fontSize,textAlign:e.textAlign,fontScale:e.fontScale,fontColor:e.fontColor,fontOpacity:e.fontOpacity,backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity,fontFamily:e.fontFamily}}}]),e}();(0,i.default)(o,"FontFamily",{ARIAL:"Arial",HELVETICA:"Helvetica",VERDANA:"Verdana",SANS_SERIF:"sans-serif"}),(0,i.default)(o,"StandardColors",{WHITE:[255,255,255],BLACK:[0,0,0],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]}),(0,i.default)(o,"StandardOpacities",{OPAQUE:1,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0}),(0,i.default)(o,"EdgeStyles",{NONE:[],RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]}),(0,i.default)(o,"FontSizes",[{value:-2,label:"50%"},{value:-1,label:"75%"},{value:0,label:"100%"},{value:2,label:"200%"},{value:3,label:"300%"},{value:4,label:"400%"}]),(0,i.default)(o,"FontAlignment",[{label:"Default",value:"default"},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}]),t.default=o},"./src/track/text-track-display.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Parser:function(){return R},StringDecoder:function(){return D},convertCueToDOMTree:function(){return x},processCues:function(){return M}});var n=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),i=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),o=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),s=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),l=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),u=r("./src/track/vtt-region.ts"),c=r("./src/track/text-style.ts"),d=r("./src/track/text-track.ts");function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,i.default)(this,r)}}var h=1;function f(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+(0|n)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}var m={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},g={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},y={v:"title",lang:"lang"},v={rt:"ruby"};function _(){this.values=O(null)}function k(e,t,r,n){var a=n?e.split(n):[e];for(var i in a)if("string"==typeof a[i]){var o=a[i].split(r);2===o.length&&t(o[0],o[1])}}function E(e,t,r){var n=e;function a(){var t=f(e);if(null===t)throw new L(L.Errors.BadTimeStamp,"Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function i(){e=e.replace(/^\s+/,"")}if(i(),t.startTime=a(),i(),"--\x3e"!==e.substr(0,3))throw new L(L.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.substr(3),i(),t.endTime=a(),i(),function(e,t){var n=new _;k(e,(function(e,t){switch(e){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===t){n.set(e,r[a].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),o=i[0];n.integer(e,o),n.percent(e,o)&&n.set("snapToLines",!1),n.alt(e,o,["auto"]),2===i.length&&n.alt("lineAlign",i[1],["start","center","end"]);break;case"position":i=t.split(","),n.percent(e,i[0]),2===i.length&&n.alt("positionAlign",i[1],["start","center","end"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start","center","end","left","right"])}}),/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical",""),t.line=n.get("line",t.line||"auto"),t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100);try{t.align=n.get("align","center")}catch(e){t.align=n.get("align","middle")}t.position=n.get("position",t.position||"auto"),t.positionAlign=n.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}function b(e,t){function r(){if(!t)return null;var e,r=t.match(/^([^<]*)(<[^>]+>?)?/);return e=r[1]?r[1]:r[2],t=t.substr(e.length),e}function n(e){return m[e]}function a(e){for(var t;t=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(t[0],n);return e}function i(e,t){return!v[t.localName]||v[t.localName]===e.localName}function o(t,r){var n=g[t];if(!n)return null;var a=e.document.createElement(n),i=y[t];return i&&r&&(a[i]=r.trim()),a}for(var s,l=e.document.createElement("div"),u=l,c=[];null!==(s=r());)if("<"!==s[0])u.appendChild(e.document.createTextNode(a(s)));else{if("/"===s[1]){c.length&&c[c.length-1]===s.substr(2).replace(">","")&&(c.pop(),u=u.parentNode);continue}var d=f(s.substr(1,s.length-2)),p=void 0;if(d){p=e.document.createProcessingInstruction("timestamp",d),u.appendChild(p);continue}var h=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!h)continue;if(!(p=o(h[1],h[3])))continue;if(!i(u,p))continue;h[2]&&(p.className=h[2].substr(1).replace("."," ")),c.push(h[1]),u.appendChild(p),u=p}return l}_.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var T=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function A(e){for(var t=0;t<T.length;t++){var r=T[t];if(e>=r[0]&&e<=r[1])return!0}return!1}var S=function(e){(0,a.default)(r,e);var t=p(r);function r(e,n,a){var i;(0,s.default)(this,r),i=t.call(this);var o="undefined"!=typeof navigator&&/MSIE\s8\.0/.test(navigator.userAgent);"undefined"!=typeof WebVTTSet&&(WebVTTSet.fontSet,WebVTTSet.backgroundSet,WebVTTSet.edgeSet),i.cue=n,i.cueDiv=b(e,n.text);var l={color:a.color,backgroundColor:a.backgroundColor,textShadow:a.textShadow,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};o||(l.writingMode=""===n.vertical?"horizontal-tb":"lr"===n.vertical?"vertical-lr":"vertical-rl",l.unicodeBidi="plaintext"),i.applyStyles(l,i.cueDiv);var u="default"===a.textAlign;i.div=e.document.createElement("div");var c="middle"===n.align?"center":n.align;u||(c=a.textAlign),l={textAlign:c,font:a.font,whiteSpace:"pre-line",position:"absolute"},o||(l.direction=function(e){var t=[],r="";if(!e||!e.childNodes)return"ltr";function n(e,t){for(var r=t.childNodes.length-1;r>=0;r--)e.push(t.childNodes[r])}function a(e){if(!e||!e.length)return null;var t=e.pop(),r=t.textContent||t.innerText;if(r){var i=r.match(/^.*(\n|\r)/);return i?(e.length=0,i[0]):r}return"ruby"===t.tagName?a(e):t.childNodes?(n(e,t),a(e)):void 0}for(n(t,e);r=a(t);)for(var i=0;i<r.length;i++)if(A(r.charCodeAt(i)))return"rtl";return"ltr"}(i.cueDiv),l.writingMode=""===n.vertical?"horizontal-tb":"lr"===n.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),i.applyStyles(l),i.div.appendChild(i.cueDiv);var d=0;if(u)switch(a.textAlign){case"start":case"left":case"line-left":d=n.position;break;case"center":d=n.position-n.size/2;break;case"end":case"right":case"line-right":d=n.position-n.size}return""===n.vertical?i.applyStyles({left:i.formatStyle(d,"%"),width:i.formatStyle(Math.min(n.size,100-d)||n.size,"%")}):i.applyStyles({top:i.formatStyle(d,"%"),height:i.formatStyle(Math.min(n.size,100-d)||n.size,"%")}),i.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})},i}return(0,l.default)(r)}(function(){function e(){(0,s.default)(this,e)}return(0,l.default)(e,[{key:"applyStyles",value:function(e,t){for(var r in t=t||this.div,e)e.hasOwnProperty(r)&&(t.style[r]=e[r])}},{key:"formatStyle",value:function(e,t){return 0===e?0:e+t}}]),e}()),C=function(){function e(t){var r,a,i,o,l;(0,s.default)(this,e),(0,n.default)(this,"overlaps",(function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top})),t.div&&(a=t.div.offsetHeight,i=t.div.offsetWidth,o=t.div.offsetTop,l=(l=t.div.childNodes)&&(l=l[0])&&l.getClientRects&&l.getClientRects(),t=t.div.getBoundingClientRect(),r=l?Math.max(l[0]&&l[0].height||0,t.height/l.length):0),this.left=t.left,this.right=t.right,this.top=t.top||o,this.height=t.height||a,this.bottom=t.bottom||o+(t.height||a),this.width=t.width||i,this.lineHeight=r||t.lineHeight||13}return(0,l.default)(e,[{key:"move",value:function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}}},{key:"overlapsAny",value:function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1}},{key:"within",value:function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right}},{key:"overlapsOppositeAxis",value:function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}}},{key:"intersectPercentage",value:function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)}},{key:"toCSSCompatValues",value:function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}}}],[{key:"getSimpleBoxPosition",value:function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,r=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,n=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||n,height:e.height||t,bottom:e.bottom||n+(e.height||t),width:e.width||r}}}]),e}();function P(e,t,r,n){var a=new C(t),i=t.cue,o=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,r=t.textTrackList,n=0,a=0;a<r.length&&r[a]!==t;a++)r[a].mode===d.default.MODE.SHOWING&&n++;return-1*++n}(i),s=[];if(i.snapToLines){var l;switch(i.vertical){case"":s=["+y","-y"],l="height";break;case"rl":s=["+x","-x"],l="width";break;case"lr":s=["-x","+x"],l="width"}var u=a.lineHeight,c=u*Math.round(o),p=r[l]+u,h=s[0];Math.abs(c)>p&&(c=c<0?-1:1,c*=Math.ceil(p/u)*u),o<0&&(c+=""===i.vertical?r.height:r.width,s=s.reverse()),a.move(h,c)}else{var f=a.lineHeight/r.height*100;switch(i.lineAlign){case"center":o-=f/2;break;case"end":o-=f}switch(i.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")})}s=["+y","-x","+x","-y"],a=new C(t)}var m=function(e,t){for(var a,i=new C(e),o=1,s=0;s<t.length;s++){for(;e.overlapsOppositeAxis(r,t[s])||e.within(r)&&e.overlapsAny(n);)e.move(t[s]);if(e.within(r))return e;var l=e.intersectPercentage(r);o>l&&(a=new C(e),o=l),e=new C(i)}return a||i}(a,s);t.move(m.toCSSCompatValues(r))}function x(e,t){return e&&t?b(e,t):null}var w=.058,I="1.5%";function M(e,t,r,n){if(!e||!t||!r)return null;for(;r.firstChild;)r.removeChild(r.firstChild);var a=e.document.createElement("div");if(a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.top="0",a.style.bottom="0",a.style.margin=I,r.appendChild(a),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var i=[],o=C.getSimpleBoxPosition(a),s=o.height<o.width?o.height:o.width,l={font:Math.round(s*w*100)/100*h*n.implicitFontScale+"px "+n.fontFamily,textAlign:n.textAlign,color:c.default.toRGBA(n.fontColor,n.fontOpacity),backgroundColor:c.default.toRGBA(n.backgroundColor,n.backgroundOpacity),textShadow:n.getTextShadow()};!function(){for(var r,n,s=0;s<t.length;s++)n=t[s],r=new S(e,n,l),a.appendChild(r.div),P(0,r,o,i),n.displayState=r.div,i.push(C.getSimpleBoxPosition(r))}()}else for(var u=0;u<t.length;u++)a.appendChild(t[u].displayState)}var R=function(e,t){this.window=e,this.state="INITIAL",this.buffer="",this.decoder=t||new TextDecoder("utf8"),this.regionList=[]},D=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},O=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function L(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}L.prototype=O(Error.prototype),L.prototype.constructor=L,L.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},R.prototype={reportOrThrowError:function(e){if(!(e instanceof L))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function r(){for(var e=t.buffer,r=0;r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var n=e.substr(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.substr(r),n}function n(e){k(e,(function(e,r){"Region"===e&&function(e){var r=new _;if(k(e,(function(e,t){switch(e){case"id":r.set(e,t);break;case"width":r.percent(e,t);break;case"lines":r.integer(e,t);break;case"regionanchor":case"viewportanchor":var n=t.split(",");if(2!==n.length)break;var a=new _;if(a.percent("x",n[0]),a.percent("y",n[1]),!a.has("x")||!a.has("y"))break;r.set(e+"X",a.get("x")),r.set(e+"Y",a.get("y"));break;case"scroll":r.alt(e,t,["up"])}}),/=/,/\s/),r.has("id")){var n=new u.Region;n.width=r.get("width",100),n.lines=r.get("lines",3),n.regionAnchorX=r.get("regionanchorX",0),n.regionAnchorY=r.get("regionanchorY",100),n.viewportAnchorX=r.get("viewportanchorX",0),n.viewportAnchorY=r.get("viewportanchorY",100),n.scroll=r.get("scroll",""),t.onregion&&t.onregion(n),t.regionList.push({id:r.get("id"),region:n})}}(r)}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var a;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var i=(a=r()).match(/^WEBVTT([ \t].*)?$/);if(!i||!i[0])throw new L(L.Errors.BadSignature);t.state="HEADER"}for(var o=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:a=r(),t.state){case"HEADER":/:/.test(a)?n(a):a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new VTTCue(0,0,""),t.state="CUE",-1===a.indexOf("--\x3e")){t.cue.id=a;continue}case"CUE":try{E(a,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==a.indexOf("--\x3e");if(!a||s&&(o=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=a;continue;case"BADCUE":a||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new L(L.Errors.BadSignature)}catch(t){e.reportOrThrowError(t)}return e.onflush&&e.onflush(),this}}},"./src/track/text-track.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{PKTextTrack:function(){return f},default:function(){return f},getActiveCues:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),o=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),s=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),u=r("./src/track/track.ts"),c=r("./src/error/error.ts");function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var a=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var f=function(e){(0,i.default)(r,e);var t=h(r);function r(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.default)(this,r),(e=t.call(this,a))._label=e.label||e.language,e._kind=a.kind,e._external=a.external,e._index=r._generateIndex(),e._default=a.default||!1,e}return(0,a.default)(r,[{key:"mode",get:function(){return this._mode},set:function(e){this._mode=e}},{key:"kind",get:function(){return this._kind}},{key:"external",get:function(){return this._external}},{key:"default",get:function(){return this._default}}],[{key:"_generateIndex",value:function(){return r._tracksCount++}},{key:"reset",value:function(){r._tracksCount=0}},{key:"isMetaDataTrack",value:function(e){return e&&e.kind===r.KIND.METADATA}},{key:"isNativeTextTrack",value:function(e){return e&&[r.KIND.SUBTITLES,r.KIND.CAPTIONS].includes(e.kind)}},{key:"isExternalTrack",value:function(e){return e&&[e.language,e.label].includes(r.EXTERNAL_TRACK_ID)}}]),r}(u.default);function m(e){var t,r=[],n=d(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(VTTCue&&a instanceof VTTCue||window.DataCue&&a instanceof window.DataCue)r.push(a);else if(TextTrackCue&&a instanceof TextTrackCue)try{r.push(new VTTCue(a.startTime,a.endTime,a.text))}catch(e){new c.default(c.default.Severity.RECOVERABLE,c.default.Category.TEXT,c.default.Code.UNABLE_TO_CREATE_TEXT_CUE,e)}}}catch(e){n.e(e)}finally{n.f()}return r}(0,l.default)(f,"MODE",{DISABLED:"disabled",SHOWING:"showing",HIDDEN:"hidden"}),(0,l.default)(f,"KIND",{METADATA:"metadata",SUBTITLES:"subtitles",CAPTIONS:"captions"}),(0,l.default)(f,"EXTERNAL_TRACK_ID","playkit-external-track"),(0,l.default)(f,"_tracksCount",0)},"./src/track/timed-metadata.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TimedMetadata:function(){return i},createTextTrackCue:function(){return o},createTimedMetadata:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=(0,n.default)((function e(t,r,n,i,o){(0,a.default)(this,e),this.startTime=t,this.endTime=r,this.id=n,this.type=i,this.metadata=o}));function o(e){try{var t=e.startTime,r=e.endTime,n=e.id,a=e.type,i=e.metadata,o=new VTTCue(t,r,""),s={key:a,data:i};return o.id=n,o.value=s,o}catch(e){return null}}function s(e){if(e){var t=e.startTime,r=e.endTime,n=e.id;if(l(e)){var a=l(e),o=a.type,s=a.metadata;return new i(t,r,n,o,s)}}return null}function l(e){if(e&&"value"in e&&e.value){var t=e.type,r=e.value,n=e.track,a=r.key,o=r.data,s="org.id3"===t||"id3"===(n&&n.label),l=Object.values(i.TYPE).find((function(e){return e===a}));return l||(l=s?i.TYPE.ID3:i.TYPE.CUSTOM),{type:l,metadata:s||!o?r:o}}return null}i.TYPE={ID3:"id3",EMSG:"emsg",CUE_POINT:"cuepoint",CUSTOM:"custom"}},"./src/track/track-type.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TrackType:function(){return n}});var n={VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image"}},"./src/track/track.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js");function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),this._id=t.id,this._active=t.active,this._label=t.label,this._language=t.language,this._index=t.index,this._available="boolean"!=typeof t.available||t.available,this.clone=e.clone.bind(null,this)}return(0,i.default)(e,[{key:"id",get:function(){return this._id}},{key:"active",get:function(){return this._active},set:function(e){this._active=e}},{key:"label",get:function(){return this._label},set:function(e){this._label=e}},{key:"language",get:function(){return this._language}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"available",get:function(){return this._available},set:function(e){this._available=e}}],[{key:"langComparer",value:function(t,r,a,i){try{var o;return o=Array.isArray(a)?[t].concat((0,n.default)(a)):[t,a],e._langComparer(o,r,i)}catch(e){return!1}}},{key:"_langComparer",value:function(e,t,r){var n,a=o(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(""!==(null==i?void 0:i.trim()))if(r){if(this._isLangEqual(i,t))return!0}else if(this._isLangPrefixEqual(i,t))return!0}}catch(e){a.e(e)}finally{a.f()}return!1}},{key:"_isLangEqual",value:function(e,t){return e.toLowerCase()===t.toLowerCase()}},{key:"_isLangPrefixEqual",value:function(e,t){return e.toLowerCase().startsWith(t.toLowerCase())||t.toLowerCase().startsWith(e.toLowerCase())}},{key:"clone",value:function(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)}}]),e}()},"./src/track/video-track.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),o=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),s=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js");function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var a=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,o.default)(this,r)}}var u=function(e){(0,i.default)(r,e);var t=l(r);function r(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.default)(this,r),(e=t.call(this,a))._bandwidth=a.bandwidth,e._width=a.width,e._height=a.height,e._label=a.label?a.label:e._height?e._height+"p":void 0,e}return(0,a.default)(r,[{key:"bandwidth",get:function(){return this._bandwidth}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]),r}(r("./src/track/track.ts").default)},"./src/track/vtt-region.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Region:function(){return l}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o={"":!0,up:!0};function s(e){return"number"==typeof e&&e>=0&&e<=100}var l,u=function(){function e(){(0,n.default)(this,e),(0,i.default)(this,"_width",100),(0,i.default)(this,"_lines",3),(0,i.default)(this,"_regionAnchorX",0),(0,i.default)(this,"_regionAnchorY",100),(0,i.default)(this,"_viewportAnchorX",0),(0,i.default)(this,"_viewportAnchorY",100),(0,i.default)(this,"_scroll","")}return(0,a.default)(e,[{key:"width",get:function(){return this._width},set:function(e){if(!s(e))throw new Error("Width must be between 0 and 100.");this._width=e}},{key:"scroll",get:function(){return this._scroll},set:function(e){var t=function(e){return"string"==typeof e&&!!o[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");this._scroll=t}},{key:"viewportAnchorY",get:function(){return this._viewportAnchorY},set:function(e){if(!s(e))throw new Error("ViewportAnchorY must be between 0 and 100.");this._viewportAnchorY=e}},{key:"viewportAnchorX",get:function(){return this._viewportAnchorX},set:function(e){if(!s(e))throw new Error("ViewportAnchorX must be between 0 and 100.");this._viewportAnchorX=e}},{key:"regionAnchorX",get:function(){return this._regionAnchorX},set:function(e){if(!s(e))throw new Error("RegionAnchorY must be between 0 and 100.");this._regionAnchorX=e}},{key:"lines",get:function(){return this._lines},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");this._lines=e}},{key:"regionAnchorY",get:function(){return this._regionAnchorY},set:function(e){if(!s(e))throw new Error("RegionAnchorX must be between 0 and 100.");this._regionAnchorY=e}}]),e}();l="undefined"!=typeof window&&window.VTTRegion?window.VTTRegion:u},"./src/types/abr-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/ad-break-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/ad-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/custom-labels-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/deferred-promise.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/dimensions.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/drm-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/drm-data.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/engine-decorator-provider.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/event-types.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/exteranl-thumbnails-object.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/image-player-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{TrackType:function(){return n.TrackType}}),r("./src/types/abr-config.ts"),r("./src/types/ad-break-options.ts"),r("./src/types/ad-options.ts"),r("./src/types/custom-labels-config.ts"),r("./src/types/deferred-promise.ts"),r("./src/types/dimensions.ts"),r("./src/types/drm-config.ts"),r("./src/types/drm-data.ts"),r("./src/types/engine-decorator-provider.ts"),r("./src/types/event-types.ts"),r("./src/types/exteranl-thumbnails-object.ts"),r("./src/types/image-player-options.ts"),r("./src/types/log-level.ts"),r("./src/types/media-source.ts"),r("./src/types/media-source-capabilities.ts"),r("./src/types/media-source-options.ts"),r("./src/types/metadata-config.ts"),r("./src/types/mime-types.ts"),r("./src/types/network-config.ts"),r("./src/types/play-options.ts"),r("./src/types/playback-config.ts"),r("./src/types/playback-options.ts"),r("./src/types/player-state.ts"),r("./src/types/prefer-native-config.ts"),r("./src/types/request.ts"),r("./src/types/request-types.ts"),r("./src/types/response.ts"),r("./src/types/restrictions-types.ts"),r("./src/types/screen-orientation-type.ts"),r("./src/types/session-config.ts"),r("./src/types/sources-config.ts"),r("./src/types/stream-types.ts"),r("./src/types/stats.ts"),r("./src/types/stream-priority.ts"),r("./src/types/streaming-config.ts"),r("./src/types/text-config.ts"),r("./src/types/text-style.ts"),r("./src/types/text-track-cue.ts"),r("./src/types/text-track-display-setting.ts"),r("./src/types/thumbnail-vtt-cue.ts"),r("./src/types/track-types.ts"),r("./src/types/video-dimensions.ts"),r("./src/types/video-element-store.ts"),r("./src/types/interfaces/index.ts");var n=r("./src/track/track-type.ts"),a=(r("./src/types/logger-levels.ts"),r("./node_modules/js-logger/src/logger.js")),i={};for(var o in a)["default","TrackType"].indexOf(o)<0&&(i[o]=function(e){return a[e]}.bind(0,o));r.d(t,i)},"./src/types/interfaces/drm-protocol.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/interfaces/engine-capabilty.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/interfaces/engine-decorator.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/interfaces/engine.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/interfaces/index.ts":function(e,t,r){"use strict";r.r(t),r("./src/types/interfaces/drm-protocol.ts"),r("./src/types/interfaces/engine.ts"),r("./src/types/interfaces/engine-capabilty.ts"),r("./src/types/interfaces/engine-decorator.ts"),r("./src/types/interfaces/media-source-adapter.ts")},"./src/types/interfaces/media-source-adapter.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/log-level.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/logger-levels.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/media-source-capabilities.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/media-source-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/media-source.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/metadata-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/mime-types.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/network-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/play-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/playback-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/playback-options.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/player-state.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/prefer-native-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/request-types.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/request.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/response.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/restrictions-types.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/screen-orientation-type.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/session-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/sources-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/stats.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/stream-priority.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/stream-types.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/streaming-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/text-config.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/text-style.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/text-track-cue.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/text-track-display-setting.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/thumbnail-vtt-cue.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/track-types.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/video-dimensions.ts":function(e,t,r){"use strict";r.r(t)},"./src/types/video-element-store.ts":function(e,t,r){"use strict";r.r(t)},"./src/utils/binary-search.ts":function(e,t,r){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 1};if(0===e.length||1===e.length&&0!==t(e[0]))return null;var r=Math.floor(e.length/2);return 0===t(e[r])?e[r]:t(e[r])>0?n(e.slice(0,r),t):n(e.slice(r+1),t)}r.r(t),r.d(t,{binarySearch:function(){return n}})},"./src/utils/env.ts":function(e,t,r){"use strict";r.r(t);var n,a=r("./node_modules/ua-parser-js/src/ua-parser.js"),i=r.n(a),o=/^.*(web0s).*(smarttv).*$/i,s=/^.*(smart-tv).*(tizen).*$/i,l=/^.*(vidaa).*(smarttv).*$/i,u=[[s],[[i().BROWSER.NAME,"SAMSUNG_TV_BROWSER"],[i().BROWSER.MAJOR,""],[i().BROWSER.VERSION,""]]],c=[[o],[i().OS.NAME],[l],[i().OS.NAME]],d=[[o],[[i().DEVICE.VENDOR,"LG"],[i().DEVICE.TYPE,i().DEVICE.SMARTTV]],[s],[[i().DEVICE.VENDOR,"SAMSUNG"],[i().DEVICE.TYPE,i().DEVICE.SMARTTV]],[l],[[i().DEVICE.VENDOR,"HISENSE"],[i().DEVICE.TYPE,i().DEVICE.SMARTTV]],[/^.*(smart-tv|smarttv).*$/i],[[i().DEVICE.TYPE,i().DEVICE.SMARTTV]]],p=[[/(edg)\/((\d+)?[\w.]+)/i],[[i().BROWSER.NAME,"Edge"],i().BROWSER.VERSION,i().BROWSER.MAJOR]],h=[].concat(p,u),f=new(i())(void 0,{browser:h,device:d,os:c}).getResult();f.isConsole=f.device.type===i().DEVICE.CONSOLE,f.isSmartTV=f.device.type===i().DEVICE.SMARTTV,f.isMobile=f.device.type===i().DEVICE.MOBILE,f.isTablet=f.device.type===i().DEVICE.TABLET,f.isWearable=f.device.type===i().DEVICE.WEARABLE,f.isEmbedded=f.device.type===i().DEVICE.EMBEDDED,f.isIPadOS="Mac OS"===f.os.name&&"ontouchend"in document,f.isSafari=Boolean(null===(n=f.browser.name)||void 0===n?void 0:n.includes("Safari")),f.isIOS="iOS"===f.os.name,f.isMacOS="Mac OS"===f.os.name,t.default=f},"./src/utils/index.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Dom:function(){return n.Dom},Generator:function(){return n.Generator},Http:function(){return n.Http},MultiMap:function(){return i.MultiMap},Number:function(){return n.Number},Object:function(){return n.Object},ResizeWatcher:function(){return a.ResizeWatcher},String:function(){return n.String},VERSION:function(){return n.VERSION},binarySearch:function(){return o.binarySearch},getSubtitleStyleSheet:function(){return s.getSubtitleStyleSheet},resetSubtitleStyleSheet:function(){return s.resetSubtitleStyleSheet}});var n=r("./src/utils/util.ts"),a=r("./src/utils/resize-watcher.ts"),i=r("./src/utils/multi-map.ts"),o=r("./src/utils/binary-search.ts"),s=r("./src/utils/styles.ts")},"./src/utils/jsonp.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{jsonp:function(){return s}});var n=r("./src/error/error.ts"),a=5e3,i="jsonpcallback",o="responseFormat=jsonp&callback=";function s(e,t,r){var s,l=(r=r||{}).timeout?r.timeout:a,u=document.createElement("script"),c=i+Math.round(Date.now()+1000001*Math.random()),d=e,p=function(){u&&u.parentNode&&u.parentNode.removeChild(u),window[c]=function(){},s&&clearTimeout(s)};return new Promise((function(r,a){l&&(s=setTimeout((function(){p(),a(new n.default(n.default.Severity.CRITICAL,n.default.Category.NETWORK,n.default.Code.TIMEOUT,e))}),l)),window[c]=function(n){var a=t(n,e);p(),r(a)},d.match(/\?/)?d+="&"+o+c:d+="?"+o+c,u.type="text/javascript",u.src=d,document.getElementsByTagName("head")[0].appendChild(u)}))}},"./src/utils/locale.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,null,[{key:"language",get:function(){var e;return(e=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language)&&e.match("-")&&(e=e.split("-")[0]),e}}]),e}()},"./src/utils/logger.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{LogLevel:function(){return i},LogLevelType:function(){return o},getLogLevel:function(){return u},getLogger:function(){return l},setLogHandler:function(){return s},setLogLevel:function(){return c}});var n=r("./node_modules/js-logger/src/logger.js"),a=r.n(n),i={DEBUG:a().DEBUG,INFO:a().INFO,TIME:a().TIME,WARN:a().WARN,ERROR:a().ERROR,OFF:a().OFF,TRACE:a().TRACE},o={};function s(e){a().setHandler((function(t,r){return e(t,r)}))}function l(e){return e?a().get(e):a()}function u(e){return l(e).getLevel()}function c(e,t){l(t).setLevel(e)}Object.keys(i).forEach((function(e){o[e]=e})),a().useDefaults({defaultLevel:a().ERROR}),t.default=l},"./src/utils/multi-map.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{MultiMap:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js");function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s=function(){function e(){(0,n.default)(this,e),this._map=new Map}return(0,a.default)(e,[{key:"push",value:function(e,t){if(this._map.has(e)){var r=this._map.get(e);Array.isArray(r)&&(r.push(t),this._map.set(e,r))}else this._map.set(e,[t])}},{key:"set",value:function(e,t){this._map.set(e,t)}},{key:"has",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){var t=this._map.get(e);return t?t.slice():[]}},{key:"getAll",value:function(){var e,t=[],r=i(this._map.values());try{for(r.s();!(e=r.n()).done;){var n=e.value;t=t.concat(n)}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"remove",value:function(e,t){if(this._map.has(e)){var r=this._map.get(e);if(Array.isArray(r)){for(var n=0;n<r.length;++n)r[n]===t&&(r.splice(n,1),--n);0===r.length&&this._map.delete(e)}}}},{key:"keys",value:function(){return this._map.keys()}},{key:"clear",value:function(){this._map.clear()}}]),e}()},"./src/utils/poster-manager.ts":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("./src/utils/util.ts"),o=function(){function e(){(0,n.default)(this,e),this._createEl()}return(0,a.default)(e,[{key:"setSrc",value:function(e){e&&(this._posterUrl=e,i.Dom.setStyle(this._el,"background-image",'url("'.concat(this._posterUrl,'")')),this.hide())}},{key:"src",get:function(){return this._posterUrl}},{key:"getElement",value:function(){return this._el}},{key:"_createEl",value:function(){if(!this._el){var e=this._el=i.Dom.createElement("div");i.Dom.setAttribute(e,"id",i.Generator.uniqueId(5)),i.Dom.setAttribute(e,"tabindex","-1")}}},{key:"_removeEl",value:function(){this._el&&i.Dom.removeChild(this._el.parentNode||void 0,this._el)}},{key:"show",value:function(){i.Dom.setStyle(this._el,"display","")}},{key:"hide",value:function(){i.Dom.setStyle(this._el,"display","none")}},{key:"reset",value:function(){this._posterUrl="",i.Dom.setStyle(this._el,"background-image","")}},{key:"destroy",value:function(){this.reset(),this._removeEl()}}]),e}();t.default=o},"./src/utils/resize-watcher.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{ResizeWatcher:function(){return h}});var n=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=r("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=r("./node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("./node_modules/@babel/runtime/helpers/esm/inherits.js"),s=r("./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=r("./src/event/fake-event.ts"),c=r("./src/event/fake-event-target.ts"),d=r("./src/event/event-type.ts");function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,l.default)(e);if(t){var a=(0,l.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var h=function(e){(0,o.default)(r,e);var t=p(r);function r(){return(0,a.default)(this,r),t.call(this)}return(0,i.default)(r,[{key:"destroy",value:function(){this._observer&&this._observer.disconnect(),this._observer=void 0,this._el=void 0}},{key:"init",value:function(e){this._observer||(this._el=e,window.ResizeObserver?this._createNativeObserver():this._createIframeObserver(),this._el instanceof HTMLElement&&this._observer&&this._observer.observe(this._el))}},{key:"_createNativeObserver",value:function(){var e=this;this._observer=new ResizeObserver((function(t){t.forEach((function(){e._triggerResize()}))}))}},{key:"_createIframeObserver",value:function(){this._observer=new f(this._triggerResize.bind(this))}},{key:"_triggerResize",value:function(){this.dispatchEvent(new u.FakeEvent(d.CustomEventType.RESIZE))}}]),r}(c.FakeEventTarget),f=function(){function e(t){(0,a.default)(this,e),(0,n.default)(this,"_observersStore",{}),this._onChangeCallback=t}return(0,i.default)(e,[{key:"observe",value:function(e){var t=this,r=this._createIframe(),n=e.getAttribute("id");this._observersStore[n]=r,e.appendChild(r),r.contentWindow.onresize=function(){return t._onChangeCallback()}}},{key:"disconnect",value:function(){for(var e in this._observersStore){var t=document.getElementById(e),r=this._observersStore[e];r.onresize=null,t&&(t.removeChild(r),delete this._observersStore[t.getAttribute("id")])}}},{key:"_createIframe",value:function(){var e=document.createElement("iframe");return e.className="playkit-size-iframe",e}}]),e}()},"./src/utils/resolution.ts":function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t,r){var a=null;if(r&&e){var i,o=[],s=1/0,l=n(e);try{for(l.s();!(i=l.n()).done;){var u=i.value,c=Math.abs(u.width-t);c<s?(s=c,o=[u]):c===s&&o.push(u)}}catch(e){l.e(e)}finally{l.f()}for(var d=t/r,p=o,h=1/0,f=0,m=o;f<m.length;f++){var g=m[f];if(g.height){var y=Math.abs(g.width/g.height-d);y<h?(h=y,p=[g]):y===h&&p.push(g)}}for(var v=0,_=0,k=p;_<k.length;_++){var E=k[_];(E.bandwidth>v||!E.bandwidth)&&(v=E.bandwidth||v,a=E)}}return a}r.r(t),r.d(t,{getSuitableSourceForResolution:function(){return i}})},"./src/utils/restrictions.ts":function(e,t,r){"use strict";function n(e,t){var r=function(e,t){var r=1/0,n=function(e,t,n){return e>=(t||0)&&e<=(n||r)},a=t.maxHeight,i=t.minHeight,o=t.maxWidth,s=t.minWidth;if(0!==i||0!==s||a!==r||o!==r)return e.filter((function(e){return n(e.height,i,a)})).filter((function(e){return n(e.width,s,o)}));var l=t.maxBitrate,u=t.minBitrate;return 0!==u||l!==r?e.filter((function(e){return n(e.bandwidth,u,l)})):e}(e,t);return r.length?r:[]}r.r(t),r.d(t,{filterTracksByRestriction:function(){return n}})},"./src/utils/styles.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{getSubtitleStyleSheet:function(){return i},resetSubtitleStyleSheet:function(){return o}});var n=r("./src/utils/util.ts"),a="playkit-subtitles-style",i=function(e){var t=n.Dom.getElementBySelector(".".concat(e,".").concat(a));return t||(t=n.Dom.createElement("style"),n.Dom.addClassName(t,e),n.Dom.addClassName(t,a),n.Dom.appendChild(document.head,t)),t.sheet},o=function(e){var t=n.Dom.getElementBySelector(".".concat(e,".").concat(a));null==t||t.remove()}},"./src/utils/util.ts":function(e,t,r){"use strict";r.r(t),r.d(t,{Dom:function(){return h},Generator:function(){return p},Http:function(){return f},Number:function(){return u},Object:function(){return d},String:function(){return c},VERSION:function(){return m}});var n=r("./node_modules/@babel/runtime/helpers/esm/toArray.js"),a=r("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=r("./node_modules/@babel/runtime/helpers/esm/typeof.js"),o=r("./src/utils/jsonp.ts");function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u={isNumber:function(e){return Number(e)===e},isInt:function(e){return this.isNumber(e)&&e%1==0},isFloat:function(e){return this.isNumber(e)&&e%1!=0}},c={capitlize:function(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)},endsWith:function(e,t){return"string"==typeof e&&"string"==typeof t&&-1!==e.indexOf(t,e.length-t.length)}},d={merge:function(e){var t,r={},n=s(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;Object.assign(r,a)}}catch(e){n.e(e)}finally{n.f()}return r},isObject:function(e){return e&&"object"===(0,i.default)(e)&&!Array.isArray(e)},isClassInstance:function(e){return e&&e.constructor&&e.constructor.name&&"Object"!==e.constructor.name},mergeDeep:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(!r.length)return e;var i=r.shift();if(this.isObject(e)&&this.isObject(i))for(var o in i)this.isObject(i[o])&&!this.isClassInstance(i[o])?(e[o]||Object.assign(e,(0,a.default)({},o,{})),this.mergeDeep(e[o],i[o])):Object.assign(e,(0,a.default)({},o,i[o]));return this.mergeDeep.apply(this,[e].concat(r))},copyDeep:function(e){var t,r=this;return Array.isArray(e)?(t=e.length>0?e.slice(0):[]).forEach((function(e,n){("object"===(0,i.default)(e)||Array.isArray(e)&&e.length>0)&&(t[n]=r.copyDeep(e))})):null!==e&&"object"===(0,i.default)(e)?e.clone&&"function"==typeof e.clone?t=e.clone():(t=Object.assign({__proto__:e.__proto__},e),Object.keys(t).forEach((function(e){("object"===(0,i.default)(t[e])||Array.isArray(t[e])&&t[e].length>0)&&(t[e]=r.copyDeep(t[e]))}))):t=e,t},isEmptyObject:function(e){for(var t in e)if(Object.hasOwnProperty.call(e,t))return!1;return!0},getPropertyPath:function(e,t){return t.split(".").reduce((function(e,t){return null==e?e:e[t]}),e)},hasPropertyPath:function(e,t){if(!t)return!1;for(var r=t.split("."),n=0;n<r.length;n++){var a=r[n];if(!e||!Object.hasOwnProperty.call(e,a))return!1;e=e[a]}return!0},createPropertyPath:function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=t.split("."),i=e;a.length>1;){var o=a,s=(0,n.default)(o),l=s[0];a=s.slice(1),void 0===i[l]&&(i[l]={}),i=i[l]}return i[a[0]]=r,e},deletePropertyPath:function(e,t){if(e&&t){for(var r=t.split("."),n=0;n<r.length-1;n++)if(void 0===(e=e[r[n]]))return;delete e[r.pop()]}},defer:function(){var e,t,r=new Promise((function(r,n){e=r,t=n}));return r.resolve=e,r.reject=t,r},bind:function(e,t){return function(){t.apply(e,arguments)}}},p={uniqueId:function(e){var t=2+(!e||e<0?0:e-2);return"_"+Math.random().toString(36).slice(2,2+t)},guid:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},h={addClassName:function(e,t){e&&(e.classList?e.classList.add(t):h.hasClassName(e,t)||(e.className+=t))},removeClassName:function(e,t){e&&(e.classList?e.classList.remove(t):h.hasClassName(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ").replace(/^\s+|\s+$/g,"")))},hasClassName:function(e,t){return e&&e.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},setAttribute:function(e,t,r){e.setAttribute(t,r)},removeAttribute:function(e,t){e.removeAttribute(t)},setStyle:function(e,t,r){void 0!==e.style.getPropertyValue(t)&&e.style.setProperty(t,r)},appendChild:function(e,t){e&&t&&e.appendChild&&e.appendChild(t)},removeChild:function(e,t){e&&t&&e.removeChild&&e.removeChild(t)},prependTo:function(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},getElementById:function(e){return document.getElementById(e)},getElementsByTagName:function(e){return document.getElementsByTagName(e)},createElement:function(e){return document.createElement(e)},loadStyleSheetAsync:function(e){var t=this;return new Promise((function(r,n){var a=!1,i=t.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,i.async=!0,i.onload=i.onreadystatechange=function(){a||this.readyState&&"complete"!==this.readyState||(a=!0,r(this))},i.onerror=i.onabort=n,h.appendChild(document.head,i)}))},loadScriptAsync:function(e){var t=this;return new Promise((function(r,n){var a=!1,i=document.getElementsByTagName("script")[0],o=t.createElement("script");o.type="text/javascript",o.src=e,o.async=!0,o.onload=o.onreadystatechange=function(){a||this.readyState&&"complete"!==this.readyState||(a=!0,r(this))},o.onerror=o.onabort=n,i&&i.parentNode&&i.parentNode.insertBefore(o,i)}))},getElementBySelector:function(e){try{return document.querySelector(e)}catch(e){return}},insertBefore:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{return e.insertBefore(t,r)}catch(e){return null}}},f={protocol:/^(https?:)/i.test(document.location.protocol)?document.location.protocol:"https:",execute:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=new XMLHttpRequest;return new Promise((function(s,l){o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status)try{var e=JSON.parse(o.responseText);s(e)}catch(e){s(o.responseText)}else l(o.responseText)},o.open(r,e),n&&n.forEach((function(e,t){o.setRequestHeader(t,e)})),a&&(o.timeout=a),i&&(o.ontimeout=function(e){i(),l(e)}),o.send(t)}))},jsonp:o.jsonp,convertHeadersToDictionary:function(e){var t={};try{e.trim().split(/[\r\n]+/).forEach((function(e){var r=e.split(": "),n=r.shift().toLowerCase(),a=r.join(": ");t[n]=a}))}catch(e){}return t}},m={compare:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=(r=d.merge([{lexicographical:!1,zeroExtend:!0},r])).lexicographical,a=r.zeroExtend,i=(e||"0").split("."),o=(t||"0").split("."),s=function(e){return(n?/^\d+[A-Za-zαß]*$/:/^\d+[A-Za-zαß]?$/).test(e)},l=function(e){return e.map((function(e){var t=/[A-Za-zαß]/.exec(e);return Number(t?e.replace(t[0],"."+e.charCodeAt(t.index)):e)}))};if(!i.every(s)||!o.every(s))return NaN;if(a){for(;i.length<o.length;)i.push("0");for(;o.length<i.length;)o.push("0")}n||(i=l(i),o=l(o));for(var u=0;u<i.length;++u){if(o.length===u)return 1;if(i[u]!==o[u])return i[u]>o[u]?1:-1}return i.length!==o.length?-1:0}}},"./node_modules/css-loader/dist/cjs.js!./src/assets/style.css":function(module,e,t){"use strict";t.r(e);var r=t("./node_modules/css-loader/dist/runtime/sourceMaps.js"),n=t.n(r),a=t("./node_modules/css-loader/dist/runtime/api.js"),i=t.n(a)()(n());i.push([module.id,".playkit-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  color: #fff;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.playkit-engine {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  object-fit: contain;\n}\n\n.playkit-engine video::-webkit-media-controls-panel,\n.playkit-engine video::-webkit-media-controls-panel-container,\n.playkit-engine video::-webkit-media-controls-start-playback-button,\n.playkit-engine video::-webkit-media-controls-play-button {\n  display: none;\n  -webkit-appearance: none;\n}\n\n.playkit-poster {\n  position: absolute;\n  display: block;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-size: contain;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-color: var(--playkit-player-background-color);\n  pointer-events: none;\n}\n\n.playkit-subtitles {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  pointer-events: none;\n  margin-bottom: 5px;\n}\n\n.playkit-black-cover {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: black;\n  pointer-events: none;\n}\n\n.playkit-size-iframe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  border: 0;\n  z-index: -100;\n}\n\n.playkit-in-browser-fullscreen-mode {\n  width: 100% !important;\n  height: 100% !important;\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  /*added for blocking element with fixed position which could be on the top of the player */\n  z-index: 999999 !important;\n}\n","",{version:3,sources:["webpack://./src/assets/style.css"],names:[],mappings:"AAAA;EACE,kBAAkB;EAClB,WAAW;EACX,YAAY;EACZ,WAAW;EACX,aAAa;EACb,2BAA2B;EAC3B,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;EACjB,wCAAwC;AAC1C;;AAEA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,MAAM;EACN,OAAO;EACP,mBAAmB;AACrB;;AAEA;;;;EAIE,aAAa;EACb,wBAAwB;AAC1B;;AAEA;EACE,kBAAkB;EAClB,cAAc;EACd,MAAM;EACN,SAAS;EACT,OAAO;EACP,QAAQ;EACR,wBAAwB;EACxB,kCAAkC;EAClC,4BAA4B;EAC5B,wDAAwD;EACxD,oBAAoB;AACtB;;AAEA;EACE,kBAAkB;EAClB,MAAM;EACN,SAAS;EACT,QAAQ;EACR,OAAO;EACP,oBAAoB;EACpB,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,YAAY;EACZ,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,SAAS;EACT,aAAa;AACf;;AAEA;EACE,sBAAsB;EACtB,uBAAuB;EACvB,0BAA0B;EAC1B,iBAAiB;EACjB,kBAAkB;EAClB,0FAA0F;EAC1F,0BAA0B;AAC5B",sourcesContent:[".playkit-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  color: #fff;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.playkit-engine {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  object-fit: contain;\n}\n\n.playkit-engine video::-webkit-media-controls-panel,\n.playkit-engine video::-webkit-media-controls-panel-container,\n.playkit-engine video::-webkit-media-controls-start-playback-button,\n.playkit-engine video::-webkit-media-controls-play-button {\n  display: none;\n  -webkit-appearance: none;\n}\n\n.playkit-poster {\n  position: absolute;\n  display: block;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-size: contain;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-color: var(--playkit-player-background-color);\n  pointer-events: none;\n}\n\n.playkit-subtitles {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  pointer-events: none;\n  margin-bottom: 5px;\n}\n\n.playkit-black-cover {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: black;\n  pointer-events: none;\n}\n\n.playkit-size-iframe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  border: 0;\n  z-index: -100;\n}\n\n.playkit-in-browser-fullscreen-mode {\n  width: 100% !important;\n  height: 100% !important;\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  /*added for blocking element with fixed position which could be on the top of the player */\n  z-index: 999999 !important;\n}\n"],sourceRoot:""}]),e.default=i},"./node_modules/css-loader/dist/runtime/api.js":function(module){"use strict";module.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(n)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(o[l]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);n&&o[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),r&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=r):c[2]=r),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":function(module){"use strict";module.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(a," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},"./node_modules/js-logger/src/logger.js":function(module,e,t){var r,n;!function(a){"use strict";var i,o={VERSION:"1.6.1"},s={},l=function(e,t){return function(){return t.apply(e,arguments)}},u=function(){var e,t,r=arguments,n=r[0];for(t=1;t<r.length;t++)for(e in r[t])!(e in n)&&r[t].hasOwnProperty(e)&&(n[e]=r[t][e]);return n},c=function(e,t){return{value:e,name:t}};o.TRACE=c(1,"TRACE"),o.DEBUG=c(2,"DEBUG"),o.INFO=c(3,"INFO"),o.TIME=c(4,"TIME"),o.WARN=c(5,"WARN"),o.ERROR=c(8,"ERROR"),o.OFF=c(99,"OFF");var d=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};d.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(o.TRACE,arguments)},debug:function(){this.invoke(o.DEBUG,arguments)},info:function(){this.invoke(o.INFO,arguments)},warn:function(){this.invoke(o.WARN,arguments)},error:function(){this.invoke(o.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(o.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(o.TIME,[e,"end"])},invoke:function(e,t){i&&this.enabledFor(e)&&i(t,u({level:e},this.context))}};var p,h=new d({filterLevel:o.OFF});(p=o).enabledFor=l(h,h.enabledFor),p.trace=l(h,h.trace),p.debug=l(h,h.debug),p.time=l(h,h.time),p.timeEnd=l(h,h.timeEnd),p.info=l(h,h.info),p.warn=l(h,h.warn),p.error=l(h,h.error),p.log=p.info,o.setHandler=function(e){i=e},o.setLevel=function(e){for(var t in h.setLevel(e),s)s.hasOwnProperty(t)&&s[t].setLevel(e)},o.getLevel=function(){return h.getLevel()},o.get=function(e){return s[e]||(s[e]=new d(u({name:e},h.context)))},o.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},r=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(n,a){n=Array.prototype.slice.call(n);var i,s=console.log;a.level===o.TIME?(i=(a.name?"["+a.name+"] ":"")+n[0],"start"===n[1]?console.time?console.time(i):t[i]=(new Date).getTime():console.timeEnd?console.timeEnd(i):r(s,[i+": "+((new Date).getTime()-t[i])+"ms"])):(a.level===o.WARN&&console.warn?s=console.warn:a.level===o.ERROR&&console.error?s=console.error:a.level===o.INFO&&console.info?s=console.info:a.level===o.DEBUG&&console.debug?s=console.debug:a.level===o.TRACE&&console.trace&&(s=console.trace),e.formatter(n,a),r(s,n))}},o.useDefaults=function(e){o.setLevel(e&&e.defaultLevel||o.DEBUG),o.setHandler(o.createDefaultHandler(e))},o.setDefaults=o.useDefaults,void 0===(n="function"==typeof(r=o)?r.call(e,t,e,module):r)||(module.exports=n)}()},"./src/assets/style.css":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),a=r.n(n),i=r("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),o=r.n(i),s=r("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=r.n(s),u=r("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),c=r.n(u),d=r("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),p=r.n(d),h=r("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),f=r.n(h),m=r("./node_modules/css-loader/dist/cjs.js!./src/assets/style.css"),g={};g.styleTagTransform=f(),g.setAttributes=c(),g.insert=l().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=p(),a()(m.default,g),t.default=m.default&&m.default.locals?m.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":function(module){"use strict";var e=[];function t(t){for(var r=-1,n=0;n<e.length;n++)if(e[n].identifier===t){r=n;break}return r}function r(r,a){for(var i={},o=[],s=0;s<r.length;s++){var l=r[s],u=a.base?l[0]+a.base:l[0],c=i[u]||0,d="".concat(u," ").concat(c);i[u]=c+1;var p=t(d),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(h);else{var f=n(h,a);a.byIndex=s,e.splice(s,0,{identifier:d,updater:f,references:1})}o.push(d)}return o}function n(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}module.exports=function(n,a){var i=r(n=n||[],a=a||{});return function(n){n=n||[];for(var o=0;o<i.length;o++){var s=t(i[o]);e[s].references--}for(var l=r(n,a),u=0;u<i.length;u++){var c=t(i[u]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}i=l}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":function(module){"use strict";var e={};module.exports=function(t,r){var n=function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":function(module){"use strict";module.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":function(module,e,t){"use strict";module.exports=function(e){var r=t.nc;r&&e.setAttribute("nonce",r)}},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":function(module){"use strict";module.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var a=void 0!==r.layer;a&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,a&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":function(module){"use strict";module.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},"./node_modules/ua-parser-js/src/ua-parser.js":function(module,e,t){var r;!function(n,a){"use strict";var i="function",s="undefined",l="object",u="string",c="major",d="model",p="name",h="type",f="vendor",m="version",g="architecture",y="console",v="mobile",_="tablet",k="smarttv",E="wearable",b="embedded",T="Amazon",A="Apple",S="ASUS",C="BlackBerry",P="Browser",x="Chrome",w="Firefox",I="Google",M="Huawei",R="LG",D="Microsoft",O="Motorola",L="Opera",N="Samsung",U="Sharp",j="Sony",B="Xiaomi",F="Zebra",V="Facebook",H="Chromium OS",G="Mac OS",$=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},K=function(e,t){return o(e)===u&&-1!==W(t).indexOf(W(e))},W=function(e){return e.toLowerCase()},z=function(e,t){if(o(e)===u)return e=e.replace(/^\s\s*/,""),o(t)===s?e:e.substring(0,500)},q=function(e,t){for(var r,n,s,u,c,d,p=0;p<t.length&&!c;){var h=t[p],f=t[p+1];for(r=n=0;r<h.length&&!c&&h[r];)if(c=h[r++].exec(e))for(s=0;s<f.length;s++)d=c[++n],o(u=f[s])===l&&u.length>0?2===u.length?o(u[1])==i?this[u[0]]=u[1].call(this,d):this[u[0]]=u[1]:3===u.length?o(u[1])!==i||u[1].exec&&u[1].test?this[u[0]]=d?d.replace(u[1],u[2]):a:this[u[0]]=d?u[1].call(this,d,u[2]):a:4===u.length&&(this[u[0]]=d?u[3].call(this,d.replace(u[1],u[2])):a):this[u]=d||a;p+=2}},Y=function(e,t){for(var r in t)if(o(t[r])===l&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(K(t[r][n],e))return"?"===r?a:r}else if(K(t[r],e))return"?"===r?a:r;return e},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Z={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[m,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[m,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,m],[/opios[\/ ]+([\w\.]+)/i],[m,[p,L+" Mini"]],[/\bopr\/([\w\.]+)/i],[m,[p,L]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[m,[p,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[p,m],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[m,[p,"UC"+P]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[m,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[m,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[m,[p,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[m,[p,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[m,[p,"Smart Lenovo "+P]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure "+P],m],[/\bfocus\/([\w\.]+)/i],[m,[p,w+" Focus"]],[/\bopt\/([\w\.]+)/i],[m,[p,L+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[m,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[m,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[m,[p,L+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[m,[p,"MIUI "+P]],[/fxios\/([-\w\.]+)/i],[m,[p,w]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 "+P]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1 "+P],m],[/samsungbrowser\/([\w\.]+)/i],[m,[p,N+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],m],[/metasr[\/ ]?([\d\.]+)/i],[m,[p,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[p,"Sogou Mobile"],m],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[p,m],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,V],m],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[p,m],[/\bgsa\/([\w\.]+) .*safari\//i],[m,[p,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[m,[p,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[m,[p,x+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,x+" WebView"],m],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[m,[p,"Android "+P]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,m],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[m,[p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[m,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[m,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[p,m],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],m],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[m,[p,w+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[p,m],[/(cobalt)\/([\w\.]+)/i],[p,[m,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,W]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,"",W]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,W]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[f,N],[h,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[d,[f,N],[h,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[f,A],[h,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[f,A],[h,_]],[/(macintosh);/i],[d,[f,A]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[f,U],[h,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[f,M],[h,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[f,M],[h,v]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[d,/_/g," "],[f,B],[h,v]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[f,B],[h,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[f,"OPPO"],[h,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[f,"Vivo"],[h,v]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[f,"Realme"],[h,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[f,O],[h,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[f,O],[h,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[f,R],[h,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[f,R],[h,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[f,"Lenovo"],[h,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[f,"Nokia"],[h,v]],[/(pixel c)\b/i],[d,[f,I],[h,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[f,I],[h,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[f,j],[h,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[f,j],[h,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[f,"OnePlus"],[h,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[f,T],[h,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[f,T],[h,v]],[/(playbook);[-\w\),; ]+(rim)/i],[d,f,[h,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[f,C],[h,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[f,S],[h,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[f,S],[h,v]],[/(nexus 9)/i],[d,[f,"HTC"],[h,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[f,[d,/_/g," "],[h,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[f,"Acer"],[h,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[f,"Meizu"],[h,v]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[f,"Ulefone"],[h,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,d,[h,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,d,[h,_]],[/(surface duo)/i],[d,[f,D],[h,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[f,"Fairphone"],[h,v]],[/(u304aa)/i],[d,[f,"AT&T"],[h,v]],[/\bsie-(\w*)/i],[d,[f,"Siemens"],[h,v]],[/\b(rct\w+) b/i],[d,[f,"RCA"],[h,_]],[/\b(venue[\d ]{2,7}) b/i],[d,[f,"Dell"],[h,_]],[/\b(q(?:mv|ta)\w+) b/i],[d,[f,"Verizon"],[h,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[f,"Barnes & Noble"],[h,_]],[/\b(tm\d{3}\w+) b/i],[d,[f,"NuVision"],[h,_]],[/\b(k88) b/i],[d,[f,"ZTE"],[h,_]],[/\b(nx\d{3}j) b/i],[d,[f,"ZTE"],[h,v]],[/\b(gen\d{3}) b.+49h/i],[d,[f,"Swiss"],[h,v]],[/\b(zur\d{3}) b/i],[d,[f,"Swiss"],[h,_]],[/\b((zeki)?tb.*\b) b/i],[d,[f,"Zeki"],[h,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],d,[h,_]],[/\b(ns-?\w{0,9}) b/i],[d,[f,"Insignia"],[h,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[f,"NextBook"],[h,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],d,[h,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],d,[h,v]],[/\b(ph-1) /i],[d,[f,"Essential"],[h,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[f,"Envizen"],[h,_]],[/\b(trio[-\w\. ]+) b/i],[d,[f,"MachSpeed"],[h,_]],[/\btu_(1491) b/i],[d,[f,"Rotor"],[h,_]],[/(shield[\w ]+) b/i],[d,[f,"Nvidia"],[h,_]],[/(sprint) (\w+)/i],[f,d,[h,v]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[f,D],[h,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[f,F],[h,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[f,F],[h,v]],[/smart-tv.+(samsung)/i],[f,[h,k]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[f,N],[h,k]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,R],[h,k]],[/(apple) ?tv/i],[f,[d,A+" TV"],[h,k]],[/crkey/i],[[d,x+"cast"],[f,I],[h,k]],[/droid.+aft(\w+)( bui|\))/i],[d,[f,T],[h,k]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[f,U],[h,k]],[/(bravia[\w ]+)( bui|\))/i],[d,[f,j],[h,k]],[/(mitv-\w{5}) bui/i],[d,[f,B],[h,k]],[/Hbbtv.*(technisat) (.*);/i],[f,d,[h,k]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[f,z],[d,z],[h,k]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,k]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,d,[h,y]],[/droid.+; (shield) bui/i],[d,[f,"Nvidia"],[h,y]],[/(playstation [345portablevi]+)/i],[d,[f,j],[h,y]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[f,D],[h,y]],[/((pebble))app/i],[f,d,[h,E]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[f,A],[h,E]],[/droid.+; (glass) \d/i],[d,[f,I],[h,E]],[/droid.+; (wt63?0{2,3})\)/i],[d,[f,F],[h,E]],[/(quest( 2| pro)?)/i],[d,[f,V],[h,E]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[h,b]],[/(aeobc)\b/i],[d,[f,T],[h,b]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[h,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[h,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,v]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[m,[p,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[m,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[p,m],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[m,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,m],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[p,[m,Y,X]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[m,Y,X],[p,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[m,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,G],[m,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[m,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,m],[/\(bb(10);/i],[m,[p,C]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[m,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[m,[p,w+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[m,[p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[m,[p,"watchOS"]],[/crkey\/([\d\.]+)/i],[m,[p,x+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[p,H],m],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,m],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],m],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[p,m]]},Q=function e(t,r){if(o(t)===l&&(r=t,t=a),!(this instanceof e))return new e(t,r).getResult();var y=o(n)!==s&&n.navigator?n.navigator:a,k=t||(y&&y.userAgent?y.userAgent:""),E=y&&y.userAgentData?y.userAgentData:a,b=r?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(Z,r):Z,T=y&&y.userAgent==k;return this.getBrowser=function(){var e,t={};return t[p]=a,t[m]=a,q.call(t,k,b.browser),t[c]=o(e=t[m])===u?e.replace(/[^\d\.]/g,"").split(".")[0]:a,T&&y&&y.brave&&o(y.brave.isBrave)==i&&(t[p]="Brave"),t},this.getCPU=function(){var e={};return e[g]=a,q.call(e,k,b.cpu),e},this.getDevice=function(){var e={};return e[f]=a,e[d]=a,e[h]=a,q.call(e,k,b.device),T&&!e[h]&&E&&E.mobile&&(e[h]=v),T&&"Macintosh"==e[d]&&y&&o(y.standalone)!==s&&y.maxTouchPoints&&y.maxTouchPoints>2&&(e[d]="iPad",e[h]=_),e},this.getEngine=function(){var e={};return e[p]=a,e[m]=a,q.call(e,k,b.engine),e},this.getOS=function(){var e={};return e[p]=a,e[m]=a,q.call(e,k,b.os),T&&!e[p]&&E&&"Unknown"!=E.platform&&(e[p]=E.platform.replace(/chrome os/i,H).replace(/macos/i,G)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return k},this.setUA=function(e){return k=o(e)===u&&e.length>500?z(e,500):e,this},this.setUA(k),this};Q.VERSION="1.0.37",Q.BROWSER=$([p,m,c]),Q.CPU=$([g]),Q.DEVICE=$([d,f,h,y,v,k,_,E,b]),Q.ENGINE=Q.OS=$([p,m]),o(e)!==s?(module.exports&&(e=module.exports=Q),e.UAParser=Q):t.amdO?(r=function(){return Q}.call(e,t,e,module))===a||(module.exports=r):o(n)!==s&&(n.UAParser=Q);var J=o(n)!==s&&(n.jQuery||n.Zepto);if(J&&!J.ua){var ee=new Q;J.ua=ee.getResult(),J.ua.get=function(){return ee.getUA()},J.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var r in t)J.ua[r]=t[r]}}}("object"===("undefined"==typeof window?"undefined":o(window))?window:this)},"./node_modules/@babel/runtime/helpers/regeneratorRuntime.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/typeof.js").default;function n(){"use strict";module.exports=n=function(){return t},module.exports.__esModule=!0,module.exports.default=module.exports;var e,t={},a=Object.prototype,i=a.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function d(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var a=t&&t.prototype instanceof _?t:_,i=Object.create(a.prototype),s=new R(n||[]);return o(i,"_invoke",{value:x(e,r,s)}),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var f="suspendedStart",m="suspendedYield",g="executing",y="completed",v={};function _(){}function k(){}function E(){}var b={};d(b,l,(function(){return this}));var T=Object.getPrototypeOf,A=T&&T(T(D([])));A&&A!==a&&i.call(A,l)&&(b=A);var S=E.prototype=_.prototype=Object.create(b);function C(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function n(a,o,s,l){var u=h(e[a],e,o);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==r(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,l)}),(function(e){n("throw",e,s,l)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}})}function x(t,r,n){var a=f;return function(i,o){if(a===g)throw new Error("Generator is already running");if(a===y){if("throw"===i)throw o;return{value:e,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var l=w(s,n);if(l){if(l===v)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=g;var u=h(t,r,n);if("normal"===u.type){if(a=n.done?y:m,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=y,n.method="throw",n.arg=u.arg)}}}function w(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,w(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(a,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var o=i.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function D(t){if(t||""===t){var n=t[l];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){for(;++a<t.length;)if(i.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(r(t)+" is not iterable")}return k.prototype=E,o(S,"constructor",{value:E,configurable:!0}),o(E,"constructor",{value:k,configurable:!0}),k.displayName=d(E,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,d(e,c,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},C(P.prototype),d(P.prototype,u,(function(){return this})),t.AsyncIterator=P,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var o=new P(p(e,r,n,a),i);return t.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},C(S),d(S,c,"Generator"),d(S,l,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=D,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;M(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}module.exports=n,module.exports.__esModule=!0,module.exports.default=module.exports},"./node_modules/@babel/runtime/helpers/typeof.js":function(module){function e(t){return module.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},module.exports.__esModule=!0,module.exports.default=module.exports,e(t)}module.exports=e,module.exports.__esModule=!0,module.exports.default=module.exports},"./node_modules/@babel/runtime/regenerator/index.js":function(module,e,t){var r=t("./node_modules/@babel/runtime/helpers/regeneratorRuntime.js")();module.exports=r;try{regeneratorRuntime=r}catch(e){"object"===("undefined"==typeof globalThis?"undefined":o(globalThis))?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},"./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js":function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js":function(e,t,r){"use strict";function n(e){if(Array.isArray(e))return e}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js");function a(e){if(Array.isArray(e))return(0,n.default)(e)}},"./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js":function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js":function(e,t,r){"use strict";function n(e,t,r,n,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(a,i){var o=e.apply(t,r);function s(e){n(o,a,i,s,l,"next",e)}function l(e){n(o,a,i,s,l,"throw",e)}s(void 0)}))}}r.r(t),r.d(t,{default:function(){return a}})},"./node_modules/@babel/runtime/helpers/esm/classCallCheck.js":function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/createClass.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js");function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(0,n.default)(a.key),a)}}function i(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}},"./node_modules/@babel/runtime/helpers/esm/defineProperty.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js");function a(e,t,r){return(t=(0,n.default)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},"./node_modules/@babel/runtime/helpers/esm/get.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/superPropBase.js");function a(){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var a=(0,n.default)(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},a.apply(this,arguments)}},"./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js":function(e,t,r){"use strict";function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/inherits.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js");function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,n.default)(e,t)}},"./node_modules/@babel/runtime/helpers/esm/iterableToArray.js":function(e,t,r){"use strict";function n(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js":function(e,t,r){"use strict";function n(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js":function(e,t,r){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js":function(e,t,r){"use strict";function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/typeof.js"),a=r("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js");function i(e,t){if(t&&("object"===(0,n.default)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,a.default)(e)}},"./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js":function(e,t,r){"use strict";function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/slicedToArray.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js"),a=r("./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js"),i=r("./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js"),o=r("./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js");function s(e,t){return(0,n.default)(e)||(0,a.default)(e,t)||(0,i.default)(e,t)||(0,o.default)()}},"./node_modules/@babel/runtime/helpers/esm/superPropBase.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js");function a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,n.default)(e)););return e}},"./node_modules/@babel/runtime/helpers/esm/toArray.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js"),a=r("./node_modules/@babel/runtime/helpers/esm/iterableToArray.js"),i=r("./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js"),o=r("./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js");function s(e){return(0,n.default)(e)||(0,a.default)(e)||(0,i.default)(e)||(0,o.default)()}},"./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js"),a=r("./node_modules/@babel/runtime/helpers/esm/iterableToArray.js"),i=r("./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js"),o=r("./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js");function s(e){return(0,n.default)(e)||(0,a.default)(e)||(0,i.default)(e)||(0,o.default)()}},"./node_modules/@babel/runtime/helpers/esm/toPrimitive.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/typeof.js");function a(e,t){if("object"!==(0,n.default)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!==(0,n.default)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}},"./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r("./node_modules/@babel/runtime/helpers/esm/typeof.js"),a=r("./node_modules/@babel/runtime/helpers/esm/toPrimitive.js");function i(e){var t=(0,a.default)(e,"string");return"symbol"===(0,n.default)(t)?t:String(t)}},"./node_modules/@babel/runtime/helpers/esm/typeof.js":function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.r(t),r.d(t,{default:function(){return n}})},"./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js":function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return a}});var n=r("./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js");function a(e,t){if(e){if("string"==typeof e)return(0,n.default)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.default)(e,t):void 0}}},"./src/assets/encoding-sources.json":function(module){"use strict";module.exports=JSON.parse('{"Base64Mp4Source":"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE="}')},"./src/engines/html5/media-source/adapters/native-adapter-default-config.json":function(module){"use strict";module.exports=JSON.parse('{"heartbeatTimeout":30000}')}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var module=t[n]={id:n,exports:{}};return e[n].call(module.exports,module,module.exports,r),module.exports}r.amdO={},r.n=function(module){var e=module&&module.__esModule?function(){return module.default}:function(){return module};return r.d(e,{a:e}),e},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nc=void 0;var n={};return function(){"use strict";r.r(n),r.d(n,{AbrMode:function(){return S.AbrMode},AdBreakType:function(){return M.AdBreakType},AdEventType:function(){return D.AdEventType},AdTagType:function(){return R.AdTagType},AudioTrack:function(){return p.default},AutoPlayType:function(){return L.AutoPlayType},BaseMediaSourceAdapter:function(){return t.default},BaseMiddleware:function(){return s.default},CorsType:function(){return P.CorsType},CustomEventType:function(){return A.CustomEventType},DrmScheme:function(){return x.DrmScheme},EngineDecoratorProvider:function(){return i.EngineDecoratorProvider},EngineType:function(){return b.EngineType},Env:function(){return g.default},Error:function(){return v.default},EventManager:function(){return B.EventManager},EventType:function(){return A.EventType},FakeEvent:function(){return j.FakeEvent},FakeEventTarget:function(){return F.FakeEventTarget},Html5EventType:function(){return A.Html5EventType},ImageTrack:function(){return c.default},LogLevel:function(){return C.LogLevel},LogLevelType:function(){return C.LogLevelType},MediaType:function(){return T.MediaType},MimeType:function(){return w.MimeType},NAME:function(){return K},PKTextTrack:function(){return h.PKTextTrack},Player:function(){return e.default},RequestType:function(){return I.RequestType},ScreenOrientationType:function(){return O.ScreenOrientationType},State:function(){return l.default},StateType:function(){return _.StateType},StreamType:function(){return E.StreamType},TextStyle:function(){return m.default},TextTrack:function(){return h.default},ThumbnailInfo:function(){return N.ThumbnailInfo},TimedMetadata:function(){return f.TimedMetadata},Track:function(){return u.default},TrackType:function(){return k.TrackType},Utils:function(){return y},VERSION:function(){return $},VideoTrack:function(){return d.default},createTextTrackCue:function(){return f.createTextTrackCue},createTimedMetadata:function(){return f.createTimedMetadata},filterTracksByRestriction:function(){return U.filterTracksByRestriction},getCapabilities:function(){return z},getLogLevel:function(){return C.getLogLevel},getLogger:function(){return C.default},loadPlayer:function(){return W},registerEngine:function(){return o.registerEngine},registerMediaSourceAdapter:function(){return a.registerMediaSourceAdapter},setCapabilities:function(){return q},setLogHandler:function(){return C.setLogHandler},setLogLevel:function(){return C.setLogLevel},unRegisterEngine:function(){return o.unRegisterEngine},utils:function(){return y}});var e=r("./src/player.ts"),t=r("./src/engines/html5/media-source/base-media-source-adapter.ts"),a=r("./src/engines/html5/media-source/media-source-provider.ts"),i=r("./src/engines/engine-decorator-provider.ts"),o=r("./src/engines/engine-provider.ts"),s=r("./src/middleware/base-middleware.ts"),l=r("./src/state/state.ts"),u=r("./src/track/track.ts"),c=r("./src/track/image-track.ts"),d=r("./src/track/video-track.ts"),p=r("./src/track/audio-track.ts"),h=r("./src/track/text-track.ts"),f=r("./src/track/timed-metadata.ts"),m=r("./src/track/text-style.ts"),g=r("./src/utils/env.ts"),y=r("./src/utils/index.ts"),v=r("./src/error/error.ts"),_=r("./src/state/state-type.ts"),k=r("./src/track/track-type.ts"),E=r("./src/engines/stream-type.ts"),b=r("./src/engines/engine-type.ts"),T=r("./src/enums/media-type.ts"),A=r("./src/event/event-type.ts"),S=r("./src/track/abr-mode-type.ts"),C=r("./src/utils/logger.ts"),P=r("./src/engines/html5/cors-types.ts"),x=r("./src/drm/drm-scheme.ts"),w=r("./src/enums/mime-type.ts"),I=r("./src/enums/request-type.ts"),M=r("./src/ads/ad-break-type.ts"),R=r("./src/ads/ad-tag-type.ts"),D=r("./src/ads/ad-event-type.ts"),O=r("./src/enums/screen-orientation-type.ts"),L=r("./src/enums/auto-play-type.ts"),N=r("./src/thumbnail/thumbnail-info.ts"),U=r("./src/utils/restrictions.ts"),j=r("./src/event/fake-event.ts"),B=r("./src/event/event-manager.ts"),F=r("./src/event/fake-event-target.ts"),V=r("./src/types/index.ts"),H={};for(var G in V)["default","loadPlayer","registerMediaSourceAdapter","BaseMediaSourceAdapter","BaseMiddleware","Track","VideoTrack","AudioTrack","TextTrack","PKTextTrack","ImageTrack","TextStyle","TimedMetadata","createTextTrackCue","createTimedMetadata","Utils","utils","Error","FakeEvent","EventManager","FakeEventTarget","VERSION","NAME","Env","State","getCapabilities","setCapabilities","EngineDecoratorProvider","registerEngine","unRegisterEngine","AdBreakType","AdTagType","AdEventType","filterTracksByRestriction","Html5EventType","CustomEventType","EventType","StateType","TrackType","EngineType","MediaType","StreamType","AbrMode","LogLevelType","CorsType","DrmScheme","MimeType","RequestType","ScreenOrientationType","AutoPlayType","ThumbnailInfo","getLogger","LogLevel","getLogLevel","setLogLevel","setLogHandler","Player"].indexOf(G)<0&&(H[G]=function(e){return V[e]}.bind(0,G));r.d(n,H);var $="0.84.12",K="@playkit-js/playkit-js";function W(t){return new e.default(t||{})}var z=e.default.getCapabilities,q=e.default.setCapabilities;n.default=W}(),n}()},"object"===o(e)&&"object"===o(module)?module.exports=i():(n=[],void 0===(a="function"==typeof(r=i)?r.apply(e,n):r)||(module.exports=a))},129:(module,e,t)=>{"use strict";t.d(e,{Z:()=>o});var r=t(864),n=t.n(r),a=t(352),i=t.n(a)()(n());i.push([module.id,".kaltura-player-container {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  background-color: #000;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n","",{version:3,sources:["webpack://./assets/style.css"],names:[],mappings:"AAAA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,sBAAsB;EACtB,aAAa;EACb,2BAA2B;EAC3B,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;EACjB,wCAAwC;AAC1C",sourcesContent:[".kaltura-player-container {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  background-color: #000;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n"],sourceRoot:""}]);const o=i},644:(module,e,t)=>{var r,n;self,module.exports=(r=t(538),n=t(673),function(){var e={774:function(e,t,r){"use strict";var n=r(537),a=r.n(n),i=r(645),o=r.n(i)()(a());o.push([e.id,".shaka-text-container {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  pointer-events: none;\n  width: 100%;\n  min-width: 48px;\n  transition: bottom cubic-bezier(0.4, 0, 0.6, 1) 0.1s;\n  transition-delay: 0s;\n  font-size: 20px;\n  line-height: 1.4;\n  color: #fff;\n  font-family: Roboto-Regular, Roboto, sans-serif, TengwarTelcontar;\n}\n.shaka-text-container span.shaka-text-wrapper {\n  display: inline;\n  background: 0 0;\n  text-align: center;\n}\n\n:fullscreen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-webkit-full-screen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-moz-full-screen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-ms-fullscreen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n","",{version:3,sources:["webpack://./src/assets/style.css"],names:[],mappings:"AAAA;EACE,kBAAkB;EAClB,OAAO;EACP,QAAQ;EACR,MAAM;EACN,SAAS;EACT,oBAAoB;EACpB,WAAW;EACX,eAAe;EACf,oDAAoD;EACpD,oBAAoB;EACpB,eAAe;EACf,gBAAgB;EAChB,WAAW;EACX,iEAAiE;AACnE;AACA;EACE,eAAe;EACf,eAAe;EACf,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;AACpB",sourcesContent:[".shaka-text-container {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  pointer-events: none;\n  width: 100%;\n  min-width: 48px;\n  transition: bottom cubic-bezier(0.4, 0, 0.6, 1) 0.1s;\n  transition-delay: 0s;\n  font-size: 20px;\n  line-height: 1.4;\n  color: #fff;\n  font-family: Roboto-Regular, Roboto, sans-serif, TengwarTelcontar;\n}\n.shaka-text-container span.shaka-text-wrapper {\n  display: inline;\n  background: 0 0;\n  text-align: center;\n}\n\n:fullscreen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-webkit-full-screen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-moz-full-screen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-ms-fullscreen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n"],sourceRoot:""}]),t.Z=o},645:function(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(n)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(o[l]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);n&&o[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),r&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=r):c[2]=r),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},537:function(e){"use strict";e.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(a," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},379:function(e){"use strict";var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var i={},o=[],s=0;s<e.length;s++){var l=e[s],u=n.base?l[0]+n.base:l[0],c=i[u]||0,d="".concat(u," ").concat(c);i[u]=c+1;var p=r(d),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var f=a(h,n);n.byIndex=s,t.splice(s,0,{identifier:d,updater:f,references:1})}o.push(d)}return o}function a(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,a){var i=n(e=e||[],a=a||{});return function(e){e=e||[];for(var o=0;o<i.length;o++){var s=r(i[o]);t[s].references--}for(var l=n(e,a),u=0;u<i.length;u++){var c=r(i[u]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}i=l}}},569:function(e){"use strict";var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},216:function(e){"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:function(e,t,r){"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},795:function(e){"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var a=void 0!==r.layer;a&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,a&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:function(e){"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},952:function(e){"use strict";e.exports=r},475:function(e){"use strict";e.exports=n},61:function(e,t,r){var n=r(698).default;function a(){"use strict";e.exports=a=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var t,r={},i=Object.prototype,o=i.hasOwnProperty,s=Object.defineProperty||function(e,t,r){e[t]=r.value},l="function"==typeof Symbol?Symbol:{},u=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",d=l.toStringTag||"@@toStringTag";function p(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(t){p=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var a=t&&t.prototype instanceof k?t:k,i=Object.create(a.prototype),o=new D(n||[]);return s(i,"_invoke",{value:w(e,r,o)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var m="suspendedStart",g="suspendedYield",y="executing",v="completed",_={};function k(){}function E(){}function b(){}var T={};p(T,u,(function(){return this}));var A=Object.getPrototypeOf,S=A&&A(A(O([])));S&&S!==i&&o.call(S,u)&&(T=S);var C=b.prototype=k.prototype=Object.create(T);function P(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(a,i,s,l){var u=f(e[a],e,i);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==n(d)&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,l)}),(function(e){r("throw",e,s,l)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return r("throw",e,s,l)}))}l(u.arg)}var a;s(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}})}function w(e,r,n){var a=m;return function(i,o){if(a===y)throw new Error("Generator is already running");if(a===v){if("throw"===i)throw o;return{value:t,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var l=I(s,n);if(l){if(l===_)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===m)throw a=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=y;var u=f(e,r,n);if("normal"===u.type){if(a=n.done?v:g,u.arg===_)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=v,n.method="throw",n.arg=u.arg)}}}function I(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var i=f(a,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,_;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,_):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function r(){for(;++a<e.length;)if(o.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(n(e)+" is not iterable")}return E.prototype=b,s(C,"constructor",{value:b,configurable:!0}),s(b,"constructor",{value:E,configurable:!0}),E.displayName=p(b,d,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===E||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,p(e,d,"GeneratorFunction")),e.prototype=Object.create(C),e},r.awrap=function(e){return{__await:e}},P(x.prototype),p(x.prototype,c,(function(){return this})),r.AsyncIterator=x,r.async=function(e,t,n,a,i){void 0===i&&(i=Promise);var o=new x(h(e,t,n,a),i);return r.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},P(C),p(C,d,"Generator"),p(C,u,(function(){return this})),p(C,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=O,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,a){return s.type="throw",s.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var l=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;R(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:O(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),_}},r}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},698:function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},687:function(e,t,r){var n=r(61)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,a),i.exports}a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nc=void 0;var i={};return function(){"use strict";a.r(i),a.d(i,{NAME:function(){return se},VERSION:function(){return oe},default:function(){return le}});var e=a(952);function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}function n(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t,r,n,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){o(i,n,a,s,l,"next",e)}function l(e){o(i,n,a,s,l,"throw",e)}s(void 0)}))}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:String(t)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function p(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function m(){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(arguments.length<3?e:r):a.value}},m.apply(this,arguments)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function y(e,t,r){return(t=c(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v,_,k=a(687),E=a.n(k),b=a(475),T=a.n(b),A=(v=function(){function t(){l(this,t)}return p(t,null,[{key:"isConfigured",value:function(t,r){return e.DrmScheme.WIDEVINE===r.keySystem&&!!t.find((function(e){return e.scheme===r.keySystem}))}},{key:"canPlayDrm",value:function(r){return t._logger.debug("Can play DRM scheme of: "+e.DrmScheme.WIDEVINE),!!r.find((function(t){return t.scheme===e.DrmScheme.WIDEVINE}))}},{key:"setDrmPlayback",value:function(r,n){t._logger.debug("Sets drm playback");var a=e.Env.browser.name,i=n.find((function(t){return t.scheme===e.DrmScheme.WIDEVINE}));i&&(r.drm={servers:y({},e.DrmScheme.WIDEVINE,i.licenseUrl),advanced:{}},"Chrome"===a&&(r.drm.advanced=y({},e.DrmScheme.WIDEVINE,{videoRobustness:"SW_SECURE_CRYPTO",audioRobustness:"SW_SECURE_CRYPTO"})))}}]),t}(),y(v,"_logger",(0,e.getLogger)("Widevine")),v),S=(_=function(){function t(){l(this,t)}return p(t,null,[{key:"isConfigured",value:function(t,r){return e.DrmScheme.PLAYREADY===r.keySystem&&!!t.find((function(e){return e.scheme===r.keySystem}))}},{key:"canPlayDrm",value:function(r){return t._logger.debug("Can play DRM scheme of: "+e.DrmScheme.PLAYREADY),!!r.find((function(t){return t.scheme===e.DrmScheme.PLAYREADY}))}},{key:"setDrmPlayback",value:function(r,n){t._logger.debug("Sets drm playback");var a=n.find((function(t){return t.scheme===e.DrmScheme.PLAYREADY}));a&&(r.drm={servers:y({},e.DrmScheme.PLAYREADY,a.licenseUrl)})}}]),t}(),y(_,"_logger",(0,e.getLogger)("PlayReady")),_),C=JSON.parse('{"shakaConfig":{"streaming":{"ignoreTextStreamFailures":true,"bufferingGoal":60,"alwaysStreamText":true},"abr":{"enabled":true,"restrictions":{}}},"forceRedirectExternalStreams":false,"trackEmsgEvents":true,"switchDynamicToStatic":false,"stallDetectionThreshold":3}'),P=a(379),x=a.n(P),w=a(795),I=a.n(w),M=a(569),R=a.n(M),D=a(565),O=a.n(D),L=a(216),N=a.n(L),U=a(589),j=a.n(U),B=a(774),F={};F.styleTagTransform=j(),F.setAttributes=O(),F.insert=R().bind(null,"head"),F.domAPI=I(),F.insertStyleElement=N(),x()(B.Z,F),B.Z&&B.Z.locals&&B.Z.locals;var V=function(){function e(t){l(this,e),this._media=$.parseAttr(t,G.AttributeTypes.MEDIA),this._startNumber=$.parseAttr(t,G.AttributeTypes.START_NUMBER,$.parseInt,1),this._duration=$.parseAttr(t,G.AttributeTypes.DURATION,$.parseFloat),this._timescale=$.parseAttr(t,G.AttributeTypes.TIMESCALE,$.parsePositiveInt,1),this._presentationTimeOffset=$.parseAttr(t,G.AttributeTypes.PRESENTATION_TIME_OFFSET,$.parseInt,0),this._endNumber=$.parseAttr(t,G.AttributeTypes.END_NUMBER,$.parsePositiveInt)}return p(e,[{key:"media",get:function(){return this._media}},{key:"startNumber",get:function(){return this._startNumber}},{key:"duration",get:function(){return this._duration}},{key:"timescale",get:function(){return this._timescale}},{key:"presentationTimeOffset",get:function(){return this._presentationTimeOffset}},{key:"endNumber",get:function(){return this._endNumber}}]),e}();y(V,"MediaTemplateType",{REPRESENTATION:"$RepresentationID$",NUMBER:"$Number$",BANDWIDTH:"$Bandwidth$",TIME:"$Time$"});var H=function(e,t){var r=t.id,n=t.index,a=t.bitrate,i=t.time,o=e.match(/\$([a-zA-Z]+)\$/g),s=function(e,t,r){return r?e.replace(t,r):e};return o&&o.forEach((function(t){switch(t){case V.MediaTemplateType.REPRESENTATION:e=s(e,t,r);break;case V.MediaTemplateType.NUMBER:e=s(e,t,n);break;case V.MediaTemplateType.BANDWIDTH:e=s(e,t,a);break;case V.MediaTemplateType.TIME:e=s(e,t,i)}})),e},G={TagTypes:{BASE_URL:"BaseURL",SEGMENT_TEMPLATE:"SegmentTemplate",REPRESENTATION:"Representation",ESSENTIAL_PROPERTY:"EssentialProperty",ADAPTATION_SET:"AdaptationSet"},AttributeTypes:{BASE_URL:"BaseURL",ID:"id",CONTENT_TYPE:"contentType",MIME_TYPE:"mimeType",MEDIA:"media",DURATION:"duration",START_NUMBER:"startNumber",TIMESCALE:"timescale",PRESENTATION_TIME_OFFSET:"presentationTimeOffset",END_NUMBER:"endNumber",BANDWIDTH:"bandwidth",WIDTH:"width",HEIGHT:"height",SCHEME_ID_URI:"schemeIdUri",VALUE:"value"}},$={parseXml:function(e){return(new DOMParser).parseFromString(e,"text/xml")},parseAttr:function(e,t,r,n){var a=null,i=e.getAttribute(t);return null!==i&&(a=r?r(i):i),null===a?n:a},findElements:function(e,t){return e.getElementsByTagName(t)},findChild:function(e,t){var r=this.findChildren(e,t);return 1!==r.length?null:r[0]},findChildren:function(e,t){return Array.from(e.childNodes).filter((function(e){return e instanceof Element&&e.tagName===t}))},parseInt:function(e){var t=Number(e);return t%1==0?t:null},parsePositiveInt:function(e){var t=Number(e);return t%1==0&&t>0?t:null},parseFloat:function(e){var t=Number(e);return isNaN(t)?null:t}},K=function(){function e(t){l(this,e),this._schemeIdUri=$.parseAttr(t,G.AttributeTypes.SCHEME_ID_URI),this._value=$.parseAttr(t,G.AttributeTypes.VALUE)}return p(e,[{key:"schemeIdUri",get:function(){return this._schemeIdUri}},{key:"value",get:function(){return this._value}}]),e}(),W=function(){function e(t){l(this,e),this._id=$.parseAttr(t,G.AttributeTypes.ID),this._bandwidth=$.parseAttr(t,G.AttributeTypes.BANDWIDTH,parseInt),this._width=$.parseAttr(t,G.AttributeTypes.WIDTH,parseInt),this._height=$.parseAttr(t,G.AttributeTypes.HEIGHT,parseInt);var r=$.findChild(t,G.TagTypes.ESSENTIAL_PROPERTY);r&&(this._essentialProperty=new K(r))}return p(e,[{key:"bandwidth",get:function(){return this._bandwidth}},{key:"id",get:function(){return this._id}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"essentialProperty",get:function(){return this._essentialProperty}}]),e}(),z=function(){function e(t){l(this,e),this._id=$.parseAttr(t,G.AttributeTypes.ID),this._mimeType=$.parseAttr(t,G.AttributeTypes.MIME_TYPE),this._contentType=$.parseAttr(t,G.AttributeTypes.CONTENT_TYPE),this._representations=Array.from($.findChildren(t,G.TagTypes.REPRESENTATION)).map((function(e){return new W(e)}));var r=$.findChild(t,G.TagTypes.SEGMENT_TEMPLATE);r&&(this._segmentTemplate=new V(r));var n=$.findChild(t,G.TagTypes.ESSENTIAL_PROPERTY);n&&(this._essentialProperty=new K(n))}return p(e,[{key:"id",get:function(){return this._id}},{key:"mimeType",get:function(){return this._mimeType}},{key:"contentType",get:function(){return this._contentType}},{key:"segmentTemplate",get:function(){return this._segmentTemplate}},{key:"essentialProperty",get:function(){return this._essentialProperty}},{key:"representations",get:function(){return this._representations}}]),e}();y(z,"ContentType",{VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image"});var q,Y=function(){function t(r){var n,a,i=this;l(this,t),y(this,"_logger",(0,e.getLogger)("DashManifestParser")),y(this,"_parseAdaptionSets",(function(){var e=$.findElements(i._xmlDoc,G.TagTypes.BASE_URL);e&&e.length>0&&e[0].innerHTML&&(i._baseURL=e[0].textContent);var t=$.findElements(i._xmlDoc,G.TagTypes.ADAPTATION_SET),r=Array.from(t).filter((function(e){return $.parseAttr(e,G.AttributeTypes.CONTENT_TYPE)===z.ContentType.IMAGE}));r.length>0?(i._adaptationSets=r.map((function(e){return new z(e)})),i._logger.debug("Found image adaptation set",i._adaptationSets)):i._logger.debug("No image adaptations were found in manifest")})),this._logger.debug("Initialize manifest parser"),this._adaptationSets=[],(n=r instanceof ArrayBuffer?(a=r,TextDecoder?(new TextDecoder).decode(new Uint8Array(a)):null):r)&&(this._xmlDoc=$.parseXml(n))}return p(t,[{key:"parseManifest",value:function(){try{this._logger.debug("Start parsing dash manifest"),this._parseAdaptionSets(),this._logger.debug("Manifest parsing finished successfully")}catch(e){this._logger.warn("Manifest parsing failed",e)}}},{key:"getBaseUrl",value:function(){return this._baseURL||""}},{key:"getImageSet",value:function(){return this._adaptationSets.find((function(e){return e.contentType===z.ContentType.IMAGE}))}},{key:"hasImageSet",value:function(){return!!this.getImageSet()}},{key:"adaptationSets",get:function(){return this._adaptationSets}}],[{key:"isValid",value:function(){return!(!window.TextEncoder||!window.TextDecoder)}}]),t}(),X=function(){function t(n,a,i){var o=this;l(this,t),y(this,"_tracks",[]),y(this,"_parseTracks",(function(t,n,a){var i=t.representations,s=t.segmentTemplate,l=t.essentialProperty;i.forEach((function(t,i){var u,c,d=t.id,p=t.bandwidth,h=t.width,f=t.height,m=s,g=m.startNumber,y=m.duration,v=m.media,_=m.timescale,k=m.presentationTimeOffset,E=o._getEssentialValue(l,t),b=(c=2,function(e){if(Array.isArray(e))return e}(u=o._getDimensions(E))||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(u,c)||r(u,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),T=b[0],A=b[1];o._tracks.push(new e.ImageTrack({id:d,index:i,active:!1,width:h,height:f,duration:y,rows:T,cols:A,url:o._buildTemplateUrl(v,d,n,a),customData:{bitrate:p,startNumber:g,timescale:_,presentationTimeOffset:k}}))}))})),y(this,"_getDimensions",(function(e){var t=1,r=1;if(e.includes("x")){var n=e.split("x");r=parseInt(n[0]),t=parseInt(n[1])}return[t,r]})),y(this,"_getEssentialValue",(function(e,t){return e?e.value:t.essentialProperty?t.essentialProperty.value:""})),y(this,"_buildTemplateUrl",(function(e,t,r,n){var a=r.split("/").pop(),i=r.replace(a,"");(n=n.replace(/^\.\/|^\./,"")).length>0&&!n.endsWith("/")&&(n+="/");var o="".concat(i).concat(n).concat(e);return H(o,{id:t})})),y(this,"_buildUrlFromTemplate",(function(e,t){return H(e.url,{index:t,time:(t-1)*e.duration*e.customData.timescale,bitrate:e.customData.bitrate})})),this._parseTracks(n,a,i),this._tracks.length>0&&(this._tracks.sort((function(e,t){return e.customData.bitrate-t.customData.bitrate})),this.selectTrack(this._tracks[this._tracks.length-1]))}return p(t,[{key:"selectTrack",value:function(e){this._tracks.forEach((function(t){return t.index===e.index?t.active=!0:t.active=!1}))}},{key:"getTracks",value:function(){return this._tracks}},{key:"getActiveTrack",value:function(){return this._tracks.find((function(e){return e.active}))}},{key:"getThumbnail",value:function(t){var r=this.getActiveTrack(),n=r.duration,a=r.rows,i=r.cols,o=r.sliceWidth,s=r.sliceHeight,l=r.customData,u=Math.floor(t/n)+l.startNumber,c=t%n,d=Math.floor(c*a*i/n);return new e.ThumbnailInfo({width:Math.floor(o),height:Math.floor(s),x:Math.floor(d%i)*o,y:Math.floor(d/i)*s,url:this._buildUrlFromTemplate(r,u)})}}]),t}(),Z=["startTime","endTime","id"];function Q(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return J(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ee="error",te="adaptation",re="buffering",ne="drmsessionupdate",ae="emsg",ie=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(v,t);var r,a,i,o,c,d=(o=v,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(o);if(c){var r=f(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}(this,e)});function v(t,r){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l(this,v),y(h(n=d.call(this,t,r,a)),"_shakaLib",T()),y(h(n),"_adapterEventsBindings",y(y(y(y(y(y(y({},ee,(function(e){return n._onError(e)})),te,(function(){return n._onAdaptation()})),re,(function(e){return n._onBuffering(e)})),ne,(function(){return n._onDrmSessionUpdate()})),ae,(function(e){return n._onEmsg(e)})),e.EventType.WAITING,(function(){return n._onWaiting()})),e.EventType.PLAYING,(function(){return n._onPlaying()}))),y(h(n),"_buffering",!1),y(h(n),"_waitingSent",!1),y(h(n),"_playingSent",!1),y(h(n),"_videoSizeUpdateTimer",null),y(h(n),"_stallInterval",null),y(h(n),"VIDEO_ERROR_CODE",3016),y(h(n),"_lastTimeDetach",NaN),y(h(n),"_requestFilterError",!1),y(h(n),"_responseFilterError",!1),y(h(n),"_isDestroyInProgress",!1),y(h(n),"_errorCounter",{}),y(h(n),"_isStartOver",!0),y(h(n),"_seekRangeStart",0),y(h(n),"_isLive",!1),y(h(n),"_isStaticLive",!1),y(h(n),"_selectedVideoTrack",null),v._logger.debug("Creating adapter. Shaka version: "+T().Player.version),n._config=e.Utils.Object.mergeDeep({},C,n._config),n._init(),n}return p(v,[{key:"applyTextTrackStyles",value:function(e,t,r){e.insertRule("#".concat(r," .").concat(v.textContainerClass," { align-items: ").concat({left:"flex-start",center:"center",right:"flex-end"}[t.textAlign],"!important; }"),0),e.insertRule("#".concat(r," .").concat(v.textContainerClass," > * { ").concat(t.toCSS()," }"),0)}},{key:"setMaxBitrate",value:function(e){this._hasLowerOrEqualBitrate(e)&&this._shaka.configure({abr:{restrictions:{maxBandwidth:e}}})}},{key:"_getSortedTracks",value:function(){return this._shaka.getVariantTracks().map((function(e){return{id:e.id,bandwidth:e.bandwidth,active:e.active}})).sort((function(e,t){return e.bandwidth-t.bandwidth}))}},{key:"_hasLowerOrEqualBitrate",value:function(e){return this._getSortedTracks()[0].bandwidth<=e}},{key:"_init",value:function(){T().polyfill.installAll(),this._shaka=new(T().Player),this._config.useShakaTextTrackDisplay&&this._shaka.setVideoContainer(e.Utils.Dom.getElementBySelector(".playkit-subtitles")),this._maybeSetFilters(),this._maybeSetDrmConfig(),this._maybeBreakStalls(),this._shaka.configure(this._config.shakaConfig),this._addBindings()}},{key:"_clearStallInterval",value:function(){this._stallInterval&&(clearInterval(this._stallInterval),this._stallInterval=null)}},{key:"_stallHandler",value:function(){var e=this;this._clearStallInterval();var t=function(){return Date.now()/1e3},r=t(),n=this._videoElement.currentTime;this._stallInterval=window.setInterval((function(){t()-r>e._config.stallDetectionThreshold&&!e._videoElement.paused&&(n===e._videoElement.currentTime&&(v._logger.debug("stall found, break the stall"),e._videoElement.currentTime=parseFloat(e._videoElement.currentTime.toFixed(1))+.1),e._clearStallInterval()),n=e._videoElement.currentTime}),500)}},{key:"_maybeBreakStalls",value:function(){var t=this;this._config.forceBreakStall&&this._eventManager.listen(this._videoElement,e.EventType.SEEKING,(function(){return t._stallHandler()}))}},{key:"_maybeGetRedirectedUrl",value:function(t){var r=this._config.forceRedirectExternalStreams,n=this._config.redirectExternalStreamsTimeout,a=this._config.redirectExternalStreamsHandler;return new Promise((function(i){if(!r)return i(t);e.Utils.Http.jsonp(t,a,{timeout:n}).then((function(e){i(e)})).catch((function(){return i(t)}))}))}},{key:"_maybeSetFilters",value:function(){var t,r,n=this;"function"==typeof e.Utils.Object.getPropertyPath(this._config,"network.requestFilter")&&(v._logger.debug("Register request filter"),null===(t=this._shaka.getNetworkingEngine())||void 0===t||t.registerRequestFilter((function(t,r){if(Object.values(e.RequestType).includes(t)){var a,i={url:r.uris[0],body:r.body,headers:r.headers};try{a=n._config.network.requestFilter(t,i)}catch(e){a=Promise.reject(e)}return(a=a||Promise.resolve(i)).then((function(e){r.uris=[e.url],r.headers=e.headers,"boolean"==typeof e.withCredentials&&(r.allowCrossSiteCredentials=e.withCredentials),"POST"===r.method?r.body=e.body:e.body&&v._logger.warn("Request with ".concat(r.method," method cannot have body"))})).catch((function(e){throw n._requestFilterError=!0,e}))}}))),"function"==typeof e.Utils.Object.getPropertyPath(this._config,"network.responseFilter")&&(v._logger.debug("Register response filter"),null===(r=this._shaka.getNetworkingEngine())||void 0===r||r.registerResponseFilter((function(t,r){if(Object.values(e.RequestType).includes(t)){var a,i=r.uri,o=r.data,s=r.headers,l={url:i,originalUrl:n._sourceObj.url,data:o,headers:s};try{a=n._config.network.responseFilter(t,l)}catch(e){a=Promise.reject(e)}return(a=a||Promise.resolve(l)).then((function(e){r.data=e.data})).catch((function(e){throw n._responseFilterError=!0,e}))}})))}},{key:"_maybeSetDrmConfig",value:function(){if(this._sourceObj&&this._sourceObj.drmData){var t,r={},n=Q(v._availableDrmProtocol);try{for(n.s();!(t=n.n()).done;)t.value.setDrmPlayback(r,this._sourceObj.drmData),this._config.shakaConfig.drm&&e.Utils.Object.mergeDeep(r.drm,this._config.shakaConfig.drm),e.Utils.Object.mergeDeep(this._config.shakaConfig,r)}catch(e){n.e(e)}finally{n.f()}}}},{key:"_maybeCapLevelToPlayerSize",value:function(){var e=this;if(this._config.capLevelToPlayerSize){var t=function(){return{minHeight:0,maxHeight:e._videoHeight,minWidth:0,maxWidth:e._videoWidth,minBitrate:0,maxBitrate:1/0}};this._clearVideoUpdateTimer(),this._videoSizeUpdateTimer=window.setInterval((function(){return e._updateRestriction(t())}),1e3),this._updateRestriction(t())}}},{key:"_maybeApplyAbrRestrictions",value:function(){this._config.capLevelToPlayerSize||(this._clearVideoUpdateTimer(),e.Utils.Object.hasPropertyPath(this._config,"abr.restrictions")&&this._updateRestriction(this._config.abr.restrictions))}},{key:"_updateRestriction",value:function(e){var t=this._getRestrictionShakaConfig(e);this._shaka.configure({abr:{restrictions:t}})}},{key:"_getRestrictionShakaConfig",value:function(e){var t=this,r=function(e){var r=t._getVideoTracks();return Math.min.apply(null,r.map((function(t){return t[e]})))},n={};if(e){var a=e.maxHeight,i=e.maxWidth,o=e.maxBitrate,s=e.minHeight,l=e.minWidth,u=e.minBitrate,c=Math.max(s,0),d=Math.max(a,r("height"));d>=c?(n.minHeight=c,n.maxHeight=d):v._logger.warn("Invalid maxHeight restriction, maxHeight must be greater than minHeight",s,a);var p=Math.max(l,0),h=Math.max(i,r("width"));h>=p?(n.minWidth=p,n.maxWidth=h):v._logger.warn("Invalid maxWidth restriction, maxWidth must be greater than minWidth",l,i);var f=Math.max(u,0),m=Math.max(o,r("bandwidth"));m>=f?(n.minBandwidth=f,n.maxBandwidth=m):v._logger.warn("Invalid maxBitrate restriction, maxBitrate must be greater than minBitrate",u,o)}return n}},{key:"attachMediaSource",value:function(){this._shaka||(this._videoElement&&this._videoElement.src&&(e.Utils.Dom.setAttribute(this._videoElement,"src",""),e.Utils.Dom.removeAttribute(this._videoElement,"src")),this._init())}},{key:"detachMediaSource",value:function(){var e=this;return this._shaka?(0===Math.floor(this.duration-this.currentTime)?this._lastTimeDetach=0:this.currentTime>0&&(this._lastTimeDetach=this.currentTime),this._reset().then((function(){e._shaka=null,e._loadPromise=void 0}))):Promise.resolve()}},{key:"_clearVideoUpdateTimer",value:function(){this._videoSizeUpdateTimer&&(clearInterval(this._videoSizeUpdateTimer),this._videoSizeUpdateTimer=null)}},{key:"_videoWidth",get:function(){var e,t=this._videoElement;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=this._contentScaleFactor),e}},{key:"_videoHeight",get:function(){var e,t=this._videoElement;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=this._contentScaleFactor),e}},{key:"_contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){v._logger.debug("failed reading devicePixelRatio, assume 1")}return e}},{key:"_addBindings",value:function(){var t,r=this;this._eventManager.listen(this._shaka,te,this._adapterEventsBindings.adaptation),this._eventManager.listen(this._shaka,ee,this._adapterEventsBindings.error),this._eventManager.listen(this._shaka,ne,this._adapterEventsBindings.drmsessionupdate),this._eventManager.listen(this._videoElement,e.EventType.WAITING,this._adapterEventsBindings.waiting),this._eventManager.listen(this._videoElement,e.EventType.PLAYING,this._adapterEventsBindings.playing),this._eventManager.listen(this._videoElement,e.EventType.LOADED_DATA,(function(){return r._onLoadedData()})),this._eventManager.listenOnce(this._videoElement,e.EventType.PLAYING,(function(){r._eventManager.listen(r._shaka,re,r._adapterEventsBindings.buffering)})),this._config.trackEmsgEvents&&this._eventManager.listen(this._shaka,ae,this._adapterEventsBindings.emsg),null===(t=this._shaka.getNetworkingEngine())||void 0===t||t.registerResponseFilter((function(t,n){switch(t){case T().net.NetworkingEngine.RequestType.SEGMENT:r._trigger(e.EventType.FRAG_LOADED,{miliSeconds:n.timeMs,bytes:n.data.byteLength,url:n.uri}),r.isLive()&&r._dispatchNativeEvent(e.EventType.DURATION_CHANGE);break;case T().net.NetworkingEngine.RequestType.MANIFEST:r._parseManifest(n.data),r._playbackActualUri=n.uri,r._trigger(e.EventType.MANIFEST_LOADED,{miliSeconds:n.timeMs}),setTimeout((function(){var e,t;r._isLive=r._isLive||(null===(e=r._shaka)||void 0===e?void 0:e.isLive()),!r._isLive||null!==(t=r._shaka)&&void 0!==t&&t.isLive()||r._isStaticLive||!r._config.switchDynamicToStatic||(r._sourceObj.url=n.uri,r._switchFromDynamicToStatic())}))}}))}},{key:"_onLoadedData",value:function(){var e=this;this._setLowLatencyMode();var t=this.getSegmentDuration();this._seekRangeStart=this._shaka.seekRange().start,this._startOverTimeout=window.setTimeout((function(){e._shaka.seekRange().start-e._seekRangeStart>=t&&(e._isStartOver=!1)}),1e3*(t+1))}},{key:"_switchFromDynamicToStatic",value:(i=s(E().mark((function t(){var r,n,a;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v._logger.info("Switching from dynamic manifest to static"),this._dispatchNativeEvent(e.EventType.WAITING),r=this._videoElement.currentTime-this._seekRangeStart,n=this.isAdaptiveBitrateEnabled(),a=this._videoElement.paused,t.next=7,this.detachMediaSource();case 7:return this._isStaticLive=!0,this._isLive=!0,this.attachMediaSource(),t.next=12,this.load();case 12:this._videoElement.currentTime=r,a||this._videoElement.play(),n?this._onAdaptation():this._selectedVideoTrack&&this.selectVideoTrack(this._selectedVideoTrack);case 15:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"_setLowLatencyMode",value:function(){this._shaka.configure({streaming:{lowLatencyMode:"boolean"==typeof this._config.lowLatencyMode?this._config.lowLatencyMode:this.isLive()}})}},{key:"_parseManifest",value:function(e){!this._manifestParser&&Y.isValid()&&(v._logger.debug("Creating parser for the first time"),this._manifestParser=new Y(e),this._manifestParser.parseManifest())}},{key:"load",value:(a=s(E().mark((function t(r){var n=this;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._loadPromise){t.next=5;break}return t.next=3,this._removeMediaKeys();case 3:this._shaka.attach(this._videoElement),this._loadPromise=new Promise((function(t,a){if(n._sourceObj&&n._sourceObj.url){n._trigger(e.EventType.ABR_MODE_CHANGED,{mode:n.isAdaptiveBitrateEnabled()?"auto":"manual"});var i="number"==typeof r&&r>-1?r:void 0;i=isNaN(n._lastTimeDetach)?i:n._lastTimeDetach,n._lastTimeDetach=NaN,n._maybeGetRedirectedUrl(n._sourceObj.url).then((function(e){return n._shaka.load(e,i)})).then((function(){var e={tracks:n._getParsedTracks()};n._maybeCapLevelToPlayerSize(),v._logger.debug("The source has been loaded successfully"),t(e)})).catch((function(t){a(new e.Error(n._isDestroyInProgress?e.Error.Severity.RECOVERABLE:t.severity,t.category,t.code,t.data))}))}}));case 5:return t.abrupt("return",this._loadPromise);case 6:case"end":return t.stop()}}),t,this)}))),function(e){return a.apply(this,arguments)})},{key:"destroy",value:function(){var e=this;return this._isDestroyInProgress=!0,new Promise((function(t,r){m(f(v.prototype),"destroy",e).call(e).then((function(){v._logger.debug("destroy"),e._loadPromise=void 0,e._adapterEventsBindings={},e._reset().then((function(r){e._isDestroyInProgress=!1,t(r)})).catch((function(t){e._isDestroyInProgress=!1,r(t)}))}))}))}},{key:"getThumbnail",value:function(e){return this._thumbnailController?this._thumbnailController.getThumbnail(e):null}},{key:"_reset",value:function(){return this._buffering=!1,this._waitingSent=!1,this._playingSent=!1,this._isLive=!1,this._isStaticLive=!1,this._requestFilterError=!1,this._responseFilterError=!1,this._manifestParser=null,this._thumbnailController=null,this._errorCounter={},this._clearStallInterval(),this._clearVideoUpdateTimer(),clearTimeout(this._startOverTimeout),this._eventManager&&this._eventManager.removeAll(),this._shaka?this._shaka.destroy():Promise.resolve()}},{key:"_removeMediaKeys",value:(r=s(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._videoElement||!this._videoElement.mediaKeys){e.next=16;break}return e.prev=1,v._logger.debug("Removing mediaKeys from the video element"),e.next=5,this._videoElement.setMediaKeys(null);case 5:v._logger.debug("mediaKeys removed"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),v._logger.warn("mediaKeys not cleared");case 11:return e.prev=11,e.abrupt("return",Promise.resolve());case 14:e.next=17;break;case 16:return e.abrupt("return",Promise.resolve());case 17:case"end":return e.stop()}}),e,this,[[1,8,11,14]])}))),function(){return r.apply(this,arguments)})},{key:"_getVideoTracks",value:function(){var e=this._shaka.getVariantTracks(),t=this._getActiveTrack();return e.filter((function(e){return e.audioId===t.audioId}))}},{key:"_getActiveTrack",value:function(){return this._shaka.getVariantTracks().find((function(e){return e.active}))}},{key:"_getAudioTracks",value:function(){var e=this._shaka.getVariantTracks(),t=this._shaka.getAudioLanguagesAndRoles();return t.forEach((function(t){var r=e.filter((function(e){return e.language===t.language})),n=r.map((function(e){return e.id})).join("_"),a=r.some((function(e){return e.active}));t.id=n,t.label=r[0].label,t.active=a})),t}},{key:"_getParsedTracks",value:function(){if(this._shaka){var e=this._getParsedVideoTracks(),t=this._getParsedAudioTracks(),r=this._getParsedTextTracks(),a=this._getParsedImageTracks();return[].concat(n(e),n(t),n(r),n(a))}return[]}},{key:"_getParsedVideoTracks",value:function(){var t=this._getVideoTracks(),r=[];if(t)for(var n=0;n<t.length;n++){var a={id:t[n].id,bandwidth:t[n].videoBandwidth||t[n].bandwidth,width:t[n].width,height:t[n].height,active:t[n].active,index:n};r.push(new e.VideoTrack(a))}return r}},{key:"_getParsedAudioTracks",value:function(){var t=this._getAudioTracks(),r=[];if(t)for(var n=0;n<t.length;n++){var a={id:t[n].id,active:t[n].active,label:t[n].label,language:t[n].language,index:n};r.push(new e.AudioTrack(a))}return r}},{key:"_getParsedTextTracks",value:function(){var t,r=[],n=Q(this._shaka.getTextTracks());try{for(n.s();!(t=n.n()).done;){var a=t.value,i=a.kind?a.kind+"s":"";i=""===i&&this._config.useShakaTextTrackDisplay?"captions":i;var o={id:a.id,kind:i,active:!1,default:a.primary,label:a.label,language:a.language};r.push(new e.TextTrack(o))}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"_getParsedImageTracks",value:function(){var e,t,r=null===(e=this._manifestParser)||void 0===e?void 0:e.getImageSet(),n=(null===(t=this._manifestParser)||void 0===t?void 0:t.getBaseUrl())||"";return r?(this._thumbnailController=new X(r,this._playbackActualUri,n),this._thumbnailController.getTracks()):[]}},{key:"selectVideoTrack",value:function(t){if(this._shaka){var r=this._getVideoTracks();if(t instanceof e.VideoTrack&&r){var n=r[t.index];n&&(this.isAdaptiveBitrateEnabled()&&(this._shaka.configure({abr:{enabled:!1}}),this._trigger(e.EventType.ABR_MODE_CHANGED,{mode:"manual"})),n.active||(this._selectedVideoTrack=t,this._shaka.selectVariantTrack(r[t.index],!0),this._onTrackChanged(t)))}}}},{key:"selectAudioTrack",value:function(t){this._shaka&&t instanceof e.AudioTrack&&!t.active&&(this._shaka.selectAudioLanguage(t.language),this._onTrackChanged(t))}},{key:"selectTextTrack",value:function(t){this._shaka&&t instanceof e.TextTrack&&!t.active&&("subtitles"===t.kind||"captions"===t.kind)&&(this._shaka.setTextTrackVisibility(this._config.textTrackVisibile),this._shaka.selectTextLanguage(t.language),this._onTrackChanged(t))}},{key:"selectImageTrack",value:function(t){this._shaka&&this._thumbnailController&&t instanceof e.ImageTrack&&!t.active&&(this._thumbnailController.selectTrack(t),this._onTrackChanged(t))}},{key:"hideTextTrack",value:function(){this._shaka&&this._shaka.setTextTrackVisibility(!1)}},{key:"enableAdaptiveBitrate",value:function(){this._shaka&&!this.isAdaptiveBitrateEnabled()&&(this._trigger(e.EventType.ABR_MODE_CHANGED,{mode:"auto"}),this._shaka.configure({abr:{enabled:!0}}))}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._shaka&&this._shaka.getConfiguration().abr.enabled}},{key:"applyABRRestriction",value:function(t){if(e.Utils.Object.createPropertyPath(this._config,"abr.restrictions",t),this._maybeApplyAbrRestrictions(),!this.isAdaptiveBitrateEnabled()){var r=this._getParsedVideoTracks(),n=(0,e.filterTracksByRestriction)(r,this._config.abr.restrictions);n.length&&(n.find((function(e){return e.active}))||this.selectVideoTrack(n[0]))}}},{key:"_getLiveEdge",value:function(){return this._shaka?this._shaka.seekRange().end:NaN}},{key:"seekToLiveEdge",value:function(){this._shaka&&this._videoElement.readyState>0&&(this._videoElement.currentTime=this._getLiveEdge())}},{key:"isLive",value:function(){var e;return(null===(e=this._shaka)||void 0===e?void 0:e.isLive())||this._isLive}},{key:"liveDuration",get:function(){return this._getLiveEdge()}},{key:"getSegmentDuration",value:function(){return this._shaka?this._shaka.getStats().maxSegmentDuration:0}},{key:"_onAdaptation",value:function(){var e=this._getParsedVideoTracks().find((function(e){return e.active}));this._onTrackChanged(e)}},{key:"_onError",value:function(t){if(t&&t.detail){var r=t.detail;if(r.code===this.VIDEO_ERROR_CODE)return;(this._requestFilterError||this._responseFilterError)&&r.data[0]instanceof T().util.Error&&(r=r.data[0],this._requestFilterError?this._requestFilterError=!1:this._responseFilterError=!1),r.severity=this._shouldErrorChangeSeverity(r.code)?e.Error.Severity.CRITICAL:r.severity,this._trigger(e.EventType.ERROR,new e.Error(r.severity,r.category,r.code,r.data)),v._logger.error(r),r.severity===e.Error.Severity.CRITICAL&&this.destroy()}}},{key:"_shouldErrorChangeSeverity",value:function(e){var t=function(){return Date.now()/1e3};return e in this._errorCounter?(this._errorCounter[e].count+=1,this._errorCounter[e].count>3?(delete this._errorCounter[e],!0):t()-this._errorCounter[e].timeStamp>30&&(this._errorCounter[e].timeStamp=t(),this._errorCounter[e].count=1,!1)):(this._errorCounter[e]={count:1,timeStamp:t()},!1)}},{key:"_onBuffering",value:function(t){t.buffering?this._waitingSent||(this._dispatchNativeEvent(e.EventType.WAITING),this._buffering=!0):(this._buffering=!1,this._videoElement.paused||this._playingSent||this._dispatchNativeEvent(e.EventType.PLAYING))}},{key:"_dispatchNativeEvent",value:function(e){var t;"function"==typeof window.Event?t=new Event(e):(t=document.createEvent("Event")).initEvent(e,!0,!0),this._videoElement.dispatchEvent(t)}},{key:"_onDrmSessionUpdate",value:function(){var t;this._trigger(e.EventType.DRM_LICENSE_LOADED,{licenseTime:this._shaka.getStats().licenseTime,scheme:null===(t=this._shaka.drmInfo())||void 0===t?void 0:t.keySystem})}},{key:"_onEmsg",value:function(t){var r=t.detail,n=t.type,a=Array.from(this._videoElement.textTracks).find((function(e){return e.label===n}));a||(a=this._videoElement.addTextTrack(e.TextTrack.KIND.METADATA,n));var i=r.startTime,o=r.endTime,s=r.id,l=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(r,Z),u=new e.TimedMetadata(i,o,s,e.TimedMetadata.TYPE.EMSG,l),c=(0,e.createTextTrackCue)(u);a.addCue(c),this._trigger(e.EventType.TIMED_METADATA_ADDED,{cues:[u]})}},{key:"_onWaiting",value:function(){this._waitingSent=!0,this._playingSent=!1}},{key:"_onPlaying",value:function(){this._playingSent=!0,this._waitingSent=!1,this._buffering&&this._dispatchNativeEvent(e.EventType.WAITING)}},{key:"getStartTimeOfDvrWindow",value:function(){return this.isLive()&&this._shaka?(this._isStartOver?this._seekRangeStart:this._shaka.seekRange().start)+this._shaka.getConfiguration().streaming.safeSeekOffset:0}},{key:"targetBuffer",get:function(){var e=NaN;return this._shaka?(e=this.isLive()?this._getLiveEdge()-this._videoElement.currentTime:this._videoElement.duration-this._videoElement.currentTime,e=Math.min(e,this._shaka.getConfiguration().streaming.bufferingGoal+this._shaka.getStats().maxSegmentDuration)):NaN}},{key:"getDrmInfo",value:function(){var e=this._shaka.drmInfo();if(e){var t=e.licenseServerUri,r=e.keySystem,n=e.serverCertificateUri,a={licenseUrl:t,scheme:r};return n&&(a.certificate=n),a}return null}}],[{key:"createAdapter",value:function(t,r,n){var a=e.Utils.Object.copyDeep(C);if(e.Utils.Object.hasPropertyPath(n,"text.useNativeTextTrack")&&(a.textTrackVisibile=e.Utils.Object.getPropertyPath(n,"text.useNativeTextTrack")),e.Utils.Object.hasPropertyPath(n,"text.useShakaTextTrackDisplay")&&(a.useShakaTextTrackDisplay=e.Utils.Object.getPropertyPath(n,"text.useShakaTextTrackDisplay"),a.textTrackVisibile=a.textTrackVisibile||a.useShakaTextTrackDisplay),e.Utils.Object.hasPropertyPath(n,"streaming")){var i=n.streaming;"boolean"==typeof i.forceBreakStall&&(a.forceBreakStall=i.forceBreakStall),"number"==typeof i.stallDetectionThreshold&&(a.stallDetectionThreshold=Math.max(2,i.stallDetectionThreshold)),"boolean"==typeof i.lowLatencyMode&&(a.lowLatencyMode=i.lowLatencyMode),"boolean"==typeof i.trackEmsgEvents&&(a.trackEmsgEvents=i.trackEmsgEvents),"boolean"==typeof i.switchDynamicToStatic&&(a.switchDynamicToStatic=i.switchDynamicToStatic)}if(e.Utils.Object.hasPropertyPath(n,"sources.options")){var o=n.sources.options;a.forceRedirectExternalStreams=o.forceRedirectExternalStreams,a.redirectExternalStreamsHandler=o.redirectExternalStreamsHandler,a.redirectExternalStreamsTimeout=o.redirectExternalStreamsTimeout}if(e.Utils.Object.hasPropertyPath(n,"abr")){var s=n.abr;"boolean"==typeof s.enabled&&(a.shakaConfig.abr.enabled=s.enabled),"boolean"==typeof s.capLevelToPlayerSize&&(a.capLevelToPlayerSize=s.capLevelToPlayerSize),s.defaultBandwidthEstimate&&(a.shakaConfig.abr.defaultBandwidthEstimate=s.defaultBandwidthEstimate),s.restrictions&&e.Utils.Object.createPropertyPath(a,"abr.restrictions",s.restrictions)}return e.Utils.Object.hasPropertyPath(n,"playback.options.html5.dash")&&(e.Utils.Object.mergeDeep(a.shakaConfig,n.playback.options.html5.dash),e.Utils.Object.hasPropertyPath(a.shakaConfig,"manifest.dash.defaultPresentationDelay")&&(a.shakaConfig.manifest.defaultPresentationDelay=a.shakaConfig.manifest.dash.defaultPresentationDelay,delete a.shakaConfig.manifest.dash.defaultPresentationDelay)),a.network=n.network,new this(t,r,a)}},{key:"canPlayType",value:function(e){var t="string"==typeof e&&e.toLowerCase()===v._dashMimeType&&v.isMSESupported();return v._logger.debug("canPlayType result for mimeType: "+e+" is "+t.toString()),t}},{key:"canPlayDrm",value:function(e,t){v._availableDrmProtocol=[];var r,n=Q(v._drmProtocols);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.isConfigured(e,t)){v._availableDrmProtocol.push(a);break}}}catch(e){n.e(e)}finally{n.f()}if(!v._availableDrmProtocol.length){var i,o=Q(v._drmProtocols);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.canPlayDrm(e)&&v._availableDrmProtocol.push(s)}}catch(e){o.e(e)}finally{o.f()}}return!!v._availableDrmProtocol.length}},{key:"isSupported",value:function(){var e=T().Player.isBrowserSupported();return v._logger.debug("isSupported:"+e),e}}]),v}(e.BaseMediaSourceAdapter);q=ie,y(ie,"id","DashAdapter"),y(ie,"_logger",e.BaseMediaSourceAdapter.getLogger(q.id)),y(ie,"textContainerClass","shaka-text-container"),y(ie,"_dashMimeType","application/dash+xml"),y(ie,"_drmProtocols",[A,S]),y(ie,"_availableDrmProtocol",[]);var oe="1.37.0",se="@playkit-js/playkit-js-dash",le=ie;ie.isSupported()&&(0,e.registerMediaSourceAdapter)(ie)}(),i}())},305:(module,e,t)=>{var r,n;self,module.exports=(r=t(538),n=t(718),function(){"use strict";var e={952:function(e){e.exports=r},85:function(e){e.exports=n}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,a),i.exports}a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){a.r(i),a.d(i,{NAME:function(){return w},VERSION:function(){return x},default:function(){return I}});var e=a(952);function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===s(t)?t:String(t)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function c(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(arguments.length<3?e:r):a.value}},h.apply(this,arguments)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function g(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}function y(e,t,r){return(t=l(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v,_,k=a(85),E=a.n(k),b=JSON.parse('{"recoverDecodingErrorDelay":3000,"recoverSwapAudioCodecDelay":3000,"abr":{"enabled":true,"restrictions":{}},"hlsConfig":{"fragLoadingMaxRetry":4,"maxMaxBufferLength":60},"network":{}}'),T=(y(y(y(y(y(y(y(y(y(y(v={},E().ErrorDetails.MANIFEST_LOAD_ERROR,{category:e.Error.Category.MANIFEST,code:e.Error.Code.HTTP_ERROR}),E().ErrorDetails.MANIFEST_LOAD_TIMEOUT,{category:e.Error.Category.MANIFEST,code:e.Error.Code.TIMEOUT}),E().ErrorDetails.MANIFEST_PARSING_ERROR,{category:e.Error.Category.MANIFEST,code:e.Error.Code.HLSJS_CANNOT_PARSE}),E().ErrorDetails.LEVEL_LOAD_ERROR,{category:e.Error.Category.NETWORK,code:e.Error.Code.HTTP_ERROR}),E().ErrorDetails.LEVEL_LOAD_TIMEOUT,{category:e.Error.Category.NETWORK,code:e.Error.Code.TIMEOUT}),E().ErrorDetails.LEVEL_SWITCH_ERROR,{category:e.Error.Category.PLAYER,code:e.Error.Code.BITRATE_SWITCH_ISSUE}),E().ErrorDetails.FRAG_LOAD_ERROR,{category:e.Error.Category.NETWORK,code:e.Error.Code.HTTP_ERROR}),E().ErrorDetails.FRAG_LOAD_TIMEOUT,{category:e.Error.Category.NETWORK,code:e.Error.Code.TIMEOUT}),E().ErrorDetails.FRAG_PARSING_ERROR,{category:e.Error.Category.MEDIA,code:e.Error.Code.HLS_FRAG_PARSING_ERROR}),E().ErrorDetails.BUFFER_APPEND_ERROR,{category:e.Error.Category.MEDIA,code:e.Error.Code.HLS_BUFFER_APPEND_ISSUE}),y(y(v,E().ErrorDetails.BUFFER_APPENDING_ERROR,{category:e.Error.Category.MEDIA,code:e.Error.Code.HLS_BUFFER_APPENDING_ISSUE}),E().ErrorDetails.BUFFER_STALLED_ERROR,{category:e.Error.Category.MEDIA,code:e.Error.Code.HLS_BUFFER_STALLED_ERROR})),A=function(e){m(a,e);var t,r,n=(t=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return g(this,e)});function a(e){var t;return o(this,a),t=n.call(this,e),e&&e.readystatechange&&(t.readystatechange=e.readystatechange),t}return c(a,[{key:"loadInternal",value:function(){var e,t=this,r=this.context;e=this.loader=new XMLHttpRequest;var n=this.stats;n.tfirst=0,n.loaded=0;var a,i=this.xhrSetup;try{if(i)try{a=i(e,r.url,r)}catch(t){e.open("GET",r.url,!0),a=i(e,r.url,r)}e.readyState||e.open("GET",r.url,!0)}catch(e){a=Promise.reject(e)}(a=a||Promise.resolve()).then((function(){r.rangeEnd&&e.setRequestHeader("Range","bytes="+r.rangeStart+"-"+(r.rangeEnd-1)),e.onreadystatechange=t.readystatechange.bind(t),e.onprogress=t.loadprogress.bind(t),e.responseType=r.responseType,t.requestTimeout=window.setTimeout(t.loadtimeout.bind(t),t.config.timeout),e.send()})).catch((function(n){t.callbacks.onError({code:e.status,text:n.message},r,e)}))}}]),a}(E().DefaultConfig.loader),S=function(t){m(i,t);var r,n,a=(r=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(n){var a=p(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return g(this,e)});function i(t){var r;o(this,i);var n=(r=a.call(this,t)).load.bind(d(r)),s=i.redirectExternalStreamsHandler;return r.load=function(t,r,a){var o=t.url;"manifest"===t.type?e.Utils.Http.jsonp(o,s,{timeout:i.redirectExternalStreamsTimeout}).then((function(e){t.url=e,n(t,r,a)})).catch((function(){return n(t,r,a)})):n(t,r,a)},r}return c(i)}(A);function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}y(S,"redirectExternalStreamsHandler",(function(e,t){return t}));var P=function(a){m(u,a);var i,s,l=(i=u,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(i);if(s){var r=p(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return g(this,e)});function u(t,r,n){var a;return o(this,u),y(d(a=l.call(this,t,r,n)),"_hlsjsLib",E()),y(d(a),"_triedReloadWithRedirect",!1),y(d(a),"_playerTracks",[]),y(d(a),"_startTime",0),y(d(a),"_requestFilterError",!1),y(d(a),"_responseFilterError",!1),y(d(a),"_nativeTextTracksMap",{}),y(d(a),"_lastLoadedFragSN",-1),y(d(a),"_sameFragSNLoadedCount",0),y(d(a),"_waitForSubtitleLoad",!0),y(d(a),"_adapterEventsBindings",y(y(y(y(y(y(y(y(y({},E().Events.ERROR,(function(e,t){return a._onError(t)})),E().Events.MANIFEST_LOADED,(function(e,t){return a._onManifestLoaded(t)})),E().Events.LEVEL_SWITCHED,(function(e,t){return a._onLevelSwitched(e,t)})),E().Events.AUDIO_TRACK_SWITCHED,(function(e,t){return a._onAudioTrackSwitched(e,t)})),E().Events.FPS_DROP,(function(e,t){return a._onFpsDrop(t)})),E().Events.FRAG_PARSING_METADATA,(function(e,t){return a._onFragParsingMetadata(t)})),E().Events.FRAG_LOADED,(function(e,t){return a._onFragLoaded(t)})),E().Events.MEDIA_ATTACHED,(function(){return a._onMediaAttached()})),E().Events.LEVEL_LOADED,(function(e,t){return a._onLevelLoaded(e,t)}))),y(d(a),"_onLevelLoaded",(function(t,r){if(a.isLive()){var n=r.details.endSN;if(a._lastLoadedFragSN===n){if(a._sameFragSNLoadedCount++,u._logger.debug("Same frag SN. Count is: ".concat(a._sameFragSNLoadedCount,", Max is: ").concat(a._config.network.maxStaleLevelReloads)),a._sameFragSNLoadedCount>=a._config.network.maxStaleLevelReloads){u._logger.error("Same frag loading reached max count");var i=new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.NETWORK,e.Error.Code.LIVE_MANIFEST_REFRESH_ERROR,{fragSN:n});return a._trigger(e.EventType.ERROR,i),a.destroy()}u._logger.debug("Last frag SN is: ".concat(n))}else a._sameFragSNLoadedCount=0;a._lastLoadedFragSN=n}})),u._logger.debug("Creating adapter. Hls version: "+E().version),a._config=e.Utils.Object.mergeDeep({},b,a._config),a._init(),a}return c(u,[{key:"_init",value:function(){this._config.forceRedirectExternalStreams&&(this._config.hlsConfig.pLoader=S),this._maybeSetFilters(),this._hls=new(E())(this._config.hlsConfig),this._capabilities.fpsControl=!0,this._hls.subtitleDisplay=this._config.subtitleDisplay,this._addBindings()}},{key:"_maybeSetFilters",value:function(){var n=this;if("function"==typeof e.Utils.Object.getPropertyPath(this._config,"network.requestFilter")&&(u._logger.debug("Register request filter"),e.Utils.Object.mergeDeep(this._config.hlsConfig,{loader:A,xhrSetup:function(a,i,o){var s,l={url:i,body:null,headers:{}};try{"manifest"===o.type&&(s=n._config.network.requestFilter(e.RequestType.MANIFEST,l)),o.frag&&"subtitle"!==o.frag.type&&(s=n._config.network.requestFilter(e.RequestType.SEGMENT,l))}catch(e){s=Promise.reject(e)}return(s=s||Promise.resolve(l)).then((function(e){o.url=e.url,a.open("GET",e.url,!0),Object.entries(e.headers).forEach((function(e){var n;a.setRequestHeader.apply(a,function(e){if(Array.isArray(e))return t(e)}(n=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||r(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())})),"boolean"==typeof e.withCredentials&&(a.withCredentials=e.withCredentials)})).catch((function(e){throw n._requestFilterError=!0,e}))}})),"function"==typeof e.Utils.Object.getPropertyPath(this._config,"network.responseFilter")){var a=this;u._logger.debug("Register response filter"),e.Utils.Object.mergeDeep(this._config.hlsConfig,{loader:A,readystatechange:function(t){var r=this,n=t.currentTarget,i=n.readyState,o=this.stats,s=this.context,l=this.config;if(!o.aborted&&i>=2){window.clearTimeout(this.requestTimeout);var c=o.loading;if(0===c.first&&(c.first=Math.max(performance.now(),c.start)),4===i){var d=n.status;if(d>=200&&d<300){var p,h;c.end=Math.max(o.tfirst,performance.now()),h="arraybuffer"===s.responseType?(p=n.response).byteLength:(p=n.responseText).length,o.loaded=o.total=h;var f,m={url:n.responseURL,originalUrl:s.url,data:p,headers:e.Utils.Http.convertHeadersToDictionary(n.getAllResponseHeaders())};try{"manifest"===s.type&&(f=a._config.network.responseFilter(e.RequestType.MANIFEST,m)),s.frag&&"subtitle"!==s.frag.type&&(f=a._config.network.responseFilter(e.RequestType.SEGMENT,m))}catch(e){f=Promise.reject(e)}return(f=f||Promise.resolve(m)).then((function(e){r.callbacks.onSuccess(e,o,s,n)})).catch((function(e){a._responseFilterError=!0,r.callbacks.onError({code:d,text:e.message},s,n)}))}o.retry>=l.maxRetry||d>=400&&d<499?(u._logger.error("".concat(d," while loading ").concat(s.url)),this.callbacks.onError({code:d,text:n.statusText},s,n)):(u._logger.warn("".concat(d," while loading ").concat(s.url,", retrying in ").concat(this.retryDelay,"...")),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,l.maxRetryDelay),o.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),l.timeout)}}})}}},{key:"_addBindings",value:function(){var e=this;this._mediaAttachedPromise=new Promise((function(t){return e._onMediaAttached=t}));for(var t=0,r=Object.entries(this._adapterEventsBindings);t<r.length;t++){var a=n(r[t],2),i=a[0],o=a[1];this._hls.on(i,o)}this._onRecoveredCallback=function(){return e._onRecovered()},this._onAddTrack=this._onAddTrack.bind(this),this._eventManager.listen(this._videoElement,"addtrack",this._onAddTrack),this._videoElement.textTracks.onaddtrack=this._onAddTrack}},{key:"_onFpsDrop",value:function(t){this._trigger(e.EventType.FPS_DROP,t)}},{key:"_onFragParsingMetadata",value:function(t){var r;this._trigger("hlsFragParsingMetadata",t);var n=Array.from(null===(r=this._videoElement)||void 0===r?void 0:r.textTracks).find((function(e){return"id3"===e.label})),a=Array.from((null==n?void 0:n.cues)||[]),i=[];null==t||t.samples.forEach((function(t){var r=e.Utils.binarySearch(a,(function(e){return e.startTime-t.pts}));if(r){var n=(0,e.createTimedMetadata)(r);i.push(n)}})),i.length&&this._trigger(e.EventType.TIMED_METADATA_ADDED,{cues:i})}},{key:"_onAddTrack",value:function(t){if(!this._hls.subtitleTracks.length){var r=this._parseCEATextTrack(t.track);r&&(u._logger.debug("A CEA 608/708 caption has been found",r),this._playerTracks.push(r),this._trigger(e.EventType.TRACKS_CHANGED,{tracks:this._playerTracks}))}}},{key:"attachMediaSource",value:function(){this._hls||(this._videoElement&&this._videoElement.src&&(e.Utils.Dom.setAttribute(this._videoElement,"src",""),e.Utils.Dom.removeAttribute(this._videoElement,"src")),this._init())}},{key:"detachMediaSource",value:function(){var t;this._hls&&(0===Math.floor(this.duration-this.currentTime)?this._config.hlsConfig.startPosition=0:this.currentTime>0&&(this._config.hlsConfig.startPosition=this.currentTime),this._reset(),null===(t=this._loadPromiseHandlers)||void 0===t||t.reject(new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.PLAYER,e.Error.Code.HLS_FATAL_MEDIA_ERROR,"media detached while loading")),this._loadPromiseHandlers=null,this._loadPromise=void 0,this._hls=null)}},{key:"handleMediaError",value:function(e){return e.code===e.MEDIA_ERR_DECODE&&(u._logger.debug("The video playback was aborted due to a corruption problem or because the video used features your browser did not support.",e.message),this._handleMediaError(E().ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR))}},{key:"load",value:function(e){var t=this;return this._loadPromise||(this._startTime=e,this._loadPromise=new Promise((function(e,r){t._loadPromiseHandlers={resolve:e,reject:r},t._loadInternal()}))),this._loadPromise}},{key:"_loadInternal",value:function(){var t;this._hls&&this._sourceObj&&this._sourceObj.url?(this._hls.loadSource(this._sourceObj.url),this._hls.attachMedia(this._videoElement),this._trigger(e.EventType.ABR_MODE_CHANGED,{mode:this.isAdaptiveBitrateEnabled()?"auto":"manual"})):null===(t=this._loadPromiseHandlers)||void 0===t||t.reject(new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.PLAYER,e.Error.Code.HLS_FATAL_MEDIA_ERROR,"no url provided"))}},{key:"_reloadWithDirectManifest",value:function(){this._triedReloadWithRedirect=!0,this._reset(),this._config.hlsConfig.pLoader=S,this._hls=new(E())(this._config.hlsConfig),this._addBindings(),this._loadInternal()}},{key:"destroy",value:function(){var t=this;return new Promise((function(r,n){h(p(u.prototype),"destroy",t).call(t).then((function(){var n;u._logger.debug("destroy"),t._playerTracks=[],t._nativeTextTracksMap={},t._sameFragSNLoadedCount=0,t._lastLoadedFragSN=-1,null===(n=t._loadPromiseHandlers)||void 0===n||n.reject(new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.PLAYER,e.Error.Code.HLS_FATAL_MEDIA_ERROR,"The adapter has been destroyed while loading")),t._loadPromiseHandlers=null,t._loadPromise=void 0,t._reset(),r()}),(function(){return n()}))}))}},{key:"_reset",value:function(){this._removeBindings(),this._requestFilterError=!1,this._responseFilterError=!1,this._hls.detachMedia(),this._hls.destroy()}},{key:"_parseTracks",value:function(){var e=this._parseAudioTracks(this._hls.audioTracks||[]),t=this._parseVideoTracks(this._hls.levels||[]),r=this._parseTextTracks(this._hls.subtitleTracks||[]);return e.concat(t).concat(r)}},{key:"_parseAudioTracks",value:function(t){for(var r=[],n=0;n<t.length;n++){var a={id:t[n].id,active:this._hls.audioTrack===t[n].id,label:t[n].name,language:t[n].lang,index:n};r.push(new e.AudioTrack(a))}return r}},{key:"_parseVideoTracks",value:function(t){for(var r=[],n=0;n<t.length;n++){var a={active:this._hls.startLevel===n,bandwidth:t[n].bitrate,width:t[n].width,height:t[n].height,language:"",index:n};r.push(new e.VideoTrack(a))}return r}},{key:"_parseTextTracks",value:function(t){var r,n=[],a=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(t);try{for(a.s();!(r=a.n()).done;){var i=r.value,o={id:i.id,active:!1,default:i.default,label:i.name,kind:i.type.toLowerCase(),language:i.lang};n.push(new e.TextTrack(o))}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"_parseCEATextTrack",value:function(t){var r=null;if("captions"===t.kind){var n={id:t.id,active:"showing"===t.mode,label:t.label,kind:t.kind,language:t.language};r=new e.TextTrack(n),this._nativeTextTracksMap[r.index]=t}return r}},{key:"selectAudioTrack",value:function(t){t instanceof e.AudioTrack&&!t.active&&this._hls.audioTracks&&(this._hls.audioTrack=t.id)}},{key:"selectVideoTrack",value:function(t){t instanceof e.VideoTrack&&(!t.active||this.isAdaptiveBitrateEnabled())&&this._hls.levels&&(this.isAdaptiveBitrateEnabled()&&this._trigger(e.EventType.ABR_MODE_CHANGED,{mode:"manual"}),this._hls.currentLevel=t.index)}},{key:"selectTextTrack",value:function(t){t instanceof e.TextTrack&&!t.active&&this._hls&&(this._hls.subtitleTracks.length?(this._hls.subtitleTrack=t.id,this._notifyTrackChanged(t)):this._selectNativeTextTrack(t))}},{key:"_selectNativeTextTrack",value:function(e){var t=this._nativeTextTracksMap[e.index];t&&(this.disableNativeTextTracks(),t.mode=this._config.subtitleDisplay?"showing":"hidden",this._notifyTrackChanged(e))}},{key:"_notifyTrackChanged",value:function(e){this._onTrackChanged(e)}},{key:"_onSubtitleFragProcessed",value:function(){this._hls.subtitleTrack=-1,this._waitForSubtitleLoad=!1,this._hls.off(E().Events.SUBTITLE_FRAG_PROCESSED,this._onSubtitleFragProcessed,this._hls)}},{key:"hideTextTrack",value:function(){this._hls&&(this._hls.subtitleTracks.length?this._waitForSubtitleLoad?this._hls.on(E().Events.SUBTITLE_FRAG_PROCESSED,this._onSubtitleFragProcessed,this._hls):this._hls.subtitleTrack=-1:this.disableNativeTextTracks())}},{key:"enableAdaptiveBitrate",value:function(){this.isAdaptiveBitrateEnabled()||(this._trigger(e.EventType.ABR_MODE_CHANGED,{mode:"auto"}),this._hls.nextLevel=-1)}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._hls&&this._hls.autoLevelEnabled}},{key:"applyABRRestriction",value:function(t){e.Utils.Object.createPropertyPath(this._config,"abr.restrictions",t),this._hls.capLevelToPlayerSize||this._maybeApplyAbrRestrictions(t)}},{key:"_getLevelDetails",value:function(){var e=this._hls.levels[this._hls.currentLevel]||this._hls.levels[this._hls.nextLevel]||this._hls.levels[this._hls.nextAutoLevel]||this._hls.levels[this._hls.nextLoadLevel];return e&&e.details?e.details:{}}},{key:"_getLiveEdge",value:function(){try{var e;return(e=this._hls.liveSyncPosition?this._hls.liveSyncPosition:this._hls.config.liveSyncDuration?this._videoElement.duration-this._hls.config.liveSyncDuration:this._videoElement.duration-this._hls.config.liveSyncDurationCount*this._getLevelDetails().targetduration)>0?e:this._videoElement.duration}catch(e){return u._logger.debug("Live edge calculation failed, fall back to duration"),this._videoElement.duration}}},{key:"seekToLiveEdge",value:function(){try{this._videoElement.currentTime=this._getLiveEdge()}catch(e){return}}},{key:"getSegmentDuration",value:function(){var t=e.Utils.Object.getPropertyPath(this._hls,"streamController.fragCurrent");return t?t.duration:0}},{key:"liveDuration",get:function(){return this._getLiveEdge()+this.getSegmentDuration()}},{key:"isLive",value:function(){try{return!!this._getLevelDetails().live}catch(e){return!1}}},{key:"_onManifestLoaded",value:function(t){var r=this;u._logger.debug("The source has been loaded successfully"),this._hls.config.autoStartLoad||this._hls.startLoad(this._startTime),this._playerTracks=this._parseTracks(),this._config.abr.enabled||(this._hls.currentLevel=0),this._mediaAttachedPromise.then((function(){var e;null===(e=r._loadPromiseHandlers)||void 0===e||e.resolve({tracks:r._playerTracks}),r._loadPromiseHandlers=null}));var n=t.stats.loading,a=n.end-n.start;this._trigger(e.EventType.MANIFEST_LOADED,{miliSeconds:a})}},{key:"_maybeApplyAbrRestrictions",value:function(t){var r=this._playerTracks.filter((function(t){return t instanceof e.VideoTrack})),n=(0,e.filterTracksByRestriction)(r,t);if(n.length){var a=n[0],i=n.pop();this._hls.config.minAutoBitrate=a.bandwidth,this._hls.autoLevelCapping=i.index;var o=n.some((function(e){return e.active}));this.isAdaptiveBitrateEnabled()||o||this.selectVideoTrack(a)}else u._logger.warn("Invalid restrictions, there are not tracks within the restriction range")}},{key:"_onLevelSwitched",value:function(t,r){var n=this._playerTracks.find((function(t){return t instanceof e.VideoTrack&&t.index===r.level}));this._onTrackChanged(n)}},{key:"_onAudioTrackSwitched",value:function(t,r){var n=this._playerTracks.find((function(t){return t instanceof e.AudioTrack&&t.id===r.id}));this._onTrackChanged(n),this._handleWaitingUponAudioTrackSwitch()}},{key:"_handleWaitingUponAudioTrackSwitch",value:function(){var t=this;["IE","Edge"].includes(e.Env.browser.name)&&this._eventManager.listenOnce(this._videoElement,e.EventType.TIME_UPDATE,(function(){t._trigger(e.EventType.PLAYING)}))}},{key:"_getErrorDataObject",value:function(e){var t={};switch(t.name=e.details,t.name){case E().ErrorDetails.MANIFEST_LOAD_ERROR:case E().ErrorDetails.LEVEL_LOAD_ERROR:case E().ErrorDetails.AUDIO_TRACK_LOAD_ERROR:t.url=e.url,t.responseCode=e.response?e.response.code:null;break;case E().ErrorDetails.MANIFEST_LOAD_TIMEOUT:case E().ErrorDetails.LEVEL_LOAD_TIMEOUT:case E().ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:t.url=e.url;break;case E().ErrorDetails.MANIFEST_PARSING_ERROR:t.url=e.url,t.reason=e.reason;break;case E().ErrorDetails.LEVEL_SWITCH_ERROR:t.level=e.level,t.reason=e.reason;break;case E().ErrorDetails.FRAG_LOAD_ERROR:t.fragUrl=e.frag?e.frag.url:null,t.responseCode=e.response?e.response.code:null;break;case E().ErrorDetails.FRAG_LOAD_TIMEOUT:t.fragUrl=e.frag?e.frag.url:null;break;case E().ErrorDetails.FRAG_DECRYPT_ERROR:case E().ErrorDetails.FRAG_PARSING_ERROR:t.reason=e.reason;break;case E().ErrorDetails.KEY_LOAD_ERROR:t.fragDecryptedDataUri=e.frag&&e.frag.decryptdata?e.frag.decryptdata.uri:null,t.responseCode=e.response?e.response.code:null;break;case E().ErrorDetails.KEY_LOAD_TIMEOUT:t.fragDecryptedDataUri=e.frag&&e.frag.decryptdata?e.frag.decryptdata.uri:null;break;case E().ErrorDetails.BUFFER_ADD_CODEC_ERROR:t.mimeType=e.mimeType,t.errorMsg=e.err?e.err.message:null;break;case E().ErrorDetails.BUFFER_STALLED_ERROR:t.buffer=e.buffer}return(this._requestFilterError||this._responseFilterError)&&(t.reason=e.response.text),t}},{key:"_onError",value:function(t){var r=t.type,n=t.details,a=t.fatal,i=this._getErrorDataObject(t);if(a){var o,s;switch(r){case E().ErrorTypes.NETWORK_ERROR:var l;l=this._requestFilterError?e.Error.Code.REQUEST_FILTER_ERROR:this._responseFilterError?e.Error.Code.RESPONSE_FILTER_ERROR:e.Error.Code.HTTP_ERROR,![E().ErrorDetails.MANIFEST_LOAD_ERROR,E().ErrorDetails.MANIFEST_LOAD_TIMEOUT].includes(n)||this._triedReloadWithRedirect||this._config.forceRedirectExternalStreams||this._requestFilterError||this._responseFilterError?o=new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.NETWORK,l,i):(o=new e.Error(e.Error.Severity.RECOVERABLE,e.Error.Category.NETWORK,l,i),this._reloadWithDirectManifest());break;case E().ErrorTypes.MEDIA_ERROR:o=this._handleMediaError(n)?new e.Error(e.Error.Severity.RECOVERABLE,e.Error.Category.MEDIA,e.Error.Code.HLS_FATAL_MEDIA_ERROR,i):new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.MEDIA,e.Error.Code.HLS_FATAL_MEDIA_ERROR,i);break;default:o=new e.Error(e.Error.Severity.CRITICAL,e.Error.Category.PLAYER,e.Error.Code.HLS_FATAL_MEDIA_ERROR,i)}this._trigger(e.EventType.ERROR,o),o&&o.severity===e.Error.Severity.CRITICAL&&(this._loadPromiseHandlers&&(null===(s=this._loadPromiseHandlers)||void 0===s||s.reject(o),this._loadPromiseHandlers=null,this._loadPromise=void 0),this.destroy())}else{var c=this._requestFilterError||this._responseFilterError?{category:e.Error.Category.NETWORK,code:this._requestFilterError?e.Error.Code.REQUEST_FILTER_ERROR:e.Error.Code.RESPONSE_FILTER_ERROR}:T[n]||{category:0,code:0},d=c.category,p=c.code;u._logger.warn(new e.Error(e.Error.Severity.RECOVERABLE,d,p,i))}this._requestFilterError=!1,this._responseFilterError=!1}},{key:"_handleMediaError",value:function(t){u._logger.error("_handleMediaError mediaErrorName:",t);var r=performance.now(),n=!0;return t===E().ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR?(u._logger.error("recover aborted due to: MANIFEST_INCOMPATIBLE_CODECS_ERROR"),n=!1):this._checkTimeDeltaHasPassed(r,this._recoverDecodingErrorDate,this._config.recoverDecodingErrorDelay)?(this._eventManager.listen(this._videoElement,e.EventType.LOADED_METADATA,this._onRecoveredCallback),u._logger.debug("try to recover using: _recoverDecodingError()"),this._recoverDecodingError()):this._checkTimeDeltaHasPassed(r,this._recoverSwapAudioCodecDate,this._config.recoverSwapAudioCodecDelay)?(this._eventManager.listen(this._videoElement,e.EventType.LOADED_METADATA,this._onRecoveredCallback),u._logger.debug("try to recover using: _recoverSwapAudioCodec()"),this._recoverSwapAudioCodec()):(u._logger.error("cannot recover, last media error recovery failed error: ",t),n=!1),n}},{key:"_onRecovered",value:function(){this._trigger(e.EventType.MEDIA_RECOVERED),this._videoElement.removeEventListener(e.EventType.LOADED_METADATA,this._onRecoveredCallback)}},{key:"_checkTimeDeltaHasPassed",value:function(e,t,r){return!t||e-t>r}},{key:"_recoverDecodingError",value:function(){this._recoverDecodingErrorDate=performance.now(),u._logger.warn("try to recover media Error"),this._hls.recoverMediaError()}},{key:"_recoverSwapAudioCodec",value:function(){this._recoverSwapAudioCodecDate=performance.now(),u._logger.warn("try to swap Audio Codec and recover media Error"),this._hls.swapAudioCodec(),this._hls.recoverMediaError()}},{key:"_removeBindings",value:function(){for(var e=0,t=Object.entries(this._adapterEventsBindings);e<t.length;e++){var r=n(t[e],2),a=r[0],i=r[1];this._hls.off(a,i)}this._hls.off(E().Events.SUBTITLE_FRAG_PROCESSED,this._onSubtitleFragProcessed,this._hls),this._videoElement.textTracks.onaddtrack=null,this._onRecoveredCallback=null,this._eventManager&&this._eventManager.removeAll()}},{key:"getStartTimeOfDvrWindow",value:function(){if(!this.isLive())return 0;try{var e=this._hls.levels[this._hls.nextLoadLevel].details,t=e.fragments,r=t.length,n=t[0].start+t[0].duration,a=t[r-1].start+t[r-1].duration,i=void 0!==this._hls.config.liveMaxLatencyDuration?this._hls.config.liveMaxLatencyDuration:this._hls.config.liveMaxLatencyDurationCount*e.targetduration;return Math.max(n-this._hls.config.maxFragLookUpTolerance,a-i)}catch(e){return u._logger.debug("Unable obtain the start of DVR window"),0}}},{key:"_onFragLoaded",value:function(t){if(e.Utils.Object.hasPropertyPath(t,"frag.stats.loading")){var r=t.frag.stats,n=r.loading.end-r.loading.start;this._trigger(e.EventType.FRAG_LOADED,{miliSeconds:n,bytes:r.loaded,url:t.frag.url})}}},{key:"targetBuffer",get:function(){var e=NaN;return this._hls?(e=this.isLive()?this._getLiveTargetBuffer()-(this._videoElement.currentTime-this._getLiveEdge()):this._videoElement.duration-this._videoElement.currentTime,e=Math.min(e,this._hls.config.maxMaxBufferLength+this._getLevelDetails().targetduration)):NaN}},{key:"_getLiveTargetBuffer",value:function(){return this._hls.config.liveSyncDuration?this._hls.config.liveSyncDuration:this._hls.config.liveSyncDurationCount*this._getLevelDetails().targetduration}}],[{key:"createAdapter",value:function(t,r,n){var a=e.Utils.Object.copyDeep(b);if(e.Utils.Object.hasPropertyPath(n,"sources.options")){var i=n.sources.options;a.forceRedirectExternalStreams=i.forceRedirectExternalStreams,a.redirectExternalStreamsHandler=i.redirectExternalStreamsHandler,a.redirectExternalStreamsTimeout=i.redirectExternalStreamsTimeout,S.redirectExternalStreamsHandler=a.redirectExternalStreamsHandler,S.redirectExternalStreamsTimeout=a.redirectExternalStreamsTimeout}if(e.Utils.Object.hasPropertyPath(n,"sources.startTime")&&e.Utils.Object.getPropertyPath(n,"sources.startTime")>-1&&(a.hlsConfig.startPosition=n.sources.startTime),e.Utils.Object.hasPropertyPath(n,"text.useNativeTextTrack")&&(a.subtitleDisplay=e.Utils.Object.getPropertyPath(n,"text.useNativeTextTrack")),e.Utils.Object.hasPropertyPath(n,"abr.fpsDroppedFramesInterval")&&(a.hlsConfig.fpsDroppedFramesInterval=n.abr.fpsDroppedFramesInterval),e.Utils.Object.hasPropertyPath(n,"abr.fpsDroppedMonitoringThreshold")&&(a.hlsConfig.fpsDroppedMonitoringThreshold=n.abr.fpsDroppedMonitoringThreshold),e.Utils.Object.hasPropertyPath(n,"abr.capLevelOnFPSDrop")&&(u._logger.debug("capLevelOnFPSDrop = ",n.abr.capLevelOnFPSDrop),a.hlsConfig.capLevelOnFPSDrop=n.abr.capLevelOnFPSDrop),e.Utils.Object.hasPropertyPath(n,"text")&&(a.hlsConfig.enableCEA708Captions=n.text.enableCEA708Captions,a.hlsConfig.captionsTextTrack1Label=n.text.captionsTextTrack1Label,a.hlsConfig.captionsTextTrack1LanguageCode=n.text.captionsTextTrack1LanguageCode,a.hlsConfig.captionsTextTrack2Label=n.text.captionsTextTrack2Label,a.hlsConfig.captionsTextTrack2LanguageCode=n.text.captionsTextTrack2LanguageCode),e.Utils.Object.hasPropertyPath(n,"abr")){var o=n.abr;"boolean"==typeof o.enabled&&(a.abr.enabled=o.enabled),"boolean"==typeof o.capLevelToPlayerSize&&(a.hlsConfig.capLevelToPlayerSize=o.capLevelToPlayerSize),o.defaultBandwidthEstimate&&(a.hlsConfig.abrEwmaDefaultEstimate=o.defaultBandwidthEstimate),o.restrictions&&e.Utils.Object.createPropertyPath(a,"abr.restrictions",o.restrictions)}return e.Utils.Object.hasPropertyPath(n,"streaming.lowLatencyMode")&&(a.hlsConfig.lowLatencyMode=e.Utils.Object.getPropertyPath(n,"streaming.lowLatencyMode")),e.Utils.Object.hasPropertyPath(n,"playback.options.html5.hls")&&e.Utils.Object.mergeDeep(a.hlsConfig,n.playback.options.html5.hls),a.network=n.network,new this(t,r,a)}},{key:"canPlayType",value:function(e){var t="string"==typeof e&&u._hlsMimeTypes.includes(e.toLowerCase())&&u.isMSESupported();return u._logger.debug("canPlayType result for mimeType:"+e+" is "+t.toString()),t}},{key:"canPlayDrm",value:function(){return u._logger.warn("canPlayDrm result is false"),!1}},{key:"isSupported",value:function(){var e=E().isSupported();return u._logger.debug("isSupported:"+e),e}}]),u}(e.BaseMediaSourceAdapter);_=P,y(P,"id","HlsAdapter"),y(P,"_logger",e.BaseMediaSourceAdapter.getLogger(_.id)),y(P,"_hlsMimeTypes",["application/x-mpegurl","application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"]);var x="1.32.13",w="@playkit-js/playkit-js-hls",I=P;P.isSupported()&&(0,e.registerMediaSourceAdapter)(P)}(),i}())},859:module=>{self,module.exports=function(){"use strict";var e={d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{NAME:function(){return we},Provider:function(){return xe},ProviderParser:function(){return ie},RequestBuilder:function(){return se},ResponseTypes:function(){return r},VERSION:function(){return Ie}});var r={};function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(e){var t=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===a(t)?t:String(t)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function d(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function h(e,t,r){return(t=i(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.r(r),e.d(r,{BaseServiceResult:function(){return E},KalturaAccessControlMessage:function(){return O},KalturaAccessControlModifyRequestHostRegexAction:function(){return C},KalturaBaseEntryListResponse:function(){return A},KalturaBumper:function(){return w},KalturaDrmPlaybackPluginData:function(){return P},KalturaFlavorAsset:function(){return I},KalturaMediaEntries:function(){return M},KalturaMediaEntry:function(){return T},KalturaMetadata:function(){return R},KalturaMetadataListResponse:function(){return D},KalturaPlaybackContext:function(){return L},KalturaPlaybackSource:function(){return x},KalturaPlaylist:function(){return N},KalturaRuleAction:function(){return S},KalturaUIConfResponse:function(){return U},KalturaUserEntry:function(){return j},KalturaUserEntryListResponse:function(){return B}});var f={get:function(){return{VERSION:"",DEBUG:{value:"",name:""},ERROR:{value:"",name:""},INFO:{value:"",name:""},OFF:{value:"",name:""},TIME:{value:"",name:""},TRACE:{value:"",name:""},WARN:{value:"",name:""},createDefaultHandler:function(){},debug:function(){},enabledFor:function(){},error:function(){},get:function(){},getLevel:function(){},info:function(){},log:function(){},setHandler:function(){},setLevel:function(){},time:function(){},timeEnd:function(){},trace:function(){},useDefaults:function(){},warn:function(){}}}},m={};function g(e){return f.get(e)}var y=g,v=function e(t){var r;return Array.isArray(t)?(r=t.length>0?t.slice(0):[]).forEach((function(t,n){("object"===a(t)||Array.isArray(t)&&t.length>0)&&(r[n]=e(t))})):"object"===a(t)?(r=Object.assign({},t),Object.keys(r).forEach((function(t){("object"===a(r[t])||Array.isArray(r[t])&&r[t].length>0)&&(r[t]=e(r[t]))}))):r=t,r},_={serviceUrl:"https://cdnapisec.kaltura.com/api_v3",cdnUrl:"https://cdnapisec.kaltura.com",serviceParams:{apiVersion:"3.3.0",format:1},useApiCaptions:!0,loadThumbnailWithKs:!1,replaceHostOnlyManifestUrls:!1},k=function(){function e(){n(this,e)}return s(e,null,[{key:"set",value:function(e){e&&Object.assign(_,e)}},{key:"get",value:function(){return v(_)}}]),e}(),E=s((function e(t){n(this,e),h(this,"hasError",!1),"KalturaAPIException"===t.objectType?(this.hasError=!0,this.error=new b(t.code,t.message)):t.error&&"KalturaAPIException"===t.error.objectType?(this.hasError=!0,this.error=new b(t.error.code,t.error.message)):this.data=t})),b=s((function e(t,r){n(this,e),this.code=t,this.message=r})),T=s((function e(t){n(this,e),this.id=t.id,this.referenceId=t.referenceId,this.externalSourceType=t.externalSourceType,this.name=t.name,this.description=t.description,this.dataUrl=t.dataUrl,this.type=t.type,this.entryType=t.mediaType,this.flavorParamsIds=t.flavorParamsIds,this.duration=t.duration,this.poster=t.thumbnailUrl,this.status=t.status,this.dvrStatus=t.dvrStatus,this.tags=t.tags,this.createdAt=t.createdAt,this.updatedAt=t.updatedAt,this.creatorId=t.creatorId,this.endDate=t.endDate,this.plays=t.plays,this.views=t.views,this.downloadUrl=t.downloadUrl}));h(T,"EntryType",{AUTOMATIC:{value:-1},EXTERNAL_MEDIA:{value:"externalMedia.externalMedia"},MEDIA_CLIP:{value:1},MIX:{value:2},PLAYLIST:{value:5},DATA:{value:6},LIVE_STREAM:{value:7},LIVE_CHANNEL:{value:8},DOCUMENT:{value:10}}),h(T,"MediaType",{VIDEO:{value:1},IMAGE:{value:2},AUDIO:{value:5},LIVE_STREAM_FLASH:{value:201},LIVE_STREAM_WINDOWS_MEDIA:{value:202},LIVE_STREAM_REAL_MEDIA:{value:203},LIVE_STREAM_QUICK_TIME:{value:204}}),h(T,"EntryStatus",{ERROR_IMPORTING:-2,ERROR_CONVERTING:-1,SCAN_FAILURE:"virusScan.ScanFailure",IMPORT:0,INFECTED:"virusScan.Infected",PRECONVERT:1,READY:2,DELETED:3,PENDING:4,MODERATE:5,BLOCKED:6,NO_CONTENT:7}),h(T,"EntryModerationStatus",{PENDING_MODERATION:1,APPROVED:2,REJECTED:3,FLAGGED_FOR_REVIEW:4,MODERATE:5,AUTO_APPROVED:6});var A=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(e){var t;return n(this,i),(t=a.call(this,e)).hasError||(t.totalCount=e.totalCount,t.totalCount>0&&(t.entries=[],e.objects.map((function(e){return t.entries.push(new T(e))})))),t}return s(i)}(E),S=s((function e(t){n(this,e),this.type=t.type}));h(S,"Type",{DRM_POLICY:"drm.DRM_POLICY",BLOCK:1,PREVIEW:2,LIMIT_FLAVORS:3,ADD_TO_STORAGE:4,LIMIT_DELIVERY_PROFILES:5,SERVE_FROM_REMOTE_SERVER:6,REQUEST_HOST_REGEX:7,LIMIT_THUMBNAIL_CAPTURE:8});var C=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(e){var t;return n(this,i),(t=a.call(this,e)).pattern=e.pattern,t.replacement=e.replacement,t.replacmenServerNodeId=e.replacmenServerNodeId,t.checkAliveTimeoutMs=e.checkAliveTimeoutMs,t}return s(i)}(S),P=s((function e(t){n(this,e),this.scheme=t.scheme,this.licenseURL=t.licenseURL,this.certificate=t.certificate}));h(P,"Scheme",{"drm.PLAYREADY_CENC":"com.microsoft.playready","drm.WIDEVINE_CENC":"com.widevine.alpha","fairplay.FAIRPLAY":"com.apple.fairplay",WIDEVINE_CENC:"com.widevine.alpha",PLAYREADY_CENC:"com.microsoft.playready",FAIRPLAY:"com.apple.fairplay"});var x=function(){function e(t){var r=this;n(this,e),h(this,"drm",[]),this.format=t.format,this.deliveryProfileId=t.deliveryProfileId,this.url=t.url,this.protocols=t.protocols,this.flavorIds=t.flavorIds,t.drm&&t.drm.map((function(e){return r.drm.push(new P(e))}))}return s(e,[{key:"hasDrmData",value:function(){return this.drm&&this.drm.length>0}},{key:"hasFlavorIds",value:function(){return!!this.flavorIds&&this.flavorIds.length>0}},{key:"getProtocol",value:function(e){var t="";if(this.protocols&&this.protocols.length>0)this.protocols.split(",").forEach((function(r){r===e&&(t=r)}));else if("http"===e)return e;return t}}]),e}(),w=s((function e(t){n(this,e),this.entryId=t.entryId,this.clickThroughUrl=t.url,this.sources=t.sources?t.sources.map((function(e){return new x(e)})):[]})),I=s((function e(t){n(this,e),this.id=t.id,this.flavorParamsId=t.flavorParamsId,this.fileExt=t.fileExt,this.bitrate=t.bitrate,this.width=t.width,this.height=t.height,this.id=t.id,this.frameRate=t.frameRate,this.isOriginal=t.isOriginal,this.isWeb=t.isWeb,this.containerFormat=t.containerFormat,this.videoCodecId=t.videoCodecId,this.status=t.status,this.language=t.language,this.label=t.label}));h(I,"Status",{ERROR:-1,QUEUED:0,CONVERTING:1,READY:2,DELETED:3,NOT_APPLICABLE:4,TEMP:5,WAIT_FOR_CONVERT:6,IMPORTING:7,VALIDATING:8,EXPORTING:9});var M=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(e){var t;return n(this,i),(t=a.call(this,e)).hasError||(t.entries=[],e.map((function(e){return t.entries.push(new T(e))}))),t}return s(i)}(E),R=s((function e(t){n(this,e),this.id=t.id,this.metadataProfileId=t.metadataProfileId,this.metadataProfileVersion=t.metadataProfileVersion,this.metadataProfileId=t.metadataProfileId,this.metadataObjectType=t.metadataObjectType,this.objectId=t.objectId,this.version=t.version,this.created=new Date(0),this.created.setUTCSeconds(t.createdAt),this.updated=new Date(0),this.updated.setUTCSeconds(t.updatedAt),this.status=t.status,this.xml=t.xml}));h(R,"ObjectType",{AD_CUE_POINT:"adCuePointMetadata.AdCuePoint",ANNOTATION:"annotationMetadata.Annotation",CODE_CUE_POINT:"codeCuePointMetadata.CodeCuePoint",THUMB_CUE_POINT:"thumbCuePointMetadata.thumbCuePoint",ENTRY:1,CATEGORY:2,USER:3,PARTNER:4,DYNAMIC_OBJECT:5}),h(R,"Status",{VALID:1,INVALID:2,DELETED:3});var D=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(e){var t;return n(this,i),(t=a.call(this,e)).hasError||(t.totalCount=e.totalCount,t.totalCount>0&&(t.metas=[],e.objects.map((function(e){return t.metas.push(new R(e))})))),t}return s(i)}(E),O=s((function e(t){n(this,e),this.message=t.message,this.code=t.code})),L=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(e){var t;if(n(this,i),h(l(t=a.call(this,e)),"sources",[]),h(l(t),"actions",[]),h(l(t),"messages",[]),h(l(t),"flavorAssets",[]),h(l(t),"bumperData",[]),!t.hasError){var r=e.messages;r&&r.map((function(e){return t.messages.push(new O(e))}));var o=e.actions;o&&o.map((function(e){e.type===S.Type.REQUEST_HOST_REGEX?t.actions.push(new C(e)):t.actions.push(new S(e))}));var s=e.sources;s&&s.map((function(e){return t.sources.push(new x(e))}));var u=e.flavorAssets;u&&u.map((function(e){return t.flavorAssets.push(new I(e))}));var c=e.bumperData;c&&c.map((function(e){return t.bumperData.push(new w(e))}))}return t}return s(i,[{key:"hasBlockAction",value:function(){return void 0!==this.getBlockAction()}},{key:"getBlockAction",value:function(){return this.actions.find((function(e){return e.type===S.Type.BLOCK}))}},{key:"getErrorMessages",value:function(){return this.messages}},{key:"getRequestHostRegexAction",value:function(){var e=this.actions.find((function(e){return e.type===S.Type.REQUEST_HOST_REGEX}));if(e instanceof C)return e}}]),i}(E),N=s((function e(t){n(this,e),this.id=t.id,this.name=t.name,this.description=t.description,this.poster=t.thumbnailUrl})),U=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(e){var t;return n(this,i),(t=a.call(this,e)).hasError||(t.name=e.name,t.description=e.description,t.objTypeAsString=e.objTypeAsString,t.width=e.width,t.height=e.height,t.htmlParams=e.htmlParams,t.swfUrl=e.swfUrl,t.confFilePath=e.confFilePath,t.confFile=e.confFile,t.confFileFeatures=e.confFileFeatures,t.config=e.config,t.confVars=e.confVars,t.useCdn=e.useCdn,t.tags=e.tags,t.swfUrlVersion=e.swfUrlVersion,t.created=new Date(0),t.created.setUTCSeconds(e.createdAt),t.updated=new Date(0),t.updated.setUTCSeconds(e.updatedAt),t.html5Url=e.description,t.version=e.description,t.partnerTags=e.description,t.objType=e.description,t.creationMode=e.description),t}return s(i)}(E);h(U,"Type",{PLAYER:1,CONTRIBUTION_WIZARD:2,SIMPLE_EDITOR:3,ADVANCED_EDITOR:4,PLAYLIST:5,APP_STUDIO:6,KRECORD:7,PLAYER_V3:8,KMC_ACCOUNT:9,KMC_ANALYTICS:10,KMC_CONTENT:11,KMC_DASHBOARD:12,KMC_LOGIN:13,PLAYER_SL:14,CLIENTSIDE_ENCODER:15,KMC_GENERAL:16,KMC_ROLES_AND_PERMISSIONS:17,CLIPPER:18,KSR:19,KUPLOAD:20,WEBCASTING:21}),h(U,"CreationMode",{WIZARD:2,ADVANCED:3});var j=s((function e(t){n(this,e),this.playlistLastEntryId=t.playlistLastEntryId,this.entryId=t.entryId,this.id=t.id,this.userId=t.userId,this.partnerId=t.partnerId,this.status=t.status,this.createdAt=t.createdAt,this.updatedAt=t.updatedAt})),B=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(e){var t;return n(this,i),(t=a.call(this,e)).hasError||(t.totalCount=e.totalCount,t.entries=[],t.totalCount>0&&e.objects.map((function(e){return t.entries.push(new j(e))}))),t}return s(i)}(E),F=function(){function e(){n(this,e)}return s(e,null,[{key:"build",value:function(e){var t=k.get(),r=t.serviceUrl.substr(0,t.serviceUrl.lastIndexOf("/")),n=e.partnerId,a=e.entryId,i=e.ks,o=e.uiConfId,s=e.format,l=e.protocol,u=e.extension,c=e.flavorIds;if(!r||isNaN(Number.parseInt(n))||!a||!s||!l)return"";var d=r;return r.endsWith("/")||(d+="/"),d+="p/"+n+"/sp/"+n+"00/playManifest/entryId/"+a+"/protocol/"+l+"/format/"+s,c?d+="/flavorIds/"+c:o&&(d+="/uiConfId/"+o),""!==i&&(d+="/ks/"+i),""!==u&&(d+="/a."+u),o&&""!==c&&(d+="?uiConfId="+o),d}}]),e}(),V=function(){function e(){n(this,e)}return s(e,null,[{key:"xmlToJson",value:function(e){var t={};if(1===e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var r=0;r<e.attributes.length;r++){var n=e.attributes.item(r);t["@attributes"][n.nodeName]=n.nodeValue}}}else 3===e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var a=0;a<e.childNodes.length;a++){var i=e.childNodes.item(a),o=i.nodeName;if(void 0===t[o])t[o]=this.xmlToJson(i);else{if(void 0===t[o].push){var s=t[o];t[o]=[],t[o].push(s)}t[o].push(this.xmlToJson(i))}}return t}}]),e}(),H={DASH:{name:"dash",mimeType:"application/dash+xml",pathExt:"mpd"},HLS:{name:"hls",mimeType:"application/x-mpegURL",pathExt:"m3u8"},WVM:{name:"wvm",mimeType:"video/wvm",pathExt:"wvm"},MP4:{name:"mp4",mimeType:"video/mp4",pathExt:"mp4"},MP3:{name:"mp3",mimeType:"audio/mpeg",pathExt:"mp3"}},G=new Map([["mpegdash",H.DASH],["applehttp",H.HLS],["url",H.MP4]]);function $(e){var t=G.get(e);return!!t&&t.name===H.MP4.name}var K=function(){function e(){n(this,e),this.progressive=[],this.dash=[],this.hls=[],this.image=[],this.document=[]}return s(e,[{key:"map",value:function(e,t){if(t)switch(t.name){case H.MP4.name:this.progressive.push(e);break;case H.DASH.name:this.dash.push(e);break;case H.HLS.name:this.hls.push(e)}}},{key:"toJSON",value:function(){var e={progressive:[],dash:[],hls:[],image:[],document:[]};return this.progressive.forEach((function(t){return e.progressive.push(t.toJSON())})),this.hls.forEach((function(t){return e.hls.push(t.toJSON())})),this.dash.forEach((function(t){return e.dash.push(t.toJSON())})),e.image=this.image,e.document=this.document,e}}]),e}(),W=function(){function e(){n(this,e),this.metadata=new Map,this.sources=new K,this.type=e.Type.UNKNOWN}return s(e,[{key:"toJSON",value:function(){return{id:this.id,name:this.name,sources:this.sources.toJSON(),duration:this.duration,dvrStatus:this.dvrStatus,status:this.status,metadata:this.metadata,type:this.type,poster:this.poster,assetReferenceType:this.assetReferenceType,downloadUrl:this.downloadUrl}}}]),e}();h(W,"Type",{VOD:"Vod",LIVE:"Live",IMAGE:"Image",AUDIO:"Audio",UNKNOWN:"Unknown",DOCUMENT:"Document"}),h(W,"DvrStatus",{ON:1,OFF:0});var z=function(){function e(t,r,a){n(this,e),this.licenseUrl=t,this.scheme=r,a&&(this.certificate=a)}return s(e,[{key:"toJSON",value:function(){var e={licenseUrl:this.licenseUrl,scheme:this.scheme};return this.certificate&&(e.certificate=this.certificate),e}}]),e}(),q=function(){function e(){n(this,e)}return s(e,[{key:"toJSON",value:function(){var e={id:this.id,url:this.url,mimetype:this.mimetype};return this.bandwidth&&(e.bandwidth=this.bandwidth),this.width&&(e.width=this.width),this.height&&(e.height=this.height),this.label&&(e.label=this.label),this.drmData&&this.drmData.length>0&&(e.drmData=[],this.drmData.forEach((function(t){Array.isArray(e.drmData)&&e.drmData.push(t.toJSON())}))),e}}]),e}(),Y=s((function e(){n(this,e),this.items=[]})),X=s((function e(){n(this,e),this.items=[]})),Z=s((function e(t){n(this,e),this.url=t.url,this.clickThroughUrl=t.clickThroughUrl})),Q={SRT:"1",DFXP:"2",WEBVTT:"3",CAP:"4"},J={3:"vtt",1:"srt"},ee=function(){function e(){n(this,e)}return s(e,null,[{key:"createConfig",value:function(e,t){return e.map((function(e){var r=e.url,n=J[e.format];return[Q.DFXP,Q.CAP].includes(e.format)&&(r=e.webVttUrl,n=J[Q.WEBVTT]),r=ae(r,t),{default:!!e.isDefault,type:n,language:e.languageCode,label:e.label,url:r}}))}}]),e}(),te=function(){function e(t){n(this,e),this.id=t.id,this.url=e.extractBaseThumbnailUrl(t.dataUrl),this.mimetype=""}return s(e,null,[{key:"extractBaseThumbnailUrl",value:function(e){return e.match(".+entry_id/[a-zA-Z0-9_]+/")[0].slice(0,-1)}}]),e}(),re=s((function e(t){n(this,e),this.id=t.id,this.url=t.downloadUrl,this.thumbnailUrl=t.poster,this.mimetype=""})),ne=function(){function e(){n(this,e)}return s(e,null,[{key:"getMediaEntry",value:function(t,r,n,a){var i=new W,o=a.entry,s=a.playBackContextResult,l=a.metadataListResult,u=s.sources;return i.sources=e._getParsedSources(u,t,r,n,o,s),e._fillBaseData(i,o,l,s),i.type!==W.Type.LIVE&&k.get().useApiCaptions&&s.data.playbackCaptions&&(i.sources.captions=ee.createConfig(s.data.playbackCaptions,t)),i}},{key:"addKsToUrl",value:function(e,t){var r;return t?(r=-1!==e.split("?")[0].replace(/^.*[\\/]/,"").indexOf(".")?-1===e.indexOf("?")?"?ks=":"&ks=":"/ks/",e+r+t):e}},{key:"getPlaylist",value:function(t){var r=new Y,n=t.playlistData,a=t.playlistItems.entries,i=t.playlistUserEntries.entries;return r.id=n.id,r.name=n.name,r.description=n.description,r.poster=n.poster,r.playlistLastEntryId=i.map((function(e){return e.playlistLastEntryId}))[0],a.forEach((function(t){var n=new W;e._fillBaseData(n,t),r.items.push(n)})),r}},{key:"getEntryList",value:function(t){var r=new X;return t.playlistItems.entries.forEach((function(t){var n=new W;e._fillBaseData(n,t),r.items.push(n)})),r}},{key:"getBumper",value:function(t,r,n){var a=t.playBackContextResult,i=a.bumperData[0];if(i){var o=(i&&i.sources).find((function(e){return $(e.format)}));if(o){var s=e._parseProgressiveSources(o,a,r,n,0,i.entryId);if(s[0])return new Z({url:s[0].url,clickThroughUrl:i.clickThroughUrl})}}}},{key:"_fillBaseData",value:function(t,r,n,a){if(t.poster=r.poster,t.id=r.id,t.duration=r.duration,t.downloadUrl=r.downloadUrl||"",t.metadata=e._parseMetadata(n),t.metadata.description=r.description||"",t.metadata.entryId=r.id||"",t.metadata.name=r.name||"",r.createdAt&&(t.metadata.createdAt=r.createdAt),r.updatedAt&&(t.metadata.updatedAt=r.updatedAt),r.creatorId&&(t.metadata.creatorId=r.creatorId),r.endDate&&(t.metadata.endDate=r.endDate),r.views&&(t.metadata.views=r.views),r.plays&&(t.metadata.plays=r.plays),t.metadata.tags=r.tags||"",t.status=r.status,t.type=e._getEntryType(r.entryType,r.type),t.type===W.Type.LIVE&&(t.dvrStatus=r.dvrStatus),a&&a.flavorAssets[0]&&a.flavorAssets[0].width&&a.flavorAssets[0].height){var i=a.flavorAssets[0],o=i.height,s=i.width;t.metadata.aspectRatio=+Number(s/o).toFixed(2)}return t}},{key:"_getEntryType",value:function(e,t){var r=W.Type.UNKNOWN;switch(e){case T.MediaType.IMAGE.value:r=W.Type.IMAGE;break;case T.MediaType.AUDIO.value:r=W.Type.AUDIO;break;default:switch(t){case T.EntryType.MEDIA_CLIP.value:r=W.Type.VOD;break;case T.EntryType.LIVE_STREAM.value:case T.EntryType.LIVE_CHANNEL.value:r=W.Type.LIVE;break;case T.EntryType.DOCUMENT.value:r=W.Type.DOCUMENT;break;default:r=W.Type.UNKNOWN}}return r}},{key:"_getParsedSources",value:function(t,r,n,a,i,o){var s,l,u=new K;return i.type===T.EntryType.EXTERNAL_MEDIA.value?((l=new q).mimetype="video/youtube",l.url=i.referenceId,l.id=i.id+"_youtube",u.progressive.push(l)):i.entryType===T.MediaType.IMAGE.value?u.image.push(new te(i)):i.type===T.EntryType.DOCUMENT.value?u.document.push(new re(i)):t&&t.length>0&&(t.filter((function(e){return!$(e.format)})).forEach((function(t){var s=e._parseAdaptiveSource(t,o,r,n,a,i.id);if(s){var l=G.get(t.format);u.map(s,l)}})),s=t.find((function(t){return $(t.format)&&""!==t.getProtocol(e._getBaseProtocol())})),u.progressive=e._parseProgressiveSources(s,o,r,n,a,i.id)),u}},{key:"_parseAdaptiveSource",value:function(t,r,n,a,i,o){var s=new q;if(t){var l="",u=G.get(t.format),c=t.getProtocol(e._getBaseProtocol()),d=t.deliveryProfileId,p=t.format,h="";if(u&&(h=u.pathExt,s.mimetype=u.mimeType),t.hasFlavorIds()?(!h&&r.flavorAssets&&r.flavorAssets.length>0&&(h=r.flavorAssets[0].fileExt),l=F.build({entryId:o,flavorIds:t.flavorIds,format:p,ks:n,partnerId:a,uiConfId:i,extension:h,protocol:c})):l=e.addKsToUrl(t.url,n),!l){var f="failed to create play url from source, discarding source: (".concat(o,"_").concat(d,"), ").concat(p);return e._logger.warn(f),null}if(s.url=l,s.id=o+"_"+d+","+p,t.hasDrmData()){var m=[];t.drm.forEach((function(e){m.push(new z(e.licenseURL,P.Scheme[e.scheme],e.certificate))})),s.drmData=m}}return s}},{key:"_parseProgressiveSources",value:function(t,r,n,a,i,o){var s=[],l=[];if(t){var u=t.getProtocol(e._getBaseProtocol()),c=t.format,d=t.deliveryProfileId,p=d+","+c;r.flavorAssets.map((function(t){var r=new q;r.id=t.id+p,r.mimetype="mp3"===t.fileExt?"audio/mp3":"video/mp4",r.height=t.height,r.width=t.width,r.bandwidth=1024*t.bitrate,r.label=t.label||t.language;var h=F.build({entryId:o,flavorIds:t.id,format:c,ks:n,partnerId:a,uiConfId:i,extension:t.fileExt,protocol:u});if(""===h)return e._logger.warn("failed to create play url from source, discarding source: (".concat(o,"_").concat(d,"), ").concat(c,".")),null;r.url=h,t.height&&t.width?s.push(r):l.push(r)}))}return l.length&&!s.length?l:s}},{key:"_parseMetadata",value:function(e){var t={};return e&&e.metas&&e.metas.length>0&&e.metas.forEach((function(e){if(e.xml){var r=new DOMParser;e.xml=e.xml.replace(/\r?\n|\r/g,""),e.xml=e.xml.replace(/>\s*/g,">"),e.xml=e.xml.replace(/>\s*/g,">");var n=r.parseFromString(e.xml,"text/xml"),a=V.xmlToJson(n);Object.keys(a.metadata).forEach((function(e){t[e]=a.metadata[e]["#text"]}))}})),t}},{key:"_getBaseProtocol",value:function(){var e=k.get(),t=/^https?:/.exec(e.cdnUrl),r=t?t[0]:document.location.protocol;return"string"==typeof r?r.slice(0,-1):"https"}},{key:"hasBlockAction",value:function(e){return e.playBackContextResult.hasBlockAction()}},{key:"getBlockAction",value:function(e){return e.playBackContextResult.getBlockAction()}},{key:"getErrorMessages",value:function(e){return e.playBackContextResult.getErrorMessages()}}]),e}();h(ne,"_logger",y("OVPProviderParser"));var ae=ne.addKsToUrl,ie=ne,oe=s((function e(t,r,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n(this,e),this.severity=t,this.category=r,this.code=a,this.data=i,e._logger.error("Category:".concat(r," | Code:").concat(a," |"),i)}));h(oe,"Severity",{RECOVERABLE:1,CRITICAL:2}),h(oe,"Category",{NETWORK:1,SERVICE:2,PROVIDER:3}),h(oe,"Code",{UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,BAD_SERVER_RESPONSE:1005,MULTIREQUEST_API_ERROR:1006,API_RESPONSE_MISMATCH:1007,ERROR:2e3,BLOCK_ACTION:2001,MEDIA_STATUS_NOT_READY:2002,MISSING_MANDATORY_PARAMS:3e3,MISSING_PLAY_SOURCE:3001,METHOD_NOT_IMPLEMENTED:3002}),h(oe,"_logger",y("Error"));var se=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map;n(this,e),h(this,"retryConfig",{async:!0,timeout:0,maxAttempts:4}),h(this,"_attemptCounter",1),this.headers=t}return s(e,[{key:"getUrl",value:function(e){return e+"/service/"+this.service+(this.action?"/action/"+this.action:"")}},{key:"doHttpRequest",value:function(){var e=this,t=new Promise((function(t,r){e._requestPromise={resolve:t,reject:r}}));return this.url||this._requestPromise.reject(new oe(oe.Severity.CRITICAL,oe.Category.NETWORK,oe.Code.MALFORMED_DATA_URI,{url:this.url})),this._createXHR(),t}},{key:"_createXHR",value:function(){var e=this,t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState&&200===t.status)try{var r=JSON.parse(t.responseText);return e.responseHeaders=e._getResponseHeaders(t),e._requestPromise.resolve(r)}catch(r){e._requestPromise.reject(e._createError(t,oe.Code.BAD_SERVER_RESPONSE,{text:t.responseText}))}},t.open(this.method,this.url,this.retryConfig.async),this.retryConfig.async&&this.retryConfig.timeout&&(t.timeout=this.retryConfig.timeout);var r=performance.now();t.ontimeout=function(){e._handleError(t,oe.Code.TIMEOUT,{timeout:(performance.now()-r)/1e3,statusText:t.statusText})},t.onerror=t.onabort=function(){e._handleError(t,oe.Code.HTTP_ERROR,{text:t.responseText,statusText:t.statusText})},this.headers.forEach((function(e,r){t.setRequestHeader(r,e)})),t.send(this.params)}},{key:"_getResponseHeaders",value:function(e){return e.getAllResponseHeaders().split("\n").filter((function(e){return 0===e.toLowerCase().indexOf("x-")}))}},{key:"_handleError",value:function(e,t,r){var n=this._createError(e,t,r);if(e.onreadystatechange=function(){},e.onerror=function(){},e.ontimeout=function(){},e.onabort=function(){},!(this.retryConfig.maxAttempts&&this._attemptCounter<this.retryConfig.maxAttempts))return this._requestPromise.reject(n);this._attemptCounter++,this._createXHR()}},{key:"_createError",value:function(e,t,r){return Object.assign(r,{url:this.url,headers:this._getResponseHeaders(e),attempt:this._attemptCounter}),new oe(oe.Severity.CRITICAL,oe.Category.NETWORK,t,r)}}]),e}(),le=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(){var e;n(this,i);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return h(l(e=a.call.apply(a,[this].concat(r))),"requests",[]),e}return s(i,[{key:"add",value:function(e){this.requests.push(e);var t={},r={service:e.service,action:e.action};return Object.assign(t,h({},this.requests.length,Object.assign(r,e.params))),Object.assign(t,this.params),this.params=t,this}},{key:"execute",value:function(e){var t=this;return new Promise((function(r,n){try{t.params=JSON.stringify(t.params)}catch(e){i._logger.error("".concat(e.message)),n(new oe(oe.Severity.CRITICAL,oe.Category.PROVIDER,oe.Code.FAILED_PARSING_REQUEST,{error:e,params:t.params}))}t.doHttpRequest().then((function(a){var i=new ue(a,e);i.success?r({headers:t.responseHeaders,response:i}):n(new oe(oe.Severity.CRITICAL,oe.Category.NETWORK,oe.Code.MULTIREQUEST_API_ERROR,{url:t.url,headers:t.responseHeaders,results:i.results}))}),(function(e){n(e)}))}))}}]),i}(se);h(le,"_logger",y("MultiRequestBuilder"));var ue=s((function e(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n(this,e),h(this,"results",[]);var a=t.result?t.result:t,i=(Array.isArray(a)?a:[a]).map((function(e){return new E(e)})),o=i.filter((function(e){return e.hasError}));o.forEach((function(t){e._logger.error("Service returned an error with error code: ".concat(t.error.code," and message: ").concat(t.error.message,"."))})),this.results=i,r&&o.length||o.length===this.results.length?this.success=!1:(this.results=this.results.filter((function(e){return!e.hasError})),this.success=!0)}));h(ue,"_logger",y("MultiRequestResult"));var ce=function(){function e(){n(this,e)}return s(e,null,[{key:"getMultiRequest",value:function(e,t,r){var n=k.get(),a=n.serviceParams;Object.assign(a,{ks:t,clientTag:"html5:v"+e}),r&&Object.assign(a,{partnerId:r});var i=new Map;i.set("Content-Type","application/json");var o=new le(i);return o.method="POST",o.service="multirequest",o.url=o.getUrl(n.serviceUrl),o.params=a,o}}]),e}(),de=s((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.type=t.type||e.Type.INCLUDE_FIELDS,this.fields=t.fields||"id,referenceId,name,description,thumbnailUrl,dataUrl,duration,msDuration,flavorParamsIds,mediaType,type,tags,dvrStatus,externalSourceType,status,createdAt,updatedAt,endDate,plays,views,downloadUrl,creatorId"}));h(de,"Type",{INCLUDE_FIELDS:1,EXCLUDE_FIELDS:2});var pe="baseEntry",he=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(){return n(this,i),a.apply(this,arguments)}return s(i,null,[{key:"getPlaybackContext",value:function(e,t,r,n){var a=new Map;a.set("Content-Type","application/json");var i=new se(a);i.service=pe,i.action="getPlaybackContext",i.method="POST",i.url=i.getUrl(e),i.tag="baseEntry-getPlaybackContext";var o={objectType:"KalturaContextDataParams",flavorTags:"all"};return n&&(o.referrer=n),i.params={entryId:r,ks:t,contextDataParams:o},i}},{key:"list",value:function(e,t,r,n,a){var o=new Map;o.set("Content-Type","application/json");var s=new se(o);return s.service=pe,s.action="list",s.method="POST",s.url=s.getUrl(e),s.tag="list",s.params=i.getEntryListReqParams(r,t,n,a),s}},{key:"getEntryListReqParams",value:function(e,t,r,n){var a={};return e?a=r?{redirectFromEntryId:e}:{idEqual:e}:n&&(a={objectType:"KalturaBaseEntryFilter",referenceIdEqual:n}),{ks:t,filter:a,responseProfile:new de}}}]),i}(ce),fe=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(){return n(this,i),a.apply(this,arguments)}return s(i,null,[{key:"list",value:function(e,t,r){var n=new Map;n.set("Content-Type","application/json");var a=new se(n);a.service="metadata_metadata",a.action="list",a.method="POST",a.url=a.getUrl(e),a.tag="metadata_metadata-list";var i={objectType:"KalturaMetadataFilter",objectIdEqual:r,metadataObjectTypeEqual:"1"};return a.params={filter:i,ks:t},a}}]),i}(ce),me=function(){function e(t){n(this,e),h(this,"_response",{}),this.requests=this.buildRequests(t),this._entryId=t.entryId,this._referenceId=t.referenceId}return s(e,[{key:"requests",get:function(){return this._requests},set:function(e){this._requests=e}},{key:"response",get:function(){return this._response},set:function(e){var t=new A(e[0].data);this._response.entry=t.entries[0],this._response.playBackContextResult=new L(e[1].data),this._response.metadataListResult=new D(e[2].data)}},{key:"buildRequests",value:function(e){var t=k.get(),r=[];r.push(he.list(t.serviceUrl,e.ks,e.entryId,e.redirectFromEntryId,e.referenceId));var n="{1:result:ks}"===e.ks?"{2:result:objects:0:id}":"{1:result:objects:0:id}";return r.push(he.getPlaybackContext(t.serviceUrl,e.ks,n,e.referrer)),r.push(fe.list(t.serviceUrl,e.ks,n)),r}},{key:"isValid",value:function(){return!(!this._entryId&&!this._referenceId)}}],[{key:"id",get:function(){return"media"}}]),e}(),ge=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(){return n(this,i),a.apply(this,arguments)}return s(i,null,[{key:"anonymousSession",value:function(e,t){var r=new Map;r.set("Content-Type","application/json");var n=new se(r);return n.service="session",n.action="startWidgetSession",n.method="POST",n.url=n.getUrl(e),n.tag="session-startWidget",n.params={widgetId:t},n}}]),i}(ce),ye=function(){function e(t){n(this,e),h(this,"_response",{}),this.requests=this.buildRequests(t),this._widgetId=t.widgetId}return s(e,[{key:"requests",get:function(){return this._requests},set:function(e){this._requests=e}},{key:"response",get:function(){return this._response.ks},set:function(e){this._response.ks=e[0].data.ks}},{key:"buildRequests",value:function(e){var t=k.get(),r=[];return r.push(ge.anonymousSession(t.serviceUrl,e.widgetId)),r}},{key:"isValid",value:function(){return!!this._widgetId}}],[{key:"id",get:function(){return"session"}}]),e}(),ve=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(e,t){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3?arguments[3]:void 0;return n(this,i),(r=a.call(this,s))._multiRequest=ce.getMultiRequest(e,o,t),r}return s(i)}(function(){function e(t){n(this,e),h(this,"_loadersResponseMap",new Map),h(this,"_loaders",new Map),this._networkRetryConfig=t}return s(e,[{key:"add",value:function(e,t,r){var n=this,a=new e(t);if(a.isValid()){this._loaders.set(e.id,a);var i=this._multiRequest.requests.length,o=a.requests;this._multiRequest.retryConfig=this._networkRetryConfig,o.forEach((function(e){e.params=e.params||{},e.params.ks=e.params.ks||r,n._multiRequest.add(e)}));var s=Array.from(new Array(o.length),(function(e,t){return t+i}));this._loadersResponseMap.set(e.id,s)}}},{key:"fetchData",value:function(e){var t=this;return new Promise((function(r,n){t._multiRequest.execute(e).then((function(e){t._multiResponse=e.response,t.prepareData(e.response).success?r(t._loaders):n(new oe(oe.Severity.CRITICAL,oe.Category.NETWORK,oe.Code.API_RESPONSE_MISMATCH,{headers:e.headers}))}),(function(e){n(e)}))}))}},{key:"prepareData",value:function(e){var t=this;return this._loaders.forEach((function(r,n){var a=t._loadersResponseMap.get(n);try{a&&a.length>0&&(r.response=e.results.slice(a[0],a[a.length-1]+1))}catch(e){return{success:!1,error:e}}})),{success:!0,data:this._loaders}}}]),e}()),_e="playlist",ke=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(){return n(this,i),a.apply(this,arguments)}return s(i,null,[{key:"execute",value:function(e,t,r){var n=new Map;n.set("Content-Type","application/json");var a=new se(n);return a.service=_e,a.action="execute",a.method="POST",a.url=a.getUrl(e),a.tag="".concat(_e,"-execute"),a.params={ks:t,id:r,responseProfile:new de},a}},{key:"get",value:function(e,t,r){var n=new Map;n.set("Content-Type","application/json");var a=new se(n);return a.service=_e,a.action="get",a.method="POST",a.url=a.getUrl(e),a.tag="".concat(_e,"-get"),a.params={ks:t,id:r,responseProfile:{fields:"id,name,description,thumbnailUrl",type:1}},a}},{key:"getLastEntryId",value:function(e,t,r){var n=new Map;n.set("Content-Type","application/json");var a=new se(n);return a.service="userEntry",a.action="list",a.method="POST",a.url=a.getUrl(e),a.tag="userEntry-list",a.params={ks:t,filter:{objectType:"KalturaViewHistoryUserEntry",entryIdEqual:r,userIdEqualCurrent:1},responseProfile:{fields:"playlistLastEntryId",type:1}},a}}]),i}(ce),Ee=function(){function e(t){n(this,e),h(this,"_response",{}),this.requests=this.buildRequests(t),this._playlistId=t.playlistId}return s(e,[{key:"requests",get:function(){return this._requests},set:function(e){this._requests=e}},{key:"response",get:function(){return this._response},set:function(e){this._response.playlistData=new N(e[0].data),this._response.playlistItems=new M(e[1].data),this._response.playlistUserEntries=new B(e[2].data)}},{key:"buildRequests",value:function(e){var t=k.get(),r=[];return r.push(ke.get(t.serviceUrl,e.ks,e.playlistId)),r.push(ke.execute(t.serviceUrl,e.ks,e.playlistId)),r.push(ke.getLastEntryId(t.serviceUrl,e.ks,e.playlistId)),r}},{key:"isValid",value:function(){return!!this._playlistId}}],[{key:"id",get:function(){return"playlist"}}]),e}(),be=function(){function e(t,r){n(this,e),h(this,"_networkRetryConfig",{async:!0,timeout:0,maxAttempts:4}),function(e){e&&"function"==typeof e.getLogger&&(f.get=e.getLogger),e&&e.LogLevel&&(m=e.LogLevel)}(t.logger),this._partnerId=t.partnerId,this._widgetId=t.widgetId,this._uiConfId=t.uiConfId,this._isAnonymous=!t.ks,this._ks=t.ks||"",this._playerVersion=r,this._referrer=t.referrer}return s(e,[{key:"partnerId",get:function(){return this._partnerId}},{key:"widgetId",get:function(){return this._widgetId||this.defaultWidgetId}},{key:"defaultWidgetId",get:function(){return"_"+this._partnerId}},{key:"uiConfId",get:function(){return this._uiConfId}},{key:"ks",get:function(){return this._ks},set:function(e){this._ks=e}},{key:"playerVersion",get:function(){return this._playerVersion}},{key:"isAnonymous",get:function(){return this._isAnonymous}},{key:"getMediaConfig",value:function(e){return Promise.reject(new oe(oe.Severity.CRITICAL,oe.Category.PROVIDER,oe.Code.METHOD_NOT_IMPLEMENTED,{message:"getMediaConfig method must be implement by the derived class"}))}},{key:"getPlaylistConfig",value:function(e){return Promise.reject(new oe(oe.Severity.CRITICAL,oe.Category.PROVIDER,oe.Code.METHOD_NOT_IMPLEMENTED,{message:"The provider does not support loading playlist by id"}))}},{key:"getEntryListConfig",value:function(e){return Promise.reject(new oe(oe.Severity.CRITICAL,oe.Category.PROVIDER,oe.Code.METHOD_NOT_IMPLEMENTED,{message:"The provider does not support loading entry list"}))}},{key:"_verifyHasSources",value:function(e){if(0===e.hls.concat(e.dash,e.progressive,e.image,e.document).length)throw new oe(oe.Severity.CRITICAL,oe.Category.SERVICE,oe.Code.MISSING_PLAY_SOURCE,{action:"",messages:"No play source for entry id: ".concat(e.id)})}},{key:"LogLevel",get:function(){return m}},{key:"getLogLevel",value:function(e){return function(e){return g(e).getLevel()}(e)}},{key:"setLogLevel",value:function(e,t){!function(e,t){g(t).setLevel(e)}(e,t)}}]),e}(),Te=function(){function e(t){n(this,e),h(this,"_response",{playlistItems:{entries:[]}}),this.requests=this.buildRequests(t),this._entries=t.entries}return s(e,[{key:"requests",get:function(){return this._requests},set:function(e){this._requests=e}},{key:"response",get:function(){return this._response},set:function(e){var t,r=this;e.forEach((function(e){t=new A(e.data),r._response.playlistItems.entries.push(t.entries[0])}))}},{key:"buildRequests",value:function(e){var t=k.get(),r=[];return e.entries.forEach((function(n){r.push(he.list(t.serviceUrl,e.ks,n.entryId||n,e.redirectFromEntryId,n.referenceId))})),r}},{key:"isValid",value:function(){return!(!this._entries||!this._entries.length)}}],[{key:"id",get:function(){return"entry_list"}}]),e}();function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Se(e){return function(e){if(Array.isArray(e))return Ae(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ae(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ce=function(){function e(){n(this,e)}return s(e,null,[{key:"_applyRegexAction",value:function(e,t){if(e){var r=new RegExp(e.pattern,"i");if(t.match(r))return t.replace(r,e.replacement+"/")}return t}},{key:"_pingECDNAndReplaceHostUrls",value:function(t,r,n){return new Promise((function(a){var i=n+"/api_v3/service/system/action/ping/format/1",o=new XMLHttpRequest;o.open("GET",i),o.timeout=r.checkAliveTimeoutMs,o.onreadystatechange=function(){4===o.readyState&&(200===o.status&&e._replaceHostUrls(t,r),a(t))},o.ontimeout=function(){e._logger.warn("Got timeout while pinging the ECDN url. the ping url: ".concat(i)),a(t)},o.send()}))}},{key:"handleRegexAction",value:function(t,r){return new Promise((function(n){var a=k.get().cdnUrl,i=e._extractRegexActionFromData(r),o=e._getRegExp(i);a&&i&&o&&a.match(o)?i.checkAliveTimeoutMs>0?(e._logger.debug("executing ping request..."),e._pingECDNAndReplaceHostUrls(t,i,a.replace(o,i.replacement)).then(n)):(e._replaceHostUrls(t,i),n(t)):(e._logger.debug("exiting handleRegexAction - not applying regex action."),n(t))}))}},{key:"_replaceHostUrls",value:function(t,r){e._logger.debug("Starting to modify urls...");var n=t.sources,a=n.hls,i=n.dash,o=n.progressive,s=n.image;[].concat(Se(a),Se(i),Se(o),Se(s)).forEach((function(t){return t.url=e._applyRegexAction(r,t.url)})),k.get().replaceHostOnlyManifestUrls||(e._logger.debug("replaceHostOnlyManifestUrls flag is off - modifying captions and poster URLs"),n.captions&&n.captions.forEach((function(t){return t.url=e._applyRegexAction(r,t.url)})),"string"==typeof n.poster&&(n.poster=e._applyRegexAction(r,n.poster))),e._logger.debug("Finished modifying urls")}},{key:"_extractRegexActionFromData",value:function(e){var t;return null===(t=e.get(me.id))||void 0===t||null===(t=t.response)||void 0===t?void 0:t.playBackContextResult.getRequestHostRegexAction()}},{key:"_getRegExp",value:function(e){if(e&&e.pattern&&e.replacement)return new RegExp(e.pattern,"i")}}]),e}();h(Ce,"_logger",y("RegexActionHandler"));var Pe=Ce,xe=function(e){c(i,e);var t,r,a=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=p(t);if(r){var a=p(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return d(this,e)});function i(e,t){var r;return n(this,i),h(l(r=a.call(this,e,t)),"_filterOptionsConfig",{redirectFromEntryId:!0}),r._logger=y("OVPProvider"),k.set(e.env),r._setFilterOptionsConfig(e.filterOptions),r._networkRetryConfig=Object.assign(r._networkRetryConfig,e.networkRetryParameters),r}return s(i,[{key:"env",get:function(){return k.get()}},{key:"getMediaConfig",value:function(e){var t=this;return e.ks&&(this.ks=e.ks,this._isAnonymous=!1),this.widgetId!==this.defaultWidgetId&&(this._isAnonymous=!1),this._dataLoader=new ve(this.playerVersion,this.partnerId,this.ks,this._networkRetryConfig),new Promise((function(r,n){var a=e.entryId,i=e.referenceId;if(a||i){var o=t.ks;o||(o="{1:result:ks}",t._dataLoader.add(ye,{widgetId:t.widgetId}));var s=t._getEntryRedirectFilter(e);return t._dataLoader.add(me,{entryId:a,ks:o,redirectFromEntryId:s,referenceId:i,referrer:t._referrer}),t._dataLoader.fetchData().then((function(e){try{var a=t._parseDataFromResponse(e);Pe.handleRegexAction(a,e).then(r)}catch(e){n(e)}}),(function(e){n(e)}))}n(new oe(oe.Severity.CRITICAL,oe.Category.PROVIDER,oe.Code.MISSING_MANDATORY_PARAMS,{message:"missing entry id"}))}))}},{key:"doRequest",value:function(e,t,r){var n=this,a=t||this.ks,i=new ve(this.playerVersion,this.partnerId,a,this._networkRetryConfig);return new Promise((function(t,o){return a||i.add(ye,{widgetId:n.widgetId}),e.forEach((function(e){i.add(e.loader,e.params,a||"{1:result:ks}")})),i.fetchData(r).then((function(e){try{t(e)}catch(e){o(e)}}),(function(e){o(e)}))}))}},{key:"_getEntryRedirectFilter",value:function(e){return"boolean"==typeof e.redirectFromEntryId?e.redirectFromEntryId:"boolean"!=typeof this._filterOptionsConfig.redirectFromEntryId||this._filterOptionsConfig.redirectFromEntryId}},{key:"_setFilterOptionsConfig",value:function(e){e&&"boolean"==typeof e.redirectFromEntryId&&(this._filterOptionsConfig.redirectFromEntryId=e.redirectFromEntryId)}},{key:"_parseDataFromResponse",value:function(e){this._logger.debug("Data parsing started");var t={session:{isAnonymous:this._isAnonymous,partnerId:this.partnerId},sources:this._getDefaultSourcesObject(),plugins:{}};if(this.uiConfId&&(t.session.uiConfId=this.uiConfId),e){if(e.has(ye.id)){var r=e.get(ye.id);r&&r.response&&(t.session.ks=r.response,this.widgetId!==this.defaultWidgetId&&(this.ks=t.session.ks))}else t.session.ks=this.ks;if(e.has(me.id)){var n=e.get(me.id);if(n&&n.response){var a=n.response;if(ie.hasBlockAction(a))throw new oe(oe.Severity.CRITICAL,oe.Category.SERVICE,oe.Code.BLOCK_ACTION,{action:ie.getBlockAction(a),messages:ie.getErrorMessages(a)});var i=ie.getMediaEntry(this.isAnonymous?"":this.ks,this.partnerId,this.uiConfId,a);Object.assign(t.sources,this._getSourcesObject(i)),this._verifyMediaStatus(i),this._verifyHasSources(t.sources);var o=ie.getBumper(a,this.isAnonymous?"":this.ks,this.partnerId);o&&Object.assign(t.plugins,{bumper:o})}}}return this._logger.debug("Data parsing finished",t),t}},{key:"_verifyMediaStatus",value:function(e){if([T.EntryStatus.IMPORT,T.EntryStatus.PRECONVERT].includes(e.status))throw new oe(oe.Severity.CRITICAL,oe.Category.SERVICE,oe.Code.MEDIA_STATUS_NOT_READY,{messages:"Status of entry id ".concat(e.id," is ").concat(e.status," and is still being imported or converted"),data:{status}})}},{key:"getPlaylistConfig",value:function(e){var t=this;return e.ks&&(this.ks=e.ks,this._isAnonymous=!1),this.widgetId!==this.defaultWidgetId&&(this._isAnonymous=!1),this._dataLoader=new ve(this.playerVersion,this.partnerId,this.ks,this._networkRetryConfig),new Promise((function(r,n){var a=e.playlistId;if(a){var i=t.ks;i||(i="{1:result:ks}",t._dataLoader.add(ye,{widgetId:t.widgetId})),t._dataLoader.add(Ee,{playlistId:a,ks:i}),t._dataLoader.fetchData().then((function(e){r(t._parsePlaylistDataFromResponse(e))}),(function(e){n(e)}))}else n({success:!1,data:"Missing mandatory parameter"})}))}},{key:"_parsePlaylistDataFromResponse",value:function(e){var t=this;this._logger.debug("Data parsing started");var r=this._getPlaylistObject();if(e&&e.has(Ee.id)){var n=e.get(Ee.id);if(n&&n.response){var a=ie.getPlaylist(n.response);r.id=a.id,r.poster=a.poster,r.metadata.name=a.name,r.metadata.description=a.description,r.playlistLastEntryId=a.playlistLastEntryId,a.items.forEach((function(e){return r.items.push({sources:t._getSourcesObject(e)})}))}}return this._logger.debug("Data parsing finished",r),r}},{key:"getEntryListConfig",value:function(e){var t=this;return e.ks&&(this.ks=e.ks,this._isAnonymous=!1),this.widgetId!==this.defaultWidgetId&&(this._isAnonymous=!1),this._dataLoader=new ve(this.playerVersion,this.partnerId,this.ks,this._networkRetryConfig),new Promise((function(r,n){var a=e.entries;if(a&&a.length){var i=t.ks;i||(i="{1:result:ks}",t._dataLoader.add(ye,{widgetId:t.widgetId}));var o=t._getEntryRedirectFilter(e);t._dataLoader.add(Te,{entries:a,ks:i,redirectFromEntryId:o}),t._dataLoader.fetchData(!1).then((function(e){r(t._parseEntryListDataFromResponse(e))}),(function(e){n(e)}))}else n({success:!1,data:"Missing mandatory parameter"})}))}},{key:"_parseEntryListDataFromResponse",value:function(e){var t=this;this._logger.debug("Data parsing started");var r=this._getPlaylistObject();if(e&&e.has(Te.id)){var n=e.get(Te.id);n&&n.response&&ie.getEntryList(n.response).items.forEach((function(e){return r.items.push({sources:t._getSourcesObject(e)})}))}return this._logger.debug("Data parsing finished",r),r}},{key:"_getPlaylistObject",value:function(){return{id:"",metadata:{name:"",description:""},poster:"",playlistLastEntryId:"",items:[]}}},{key:"_getDefaultSourcesObject",value:function(){return{hls:[],dash:[],progressive:[],image:[],document:[],id:"",duration:0,type:W.Type.UNKNOWN,poster:"",dvr:!1,vr:null,metadata:{name:"",description:"",tags:""}}}},{key:"_getSourcesObject",value:function(e){var t=this._getDefaultSourcesObject(),r=e.sources.toJSON();return t.hls=r.hls,t.dash=r.dash,t.progressive=r.progressive,t.image=r.image,t.document=r.document,t.id=e.id,t.duration=e.duration,t.type=e.type,t.dvr=!!e.dvrStatus,t.poster=e.poster,t.downloadUrl=e.downloadUrl,e.sources.captions&&(t.captions=e.sources.captions),e.metadata&&"string"==typeof e.metadata.tags&&e.metadata.tags.split(", ").includes("360")&&(t.vr={}),Object.assign(t.metadata,e.metadata),t}}]),i}(be),we="@playkit-js/playkit-js-providers-ovp",Ie="2.40.7";return t}()},352:module=>{"use strict";module.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(n)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(o[l]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);n&&o[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),r&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=r):c[2]=r),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},864:module=>{"use strict";module.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(a," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},718:module=>{!function e(t){var r;r=function(){"use strict";function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){var r,i,o;r=e,i=t,o=n[t],(i=a(i))in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(this,arguments)}function l(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,c(e,t)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function d(e,t,r){return d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&c(a,r.prototype),a},d.apply(null,arguments)}function p(e){var t="function"==typeof Map?new Map:void 0;return p=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return d(e,arguments,u(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),c(r,e)},p(e)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var f={exports:{}};!function(e,t){var r,n,a,i,o;r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,i=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var a=o.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");return a.path=o.normalizePath(a.path),o.buildURLFromParts(a)}var i=o.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=o.normalizePath(i.path),o.buildURLFromParts(i)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=n.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(u.netLoc=s.netLoc,"/"!==i.path[0]))if(i.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+i.path;u.path=o.normalizePath(d)}else u.path=s.path,i.params||(u.params=s.params,i.query||(u.query=s.query));return null===u.path&&(u.path=r.alwaysNormalize?o.normalizePath(i.path):i.path),o.buildURLFromParts(u)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(i,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o}(f);var m=f.exports,g=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},y=Number.isSafeInteger||function(e){return"number"==typeof e&&Math.abs(e)<=v},v=Number.MAX_SAFE_INTEGER||9007199254740991,_=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",e}({}),k=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),E=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown",e}({}),b=function(){},T={trace:b,debug:b,log:b,warn:b,info:b,error:b},A=T;function S(e,t){if("object"==typeof console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach((function(t){A[t]=e[t]?e[t].bind(e):function(e){var t=self.console[e];return t?t.bind(self.console,"["+e+"] >"):b}(t)}))}(e,"debug","log","info","warn","error");try{A.log('Debug logs enabled for "'+t+'" in hls.js version 1.5.8')}catch(e){A=T}}else A=T}var C=A,P=/^(\d+)x(\d+)$/,x=/(.+?)=(".*?"|.*?)(?:,|$)/g,w=function(){function e(t){"string"==typeof t&&(t=e.parseAttrList(t)),s(this,t)}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.optionalFloat=function(e,t){var r=this[e];return r?parseFloat(r):t},t.enumeratedString=function(e){return this[e]},t.bool=function(e){return"YES"===this[e]},t.decimalResolution=function(e){var t=P.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,r={};for(x.lastIndex=0;null!==(t=x.exec(e));){var n=t[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),r[t[1].trim()]=n}return r},o(e,[{key:"clientAttrs",get:function(){return Object.keys(this).filter((function(e){return"X-"===e.substring(0,2)}))}}]),e}();function I(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e}var M=function(){function e(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){var r=t.attr;for(var n in r)if(Object.prototype.hasOwnProperty.call(e,n)&&e[n]!==r[n]){C.warn('DATERANGE tag attribute: "'+n+'" does not match for tags with ID: "'+e.ID+'"'),this._badValueForSameId=n;break}e=s(new w({}),r,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){var a=new Date(this.attr["END-DATE"]);g(a.getTime())&&(this._endDate=a)}}return o(e,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}},{key:"duration",get:function(){if("DURATION"in this.attr){var e=this.attr.decimalFloatingPoint("DURATION");if(g(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}},{key:"endOnNext",get:function(){return this.attr.bool("END-ON-NEXT")}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&g(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),e}(),R=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}},D="audio",O="video",L="audiovideo",N=function(){function e(e){var t;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((t={})[D]=null,t[O]=null,t[L]=null,t),this.baseurl=e}return e.prototype.setByteRange=function(e,t){var r,n=e.split("@",2);r=1===n.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(n[1]),this._byteRange=[r,parseInt(n[0])+r]},o(e,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=m.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}]),e}(),U=function(e){function t(t,r){var n;return(n=e.call(this,r)||this)._decryptdata=null,n.rawProgramDateTime=null,n.programDateTime=null,n.tagList=[],n.duration=0,n.sn=0,n.levelkeys=void 0,n.type=void 0,n.loader=null,n.keyLoader=null,n.level=-1,n.cc=0,n.startPTS=void 0,n.endPTS=void 0,n.startDTS=void 0,n.endDTS=void 0,n.start=0,n.deltaPTS=void 0,n.maxStartPTS=void 0,n.minEndPTS=void 0,n.stats=new R,n.data=void 0,n.bitrateTest=!1,n.title=null,n.initSegment=null,n.endList=void 0,n.gap=void 0,n.urlId=0,n.type=t,n}l(t,e);var r=t.prototype;return r.setKeyFormat=function(e){if(this.levelkeys){var t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}},r.abortRequests=function(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()},r.setElementaryStreamInfo=function(e,t,r,n,a,i){void 0===i&&(i=!1);var o=this.elementaryStreams,s=o[e];s?(s.startPTS=Math.min(s.startPTS,t),s.endPTS=Math.max(s.endPTS,r),s.startDTS=Math.min(s.startDTS,n),s.endDTS=Math.max(s.endDTS,a)):o[e]={startPTS:t,endPTS:r,startDTS:n,endDTS:a,partial:i}},r.clearElementaryStreamInfo=function(){var e=this.elementaryStreams;e[D]=null,e[O]=null,e[L]=null},o(t,[{key:"decryptdata",get:function(){if(!this.levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{var t=Object.keys(this.levelkeys);if(1===t.length)return this._decryptdata=this.levelkeys[t[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!g(this.programDateTime))return null;var e=g(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){var t=Object.keys(this.levelkeys),r=t.length;if(r>1||1===r&&this.levelkeys[t[0]].encrypted)return!0}return!1}}]),t}(N),j=function(e){function t(t,r,n,a,i){var o;(o=e.call(this,n)||this).fragOffset=0,o.duration=0,o.gap=!1,o.independent=!1,o.relurl=void 0,o.fragment=void 0,o.index=void 0,o.stats=new R,o.duration=t.decimalFloatingPoint("DURATION"),o.gap=t.bool("GAP"),o.independent=t.bool("INDEPENDENT"),o.relurl=t.enumeratedString("URI"),o.fragment=r,o.index=a;var s=t.enumeratedString("BYTERANGE");return s&&o.setByteRange(s,i),i&&(o.fragOffset=i.fragOffset+i.duration),o}return l(t,e),o(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}]),t}(N),B=function(){function e(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}return e.prototype.reloaded=function(e){if(!e)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&r>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay},o(e,[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&g(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),e}();function F(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}function V(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(function(e){return e.charCodeAt(0)}))}var H="undefined"!=typeof self?self:void 0,G={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},$="org.w3.clearkey",K="com.apple.streamingkeydelivery",W="com.microsoft.playready",z="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function q(e){switch(e){case K:return G.FAIRPLAY;case W:return G.PLAYREADY;case z:return G.WIDEVINE;case $:return G.CLEARKEY}}var Y="edef8ba979d64acea3c827dcd51d21ed";function X(e){switch(e){case G.FAIRPLAY:return K;case G.PLAYREADY:return W;case G.WIDEVINE:return z;case G.CLEARKEY:return $}}function Z(e){var t=e.drmSystems,r=e.widevineLicenseUrl,n=t?[G.FAIRPLAY,G.WIDEVINE,G.PLAYREADY,G.CLEARKEY].filter((function(e){return!!t[e]})):[];return!n[G.WIDEVINE]&&r&&n.push(G.WIDEVINE),n}var Q,J=null!=H&&null!=(Q=H.navigator)&&Q.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function ee(e,t,r){return Uint8Array.prototype.slice?e.slice(t,r):new Uint8Array(Array.prototype.slice.call(e,t,r))}var te,re=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},ne=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},ae=function(e,t){for(var r=t,n=0;re(e,t);)n+=10,n+=ie(e,t+6),ne(e,t+10)&&(n+=10),t+=n;if(n>0)return e.subarray(r,r+n)},ie=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,(r|=(127&e[t+2])<<7)|127&e[t+3]},oe=function(e,t){return re(e,t)&&ie(e,t+6)+10<=e.length-t},se=function(e){for(var t=ce(e),r=0;r<t.length;r++){var n=t[r];if(le(n))return me(n)}},le=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},ue=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),r=ie(e,4);return{type:t,size:r,data:e.subarray(10,10+r)}},ce=function(e){for(var t=0,r=[];re(e,t);){for(var n=ie(e,t+6),a=(t+=10)+n;t+8<a;){var i=ue(e.subarray(t)),o=de(i);o&&r.push(o),t+=i.size+10}ne(e,t)&&(t+=10)}return r},de=function(e){return"PRIV"===e.type?pe(e):"W"===e.type[0]?fe(e):he(e)},pe=function(e){if(!(e.size<2)){var t=ge(e.data,!0),r=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:r.buffer}}},he=function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,r=ge(e.data.subarray(t),!0);t+=r.length+1;var n=ge(e.data.subarray(t));return{key:e.type,info:r,data:n}}var a=ge(e.data.subarray(1));return{key:e.type,data:a}}},fe=function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,r=ge(e.data.subarray(t),!0);t+=r.length+1;var n=ge(e.data.subarray(t));return{key:e.type,info:r,data:n}}var a=ge(e.data);return{key:e.type,data:a}},me=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}},ge=function(e,t){void 0===t&&(t=!1);var r=function(){if(!navigator.userAgent.includes("PlayStation 4"))return te||void 0===self.TextDecoder||(te=new self.TextDecoder("utf-8")),te}();if(r){var n=r.decode(e);if(t){var a=n.indexOf("\0");return-1!==a?n.substring(0,a):n}return n.replace(/\0/g,"")}for(var i,o,s,l=e.length,u="",c=0;c<l;){if(0===(i=e[c++])&&t)return u;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(i);break;case 12:case 13:o=e[c++],u+=String.fromCharCode((31&i)<<6|63&o);break;case 14:o=e[c++],s=e[c++],u+=String.fromCharCode((15&i)<<12|(63&o)<<6|(63&s)<<0)}}return u};var ye=function(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);n.length<2&&(n="0"+n),t+=n}return t},ve=Math.pow(2,32)-1,_e=[].push,ke={video:1,audio:2,id3:3,text:4};function Ee(e){return String.fromCharCode.apply(null,e)}function be(e,t){var r=e[t]<<8|e[t+1];return r<0?65536+r:r}function Te(e,t){var r=Se(e,t);return r<0?4294967296+r:r}function Ae(e,t){var r=Te(e,t);return(r*=Math.pow(2,32))+Te(e,t+4)}function Se(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function Ce(e,t,r){e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}function Pe(e,t){var r=[];if(!t.length)return r;for(var n=e.byteLength,a=0;a<n;){var i=Te(e,a),o=i>1?a+i:n;if(Ee(e.subarray(a+4,a+8))===t[0])if(1===t.length)r.push(e.subarray(a+8,o));else{var s=Pe(e.subarray(a+8,o),t.slice(1));s.length&&_e.apply(r,s)}a=o}return r}function xe(e){var t=[],r=e[0],n=8,a=Te(e,n);n+=4;var i=0,o=0;0===r?(i=Te(e,n),o=Te(e,n+4),n+=8):(i=Ae(e,n),o=Ae(e,n+8),n+=16),n+=2;var s=e.length+o,l=be(e,n);n+=2;for(var u=0;u<l;u++){var c=n,d=Te(e,c);c+=4;var p=2147483647&d;if(1==(2147483648&d)>>>31)return C.warn("SIDX has hierarchical references (not supported)"),null;var h=Te(e,c);c+=4,t.push({referenceSize:p,subsegmentDuration:h,info:{duration:h/a,start:s,end:s+p-1}}),s+=p,n=c+=4}return{earliestPresentationTime:i,timescale:a,version:r,referencesCount:l,references:t}}function we(e){for(var t=[],r=Pe(e,["moov","trak"]),a=0;a<r.length;a++){var i=r[a],o=Pe(i,["tkhd"])[0];if(o){var s=o[0],l=Te(o,0===s?12:20),u=Pe(i,["mdia","mdhd"])[0];if(u){var c=Te(u,0===(s=u[0])?12:20),d=Pe(i,["mdia","hdlr"])[0];if(d){var p=Ee(d.subarray(8,12)),h={soun:D,vide:O}[p];if(h){var f=Ie(Pe(i,["mdia","minf","stbl","stsd"])[0]);t[l]={timescale:c,type:h},t[h]=n({timescale:c,id:l},f)}}}}}return Pe(e,["moov","mvex","trex"]).forEach((function(e){var r=Te(e,4),n=t[r];n&&(n.default={duration:Te(e,12),flags:Te(e,20)})})),t}function Ie(e){var t=e.subarray(8),r=t.subarray(86),n=Ee(t.subarray(4,8)),a=n,i="enca"===n||"encv"===n;if(i){var o=Pe(t,[n])[0];Pe(o.subarray("enca"===n?28:78),["sinf"]).forEach((function(e){var t=Pe(e,["schm"])[0];if(t){var r=Ee(t.subarray(4,8));if("cbcs"===r||"cenc"===r){var n=Pe(e,["frma"])[0];n&&(a=Ee(n))}}}))}switch(a){case"avc1":case"avc2":case"avc3":case"avc4":var s=Pe(r,["avcC"])[0];a+="."+Re(s[1])+Re(s[2])+Re(s[3]);break;case"mp4a":var l=Pe(t,[n])[0],u=Pe(l.subarray(28),["esds"])[0];if(u&&u.length>12){var c=4;if(3!==u[c++])break;c=Me(u,c),c+=2;var d=u[c++];if(128&d&&(c+=2),64&d&&(c+=u[c++]),4!==u[c++])break;c=Me(u,c);var p=u[c++];if(64!==p)break;if(a+="."+Re(p),c+=12,5!==u[c++])break;c=Me(u,c);var h=u[c++],f=(248&h)>>3;31===f&&(f+=1+((7&h)<<3)+((224&u[c])>>5)),a+="."+f}break;case"hvc1":case"hev1":var m=Pe(r,["hvcC"])[0],g=m[1],y=["","A","B","C"][g>>6],v=31&g,_=Te(m,2),k=(32&g)>>5?"H":"L",E=m[12],b=m.subarray(6,12);a+="."+y+v,a+="."+_.toString(16).toUpperCase(),a+="."+k+E;for(var T="",A=b.length;A--;){var S=b[A];(S||T)&&(T="."+S.toString(16).toUpperCase()+T)}a+=T;break;case"dvh1":case"dvhe":var C=Pe(r,["dvcC"])[0],P=C[2]>>1&127,x=C[2]<<5&32|C[3]>>3&31;a+="."+De(P)+"."+De(x);break;case"vp09":var w=Pe(r,["vpcC"])[0],I=w[4],M=w[5],R=w[6]>>4&15;a+="."+De(I)+"."+De(M)+"."+De(R);break;case"av01":var D=Pe(r,["av1C"])[0],O=D[1]>>>5,L=31&D[1],N=D[2]>>>7?"H":"M",U=(64&D[2])>>6,j=(32&D[2])>>5,B=2===O&&U?j?12:10:U?10:8,F=(16&D[2])>>4,V=(8&D[2])>>3,H=(4&D[2])>>2,G=3&D[2];a+="."+O+"."+De(L)+N+"."+De(B)+"."+F+"."+V+H+G+"."+De(1)+"."+De(1)+"."+De(1)+".0"}return{codec:a,encrypted:i}}function Me(e,t){for(var r=t+5;128&e[t++]&&t<r;);return t}function Re(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function De(e){return(e<10?"0":"")+e}function Oe(e){var t=Pe(e,["schm"])[0];if(t){var r=Ee(t.subarray(4,8));if("cbcs"===r||"cenc"===r)return Pe(e,["schi","tenc"])[0]}return C.error("[eme] missing 'schm' box"),null}function Le(e){var t=Te(e,0),r=8;1&t&&(r+=4),4&t&&(r+=4);for(var n=0,a=Te(e,4),i=0;i<a;i++)256&t&&(n+=Te(e,r),r+=4),512&t&&(r+=4),1024&t&&(r+=4),2048&t&&(r+=4);return n}function Ne(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function Ue(e,t){var r=[],n=t.samples,a=t.timescale,i=t.id,o=!1;return Pe(n,["moof"]).map((function(s){var l=s.byteOffset-8;Pe(s,["traf"]).map((function(s){var u=Pe(s,["tfdt"]).map((function(e){var t=e[0],r=Te(e,4);return 1===t&&(r*=Math.pow(2,32),r+=Te(e,8)),r/a}))[0];return void 0!==u&&(e=u),Pe(s,["tfhd"]).map((function(u){var c=Te(u,4),d=16777215&Te(u,0),p=0,h=0!=(16&d),f=0,m=0!=(32&d),g=8;c===i&&(0!=(1&d)&&(g+=8),0!=(2&d)&&(g+=4),0!=(8&d)&&(p=Te(u,g),g+=4),h&&(f=Te(u,g),g+=4),m&&(g+=4),"video"===t.type&&(o=function(e){if(!e)return!1;var t=e.indexOf("."),r=t<0?e:e.substring(0,t);return"hvc1"===r||"hev1"===r||"dvh1"===r||"dvhe"===r}(t.codec)),Pe(s,["trun"]).map((function(i){var s=i[0],u=16777215&Te(i,0),c=0!=(1&u),d=0,h=0!=(4&u),m=0!=(256&u),g=0,y=0!=(512&u),v=0,_=0!=(1024&u),k=0!=(2048&u),E=0,b=Te(i,4),T=8;c&&(d=Te(i,T),T+=4),h&&(T+=4);for(var A=d+l,S=0;S<b;S++){if(m?(g=Te(i,T),T+=4):g=p,y?(v=Te(i,T),T+=4):v=f,_&&(T+=4),k&&(E=0===s?Te(i,T):Se(i,T),T+=4),t.type===O)for(var C=0;C<v;){var P=Te(n,A);je(o,n[A+=4])&&Be(n.subarray(A,A+P),o?2:1,e+E/a,r),A+=P,C+=P+4}e+=g/a}})))}))}))})),r}function je(e,t){if(e){var r=t>>1&63;return 39===r||40===r}return 6==(31&t)}function Be(e,t,r,n){var a=Fe(e),i=0;i+=t;for(var o=0,s=0,l=0;i<a.length;){o=0;do{if(i>=a.length)break;o+=l=a[i++]}while(255===l);s=0;do{if(i>=a.length)break;s+=l=a[i++]}while(255===l);var u=a.length-i,c=i;if(s<u)i+=s;else if(s>u){C.error("Malformed SEI payload. "+s+" is too small, only "+u+" bytes left to parse.");break}if(4===o){if(181===a[c++]){var d=be(a,c);if(c+=2,49===d){var p=Te(a,c);if(c+=4,1195456820===p){var h=a[c++];if(3===h){var f=a[c++],m=64&f,g=m?2+3*(31&f):0,y=new Uint8Array(g);if(m){y[0]=f;for(var v=1;v<g;v++)y[v]=a[c++]}n.push({type:h,payloadType:o,pts:r,bytes:y})}}}}}else if(5===o&&s>16){for(var _=[],k=0;k<16;k++){var E=a[c++].toString(16);_.push(1==E.length?"0"+E:E),3!==k&&5!==k&&7!==k&&9!==k||_.push("-")}for(var b=s-16,T=new Uint8Array(b),A=0;A<b;A++)T[A]=a[c++];n.push({payloadType:o,pts:r,uuid:_.join(""),userData:ge(T),userDataBytes:T})}}}function Fe(e){for(var t=e.byteLength,r=[],n=1;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(r.push(n+2),n+=2):n++;if(0===r.length)return e;var a=t-r.length,i=new Uint8Array(a),o=0;for(n=0;n<a;o++,n++)o===r[0]&&(o++,r.shift()),i[n]=e[o];return i}var Ve={},He=function(){function e(e,t,r,n,a){void 0===n&&(n=[1]),void 0===a&&(a=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=n,this.iv=a,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}e.clearKeyUriToKeyIdMap=function(){Ve={}};var t=e.prototype;return t.isSupported=function(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case K:case z:case W:case $:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1},t.getDecryptData=function(t){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof t&&("AES-128"!==this.method||this.iv||C.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),t=0);var r=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}(t);return new e(this.method,this.uri,"identity",this.keyFormatVersions,r)}var n=function(e){var t,r,n=e.split(":"),a=null;if("data"===n[0]&&2===n.length){var i=n[1].split(";"),o=i[i.length-1].split(",");if(2===o.length){var s="base64"===o[0],l=o[1];s?(i.splice(-1,1),a=F(l)):(t=V(l).subarray(0,16),(r=new Uint8Array(16)).set(t,16-t.length),a=r)}}return a}(this.uri);if(n)switch(this.keyFormat){case z:this.pssh=n,n.length>=22&&(this.keyId=n.subarray(n.length-22,n.length-6));break;case W:var a=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function(e,t,r){if(16!==e.byteLength)throw new RangeError("Invalid system id");var n,a,i;if(t){n=1,a=new Uint8Array(16*t.length);for(var o=0;o<t.length;o++){var s=t[o];if(16!==s.byteLength)throw new RangeError("Invalid key");a.set(s,16*o)}}else n=0,a=new Uint8Array;n>0?(i=new Uint8Array(4),t.length>0&&new DataView(i.buffer).setUint32(0,t.length,!1)):i=new Uint8Array;var l=new Uint8Array(4);return r&&r.byteLength>0&&new DataView(l.buffer).setUint32(0,r.byteLength,!1),function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var a=r.length,i=8,o=a;o--;)i+=r[o].byteLength;var s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=255&i,s.set(e,4),o=0,i=8;o<a;o++)s.set(r[o],i),i+=r[o].byteLength;return s}([112,115,115,104],new Uint8Array([n,0,0,0]),e,i,a,l,r||new Uint8Array)}(a,null,n);var i=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),o=String.fromCharCode.apply(null,Array.from(i)),s=o.substring(o.indexOf("<"),o.length),l=(new DOMParser).parseFromString(s,"text/xml").getElementsByTagName("KID")[0];if(l){var u=l.childNodes[0]?l.childNodes[0].nodeValue:l.getAttribute("VALUE");if(u){var c=F(u).subarray(0,16);!function(e){var t=function(e,t,r){var n=e[t];e[t]=e[r],e[r]=n};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}(c),this.keyId=c}}break;default:var d=n.subarray(0,16);if(16!==d.length){var p=new Uint8Array(16);p.set(d,16-d.length),d=p}this.keyId=d}if(!this.keyId||16!==this.keyId.byteLength){var h=Ve[this.uri];if(!h){var f=Object.keys(Ve).length%Number.MAX_SAFE_INTEGER;h=new Uint8Array(16),new DataView(h.buffer,12,4).setUint32(0,f),Ve[this.uri]=h}this.keyId=h}return this},e}(),Ge=/\{\$([a-zA-Z0-9-_]+)\}/g;function $e(e){return Ge.test(e)}function Ke(e,t,r){if(null!==e.variableList||e.hasVariableRefs)for(var n=r.length;n--;){var a=r[n],i=t[a];i&&(t[a]=We(e,i))}}function We(e,t){if(null!==e.variableList||e.hasVariableRefs){var r=e.variableList;return t.replace(Ge,(function(t){var n=t.substring(2,t.length-1),a=null==r?void 0:r[n];return void 0===a?(e.playlistParsingError||(e.playlistParsingError=new Error('Missing preceding EXT-X-DEFINE tag for Variable Reference: "'+n+'"')),t):a}))}return t}function ze(e,t,r){var n,a,i=e.variableList;if(i||(e.variableList=i={}),"QUERYPARAM"in t){n=t.QUERYPARAM;try{var o=new self.URL(r).searchParams;if(!o.has(n))throw new Error('"'+n+'" does not match any query parameter in URI: "'+r+'"');a=o.get(n)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error("EXT-X-DEFINE QUERYPARAM: "+t.message))}}else n=t.NAME,a=t.VALUE;n in i?e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE duplicate Variable Name declarations: "'+n+'"')):i[n]=a||""}function qe(e,t,r){var n=t.IMPORT;if(r&&n in r){var a=e.variableList;a||(e.variableList=a={}),a[n]=r[n]}else e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "'+n+'"'))}function Ye(e){if(void 0===e&&(e=!0),"undefined"!=typeof self)return(e||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}var Xe={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Ze(e,t,r){return void 0===r&&(r=!0),!e.split(",").some((function(e){return!Qe(e,t,r)}))}function Qe(e,t,r){var n;void 0===r&&(r=!0);var a=Ye(r);return null!=(n=null==a?void 0:a.isTypeSupported(Je(e,t)))&&n}function Je(e,t){return t+'/mp4;codecs="'+e+'"'}function et(e){if(e){var t=e.substring(0,4);return Xe.video[t]}return 2}function tt(e){return e.split(",").reduce((function(e,t){var r=Xe.video[t];return r?(2*r+e)/(e?3:2):(Xe.audio[t]+e)/(e?2:1)}),0)}var rt={},nt=/flac|opus/i;function at(e,t){return void 0===t&&(t=!0),e.replace(nt,(function(e){return function(e,t){if(void 0===t&&(t=!0),rt[e])return rt[e];for(var r={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[e],n=0;n<r.length;n++)if(Qe(r[n],"audio",t))return rt[e]=r[n],r[n];return e}(e.toLowerCase(),t)}))}function it(e,t){return e&&"mp4a"!==e?e:t?t.split(",")[0]:t}var ot=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,st=/#EXT-X-MEDIA:(.*)/g,lt=/^#EXT(?:INF|-X-TARGETDURATION):/m,ut=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),ct=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),dt=function(){function e(){}return e.findGroup=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.id===t)return n}},e.resolve=function(e,t){return m.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.isMediaPlaylist=function(e){return lt.test(e)},e.parseMasterPlaylist=function(t,r){var n,a={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:$e(t)},i=[];for(ot.lastIndex=0;null!=(n=ot.exec(t));)if(n[1]){var o,s=new w(n[1]);Ke(a,s,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);var l=We(a,n[2]),u={attrs:s,bitrate:s.decimalInteger("BANDWIDTH")||s.decimalInteger("AVERAGE-BANDWIDTH"),name:s.NAME,url:e.resolve(l,r)},c=s.decimalResolution("RESOLUTION");c&&(u.width=c.width,u.height=c.height),ft(s.CODECS,u),null!=(o=u.unknownCodecs)&&o.length||i.push(u),a.levels.push(u)}else if(n[3]){var d=n[3],p=n[4];switch(d){case"SESSION-DATA":var h=new w(p);Ke(a,h,["DATA-ID","LANGUAGE","VALUE","URI"]);var f=h["DATA-ID"];f&&(null===a.sessionData&&(a.sessionData={}),a.sessionData[f]=h);break;case"SESSION-KEY":var m=pt(p,r,a);m.encrypted&&m.isSupported()?(null===a.sessionKeys&&(a.sessionKeys=[]),a.sessionKeys.push(m)):C.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+p+'"');break;case"DEFINE":var g=new w(p);Ke(a,g,["NAME","VALUE","QUERYPARAM"]),ze(a,g,r);break;case"CONTENT-STEERING":var y=new w(p);Ke(a,y,["SERVER-URI","PATHWAY-ID"]),a.contentSteering={uri:e.resolve(y["SERVER-URI"],r),pathwayId:y["PATHWAY-ID"]||"."};break;case"START":a.startTimeOffset=ht(p)}}var v=i.length>0&&i.length<a.levels.length;return a.levels=v?i:a.levels,0===a.levels.length&&(a.playlistParsingError=new Error("no levels found in manifest")),a},e.parseMasterPlaylistMedia=function(t,r,n){var a,i={},o=n.levels,s={AUDIO:o.map((function(e){return{id:e.attrs.AUDIO,audioCodec:e.audioCodec}})),SUBTITLES:o.map((function(e){return{id:e.attrs.SUBTITLES,textCodec:e.textCodec}})),"CLOSED-CAPTIONS":[]},l=0;for(st.lastIndex=0;null!==(a=st.exec(t));){var u=new w(a[1]),c=u.TYPE;if(c){var d=s[c],p=i[c]||[];i[c]=p,Ke(n,u,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);var h=u.LANGUAGE,f=u["ASSOC-LANGUAGE"],m=u.CHANNELS,g=u.CHARACTERISTICS,y=u["INSTREAM-ID"],v={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||h||"",type:c,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:h,url:u.URI?e.resolve(u.URI,r):""};if(f&&(v.assocLang=f),m&&(v.channels=m),g&&(v.characteristics=g),y&&(v.instreamId=y),null!=d&&d.length){var _=e.findGroup(d,v.groupId)||d[0];mt(v,_,"audioCodec"),mt(v,_,"textCodec")}p.push(v)}}return i},e.parseLevelPlaylist=function(e,t,r,n,a,i){var o,l,u,c=new B(t),d=c.fragments,p=null,h=0,f=0,m=0,y=0,v=null,_=new U(n,t),k=-1,E=!1,b=null;for(ut.lastIndex=0,c.m3u8=e,c.hasVariableRefs=$e(e);null!==(o=ut.exec(e));){E&&(E=!1,(_=new U(n,t)).start=m,_.sn=h,_.cc=y,_.level=r,p&&(_.initSegment=p,_.rawProgramDateTime=p.rawProgramDateTime,p.rawProgramDateTime=null,b&&(_.setByteRange(b),b=null)));var T=o[1];if(T){_.duration=parseFloat(T);var A=(" "+o[2]).slice(1);_.title=A||null,_.tagList.push(A?["INF",T,A]:["INF",T])}else if(o[3]){if(g(_.duration)){_.start=m,u&&vt(_,u,c),_.sn=h,_.level=r,_.cc=y,d.push(_);var S=(" "+o[3]).slice(1);_.relurl=We(c,S),gt(_,v),v=_,m+=_.duration,h++,f=0,E=!0}}else if(o[4]){var P=(" "+o[4]).slice(1);v?_.setByteRange(P,v):_.setByteRange(P)}else if(o[5])_.rawProgramDateTime=(" "+o[5]).slice(1),_.tagList.push(["PROGRAM-DATE-TIME",_.rawProgramDateTime]),-1===k&&(k=d.length);else{if(!(o=o[0].match(ct))){C.warn("No matches on slow regex match for level playlist!");continue}for(l=1;l<o.length&&void 0===o[l];l++);var x=(" "+o[l]).slice(1),I=(" "+o[l+1]).slice(1),R=o[l+2]?(" "+o[l+2]).slice(1):"";switch(x){case"PLAYLIST-TYPE":c.type=I.toUpperCase();break;case"MEDIA-SEQUENCE":h=c.startSN=parseInt(I);break;case"SKIP":var D=new w(I);Ke(c,D,["RECENTLY-REMOVED-DATERANGES"]);var O=D.decimalInteger("SKIPPED-SEGMENTS");if(g(O)){c.skippedSegments=O;for(var L=O;L--;)d.unshift(null);h+=O}var N=D.enumeratedString("RECENTLY-REMOVED-DATERANGES");N&&(c.recentlyRemovedDateranges=N.split("\t"));break;case"TARGETDURATION":c.targetduration=Math.max(parseInt(I),1);break;case"VERSION":c.version=parseInt(I);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":c.live=!1;break;case"#":(I||R)&&_.tagList.push(R?[I,R]:[I]);break;case"DISCONTINUITY":y++,_.tagList.push(["DIS"]);break;case"GAP":_.gap=!0,_.tagList.push([x]);break;case"BITRATE":_.tagList.push([x,I]);break;case"DATERANGE":var F=new w(I);Ke(c,F,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Ke(c,F,F.clientAttrs);var V=new M(F,c.dateRanges[F.ID]);V.isValid||c.skippedSegments?c.dateRanges[V.id]=V:C.warn('Ignoring invalid DATERANGE tag: "'+I+'"'),_.tagList.push(["EXT-X-DATERANGE",I]);break;case"DEFINE":var H=new w(I);Ke(c,H,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in H?qe(c,H,i):ze(c,H,t);break;case"DISCONTINUITY-SEQUENCE":y=parseInt(I);break;case"KEY":var G=pt(I,t,c);if(G.isSupported()){if("NONE"===G.method){u=void 0;break}u||(u={}),u[G.keyFormat]&&(u=s({},u)),u[G.keyFormat]=G}else C.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+I+'"');break;case"START":c.startTimeOffset=ht(I);break;case"MAP":var $=new w(I);if(Ke(c,$,["BYTERANGE","URI"]),_.duration){var K=new U(n,t);yt(K,$,r,u),p=K,_.initSegment=p,p.rawProgramDateTime&&!_.rawProgramDateTime&&(_.rawProgramDateTime=p.rawProgramDateTime)}else{var W=_.byteRangeEndOffset;if(W){var z=_.byteRangeStartOffset;b=W-z+"@"+z}else b=null;yt(_,$,r,u),p=_,E=!0}break;case"SERVER-CONTROL":var q=new w(I);c.canBlockReload=q.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=q.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&q.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=q.optionalFloat("PART-HOLD-BACK",0),c.holdBack=q.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var Y=new w(I);c.partTarget=Y.decimalFloatingPoint("PART-TARGET");break;case"PART":var X=c.partList;X||(X=c.partList=[]);var Z=f>0?X[X.length-1]:void 0,Q=f++,J=new w(I);Ke(c,J,["BYTERANGE","URI"]);var ee=new j(J,_,t,Q,Z);X.push(ee),_.duration+=ee.duration;break;case"PRELOAD-HINT":var te=new w(I);Ke(c,te,["URI"]),c.preloadHint=te;break;case"RENDITION-REPORT":var re=new w(I);Ke(c,re,["URI"]),c.renditionReports=c.renditionReports||[],c.renditionReports.push(re);break;default:C.warn("line parsed but not handled: "+o)}}}v&&!v.relurl?(d.pop(),m-=v.duration,c.partList&&(c.fragmentHint=v)):c.partList&&(gt(_,v),_.cc=y,c.fragmentHint=_,u&&vt(_,u,c));var ne=d.length,ae=d[0],ie=d[ne-1];if((m+=c.skippedSegments*c.targetduration)>0&&ne&&ie){c.averagetargetduration=m/ne;var oe=ie.sn;c.endSN="initSegment"!==oe?oe:0,c.live||(ie.endList=!0),ae&&(c.startCC=ae.cc)}else c.endSN=0,c.startCC=0;return c.fragmentHint&&(m+=c.fragmentHint.duration),c.totalduration=m,c.endCC=y,k>0&&function(e,t){for(var r=e[t],n=t;n--;){var a=e[n];if(!a)return;a.programDateTime=r.programDateTime-1e3*a.duration,r=a}}(d,k),c},e}();function pt(e,t,r){var n,a,i=new w(e);Ke(r,i,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);var o=null!=(n=i.METHOD)?n:"",s=i.URI,l=i.hexadecimalInteger("IV"),u=i.KEYFORMATVERSIONS,c=null!=(a=i.KEYFORMAT)?a:"identity";s&&i.IV&&!l&&C.error("Invalid IV: "+i.IV);var d=s?dt.resolve(s,t):"",p=(u||"1").split("/").map(Number).filter(Number.isFinite);return new He(o,d,c,p,l)}function ht(e){var t=new w(e).decimalFloatingPoint("TIME-OFFSET");return g(t)?t:null}function ft(e,t){var r=(e||"").split(/[ ,]+/).filter((function(e){return e}));["video","audio","text"].forEach((function(e){var n=r.filter((function(t){return function(e,t){var r=Xe[t];return!!r&&!!r[e.slice(0,4)]}(t,e)}));n.length&&(t[e+"Codec"]=n.join(","),r=r.filter((function(e){return-1===n.indexOf(e)})))})),t.unknownCodecs=r}function mt(e,t,r){var n=t[r];n&&(e[r]=n)}function gt(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),g(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function yt(e,t,r,n){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=r,e.sn="initSegment",n&&(e.levelkeys=n),e.initSegment=null}function vt(e,t,r){e.levelkeys=t;var n=r.encryptedFragments;n.length&&n[n.length-1].levelkeys===t||!Object.keys(t).some((function(e){return t[e].isCommonEncryption}))||n.push(e)}var _t="manifest",kt="level",Et="audioTrack",bt="subtitleTrack",Tt="main",At="audio",St="subtitle";function Ct(e){switch(e.type){case Et:return At;case bt:return St;default:return Tt}}function Pt(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r}var xt=function(){function e(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}var t=e.prototype;return t.startLoad=function(e){},t.stopLoad=function(){this.destroyInternalLoaders()},t.registerListeners=function(){var e=this.hls;e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.LEVEL_LOADING,this.onLevelLoading,this),e.on(_.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(_.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.unregisterListeners=function(){var e=this.hls;e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.LEVEL_LOADING,this.onLevelLoading,this),e.off(_.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(_.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,n=t.loader,a=new(r||n)(t);return this.loaders[e.type]=a,a},t.getInternalLoader=function(e){return this.loaders[e.type]},t.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},t.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},t.destroy=function(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()},t.onManifestLoading=function(e,t){var r=t.url;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:_t,url:r,deliveryDirectives:null})},t.onLevelLoading=function(e,t){var r=t.id,n=t.level,a=t.pathwayId,i=t.url,o=t.deliveryDirectives;this.load({id:r,level:n,pathwayId:a,responseType:"text",type:kt,url:i,deliveryDirectives:o})},t.onAudioTrackLoading=function(e,t){var r=t.id,n=t.groupId,a=t.url,i=t.deliveryDirectives;this.load({id:r,groupId:n,level:null,responseType:"text",type:Et,url:a,deliveryDirectives:i})},t.onSubtitleTrackLoading=function(e,t){var r=t.id,n=t.groupId,a=t.url,i=t.deliveryDirectives;this.load({id:r,groupId:n,level:null,responseType:"text",type:bt,url:a,deliveryDirectives:i})},t.load=function(e){var t,r,n,a=this,i=this.hls.config,o=this.getInternalLoader(e);if(o){var l=o.context;if(l&&l.url===e.url&&l.level===e.level)return void C.trace("[playlist-loader]: playlist request ongoing");C.log("[playlist-loader]: aborting previous loader for type: "+e.type),o.abort()}if(r=e.type===_t?i.manifestLoadPolicy.default:s({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),o=this.createInternalLoader(e),g(null==(t=e.deliveryDirectives)?void 0:t.part)&&(e.type===kt&&null!==e.level?n=this.hls.levels[e.level].details:e.type===Et&&null!==e.id?n=this.hls.audioTracks[e.id].details:e.type===bt&&null!==e.id&&(n=this.hls.subtitleTracks[e.id].details),n)){var u=n.partTarget,c=n.targetduration;if(u&&c){var d=1e3*Math.max(3*u,.8*c);r=s({},r,{maxTimeToFirstByteMs:Math.min(d,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(d,r.maxTimeToFirstByteMs)})}}var p=r.errorRetry||r.timeoutRetry||{},h={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:p.maxNumRetry||0,retryDelay:p.retryDelayMs||0,maxRetryDelay:p.maxRetryDelayMs||0},f={onSuccess:function(e,t,r,n){var i=a.getInternalLoader(r);a.resetInternalLoader(r.type);var o=e.data;0===o.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),dt.isMediaPlaylist(o)?a.handleTrackOrLevelPlaylist(e,t,r,n||null,i):a.handleMasterPlaylist(e,t,r,n)):a.handleManifestParsingError(e,r,new Error("no EXTM3U delimiter"),n||null,t)},onError:function(e,t,r,n){a.handleNetworkError(t,r,!1,e,n)},onTimeout:function(e,t,r){a.handleNetworkError(t,r,!0,void 0,e)}};o.load(e,h,f)},t.handleMasterPlaylist=function(e,t,r,n){var a=this.hls,i=e.data,o=Pt(e,r),s=dt.parseMasterPlaylist(i,o);if(s.playlistParsingError)this.handleManifestParsingError(e,r,s.playlistParsingError,n,t);else{var l=s.contentSteering,u=s.levels,c=s.sessionData,d=s.sessionKeys,p=s.startTimeOffset,h=s.variableList;this.variableList=h;var f=dt.parseMasterPlaylistMedia(i,o,s),m=f.AUDIO,g=void 0===m?[]:m,y=f.SUBTITLES,v=f["CLOSED-CAPTIONS"];g.length&&(g.some((function(e){return!e.url}))||!u[0].audioCodec||u[0].attrs.AUDIO||(C.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new w({}),bitrate:0,url:""}))),a.trigger(_.MANIFEST_LOADED,{levels:u,audioTracks:g,subtitles:y,captions:v,contentSteering:l,url:o,stats:t,networkDetails:n,sessionData:c,sessionKeys:d,startTimeOffset:p,variableList:h})}},t.handleTrackOrLevelPlaylist=function(e,t,r,n,a){var i=this.hls,o=r.id,s=r.level,l=r.type,u=Pt(e,r),c=g(s)?s:g(o)?o:0,d=Ct(r),p=dt.parseLevelPlaylist(e.data,u,c,d,0,this.variableList);if(l===_t){var h={attrs:new w({}),bitrate:0,details:p,name:"",url:u};i.trigger(_.MANIFEST_LOADED,{levels:[h],audioTracks:[],url:u,stats:t,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=p,this.handlePlaylistLoaded(p,e,t,r,n,a)},t.handleManifestParsingError=function(e,t,r,n,a){this.hls.trigger(_.ERROR,{type:k.NETWORK_ERROR,details:E.MANIFEST_PARSING_ERROR,fatal:t.type===_t,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:n,stats:a})},t.handleNetworkError=function(e,t,r,a,i){void 0===r&&(r=!1);var o="A network "+(r?"timeout":"error"+(a?" (status "+a.code+")":""))+" occurred while loading "+e.type;e.type===kt?o+=": "+e.level+" id: "+e.id:e.type!==Et&&e.type!==bt||(o+=" id: "+e.id+' group-id: "'+e.groupId+'"');var s=new Error(o);C.warn("[playlist-loader]: "+o);var l=E.UNKNOWN,u=!1,c=this.getInternalLoader(e);switch(e.type){case _t:l=r?E.MANIFEST_LOAD_TIMEOUT:E.MANIFEST_LOAD_ERROR,u=!0;break;case kt:l=r?E.LEVEL_LOAD_TIMEOUT:E.LEVEL_LOAD_ERROR,u=!1;break;case Et:l=r?E.AUDIO_TRACK_LOAD_TIMEOUT:E.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case bt:l=r?E.SUBTITLE_TRACK_LOAD_TIMEOUT:E.SUBTITLE_LOAD_ERROR,u=!1}c&&this.resetInternalLoader(e.type);var d={type:k.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:c,context:e,error:s,networkDetails:t,stats:i};if(a){var p=(null==t?void 0:t.url)||e.url;d.response=n({url:p,data:void 0},a)}this.hls.trigger(_.ERROR,d)},t.handlePlaylistLoaded=function(e,t,r,n,a,i){var o=this.hls,s=n.type,l=n.level,u=n.id,c=n.groupId,d=n.deliveryDirectives,p=Pt(t,n),h=Ct(n),f="number"==typeof n.level&&h===Tt?l:void 0;if(e.fragments.length){e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));var m=e.playlistParsingError;if(m)o.trigger(_.ERROR,{type:k.NETWORK_ERROR,details:E.LEVEL_PARSING_ERROR,fatal:!1,url:p,error:m,reason:m.message,response:t,context:n,level:f,parent:h,networkDetails:a,stats:r});else switch(e.live&&i&&(i.getCacheAge&&(e.ageHeader=i.getCacheAge()||0),i.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),s){case _t:case kt:o.trigger(_.LEVEL_LOADED,{details:e,level:f||0,id:u||0,stats:r,networkDetails:a,deliveryDirectives:d});break;case Et:o.trigger(_.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:r,networkDetails:a,deliveryDirectives:d});break;case bt:o.trigger(_.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:r,networkDetails:a,deliveryDirectives:d})}}else{var g=new Error("No Segments found in Playlist");o.trigger(_.ERROR,{type:k.NETWORK_ERROR,details:E.LEVEL_EMPTY_ERROR,fatal:!1,url:p,error:g,reason:g.message,response:t,context:n,level:f,parent:h,networkDetails:a,stats:r})}},e}();function wt(e,t){var r;try{r=new Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)}function It(e,t){var r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(r){C.debug("[texttrack-utils]: "+r);try{var n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(e){C.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: "+e)}}"disabled"===r&&(e.mode=r)}function Mt(e){var t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(var r=e.cues.length;r--;)e.removeCue(e.cues[r]);"disabled"===t&&(e.mode=t)}function Rt(e,t,r,n){var a=e.mode;if("disabled"===a&&(e.mode="hidden"),e.cues&&e.cues.length>0)for(var i=function(e,t,r){var n=[],a=function(e,t){if(t<e[0].startTime)return 0;var r=e.length-1;if(t>e[r].endTime)return-1;for(var n=0,a=r;n<=a;){var i=Math.floor((a+n)/2);if(t<e[i].startTime)a=i-1;else{if(!(t>e[i].startTime&&n<r))return i;n=i+1}}return e[n].startTime-t<t-e[a].startTime?n:a}(e,t);if(a>-1)for(var i=a,o=e.length;i<o;i++){var s=e[i];if(s.startTime>=t&&s.endTime<=r)n.push(s);else if(s.startTime>r)return n}return n}(e.cues,t,r),o=0;o<i.length;o++)n&&!n(i[o])||e.removeCue(i[o]);"disabled"===a&&(e.mode=a)}function Dt(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];"subtitles"!==n.kind&&"captions"!==n.kind||!n.label||t.push(e[r])}return t}var Ot="org.id3",Lt="https://aomedia.org/emsg/ID3";function Nt(){if("undefined"!=typeof self)return self.VTTCue||self.TextTrackCue}function Ut(e,t,r,a,i){var o=new e(t,r,"");try{o.value=a,i&&(o.type=i)}catch(s){o=new e(t,r,JSON.stringify(i?n({type:i},a):a))}return o}var jt=function(){var e=Nt();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function Bt(e,t){return e.getTime()/1e3-t}var Ft=function(){function e(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}var t=e.prototype;return t.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},t._registerListeners=function(){var e=this.hls;e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(_.LEVEL_UPDATED,this.onLevelUpdated,this)},t._unregisterListeners=function(){var e=this.hls;e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(_.LEVEL_UPDATED,this.onLevelUpdated,this)},t.onMediaAttached=function(e,t){this.media=t.media},t.onMediaDetaching=function(){this.id3Track&&(Mt(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},t.onManifestLoading=function(){this.dateRangeCuesAppended={}},t.createTrack=function(e){var t=this.getID3Track(e.textTracks);return t.mode="hidden",t},t.getID3Track=function(e){if(this.media){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return wt(r,this.media),r}return this.media.addTextTrack("metadata","id3")}},t.onFragParsingMetadata=function(e,t){if(this.media){var r=this.hls.config,n=r.enableEmsgMetadataCues,a=r.enableID3MetadataCues;if(n||a){var i=t.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));var o=Nt();if(o)for(var s=0;s<i.length;s++){var l=i[s].type;if((l!==Lt||n)&&a){var u=ce(i[s].data);if(u){var c=i[s].pts,d=c+i[s].duration;d>jt&&(d=jt),d-c<=0&&(d=c+.25);for(var p=0;p<u.length;p++){var h=u[p];if(!le(h)){this.updateId3CueEnds(c,l);var f=Ut(o,c,d,h,l);f&&this.id3Track.addCue(f)}}}}}}}},t.updateId3CueEnds=function(e,t){var r,n=null==(r=this.id3Track)?void 0:r.cues;if(n)for(var a=n.length;a--;){var i=n[a];i.type===t&&i.startTime<e&&i.endTime===jt&&(i.endTime=e)}},t.onBufferFlushing=function(e,t){var r=t.startOffset,n=t.endOffset,a=t.type,i=this.id3Track,o=this.hls;if(o){var s=o.config,l=s.enableEmsgMetadataCues,u=s.enableID3MetadataCues;i&&(l||u)&&Rt(i,r,n,"audio"===a?function(e){return e.type===Ot&&u}:"video"===a?function(e){return e.type===Lt&&l}:function(e){return e.type===Ot&&u||e.type===Lt&&l})}},t.onLevelUpdated=function(e,t){var r=this,n=t.details;if(this.media&&n.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var a=this.dateRangeCuesAppended,i=this.id3Track,o=n.dateRanges,s=Object.keys(o);if(i)for(var l=Object.keys(a).filter((function(e){return!s.includes(e)})),u=function(){var e=l[c];Object.keys(a[e].cues).forEach((function(t){i.removeCue(a[e].cues[t])})),delete a[e]},c=l.length;c--;)u();var d=n.fragments[n.fragments.length-1];if(0!==s.length&&g(null==d?void 0:d.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var p=d.programDateTime/1e3-d.start,h=Nt(),f=function(){var e=s[m],t=o[e],n=Bt(t.startDate,p),i=a[e],l=(null==i?void 0:i.cues)||{},u=(null==i?void 0:i.durationKnown)||!1,c=jt,d=t.endDate;if(d)c=Bt(d,p),u=!0;else if(t.endOnNext&&!u){var f=s.reduce((function(e,r){if(r!==t.id){var n=o[r];if(n.class===t.class&&n.startDate>t.startDate&&(!e||t.startDate<e.startDate))return n}return e}),null);f&&(c=Bt(f.startDate,p),u=!0)}for(var g,y,v=Object.keys(t.attr),_=0;_<v.length;_++){var k=v[_];if("ID"!==(y=k)&&"CLASS"!==y&&"START-DATE"!==y&&"DURATION"!==y&&"END-DATE"!==y&&"END-ON-NEXT"!==y){var E=l[k];if(E)u&&!i.durationKnown&&(E.endTime=c);else if(h){var b=t.attr[k];I(k)&&(g=b,b=Uint8Array.from(g.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer);var T=Ut(h,n,c,{key:k,data:b},"com.apple.quicktime.HLS");T&&(T.id=e,r.id3Track.addCue(T),l[k]=T)}}}a[e]={cues:l,dateRange:t,durationKnown:u}},m=0;m<s.length;m++)f()}}},e}(),Vt=function(){function e(e){var t=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return t.timeupdate()},this.hls=e,this.config=e.config,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},t.registerListeners=function(){this.hls.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(_.ERROR,this.onError,this)},t.unregisterListeners=function(){this.hls.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(_.ERROR,this.onError,this)},t.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},t.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},t.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},t.onLevelUpdated=function(e,t){var r=t.details;this.levelDetails=r,r.advanced&&this.timeupdate(),!r.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},t.onError=function(e,t){var r;t.details===E.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(r=this.levelDetails)&&r.live&&C.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},t.timeupdate=function(){var e=this.media,t=this.levelDetails;if(e&&t){this.currentTime=e.currentTime;var r=this.computeLatency();if(null!==r){this._latency=r;var n=this.config,a=n.lowLatencyMode,i=n.maxLiveSyncPlaybackRate;if(a&&1!==i&&t.live){var o=this.targetLatency;if(null!==o){var s=r-o;if(s<Math.min(this.maxLatency,o+t.targetduration)&&s>.05&&this.forwardBufferLength>1){var l=Math.min(2,Math.max(1,i)),u=Math.round(2/(1+Math.exp(-.75*s-this.edgeStalled))*20)/20;e.playbackRate=Math.min(l,Math.max(1,u))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}}}}},t.estimateLiveEdge=function(){var e=this.levelDetails;return null===e?null:e.edge+e.age},t.computeLatency=function(){var e=this.estimateLiveEdge();return null===e?null:e-this.currentTime},o(e,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var e=this.config,t=this.levelDetails;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}},{key:"targetLatency",get:function(){var e=this.levelDetails;if(null===e)return null;var t=e.holdBack,r=e.partHoldBack,n=e.targetduration,a=this.config,i=a.liveSyncDuration,o=a.liveSyncDurationCount,s=a.lowLatencyMode,l=this.hls.userConfig,u=s&&r||t;(l.liveSyncDuration||l.liveSyncDurationCount||0===u)&&(u=void 0!==i?i:o*n);var c=n;return u+Math.min(1*this.stallCount,c)}},{key:"liveSyncPosition",get:function(){var e=this.estimateLiveEdge(),t=this.targetLatency,r=this.levelDetails;if(null===e||null===t||null===r)return null;var n=r.edge,a=e-t-this.edgeStalled,i=n-r.totalduration,o=n-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(i,a),o)}},{key:"drift",get:function(){var e=this.levelDetails;return null===e?1:e.drift}},{key:"edgeStalled",get:function(){var e=this.levelDetails;if(null===e)return 0;var t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}},{key:"forwardBufferLength",get:function(){var e=this.media,t=this.levelDetails;if(!e||!t)return 0;var r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}}]),e}(),Ht=["NONE","TYPE-0","TYPE-1",null],Gt=["SDR","PQ","HLG"];function $t(e){var t=e.canSkipUntil,r=e.canSkipDateRanges,n=e.age;return t&&n<t/2?r?"v2":"YES":""}var Kt=function(){function e(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}return e.prototype.addDirectives=function(e){var t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href},e}(),Wt=function(){function e(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter((function(e){return!!e})).map((function(e){return e.substring(0,4)})).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}var t=e.prototype;return t.hasAudioGroup=function(e){return zt(this._audioGroups,e)},t.hasSubtitleGroup=function(e){return zt(this._subtitleGroups,e)},t.addGroupId=function(e,t){if(t)if("audio"===e){var r=this._audioGroups;r||(r=this._audioGroups=[]),-1===r.indexOf(t)&&r.push(t)}else if("text"===e){var n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),-1===n.indexOf(t)&&n.push(t)}},t.addFallback=function(){},o(e,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"averageBitrate",get:function(){return this._avgBitrate||this.realBitrate||this.bitrate}},{key:"attrs",get:function(){return this._attrs[0]}},{key:"codecs",get:function(){return this.attrs.CODECS||""}},{key:"pathwayId",get:function(){return this.attrs["PATHWAY-ID"]||"."}},{key:"videoRange",get:function(){return this.attrs["VIDEO-RANGE"]||"SDR"}},{key:"score",get:function(){return this.attrs.optionalFloat("SCORE",0)}},{key:"uri",get:function(){return this.url[0]||""}},{key:"audioGroups",get:function(){return this._audioGroups}},{key:"subtitleGroups",get:function(){return this._subtitleGroups}},{key:"urlId",get:function(){return 0},set:function(e){}},{key:"audioGroupIds",get:function(){return this.audioGroups?[this.audioGroupId]:void 0}},{key:"textGroupIds",get:function(){return this.subtitleGroups?[this.textGroupId]:void 0}},{key:"audioGroupId",get:function(){var e;return null==(e=this.audioGroups)?void 0:e[0]}},{key:"textGroupId",get:function(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}}]),e}();function zt(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}function qt(e,t){var r=t.startPTS;if(g(r)){var n,a=0;t.sn>e.sn?(a=r-e.start,n=e):(a=e.start-r,n=t),n.duration!==a&&(n.duration=a)}else t.sn>e.sn?e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration:t.start=Math.max(e.start-t.duration,0)}function Yt(e,t,r,n,a,i){n-r<=0&&(C.warn("Fragment should have a positive duration",t),n=r+t.duration,i=a+t.duration);var o=r,s=n,l=t.startPTS,u=t.endPTS;if(g(l)){var c=Math.abs(l-r);g(t.deltaPTS)?t.deltaPTS=Math.max(c,t.deltaPTS):t.deltaPTS=c,o=Math.max(r,l),r=Math.min(r,l),a=Math.min(a,t.startDTS),s=Math.min(n,u),n=Math.max(n,u),i=Math.max(i,t.endDTS)}var d=r-t.start;0!==t.start&&(t.start=r),t.duration=n-t.start,t.startPTS=r,t.maxStartPTS=o,t.startDTS=a,t.endPTS=n,t.minEndPTS=s,t.endDTS=i;var p,h=t.sn;if(!e||h<e.startSN||h>e.endSN)return 0;var f=h-e.startSN,m=e.fragments;for(m[f]=t,p=f;p>0;p--)qt(m[p],m[p-1]);for(p=f;p<m.length-1;p++)qt(m[p],m[p+1]);return e.fragmentHint&&qt(m[m.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,d}function Xt(e,t){for(var r=null,n=e.fragments,a=n.length-1;a>=0;a--){var i=n[a].initSegment;if(i){r=i;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;var o,l,u,c,d,p=0;if(function(e,t,r){for(var n=t.skippedSegments,a=Math.max(e.startSN,t.startSN)-t.startSN,i=(e.fragmentHint?1:0)+(n?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,o=t.startSN-e.startSN,s=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=a;u<=i;u++){var c=l[o+u],d=s[u];n&&!d&&u<n&&(d=t.fragments[u]=c),c&&d&&r(c,d)}}(e,t,(function(e,n){e.relurl&&(p=e.cc-n.cc),g(e.startPTS)&&g(e.endPTS)&&(n.start=n.startPTS=e.startPTS,n.startDTS=e.startDTS,n.maxStartPTS=e.maxStartPTS,n.endPTS=e.endPTS,n.endDTS=e.endDTS,n.minEndPTS=e.minEndPTS,n.duration=e.endPTS-e.startPTS,n.duration&&(o=n),t.PTSKnown=t.alignedSliding=!0),n.elementaryStreams=e.elementaryStreams,n.loader=e.loader,n.stats=e.stats,e.initSegment&&(n.initSegment=e.initSegment,r=e.initSegment)})),r&&(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach((function(e){var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=r)?void 0:t.relurl)||(e.initSegment=r)})),t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some((function(e){return!e})),t.deltaUpdateFailed){C.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var h=t.skippedSegments;h--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=(l=e.dateRanges,u=t.dateRanges,c=t.recentlyRemovedDateranges,d=s({},l),c&&c.forEach((function(e){delete d[e]})),Object.keys(u).forEach((function(e){var t=new M(u[e].attr,d[e]);t.isValid?d[e]=t:C.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(u[e].attr)+'"')})),d));var f=t.fragments;if(p){C.warn("discontinuity sliding from playlist, take drift into account");for(var m=0;m<f.length;m++)f[m].cc+=p}t.skippedSegments&&(t.startCC=t.fragments[0].cc),function(e,t,r){if(e&&t)for(var n=0,a=0,i=e.length;a<=i;a++){var o=e[a],s=t[a+n];o&&s&&o.index===s.index&&o.fragment.sn===s.fragment.sn?r(o,s):n--}}(e.partList,t.partList,(function(e,t){t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),o?Yt(t,o,o.startPTS,o.endPTS,o.startDTS,o.endDTS):Zt(e,t),f.length&&(t.totalduration=t.edge-f[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;var y=t.advancedDateTime;if(t.advanced&&y){var v=t.edge;t.driftStart||(t.driftStartTime=y,t.driftStart=v),t.driftEndTime=y,t.driftEnd=v}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}function Zt(e,t){var r=t.startSN+t.skippedSegments-e.startSN,n=e.fragments;r<0||r>=n.length||Qt(t,n[r].start)}function Qt(e,t){if(t){for(var r=e.fragments,n=e.skippedSegments;n<r.length;n++)r[n].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function Jt(e,t,r){var n;return null!=e&&e.details?er(null==(n=e.details)?void 0:n.partList,t,r):null}function er(e,t,r){if(e)for(var n=e.length;n--;){var a=e[n];if(a.index===r&&a.fragment.sn===t)return a}return null}function tr(e){e.forEach((function(e,t){var r=e.details;null!=r&&r.fragments&&r.fragments.forEach((function(e){e.level=t}))}))}function rr(e){switch(e.details){case E.FRAG_LOAD_TIMEOUT:case E.KEY_LOAD_TIMEOUT:case E.LEVEL_LOAD_TIMEOUT:case E.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function nr(e,t){var r=rr(t);return e.default[(r?"timeout":"error")+"Retry"]}function ar(e,t){var r="linear"===e.backoff?1:Math.pow(2,t);return Math.min(r*e.retryDelayMs,e.maxRetryDelayMs)}function ir(e){return n(n({},e),{errorRetry:null,timeoutRetry:null})}function or(e,t,r,n){if(!e)return!1;var a=null==n?void 0:n.code,i=t<e.maxNumRetry&&(function(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}(a)||!!r);return e.shouldRetry?e.shouldRetry(e,t,r,n,i):i}var sr=function(e,t){for(var r=0,n=e.length-1,a=null,i=null;r<=n;){var o=t(i=e[a=(r+n)/2|0]);if(o>0)r=a+1;else{if(!(o<0))return i;n=a-1}}return null};function lr(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var a=null;if(e){a=t[e.sn-t[0].sn+1]||null;var i=e.endDTS-r;i>0&&i<15e-7&&(r+=15e-7)}else 0===r&&0===t[0].start&&(a=t[0]);if(a&&(!e||e.level===a.level)&&0===ur(r,n,a))return a;var o=sr(t,ur.bind(null,r,n));return!o||o===e&&a?a:o}function ur(e,t,r){if(void 0===e&&(e=0),void 0===t&&(t=0),r.start<=e&&r.start+r.duration>e)return 0;var n=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=e?1:r.start-n>e&&r.start?-1:0}function cr(e,t,r){var n=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-n>e}var dr=function(){function e(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=C.log.bind(C,"[info]:"),this.warn=C.warn.bind(C,"[warning]:"),this.error=C.error.bind(C,"[error]:"),this.registerListeners()}var t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(_.ERROR,this.onError,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.LEVEL_UPDATED,this.onLevelUpdated,this)},t.unregisterListeners=function(){var e=this.hls;e&&(e.off(_.ERROR,this.onError,this),e.off(_.ERROR,this.onErrorOut,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.LEVEL_UPDATED,this.onLevelUpdated,this))},t.destroy=function(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}},t.startLoad=function(e){},t.stopLoad=function(){this.playlistError=0},t.getVariantLevelIndex=function(e){return(null==e?void 0:e.type)===Tt?e.level:this.hls.loadLevel},t.onManifestLoading=function(){this.playlistError=0,this.penalizedRenditions={}},t.onLevelUpdated=function(){this.playlistError=0},t.onError=function(e,t){var r,n;if(!t.fatal){var a=this.hls,i=t.context;switch(t.details){case E.FRAG_LOAD_ERROR:case E.FRAG_LOAD_TIMEOUT:case E.KEY_LOAD_ERROR:case E.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case E.FRAG_PARSING_ERROR:if(null!=(r=t.frag)&&r.gap)return void(t.errorAction={action:0,flags:0});case E.FRAG_GAP:case E.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=2);case E.LEVEL_EMPTY_ERROR:case E.LEVEL_PARSING_ERROR:var o,s,l=t.parent===Tt?t.level:a.loadLevel;return void(t.details===E.LEVEL_EMPTY_ERROR&&null!=(o=t.context)&&null!=(s=o.levelDetails)&&s.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,l):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,l)));case E.LEVEL_LOAD_ERROR:case E.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==i?void 0:i.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.level)));case E.AUDIO_TRACK_LOAD_ERROR:case E.AUDIO_TRACK_LOAD_TIMEOUT:case E.SUBTITLE_LOAD_ERROR:case E.SUBTITLE_TRACK_LOAD_TIMEOUT:if(i){var u=a.levels[a.loadLevel];if(u&&(i.type===Et&&u.hasAudioGroup(i.groupId)||i.type===bt&&u.hasSubtitleGroup(i.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.loadLevel),t.errorAction.action=2,void(t.errorAction.flags=1)}return;case E.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var c=a.levels[a.loadLevel],d=null==c?void 0:c.attrs["HDCP-LEVEL"];return void(d?t.errorAction={action:2,flags:2,hdcpLevel:d}:this.keySystemError(t));case E.BUFFER_ADD_CODEC_ERROR:case E.REMUX_ALLOC_ERROR:case E.BUFFER_APPEND_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(n=t.level)?n:a.loadLevel));case E.INTERNAL_EXCEPTION:case E.BUFFER_APPENDING_ERROR:case E.BUFFER_FULL_ERROR:case E.LEVEL_SWITCH_ERROR:case E.BUFFER_STALLED_ERROR:case E.BUFFER_SEEK_OVER_HOLE:case E.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:0,flags:0})}t.type===k.KEY_SYSTEM_ERROR&&this.keySystemError(t)}},t.keySystemError=function(e){var t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)},t.getPlaylistRetryOrSwitchAction=function(e,t){var r=nr(this.hls.config.playlistLoadPolicy,e),n=this.playlistError++;if(or(r,n,rr(e),e.response))return{action:5,flags:0,retryConfig:r,retryCount:n};var a=this.getLevelSwitchAction(e,t);return r&&(a.retryConfig=r,a.retryCount=n),a},t.getFragRetryOrSwitchAction=function(e){var t=this.hls,r=this.getVariantLevelIndex(e.frag),n=t.levels[r],a=t.config,i=a.fragLoadPolicy,o=a.keyLoadPolicy,s=nr(e.details.startsWith("key")?o:i,e),l=t.levels.reduce((function(e,t){return e+t.fragmentError}),0);if(n&&(e.details!==E.FRAG_GAP&&n.fragmentError++,or(s,l,rr(e),e.response)))return{action:5,flags:0,retryConfig:s,retryCount:l};var u=this.getLevelSwitchAction(e,r);return s&&(u.retryConfig=s,u.retryCount=l),u},t.getLevelSwitchAction=function(e,t){var r=this.hls;null==t&&(t=r.loadLevel);var n=this.hls.levels[t];if(n){var a,i,o=e.details;n.loadError++,o===E.BUFFER_APPEND_ERROR&&n.fragmentError++;var s=-1,l=r.levels,u=r.loadLevel,c=r.minAutoLevel,d=r.maxAutoLevel;r.autoLevelEnabled||(r.loadLevel=-1);for(var p,h=null==(a=e.frag)?void 0:a.type,f=(h===At&&o===E.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(o===E.BUFFER_ADD_CODEC_ERROR||o===E.BUFFER_APPEND_ERROR))&&l.some((function(e){var t=e.audioCodec;return n.audioCodec!==t})),m="video"===e.sourceBufferName&&(o===E.BUFFER_ADD_CODEC_ERROR||o===E.BUFFER_APPEND_ERROR)&&l.some((function(e){var t=e.codecSet,r=e.audioCodec;return n.codecSet!==t&&n.audioCodec===r})),g=null!=(i=e.context)?i:{},y=g.type,v=g.groupId,_=function(){var t=(k+u)%l.length;if(t!==u&&t>=c&&t<=d&&0===l[t].loadError){var r,a,i=l[t];if(o===E.FRAG_GAP&&e.frag){var p=l[t].details;if(p){var g=lr(e.frag,p.fragments,e.frag.start);if(null!=g&&g.gap)return 0}}else{if(y===Et&&i.hasAudioGroup(v)||y===bt&&i.hasSubtitleGroup(v))return 0;if(h===At&&null!=(r=n.audioGroups)&&r.some((function(e){return i.hasAudioGroup(e)}))||h===St&&null!=(a=n.subtitleGroups)&&a.some((function(e){return i.hasSubtitleGroup(e)}))||f&&n.audioCodec===i.audioCodec||!f&&n.audioCodec!==i.audioCodec||m&&n.codecSet===i.codecSet)return 0}return s=t,1}},k=l.length;k--&&(0===(p=_())||1!==p););if(s>-1&&r.loadLevel!==s)return e.levelRetry=!0,this.playlistError=0,{action:2,flags:0,nextAutoLevel:s}}return{action:2,flags:1}},t.onErrorOut=function(e,t){var r;switch(null==(r=t.errorAction)?void 0:r.action){case 0:break;case 2:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===E.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn('MediaSource ended after "'+t.sourceBufferName+'" sourceBuffer append error. Attempting to recover from media error.'),this.hls.recoverMediaError()):t.fatal=!0}t.fatal&&this.hls.stopLoad()},t.sendAlternateToPenaltyBox=function(e){var t=this.hls,r=e.errorAction;if(r){var n=r.flags,a=r.hdcpLevel,i=r.nextAutoLevel;switch(n){case 0:this.switchLevel(e,i);break;case 2:a&&(t.maxHdcpLevel=Ht[Ht.indexOf(a)-1],r.resolved=!0),this.warn('Restricting playback to HDCP-LEVEL of "'+t.maxHdcpLevel+'" or lower')}r.resolved||this.switchLevel(e,i)}},t.switchLevel=function(e,t){void 0!==t&&e.errorAction&&(this.warn("switching to level "+t+" after "+e.details),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)},e}(),pr=function(){function e(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=C.log.bind(C,t+":"),this.warn=C.warn.bind(C,t+":"),this.hls=e}var t=e.prototype;return t.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},t.clearTimer=function(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)},t.startLoad=function(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()},t.stopLoad=function(){this.canLoad=!1,this.clearTimer()},t.switchParams=function(e,t,r){var n=null==t?void 0:t.renditionReports;if(n){for(var a=-1,i=0;i<n.length;i++){var o=n[i],s=void 0;try{s=new self.URL(o.URI,t.url).href}catch(e){C.warn("Could not construct new URL for Rendition Report: "+e),s=o.URI||""}if(s===e){a=i;break}s===e.substring(0,s.length)&&(a=i)}if(-1!==a){var l=n[a],u=parseInt(l["LAST-MSN"])||(null==t?void 0:t.lastPartSn),c=parseInt(l["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){var d=Math.min(t.age-t.partTarget,t.targetduration);c>=0&&d>t.partTarget&&(c+=1)}var p=r&&$t(r);return new Kt(u,c>=0?c:void 0,p)}}},t.loadPlaylist=function(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())},t.shouldLoadPlaylist=function(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)},t.shouldReloadPlaylist=function(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)},t.playlistLoaded=function(e,t,r){var n=this,a=t.details,i=t.stats,o=self.performance.now(),s=i.loading.first?Math.max(0,o-i.loading.first):0;if(a.advancedDateTime=Date.now()-s,a.live||null!=r&&r.live){if(a.reloaded(r),r&&this.log("live playlist "+e+" "+(a.advanced?"REFRESHED "+a.lastPartSn+"-"+a.lastPartIndex:a.updated?"UPDATED":"MISSED")),r&&a.fragments.length>0&&Xt(r,a),!this.canLoad||!a.live)return;var l,u=void 0,c=void 0;if(a.canBlockReload&&a.endSN&&a.advanced){var d=this.hls.config.lowLatencyMode,p=a.lastPartSn,h=a.endSN,f=a.lastPartIndex,m=p===h;-1!==f?(u=m?h+1:p,c=m?d?0:f:f+1):u=h+1;var g=a.age,y=g+a.ageHeader,v=Math.min(y-a.partTarget,1.5*a.targetduration);if(v>0){if(r&&v>r.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+r.tuneInGoal+" to: "+v+" with playlist age: "+a.age),v=0;else{var _=Math.floor(v/a.targetduration);u+=_,void 0!==c&&(c+=Math.round(v%a.targetduration/a.partTarget)),this.log("CDN Tune-in age: "+a.ageHeader+"s last advanced "+g.toFixed(2)+"s goal: "+v+" skip sn "+_+" to part "+c)}a.tuneInGoal=v}if(l=this.getDeliveryDirectives(a,t.deliveryDirectives,u,c),d||!m)return void this.loadPlaylist(l)}else(a.canBlockReload||a.canSkipUntil)&&(l=this.getDeliveryDirectives(a,t.deliveryDirectives,u,c));var k=this.hls.mainForwardBufferInfo,E=k?k.end-k.len:0,b=function(e,t){void 0===t&&(t=1/0);var r=1e3*e.targetduration;if(e.updated){var n=e.fragments;if(n.length&&4*r>t){var a=1e3*n[n.length-1].duration;a<r&&(r=a)}}else r/=2;return Math.round(r)}(a,1e3*(a.edge-E));a.updated&&o>this.requestScheduled+b&&(this.requestScheduled=i.loading.start),void 0!==u&&a.canBlockReload?this.requestScheduled=i.loading.first+b-(1e3*a.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+b<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=b);var T=this.requestScheduled-o;T=Math.max(0,T),this.log("reload live playlist "+e+" in "+Math.round(T)+" ms"),this.timer=self.setTimeout((function(){return n.loadPlaylist(l)}),T)}else this.clearTimer()},t.getDeliveryDirectives=function(e,t,r,n){var a=$t(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,n=t.part,a=""),new Kt(r,n,a)},t.checkRetry=function(e){var t=this,r=e.details,n=rr(e),a=e.errorAction,i=a||{},o=i.action,s=i.retryCount,l=void 0===s?0:s,u=i.retryConfig,c=!!a&&!!u&&(5===o||!a.resolved&&2===o);if(c){var d;if(this.requestScheduled=-1,l>=u.maxNumRetry)return!1;if(n&&null!=(d=e.context)&&d.deliveryDirectives)this.warn("Retrying playlist loading "+(l+1)+"/"+u.maxNumRetry+' after "'+r+'" without delivery-directives'),this.loadPlaylist();else{var p=ar(u,l);this.timer=self.setTimeout((function(){return t.loadPlaylist()}),p),this.warn("Retrying playlist loading "+(l+1)+"/"+u.maxNumRetry+' after "'+r+'" in '+p+"ms")}e.levelRetry=!0,a.resolved=!0}return c},e}(),hr=function(){function e(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}var t=e.prototype;return t.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_},e}(),fr=function(){function e(e,t,r,n){void 0===n&&(n=100),this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new hr(e),this.fast_=new hr(t),this.defaultTTFB_=n,this.ttfb_=new hr(e)}var t=e.prototype;return t.update=function(e,t){var r=this.slow_,n=this.fast_,a=this.ttfb_;r.halfLife!==e&&(this.slow_=new hr(e,r.getEstimate(),r.getTotalWeight())),n.halfLife!==t&&(this.fast_=new hr(t,n.getEstimate(),n.getTotalWeight())),a.halfLife!==e&&(this.ttfb_=new hr(e,a.getEstimate(),a.getTotalWeight()))},t.sample=function(e,t){var r=(e=Math.max(e,this.minDelayMs_))/1e3,n=8*t/r;this.fast_.sample(r,n),this.slow_.sample(r,n)},t.sampleTTFB=function(e){var t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))},t.canEstimate=function(){return this.fast_.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.getEstimateTTFB=function(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_},t.destroy=function(){},e}(),mr={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},gr={};function yr(e,t,r){var a=e.videoCodec,i=e.audioCodec;if(!a||!i||!r)return Promise.resolve(mr);var o={width:e.width,height:e.height,bitrate:Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)),framerate:e.frameRate||30},s=e.videoRange;"SDR"!==s&&(o.transferFunction=s.toLowerCase());var l=a.split(",").map((function(e){return{type:"media-source",video:n(n({},o),{},{contentType:Je(e,"video")})}}));return i&&e.audioGroups&&e.audioGroups.forEach((function(e){var r;e&&(null==(r=t.groups[e])||r.tracks.forEach((function(t){if(t.groupId===e){var r=t.channels||"",n=parseFloat(r);g(n)&&n>2&&l.push.apply(l,i.split(",").map((function(e){return{type:"media-source",audio:{contentType:Je(e,"audio"),channels:""+n}}})))}})))})),Promise.all(l.map((function(e){var t=function(e){var t=e.audio,r=e.video,n=r||t;if(n){var a=n.contentType.split('"')[1];if(r)return"r"+r.height+"x"+r.width+"f"+Math.ceil(r.framerate)+(r.transferFunction||"sd")+"_"+a+"_"+Math.ceil(r.bitrate/1e5);if(t)return"c"+t.channels+(t.spatialRendering?"s":"n")+"_"+a}return""}(e);return gr[t]||(gr[t]=r.decodingInfo(e))}))).then((function(e){return{supported:!e.some((function(e){return!e.supported})),configurations:l,decodingInfoResults:e}})).catch((function(e){return{supported:!1,configurations:l,decodingInfoResults:[],error:e}}))}function vr(e,t){C.log('[abr] start candidates with "'+e+'" ignored because '+t)}function _r(e,t,r){if("attrs"in e){var n=t.indexOf(e);if(-1!==n)return n}for(var a=0;a<t.length;a++)if(kr(e,t[a],r))return a;return-1}function kr(e,t,r){var n=e.groupId,a=e.name,i=e.lang,o=e.assocLang,s=e.characteristics,l=e.default,u=e.forced;return(void 0===n||t.groupId===n)&&(void 0===a||t.name===a)&&(void 0===i||t.lang===i)&&(void 0===i||t.assocLang===o)&&(void 0===l||t.default===l)&&(void 0===u||t.forced===u)&&(void 0===s||function(e,t){void 0===t&&(t="");var r=e.split(","),n=t.split(",");return r.length===n.length&&!r.some((function(e){return-1===n.indexOf(e)}))}(s,t.characteristics))&&(void 0===r||r(e,t))}function Er(e,t){var r=e.audioCodec,n=e.channels;return!(void 0!==r&&(t.audioCodec||"").substring(0,4)!==r.substring(0,4)||void 0!==n&&n!==(t.channels||"2"))}function br(e,t,r){for(var n=t;n;n--)if(r(e[n]))return n;for(var a=t+1;a<e.length;a++)if(r(e[a]))return a;return-1}var Tr=function(){function e(e){var t=this;this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=function(){var e=t.fragCurrent,r=t.partCurrent,n=t.hls,a=n.autoLevelEnabled,i=n.media;if(e&&i){var o=performance.now(),s=r?r.stats:e.stats,l=r?r.duration:e.duration,u=o-s.loading.start,c=n.minAutoLevel;if(s.aborted||s.loaded&&s.loaded===s.total||e.level<=c)return t.clearTimer(),void(t._nextAutoLevel=-1);if(a&&!i.paused&&i.playbackRate&&i.readyState){var d=n.mainForwardBufferInfo;if(null!==d){var p=t.bwEstimator.getEstimateTTFB(),h=Math.abs(i.playbackRate);if(!(u<=Math.max(p,l/(2*h)*1e3))){var f=d.len/h,m=s.loading.first?s.loading.first-s.loading.start:-1,y=s.loaded&&m>-1,v=t.getBwEstimate(),k=n.levels,E=k[e.level],b=s.total||Math.max(s.loaded,Math.round(l*E.averageBitrate/8)),T=y?u-m:u;T<1&&y&&(T=Math.min(u,8*s.loaded/v));var A=y?1e3*s.loaded/T:0,S=A?(b-s.loaded)/A:8*b/v+p/1e3;if(!(S<=f)){var P,x=A?8*A:v,w=Number.POSITIVE_INFINITY;for(P=e.level-1;P>c;P--){var I=k[P].maxBitrate;if((w=t.getTimeToLoadFrag(p/1e3,x,l*I,!k[P].details))<f)break}if(!(w>=S||w>10*l)){n.nextLoadLevel=n.nextAutoLevel=P,y?t.bwEstimator.sample(u-Math.min(p,m),s.loaded):t.bwEstimator.sampleTTFB(u);var M=k[P].maxBitrate;t.getBwEstimate()*t.hls.config.abrBandWidthUpFactor>M&&t.resetEstimator(M),t.clearTimer(),C.warn("[abr] Fragment "+e.sn+(r?" part "+r.index:"")+" of level "+e.level+" is loading too slowly;\n      Time to underbuffer: "+f.toFixed(3)+" s\n      Estimated load time for current fragment: "+S.toFixed(3)+" s\n      Estimated load time for down switch fragment: "+w.toFixed(3)+" s\n      TTFB estimate: "+(0|m)+" ms\n      Current BW estimate: "+(g(v)?0|v:"Unknown")+" bps\n      New BW estimate: "+(0|t.getBwEstimate())+" bps\n      Switching to level "+P+" @ "+(0|M)+" bps"),n.trigger(_.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:r,stats:s})}}}}}}},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}var t=e.prototype;return t.resetEstimator=function(e){e&&(C.log("setting initial bwe to "+e),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()},t.initEstimator=function(){var e=this.hls.config;return new fr(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)},t.registerListeners=function(){var e=this.hls;e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.FRAG_LOADING,this.onFragLoading,this),e.on(_.FRAG_LOADED,this.onFragLoaded,this),e.on(_.FRAG_BUFFERED,this.onFragBuffered,this),e.on(_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(_.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(_.ERROR,this.onError,this)},t.unregisterListeners=function(){var e=this.hls;e&&(e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.FRAG_LOADING,this.onFragLoading,this),e.off(_.FRAG_LOADED,this.onFragLoaded,this),e.off(_.FRAG_BUFFERED,this.onFragBuffered,this),e.off(_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(_.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(_.ERROR,this.onError,this))},t.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null},t.onManifestLoading=function(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()},t.onLevelsUpdated=function(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null},t.onMaxAutoLevelUpdated=function(){this.firstSelection=-1,this.nextAutoLevelKey=""},t.onFragLoading=function(e,t){var r,n=t.frag;this.ignoreFragment(n)||(n.bitrateTest||(this.fragCurrent=n,this.partCurrent=null!=(r=t.part)?r:null),this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100))},t.onLevelSwitching=function(e,t){this.clearTimer()},t.onError=function(e,t){if(!t.fatal)switch(t.details){case E.BUFFER_ADD_CODEC_ERROR:case E.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case E.FRAG_LOAD_TIMEOUT:var r=t.frag,n=this.fragCurrent,a=this.partCurrent;if(r&&n&&r.sn===n.sn&&r.level===n.level){var i=performance.now(),o=a?a.stats:r.stats,s=i-o.loading.start,l=o.loading.first?o.loading.first-o.loading.start:-1;if(o.loaded&&l>-1){var u=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(s-Math.min(u,l),o.loaded)}else this.bwEstimator.sampleTTFB(s)}}},t.getTimeToLoadFrag=function(e,t,r,n){return e+r/t+(n?this.lastLevelLoadSec:0)},t.onLevelLoaded=function(e,t){var r=this.hls.config,n=t.stats.loading,a=n.end-n.start;g(a)&&(this.lastLevelLoadSec=a/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)},t.onFragLoaded=function(e,t){var r=t.frag,n=t.part,a=n?n.stats:r.stats;if(r.type===Tt&&this.bwEstimator.sampleTTFB(a.loading.first-a.loading.start),!this.ignoreFragment(r)){if(this.clearTimer(),r.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){var i=n?n.duration:r.duration,o=this.hls.levels[r.level],s=(o.loaded?o.loaded.bytes:0)+a.loaded,l=(o.loaded?o.loaded.duration:0)+i;o.loaded={bytes:s,duration:l},o.realBitrate=Math.round(8*s/l)}if(r.bitrateTest){var u={stats:a,frag:r,part:n,id:r.type};this.onFragBuffered(_.FRAG_BUFFERED,u),r.bitrateTest=!1}else this.lastLoadedFragLevel=r.level}},t.onFragBuffered=function(e,t){var r=t.frag,n=t.part,a=null!=n&&n.stats.loaded?n.stats:r.stats;if(!a.aborted&&!this.ignoreFragment(r)){var i=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(i,a.loaded),a.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=i/1e3:this.bitrateTestDelay=0}},t.ignoreFragment=function(e){return e.type!==Tt||"initSegment"===e.sn},t.clearTimer=function(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)},t.getAutoLevelKey=function(){return this.getBwEstimate()+"_"+this.getStarvationDelay().toFixed(2)},t.getNextABRAutoLevel=function(){var e=this.fragCurrent,t=this.partCurrent,r=this.hls,n=r.maxAutoLevel,a=r.config,i=r.minAutoLevel,o=t?t.duration:e?e.duration:0,s=this.getBwEstimate(),l=this.getStarvationDelay(),u=a.abrBandWidthFactor,c=a.abrBandWidthUpFactor;if(l){var d=this.findBestLevel(s,i,n,l,0,u,c);if(d>=0)return d}var p=o?Math.min(o,a.maxStarvationDelay):a.maxStarvationDelay;if(!l){var h=this.bitrateTestDelay;h&&(p=(o?Math.min(o,a.maxLoadingDelay):a.maxLoadingDelay)-h,C.info("[abr] bitrate test took "+Math.round(1e3*h)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),u=c=1)}var f=this.findBestLevel(s,i,n,l,p,u,c);if(C.info("[abr] "+(l?"rebuffering expected":"buffer is empty")+", optimal quality level "+f),f>-1)return f;var m=r.levels[i],g=r.levels[r.loadLevel];return(null==m?void 0:m.bitrate)<(null==g?void 0:g.bitrate)?i:r.loadLevel},t.getStarvationDelay=function(){var e=this.hls,t=e.media;if(!t)return 1/0;var r=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,n=e.mainForwardBufferInfo;return(n?n.len:0)/r},t.getBwEstimate=function(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate},t.findBestLevel=function(e,t,r,n,a,i,o){var s,l=this,u=n+a,c=this.lastLoadedFragLevel,d=-1===c?this.hls.firstLevel:c,p=this.fragCurrent,h=this.partCurrent,f=this.hls,m=f.levels,y=f.allAudioTracks,v=f.loadLevel,_=f.config;if(1===m.length)return 0;var k,E=m[d],b=!(null==E||null==(s=E.details)||!s.live),T=-1===v||-1===c,A="SDR",S=(null==E?void 0:E.frameRate)||0,P=_.audioPreference,x=_.videoPreference,w=this.audioTracksByGroup||(this.audioTracksByGroup=function(e){return e.reduce((function(e,t){var r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);var n=t.channels||"2";return r.channels[n]=(r.channels[n]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e}),{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}(y));if(T){if(-1!==this.firstSelection)return this.firstSelection;var I=this.codecTiers||(this.codecTiers=function(e,t,r,n){return e.slice(r,n+1).reduce((function(e,r){if(!r.codecSet)return e;var n=r.audioGroups,a=e[r.codecSet];a||(e[r.codecSet]=a={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!n,fragmentError:0}),a.minBitrate=Math.min(a.minBitrate,r.bitrate);var i=Math.min(r.height,r.width);return a.minHeight=Math.min(a.minHeight,i),a.minFramerate=Math.min(a.minFramerate,r.frameRate),a.maxScore=Math.max(a.maxScore,r.score),a.fragmentError+=r.fragmentError,a.videoRanges[r.videoRange]=(a.videoRanges[r.videoRange]||0)+1,n&&n.forEach((function(e){if(e){var r=t.groups[e];r&&(a.hasDefaultAudio=a.hasDefaultAudio||t.hasDefaultAudio?r.hasDefault:r.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(r.channels).forEach((function(e){a.channels[e]=(a.channels[e]||0)+r.channels[e]})))}})),e}),{})}(m,w,t,r)),M=function(e,t,r,n,a){for(var i=Object.keys(e),o=null==n?void 0:n.channels,s=null==n?void 0:n.audioCodec,l=o&&2===parseInt(o),u=!0,c=!1,d=1/0,p=1/0,h=1/0,f=0,m=[],y=function(e,t){var r=!1,n=[];return e&&(r="SDR"!==e,n=[e]),t&&(n=t.allowedVideoRanges||Gt.slice(0),n=(r=void 0!==t.preferHDR?t.preferHDR:function(){if("function"==typeof matchMedia){var e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}())?n.filter((function(e){return"SDR"!==e})):["SDR"]),{preferHDR:r,allowedVideoRanges:n}}(t,a),v=y.preferHDR,_=y.allowedVideoRanges,k=function(){var t=e[i[E]];u=t.channels[2]>0,d=Math.min(d,t.minHeight),p=Math.min(p,t.minFramerate),h=Math.min(h,t.minBitrate);var r=_.filter((function(e){return t.videoRanges[e]>0}));r.length>0&&(c=!0,m=r)},E=i.length;E--;)k();d=g(d)?d:0,p=g(p)?p:0;var b=Math.max(1080,d),T=Math.max(30,p);return h=g(h)?h:r,r=Math.max(h,r),c||(t=void 0,m=[]),{codecSet:i.reduce((function(t,n){var a=e[n];if(n===t)return t;if(a.minBitrate>r)return vr(n,"min bitrate of "+a.minBitrate+" > current estimate of "+r),t;if(!a.hasDefaultAudio)return vr(n,"no renditions with default or auto-select sound found"),t;if(s&&n.indexOf(s.substring(0,4))%5!=0)return vr(n,'audio codec preference "'+s+'" not found'),t;if(o&&!l){if(!a.channels[o])return vr(n,"no renditions with "+o+" channel sound found (channels options: "+Object.keys(a.channels)+")"),t}else if((!s||l)&&u&&0===a.channels[2])return vr(n,"no renditions with stereo sound found"),t;return a.minHeight>b?(vr(n,"min resolution of "+a.minHeight+" > maximum of "+b),t):a.minFramerate>T?(vr(n,"min framerate of "+a.minFramerate+" > maximum of "+T),t):m.some((function(e){return a.videoRanges[e]>0}))?a.maxScore<f?(vr(n,"max score of "+a.maxScore+" < selected max of "+f),t):t&&(tt(n)>=tt(t)||a.fragmentError>e[t].fragmentError)?t:(f=a.maxScore,n):(vr(n,"no variants with VIDEO-RANGE of "+JSON.stringify(m)+" found"),t)}),void 0),videoRanges:m,preferHDR:v,minFramerate:p,minBitrate:h}}(I,A,e,P,x),R=M.codecSet,D=M.videoRanges,O=M.minFramerate,L=M.minBitrate,N=M.preferHDR;k=R,A=N?D[D.length-1]:D[0],S=O,e=Math.max(e,L),C.log("[abr] picked start tier "+JSON.stringify(M))}else k=null==E?void 0:E.codecSet,A=null==E?void 0:E.videoRange;for(var U,j=h?h.duration:p?p.duration:0,B=this.bwEstimator.getEstimateTTFB()/1e3,F=[],V=function(){var t,s=m[H],p=H>d;if(!s)return 0;if(_.useMediaCapabilities&&!s.supportedResult&&!s.supportedPromise){var f=navigator.mediaCapabilities;"function"==typeof(null==f?void 0:f.decodingInfo)&&function(e,t,r,n,a,i){var o=e.audioCodec?e.audioGroups:null,s=null==i?void 0:i.audioCodec,l=null==i?void 0:i.channels,u=l?parseInt(l):s?1/0:2,c=null;if(null!=o&&o.length)try{c=1===o.length&&o[0]?t.groups[o[0]].channels:o.reduce((function(e,r){if(r){var n=t.groups[r];if(!n)throw new Error("Audio track group "+r+" not found");Object.keys(n.channels).forEach((function(t){e[t]=(e[t]||0)+n.channels[t]}))}return e}),{2:0})}catch(e){return!0}return void 0!==e.videoCodec&&(e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(n,30)||"SDR"!==e.videoRange&&e.videoRange!==r||e.bitrate>Math.max(a,8e6))||!!c&&g(u)&&Object.keys(c).some((function(e){return parseInt(e)>u}))}(s,w,A,S,e,P)?(s.supportedPromise=yr(s,w,f),s.supportedPromise.then((function(e){if(l.hls){s.supportedResult=e;var t=l.hls.levels,r=t.indexOf(s);e.error?C.warn('[abr] MediaCapabilities decodingInfo error: "'+e.error+'" for level '+r+" "+JSON.stringify(e)):e.supported||(C.warn("[abr] Unsupported MediaCapabilities decodingInfo result for level "+r+" "+JSON.stringify(e)),r>-1&&t.length>1&&(C.log("[abr] Removing unsupported level "+r),l.hls.removeLevel(r)))}}))):s.supportedResult=mr}if(k&&s.codecSet!==k||A&&s.videoRange!==A||p&&S>s.frameRate||!p&&S>0&&S<s.frameRate||s.supportedResult&&(null==(t=s.supportedResult.decodingInfoResults)||!t[0].smooth))return F.push(H),0;var y,x=s.details,I=(h?null==x?void 0:x.partTarget:null==x?void 0:x.averagetargetduration)||j;y=p?o*e:i*e;var M=j&&n>=2*j&&0===a?m[H].averageBitrate:m[H].maxBitrate,R=l.getTimeToLoadFrag(B,y,M*I,void 0===x);if(y>=M&&(H===c||0===s.loadError&&0===s.fragmentError)&&(R<=B||!g(R)||b&&!l.bitrateTestDelay||R<u)){var D=l.forcedAutoLevel;return H===v||-1!==D&&D===v||(F.length&&C.trace("[abr] Skipped level(s) "+F.join(",")+" of "+r+' max with CODECS and VIDEO-RANGE:"'+m[F[0]].codecs+'" '+m[F[0]].videoRange+'; not compatible with "'+E.codecs+'" '+A),C.info("[abr] switch candidate:"+d+"->"+H+" adjustedbw("+Math.round(y)+")-bitrate="+Math.round(y-M)+" ttfb:"+B.toFixed(1)+" avgDuration:"+I.toFixed(1)+" maxFetchDuration:"+u.toFixed(1)+" fetchDuration:"+R.toFixed(1)+" firstSelection:"+T+" codecSet:"+k+" videoRange:"+A+" hls.loadLevel:"+v)),T&&(l.firstSelection=H),{v:H}}},H=r;H>=t;H--)if(0!==(U=V())&&U)return U.v;return-1},o(e,[{key:"firstAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.minAutoLevel,n=this.getBwEstimate(),a=this.hls.config.maxStarvationDelay,i=this.findBestLevel(n,r,t,0,a,1,1);if(i>-1)return i;var o=this.hls.firstLevel,s=Math.min(Math.max(o,r),t);return C.warn("[abr] Could not find best starting auto level. Defaulting to first in playlist "+o+" clamped to "+s),s}},{key:"forcedAutoLevel",get:function(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}},{key:"nextAutoLevel",get:function(){var e=this.forcedAutoLevel,t=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(!(-1===e||t&&r&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return e;var n=t&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){var a=this.hls.levels;if(a.length>Math.max(e,n)&&a[e].loadError<=a[n].loadError)return e}return this._nextAutoLevel=n,this.nextAutoLevelKey=this.getAutoLevelKey(),n},set:function(e){var t=this.hls,r=t.maxAutoLevel,n=t.minAutoLevel,a=Math.min(Math.max(e,n),r);this._nextAutoLevel!==a&&(this.nextAutoLevelKey="",this._nextAutoLevel=a)}}]),e}(),Ar=function(){function e(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},t.onHandlerDestroyed=function(){},t.hasInterval=function(){return!!this._tickInterval},t.hasNextTick=function(){return!!this._tickTimer},t.setInterval=function(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)},t.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},t.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},t.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},t.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},t.doTick=function(){},e}(),Sr="NOT_LOADED",Cr="APPENDING",Pr="PARTIAL",xr="OK",wr=function(){function e(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}var t=e.prototype;return t._registerListeners=function(){var e=this.hls;e.on(_.BUFFER_APPENDED,this.onBufferAppended,this),e.on(_.FRAG_BUFFERED,this.onFragBuffered,this),e.on(_.FRAG_LOADED,this.onFragLoaded,this)},t._unregisterListeners=function(){var e=this.hls;e.off(_.BUFFER_APPENDED,this.onBufferAppended,this),e.off(_.FRAG_BUFFERED,this.onFragBuffered,this),e.off(_.FRAG_LOADED,this.onFragLoaded,this)},t.destroy=function(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null},t.getAppendedFrag=function(e,t){var r=this.activePartLists[t];if(r)for(var n=r.length;n--;){var a=r[n];if(!a)break;var i=a.end;if(a.start<=e&&null!==i&&e<=i)return a}return this.getBufferedFrag(e,t)},t.getBufferedFrag=function(e,t){for(var r=this.fragments,n=Object.keys(r),a=n.length;a--;){var i=r[n[a]];if((null==i?void 0:i.body.type)===t&&i.buffered){var o=i.body;if(o.start<=e&&e<=o.end)return o}}return null},t.detectEvictedFragments=function(e,t,r,n){var a=this;this.timeRanges&&(this.timeRanges[e]=t);var i=(null==n?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach((function(n){var o=a.fragments[n];if(o&&!(i>=o.body.sn))if(o.buffered||o.loaded){var s=o.range[e];s&&s.time.some((function(e){var r=!a.isTimeBuffered(e.startPTS,e.endPTS,t);return r&&a.removeFragment(o.body),r}))}else o.body.type===r&&a.removeFragment(o.body)}))},t.detectPartialFragments=function(e){var t=this,r=this.timeRanges,n=e.frag,a=e.part;if(r&&"initSegment"!==n.sn){var i=Mr(n),o=this.fragments[i];if(!(!o||o.buffered&&n.gap)){var s=!n.relurl;Object.keys(r).forEach((function(e){var i=n.elementaryStreams[e];if(i){var l=r[e],u=s||!0===i.partial;o.range[e]=t.getBufferedTimes(n,a,u,l)}})),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,(o.body.endList=n.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),Ir(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}}},t.removeParts=function(e,t){var r=this.activePartLists[t];r&&(this.activePartLists[t]=r.filter((function(t){return t.fragment.sn>=e})))},t.fragBuffered=function(e,t){var r=Mr(e),n=this.fragments[r];!n&&t&&(n=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)},t.getBufferedTimes=function(e,t,r,n){for(var a={time:[],partial:r},i=e.start,o=e.end,s=e.minEndPTS||o,l=e.maxStartPTS||i,u=0;u<n.length;u++){var c=n.start(u)-this.bufferPadding,d=n.end(u)+this.bufferPadding;if(l>=c&&s<=d){a.time.push({startPTS:Math.max(i,n.start(u)),endPTS:Math.min(o,n.end(u))});break}if(i<d&&o>c){var p=Math.max(i,n.start(u)),h=Math.min(o,n.end(u));h>p&&(a.partial=!0,a.time.push({startPTS:p,endPTS:h}))}else if(o<=c)break}return a},t.getPartialFragment=function(e){var t,r,n,a=null,i=0,o=this.bufferPadding,s=this.fragments;return Object.keys(s).forEach((function(l){var u=s[l];u&&Ir(u)&&(r=u.body.start-o,n=u.body.end+o,e>=r&&e<=n&&(t=Math.min(e-r,n-e),i<=t&&(a=u.body,i=t)))})),a},t.isEndListAppended=function(e){var t=this.endListFragments[e];return void 0!==t&&(t.buffered||Ir(t))},t.getState=function(e){var t=Mr(e),r=this.fragments[t];return r?r.buffered?Ir(r)?Pr:xr:Cr:Sr},t.isTimeBuffered=function(e,t,r){for(var n,a,i=0;i<r.length;i++){if(n=r.start(i)-this.bufferPadding,a=r.end(i)+this.bufferPadding,e>=n&&t<=a)return!0;if(t<=n)return!1}return!1},t.onFragLoaded=function(e,t){var r=t.frag,n=t.part;if("initSegment"!==r.sn&&!r.bitrateTest){var a=n?null:t,i=Mr(r);this.fragments[i]={body:r,appendedPTS:null,loaded:a,buffered:!1,range:Object.create(null)}}},t.onBufferAppended=function(e,t){var r=this,n=t.frag,a=t.part,i=t.timeRanges;if("initSegment"!==n.sn){var o=n.type;if(a){var s=this.activePartLists[o];s||(this.activePartLists[o]=s=[]),s.push(a)}this.timeRanges=i,Object.keys(i).forEach((function(e){var t=i[e];r.detectEvictedFragments(e,t,o,a)}))}},t.onFragBuffered=function(e,t){this.detectPartialFragments(t)},t.hasFragment=function(e){var t=Mr(e);return!!this.fragments[t]},t.hasParts=function(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)},t.removeFragmentsInRange=function(e,t,r,n,a){var i=this;n&&!this.hasGaps||Object.keys(this.fragments).forEach((function(o){var s=i.fragments[o];if(s){var l=s.body;l.type!==r||n&&!l.gap||l.start<t&&l.end>e&&(s.buffered||a)&&i.removeFragment(l)}}))},t.removeFragment=function(e){var t=Mr(e);e.stats.loaded=0,e.clearElementaryStreamInfo();var r=this.activePartLists[e.type];if(r){var n=e.sn;this.activePartLists[e.type]=r.filter((function(e){return e.fragment.sn!==n}))}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]},t.removeAllFragments=function(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1},e}();function Ir(e){var t,r,n;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(r=e.range.audio)?void 0:r.partial)||(null==(n=e.range.audiovideo)?void 0:n.partial))}function Mr(e){return e.type+"_"+e.level+"_"+e.sn}var Rr={length:0,start:function(){return 0},end:function(){return 0}},Dr=function(){function e(){}return e.isBuffered=function(t,r){try{if(t)for(var n=e.getBuffered(t),a=0;a<n.length;a++)if(r>=n.start(a)&&r<=n.end(a))return!0}catch(e){}return!1},e.bufferInfo=function(t,r,n){try{if(t){var a,i=e.getBuffered(t),o=[];for(a=0;a<i.length;a++)o.push({start:i.start(a),end:i.end(a)});return this.bufferedInfo(o,r,n)}}catch(e){}return{len:0,start:r,end:r,nextStart:void 0}},e.bufferedInfo=function(e,t,r){t=Math.max(0,t),e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var n=[];if(r)for(var a=0;a<e.length;a++){var i=n.length;if(i){var o=n[i-1].end;e[a].start-o<r?e[a].end>o&&(n[i-1].end=e[a].end):n.push(e[a])}else n.push(e[a])}else n=e;for(var s,l=0,u=t,c=t,d=0;d<n.length;d++){var p=n[d].start,h=n[d].end;if(t+r>=p&&t<h)u=p,l=(c=h)-t;else if(t+r<p){s=p;break}}return{len:l,start:u||0,end:c||0,nextStart:s}},e.getBuffered=function(e){try{return e.buffered}catch(e){return C.log("failed to get media.buffered",e),Rr}},e}(),Or=function(e,t,r,n,a,i){void 0===n&&(n=0),void 0===a&&(a=-1),void 0===i&&(i=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=r,this.size=n,this.part=a,this.partial=i};function Lr(e,t){for(var r=0,n=e.length;r<n;r++){var a;if((null==(a=e[r])?void 0:a.cc)===t)return e[r]}return null}function Nr(e,t){if(e){var r=e.start+t;e.start=e.startPTS=r,e.endPTS=r+e.duration}}function Ur(e,t){for(var r=t.fragments,n=0,a=r.length;n<a;n++)Nr(r[n],e);t.fragmentHint&&Nr(t.fragmentHint,e),t.alignedSliding=!0}function jr(e,t){if(e.hasProgramDateTime&&t.hasProgramDateTime){var r=e.fragments,n=t.fragments;if(r.length&&n.length){var a,i,o=Math.min(t.endCC,e.endCC);t.startCC<o&&e.startCC<o&&(a=Lr(n,o),i=Lr(r,o)),a&&i||(i=Lr(r,(a=n[Math.floor(n.length/2)]).cc)||r[Math.floor(r.length/2)]);var s=a.programDateTime,l=i.programDateTime;s&&l&&Ur((l-s)/1e3-(i.start-a.start),e)}}}var Br=Math.pow(2,17),Fr=function(){function e(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}var t=e.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.abort=function(){this.loader&&this.loader.abort()},t.load=function(e,t){var r=this,a=e.url;if(!a)return Promise.reject(new Gr({type:k.NETWORK_ERROR,details:E.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(a?"part list":"url")),networkDetails:null}));this.abort();var i=this.config,o=i.fLoader,s=i.loader;return new Promise((function(l,u){if(r.loader&&r.loader.destroy(),e.gap){if(e.tagList.some((function(e){return"GAP"===e[0]})))return void u(Hr(e));e.gap=!1}var c=r.loader=e.loader=o?new o(i):new s(i),d=Vr(e),p=ir(i.fragLoadPolicy.default),h={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:Br};e.stats=c.stats,c.load(d,h,{onSuccess:function(t,n,a,i){r.resetLoader(e,c);var o=t.data;a.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(o.slice(0,16)),o=o.slice(16)),l({frag:e,part:null,payload:o,networkDetails:i})},onError:function(t,i,o,s){r.resetLoader(e,c),u(new Gr({type:k.NETWORK_ERROR,details:E.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:n({url:a,data:void 0},t),error:new Error("HTTP Error "+t.code+" "+t.text),networkDetails:o,stats:s}))},onAbort:function(t,n,a){r.resetLoader(e,c),u(new Gr({type:k.NETWORK_ERROR,details:E.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:a,stats:t}))},onTimeout:function(t,n,a){r.resetLoader(e,c),u(new Gr({type:k.NETWORK_ERROR,details:E.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error("Timeout after "+h.timeout+"ms"),networkDetails:a,stats:t}))},onProgress:function(r,n,a,i){t&&t({frag:e,part:null,payload:a,networkDetails:i})}})}))},t.loadPart=function(e,t,r){var a=this;this.abort();var i=this.config,o=i.fLoader,s=i.loader;return new Promise((function(l,u){if(a.loader&&a.loader.destroy(),e.gap||t.gap)u(Hr(e,t));else{var c=a.loader=e.loader=o?new o(i):new s(i),d=Vr(e,t),p=ir(i.fragLoadPolicy.default),h={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Br};t.stats=c.stats,c.load(d,h,{onSuccess:function(n,i,o,s){a.resetLoader(e,c),a.updateStatsFromPart(e,t);var u={frag:e,part:t,payload:n.data,networkDetails:s};r(u),l(u)},onError:function(r,i,o,s){a.resetLoader(e,c),u(new Gr({type:k.NETWORK_ERROR,details:E.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:n({url:d.url,data:void 0},r),error:new Error("HTTP Error "+r.code+" "+r.text),networkDetails:o,stats:s}))},onAbort:function(r,n,i){e.stats.aborted=t.stats.aborted,a.resetLoader(e,c),u(new Gr({type:k.NETWORK_ERROR,details:E.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:i,stats:r}))},onTimeout:function(r,n,i){a.resetLoader(e,c),u(new Gr({type:k.NETWORK_ERROR,details:E.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error("Timeout after "+h.timeout+"ms"),networkDetails:i,stats:r}))}})}}))},t.updateStatsFromPart=function(e,t){var r=e.stats,n=t.stats,a=n.total;if(r.loaded+=n.loaded,a){var i=Math.round(e.duration/t.duration),o=Math.min(Math.round(r.loaded/a),i),s=(i-o)*Math.round(r.loaded/o);r.total=r.loaded+s}else r.total=Math.max(r.loaded,r.total);var l=r.loading,u=n.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end},t.resetLoader=function(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()},e}();function Vr(e,t){void 0===t&&(t=null);var r=t||e,n={frag:e,part:t,responseType:"arraybuffer",url:r.url,headers:{},rangeStart:0,rangeEnd:0},a=r.byteRangeStartOffset,i=r.byteRangeEndOffset;if(g(a)&&g(i)){var o,s=a,l=i;if("initSegment"===e.sn&&"AES-128"===(null==(o=e.decryptdata)?void 0:o.method)){var u=i-a;u%16&&(l=i+(16-u%16)),0!==a&&(n.resetIV=!0,s=a-16)}n.rangeStart=s,n.rangeEnd=l}return n}function Hr(e,t){var r=new Error("GAP "+(e.gap?"tag":"attribute")+" found"),n={type:k.MEDIA_ERROR,details:E.FRAG_GAP,fatal:!1,frag:e,error:r,networkDetails:null};return t&&(n.part=t),(t||e).stats.aborted=!0,new Gr(n)}var Gr=function(e){function t(t){var r;return(r=e.call(this,t.error.message)||this).data=void 0,r.data=t,r}return l(t,e),t}(p(Error)),$r=function(){function e(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),Kr=function(){function e(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}(),Wr=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),n=0;n<4;n++)r[n]=t.getUint32(4*n);return r},t.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],a=r[1],i=r[2],o=r[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],d=s[3],p=new Uint32Array(256),h=0,f=0,m=0;for(m=0;m<256;m++)p[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var g=f^f<<1^f<<2^f<<3^f<<4;g=g>>>8^255&g^99,e[h]=g,t[g]=h;var y=p[h],v=p[y],_=p[v],k=257*p[g]^16843008*g;n[h]=k<<24|k>>>8,a[h]=k<<16|k>>>16,i[h]=k<<8|k>>>24,o[h]=k,k=16843009*_^65537*v^257*y^16843008*h,l[g]=k<<24|k>>>8,u[g]=k<<16|k>>>16,c[g]=k<<8|k>>>24,d[g]=k,h?(h=y^p[p[p[_^y]]],f^=p[p[f]]):h=f=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,n=0;n<t.length&&r;)r=t[n]===this.key[n],n++;if(!r){this.key=t;var a=this.keySize=t.length;if(4!==a&&6!==a&&8!==a)throw new Error("Invalid aes key size="+a);var i,o,s,l,u=this.ksRows=4*(a+6+1),c=this.keySchedule=new Uint32Array(u),d=this.invKeySchedule=new Uint32Array(u),p=this.sBox,h=this.rcon,f=this.invSubMix,m=f[0],g=f[1],y=f[2],v=f[3];for(i=0;i<u;i++)i<a?s=c[i]=t[i]:(l=s,i%a==0?(l=p[(l=l<<8|l>>>24)>>>24]<<24|p[l>>>16&255]<<16|p[l>>>8&255]<<8|p[255&l],l^=h[i/a|0]<<24):a>6&&i%a==4&&(l=p[l>>>24]<<24|p[l>>>16&255]<<16|p[l>>>8&255]<<8|p[255&l]),c[i]=s=(c[i-a]^l)>>>0);for(o=0;o<u;o++)i=u-o,l=3&o?c[i]:c[i-4],d[o]=o<4||i<=4?l:m[p[l>>>24]]^g[p[l>>>16&255]]^y[p[l>>>8&255]]^v[p[255&l]],d[o]=d[o]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,r){for(var n,a,i,o,s,l,u,c,d,p,h,f,m,g,y=this.keySize+6,v=this.invKeySchedule,_=this.invSBox,k=this.invSubMix,E=k[0],b=k[1],T=k[2],A=k[3],S=this.uint8ArrayToUint32Array_(r),C=S[0],P=S[1],x=S[2],w=S[3],I=new Int32Array(e),M=new Int32Array(I.length),R=this.networkToHostOrderSwap;t<I.length;){for(d=R(I[t]),p=R(I[t+1]),h=R(I[t+2]),f=R(I[t+3]),s=d^v[0],l=f^v[1],u=h^v[2],c=p^v[3],m=4,g=1;g<y;g++)n=E[s>>>24]^b[l>>16&255]^T[u>>8&255]^A[255&c]^v[m],a=E[l>>>24]^b[u>>16&255]^T[c>>8&255]^A[255&s]^v[m+1],i=E[u>>>24]^b[c>>16&255]^T[s>>8&255]^A[255&l]^v[m+2],o=E[c>>>24]^b[s>>16&255]^T[l>>8&255]^A[255&u]^v[m+3],s=n,l=a,u=i,c=o,m+=4;n=_[s>>>24]<<24^_[l>>16&255]<<16^_[u>>8&255]<<8^_[255&c]^v[m],a=_[l>>>24]<<24^_[u>>16&255]<<16^_[c>>8&255]<<8^_[255&s]^v[m+1],i=_[u>>>24]<<24^_[c>>16&255]<<16^_[s>>8&255]<<8^_[255&l]^v[m+2],o=_[c>>>24]<<24^_[s>>16&255]<<16^_[l>>8&255]<<8^_[255&u]^v[m+3],M[t]=R(n^C),M[t+1]=R(o^P),M[t+2]=R(i^x),M[t+3]=R(a^w),C=d,P=p,x=h,w=f,t+=4}return M.buffer},e}(),zr=function(){function e(e,t){var r=(void 0===t?{}:t).removePKCS7Padding,n=void 0===r||r;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=n,n)try{var a=self.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(e){}null===this.subtle&&(this.useSoftware=!0)}var t=e.prototype;return t.destroy=function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},t.isSync=function(){return this.useSoftware},t.flush=function(){var e=this.currentResult,t=this.remainderData;if(!e||t)return this.reset(),null;var r,n,a,i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?(a=(n=(r=i).byteLength)&&new DataView(r.buffer).getUint8(n-1))?ee(r,0,n-a):r:i},t.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},t.decrypt=function(e,t,r){var n=this;return this.useSoftware?new Promise((function(a,i){n.softwareDecrypt(new Uint8Array(e),t,r);var o=n.flush();o?a(o.buffer):i(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,r)},t.softwareDecrypt=function(e,t,r){var n=this.currentIV,a=this.currentResult,i=this.remainderData;this.logOnce("JS AES decrypt"),i&&(e=Ne(i,e),this.remainderData=null);var o=this.getValidChunk(e);if(!o.length)return null;n&&(r=n);var s=this.softwareDecrypter;s||(s=this.softwareDecrypter=new Wr),s.expandKey(t);var l=a;return this.currentResult=s.decrypt(o.buffer,0,r),this.currentIV=ee(o,-16).buffer,l||null},t.webCryptoDecrypt=function(e,t,r){var n=this,a=this.subtle;return this.key===t&&this.fastAesKey||(this.key=t,this.fastAesKey=new Kr(a,t)),this.fastAesKey.expandKey().then((function(t){return a?(n.logOnce("WebCrypto AES decrypt"),new $r(a,new Uint8Array(r)).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized"))})).catch((function(a){return C.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+a.name+": "+a.message),n.onWebCryptoError(e,t,r)}))},t.onWebCryptoError=function(e,t,r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r);var n=this.flush();if(n)return n.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")},t.getValidChunk=function(e){var t=e,r=e.length-e.length%16;return r!==e.length&&(t=ee(e,0,r),this.remainderData=ee(e,r)),t},t.logOnce=function(e){this.logEnabled&&(C.log("[decrypter]: "+e),this.logEnabled=!1)},e}(),qr="STOPPED",Yr="IDLE",Xr="KEY_LOADING",Zr="FRAG_LOADING",Qr="FRAG_LOADING_WAITING_RETRY",Jr="WAITING_TRACK",en="PARSING",tn="PARSED",rn="ENDED",nn="ERROR",an="WAITING_INIT_PTS",on="WAITING_LEVEL",sn=function(e){function t(t,r,n,a,i){var o;return(o=e.call(this)||this).hls=void 0,o.fragPrevious=null,o.fragCurrent=null,o.fragmentTracker=void 0,o.transmuxer=null,o._state=qr,o.playlistType=void 0,o.media=null,o.mediaBuffer=null,o.config=void 0,o.bitrateTest=!1,o.lastCurrentTime=0,o.nextLoadPosition=0,o.startPosition=0,o.startTimeOffset=null,o.loadedmetadata=!1,o.retryDate=0,o.levels=null,o.fragmentLoader=void 0,o.keyLoader=void 0,o.levelLastLoaded=null,o.startFragRequested=!1,o.decrypter=void 0,o.initPTS=[],o.onvseeking=null,o.onvended=null,o.logPrefix="",o.log=void 0,o.warn=void 0,o.playlistType=i,o.logPrefix=a,o.log=C.log.bind(C,a+":"),o.warn=C.warn.bind(C,a+":"),o.hls=t,o.fragmentLoader=new Fr(t.config),o.keyLoader=n,o.fragmentTracker=r,o.config=t.config,o.decrypter=new zr(t.config),t.on(_.MANIFEST_LOADED,o.onManifestLoaded,function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(o)),o}l(t,e);var r=t.prototype;return r.doTick=function(){this.onTickEnd()},r.onTickEnd=function(){},r.startLoad=function(e){},r.stopLoad=function(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);var e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=qr},r._streamEnded=function(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;var r=t.partList;if(null!=r&&r.length){var n=r[r.length-1];return Dr.isBuffered(this.media,n.start+n.duration/2)}var a=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(a)},r.getLevelDetails=function(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levelLastLoaded)?void 0:e.details},r.onMediaAttached=function(e,t){var r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),r.addEventListener("seeking",this.onvseeking),r.addEventListener("ended",this.onvended);var n=this.config;this.levels&&n.autoStartLoad&&this.state===qr&&this.startLoad(n.startPosition)},r.onMediaDetaching=function(){var e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},r.onMediaSeeking=function(){var e=this.config,t=this.fragCurrent,r=this.media,n=this.mediaBuffer,a=this.state,i=r?r.currentTime:0,o=Dr.bufferInfo(n||r,i,e.maxBufferHole);if(this.log("media seeking to "+(g(i)?i.toFixed(3):i)+", state: "+a),this.state===rn)this.resetLoadingState();else if(t){var s=e.maxFragLookUpTolerance,l=t.start-s,u=t.start+t.duration+s;if(!o.len||u<o.start||l>o.end){var c=i>u;(i<l||c)&&(c&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}r&&(this.fragmentTracker.removeFragmentsInRange(i,1/0,this.playlistType,!0),this.lastCurrentTime=i),this.loadedmetadata||o.len||(this.nextLoadPosition=this.startPosition=i),this.tickImmediate()},r.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},r.onManifestLoaded=function(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]},r.onHandlerDestroying=function(){this.hls.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),e.prototype.onHandlerDestroying.call(this),this.hls=null},r.onHandlerDestroyed=function(){this.state=qr,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,e.prototype.onHandlerDestroyed.call(this)},r.loadFragment=function(e,t,r){this._loadFragForPlayback(e,t,r)},r._loadFragForPlayback=function(e,t,r){var n=this;this._doFragLoad(e,t,r,(function(t){if(n.fragContextChanged(e))return n.warn("Fragment "+e.sn+(t.part?" p: "+t.part.index:"")+" of level "+e.level+" was dropped during download."),void n.fragmentTracker.removeFragment(e);e.stats.chunkCount++,n._handleFragmentLoadProgress(t)})).then((function(t){if(t){var r=n.state;n.fragContextChanged(e)?(r===Zr||!n.fragCurrent&&r===en)&&(n.fragmentTracker.removeFragment(e),n.state=Yr):("payload"in t&&(n.log("Loaded fragment "+e.sn+" of level "+e.level),n.hls.trigger(_.FRAG_LOADED,t)),n._handleFragmentLoadComplete(t))}})).catch((function(t){n.state!==qr&&n.state!==nn&&(n.warn(t),n.resetFragmentLoading(e))}))},r.clearTrackerIfNeeded=function(e){var t,r=this.fragmentTracker;if(r.getState(e)===Cr){var n=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,n),i=Math.max(e.duration,a?a.len:this.config.maxBufferLength);this.reduceMaxBufferLength(i)&&r.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===Pr&&r.removeFragment(e))},r.checkLiveUpdate=function(e){if(e.updated&&!e.live){var t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)},r.flushMainBuffer=function(e,t,r){if(void 0===r&&(r=null),e-t){var n={startOffset:e,endOffset:t,type:r};this.hls.trigger(_.BUFFER_FLUSHING,n)}},r._loadInitSegment=function(e,t){var r=this;this._doFragLoad(e,t).then((function(t){if(!t||r.fragContextChanged(e)||!r.levels)throw new Error("init load aborted");return t})).then((function(t){var n=r.hls,a=t.payload,i=e.decryptdata;if(a&&a.byteLength>0&&null!=i&&i.key&&i.iv&&"AES-128"===i.method){var o=self.performance.now();return r.decrypter.decrypt(new Uint8Array(a),i.key.buffer,i.iv.buffer).catch((function(t){throw n.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t})).then((function(a){var i=self.performance.now();return n.trigger(_.FRAG_DECRYPTED,{frag:e,payload:a,stats:{tstart:o,tdecrypt:i}}),t.payload=a,r.completeInitSegmentLoad(t)}))}return r.completeInitSegmentLoad(t)})).catch((function(t){r.state!==qr&&r.state!==nn&&(r.warn(t),r.resetFragmentLoading(e))}))},r.completeInitSegmentLoad=function(e){if(!this.levels)throw new Error("init load aborted, missing levels");var t=e.frag.stats;this.state=Yr,e.frag.data=new Uint8Array(e.payload),t.parsing.start=t.buffering.start=self.performance.now(),t.parsing.end=t.buffering.end=self.performance.now(),this.tick()},r.fragContextChanged=function(e){var t=this.fragCurrent;return!e||!t||e.sn!==t.sn||e.level!==t.level},r.fragBufferedComplete=function(e,t){var r,n,a,i,o=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log("Buffered "+e.type+" sn: "+e.sn+(t?" part: "+t.index:"")+" of "+(this.playlistType===Tt?"level":"track")+" "+e.level+" (frag:["+(null!=(r=e.startPTS)?r:NaN).toFixed(3)+"-"+(null!=(n=e.endPTS)?n:NaN).toFixed(3)+"] > buffer:"+(o?function(e){for(var t="",r=e.length,n=0;n<r;n++)t+="["+e.start(n).toFixed(3)+"-"+e.end(n).toFixed(3)+"]";return t}(Dr.getBuffered(o)):"(detached)")+")"),"initSegment"!==e.sn){var s;if(e.type!==St){var l=e.elementaryStreams;if(!Object.keys(l).some((function(e){return!!l[e]})))return void(this.state=Yr)}var u=null==(s=this.levels)?void 0:s[e.level];null!=u&&u.fragmentError&&(this.log("Resetting level fragment error count of "+u.fragmentError+" on frag buffered"),u.fragmentError=0)}this.state=Yr,o&&(!this.loadedmetadata&&e.type==Tt&&o.buffered.length&&(null==(a=this.fragCurrent)?void 0:a.sn)===(null==(i=this.fragPrevious)?void 0:i.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},r.seekToStartPos=function(){},r._handleFragmentLoadComplete=function(e){var t=this.transmuxer;if(t){var r=e.frag,n=e.part,a=e.partsLoaded,i=!a||0===a.length||a.some((function(e){return!e})),o=new Or(r.level,r.sn,r.stats.chunkCount+1,0,n?n.index:-1,!i);t.flush(o)}},r._handleFragmentLoadProgress=function(e){},r._doFragLoad=function(e,t,r,n){var a,i=this;void 0===r&&(r=null);var o=null==t?void 0:t.details;if(!this.levels||!o)throw new Error("frag load aborted, missing level"+(o?"":" detail")+"s");var s=null;if(!e.encrypted||null!=(a=e.decryptdata)&&a.key?!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments):(this.log("Loading key for "+e.sn+" of ["+o.startSN+"-"+o.endSN+"], "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+e.level),this.state=Xr,this.fragCurrent=e,s=this.keyLoader.load(e).then((function(e){if(!i.fragContextChanged(e.frag))return i.hls.trigger(_.KEY_LOADED,e),i.state===Xr&&(i.state=Yr),e})),this.hls.trigger(_.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(s=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),r=Math.max(e.start,r||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){var l=o.partList;if(l&&n){r>e.end&&o.fragmentHint&&(e=o.fragmentHint);var u=this.getNextPart(l,e,r);if(u>-1){var c,d=l[u];return this.log("Loading part sn: "+e.sn+" p: "+d.index+" cc: "+e.cc+" of playlist ["+o.startSN+"-"+o.endSN+"] parts [0-"+u+"-"+(l.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(r.toFixed(3))),this.nextLoadPosition=d.start+d.duration,this.state=Zr,c=s?s.then((function(r){return!r||i.fragContextChanged(r.frag)?null:i.doFragPartsLoad(e,d,t,n)})).catch((function(e){return i.handleFragLoadError(e)})):this.doFragPartsLoad(e,d,t,n).catch((function(e){return i.handleFragLoadError(e)})),this.hls.trigger(_.FRAG_LOADING,{frag:e,part:d,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):c}if(!e.url||this.loadedEndOfParts(l,r))return Promise.resolve(null)}}this.log("Loading fragment "+e.sn+" cc: "+e.cc+" "+(o?"of ["+o.startSN+"-"+o.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(r.toFixed(3))),g(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Zr;var p,h=this.config.progressive;return p=h&&s?s.then((function(t){return!t||i.fragContextChanged(null==t?void 0:t.frag)?null:i.fragmentLoader.load(e,n)})).catch((function(e){return i.handleFragLoadError(e)})):Promise.all([this.fragmentLoader.load(e,h?n:void 0),s]).then((function(e){var t=e[0];return!h&&t&&n&&n(t),t})).catch((function(e){return i.handleFragLoadError(e)})),this.hls.trigger(_.FRAG_LOADING,{frag:e,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):p},r.doFragPartsLoad=function(e,t,r,n){var a=this;return new Promise((function(i,o){var s,l=[],u=null==(s=r.details)?void 0:s.partList;!function t(s){a.fragmentLoader.loadPart(e,s,n).then((function(n){l[s.index]=n;var o=n.part;a.hls.trigger(_.FRAG_LOADED,n);var c=Jt(r,e.sn,s.index+1)||er(u,e.sn,s.index+1);if(!c)return i({frag:e,part:o,partsLoaded:l});t(c)})).catch(o)}(t)}))},r.handleFragLoadError=function(e){if("data"in e){var t=e.data;e.data&&t.details===E.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(_.ERROR,t)}else this.hls.trigger(_.ERROR,{type:k.OTHER_ERROR,details:E.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null},r._handleTransmuxerFlush=function(e){var t=this.getCurrentContext(e);if(t&&this.state===en){var r=t.frag,n=t.part,a=t.level,i=self.performance.now();r.stats.parsing.end=i,n&&(n.stats.parsing.end=i),this.updateLevelTiming(r,n,a,e.partial)}else this.fragCurrent||this.state===qr||this.state===nn||(this.state=Yr)},r.getCurrentContext=function(e){var t=this.levels,r=this.fragCurrent,n=e.level,a=e.sn,i=e.part;if(null==t||!t[n])return this.warn("Levels object was unset while buffering fragment "+a+" of level "+n+". The current chunk will not be buffered."),null;var o=t[n],s=i>-1?Jt(o,a,i):null,l=s?s.fragment:function(e,t,r){if(null==e||!e.details)return null;var n=e.details,a=n.fragments[t-n.startSN];return a||((a=n.fragmentHint)&&a.sn===t?a:t<n.startSN&&r&&r.sn===t?r:null)}(o,a,r);return l?(r&&r!==l&&(l.stats=r.stats),{frag:l,part:s,level:o}):null},r.bufferFragmentData=function(e,t,r,n,a){var i;if(e&&this.state===en){var o=e.data1,s=e.data2,l=o;if(o&&s&&(l=Ne(o,s)),null!=(i=l)&&i.length){var u={type:e.type,frag:t,part:r,chunkMeta:n,parent:t.type,data:l};if(this.hls.trigger(_.BUFFER_APPENDING,u),e.dropped&&e.independent&&!r){if(a)return;this.flushBufferGap(t)}}}},r.flushBufferGap=function(e){var t=this.media;if(t)if(Dr.isBuffered(t,t.currentTime)){var r=t.currentTime,n=Dr.bufferInfo(t,r,0),a=e.duration,i=Math.min(2*this.config.maxFragLookUpTolerance,.25*a),o=Math.max(Math.min(e.start-i,n.end-i),r+i);e.start-o>i&&this.flushMainBuffer(o,e.start)}else this.flushMainBuffer(0,e.start)},r.getFwdBufferInfo=function(e,t){var r=this.getLoadPosition();return g(r)?this.getFwdBufferInfoAtPos(e,r,t):null},r.getFwdBufferInfoAtPos=function(e,t,r){var n=this.config.maxBufferHole,a=Dr.bufferInfo(e,t,n);if(0===a.len&&void 0!==a.nextStart){var i=this.fragmentTracker.getBufferedFrag(t,r);if(i&&a.nextStart<i.end)return Dr.bufferInfo(e,t,Math.max(a.nextStart,n))}return a},r.getMaxBufferLength=function(e){var t,r=this.config;return t=e?Math.max(8*r.maxBufferSize/e,r.maxBufferLength):r.maxBufferLength,Math.min(t,r.maxMaxBufferLength)},r.reduceMaxBufferLength=function(e){var t=this.config,r=e||t.maxBufferLength;return t.maxMaxBufferLength>=r&&(t.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},r.getAppendedFrag=function(e,t){var r=this.fragmentTracker.getAppendedFrag(e,Tt);return r&&"fragment"in r?r.fragment:r},r.getNextFragment=function(e,t){var r=t.fragments,n=r.length;if(!n)return null;var a,i=this.config,o=r[0].start;if(t.live){var s=i.initialLiveManifestSize;if(n<s)return this.warn("Not enough fragments to start playback (have: "+n+", need: "+s+")"),null;(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<o)&&(a=this.getInitialLiveFragment(t,r),this.startPosition=this.nextLoadPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=o&&(a=r[0]);if(!a){var l=i.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(a)},r.isLoopLoading=function(e,t){var r=this.fragmentTracker.getState(e);return(r===xr||r===Pr&&!!e.gap)&&this.nextLoadPosition>t},r.getNextFragmentLoopLoading=function(e,t,r,n,a){var i=e.gap,o=this.getNextFragment(this.nextLoadPosition,t);if(null===o)return o;if(e=o,i&&e&&!e.gap&&r.nextStart){var s=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,n);if(null!==s&&r.len+s.len>=a)return this.log('buffer full after gaps in "'+n+'" playlist starting at sn: '+e.sn),null}return e},r.mapToInitFragWhenRequired=function(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment},r.getNextPart=function(e,t,r){for(var n=-1,a=!1,i=!0,o=0,s=e.length;o<s;o++){var l=e[o];if(i=i&&!l.independent,n>-1&&r<l.start)break;var u=l.loaded;u?n=-1:(a||l.independent||i)&&l.fragment===t&&(n=o),a=u}return n},r.loadedEndOfParts=function(e,t){var r=e[e.length-1];return r&&t>r.start&&r.loaded},r.getInitialLiveFragment=function(e,t){var r=this.fragPrevious,n=null;if(r){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),n=function(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!g(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;r=r||0;for(var n=0;n<e.length;++n){var a=e[n];if(cr(t,r,a))return a}return null}(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){var a=r.sn+1;if(a>=e.startSN&&a<=e.endSN){var i=t[a-e.startSN];r.cc===i.cc&&(n=i,this.log("Live playlist, switching playlist, load frag with next SN: "+n.sn))}n||(n=function(e,t){return sr(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}(t,r.cc),n&&this.log("Live playlist, switching playlist, load frag with same CC: "+n.sn))}}else{var o=this.hls.liveSyncPosition;null!==o&&(n=this.getFragmentAtPosition(o,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n},r.getFragmentAtPosition=function(e,t,r){var n,a=this.config,i=this.fragPrevious,o=r.fragments,s=r.endSN,l=r.fragmentHint,u=a.maxFragLookUpTolerance,c=r.partList,d=!!(a.lowLatencyMode&&null!=c&&c.length&&l);if(d&&l&&!this.bitrateTest&&(o=o.concat(l),s=l.sn),n=e<t?lr(i,o,e,e>t-u?0:u):o[o.length-1]){var p=n.sn-r.startSN,h=this.fragmentTracker.getState(n);if((h===xr||h===Pr&&n.gap)&&(i=n),i&&n.sn===i.sn&&(!d||c[0].fragment.sn>n.sn)&&i&&n.level===i.level){var f=o[p+1];n=n.sn<s&&this.fragmentTracker.getState(f)!==xr?f:null}}return n},r.synchronizeToLiveEdge=function(e){var t=this.config,r=this.media;if(r){var n=this.hls.liveSyncPosition,a=r.currentTime,i=e.fragments[0].start,o=e.edge,s=a>=i-t.maxFragLookUpTolerance&&a<=o;if(null!==n&&r.duration>n&&(a<n||!s)){var l=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!s&&r.readyState<4||a<o-l)&&(this.loadedmetadata||(this.nextLoadPosition=n),r.readyState&&(this.warn("Playback: "+a.toFixed(3)+" is located too far from the end of live sliding playlist: "+o+", reset currentTime to : "+n.toFixed(3)),r.currentTime=n))}}},r.alignPlaylists=function(e,t,r){var n=e.fragments.length;if(!n)return this.warn("No fragments in live playlist"),0;var a=e.fragments[0].start,i=!t,o=e.alignedSliding&&g(a);if(i||!o&&!a){var s=this.fragPrevious;!function(e,t,r){t&&(function(e,t,r){if(function(e,t,r){return!(!t||!(r.endCC>r.startCC||e&&e.cc<r.startCC))}(e,r,t)){var n=function(e,t){var r=e.fragments,n=t.fragments;if(n.length&&r.length){var a=Lr(r,n[0].cc);if(a&&(!a||a.startPTS))return a;C.log("No frag in previous level to align on")}else C.log("No fragments to align")}(r,t);n&&g(n.start)&&(C.log("Adjusting PTS using last level due to CC increase within current level "+t.url),Ur(n.start,t))}}(e,r,t),!r.alignedSliding&&t&&jr(r,t),r.alignedSliding||!t||r.skippedSegments||Zt(t,r))}(s,r,e);var l=e.fragments[0].start;return this.log("Live playlist sliding: "+l.toFixed(2)+" start-sn: "+(t?t.startSN:"na")+"->"+e.startSN+" prev-sn: "+(s?s.sn:"na")+" fragments: "+n),l}return a},r.waitForCdnTuneIn=function(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)},r.setStartPosition=function(e,t){var r=this.startPosition;if(r<t&&(r=-1),-1===r||-1===this.lastCurrentTime){var n=null!==this.startTimeOffset,a=n?this.startTimeOffset:e.startTimeOffset;null!==a&&g(a)?(r=t+a,a<0&&(r+=e.totalduration),r=Math.min(Math.max(t,r),t+e.totalduration),this.log("Start time offset "+a+" found in "+(n?"multivariant":"media")+" playlist, adjust startPosition to "+r),this.startPosition=r):e.live?r=this.hls.liveSyncPosition||t:this.startPosition=r=0,this.lastCurrentTime=r}this.nextLoadPosition=r},r.getLoadPosition=function(){var e=this.media,t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t},r.handleFragLoadAborted=function(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn("Fragment "+e.sn+(t?" part "+t.index:"")+" of level "+e.level+" was aborted"),this.resetFragmentLoading(e))},r.resetFragmentLoading=function(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Qr)||(this.state=Yr)},r.onFragmentOrKeyLoadError=function(e,t){if(t.chunkMeta&&!t.frag){var r=this.getCurrentContext(t.chunkMeta);r&&(t.frag=r.frag)}var n=t.frag;if(n&&n.type===e&&this.levels)if(this.fragContextChanged(n)){var a;this.warn("Frag load error must match current frag to retry "+n.url+" > "+(null==(a=this.fragCurrent)?void 0:a.url))}else{var i=t.details===E.FRAG_GAP;i&&this.fragmentTracker.fragBuffered(n,!0);var o=t.errorAction,s=o||{},l=s.action,u=s.retryCount,c=void 0===u?0:u,d=s.retryConfig;if(o&&5===l&&d){this.resetStartWhenNotLoaded(this.levelLastLoaded);var p=ar(d,c);this.warn("Fragment "+n.sn+" of "+e+" "+n.level+" errored with "+t.details+", retrying loading "+(c+1)+"/"+d.maxNumRetry+" in "+p+"ms"),o.resolved=!0,this.retryDate=self.performance.now()+p,this.state=Qr}else if(d&&o){if(this.resetFragmentErrors(e),!(c<d.maxNumRetry))return void C.warn(t.details+" reached or exceeded max retry ("+c+")");i||3===l||(o.resolved=!0)}else 2===(null==o?void 0:o.action)?this.state=on:this.state=nn;this.tickImmediate()}},r.reduceLengthAndFlushBuffer=function(e){if(this.state===en||this.state===tn){var t=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,t),n=r&&r.len>.5;n&&this.reduceMaxBufferLength(r.len);var a=!n;return a&&this.warn("Buffer full error while media.currentTime is not buffered, flush "+t+" buffer"),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),a}return!1},r.resetFragmentErrors=function(e){e===At&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==qr&&(this.state=Yr)},r.afterBufferFlushed=function(e,t,r){if(e){var n=Dr.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,n,r),this.state===rn&&this.resetLoadingState()}},r.resetLoadingState=function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Yr},r.resetStartWhenNotLoaded=function(e){if(!this.loadedmetadata){this.startFragRequested=!1;var t=e?e.details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},r.resetWhenMissingContext=function(e){this.warn("The loading context changed while buffering fragment "+e.sn+" of level "+e.level+". This chunk will not be buffered."),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()},r.removeUnbufferedFrags=function(e){void 0===e&&(e=0),this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)},r.updateLevelTiming=function(e,t,r,n){var a,i=this,o=r.details;if(o){if(!Object.keys(e.elementaryStreams).reduce((function(t,a){var s=e.elementaryStreams[a];if(s){var l=s.endPTS-s.startPTS;if(l<=0)return i.warn("Could not parse fragment "+e.sn+" "+a+" duration reliably ("+l+")"),t||!1;var u=n?0:Yt(o,e,s.startPTS,s.endPTS,s.startDTS,s.endDTS);return i.hls.trigger(_.LEVEL_PTS_UPDATED,{details:o,level:r,drift:u,type:a,frag:e,start:s.startPTS,end:s.endPTS}),!0}return t}),!1)&&null===(null==(a=this.transmuxer)?void 0:a.error)){var s=new Error("Found no media in fragment "+e.sn+" of level "+e.level+" resetting transmuxer to fallback to playlist timing");if(0===r.fragmentError&&(r.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(s.message),this.hls.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.FRAG_PARSING_ERROR,fatal:!1,error:s,frag:e,reason:"Found no media in msn "+e.sn+' of level "'+r.url+'"'}),!this.hls)return;this.resetTransmuxer()}this.state=tn,this.hls.trigger(_.FRAG_PARSED,{frag:e,part:t})}else this.warn("level.details undefined")},r.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},r.recoverWorkerError=function(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())},o(t,[{key:"state",get:function(){return this._state},set:function(e){var t=this._state;t!==e&&(this._state=e,this.log(t+"->"+e))}}]),t}(Ar),ln=function(){function e(){this.chunks=[],this.dataLength=0}var t=e.prototype;return t.push=function(e){this.chunks.push(e),this.dataLength+=e.length},t.flush=function(){var e,t=this.chunks,r=this.dataLength;return t.length?(e=1===t.length?t[0]:function(e,t){for(var r=new Uint8Array(t),n=0,a=0;a<e.length;a++){var i=e[a];r.set(i,n),n+=i.length}return r}(t,r),this.reset(),e):new Uint8Array(0)},t.reset=function(){this.chunks.length=0,this.dataLength=0},e}();function un(e,t){return void 0===e&&(e=""),void 0===t&&(t=9e4),{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}var cn=function(){function e(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var t=e.prototype;return t.resetInitSegment=function(e,t,r,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},t.resetTimeStamp=function(e){this.initPTS=e,this.resetContiguity()},t.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},t.canParse=function(e,t){return!1},t.appendFrame=function(e,t,r){},t.demux=function(e,t){this.cachedData&&(e=Ne(this.cachedData,e),this.cachedData=null);var r,n=ae(e,0),a=n?n.length:0,i=this._audioTrack,o=this._id3Track,s=n?se(n):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&g(s))&&(this.basePTS=dn(s,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),n&&n.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Ot,duration:Number.POSITIVE_INFINITY});a<l;){if(this.canParse(e,a)){var u=this.appendFrame(i,e,a);u?(this.frameIndex++,this.lastPTS=u.sample.pts,r=a+=u.length):a=l}else oe(e,a)?(n=ae(e,a),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Ot,duration:Number.POSITIVE_INFINITY}),r=a+=n.length):a++;if(a===l&&r!==l){var c=ee(e,r);this.cachedData?this.cachedData=Ne(this.cachedData,c):this.cachedData=c}}return{audioTrack:i,videoTrack:un(),id3Track:o,textTrack:un()}},t.demuxSampleAes=function(e,t,r){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},t.flush=function(e){var t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:un(),id3Track:this._id3Track,textTrack:un()}},t.destroy=function(){},e}(),dn=function(e,t,r){return g(e)?90*e:9e4*t+(r?9e4*r.baseTime/r.timescale:0)};function pn(e,t){return 255===e[t]&&240==(246&e[t+1])}function hn(e,t){return 1&e[t+1]?7:9}function fn(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function mn(e,t){return t+1<e.length&&pn(e,t)}function gn(e,t){if(mn(e,t)){var r=hn(e,t);if(t+r>=e.length)return!1;var n=fn(e,t);if(n<=r)return!1;var a=t+n;return a===e.length||mn(e,a)}return!1}function yn(e,t,r,n,a){if(!e.samplerate){var i=function(e,t,r,n){var a,i,o,s,l=navigator.userAgent.toLowerCase(),u=n,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=1+((192&t[r+2])>>>6);var d=(60&t[r+2])>>>2;if(!(d>c.length-1))return o=(1&t[r+2])<<2,o|=(192&t[r+3])>>>6,C.log("manifest codec:"+n+", ADTS type:"+a+", samplingIndex:"+d),/firefox/i.test(l)?d>=6?(a=5,s=new Array(4),i=d-3):(a=2,s=new Array(2),i=d):-1!==l.indexOf("android")?(a=2,s=new Array(2),i=d):(a=5,s=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&d>=6?i=d-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(d>=6&&1===o||/vivaldi/i.test(l))||!n&&1===o)&&(a=2,s=new Array(2)),i=d)),s[0]=a<<3,s[0]|=(14&d)>>1,s[1]|=(1&d)<<7,s[1]|=o<<3,5===a&&(s[1]|=(14&i)>>1,s[2]=(1&i)<<7,s[2]|=8,s[3]=0),{config:s,samplerate:c[d],channelCount:o,codec:"mp4a.40."+a,manifestCodec:u};var p=new Error("invalid ADTS sampling index:"+d);e.emit(_.ERROR,_.ERROR,{type:k.MEDIA_ERROR,details:E.FRAG_PARSING_ERROR,fatal:!0,error:p,reason:p.message})}(t,r,n,a);if(!i)return;e.config=i.config,e.samplerate=i.samplerate,e.channelCount=i.channelCount,e.codec=i.codec,e.manifestCodec=i.manifestCodec,C.log("parsed codec:"+e.codec+", rate:"+i.samplerate+", channels:"+i.channelCount)}}function vn(e){return 9216e4/e}function _n(e,t,r,n,a){var i,o=n+a*vn(e.samplerate),s=function(e,t){var r=hn(e,t);if(t+r<=e.length){var n=fn(e,t)-r;if(n>0)return{headerLength:r,frameLength:n}}}(t,r);if(s){var l=s.frameLength,u=s.headerLength,c=u+l,d=Math.max(0,r+c-t.length);d?(i=new Uint8Array(c-u)).set(t.subarray(r+u,t.length),0):i=t.subarray(r+u,r+c);var p={unit:i,pts:o};return d||e.samples.push(p),{sample:p,length:c,missing:d}}var h=t.length-r;return(i=new Uint8Array(h)).set(t.subarray(r,t.length),0),{sample:{unit:i,pts:o},length:h,missing:-1}}var kn=null,En=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],bn=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Tn=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],An=[0,1,1,4];function Sn(e,t,r,n,a){if(!(r+24>t.length)){var i=Cn(t,r);if(i&&r+i.frameLength<=t.length){var o=n+a*(9e4*i.samplesPerFrame/i.sampleRate),s={unit:t.subarray(r,r+i.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=i.channelCount,e.samplerate=i.sampleRate,e.samples.push(s),{sample:s,length:i.frameLength,missing:0}}}}function Cn(e,t){var r=e[t+1]>>3&3,n=e[t+1]>>1&3,a=e[t+2]>>4&15,i=e[t+2]>>2&3;if(1!==r&&0!==a&&15!==a&&3!==i){var o=e[t+2]>>1&1,s=e[t+3]>>6,l=1e3*En[14*(3===r?3-n:3===n?3:4)+a-1],u=bn[3*(3===r?0:2===r?1:2)+i],c=3===s?1:2,d=Tn[r][n],p=An[n],h=8*d*p,f=Math.floor(d*l/u+o)*p;if(null===kn){var m=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);kn=m?parseInt(m[1]):0}return!!kn&&kn<=87&&2===n&&l>=224e3&&0===s&&(e[t+3]=128|e[t+3]),{sampleRate:u,channelCount:c,frameLength:f,samplesPerFrame:h}}}function Pn(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function xn(e,t){return t+1<e.length&&Pn(e,t)}function wn(e,t){if(t+1<e.length&&Pn(e,t)){var r=Cn(e,t),n=4;null!=r&&r.frameLength&&(n=r.frameLength);var a=t+n;return a===e.length||xn(e,a)}return!1}var In=function(e){function t(t,r){var n;return(n=e.call(this)||this).observer=void 0,n.config=void 0,n.observer=t,n.config=r,n}l(t,e);var r=t.prototype;return r.resetInitSegment=function(t,r,n,a){e.prototype.resetInitSegment.call(this,t,r,n,a),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:r,duration:a,inputTimeScale:9e4,dropped:0}},t.probe=function(e){if(!e)return!1;var t=ae(e,0),r=(null==t?void 0:t.length)||0;if(wn(e,r))return!1;for(var n=e.length;r<n;r++)if(gn(e,r))return C.log("ADTS sync word found !"),!0;return!1},r.canParse=function(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&pn(e,t)&&fn(e,t)<=e.length-t}(e,t)},r.appendFrame=function(e,t,r){yn(e,this.observer,t,r,e.manifestCodec);var n=_n(e,t,r,this.basePTS,this.frameIndex);if(n&&0===n.missing)return n},t}(cn),Mn=/\/emsg[-/]ID3/i,Rn=function(){function e(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}var t=e.prototype;return t.resetTimeStamp=function(){},t.resetInitSegment=function(e,t,r,n){var a=this.videoTrack=un("video",1),i=this.audioTrack=un("audio",1),o=this.txtTrack=un("text",1);if(this.id3Track=un("id3",1),this.timeOffset=0,null!=e&&e.byteLength){var s=we(e);if(s.video){var l=s.video,u=l.id,c=l.timescale,d=l.codec;a.id=u,a.timescale=o.timescale=c,a.codec=d}if(s.audio){var p=s.audio,h=p.id,f=p.timescale,m=p.codec;i.id=h,i.timescale=f,i.codec=m}o.id=ke.text,a.sampleDuration=0,a.duration=i.duration=n}},t.resetContiguity=function(){this.remainderData=null},e.probe=function(e){return function(e){for(var t=e.byteLength,r=0;r<t;){var n=Te(e,r);if(n>8&&109===e[r+4]&&111===e[r+5]&&111===e[r+6]&&102===e[r+7])return!0;r=n>1?r+n:t}return!1}(e)},t.demux=function(e,t){this.timeOffset=t;var r=e,n=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=Ne(this.remainderData,e));var i=function(e){var t={valid:null,remainder:null},r=Pe(e,["moof"]);if(r.length<2)return t.remainder=e,t;var n=r[r.length-1];return t.valid=ee(e,0,n.byteOffset-8),t.remainder=ee(e,n.byteOffset-8),t}(r);this.remainderData=i.remainder,n.samples=i.valid||new Uint8Array}else n.samples=r;var o=this.extractID3Track(n,t);return a.samples=Ue(t,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}},t.flush=function(){var e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;var n=this.extractID3Track(t,this.timeOffset);return r.samples=Ue(e,t),{videoTrack:t,audioTrack:un(),id3Track:n,textTrack:un()}},t.extractID3Track=function(e,t){var r=this.id3Track;if(e.samples.length){var n=Pe(e.samples,["emsg"]);n&&n.forEach((function(e){var n=function(e){var t=e[0],r="",n="",a=0,i=0,o=0,s=0,l=0,u=0;if(0===t){for(;"\0"!==Ee(e.subarray(u,u+1));)r+=Ee(e.subarray(u,u+1)),u+=1;for(r+=Ee(e.subarray(u,u+1)),u+=1;"\0"!==Ee(e.subarray(u,u+1));)n+=Ee(e.subarray(u,u+1)),u+=1;n+=Ee(e.subarray(u,u+1)),u+=1,a=Te(e,12),i=Te(e,16),s=Te(e,20),l=Te(e,24),u=28}else if(1===t){a=Te(e,u+=4);var c=Te(e,u+=4),d=Te(e,u+=4);for(u+=4,o=Math.pow(2,32)*c+d,y(o)||(o=Number.MAX_SAFE_INTEGER,C.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),s=Te(e,u),l=Te(e,u+=4),u+=4;"\0"!==Ee(e.subarray(u,u+1));)r+=Ee(e.subarray(u,u+1)),u+=1;for(r+=Ee(e.subarray(u,u+1)),u+=1;"\0"!==Ee(e.subarray(u,u+1));)n+=Ee(e.subarray(u,u+1)),u+=1;n+=Ee(e.subarray(u,u+1)),u+=1}return{schemeIdUri:r,value:n,timeScale:a,presentationTime:o,presentationTimeDelta:i,eventDuration:s,id:l,payload:e.subarray(u,e.byteLength)}}(e);if(Mn.test(n.schemeIdUri)){var a=g(n.presentationTime)?n.presentationTime/n.timeScale:t+n.presentationTimeDelta/n.timeScale,i=4294967295===n.eventDuration?Number.POSITIVE_INFINITY:n.eventDuration/n.timeScale;i<=.001&&(i=Number.POSITIVE_INFINITY);var o=n.payload;r.samples.push({data:o,len:o.byteLength,dts:a,pts:a,type:Lt,duration:i})}}))}return r},t.demuxSampleAes=function(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},t.destroy=function(){},e}(),Dn=function(e,t){var r=0,n=5;t+=n;for(var a=new Uint32Array(1),i=new Uint32Array(1),o=new Uint8Array(1);n>0;){o[0]=e[t];var s=Math.min(n,8),l=8-s;i[0]=4278190080>>>24+l<<l,a[0]=(o[0]&i[0])>>l,r=r?r<<s|a[0]:a[0],t+=1,n-=s}return r},On=function(e){function t(t){var r;return(r=e.call(this)||this).observer=void 0,r.observer=t,r}l(t,e);var r=t.prototype;return r.resetInitSegment=function(t,r,n,a){e.prototype.resetInitSegment.call(this,t,r,n,a),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:r,duration:a,inputTimeScale:9e4,dropped:0}},r.canParse=function(e,t){return t+64<e.length},r.appendFrame=function(e,t,r){var n=Ln(e,t,r,this.basePTS,this.frameIndex);if(-1!==n)return{sample:e.samples[e.samples.length-1],length:n,missing:0}},t.probe=function(e){if(!e)return!1;var t=ae(e,0);if(!t)return!1;var r=t.length;return 11===e[r]&&119===e[r+1]&&void 0!==se(t)&&Dn(e,r)<16},t}(cn);function Ln(e,t,r,n,a){if(r+8>t.length)return-1;if(11!==t[r]||119!==t[r+1])return-1;var i=t[r+4]>>6;if(i>=3)return-1;var o=[48e3,44100,32e3][i],s=63&t[r+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*s+i];if(r+l>t.length)return-1;var u=t[r+6]>>5,c=0;2===u?c+=2:(1&u&&1!==u&&(c+=2),4&u&&(c+=2));var d=(t[r+6]<<8|t[r+7])>>12-c&1,p=[2,1,2,3,3,4,4,5][u]+d,h=t[r+5]>>3,f=7&t[r+5],m=new Uint8Array([i<<6|h<<1|f>>2,(3&f)<<6|u<<3|d<<2|s>>4,s<<4&224]),g=n+a*(1536/o*9e4),y=t.subarray(r,r+l);return e.config=m,e.channelCount=p,e.samplerate=o,e.samples.push({unit:y,pts:g}),l}var Nn=function(){function e(){this.VideoSample=null}var t=e.prototype;return t.createVideoSample=function(e,t,r,n){return{key:e,frame:!1,pts:t,dts:r,units:[],debug:n,length:0}},t.getLastNalUnit=function(e){var t,r,n=this.VideoSample;if(n&&0!==n.units.length||(n=e[e.length-1]),null!=(t=n)&&t.units){var a=n.units;r=a[a.length-1]}return r},t.pushAccessUnit=function(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){var r=t.samples,n=r.length;if(!n)return void t.dropped++;var a=r[n-1];e.pts=a.pts,e.dts=a.dts}t.samples.push(e)}e.debug.length&&C.log(e.pts+"/"+e.dts+":"+e.debug)},e}(),Un=function(){function e(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),a=Math.min(4,t);if(0===a)throw new Error("no bytes available");n.set(e.subarray(r,r+a)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a},t.skipBits=function(e){var t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;if(e>32&&C.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){for(var t=8,r=8,n=0;n<e;n++)0!==r&&(r=(t+this.readEG()+256)%256),t=0===r?t:r},t.readSPS=function(){var e,t,r,n=0,a=0,i=0,o=0,s=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),p=this.skipEG.bind(this),h=this.skipUEG.bind(this),f=this.skipScalingList.bind(this);s();var m=s();if(l(5),d(3),s(),h(),100===m||110===m||122===m||244===m||44===m||83===m||86===m||118===m||128===m){var g=u();if(3===g&&d(1),h(),h(),d(1),c())for(t=3!==g?8:12,r=0;r<t;r++)c()&&f(r<6?16:64)}h();var y=u();if(0===y)u();else if(1===y)for(d(1),p(),p(),e=u(),r=0;r<e;r++)p();h(),d(1);var v=u(),_=u(),k=l(1);0===k&&d(1),d(1),c()&&(n=u(),a=u(),i=u(),o=u());var E=[1,1];if(c()&&c())switch(s()){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[s()<<8|s(),s()<<8|s()]}return{width:Math.ceil(16*(v+1)-2*n-2*a),height:(2-k)*(_+1)*16-(k?2:4)*(i+o),pixelRatio:E}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),jn=function(e){function t(){return e.apply(this,arguments)||this}l(t,e);var r=t.prototype;return r.parseAVCPES=function(e,t,r,n,a){var i,o=this,s=this.parseAVCNALu(e,r.data),l=this.VideoSample,u=!1;r.data=null,l&&s.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts,"")),s.forEach((function(n){var s;switch(n.type){case 1:var c=!1;i=!0;var d,p=n.data;if(u&&p.length>4){var h=new Un(p).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(c=!0)}c&&null!=(d=l)&&d.frame&&!l.key&&(o.pushAccessUnit(l,e),l=o.VideoSample=null),l||(l=o.VideoSample=o.createVideoSample(!0,r.pts,r.dts,"")),l.frame=!0,l.key=c;break;case 5:i=!0,null!=(s=l)&&s.frame&&!l.key&&(o.pushAccessUnit(l,e),l=o.VideoSample=null),l||(l=o.VideoSample=o.createVideoSample(!0,r.pts,r.dts,"")),l.key=!0,l.frame=!0;break;case 6:i=!0,Be(n.data,1,r.pts,t.samples);break;case 7:var f,m;i=!0,u=!0;var g=n.data,y=new Un(g).readSPS();if(!e.sps||e.width!==y.width||e.height!==y.height||(null==(f=e.pixelRatio)?void 0:f[0])!==y.pixelRatio[0]||(null==(m=e.pixelRatio)?void 0:m[1])!==y.pixelRatio[1]){e.width=y.width,e.height=y.height,e.pixelRatio=y.pixelRatio,e.sps=[g],e.duration=a;for(var v=g.subarray(1,4),_="avc1.",k=0;k<3;k++){var E=v[k].toString(16);E.length<2&&(E="0"+E),_+=E}e.codec=_}break;case 8:i=!0,e.pps=[n.data];break;case 9:i=!0,e.audFound=!0,l&&o.pushAccessUnit(l,e),l=o.VideoSample=o.createVideoSample(!1,r.pts,r.dts,"");break;case 12:i=!0;break;default:i=!1,l&&(l.debug+="unknown NAL "+n.type+" ")}l&&i&&l.units.push(n)})),n&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)},r.parseAVCNALu=function(e,t){var r,n,a=t.byteLength,i=e.naluState||0,o=i,s=[],l=0,u=-1,c=0;for(-1===i&&(u=0,c=31&t[0],i=0,l=1);l<a;)if(r=t[l++],i)if(1!==i)if(r)if(1===r){if(n=l-i-1,u>=0){var d={data:t.subarray(u,n),type:c};s.push(d)}else{var p=this.getLastNalUnit(e.samples);p&&(o&&l<=4-o&&p.state&&(p.data=p.data.subarray(0,p.data.byteLength-o)),n>0&&(p.data=Ne(p.data,t.subarray(0,n)),p.state=0))}l<a?(u=l,c=31&t[l],i=0):i=-1}else i=0;else i=3;else i=r?0:2;else i=r?0:1;if(u>=0&&i>=0){var h={data:t.subarray(u,a),type:c,state:i};s.push(h)}if(0===s.length){var f=this.getLastNalUnit(e.samples);f&&(f.data=Ne(f.data,t))}return e.naluState=i,s},t}(Nn),Bn=function(){function e(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new zr(t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)},t.decryptAacSample=function(e,t,r){var n=this,a=e[t].unit;if(!(a.length<=16)){var i=a.subarray(16,a.length-a.length%16),o=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(o).then((function(i){var o=new Uint8Array(i);a.set(o,16),n.decrypter.isSync()||n.decryptAacSamples(e,t+1,r)}))}},t.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32||(this.decryptAacSample(e,t,r),this.decrypter.isSync())))return}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),n=0,a=32;a<e.length-16;a+=160,n+=16)r.set(e.subarray(a,a+16),n);return r},t.getAvcDecryptedUnit=function(e,t){for(var r=new Uint8Array(t),n=0,a=32;a<e.length-16;a+=160,n+=16)e.set(r.subarray(n,n+16),a);return e},t.decryptAvcSample=function(e,t,r,n,a){var i=this,o=Fe(a.data),s=this.getAvcEncryptedData(o);this.decryptBuffer(s.buffer).then((function(s){a.data=i.getAvcDecryptedUnit(o,s),i.decrypter.isSync()||i.decryptAvcSamples(e,t,r+1,n)}))},t.decryptAvcSamples=function(e,t,r,n){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length)return void n();for(var a=e[t].units;!(r>=a.length);r++){var i=a[r];if(!(i.data.length<=48||1!==i.type&&5!==i.type||(this.decryptAvcSample(e,t,r,n,i),this.decrypter.isSync())))return}}},e}(),Fn=188,Vn=function(){function e(e,t,r){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.videoParser=new jn}e.probe=function(t){var r=e.syncOffset(t);return r>0&&C.warn("MPEG2-TS detected but first sync word found @ offset "+r),-1!==r},e.syncOffset=function(e){for(var t=e.length,r=Math.min(940,t-Fn)+1,n=0;n<r;){for(var a=!1,i=-1,o=0,s=n;s<t;s+=Fn){if(71!==e[s]||t-s!==Fn&&71!==e[s+Fn]){if(o)return-1;break}if(o++,-1===i&&0!==(i=s)&&(r=Math.min(i+18612,e.length-Fn)+1),a||(a=0===Hn(e,s)),a&&o>1&&(0===i&&o>2||s+Fn>r))return i}n++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:ke[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}};var t=e.prototype;return t.resetInitSegment=function(t,r,n,a){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=e.createTrack("video"),this._audioTrack=e.createTrack("audio",a),this._id3Track=e.createTrack("id3"),this._txtTrack=e.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=r,this.videoCodec=n,this._duration=a},t.resetTimeStamp=function(){},t.resetContiguity=function(){var e=this._audioTrack,t=this._videoTrack,r=this._id3Track;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null},t.demux=function(t,r,n,a){var i;void 0===n&&(n=!1),void 0===a&&(a=!1),n||(this.sampleAes=null);var o=this._videoTrack,s=this._audioTrack,l=this._id3Track,u=this._txtTrack,c=o.pid,d=o.pesData,p=s.pid,h=l.pid,f=s.pesData,m=l.pesData,g=null,y=this.pmtParsed,v=this._pmtId,b=t.length;if(this.remainderData&&(b=(t=Ne(this.remainderData,t)).length,this.remainderData=null),b<Fn&&!a)return this.remainderData=t,{audioTrack:s,videoTrack:o,id3Track:l,textTrack:u};var T=Math.max(0,e.syncOffset(t));(b-=(b-T)%Fn)<t.byteLength&&!a&&(this.remainderData=new Uint8Array(t.buffer,b,t.buffer.byteLength-b));for(var A=0,S=T;S<b;S+=Fn)if(71===t[S]){var P=!!(64&t[S+1]),x=Hn(t,S),w=void 0;if((48&t[S+3])>>4>1){if((w=S+5+t[S+4])===S+Fn)continue}else w=S+4;switch(x){case c:P&&(d&&(i=Wn(d))&&this.videoParser.parseAVCPES(o,u,i,!1,this._duration),d={data:[],size:0}),d&&(d.data.push(t.subarray(w,S+Fn)),d.size+=S+Fn-w);break;case p:if(P){if(f&&(i=Wn(f)))switch(s.segmentCodec){case"aac":this.parseAACPES(s,i);break;case"mp3":this.parseMPEGPES(s,i);break;case"ac3":this.parseAC3PES(s,i)}f={data:[],size:0}}f&&(f.data.push(t.subarray(w,S+Fn)),f.size+=S+Fn-w);break;case h:P&&(m&&(i=Wn(m))&&this.parseID3PES(l,i),m={data:[],size:0}),m&&(m.data.push(t.subarray(w,S+Fn)),m.size+=S+Fn-w);break;case 0:P&&(w+=t[w]+1),v=this._pmtId=Gn(t,w);break;case v:P&&(w+=t[w]+1);var I=$n(t,w,this.typeSupported,n);(c=I.videoPid)>0&&(o.pid=c,o.segmentCodec=I.segmentVideoCodec),(p=I.audioPid)>0&&(s.pid=p,s.segmentCodec=I.segmentAudioCodec),(h=I.id3Pid)>0&&(l.pid=h),null===g||y||(C.warn("MPEG-TS PMT found at "+S+" after unknown PID '"+g+"'. Backtracking to sync byte @"+T+" to parse all TS packets."),g=null,S=T-188),y=this.pmtParsed=!0;break;case 17:case 8191:break;default:g=x}}else A++;if(A>0){var M=new Error("Found "+A+" TS packet/s that do not start with 0x47");this.observer.emit(_.ERROR,_.ERROR,{type:k.MEDIA_ERROR,details:E.FRAG_PARSING_ERROR,fatal:!1,error:M,reason:M.message})}o.pesData=d,s.pesData=f,l.pesData=m;var R={audioTrack:s,videoTrack:o,id3Track:l,textTrack:u};return a&&this.extractRemainingSamples(R),R},t.flush=function(){var e,t=this.remainderData;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e},t.extractRemainingSamples=function(e){var t,r=e.audioTrack,n=e.videoTrack,a=e.id3Track,i=e.textTrack,o=n.pesData,s=r.pesData,l=a.pesData;if(o&&(t=Wn(o))?(this.videoParser.parseAVCPES(n,i,t,!0,this._duration),n.pesData=null):n.pesData=o,s&&(t=Wn(s))){switch(r.segmentCodec){case"aac":this.parseAACPES(r,t);break;case"mp3":this.parseMPEGPES(r,t);break;case"ac3":this.parseAC3PES(r,t)}r.pesData=null}else null!=s&&s.size&&C.log("last AAC PES packet truncated,might overlap between fragments"),r.pesData=s;l&&(t=Wn(l))?(this.parseID3PES(a,t),a.pesData=null):a.pesData=l},t.demuxSampleAes=function(e,t,r){var n=this.demux(e,r,!0,!this.config.progressive),a=this.sampleAes=new Bn(this.observer,this.config,t);return this.decrypt(n,a)},t.decrypt=function(e,t){return new Promise((function(r){var n=e.audioTrack,a=e.videoTrack;n.samples&&"aac"===n.segmentCodec?t.decryptAacSamples(n.samples,0,(function(){a.samples?t.decryptAvcSamples(a.samples,0,0,(function(){r(e)})):r(e)})):a.samples&&t.decryptAvcSamples(a.samples,0,0,(function(){r(e)}))}))},t.destroy=function(){this._duration=0},t.parseAACPES=function(e,t){var r,n,a,i=0,o=this.aacOverFlow,s=t.data;if(o){this.aacOverFlow=null;var l=o.missing,u=o.sample.unit.byteLength;if(-1===l)s=Ne(o.sample.unit,s);else{var c=u-l;o.sample.unit.set(s.subarray(0,l),c),e.samples.push(o.sample),i=o.missing}}for(r=i,n=s.length;r<n-1&&!mn(s,r);r++);if(r!==i){var d,p=r<n-1;d=p?"AAC PES did not start with ADTS header,offset:"+r:"No ADTS header found in AAC PES";var h=new Error(d);if(C.warn("parsing error: "+d),this.observer.emit(_.ERROR,_.ERROR,{type:k.MEDIA_ERROR,details:E.FRAG_PARSING_ERROR,fatal:!1,levelRetry:p,error:h,reason:d}),!p)return}if(yn(e,this.observer,s,r,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!o)return void C.warn("[tsdemuxer]: AAC PES unknown PTS");var f=vn(e.samplerate);a=o.sample.pts+f}for(var m,g=0;r<n;){if(r+=(m=_n(e,s,r,a,g)).length,m.missing){this.aacOverFlow=m;break}for(g++;r<n-1&&!mn(s,r);r++);}},t.parseMPEGPES=function(e,t){var r=t.data,n=r.length,a=0,i=0,o=t.pts;if(void 0!==o)for(;i<n;)if(xn(r,i)){var s=Sn(e,r,i,o,a);if(!s)break;i+=s.length,a++}else i++;else C.warn("[tsdemuxer]: MPEG PES unknown PTS")},t.parseAC3PES=function(e,t){var r=t.data,n=t.pts;if(void 0!==n)for(var a,i=r.length,o=0,s=0;s<i&&(a=Ln(e,r,s,n,o++))>0;)s+=a;else C.warn("[tsdemuxer]: AC3 PES unknown PTS")},t.parseID3PES=function(e,t){if(void 0!==t.pts){var r=s({},t,{type:this._videoTrack?Lt:Ot,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}else C.warn("[tsdemuxer]: ID3 PES unknown PTS")},e}();function Hn(e,t){return((31&e[t+1])<<8)+e[t+2]}function Gn(e,t){return(31&e[t+10])<<8|e[t+11]}function $n(e,t,r,n){var a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},i=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<i;){var o=Hn(e,t),s=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!n){Kn("ADTS AAC");break}case 15:-1===a.audioPid&&(a.audioPid=o);break;case 21:-1===a.id3Pid&&(a.id3Pid=o);break;case 219:if(!n){Kn("H.264");break}case 27:-1===a.videoPid&&(a.videoPid=o,a.segmentVideoCodec="avc");break;case 3:case 4:r.mpeg||r.mp3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="mp3"):C.log("MPEG audio found, not supported in this browser");break;case 193:if(!n){Kn("AC-3");break}case 129:r.ac3?-1===a.audioPid&&(a.audioPid=o,a.segmentAudioCodec="ac3"):C.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===a.audioPid&&s>0)for(var l=t+5,u=s;u>2;){106===e[l]&&(!0!==r.ac3?C.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=o,a.segmentAudioCodec="ac3"));var c=e[l+1]+2;l+=c,u-=c}break;case 194:case 135:C.warn("Unsupported EC-3 in M2TS found");break;case 36:C.warn("Unsupported HEVC in M2TS found")}t+=s+5}return a}function Kn(e){C.log(e+" with AES-128-CBC encryption found in unencrypted stream")}function Wn(e){var t,r,n,a,i,o=0,s=e.data;if(!e||0===e.size)return null;for(;s[0].length<19&&s.length>1;)s[0]=Ne(s[0],s[1]),s.splice(1,1);if(1===((t=s[0])[0]<<16)+(t[1]<<8)+t[2]){if((r=(t[4]<<8)+t[5])&&r>e.size-6)return null;var l=t[7];192&l&&(a=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&l?a-(i=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(C.warn(Math.round((a-i)/9e4)+"s delta between PTS and DTS, align them"),a=i):i=a);var u=(n=t[8])+9;if(e.size<=u)return null;e.size-=u;for(var c=new Uint8Array(e.size),d=0,p=s.length;d<p;d++){var h=(t=s[d]).byteLength;if(u){if(u>h){u-=h;continue}t=t.subarray(u),h-=u,u=0}c.set(t,o),o+=h}return r&&(r-=n+3),{data:c,pts:a,dts:i,len:r}}return null}var zn=function(e){function t(){return e.apply(this,arguments)||this}l(t,e);var r=t.prototype;return r.resetInitSegment=function(t,r,n,a){e.prototype.resetInitSegment.call(this,t,r,n,a),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:r,duration:a,inputTimeScale:9e4,dropped:0}},t.probe=function(e){if(!e)return!1;var t=ae(e,0),r=(null==t?void 0:t.length)||0;if(t&&11===e[r]&&119===e[r+1]&&void 0!==se(t)&&Dn(e,r)<=16)return!1;for(var n=e.length;r<n;r++)if(wn(e,r))return C.log("MPEG Audio sync word found !"),!0;return!1},r.canParse=function(e,t){return function(e,t){return Pn(e,t)&&4<=e.length-t}(e,t)},r.appendFrame=function(e,t,r){if(null!==this.basePTS)return Sn(e,t,r,this.basePTS,this.frameIndex)},t}(cn),qn=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},e}(),Yn=Math.pow(2,32)-1,Xn=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:n};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=i,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,a))},e.box=function(e){for(var t=8,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];for(var i=n.length,o=i;i--;)t+=n[i].byteLength;var s=new Uint8Array(t);for(s[0]=t>>24&255,s[1]=t>>16&255,s[2]=t>>8&255,s[3]=255&t,s.set(e,4),i=0,t=8;i<o;i++)s.set(n[i],t),t+=n[i].byteLength;return s},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var n=Math.floor(r/(Yn+1)),a=Math.floor(r%(Yn+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,r))},e.moov=function(t){for(var r=t.length,n=[];r--;)n[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,n=[];r--;)n[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(n))},e.mvhd=function(t,r){r*=t;var n=Math.floor(r/(Yn+1)),a=Math.floor(r%(Yn+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,i)},e.sdtp=function(t){var r,n,a=t.samples||[],i=new Uint8Array(4+a.length);for(r=0;r<a.length;r++)n=a[r].flags,i[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e.box(e.types.sdtp,i)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r,n,a,i=[],o=[];for(r=0;r<t.sps.length;r++)a=(n=t.sps[r]).byteLength,i.push(a>>>8&255),i.push(255&a),i=i.concat(Array.prototype.slice.call(n));for(r=0;r<t.pps.length;r++)a=(n=t.pps[r]).byteLength,o.push(a>>>8&255),o.push(255&a),o=o.concat(Array.prototype.slice.call(n));var s=e.box(e.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(o))),l=t.width,u=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.audioStsd=function(e){var t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0])},e.mp4a=function(t){return e.box(e.types.mp4a,e.audioStsd(t),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){return e.box(e.types[".mp3"],e.audioStsd(t))},e.ac3=function(t){return e.box(e.types["ac-3"],e.audioStsd(t),e.box(e.types.dac3,t.config))},e.stsd=function(t){return"audio"===t.type?"mp3"===t.segmentCodec&&"mp3"===t.codec?e.box(e.types.stsd,e.STSD,e.mp3(t)):"ac3"===t.segmentCodec?e.box(e.types.stsd,e.STSD,e.ac3(t)):e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var r=t.id,n=t.duration*t.timescale,a=t.width,i=t.height,o=Math.floor(n/(Yn+1)),s=Math.floor(n%(Yn+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,i>>8&255,255&i,0,0]))},e.traf=function(t,r){var n=e.sdtp(t),a=t.id,i=Math.floor(r/(Yn+1)),o=Math.floor(r%(Yn+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,o>>24,o>>16&255,o>>8&255,255&o])),e.trun(t,n.length+16+20+8+16+8+8),n)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var n,a,i,o,s,l,u=t.samples||[],c=u.length,d=12+16*c,p=new Uint8Array(d);for(r+=8+d,p.set(["video"===t.type?1:0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<c;n++)i=(a=u[n]).duration,o=a.size,s=a.flags,l=a.cts,p.set([i>>>24&255,i>>>16&255,i>>>8&255,255&i,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return e.box(e.types.trun,p)},e.initSegment=function(t){e.types||e.init();var r=e.moov(t);return Ne(e.FTYP,r)},e}();Xn.types=void 0,Xn.HDLR_TYPES=void 0,Xn.STTS=void 0,Xn.STSC=void 0,Xn.STCO=void 0,Xn.STSZ=void 0,Xn.VMHD=void 0,Xn.SMHD=void 0,Xn.STSD=void 0,Xn.FTYP=void 0,Xn.DINF=void 0;function Zn(e,t,r,n){void 0===r&&(r=1),void 0===n&&(n=!1);var a=e*t*r;return n?Math.round(a):a}function Qn(e,t){return void 0===t&&(t=!1),Zn(e,1e3,1/9e4,t)}var Jn=null,ea=null,ta=function(){function e(e,t,r,n){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,null===Jn){var a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Jn=a?parseInt(a[1]):0}if(null===ea){var i=navigator.userAgent.match(/Safari\/(\d+)/i);ea=i?parseInt(i[1]):0}}var t=e.prototype;return t.destroy=function(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null},t.resetTimeStamp=function(e){C.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e},t.resetNextTimestamp=function(){C.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},t.resetInitSegment=function(){C.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0},t.getVideoStartPts=function(e){var t=!1,r=e.reduce((function(e,r){var n=r.pts-e;return n<-4294967296?(t=!0,ra(e,r.pts)):n>0?e:r.pts}),e[0].pts);return t&&C.debug("PTS rollover detected"),r},t.remux=function(e,t,r,n,a,i,o,s){var l,u,c,d,p,h,f=a,m=a,g=e.pid>-1,y=t.pid>-1,v=t.samples.length,_=e.samples.length>0,k=o&&v>0||v>1;if((!g||_)&&(!y||k)||this.ISGenerated||o){if(this.ISGenerated){var E,b,T,A,S=this.videoTrackConfig;!S||t.width===S.width&&t.height===S.height&&(null==(E=t.pixelRatio)?void 0:E[0])===(null==(b=S.pixelRatio)?void 0:b[0])&&(null==(T=t.pixelRatio)?void 0:T[1])===(null==(A=S.pixelRatio)?void 0:A[1])||this.resetInitSegment()}else c=this.generateIS(e,t,a,i);var P,x=this.isVideoContiguous,w=-1;if(k&&(w=function(e){for(var t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!x&&this.config.forceKeyFrameOnDiscontinuity))if(h=!0,w>0){C.warn("[mp4-remuxer]: Dropped "+w+" out of "+v+" video samples due to a missing keyframe");var I=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(w),t.dropped+=w,P=m+=(t.samples[0].pts-I)/t.inputTimeScale}else-1===w&&(C.warn("[mp4-remuxer]: No keyframe found out of "+v+" video samples"),h=!1);if(this.ISGenerated){if(_&&k){var M=this.getVideoStartPts(t.samples),R=(ra(e.samples[0].pts,M)-M)/t.inputTimeScale;f+=Math.max(0,R),m+=Math.max(0,-R)}if(_){if(e.samplerate||(C.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),c=this.generateIS(e,t,a,i)),u=this.remuxAudio(e,f,this.isAudioContiguous,i,y||k||s===At?m:void 0),k){var D=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(C.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(e,t,a,i)),l=this.remuxVideo(t,m,x,D)}}else k&&(l=this.remuxVideo(t,m,x,0));l&&(l.firstKeyFrame=w,l.independent=-1!==w,l.firstKeyFramePTS=P)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(p=na(r,a,this._initPTS,this._initDTS)),n.samples.length&&(d=aa(n,a,this._initPTS))),{audio:u,video:l,initSegment:c,independent:h,text:d,id3:p}},t.generateIS=function(e,t,r,n){var a,i,o,s=e.samples,l=t.samples,u=this.typeSupported,c={},d=this._initPTS,p=!d||n,h="audio/mp4";if(p&&(a=i=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":u.mpeg?(h="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3"}c.audio={id:"audio",container:h,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&u.mpeg?new Uint8Array(0):Xn.initSegment([e]),metadata:{channelCount:e.channelCount}},p&&(o=e.inputTimeScale,d&&o===d.timescale?p=!1:a=i=s[0].pts-Math.round(o*r))}if(t.sps&&t.pps&&l.length){if(t.timescale=t.inputTimeScale,c.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Xn.initSegment([t]),metadata:{width:t.width,height:t.height}},p)if(o=t.inputTimeScale,d&&o===d.timescale)p=!1;else{var f=this.getVideoStartPts(l),m=Math.round(o*r);i=Math.min(i,ra(l[0].dts,f)-m),a=Math.min(a,f-m)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(c).length)return this.ISGenerated=!0,p?(this._initPTS={baseTime:a,timescale:o},this._initDTS={baseTime:i,timescale:o}):a=o=void 0,{tracks:c,initPTS:a,timescale:o}},t.remuxVideo=function(e,t,r,n){var a,i,o=e.inputTimeScale,l=e.samples,u=[],c=l.length,d=this._initPTS,p=this.nextAvcDts,h=8,f=this.videoSampleDuration,m=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,y=!1;if(!r||null===p){var v=t*o,b=l[0].pts-ra(l[0].dts,l[0].pts);Jn&&null!==p&&Math.abs(v-b-p)<15e3?r=!0:p=v-b}for(var T=d.baseTime*o/d.timescale,A=0;A<c;A++){var S=l[A];S.pts=ra(S.pts-T,p),S.dts=ra(S.dts-T,p),S.dts<l[A>0?A-1:A].dts&&(y=!0)}y&&l.sort((function(e,t){var r=e.dts-t.dts,n=e.pts-t.pts;return r||n})),a=l[0].dts;var P=l[l.length-1].dts-a,x=P?Math.round(P/(c-1)):f||e.inputTimeScale/30;if(r){var w=a-p,I=w>x,M=w<-1;if((I||M)&&(I?C.warn("AVC: "+Qn(w,!0)+" ms ("+w+"dts) hole between fragments detected at "+t.toFixed(3)):C.warn("AVC: "+Qn(-w,!0)+" ms ("+w+"dts) overlapping between fragments detected at "+t.toFixed(3)),!M||p>=l[0].pts||Jn)){a=p;var R=l[0].pts-w;if(I)l[0].dts=a,l[0].pts=R;else for(var D=0;D<l.length&&!(l[D].dts>R);D++)l[D].dts-=w,l[D].pts-=w;C.log("Video: Initial PTS/DTS adjusted: "+Qn(R,!0)+"/"+Qn(a,!0)+", delta: "+Qn(w,!0)+" ms")}}for(var O=0,L=0,N=a=Math.max(0,a),U=0;U<c;U++){for(var j=l[U],B=j.units,F=B.length,V=0,H=0;H<F;H++)V+=B[H].data.length;L+=V,O+=F,j.length=V,j.dts<N?(j.dts=N,N+=x/4|0||1):N=j.dts,m=Math.min(j.pts,m),g=Math.max(j.pts,g)}i=l[c-1].dts;var G,$=L+4*O+8;try{G=new Uint8Array($)}catch(e){return void this.observer.emit(_.ERROR,_.ERROR,{type:k.MUX_ERROR,details:E.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:$,reason:"fail allocating video mdat "+$})}var K=new DataView(G.buffer);K.setUint32(0,$),G.set(Xn.types.mdat,4);for(var W=!1,z=Number.POSITIVE_INFINITY,q=Number.POSITIVE_INFINITY,Y=Number.NEGATIVE_INFINITY,X=Number.NEGATIVE_INFINITY,Z=0;Z<c;Z++){for(var Q=l[Z],J=Q.units,ee=0,te=0,re=J.length;te<re;te++){var ne=J[te],ae=ne.data,ie=ne.data.byteLength;K.setUint32(h,ie),h+=4,G.set(ae,h),h+=ie,ee+=4+ie}var oe=void 0;if(Z<c-1)f=l[Z+1].dts-Q.dts,oe=l[Z+1].pts-Q.pts;else{var se=this.config,le=Z>0?Q.dts-l[Z-1].dts:x;if(oe=Z>0?Q.pts-l[Z-1].pts:x,se.stretchShortVideoTrack&&null!==this.nextAudioPts){var ue=Math.floor(se.maxBufferHole*o),ce=(n?m+n*o:this.nextAudioPts)-Q.pts;ce>ue?((f=ce-le)<0?f=le:W=!0,C.log("[mp4-remuxer]: It is approximately "+ce/90+" ms to the next segment; using duration "+f/90+" ms for the last video frame.")):f=le}else f=le}var de=Math.round(Q.pts-Q.dts);z=Math.min(z,f),Y=Math.max(Y,f),q=Math.min(q,oe),X=Math.max(X,oe),u.push(new oa(Q.key,f,ee,de))}if(u.length)if(Jn){if(Jn<70){var pe=u[0].flags;pe.dependsOn=2,pe.isNonSync=0}}else if(ea&&X-q<Y-z&&x/Y<.025&&0===u[0].cts){C.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var he=a,fe=0,me=u.length;fe<me;fe++){var ge=he+u[fe].duration,ye=he+u[fe].cts;if(fe<me-1){var ve=ge+u[fe+1].cts;u[fe].duration=ve-ye}else u[fe].duration=fe?u[fe-1].duration:x;u[fe].cts=0,he=ge}}f=W||!f?x:f,this.nextAvcDts=p=i+f,this.videoSampleDuration=f,this.isVideoContiguous=!0;var _e={data1:Xn.moof(e.sequenceNumber++,a,s({},e,{samples:u})),data2:G,startPTS:m/o,endPTS:(g+f)/o,startDTS:a/o,endDTS:p/o,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:e.dropped};return e.samples=[],e.dropped=0,_e},t.getSamplesPerFrame=function(e){switch(e.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}},t.remuxAudio=function(e,t,r,n,a){var i=e.inputTimeScale,o=i/(e.samplerate?e.samplerate:i),l=this.getSamplesPerFrame(e),u=l*o,c=this._initPTS,d="mp3"===e.segmentCodec&&this.typeSupported.mpeg,p=[],h=void 0!==a,f=e.samples,m=d?0:8,g=this.nextAudioPts||-1,y=t*i,v=c.baseTime*i/c.timescale;if(this.isAudioContiguous=r=r||f.length&&g>0&&(n&&Math.abs(y-g)<9e3||Math.abs(ra(f[0].pts-v,y)-g)<20*u),f.forEach((function(e){e.pts=ra(e.pts-v,y)})),!r||g<0){if(f=f.filter((function(e){return e.pts>=0})),!f.length)return;g=0===a?0:n&&!h?Math.max(0,y):f[0].pts}if("aac"===e.segmentCodec)for(var b=this.config.maxAudioFramesDrift,T=0,A=g;T<f.length;T++){var S=f[T],P=S.pts,x=P-A,w=Math.abs(1e3*x/i);if(x<=-b*u&&h)0===T&&(C.warn("Audio frame @ "+(P/i).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*x/i)+" ms."),this.nextAudioPts=g=A=P);else if(x>=b*u&&w<1e4&&h){var I=Math.round(x/u);(A=P-I*u)<0&&(I--,A+=u),0===T&&(this.nextAudioPts=g=A),C.warn("[mp4-remuxer]: Injecting "+I+" audio frame @ "+(A/i).toFixed(3)+"s due to "+Math.round(1e3*x/i)+" ms gap.");for(var M=0;M<I;M++){var R=Math.max(A,0),D=qn.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);D||(C.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),D=S.unit.subarray()),f.splice(T,0,{unit:D,pts:R}),A+=u,T++}}S.pts=A,A+=u}for(var O,L=null,N=null,U=0,j=f.length;j--;)U+=f[j].unit.byteLength;for(var B=0,F=f.length;B<F;B++){var V=f[B],H=V.unit,G=V.pts;if(null!==N)p[B-1].duration=Math.round((G-N)/o);else{if(r&&"aac"===e.segmentCodec&&(G=g),L=G,!(U>0))return;U+=m;try{O=new Uint8Array(U)}catch(e){return void this.observer.emit(_.ERROR,_.ERROR,{type:k.MUX_ERROR,details:E.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:U,reason:"fail allocating audio mdat "+U})}d||(new DataView(O.buffer).setUint32(0,U),O.set(Xn.types.mdat,4))}O.set(H,m);var $=H.byteLength;m+=$,p.push(new oa(!0,l,$,0)),N=G}var K=p.length;if(K){var W=p[p.length-1];this.nextAudioPts=g=N+o*W.duration;var z=d?new Uint8Array(0):Xn.moof(e.sequenceNumber++,L/o,s({},e,{samples:p}));e.samples=[];var q=L/i,Y=g/i,X={data1:z,data2:O,startPTS:q,endPTS:Y,startDTS:q,endDTS:Y,type:"audio",hasAudio:!0,hasVideo:!1,nb:K};return this.isAudioContiguous=!0,X}},t.remuxEmptyAudio=function(e,t,r,n){var a=e.inputTimeScale,i=a/(e.samplerate?e.samplerate:a),o=this.nextAudioPts,s=this._initDTS,l=9e4*s.baseTime/s.timescale,u=(null!==o?o:n.startDTS*a)+l,c=n.endDTS*a+l,d=1024*i,p=Math.ceil((c-u)/d),h=qn.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(C.warn("[mp4-remuxer]: remux empty Audio"),h){for(var f=[],m=0;m<p;m++){var g=u+m*d;f.push({unit:h,pts:g,dts:g})}return e.samples=f,this.remuxAudio(e,t,r,!1)}C.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},e}();function ra(e,t){var r;if(null===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}function na(e,t,r,n){var a=e.samples.length;if(a){for(var i=e.inputTimeScale,o=0;o<a;o++){var s=e.samples[o];s.pts=ra(s.pts-r.baseTime*i/r.timescale,t*i)/i,s.dts=ra(s.dts-n.baseTime*i/n.timescale,t*i)/i}var l=e.samples;return e.samples=[],{samples:l}}}function aa(e,t,r){var n=e.samples.length;if(n){for(var a=e.inputTimeScale,i=0;i<n;i++){var o=e.samples[i];o.pts=ra(o.pts-r.baseTime*a/r.timescale,t*a)/a}e.samples.sort((function(e,t){return e.pts-t.pts}));var s=e.samples;return e.samples=[],{samples:s}}}var ia,oa=function(e,t,r,n){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=r,this.cts=n,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}},sa=function(){function e(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this.initPTS=e,this.lastEndTime=null},t.resetNextTimestamp=function(){this.lastEndTime=null},t.resetInitSegment=function(e,t,r,n){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(function(e,t){if(!e||!t)return e;var r=t.keyId;return r&&t.isCommonEncryption&&Pe(e,["moov","trak"]).forEach((function(e){var t=Pe(e,["mdia","minf","stbl","stsd"])[0].subarray(8),n=Pe(t,["enca"]),a=n.length>0;a||(n=Pe(t,["encv"])),n.forEach((function(e){Pe(a?e.subarray(28):e.subarray(78),["sinf"]).forEach((function(e){var t=Oe(e);if(t){var n=t.subarray(8,24);n.some((function(e){return 0!==e}))||(C.log("[eme] Patching keyId in 'enc"+(a?"a":"v")+">sinf>>tenc' box: "+ye(n)+" -> "+ye(r)),t.set(r,8))}}))}))})),e}(e,n)),this.emitInitSegment=!0},t.generateInitSegment=function(e){var t=this.audioCodec,r=this.videoCodec;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var n=this.initData=we(e);n.audio&&(t=la(n.audio,D)),n.video&&(r=la(n.video,O));var a={};n.audio&&n.video?a.audiovideo={container:"video/mp4",codec:t+","+r,initSegment:e,id:"main"}:n.audio?a.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:n.video?a.video={container:"video/mp4",codec:r,initSegment:e,id:"main"}:C.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=a},t.remux=function(e,t,r,n,a,i){var o,s,l=this.initPTS,u=this.lastEndTime,c={audio:void 0,video:void 0,text:n,id3:r,initSegment:void 0};g(u)||(u=this.lastEndTime=a||0);var d=t.samples;if(null==d||!d.length)return c;var p={initPTS:void 0,timescale:1},h=this.initData;if(null!=(o=h)&&o.length||(this.generateInitSegment(d),h=this.initData),null==(s=h)||!s.length)return C.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),c;this.emitInitSegment&&(p.tracks=this.initTracks,this.emitInitSegment=!1);var f=function(e,t){for(var r=0,n=0,a=0,i=Pe(e,["moof","traf"]),o=0;o<i.length;o++){var s=i[o],l=Pe(s,["tfhd"])[0],u=t[Te(l,4)];if(u){var c=u.default,d=Te(l,0)|(null==c?void 0:c.flags),p=null==c?void 0:c.duration;8&d&&(p=Te(l,2&d?12:8));for(var h=u.timescale||9e4,f=Pe(s,["trun"]),m=0;m<f.length;m++)!(r=Le(f[m]))&&p&&(r=p*Te(f[m],4)),u.type===O?n+=r/h:u.type===D&&(a+=r/h)}}if(0===n&&0===a){for(var y=1/0,v=0,_=0,k=Pe(e,["sidx"]),E=0;E<k.length;E++){var b=xe(k[E]);if(null!=b&&b.references){y=Math.min(y,b.earliestPresentationTime/b.timescale);var T=b.references.reduce((function(e,t){return e+t.info.duration||0}),0);_=(v=Math.max(v,T+b.earliestPresentationTime/b.timescale))-y}}if(_&&g(_))return _}return n||a}(d,h),m=function(e,t){return Pe(t,["moof","traf"]).reduce((function(t,r){var n=Pe(r,["tfdt"])[0],a=n[0],i=Pe(r,["tfhd"]).reduce((function(t,r){var i=Te(r,4),o=e[i];if(o){var s=Te(n,4);if(1===a){if(s===ve)return C.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;s*=ve+1,s+=Te(n,8)}var l=s/(o.timescale||9e4);if(g(l)&&(null===t||l<t))return l}return t}),null);return null!==i&&g(i)&&(null===t||i<t)?i:t}),null)}(h,d),y=null===m?a:m;(function(e,t,r,n){if(null===e)return!0;var a=Math.max(n,1),i=t-e.baseTime/e.timescale;return Math.abs(i-r)>a}(l,y,a,f)||p.timescale!==l.timescale&&i)&&(p.initPTS=y-a,l&&1===l.timescale&&C.warn("Adjusting initPTS by "+(p.initPTS-l.baseTime)),this.initPTS=l={baseTime:p.initPTS,timescale:1});var v=e?y-l.baseTime/l.timescale:u,_=v+f;!function(e,t,r){Pe(t,["moof","traf"]).forEach((function(t){Pe(t,["tfhd"]).forEach((function(n){var a=Te(n,4),i=e[a];if(i){var o=i.timescale||9e4;Pe(t,["tfdt"]).forEach((function(e){var t=e[0],n=r*o;if(n){var a=Te(e,4);if(0===t)a-=n,Ce(e,4,a=Math.max(a,0));else{a*=Math.pow(2,32),a+=Te(e,8),a-=n,a=Math.max(a,0);var i=Math.floor(a/(ve+1)),s=Math.floor(a%(ve+1));Ce(e,4,i),Ce(e,8,s)}}}))}}))}))}(h,d,l.baseTime/l.timescale),f>0?this.lastEndTime=_:(C.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var k=!!h.audio,E=!!h.video,b="";k&&(b+="audio"),E&&(b+="video");var T={data1:d,startPTS:v,startDTS:v,endPTS:_,endDTS:_,type:b,hasAudio:k,hasVideo:E,nb:1,dropped:0};return c.audio="audio"===T.type?T:void 0,c.video="audio"!==T.type?T:void 0,c.initSegment=p,c.id3=na(r,a,l,l),n.samples.length&&(c.text=aa(n,a,l)),c},e}();function la(e,t){var r=null==e?void 0:e.codec;if(r&&r.length>4)return r;if(t===D){if("ec-3"===r||"ac-3"===r||"alac"===r)return r;if("fLaC"===r||"Opus"===r)return at(r,!1);var n="mp4a.40.5";return C.info('Parsed audio codec "'+r+'" or audio object type not handled. Using "'+n+'"'),n}return C.warn('Unhandled video codec "'+r+'"'),"hvc1"===r||"hev1"===r?"hvc1.1.6.L120.90":"av01"===r?"av01.0.04M.08":"avc1.42e01e"}try{ia=self.performance.now.bind(self.performance)}catch(e){C.debug("Unable to use Performance API on this environment"),ia=null==H?void 0:H.Date.now}var ua=[{demux:Rn,remux:sa},{demux:Vn,remux:ta},{demux:In,remux:ta},{demux:zn,remux:ta}];ua.splice(2,0,{demux:On,remux:ta});var ca=function(){function e(e,t,r,n,a){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.vendor=n,this.id=a}var t=e.prototype;return t.configure=function(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()},t.push=function(e,t,r,n){var a=this,i=r.transmuxing;i.executeStart=ia();var o=new Uint8Array(e),s=this.currentTransmuxState,l=this.transmuxConfig;n&&(this.currentTransmuxState=n);var u=n||s,c=u.contiguous,d=u.discontinuity,p=u.trackSwitch,h=u.accurateTimeOffset,f=u.timeOffset,m=u.initSegmentChange,g=l.audioCodec,y=l.videoCodec,v=l.defaultInitPts,b=l.duration,T=l.initSegmentData,A=function(e,t){var r=null;return e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(r=t),r}(o,t);if(A&&"AES-128"===A.method){var S=this.getDecrypter();if(!S.isSync())return this.decryptionPromise=S.webCryptoDecrypt(o,A.key.buffer,A.iv.buffer).then((function(e){var t=a.push(e,null,r);return a.decryptionPromise=null,t})),this.decryptionPromise;var P=S.softwareDecrypt(o,A.key.buffer,A.iv.buffer);if(r.part>-1&&(P=S.flush()),!P)return i.executeEnd=ia(),da(r);o=new Uint8Array(P)}var x=this.needsProbing(d,p);if(x){var w=this.configureTransmuxer(o);if(w)return C.warn("[transmuxer] "+w.message),this.observer.emit(_.ERROR,_.ERROR,{type:k.MEDIA_ERROR,details:E.FRAG_PARSING_ERROR,fatal:!1,error:w,reason:w.message}),i.executeEnd=ia(),da(r)}(d||p||m||x)&&this.resetInitSegment(T,g,y,b,t),(d||m||x)&&this.resetInitialTimestamp(v),c||this.resetContiguity();var I=this.transmux(o,A,f,h,r),M=this.currentTransmuxState;return M.contiguous=!0,M.discontinuity=!1,M.trackSwitch=!1,i.executeEnd=ia(),I},t.flush=function(e){var t=this,r=e.transmuxing;r.executeStart=ia();var n=this.decrypter,a=this.currentTransmuxState,i=this.decryptionPromise;if(i)return i.then((function(){return t.flush(e)}));var o=[],s=a.timeOffset;if(n){var l=n.flush();l&&o.push(this.push(l,null,e))}var u=this.demuxer,c=this.remuxer;if(!u||!c)return r.executeEnd=ia(),[da(e)];var d=u.flush(s);return pa(d)?d.then((function(r){return t.flushRemux(o,r,e),o})):(this.flushRemux(o,d,e),o)},t.flushRemux=function(e,t,r){var n=t.audioTrack,a=t.videoTrack,i=t.id3Track,o=t.textTrack,s=this.currentTransmuxState,l=s.accurateTimeOffset,u=s.timeOffset;C.log("[transmuxer.ts]: Flushed fragment "+r.sn+(r.part>-1?" p: "+r.part:"")+" of level "+r.level);var c=this.remuxer.remux(n,a,i,o,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:r}),r.transmuxing.executeEnd=ia()},t.resetInitialTimestamp=function(e){var t=this.demuxer,r=this.remuxer;t&&r&&(t.resetTimeStamp(e),r.resetTimeStamp(e))},t.resetContiguity=function(){var e=this.demuxer,t=this.remuxer;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())},t.resetInitSegment=function(e,t,r,n,a){var i=this.demuxer,o=this.remuxer;i&&o&&(i.resetInitSegment(e,t,r,n),o.resetInitSegment(e,t,r,a))},t.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},t.transmux=function(e,t,r,n,a){return t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,r,n,a):this.transmuxUnencrypted(e,r,n,a)},t.transmuxUnencrypted=function(e,t,r,n){var a=this.demuxer.demux(e,t,!1,!this.config.progressive),i=a.audioTrack,o=a.videoTrack,s=a.id3Track,l=a.textTrack;return{remuxResult:this.remuxer.remux(i,o,s,l,t,r,!1,this.id),chunkMeta:n}},t.transmuxSampleAes=function(e,t,r,n,a){var i=this;return this.demuxer.demuxSampleAes(e,t,r).then((function(e){return{remuxResult:i.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,r,n,!1,i.id),chunkMeta:a}}))},t.configureTransmuxer=function(e){for(var t,r=this.config,n=this.observer,a=this.typeSupported,i=this.vendor,o=0,s=ua.length;o<s;o++){var l;if(null!=(l=ua[o].demux)&&l.probe(e)){t=ua[o];break}}if(!t)return new Error("Failed to find demuxer by probing fragment data");var u=this.demuxer,c=this.remuxer,d=t.remux,p=t.demux;c&&c instanceof d||(this.remuxer=new d(n,r,a,i)),u&&u instanceof p||(this.demuxer=new p(n,r,a),this.probe=p.probe)},t.needsProbing=function(e,t){return!this.demuxer||!this.remuxer||e||t},t.getDecrypter=function(){var e=this.decrypter;return e||(e=this.decrypter=new zr(this.config)),e},e}(),da=function(e){return{remuxResult:{},chunkMeta:e}};function pa(e){return"then"in e&&e.then instanceof Function}var ha=function(e,t,r,n,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=n,this.defaultInitPts=a||null},fa=function(e,t,r,n,a,i){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=n,this.timeOffset=a,this.initSegmentChange=i},ma={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function a(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,n,i,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,i||e,o),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,a=[];if(0===this._eventsCount)return a;for(n in e=this._events)t.call(e,n)&&a.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var a=0,i=n.length,o=new Array(i);a<i;a++)o[a]=n[a].fn;return o},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,a,i,o){var s=r?r+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,a),!0;case 5:return c.fn.call(c.context,t,n,a,i),!0;case 6:return c.fn.call(c.context,t,n,a,i,o),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var p,h=c.length;for(u=0;u<h;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,n);break;case 4:c[u].fn.call(c[u].context,t,n,a);break;default:if(!l)for(p=1,l=new Array(d-1);p<d;p++)l[p-1]=arguments[p];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,a){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return o(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||a&&!s.once||n&&s.context!==n||o(this,i);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||a&&!s[l].once||n&&s[l].context!==n)&&u.push(s[l]);u.length?this._events[i]=1===u.length?u[0]:u:o(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s}(ma);var ga=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(ma.exports);function ya(e,t){if(!((r=t.remuxResult).audio||r.video||r.text||r.id3||r.initSegment))return!1;var r,n=[],a=t.remuxResult,i=a.audio,o=a.video;return i&&va(n,i),o&&va(n,o),e.postMessage({event:"transmuxComplete",data:t},n),!0}function va(e,t){t.data1&&e.push(t.data1.buffer),t.data2&&e.push(t.data2.buffer)}function _a(e,t,r){t.reduce((function(t,r){return ya(e,r)||t}),!1)||e.postMessage({event:"transmuxComplete",data:t[0]}),e.postMessage({event:"flush",data:r})}void 0!==t&&t&&function(e){var t=new ga,r=function(t,r){e.postMessage({event:t,data:r})};t.on(_.FRAG_DECRYPTED,r),t.on(_.ERROR,r);e.addEventListener("message",(function(n){var a=n.data;switch(a.cmd){case"init":var i=JSON.parse(a.config);e.transmuxer=new ca(t,a.typeSupported,i,a.vendor,a.id),S(i.debug,a.id),function(){var e=function(e){C[e]=function(t){r("workerLog",{logType:e,message:t})}};for(var t in C)e(t)}(),r("init",null);break;case"configure":e.transmuxer.configure(a.config);break;case"demux":var o=e.transmuxer.push(a.data,a.decryptdata,a.chunkMeta,a.state);pa(o)?(e.transmuxer.async=!0,o.then((function(t){ya(e,t)})).catch((function(e){r(_.ERROR,{type:k.MEDIA_ERROR,details:E.FRAG_PARSING_ERROR,chunkMeta:a.chunkMeta,fatal:!1,error:e,err:e,reason:"transmuxer-worker push error"})}))):(e.transmuxer.async=!1,ya(e,o));break;case"flush":var s=a.chunkMeta,l=e.transmuxer.flush(s);pa(l)||e.transmuxer.async?(pa(l)||(l=Promise.resolve(l)),l.then((function(t){_a(e,t,s)})).catch((function(e){r(_.ERROR,{type:k.MEDIA_ERROR,details:E.FRAG_PARSING_ERROR,chunkMeta:a.chunkMeta,fatal:!1,error:e,err:e,reason:"transmuxer-worker flush error"})}))):_a(e,l,s)}}))}(self);var ka=function(){function t(t,r,n,a){var i=this;this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var o=t.config;this.hls=t,this.id=r,this.useWorker=!!o.enableWorker,this.onTransmuxComplete=n,this.onFlush=a;var s=function(e,t){(t=t||{}).frag=i.frag,t.id=i.id,e===_.ERROR&&(i.error=t.error),i.hls.trigger(e,t)};this.observer=new ga,this.observer.on(_.FRAG_DECRYPTED,s),this.observer.on(_.ERROR,s);var l,u,c,d,p=Ye(o.preferManagedMediaSource)||{isTypeSupported:function(){return!1}},h={mpeg:p.isTypeSupported("audio/mpeg"),mp3:p.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:p.isTypeSupported('audio/mp4; codecs="ac-3"')},f=navigator.vendor;if(!this.useWorker||"undefined"==typeof Worker||(o.workerPath,0))this.transmuxer=new ca(this.observer,h,o,f,r);else try{o.workerPath?(C.log("loading Web Worker "+o.workerPath+' for "'+r+'"'),this.workerContext=(c=o.workerPath,d=new self.URL(c,self.location.href).href,{worker:new self.Worker(d),scriptURL:d})):(C.log('injecting Web Worker for "'+r+'"'),this.workerContext=(l=new self.Blob(["var exports={};var module={exports:exports};function define(f){f()};define.amd=true;("+e.toString()+")(true);"],{type:"text/javascript"}),u=self.URL.createObjectURL(l),{worker:new self.Worker(u),objectURL:u})),this.onwmsg=function(e){return i.onWorkerMessage(e)};var m=this.workerContext.worker;m.addEventListener("message",this.onwmsg),m.onerror=function(e){var t=new Error(e.message+"  ("+e.filename+":"+e.lineno+")");o.enableWorker=!1,C.warn('Error in "'+r+'" Web Worker, fallback to inline'),i.hls.trigger(_.ERROR,{type:k.OTHER_ERROR,details:E.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:t})},m.postMessage({cmd:"init",typeSupported:h,vendor:f,id:r,config:JSON.stringify(o)})}catch(e){C.warn('Error setting up "'+r+'" Web Worker, fallback to inline',e),this.resetWorker(),this.error=null,this.transmuxer=new ca(this.observer,h,o,f,r)}}var r=t.prototype;return r.resetWorker=function(){if(this.workerContext){var e=this.workerContext,t=e.worker,r=e.objectURL;r&&self.URL.revokeObjectURL(r),t.removeEventListener("message",this.onwmsg),t.onerror=null,t.terminate(),this.workerContext=null}},r.destroy=function(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{var e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}var t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},r.push=function(e,t,r,n,a,i,o,s,l,u){var c,d,p=this;l.transmuxing.start=self.performance.now();var h=this.transmuxer,f=i?i.start:a.start,m=a.decryptdata,g=this.frag,y=!(g&&a.cc===g.cc),v=!(g&&l.level===g.level),_=g?l.sn-g.sn:-1,k=this.part?l.part-this.part.index:-1,E=0===_&&l.id>1&&l.id===(null==g?void 0:g.stats.chunkCount),b=!v&&(1===_||0===_&&(1===k||E&&k<=0)),T=self.performance.now();(v||_||0===a.stats.parsing.start)&&(a.stats.parsing.start=T),!i||!k&&b||(i.stats.parsing.start=T);var A=!(g&&(null==(c=a.initSegment)?void 0:c.url)===(null==(d=g.initSegment)?void 0:d.url)),S=new fa(y,b,s,v,f,A);if(!b||y||A){C.log("[transmuxer-interface, "+a.type+"]: Starting new transmux session for sn: "+l.sn+" p: "+l.part+" level: "+l.level+" id: "+l.id+"\n        discontinuity: "+y+"\n        trackSwitch: "+v+"\n        contiguous: "+b+"\n        accurateTimeOffset: "+s+"\n        timeOffset: "+f+"\n        initSegmentChange: "+A);var P=new ha(r,n,t,o,u);this.configureTransmuxer(P)}if(this.frag=a,this.part=i,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:m,chunkMeta:l,state:S},e instanceof ArrayBuffer?[e]:[]);else if(h){var x=h.push(e,m,l,S);pa(x)?(h.async=!0,x.then((function(e){p.handleTransmuxComplete(e)})).catch((function(e){p.transmuxerError(e,l,"transmuxer-interface push error")}))):(h.async=!1,this.handleTransmuxComplete(x))}},r.flush=function(e){var t=this;e.transmuxing.start=self.performance.now();var r=this.transmuxer;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(r){var n=r.flush(e);pa(n)||r.async?(pa(n)||(n=Promise.resolve(n)),n.then((function(r){t.handleFlushResult(r,e)})).catch((function(r){t.transmuxerError(r,e,"transmuxer-interface flush error")}))):this.handleFlushResult(n,e)}},r.transmuxerError=function(e,t,r){this.hls&&(this.error=e,this.hls.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:r}))},r.handleFlushResult=function(e,t){var r=this;e.forEach((function(e){r.handleTransmuxComplete(e)})),this.onFlush(t)},r.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":var n,a=null==(n=this.workerContext)?void 0:n.objectURL;a&&self.URL.revokeObjectURL(a);break;case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":C[t.data.logType]&&C[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},r.configureTransmuxer=function(e){var t=this.transmuxer;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)},r.handleTransmuxComplete=function(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)},t}();function Ea(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!ba(e[r].attrs,t[r].attrs))return!1;return!0}function ba(e,t,r){var n=e["STABLE-RENDITION-ID"];return n&&!r?n===t["STABLE-RENDITION-ID"]:!(r||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((function(r){return e[r]!==t[r]}))}function Ta(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}var Aa=function(e){function t(t,r,n){var a;return(a=e.call(this,t,r,n,"[audio-stream-controller]",At)||this).videoBuffer=null,a.videoTrackCC=-1,a.waitingVideoCC=-1,a.bufferedTrack=null,a.switchingTrack=null,a.trackId=-1,a.waitingData=null,a.mainDetails=null,a.flushing=!1,a.bufferFlushed=!1,a.cachedTrackLoadedData=null,a._registerListeners(),a}l(t,e);var r=t.prototype;return r.onHandlerDestroying=function(){this._unregisterListeners(),e.prototype.onHandlerDestroying.call(this),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null},r._registerListeners=function(){var e=this.hls;e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(_.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(_.ERROR,this.onError,this),e.on(_.BUFFER_RESET,this.onBufferReset,this),e.on(_.BUFFER_CREATED,this.onBufferCreated,this),e.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(_.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(_.FRAG_BUFFERED,this.onFragBuffered,this)},r._unregisterListeners=function(){var e=this.hls;e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(_.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(_.ERROR,this.onError,this),e.off(_.BUFFER_RESET,this.onBufferReset,this),e.off(_.BUFFER_CREATED,this.onBufferCreated,this),e.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(_.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(_.FRAG_BUFFERED,this.onFragBuffered,this)},r.onInitPtsFound=function(e,t){var r=t.frag,n=t.id,a=t.initPTS,i=t.timescale;if("main"===n){var o=r.cc;this.initPTS[r.cc]={baseTime:a,timescale:i},this.log("InitPTS for cc: "+o+" found from main: "+a),this.videoTrackCC=o,this.state===an&&this.tick()}},r.startLoad=function(e){if(!this.levels)return this.startPosition=e,void(this.state=qr);var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),t>0&&-1===e?(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t,this.state=Yr):(this.loadedmetadata=!1,this.state=Jr),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()},r.doTick=function(){switch(this.state){case Yr:this.doTickIdle();break;case Jr:var t,r=this.levels,n=this.trackId,a=null==r||null==(t=r[n])?void 0:t.details;if(a){if(this.waitForCdnTuneIn(a))break;this.state=an}break;case Qr:var i,o=performance.now(),s=this.retryDate;if(!s||o>=s||null!=(i=this.media)&&i.seeking){var l=this.levels,u=this.trackId;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==l?void 0:l[u])||null),this.state=Yr}break;case an:var c=this.waitingData;if(c){var d=c.frag,p=c.part,h=c.cache,f=c.complete;if(void 0!==this.initPTS[d.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=Zr;var m={frag:d,part:p,payload:h.flush(),networkDetails:null};this._handleFragmentLoadProgress(m),f&&e.prototype._handleFragmentLoadComplete.call(this,m)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+d.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var g=this.getLoadPosition(),y=Dr.bufferInfo(this.mediaBuffer,g,this.config.maxBufferHole);ur(y.end,this.config.maxFragLookUpTolerance,d)<0&&(this.log("Waiting fragment cc ("+d.cc+") @ "+d.start+" cancelled because another fragment at "+y.end+" is needed"),this.clearWaitingFragment())}}else this.state=Yr}this.onTickEnd()},r.clearWaitingFragment=function(){var e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Yr)},r.resetLoadingState=function(){this.clearWaitingFragment(),e.prototype.resetLoadingState.call(this)},r.onTickEnd=function(){var e=this.media;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)},r.doTickIdle=function(){var e=this.hls,t=this.levels,r=this.media,n=this.trackId,a=e.config;if((r||!this.startFragRequested&&a.startFragPrefetch)&&null!=t&&t[n]){var i=t[n],o=i.details;if(!o||o.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(o))this.state=Jr;else{var s=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&s&&(this.bufferFlushed=!1,this.afterBufferFlushed(s,D,At));var l=this.getFwdBufferInfo(s,At);if(null!==l){var u=this.bufferedTrack,c=this.switchingTrack;if(!c&&this._streamEnded(l,o))return e.trigger(_.BUFFER_EOS,{type:"audio"}),void(this.state=rn);var d=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Tt),p=l.len,h=this.getMaxBufferLength(null==d?void 0:d.len),f=o.fragments,m=f[0].start,g=this.flushing?this.getLoadPosition():l.end;if(c&&r){var y=this.getLoadPosition();u&&!ba(c.attrs,u.attrs)&&(g=y),o.PTSKnown&&y<m&&(l.end>m||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=m+.05)}if(!(p>=h&&!c&&g<f[f.length-1].start)){var v=this.getNextFragment(g,o),k=!1;if(v&&this.isLoopLoading(v,g)&&(k=!!v.gap,v=this.getNextFragmentLoopLoading(v,o,l,Tt,h)),v){var E=d&&v.start>d.end+o.targetduration;if(E||(null==d||!d.len)&&l.len){var b=this.getAppendedFrag(v.start,Tt);if(null===b)return;if(k||(k=!!b.gap||!!E&&0===d.len),E&&!k||k&&l.nextStart&&l.nextStart<b.end)return}this.loadFragment(v,i,g)}else this.bufferFlushed=!0}}}}},r.getMaxBufferLength=function(t){var r=e.prototype.getMaxBufferLength.call(this);return t?Math.min(Math.max(r,t),this.config.maxMaxBufferLength):r},r.onMediaDetaching=function(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,e.prototype.onMediaDetaching.call(this)},r.onAudioTracksUpdated=function(e,t){var r=t.audioTracks;this.resetTransmuxer(),this.levels=r.map((function(e){return new Wt(e)}))},r.onAudioTrackSwitching=function(e,t){var r=!!t.url;this.trackId=t.id;var n=this.fragCurrent;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),r?this.setInterval(100):this.resetTransmuxer(),r?(this.switchingTrack=t,this.state=Yr,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=qr),this.tick()},r.onManifestLoading=function(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1},r.onLevelLoaded=function(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(_.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},r.onAudioTrackLoaded=function(e,t){var r;if(null!=this.mainDetails){var n=this.levels,a=t.details,i=t.id;if(n){this.log("Audio track "+i+" loaded ["+a.startSN+","+a.endSN+"]"+(a.lastPartSn?"[part-"+a.lastPartSn+"-"+a.lastPartIndex+"]":"")+",duration:"+a.totalduration);var o=n[i],s=0;if(a.live||null!=(r=o.details)&&r.live){this.checkLiveUpdate(a);var l,u=this.mainDetails;if(a.deltaUpdateFailed||!u)return;!o.details&&a.hasProgramDateTime&&u.hasProgramDateTime?(jr(a,u),s=a.fragments[0].start):s=this.alignPlaylists(a,o.details,null==(l=this.levelLastLoaded)?void 0:l.details)}o.details=a,this.levelLastLoaded=o,this.startFragRequested||!this.mainDetails&&a.live||this.setStartPosition(this.mainDetails||a,s),this.state!==Jr||this.waitForCdnTuneIn(a)||(this.state=Yr),this.tick()}else this.warn("Audio tracks were reset while loading level "+i)}else this.cachedTrackLoadedData=t},r._handleFragmentLoadProgress=function(e){var t,r=e.frag,n=e.part,a=e.payload,i=this.config,o=this.trackId,s=this.levels;if(s){var l=s[o];if(l){var u=l.details;if(!u)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(r.start);var c=i.defaultAudioCodec||l.audioCodec||"mp4a.40.2",d=this.transmuxer;d||(d=this.transmuxer=new ka(this.hls,At,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var p=this.initPTS[r.cc],h=null==(t=r.initSegment)?void 0:t.data;if(void 0!==p){var f=n?n.index:-1,m=-1!==f,g=new Or(r.level,r.sn,r.stats.chunkCount,a.byteLength,f,m);d.push(a,h,c,"",r,n,u.totalduration,!1,g,p)}else this.log("Unknown video PTS for cc "+r.cc+", waiting for video PTS before demuxing audio frag "+r.sn+" of ["+u.startSN+" ,"+u.endSN+"],track "+o),(this.waitingData=this.waitingData||{frag:r,part:n,cache:new ln,complete:!1}).cache.push(new Uint8Array(a)),this.waitingVideoCC=this.videoTrackCC,this.state=an}else this.warn("Audio track is undefined on fragment load progress")}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered")},r._handleFragmentLoadComplete=function(t){this.waitingData?this.waitingData.complete=!0:e.prototype._handleFragmentLoadComplete.call(this,t)},r.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},r.onBufferCreated=function(e,t){var r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)},r.onFragBuffered=function(e,t){var r=t.frag,a=t.part;if(r.type===At)if(this.fragContextChanged(r))this.warn("Fragment "+r.sn+(a?" p: "+a.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+(this.switchingTrack?this.switchingTrack.name:"false"));else{if("initSegment"!==r.sn){this.fragPrevious=r;var i=this.switchingTrack;i&&(this.bufferedTrack=i,this.switchingTrack=null,this.hls.trigger(_.AUDIO_TRACK_SWITCHED,n({},i)))}this.fragBufferedComplete(r,a)}else if(!this.loadedmetadata&&r.type===Tt){var o=this.videoBuffer||this.media;o&&Dr.getBuffered(o).length&&(this.loadedmetadata=!0)}},r.onError=function(t,r){var n;if(r.fatal)this.state=nn;else switch(r.details){case E.FRAG_GAP:case E.FRAG_PARSING_ERROR:case E.FRAG_DECRYPT_ERROR:case E.FRAG_LOAD_ERROR:case E.FRAG_LOAD_TIMEOUT:case E.KEY_LOAD_ERROR:case E.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(At,r);break;case E.AUDIO_TRACK_LOAD_ERROR:case E.AUDIO_TRACK_LOAD_TIMEOUT:case E.LEVEL_PARSING_ERROR:r.levelRetry||this.state!==Jr||(null==(n=r.context)?void 0:n.type)!==Et||(this.state=Yr);break;case E.BUFFER_APPEND_ERROR:case E.BUFFER_FULL_ERROR:if(!r.parent||"audio"!==r.parent)return;if(r.details===E.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(r)&&(this.bufferedTrack=null,e.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio"));break;case E.INTERNAL_EXCEPTION:this.recoverWorkerError(r)}},r.onBufferFlushing=function(e,t){t.type!==O&&(this.flushing=!0)},r.onBufferFlushed=function(e,t){var r=t.type;if(r!==O){this.flushing=!1,this.bufferFlushed=!0,this.state===rn&&(this.state=Yr);var n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,r,At),this.tick())}},r._handleTransmuxComplete=function(e){var t,r="audio",n=this.hls,a=e.remuxResult,i=e.chunkMeta,o=this.getCurrentContext(i);if(o){var l=o.frag,u=o.part,c=o.level,d=c.details,p=a.audio,h=a.text,f=a.id3,m=a.initSegment;if(!this.fragContextChanged(l)&&d){if(this.state=en,this.switchingTrack&&p&&this.completeAudioSwitch(this.switchingTrack),null!=m&&m.tracks){var g=l.initSegment||l;this._bufferInitSegment(c,m.tracks,g,i),n.trigger(_.FRAG_PARSING_INIT_SEGMENT,{frag:g,id:r,tracks:m.tracks})}if(p){var y=p.startPTS,v=p.endPTS,k=p.startDTS,E=p.endDTS;u&&(u.elementaryStreams[D]={startPTS:y,endPTS:v,startDTS:k,endDTS:E}),l.setElementaryStreamInfo(D,y,v,k,E),this.bufferFragmentData(p,l,u,i)}if(null!=f&&null!=(t=f.samples)&&t.length){var b=s({id:r,frag:l,details:d},f);n.trigger(_.FRAG_PARSING_METADATA,b)}if(h){var T=s({id:r,frag:l,details:d},h);n.trigger(_.FRAG_PARSING_USERDATA,T)}}else this.fragmentTracker.removeFragment(l)}else this.resetWhenMissingContext(i)},r._bufferInitSegment=function(e,t,r,n){if(this.state===en){t.video&&delete t.video;var a=t.audio;if(a){a.id="audio";var i=e.audioCodec;this.log("Init audio buffer, container:"+a.container+", codecs[level/parsed]=["+i+"/"+a.codec+"]"),i&&1===i.split(",").length&&(a.levelCodec=i),this.hls.trigger(_.BUFFER_CODECS,t);var o=a.initSegment;if(null!=o&&o.byteLength){var s={type:"audio",frag:r,part:null,chunkMeta:n,parent:r.type,data:o};this.hls.trigger(_.BUFFER_APPENDING,s)}this.tickImmediate()}}},r.loadFragment=function(t,r,n){var a,i=this.fragmentTracker.getState(t);if(this.fragCurrent=t,this.switchingTrack||i===Sr||i===Pr)if("initSegment"===t.sn)this._loadInitSegment(t,r);else if(null!=(a=r.details)&&a.live&&!this.initPTS[t.cc]){this.log("Waiting for video PTS in continuity counter "+t.cc+" of live stream before loading audio fragment "+t.sn+" of level "+this.trackId),this.state=an;var o=this.mainDetails;o&&o.fragments[0].start!==r.details.fragments[0].start&&jr(r.details,o)}else this.startFragRequested=!0,e.prototype.loadFragment.call(this,t,r,n);else this.clearTrackerIfNeeded(t)},r.flushAudioIfNeeded=function(t){var r=this.media,n=this.bufferedTrack,a=null==n?void 0:n.attrs,i=t.attrs;r&&a&&(a.CHANNELS!==i.CHANNELS||n.name!==t.name||n.lang!==t.lang)&&(this.log("Switching audio track : flushing all audio"),e.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)},r.completeAudioSwitch=function(e){var t=this.hls;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(_.AUDIO_TRACK_SWITCHED,n({},e))},t}(sn),Sa=function(e){function t(t){var r;return(r=e.call(this,t,"[audio-track-controller]")||this).tracks=[],r.groupIds=null,r.tracksInGroup=[],r.trackId=-1,r.currentTrack=null,r.selectDefaultTrack=!0,r.registerListeners(),r}l(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(_.LEVEL_LOADING,this.onLevelLoading,this),e.on(_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(_.ERROR,this.onError,this)},r.unregisterListeners=function(){var e=this.hls;e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(_.LEVEL_LOADING,this.onLevelLoading,this),e.off(_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(_.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(_.ERROR,this.onError,this)},r.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,e.prototype.destroy.call(this)},r.onManifestLoading=function(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0},r.onManifestParsed=function(e,t){this.tracks=t.audioTracks||[]},r.onAudioTrackLoaded=function(e,t){var r=t.id,n=t.groupId,a=t.details,i=this.tracksInGroup[r];if(i&&i.groupId===n){var o=i.details;i.details=t.details,this.log("Audio track "+r+' "'+i.name+'" lang:'+i.lang+" group:"+n+" loaded ["+a.startSN+"-"+a.endSN+"]"),r===this.trackId&&this.playlistLoaded(r,t,o)}else this.warn("Audio track with id:"+r+" and group:"+n+" not found in active group "+(null==i?void 0:i.groupId))},r.onLevelLoading=function(e,t){this.switchLevel(t.level)},r.onLevelSwitching=function(e,t){this.switchLevel(t.level)},r.switchLevel=function(e){var t=this.hls.levels[e];if(t){var r=t.audioGroups||null,n=this.groupIds,a=this.currentTrack;if(!r||(null==n?void 0:n.length)!==(null==r?void 0:r.length)||null!=r&&r.some((function(e){return-1===(null==n?void 0:n.indexOf(e))}))){this.groupIds=r,this.trackId=-1,this.currentTrack=null;var i=this.tracks.filter((function(e){return!r||-1!==r.indexOf(e.groupId)}));if(i.length)this.selectDefaultTrack&&!i.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),i.forEach((function(e,t){e.id=t}));else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=i;var o=this.hls.config.audioPreference;if(!a&&o){var s=_r(o,i,Er);if(s>-1)a=i[s];else{var l=_r(o,this.tracks);a=this.tracks[l]}}var u=this.findTrackId(a);-1===u&&a&&(u=this.findTrackId(null));var c={audioTracks:i};this.log("Updating audio tracks, "+i.length+" track(s) found in group(s): "+(null==r?void 0:r.join(","))),this.hls.trigger(_.AUDIO_TRACKS_UPDATED,c);var d=this.trackId;if(-1!==u&&-1===d)this.setAudioTrack(u);else if(i.length&&-1===d){var p,h=new Error("No audio track selected for current audio group-ID(s): "+(null==(p=this.groupIds)?void 0:p.join(","))+" track count: "+i.length);this.warn(h.message),this.hls.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:h})}}else this.shouldReloadPlaylist(a)&&this.setAudioTrack(this.trackId)}},r.onError=function(e,t){!t.fatal&&t.context&&(t.context.type!==Et||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||(this.requestScheduled=-1,this.checkRetry(t)))},r.setAudioOption=function(e){var t=this.hls;if(t.config.audioPreference=e,e){var r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){var n=this.currentTrack;if(n&&kr(e,n,Er))return n;var a=_r(e,this.tracksInGroup,Er);if(a>-1){var i=this.tracksInGroup[a];return this.setAudioTrack(a),i}if(n){var o=t.loadLevel;-1===o&&(o=t.firstAutoLevel);var s=function(e,t,r,n,a){var i=t[n],o=t.reduce((function(e,t,r){var n=t.uri;return(e[n]||(e[n]=[])).push(r),e}),{})[i.uri];o.length>1&&(n=Math.max.apply(Math,o));var s=i.videoRange,l=i.frameRate,u=i.codecSet.substring(0,4),c=br(t,n,(function(t){if(t.videoRange!==s||t.frameRate!==l||t.codecSet.substring(0,4)!==u)return!1;var n=t.audioGroups,i=r.filter((function(e){return!n||-1!==n.indexOf(e.groupId)}));return _r(e,i,a)>-1}));return c>-1?c:br(t,n,(function(t){var n=t.audioGroups,i=r.filter((function(e){return!n||-1!==n.indexOf(e.groupId)}));return _r(e,i,a)>-1}))}(e,t.levels,r,o,Er);if(-1===s)return null;t.nextLoadLevel=s}if(e.channels||e.audioCodec){var l=_r(e,r);if(l>-1)return r[l]}}}return null},r.setAudioTrack=function(e){var t=this.tracksInGroup;if(e<0||e>=t.length)this.warn("Invalid audio track id: "+e);else{this.clearTimer(),this.selectDefaultTrack=!1;var r=this.currentTrack,a=t[e],i=a.details&&!a.details.live;if(!(e===this.trackId&&a===r&&i||(this.log("Switching to audio-track "+e+' "'+a.name+'" lang:'+a.lang+" group:"+a.groupId+" channels:"+a.channels),this.trackId=e,this.currentTrack=a,this.hls.trigger(_.AUDIO_TRACK_SWITCHING,n({},a)),i))){var o=this.switchParams(a.url,null==r?void 0:r.details,a.details);this.loadPlaylist(o)}}},r.findTrackId=function(e){for(var t=this.tracksInGroup,r=0;r<t.length;r++){var n=t[r];if((!this.selectDefaultTrack||n.default)&&(!e||kr(e,n,Er)))return r}if(e){for(var a=e.name,i=e.lang,o=e.assocLang,s=e.characteristics,l=e.audioCodec,u=e.channels,c=0;c<t.length;c++)if(kr({name:a,lang:i,assocLang:o,characteristics:s,audioCodec:l,channels:u},t[c],Er))return c;for(var d=0;d<t.length;d++){var p=t[d];if(ba(e.attrs,p.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(var h=0;h<t.length;h++){var f=t[h];if(ba(e.attrs,f.attrs,["LANGUAGE"]))return h}}return-1},r.loadPlaylist=function(t){var r=this.currentTrack;if(this.shouldLoadPlaylist(r)&&r){e.prototype.loadPlaylist.call(this);var n=r.id,a=r.groupId,i=r.url;if(t)try{i=t.addDirectives(i)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("loading audio-track playlist "+n+' "'+r.name+'" lang:'+r.lang+" group:"+a),this.clearTimer(),this.hls.trigger(_.AUDIO_TRACK_LOADING,{url:i,id:n,groupId:a,deliveryDirectives:t||null})}},o(t,[{key:"allAudioTracks",get:function(){return this.tracks}},{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}}]),t}(pr),Ca=function(e){function t(t,r,n){var a;return(a=e.call(this,t,r,n,"[subtitle-stream-controller]",St)||this).currentTrackId=-1,a.tracksBuffered=[],a.mainDetails=null,a._registerListeners(),a}l(t,e);var r=t.prototype;return r.onHandlerDestroying=function(){this._unregisterListeners(),e.prototype.onHandlerDestroying.call(this),this.mainDetails=null},r._registerListeners=function(){var e=this.hls;e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(_.ERROR,this.onError,this),e.on(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(_.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(_.FRAG_BUFFERED,this.onFragBuffered,this)},r._unregisterListeners=function(){var e=this.hls;e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(_.ERROR,this.onError,this),e.off(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(_.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(_.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(_.FRAG_BUFFERED,this.onFragBuffered,this)},r.startLoad=function(e){this.stopLoad(),this.state=Yr,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()},r.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},r.onMediaDetaching=function(){this.tracksBuffered=[],e.prototype.onMediaDetaching.call(this)},r.onLevelLoaded=function(e,t){this.mainDetails=t.details},r.onSubtitleFragProcessed=function(e,t){var r=t.frag,n=t.success;if(this.fragPrevious=r,this.state=Yr,n){var a=this.tracksBuffered[this.currentTrackId];if(a){for(var i,o=r.start,s=0;s<a.length;s++)if(o>=a[s].start&&o<=a[s].end){i=a[s];break}var l=r.start+r.duration;i?i.end=l:(i={start:o,end:l},a.push(i)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null)}}},r.onBufferFlushing=function(e,t){var r=t.startOffset,n=t.endOffset;if(0===r&&n!==Number.POSITIVE_INFINITY){var a=n-1;if(a<=0)return;t.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach((function(e){for(var t=0;t<e.length;)if(e[t].end<=a)e.shift();else{if(!(e[t].start<a))break;e[t].start=a,t++}})),this.fragmentTracker.removeFragmentsInRange(r,a,St)}},r.onFragBuffered=function(e,t){var r;this.loadedmetadata||t.frag.type!==Tt||null!=(r=this.media)&&r.buffered.length&&(this.loadedmetadata=!0)},r.onError=function(e,t){var r=t.frag;(null==r?void 0:r.type)===St&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==qr&&(this.state=Yr))},r.onSubtitleTracksUpdated=function(e,t){var r=this,n=t.subtitleTracks;this.levels&&Ea(this.levels,n)?this.levels=n.map((function(e){return new Wt(e)})):(this.tracksBuffered=[],this.levels=n.map((function(e){var t=new Wt(e);return r.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,St),this.fragPrevious=null,this.mediaBuffer=null)},r.onSubtitleTrackSwitch=function(e,t){var r;if(this.currentTrackId=t.id,null!=(r=this.levels)&&r.length&&-1!==this.currentTrackId){var n=this.levels[this.currentTrackId];null!=n&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.setInterval(500)}else this.clearInterval()},r.onSubtitleTrackLoaded=function(e,t){var r,n=this.currentTrackId,a=this.levels,i=t.details,o=t.id;if(a){var s=a[n];if(!(o>=a.length||o!==n)&&s){this.log("Subtitle track "+o+" loaded ["+i.startSN+","+i.endSN+"]"+(i.lastPartSn?"[part-"+i.lastPartSn+"-"+i.lastPartIndex+"]":"")+",duration:"+i.totalduration),this.mediaBuffer=this.mediaBufferTimeRanges;var l=0;if(i.live||null!=(r=s.details)&&r.live){var u=this.mainDetails;if(i.deltaUpdateFailed||!u)return;var c,d=u.fragments[0];s.details?0===(l=this.alignPlaylists(i,s.details,null==(c=this.levelLastLoaded)?void 0:c.details))&&d&&Qt(i,l=d.start):i.hasProgramDateTime&&u.hasProgramDateTime?(jr(i,u),l=i.fragments[0].start):d&&Qt(i,l=d.start)}s.details=i,this.levelLastLoaded=s,this.startFragRequested||!this.mainDetails&&i.live||this.setStartPosition(this.mainDetails||i,l),this.tick(),i.live&&!this.fragCurrent&&this.media&&this.state===Yr&&(lr(null,i.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),s.details=void 0))}}else this.warn("Subtitle tracks were reset while loading level "+o)},r._handleFragmentLoadComplete=function(e){var t=this,r=e.frag,n=e.payload,a=r.decryptdata,i=this.hls;if(!this.fragContextChanged(r)&&n&&n.byteLength>0&&null!=a&&a.key&&a.iv&&"AES-128"===a.method){var o=performance.now();this.decrypter.decrypt(new Uint8Array(n),a.key.buffer,a.iv.buffer).catch((function(e){throw i.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:r}),e})).then((function(e){var t=performance.now();i.trigger(_.FRAG_DECRYPTED,{frag:r,payload:e,stats:{tstart:o,tdecrypt:t}})})).catch((function(e){t.warn(e.name+": "+e.message),t.state=Yr}))}},r.doTick=function(){if(this.media){if(this.state===Yr){var e=this.currentTrackId,t=this.levels,r=null==t?void 0:t[e];if(!r||!t.length||!r.details)return;var n=this.config,a=this.getLoadPosition(),i=Dr.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,n.maxBufferHole),o=i.end,s=i.len,l=this.getFwdBufferInfo(this.media,Tt),u=r.details;if(s>this.getMaxBufferLength(null==l?void 0:l.len)+u.levelTargetDuration)return;var c=u.fragments,d=c.length,p=u.edge,h=null,f=this.fragPrevious;if(o<p){var m=n.maxFragLookUpTolerance,g=o>p-m?0:m;!(h=lr(f,c,Math.max(c[0].start,o),g))&&f&&f.start<c[0].start&&(h=c[0])}else h=c[d-1];if(!h)return;if("initSegment"!==(h=this.mapToInitFragWhenRequired(h)).sn){var y=c[h.sn-u.startSN-1];y&&y.cc===h.cc&&this.fragmentTracker.getState(y)===Sr&&(h=y)}this.fragmentTracker.getState(h)===Sr&&this.loadFragment(h,r,o)}}else this.state=Yr},r.getMaxBufferLength=function(t){var r=e.prototype.getMaxBufferLength.call(this);return t?Math.max(r,t):r},r.loadFragment=function(t,r,n){this.fragCurrent=t,"initSegment"===t.sn?this._loadInitSegment(t,r):(this.startFragRequested=!0,e.prototype.loadFragment.call(this,t,r,n))},o(t,[{key:"mediaBufferTimeRanges",get:function(){return new Pa(this.tracksBuffered[this.currentTrackId]||[])}}]),t}(sn),Pa=function(e){this.buffered=void 0;var t=function(t,r,n){if((r>>>=0)>n-1)throw new DOMException("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+r+") is greater than the maximum bound ("+n+")");return e[r][t]};this.buffered={get length(){return e.length},end:function(r){return t("end",r,e.length)},start:function(r){return t("start",r,e.length)}}},xa=function(e){function t(t){var r;return(r=e.call(this,t,"[subtitle-track-controller]")||this).media=null,r.tracks=[],r.groupIds=null,r.tracksInGroup=[],r.trackId=-1,r.currentTrack=null,r.selectDefaultTrack=!0,r.queuedDefaultTrack=-1,r.asyncPollTrackChange=function(){return r.pollTrackChange(0)},r.useTextTrackPolling=!1,r.subtitlePollingInterval=-1,r._subtitleDisplay=!0,r.onTextTracksChanged=function(){if(r.useTextTrackPolling||self.clearInterval(r.subtitlePollingInterval),r.media&&r.hls.config.renderTextTracksNatively){for(var e=null,t=Dt(r.media.textTracks),n=0;n<t.length;n++)if("hidden"===t[n].mode)e=t[n];else if("showing"===t[n].mode){e=t[n];break}var a=r.findTrackForTextTrack(e);r.subtitleTrack!==a&&r.setSubtitleTrack(a)}},r.registerListeners(),r}l(t,e);var r=t.prototype;return r.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,e.prototype.destroy.call(this)},r.registerListeners=function(){var e=this.hls;e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(_.LEVEL_LOADING,this.onLevelLoading,this),e.on(_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(_.ERROR,this.onError,this)},r.unregisterListeners=function(){var e=this.hls;e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(_.LEVEL_LOADING,this.onLevelLoading,this),e.off(_.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(_.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(_.ERROR,this.onError,this)},r.onMediaAttached=function(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},r.pollTrackChange=function(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)},r.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Dt(this.media.textTracks).forEach((function(e){Mt(e)})),this.subtitleTrack=-1,this.media=null)},r.onManifestLoading=function(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0},r.onManifestParsed=function(e,t){this.tracks=t.subtitleTracks},r.onSubtitleTrackLoaded=function(e,t){var r=t.id,n=t.groupId,a=t.details,i=this.tracksInGroup[r];if(i&&i.groupId===n){var o=i.details;i.details=t.details,this.log("Subtitle track "+r+' "'+i.name+'" lang:'+i.lang+" group:"+n+" loaded ["+a.startSN+"-"+a.endSN+"]"),r===this.trackId&&this.playlistLoaded(r,t,o)}else this.warn("Subtitle track with id:"+r+" and group:"+n+" not found in active group "+(null==i?void 0:i.groupId))},r.onLevelLoading=function(e,t){this.switchLevel(t.level)},r.onLevelSwitching=function(e,t){this.switchLevel(t.level)},r.switchLevel=function(e){var t=this.hls.levels[e];if(t){var r=t.subtitleGroups||null,n=this.groupIds,a=this.currentTrack;if(!r||(null==n?void 0:n.length)!==(null==r?void 0:r.length)||null!=r&&r.some((function(e){return-1===(null==n?void 0:n.indexOf(e))}))){this.groupIds=r,this.trackId=-1,this.currentTrack=null;var i=this.tracks.filter((function(e){return!r||-1!==r.indexOf(e.groupId)}));if(i.length)this.selectDefaultTrack&&!i.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),i.forEach((function(e,t){e.id=t}));else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=i;var o=this.hls.config.subtitlePreference;if(!a&&o){this.selectDefaultTrack=!1;var s=_r(o,i);if(s>-1)a=i[s];else{var l=_r(o,this.tracks);a=this.tracks[l]}}var u=this.findTrackId(a);-1===u&&a&&(u=this.findTrackId(null));var c={subtitleTracks:i};this.log("Updating subtitle tracks, "+i.length+' track(s) found in "'+(null==r?void 0:r.join(","))+'" group-id'),this.hls.trigger(_.SUBTITLE_TRACKS_UPDATED,c),-1!==u&&-1===this.trackId&&this.setSubtitleTrack(u)}else this.shouldReloadPlaylist(a)&&this.setSubtitleTrack(this.trackId)}},r.findTrackId=function(e){for(var t=this.tracksInGroup,r=this.selectDefaultTrack,n=0;n<t.length;n++){var a=t[n];if((!r||a.default)&&(r||e)&&(!e||kr(a,e)))return n}if(e){for(var i=0;i<t.length;i++){var o=t[i];if(ba(e.attrs,o.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(var s=0;s<t.length;s++){var l=t[s];if(ba(e.attrs,l.attrs,["LANGUAGE"]))return s}}return-1},r.findTrackForTextTrack=function(e){if(e)for(var t=this.tracksInGroup,r=0;r<t.length;r++)if(Ta(t[r],e))return r;return-1},r.onError=function(e,t){!t.fatal&&t.context&&(t.context.type!==bt||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))},r.setSubtitleOption=function(e){if(this.hls.config.subtitlePreference=e,e){var t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){var r=this.currentTrack;if(r&&kr(e,r))return r;var n=_r(e,this.tracksInGroup);if(n>-1){var a=this.tracksInGroup[n];return this.setSubtitleTrack(n),a}if(r)return null;var i=_r(e,t);if(i>-1)return t[i]}}return null},r.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this);var r=this.currentTrack;if(this.shouldLoadPlaylist(r)&&r){var n=r.id,a=r.groupId,i=r.url;if(t)try{i=t.addDirectives(i)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("Loading subtitle playlist for id "+n),this.hls.trigger(_.SUBTITLE_TRACK_LOADING,{url:i,id:n,groupId:a,deliveryDirectives:t||null})}},r.toggleTrackModes=function(){var e=this.media;if(e){var t,r=Dt(e.textTracks),n=this.currentTrack;if(n&&((t=r.filter((function(e){return Ta(n,e)}))[0])||this.warn('Unable to find subtitle TextTrack with name "'+n.name+'" and language "'+n.lang+'"')),[].slice.call(r).forEach((function(e){"disabled"!==e.mode&&e!==t&&(e.mode="disabled")})),t){var a=this.subtitleDisplay?"showing":"hidden";t.mode!==a&&(t.mode=a)}}},r.setSubtitleTrack=function(e){var t=this.tracksInGroup;if(this.media)if(e<-1||e>=t.length||!g(e))this.warn("Invalid subtitle track id: "+e);else{this.clearTimer(),this.selectDefaultTrack=!1;var r=this.currentTrack,n=t[e]||null;if(this.trackId=e,this.currentTrack=n,this.toggleTrackModes(),n){var a=!!n.details&&!n.details.live;if(e!==this.trackId||n!==r||!a){this.log("Switching to subtitle-track "+e+(n?' "'+n.name+'" lang:'+n.lang+" group:"+n.groupId:""));var i=n.id,o=n.groupId,s=void 0===o?"":o,l=n.name,u=n.type,c=n.url;this.hls.trigger(_.SUBTITLE_TRACK_SWITCH,{id:i,groupId:s,name:l,type:u,url:c});var d=this.switchParams(n.url,null==r?void 0:r.details,n.details);this.loadPlaylist(d)}}else this.hls.trigger(_.SUBTITLE_TRACK_SWITCH,{id:e})}else this.queuedDefaultTrack=e},o(t,[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}},{key:"allSubtitleTracks",get:function(){return this.tracks}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}}]),t}(pr),wa=function(){function e(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}var t=e.prototype;return t.append=function(e,t,r){var n=this.queues[t];n.push(e),1!==n.length||r||this.executeNext(t)},t.insertAbort=function(e,t){this.queues[t].unshift(e),this.executeNext(t)},t.appendBlocker=function(e){var t,r=new Promise((function(e){t=e})),n={execute:t,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(n,e),r},t.executeNext=function(e){var t=this.queues[e];if(t.length){var r=t[0];try{r.execute()}catch(t){C.warn('[buffer-operation-queue]: Exception executing "'+e+'" SourceBuffer operation: '+t),r.onError(t);var n=this.buffers[e];null!=n&&n.updating||this.shiftAndExecuteNext(e)}}},t.shiftAndExecuteNext=function(e){this.queues[e].shift(),this.executeNext(e)},t.current=function(e){return this.queues[e][0]},e}(),Ia=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,Ma=function(){function e(e){var t=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=function(e){t.hls&&t.hls.pauseBuffering()},this._onStartStreaming=function(e){t.hls&&t.hls.resumeBuffering()},this._onMediaSourceOpen=function(){var e=t.media,r=t.mediaSource;t.log("Media source opened"),e&&(e.removeEventListener("emptied",t._onMediaEmptied),t.updateMediaElementDuration(),t.hls.trigger(_.MEDIA_ATTACHED,{media:e,mediaSource:r})),r&&r.removeEventListener("sourceopen",t._onMediaSourceOpen),t.checkPendingTracks()},this._onMediaSourceClose=function(){t.log("Media source closed")},this._onMediaSourceEnded=function(){t.log("Media source ended")},this._onMediaEmptied=function(){var e=t.mediaSrc,r=t._objectUrl;e!==r&&C.error("Media element src was set while attaching MediaSource ("+r+" > "+e+")")},this.hls=e;var r,n="[buffer-controller]";this.appendSource=(r=Ye(e.config.preferManagedMediaSource),"undefined"!=typeof self&&r===self.ManagedMediaSource),this.log=C.log.bind(C,n),this.warn=C.warn.bind(C,n),this.error=C.error.bind(C,n),this._initSourceBuffer(),this.registerListeners()}var t=e.prototype;return t.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},t.destroy=function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null},t.registerListeners=function(){var e=this.hls;e.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(_.BUFFER_RESET,this.onBufferReset,this),e.on(_.BUFFER_APPENDING,this.onBufferAppending,this),e.on(_.BUFFER_CODECS,this.onBufferCodecs,this),e.on(_.BUFFER_EOS,this.onBufferEos,this),e.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(_.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(_.FRAG_PARSED,this.onFragParsed,this),e.on(_.FRAG_CHANGED,this.onFragChanged,this)},t.unregisterListeners=function(){var e=this.hls;e.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(_.BUFFER_RESET,this.onBufferReset,this),e.off(_.BUFFER_APPENDING,this.onBufferAppending,this),e.off(_.BUFFER_CODECS,this.onBufferCodecs,this),e.off(_.BUFFER_EOS,this.onBufferEos,this),e.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(_.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(_.FRAG_PARSED,this.onFragParsed,this),e.off(_.FRAG_CHANGED,this.onFragChanged,this)},t._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new wa(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null},t.onManifestLoading=function(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null},t.onManifestParsed=function(e,t){var r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r,this.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},t.onMediaAttaching=function(e,t){var r=this.media=t.media,n=Ye(this.appendSource);if(r&&n){var a,i=this.mediaSource=new n;this.log("created media source: "+(null==(a=i.constructor)?void 0:a.name)),i.addEventListener("sourceopen",this._onMediaSourceOpen),i.addEventListener("sourceended",this._onMediaSourceEnded),i.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(i.addEventListener("startstreaming",this._onStartStreaming),i.addEventListener("endstreaming",this._onEndStreaming));var o=this._objectUrl=self.URL.createObjectURL(i);if(this.appendSource)try{r.removeAttribute("src");var s=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||s&&i instanceof s,Ra(r),function(e,t){var r=self.document.createElement("source");r.type="video/mp4",r.src=t,e.appendChild(r)}(r,o),r.load()}catch(e){r.src=o}else r.src=o;r.addEventListener("emptied",this._onMediaEmptied)}},t.onMediaDetaching=function(){var e=this.media,t=this.mediaSource,r=this._objectUrl;if(t){if(this.log("media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){this.warn("onMediaDetaching: "+e.message+" while calling endOfStream")}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),r&&self.URL.revokeObjectURL(r),this.mediaSrc===r?(e.removeAttribute("src"),this.appendSource&&Ra(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(_.MEDIA_DETACHED,void 0)},t.onBufferReset=function(){var e=this;this.getSourceBufferTypes().forEach((function(t){e.resetBuffer(t)})),this._initSourceBuffer()},t.resetBuffer=function(e){var t=this.sourceBuffer[e];try{var r;t&&(this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,null!=(r=this.mediaSource)&&r.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t))}catch(t){this.warn("onBufferReset "+e,t)}},t.onBufferCodecs=function(e,t){var r=this,n=this.getSourceBufferTypes().length,a=Object.keys(t);if(a.forEach((function(e){if(n){var a=r.tracks[e];if(a&&"function"==typeof a.buffer.changeType){var i,o=t[e],s=o.id,l=o.codec,u=o.levelCodec,c=o.container,d=o.metadata,p=it(a.codec,a.levelCodec),h=null==p?void 0:p.replace(Ia,"$1"),f=it(l,u),m=null==(i=f)?void 0:i.replace(Ia,"$1");if(f&&h!==m){"audio"===e.slice(0,5)&&(f=at(f,r.appendSource));var g=c+";codecs="+f;r.appendChangeType(e,g),r.log("switching codec "+p+" to "+f),r.tracks[e]={buffer:a.buffer,codec:l,container:c,levelCodec:u,metadata:d,id:s}}}}else r.pendingTracks[e]=t[e]})),!n){var i=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==i&&(this.log(i+" bufferCodec event(s) expected "+a.join(",")),this.bufferCodecEventsExpected=i),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks()}},t.appendChangeType=function(e,t){var r=this,n=this.operationQueue,a={execute:function(){var a=r.sourceBuffer[e];a&&(r.log("changing "+e+" sourceBuffer type to "+t),a.changeType(t)),n.shiftAndExecuteNext(e)},onStart:function(){},onComplete:function(){},onError:function(t){r.warn("Failed to change "+e+" SourceBuffer type",t)}};n.append(a,e,!!this.pendingTracks[e])},t.onBufferAppending=function(e,t){var r=this,n=this.hls,a=this.operationQueue,i=this.tracks,o=t.data,s=t.type,l=t.frag,u=t.part,c=t.chunkMeta,d=c.buffering[s],p=self.performance.now();d.start=p;var h=l.stats.buffering,f=u?u.stats.buffering:null;0===h.start&&(h.start=p),f&&0===f.start&&(f.start=p);var m=i.audio,g=!1;"audio"===s&&"audio/mpeg"===(null==m?void 0:m.container)&&(g=!this.lastMpegAudioChunk||1===c.id||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);var y=l.start,v={execute:function(){if(d.executeStart=self.performance.now(),g){var e=r.sourceBuffer[s];if(e){var t=y-e.timestampOffset;Math.abs(t)>=.1&&(r.log("Updating audio SourceBuffer timestampOffset to "+y+" (delta: "+t+") sn: "+l.sn+")"),e.timestampOffset=y)}}r.appendExecutor(o,s)},onStart:function(){},onComplete:function(){var e=self.performance.now();d.executeEnd=d.end=e,0===h.first&&(h.first=e),f&&0===f.first&&(f.first=e);var t=r.sourceBuffer,n={};for(var a in t)n[a]=Dr.getBuffered(t[a]);r.appendErrors[s]=0,"audio"===s||"video"===s?r.appendErrors.audiovideo=0:(r.appendErrors.audio=0,r.appendErrors.video=0),r.hls.trigger(_.BUFFER_APPENDED,{type:s,frag:l,part:u,chunkMeta:c,parent:l.type,timeRanges:n})},onError:function(e){var t={type:k.MEDIA_ERROR,parent:l.type,details:E.BUFFER_APPEND_ERROR,sourceBufferName:s,frag:l,part:u,chunkMeta:c,error:e,err:e,fatal:!1};if(e.code===DOMException.QUOTA_EXCEEDED_ERR)t.details=E.BUFFER_FULL_ERROR;else{var a=++r.appendErrors[s];t.details=E.BUFFER_APPEND_ERROR,r.warn("Failed "+a+"/"+n.config.appendErrorMaxRetry+' times to append segment in "'+s+'" sourceBuffer'),a>=n.config.appendErrorMaxRetry&&(t.fatal=!0)}n.trigger(_.ERROR,t)}};a.append(v,s,!!this.pendingTracks[s])},t.onBufferFlushing=function(e,t){var r=this,n=this.operationQueue,a=function(e){return{execute:r.removeExecutor.bind(r,e,t.startOffset,t.endOffset),onStart:function(){},onComplete:function(){r.hls.trigger(_.BUFFER_FLUSHED,{type:e})},onError:function(t){r.warn("Failed to remove from "+e+" SourceBuffer",t)}}};t.type?n.append(a(t.type),t.type):this.getSourceBufferTypes().forEach((function(e){n.append(a(e),e)}))},t.onFragParsed=function(e,t){var r=this,n=t.frag,a=t.part,i=[],o=a?a.elementaryStreams:n.elementaryStreams;o[L]?i.push("audiovideo"):(o[D]&&i.push("audio"),o[O]&&i.push("video")),0===i.length&&this.warn("Fragments must have at least one ElementaryStreamType set. type: "+n.type+" level: "+n.level+" sn: "+n.sn),this.blockBuffers((function(){var e=self.performance.now();n.stats.buffering.end=e,a&&(a.stats.buffering.end=e);var t=a?a.stats:n.stats;r.hls.trigger(_.FRAG_BUFFERED,{frag:n,part:a,stats:t,id:n.type})}),i)},t.onFragChanged=function(e,t){this.trimBuffers()},t.onBufferEos=function(e,t){var r=this;this.getSourceBufferTypes().reduce((function(e,n){var a=r.sourceBuffer[n];return!a||t.type&&t.type!==n||(a.ending=!0,a.ended||(a.ended=!0,r.log(n+" sourceBuffer now EOS"))),e&&!(a&&!a.ended)}),!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers((function(){r.getSourceBufferTypes().forEach((function(e){var t=r.sourceBuffer[e];t&&(t.ending=!1)}));var e=r.mediaSource;e&&"open"===e.readyState?(r.log("Calling mediaSource.endOfStream()"),e.endOfStream()):e&&r.log("Could not call mediaSource.endOfStream(). mediaSource.readyState: "+e.readyState)})))},t.onLevelUpdated=function(e,t){var r=t.details;r.fragments.length&&(this.details=r,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},t.trimBuffers=function(){var e=this.hls,t=this.details,r=this.media;if(r&&null!==t&&this.getSourceBufferTypes().length){var n=e.config,a=r.currentTime,i=t.levelTargetDuration,o=t.live&&null!==n.liveBackBufferLength?n.liveBackBufferLength:n.backBufferLength;if(g(o)&&o>0){var s=Math.max(o,i),l=Math.floor(a/i)*i-s;this.flushBackBuffer(a,i,l)}if(g(n.frontBufferFlushThreshold)&&n.frontBufferFlushThreshold>0){var u=Math.max(n.maxBufferLength,n.frontBufferFlushThreshold),c=Math.max(u,i),d=Math.floor(a/i)*i+c;this.flushFrontBuffer(a,i,d)}}},t.flushBackBuffer=function(e,t,r){var n=this,a=this.details,i=this.sourceBuffer;this.getSourceBufferTypes().forEach((function(o){var s=i[o];if(s){var l=Dr.getBuffered(s);if(l.length>0&&r>l.start(0)){if(n.hls.trigger(_.BACK_BUFFER_REACHED,{bufferEnd:r}),null!=a&&a.live)n.hls.trigger(_.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(s.ended&&l.end(l.length-1)-e<2*t)return void n.log("Cannot flush "+o+" back buffer while SourceBuffer is in ended state");n.hls.trigger(_.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:o})}}}))},t.flushFrontBuffer=function(e,t,r){var n=this,a=this.sourceBuffer;this.getSourceBufferTypes().forEach((function(i){var o=a[i];if(o){var s=Dr.getBuffered(o),l=s.length;if(l<2)return;var u=s.start(l-1),c=s.end(l-1);if(r>u||e>=u&&e<=c)return;if(o.ended&&e-c<2*t)return void n.log("Cannot flush "+i+" front buffer while SourceBuffer is in ended state");n.hls.trigger(_.BUFFER_FLUSHING,{startOffset:u,endOffset:1/0,type:i})}}))},t.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var e=this.details,t=this.hls,r=this.media,n=this.mediaSource,a=e.fragments[0].start+e.totalduration,i=r.duration,o=g(n.duration)?n.duration:0;e.live&&t.config.liveDurationInfinity?(n.duration=1/0,this.updateSeekableRange(e)):(a>o&&a>i||!g(i))&&(this.log("Updating Media Source duration to "+a.toFixed(3)),n.duration=a)}},t.updateSeekableRange=function(e){var t=this.mediaSource,r=e.fragments;if(r.length&&e.live&&null!=t&&t.setLiveSeekableRange){var n=Math.max(0,r[0].start),a=Math.max(n,n+e.totalduration);this.log("Media Source duration is set to "+t.duration+". Setting seekable range to "+n+"-"+a+"."),t.setLiveSeekableRange(n,a)}},t.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.operationQueue,r=this.pendingTracks,n=Object.keys(r).length;if(n&&(!e||2===n||"audiovideo"in r)){this.createSourceBuffers(r),this.pendingTracks={};var a=this.getSourceBufferTypes();if(a.length)this.hls.trigger(_.BUFFER_CREATED,{tracks:this.tracks}),a.forEach((function(e){t.executeNext(e)}));else{var i=new Error("could not create source buffer for media codec(s)");this.hls.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:i,reason:i.message})}}},t.createSourceBuffers=function(e){var t=this,r=this.sourceBuffer,n=this.mediaSource;if(!n)throw Error("createSourceBuffers called when mediaSource was null");var a=function(a){if(!r[a]){var i,o=e[a];if(!o)throw Error("source buffer exists for track "+a+", however track does not");var s=-1===(null==(i=o.levelCodec)?void 0:i.indexOf(","))?o.levelCodec:o.codec;s&&"audio"===a.slice(0,5)&&(s=at(s,t.appendSource));var l=o.container+";codecs="+s;t.log("creating sourceBuffer("+l+")");try{var u=r[a]=n.addSourceBuffer(l),c=a;t.addBufferListener(c,"updatestart",t._onSBUpdateStart),t.addBufferListener(c,"updateend",t._onSBUpdateEnd),t.addBufferListener(c,"error",t._onSBUpdateError),t.appendSource&&t.addBufferListener(c,"bufferedchange",(function(e,r){var n=r.removedRanges;null!=n&&n.length&&t.hls.trigger(_.BUFFER_FLUSHED,{type:a})})),t.tracks[a]={buffer:u,codec:s,container:o.container,levelCodec:o.levelCodec,metadata:o.metadata,id:o.id}}catch(e){t.error("error while trying to add sourceBuffer: "+e.message),t.hls.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,sourceBufferName:a,mimeType:l})}}};for(var i in e)a(i)},t._onSBUpdateStart=function(e){this.operationQueue.current(e).onStart()},t._onSBUpdateEnd=function(e){var t;if("closed"!==(null==(t=this.mediaSource)?void 0:t.readyState)){var r=this.operationQueue;r.current(e).onComplete(),r.shiftAndExecuteNext(e)}else this.resetBuffer(e)},t._onSBUpdateError=function(e,t){var r,n=new Error(e+" SourceBuffer error. MediaSource readyState: "+(null==(r=this.mediaSource)?void 0:r.readyState));this.error(""+n,t),this.hls.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:n,fatal:!1});var a=this.operationQueue.current(e);a&&a.onError(n)},t.removeExecutor=function(e,t,r){var n=this.media,a=this.mediaSource,i=this.operationQueue,o=this.sourceBuffer[e];if(!n||!a||!o)return this.warn("Attempting to remove from the "+e+" SourceBuffer, but it does not exist"),void i.shiftAndExecuteNext(e);var s=g(n.duration)?n.duration:1/0,l=g(a.duration)?a.duration:1/0,u=Math.max(0,t),c=Math.min(r,s,l);c>u&&(!o.ending||o.ended)?(o.ended=!1,this.log("Removing ["+u+","+c+"] from the "+e+" SourceBuffer"),o.remove(u,c)):i.shiftAndExecuteNext(e)},t.appendExecutor=function(e,t){var r=this.sourceBuffer[t];if(r)r.ended=!1,r.appendBuffer(e);else if(!this.pendingTracks[t])throw new Error("Attempting to append to the "+t+" SourceBuffer, but it does not exist")},t.blockBuffers=function(e,t){var r=this;if(void 0===t&&(t=this.getSourceBufferTypes()),!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);var n=this.operationQueue,a=t.map((function(e){return n.appendBlocker(e)}));Promise.all(a).then((function(){e(),t.forEach((function(e){var t=r.sourceBuffer[e];null!=t&&t.updating||n.shiftAndExecuteNext(e)}))}))},t.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},t.addBufferListener=function(e,t,r){var n=this.sourceBuffer[e];if(n){var a=r.bind(this,e);this.listeners[e].push({event:t,listener:a}),n.addEventListener(t,a)}},t.removeBufferListeners=function(e){var t=this.sourceBuffer[e];t&&this.listeners[e].forEach((function(e){t.removeEventListener(e.event,e.listener)}))},o(e,[{key:"mediaSrc",get:function(){var e,t=(null==(e=this.media)?void 0:e.firstChild)||this.media;return null==t?void 0:t.src}}]),e}();function Ra(e){var t=e.querySelectorAll("source");[].slice.call(t).forEach((function(t){e.removeChild(t)}))}var Da={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Oa=function(e){var t=e;return Da.hasOwnProperty(e)&&(t=Da[e]),String.fromCharCode(t)},La=15,Na=100,Ua={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},ja={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Ba={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Fa={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Va=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],Ha=function(){function e(){this.time=null,this.verboseLevel=0}return e.prototype.log=function(e,t){if(this.verboseLevel>=e){var r="function"==typeof t?t():t;C.log(this.time+" ["+e+"] "+r)}},e}(),Ga=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},$a=function(){function e(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),Ka=function(){function e(){this.uchar=" ",this.penState=new $a}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),Wa=function(){function e(e){this.chars=[],this.pos=0,this.currPenState=new $a,this.cueStartTime=null,this.logger=void 0;for(var t=0;t<Na;t++)this.chars.push(new Ka);this.logger=e}var t=e.prototype;return t.equals=function(e){for(var t=0;t<Na;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0},t.copy=function(e){for(var t=0;t<Na;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<Na;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Na&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Na)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){var t=this;e>=144&&this.backSpace();var r=Oa(e);this.pos>=Na?this.logger.log(0,(function(){return"Cannot insert "+e.toString(16)+" ("+r+") at position "+t.pos+". Skipping it!"})):(this.chars[this.pos].setChar(r,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<Na;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,r=0;r<Na;r++){var n=this.chars[r].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),za=function(){function e(e){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(var t=0;t<La;t++)this.rows.push(new Wa(e));this.logger=e}var t=e.prototype;return t.reset=function(){for(var e=0;e<La;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,r=0;r<La;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<La;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<La;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){this.logger.log(2,(function(){return"pacData = "+JSON.stringify(e)}));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<La;r++)this.rows[r].clear();var n=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){var i=a.rows[n].cueStartTime,o=this.logger.time;if(null!==i&&null!==o&&i<o)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(a.rows[n+s])}}this.currRow=t;var l=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,c=Math.max(u-1,0);l.setCursor(e.indent),e.color=l.chars[c].penState.foreground}var d={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(d)},t.setBkgData=function(e){this.logger.log(2,(function(){return"bkgData = "+JSON.stringify(e)})),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){var e=this;if(null!==this.nrRollUpRows){this.logger.log(1,(function(){return e.getDisplayText()}));var t=this.currRow+1-this.nrRollUpRows,r=this.rows.splice(t,1)[0];r.clear(),this.rows.splice(this.currRow,0,r),this.logger.log(2,"Rolling up")}else this.logger.log(3,"roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],r="",n=-1,a=0;a<La;a++){var i=this.rows[a].getTextString();i&&(n=a+1,e?t.push("Row "+n+": '"+i+"'"):t.push(i.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},t.getTextAndFormat=function(){return this.rows},e}(),qa=function(){function e(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new za(r),this.nonDisplayedMemory=new za(r),this.lastOutputScreen=new za(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(function(){return"MODE="+e})),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=this,r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(function(){return n+": "+t.writeScreen.getDisplayText(!0)})),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(function(){return"DISPLAYED: "+t.displayedMemory.getDisplayText(!0)})),this.outputDataUpdate())},t.ccRCL=function(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){var e=this;if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(function(){return"DISP: "+e.displayedMemory.getDisplayText()}))}this.outputDataUpdate(!0)},t.ccTO=function(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),Ya=function(){function e(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;var n=this.logger=new Ha;this.channels=[null,new qa(e,t,n),new qa(e+1,r,n)]}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var r,n,a,i=!1;this.logger.time=e;for(var o=0;o<t.length;o+=2)if(n=127&t[o],a=127&t[o+1],0!==n||0!==a){if(this.logger.log(3,"["+Ga([t[o],t[o+1]])+"] -> ("+Ga([n,a])+")"),(r=this.parseCmd(n,a))||(r=this.parseMidrow(n,a)),r||(r=this.parsePAC(n,a)),r||(r=this.parseBackgroundAttributes(n,a)),!r&&(i=this.parseChars(n,a))){var s=this.currentChannel;s&&s>0?this.channels[s].insertChars(i):this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||i||this.logger.log(2,"Couldn't parse cleaned data "+Ga([n,a])+" orig: "+Ga([t[o],t[o+1]]))}},t.parseCmd=function(e,t){var r=this.cmdHistory;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(Za(e,t,r))return Xa(null,null,r),this.logger.log(3,"Repeated command ("+Ga([e,t])+") is dropped"),!0;var n=20===e||21===e||23===e?1:2,a=this.channels[n];return 20===e||21===e||28===e||29===e?32===t?a.ccRCL():33===t?a.ccBS():34===t?a.ccAOF():35===t?a.ccAON():36===t?a.ccDER():37===t?a.ccRU(2):38===t?a.ccRU(3):39===t?a.ccRU(4):40===t?a.ccFON():41===t?a.ccRDC():42===t?a.ccTR():43===t?a.ccRTD():44===t?a.ccEDM():45===t?a.ccCR():46===t?a.ccENM():47===t&&a.ccEOC():a.ccTO(t-32),Xa(e,t,r),this.currentChannel=n,!0},t.parseMidrow=function(e,t){var r=0;if((17===e||25===e)&&t>=32&&t<=47){if((r=17===e?1:2)!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;var n=this.channels[r];return!!n&&(n.ccMIDROW(t),this.logger.log(3,"MIDROW ("+Ga([e,t])+")"),!0)}return!1},t.parsePAC=function(e,t){var r,n=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(Za(e,t,n))return Xa(null,null,n),!0;var a=e<=23?1:2;r=t>=64&&t<=95?1===a?Ua[e]:Ba[e]:1===a?ja[e]:Fa[e];var i=this.channels[a];return!!i&&(i.setPAC(this.interpretPAC(r,t)),Xa(e,t,n),this.currentChannel=a,!0)},t.interpretPAC=function(e,t){var r,n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,n.underline=1==(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n},t.parseChars=function(e,t){var r,n,a=null,i=null;if(e>=25?(r=2,i=e-8):(r=1,i=e),i>=17&&i<=19?(n=17===i?t+80:18===i?t+112:t+144,this.logger.log(2,"Special char '"+Oa(n)+"' in channel "+r),a=[n]):e>=32&&e<=127&&(a=0===t?[e]:[e,t]),a){var o=Ga(a);this.logger.log(3,"Char codes =  "+o.join(",")),Xa(e,t,this.cmdHistory)}return a},t.parseBackgroundAttributes=function(e,t){var r;if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;var n={};16===e||24===e?(r=Math.floor((t-32)/2),n.background=Va[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0));var a=e<=23?1:2;return this.channels[a].setBkgData(n),Xa(e,t,this.cmdHistory),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e)}},e}();function Xa(e,t,r){r.a=e,r.b=t}function Za(e,t,r){return r.a===e&&r.b===t}var Qa=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},t.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},t.reset=function(){this.cueRanges=[],this.startTime=null},e}(),Ja=function(){if(null!=H&&H.VTTCue)return self.VTTCue;var e=["","lr","rl"],t=["start","middle","end","left","right"];function r(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;var r=t.toLowerCase();return!!~e.indexOf(r)&&r}function n(e){return r(t,e)}function a(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var a=1;a<arguments.length;a++){var i=arguments[a];for(var o in i)e[o]=i[o]}return e}function i(t,i,o){var s=this,l={enumerable:!0};s.hasBeenReset=!1;var u="",c=!1,d=t,p=i,h=o,f=null,m="",g=!0,y="auto",v="start",_=50,k="middle",E=50,b="middle";Object.defineProperty(s,"id",a({},l,{get:function(){return u},set:function(e){u=""+e}})),Object.defineProperty(s,"pauseOnExit",a({},l,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(s,"startTime",a({},l,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",a({},l,{get:function(){return p},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");p=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",a({},l,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",a({},l,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",a({},l,{get:function(){return m},set:function(t){var n=function(t){return r(e,t)}(t);if(!1===n)throw new SyntaxError("An invalid or illegal string was specified.");m=n,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",a({},l,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",a({},l,{get:function(){return y},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",a({},l,{get:function(){return v},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",a({},l,{get:function(){return _},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",a({},l,{get:function(){return k},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");k=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",a({},l,{get:function(){return E},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",a({},l,{get:function(){return b},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),s.displayState=void 0}return i.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},i}(),ei=function(){function e(){}return e.prototype.decode=function(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))},e}();function ti(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+parseFloat(n||0)}var r=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return r?parseFloat(r[2])>59?t(r[2],r[3],0,r[4]):t(r[1],r[2],r[3],r[4]):null}var ri=function(){function e(){this.values=Object.create(null)}var t=e.prototype;return t.set=function(e,t){this.get(e)||""===t||(this.values[e]=t)},t.get=function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},t.has=function(e){return e in this.values},t.alt=function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}},t.integer=function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},t.percent=function(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1},e}();function ni(e,t,r,n){var a=n?e.split(n):[e];for(var i in a)if("string"==typeof a[i]){var o=a[i].split(r);2===o.length&&t(o[0],o[1])}}var ai=new Ja(0,0,""),ii="middle"===ai.align?"middle":"center";function oi(e,t,r){var n=e;function a(){var t=ti(e);if(null===t)throw new Error("Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function i(){e=e.replace(/^\s+/,"")}if(i(),t.startTime=a(),i(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.slice(3),i(),t.endTime=a(),i(),function(e,t){var n=new ri;ni(e,(function(e,t){var a;switch(e){case"region":for(var i=r.length-1;i>=0;i--)if(r[i].id===t){n.set(e,r[i].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":a=t.split(","),n.integer(e,a[0]),n.percent(e,a[0])&&n.set("snapToLines",!1),n.alt(e,a[0],["auto"]),2===a.length&&n.alt("lineAlign",a[1],["start",ii,"end"]);break;case"position":a=t.split(","),n.percent(e,a[0]),2===a.length&&n.alt("positionAlign",a[1],["start",ii,"end","line-left","line-right","auto"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start",ii,"end","left","right"])}}),/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical","");var a=n.get("line","auto");"auto"===a&&-1===ai.line&&(a=-1),t.line=a,t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100),t.align=n.get("align",ii);var i=n.get("position","auto");"auto"===i&&50===ai.position&&(i="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=i}(e,t)}function si(e){return e.replace(/<br(?: \/)?>/gi,"\n")}var li=function(){function e(){this.state="INITIAL",this.buffer="",this.decoder=new ei,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var t=e.prototype;return t.parse=function(e){var t=this;function r(){var e=t.buffer,r=0;for(e=si(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var n=e.slice(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.slice(r),n}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var n="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(n=r()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(null==a||!a[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var i=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(i?i=!1:n=r(),t.state){case"HEADER":/:/.test(n)?ni(n,(function(e,t){}),/:/):n||(t.state="ID");continue;case"NOTE":n||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){t.state="NOTE";break}if(!n)continue;if(t.cue=new Ja(0,0,""),t.state="CUE",-1===n.indexOf("--\x3e")){t.cue.id=n;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{oi(n,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var o=-1!==n.indexOf("--\x3e");if(!n||o&&(i=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=n;continue;case"BADCUE":n||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},t.flush=function(){var e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this},e}(),ui=/\r\n|\n\r|\n|\r/g,ci=function(e,t,r){return void 0===r&&(r=0),e.slice(r,r+t.length)===t},di=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()};function pi(e,t,r){return di(e.toString())+di(t.toString())+di(r)}var hi="stpp.ttml.im1t",fi=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,mi=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,gi={left:"start",center:"center",right:"end",start:"start",end:"end"};function yi(e,t,r,n){var a=Pe(new Uint8Array(e),["mdat"]);if(0!==a.length){var i,o,l,u=a.map((function(e){return ge(e)})),c=(i=t.baseTime,1,void 0===(o=t.timescale)&&(o=1),void 0===l&&(l=!1),Zn(i,1,1/o,l));try{u.forEach((function(e){return r(function(e,t){var r=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");var n={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(n).reduce((function(e,t){return e[t]=r.getAttribute("ttp:"+t)||n[t],e}),{}),i="preserve"!==r.getAttribute("xml:space"),o=_i(vi(r,"styling","style")),l=_i(vi(r,"layout","region")),u=vi(r,"body","[begin]");return[].map.call(u,(function(e){var r=ki(e,i);if(!r||!e.hasAttribute("begin"))return null;var n=Ti(e.getAttribute("begin"),a),u=Ti(e.getAttribute("dur"),a),c=Ti(e.getAttribute("end"),a);if(null===n)throw bi(e);if(null===c){if(null===u)throw bi(e);c=n+u}var d=new Ja(n-t,c-t,r);d.id=pi(d.startTime,d.endTime,d.text);var p=function(e,t,r){var n="http://www.w3.org/ns/ttml#styling",a=null,i=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return i&&r.hasOwnProperty(i)&&(a=r[i]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((function(r,i){var o=Ei(t,n,i)||Ei(e,n,i)||Ei(a,n,i);return o&&(r[i]=o),r}),{})}(l[e.getAttribute("region")],o[e.getAttribute("style")],o),h=p.textAlign;if(h){var f=gi[h];f&&(d.lineAlign=f),d.align=h}return s(d,p),d})).filter((function(e){return null!==e}))}(e,c))}))}catch(e){n(e)}}else n(new Error("Could not parse IMSC1 mdat"))}function vi(e,t,r){var n=e.getElementsByTagName(t)[0];return n?[].slice.call(n.querySelectorAll(r)):[]}function _i(e){return e.reduce((function(e,t){var r=t.getAttribute("xml:id");return r&&(e[r]=t),e}),{})}function ki(e,t){return[].slice.call(e.childNodes).reduce((function(e,r,n){var a;return"br"===r.nodeName&&n?e+"\n":null!=(a=r.childNodes)&&a.length?ki(r,t):t?e+r.textContent.trim().replace(/\s+/g," "):e+r.textContent}),"")}function Ei(e,t,r){return e&&e.hasAttributeNS(t,r)?e.getAttributeNS(t,r):null}function bi(e){return new Error("Could not parse ttml timestamp "+e)}function Ti(e,t){if(!e)return null;var r=ti(e);return null===r&&(fi.test(e)?r=function(e,t){var r=fi.exec(e),n=(0|r[4])+(0|r[5])/t.subFrameRate;return 3600*(0|r[1])+60*(0|r[2])+(0|r[3])+n/t.frameRate}(e,t):mi.test(e)&&(r=function(e,t){var r=mi.exec(e),n=Number(r[1]);switch(r[2]){case"h":return 3600*n;case"m":return 60*n;case"ms":return 1e3*n;case"f":return n/t.frameRate;case"t":return n/t.tickRate}return n}(e,t))),r}var Ai=function(){function e(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(_.FRAG_LOADING,this.onFragLoading,this),e.on(_.FRAG_LOADED,this.onFragLoaded,this),e.on(_.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(_.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(_.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(_.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(_.BUFFER_FLUSHING,this.onBufferFlushing,this)}var t=e.prototype;return t.destroy=function(){var e=this.hls;e.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(_.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(_.FRAG_LOADING,this.onFragLoading,this),e.off(_.FRAG_LOADED,this.onFragLoaded,this),e.off(_.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(_.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(_.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(_.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(_.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0},t.initCea608Parsers=function(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){var e=new Qa(this,"textTrack1"),t=new Qa(this,"textTrack2"),r=new Qa(this,"textTrack3"),n=new Qa(this,"textTrack4");this.cea608Parser1=new Ya(1,e,t),this.cea608Parser2=new Ya(3,r,n)}},t.addCues=function(e,t,r,n,a){for(var i,o,s,l,u=!1,c=a.length;c--;){var d=a[c],p=(i=d[0],o=d[1],s=t,l=r,Math.min(o,l)-Math.max(i,s));if(p>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],r),u=!0,p/(r-t)>.5))return}if(u||a.push([t,r]),this.config.renderTextTracksNatively){var h=this.captionsTracks[e];this.Cues.newCue(h,t,r,n)}else{var f=this.Cues.newCue(null,t,r,n);this.hls.trigger(_.CUES_PARSED,{type:"captions",cues:f,track:e})}},t.onInitPtsFound=function(e,t){var r=this,n=t.frag,a=t.id,i=t.initPTS,o=t.timescale,s=this.unparsedVttFrags;"main"===a&&(this.initPTS[n.cc]={baseTime:i,timescale:o}),s.length&&(this.unparsedVttFrags=[],s.forEach((function(e){r.onFragLoaded(_.FRAG_LOADED,e)})))},t.getExistingTrack=function(e,t){var r=this.media;if(r)for(var n=0;n<r.textTracks.length;n++){var a=r.textTracks[n];if(Ci(a,{name:e,lang:t,attrs:{}}))return a}return null},t.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},t.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,r=this.captionsTracks,n=this.media,a=t[e],i=a.label,o=a.languageCode,s=this.getExistingTrack(i,o);if(s)r[e]=s,Mt(r[e]),wt(r[e],n);else{var l=this.createTextTrack("captions",i,o);l&&(l[e]=!0,r[e]=l)}}},t.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(_.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}},t.createTextTrack=function(e,t,r){var n=this.media;if(n)return n.addTextTrack(e,t,r)},t.onMediaAttaching=function(e,t){this.media=t.media,this._cleanTracks()},t.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){Mt(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}},t.onManifestLoading=function(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},t._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)Mt(t[r])}},t.onSubtitleTracksUpdated=function(e,t){var r=this,n=t.subtitleTracks||[],a=n.some((function(e){return e.textCodec===hi}));if(this.config.enableWebVTT||a&&this.config.enableIMSC1){if(Ea(this.tracks,n))return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){var i=this.media,o=i?Dt(i.textTracks):null;if(this.tracks.forEach((function(e,t){var n;if(o){for(var a=null,i=0;i<o.length;i++)if(o[i]&&Ci(o[i],e)){a=o[i],o[i]=null;break}a&&(n=a)}if(n)Mt(n);else{var s=Si(e);(n=r.createTextTrack(s,e.name,e.lang))&&(n.mode="disabled")}n&&r.textTracks.push(n)})),null!=o&&o.length){var s=o.filter((function(e){return null!==e})).map((function(e){return e.label}));s.length&&C.warn("Media element contains unused subtitle tracks: "+s.join(", ")+". Replace media element for each source to clear TextTracks and captions menu.")}}else if(this.tracks.length){var l=this.tracks.map((function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}}));this.hls.trigger(_.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}},t.onManifestLoaded=function(e,t){var r=this;this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((function(e){var t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(t){var n="textTrack"+t[1],a=r.captionsProperties[n];a&&(a.label=e.name,e.lang&&(a.languageCode=e.lang),a.media=e)}}))},t.closedCaptionsForLevel=function(e){var t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]},t.onFragLoading=function(e,t){this.initCea608Parsers();var r=this.cea608Parser1,n=this.cea608Parser2,a=this.lastCc,i=this.lastSn,o=this.lastPartIndex;if(this.enabled&&r&&n&&t.frag.type===Tt){var s,l,u=t.frag,c=u.cc,d=u.sn,p=null!=(s=null==t||null==(l=t.part)?void 0:l.index)?s:-1;d===i+1||d===i&&p===o+1||c===a||(r.reset(),n.reset()),this.lastCc=c,this.lastSn=d,this.lastPartIndex=p}},t.onFragLoaded=function(e,t){var r=t.frag,n=t.payload;if(r.type===St)if(n.byteLength){var a=r.decryptdata,i="stats"in t;if(null==a||!a.encrypted||i){var o=this.tracks[r.level],s=this.vttCCs;s[r.cc]||(s[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),o&&o.textCodec===hi?this._parseIMSC1(r,n):this._parseVTTs(t)}}else this.hls.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})},t._parseIMSC1=function(e,t){var r=this,n=this.hls;yi(t,this.initPTS[e.cc],(function(t){r._appendCues(t,e.level),n.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(t){C.log("Failed to parse IMSC1: "+t),n.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))},t._parseVTTs=function(e){var t,r=this,n=e.frag,a=e.payload,i=this.initPTS,o=this.unparsedVttFrags,s=i.length-1;if(i[n.cc]||-1!==s){var l=this.hls;!function(e,t,r,n,a,i,o){var s,l,u,c=new li,d=ge(new Uint8Array(e)).trim().replace(ui,"\n").split("\n"),p=[],h=t?(s=t.baseTime,void 0===(l=t.timescale)&&(l=1),Zn(s,9e4,1/l)):0,f="00:00.000",m=0,y=0,v=!0;c.oncue=function(e){var i=r[n],o=r.ccOffset,s=(m-h)/9e4;if(null!=i&&i.new&&(void 0!==y?o=r.ccOffset=i.start:function(e,t,r){var n=e[t],a=e[n.prevCC];if(!a||!a.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,void(n.new=!1);for(;null!=(i=a)&&i.new;){var i;e.ccOffset+=n.start-a.start,n.new=!1,a=e[(n=a).prevCC]}e.presentationOffset=r}(r,n,s)),s){if(!t)return void(u=new Error("Missing initPTS for VTT MPEGTS"));o=s-r.presentationOffset}var l=e.endTime-e.startTime,c=ra(9e4*(e.startTime+o-y),9e4*a)/9e4;e.startTime=Math.max(c,0),e.endTime=Math.max(c+l,0);var d=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(d)),e.id||(e.id=pi(e.startTime,e.endTime,d)),e.endTime>0&&p.push(e)},c.onparsingerror=function(e){u=e},c.onflush=function(){u?o(u):i(p)},d.forEach((function(e){if(v){if(ci(e,"X-TIMESTAMP-MAP=")){v=!1,e.slice(16).split(",").forEach((function(e){ci(e,"LOCAL:")?f=e.slice(6):ci(e,"MPEGTS:")&&(m=parseInt(e.slice(7)))}));try{y=function(e){var t=parseInt(e.slice(-3)),r=parseInt(e.slice(-6,-4)),n=parseInt(e.slice(-9,-7)),a=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(g(t)&&g(r)&&g(n)&&g(a)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*r,(t+=6e4*n)+36e5*a}(f)/1e3}catch(e){u=e}return}""===e&&(v=!1)}c.parse(e+"\n")})),c.flush()}(null!=(t=n.initSegment)&&t.data?Ne(n.initSegment.data,new Uint8Array(a)):a,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,(function(e){r._appendCues(e,n.level),l.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})}),(function(t){var i="Missing initPTS for VTT MPEGTS"===t.message;i?o.push(e):r._fallbackToIMSC1(n,a),C.log("Failed to parse VTT cue: "+t),i&&s>n.cc||l.trigger(_.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})}))}else o.push(e)},t._fallbackToIMSC1=function(e,t){var r=this,n=this.tracks[e.level];n.textCodec||yi(t,this.initPTS[e.cc],(function(){n.textCodec=hi,r._parseIMSC1(e,t)}),(function(){n.textCodec="wvtt"}))},t._appendCues=function(e,t){var r=this.hls;if(this.config.renderTextTracksNatively){var n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach((function(e){return It(n,e)}))}else{var a=this.tracks[t];if(!a)return;var i=a.default?"default":"subtitles"+t;r.trigger(_.CUES_PARSED,{type:"subtitles",cues:e,track:i})}},t.onFragDecrypted=function(e,t){t.frag.type===St&&this.onFragLoaded(_.FRAG_LOADED,t)},t.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},t.onFragParsingUserdata=function(e,t){this.initCea608Parsers();var r=this.cea608Parser1,n=this.cea608Parser2;if(this.enabled&&r&&n){var a=t.frag,i=t.samples;if(a.type!==Tt||"NONE"!==this.closedCaptionsForLevel(a))for(var o=0;o<i.length;o++){var s=i[o].bytes;if(s){var l=this.extractCea608Data(s);r.addData(i[o].pts,l[0]),n.addData(i[o].pts,l[1])}}}},t.onBufferFlushing=function(e,t){var r=t.startOffset,n=t.endOffset,a=t.endOffsetSubtitles,i=t.type,o=this.media;if(o&&!(o.currentTime<n)){if(!i||"video"===i){var s=this.captionsTracks;Object.keys(s).forEach((function(e){return Rt(s[e],r,n)}))}if(this.config.renderTextTracksNatively&&0===r&&void 0!==a){var l=this.textTracks;Object.keys(l).forEach((function(e){return Rt(l[e],r,a)}))}}},t.extractCea608Data=function(e){for(var t=[[],[]],r=31&e[0],n=2,a=0;a<r;a++){var i=e[n++],o=127&e[n++],s=127&e[n++];if((0!==o||0!==s)&&0!=(4&i)){var l=3&i;0!==l&&1!==l||(t[l].push(o),t[l].push(s))}}return t},e}();function Si(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function Ci(e,t){return!!e&&e.kind===Si(t)&&Ta(t,e)}var Pi=function(){function e(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var t=e.prototype;return t.setStreamController=function(e){this.streamController=e},t.destroy=function(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},t.registerListeners=function(){var e=this.hls;e.on(_.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(_.BUFFER_CODECS,this.onBufferCodecs,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this)},t.unregisterListener=function(){var e=this.hls;e.off(_.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(_.BUFFER_CODECS,this.onBufferCodecs,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this)},t.onFpsDropLevelCapping=function(e,t){var r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})},t.onMediaAttaching=function(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()},t.onManifestParsed=function(e,t){var r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()},t.onLevelsUpdated=function(e,t){this.timer&&g(this.autoLevelCapping)&&this.detectPlayerSize()},t.onBufferCodecs=function(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()},t.onMediaDetaching=function(){this.stopCapping()},t.detectPlayerSize=function(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);var e=this.hls.levels;if(e.length){var t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&C.log("Setting autoLevelCapping to "+r+": "+e[r].height+"p@"+e[r].bitrate+" for media "+this.mediaWidth+"x"+this.mediaHeight),t.autoLevelCapping=r,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},t.getMaxLevel=function(t){var r=this,n=this.hls.levels;if(!n.length)return-1;var a=n.filter((function(e,n){return r.isLevelAllowed(e)&&n<=t}));return this.clientRect=null,e.getMaxLevelByMediaSize(a,this.mediaWidth,this.mediaHeight)},t.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},t.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},t.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.width||t.height||(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t},t.isLevelAllowed=function(e){return!this.restrictedLevels.some((function(t){return e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height}))},e.getMaxLevelByMediaSize=function(e,t,r){if(null==e||!e.length)return-1;for(var n,a,i=e.length-1,o=Math.max(t,r),s=0;s<e.length;s+=1){var l=e[s];if((l.width>=o||l.height>=o)&&(n=l,!(a=e[s+1])||n.width!==a.width||n.height!==a.height)){i=s;break}}return i},o(e,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}}]),e}(),xi=function(){function e(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}var t=e.prototype;return t.setStreamController=function(e){this.streamController=e},t.registerListeners=function(){this.hls.on(_.MEDIA_ATTACHING,this.onMediaAttaching,this)},t.unregisterListeners=function(){this.hls.off(_.MEDIA_ATTACHING,this.onMediaAttaching,this)},t.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},t.onMediaAttaching=function(e,t){var r=this.hls.config;if(r.capLevelOnFPSDrop){var n=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=n,n&&"function"==typeof n.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}},t.checkFPS=function(e,t,r){var n=performance.now();if(t){if(this.lastTime){var a=n-this.lastTime,i=r-this.lastDroppedFrames,o=t-this.lastDecodedFrames,s=1e3*i/a,l=this.hls;if(l.trigger(_.FPS_DROP,{currentDropped:i,currentDecoded:o,totalDroppedFrames:r}),s>0&&i>l.config.fpsDroppedMonitoringThreshold*o){var u=l.currentLevel;C.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(u-=1,l.trigger(_.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},t.checkFPSInterval=function(){var e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},e}(),wi="[eme]",Ii=function(){function e(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=e.CDMCleanupPromise?[e.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=C.debug.bind(C,wi),this.log=C.log.bind(C,wi),this.warn=C.warn.bind(C,wi),this.error=C.error.bind(C,wi),this.hls=t,this.config=t.config,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.unregisterListeners(),this.onMediaDetached();var e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null},t.registerListeners=function(){this.hls.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(_.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(_.MANIFEST_LOADED,this.onManifestLoaded,this)},t.unregisterListeners=function(){this.hls.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(_.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(_.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(_.MANIFEST_LOADED,this.onManifestLoaded,this)},t.getLicenseServerUrl=function(e){var t=this.config,r=t.drmSystems,n=t.widevineLicenseUrl,a=r[e];if(a)return a.licenseUrl;if(e===G.WIDEVINE&&n)return n;throw new Error('no license server URL configured for key-system "'+e+'"')},t.getServerCertificateUrl=function(e){var t=this.config.drmSystems[e];if(t)return t.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+e+'"]')},t.attemptKeySystemAccess=function(e){var t=this,r=this.hls.levels,n=function(e,t,r){return!!e&&r.indexOf(e)===t},a=r.map((function(e){return e.audioCodec})).filter(n),i=r.map((function(e){return e.videoCodec})).filter(n);return a.length+i.length===0&&i.push("avc1.42e01e"),new Promise((function(r,n){!function e(o){var s=o.shift();t.getMediaKeysPromise(s,a,i).then((function(e){return r({keySystem:s,mediaKeys:e})})).catch((function(t){o.length?e(o):n(t instanceof Li?t:new Li({type:k.KEY_SYSTEM_ERROR,details:E.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))}(e)}))},t.requestMediaKeySystemAccess=function(e,t){var r=this.config.requestMediaKeySystemAccessFunc;if("function"!=typeof r){var n="Configured requestMediaKeySystemAccess is not a function "+r;return null===J&&"http:"===self.location.protocol&&(n="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(n))}return r(e,t)},t.getMediaKeysPromise=function(e,t,r){var n=this,a=function(e,t,r,n){var a;switch(e){case G.FAIRPLAY:a=["cenc","sinf"];break;case G.WIDEVINE:case G.PLAYREADY:a=["cenc"];break;case G.CLEARKEY:a=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+e)}return function(e,t,r,n){return[{initDataTypes:e,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:t.map((function(e){return{contentType:'audio/mp4; codecs="'+e+'"',robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null}})),videoCapabilities:r.map((function(e){return{contentType:'video/mp4; codecs="'+e+'"',robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}}))}]}(a,t,r,n)}(e,t,r,this.config.drmSystemOptions),i=this.keySystemAccessPromises[e],o=null==i?void 0:i.keySystemAccess;if(!o){this.log('Requesting encrypted media "'+e+'" key-system access with config: '+JSON.stringify(a)),o=this.requestMediaKeySystemAccess(e,a);var s=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch((function(t){n.log('Failed to obtain access to key-system "'+e+'": '+t)})),o.then((function(t){n.log('Access for key-system "'+t.keySystem+'" obtained');var r=n.fetchServerCertificate(e);return n.log('Create media-keys for "'+e+'"'),s.mediaKeys=t.createMediaKeys().then((function(t){return n.log('Media-keys created for "'+e+'"'),r.then((function(r){return r?n.setMediaKeysServerCertificate(t,e,r):t}))})),s.mediaKeys.catch((function(t){n.error('Failed to create media-keys for "'+e+'"}: '+t)})),s.mediaKeys}))}return o.then((function(){return i.mediaKeys}))},t.createMediaKeySessionContext=function(e){var t=e.decryptdata,r=e.keySystem,n=e.mediaKeys;this.log('Creating key-system session "'+r+'" keyId: '+ye(t.keyId||[]));var a=n.createSession(),i={decryptdata:t,keySystem:r,mediaKeys:n,mediaKeysSession:a,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i},t.renewKeySession=function(e){var t=e.decryptdata;if(t.pssh){var r=this.createMediaKeySessionContext(e),n=this.getKeyIdString(t);this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(r,"cenc",t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)},t.getKeyIdString=function(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return ye(e.keyId)},t.updateKeySession=function(e,t){var r,n=e.mediaKeysSession;return this.log('Updating key-session "'+n.sessionId+'" for keyID '+ye((null==(r=e.decryptdata)?void 0:r.keyId)||[])+"\n      } (data length: "+(t?t.byteLength:t)+")"),n.update(t)},t.selectKeySystemFormat=function(e){var t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+e.sn+" "+e.type+": "+e.level+") key formats "+t.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise},t.getKeyFormatPromise=function(e){var t=this;return new Promise((function(r,n){var a=Z(t.config),i=e.map(q).filter((function(e){return!!e&&-1!==a.indexOf(e)}));return t.getKeySystemSelectionPromise(i).then((function(e){var t=e.keySystem,a=X(t);a?r(a):n(new Error('Unable to find format for key-system "'+t+'"'))})).catch(n)}))},t.loadKey=function(e){var t=this,r=e.keyInfo.decryptdata,n=this.getKeyIdString(r),a="(keyId: "+n+' format: "'+r.keyFormat+'" method: '+r.method+" uri: "+r.uri+")";this.log("Starting session for key "+a);var i=this.keyIdToKeySessionPromise[n];return i||(i=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(r).then((function(n){var i=n.keySystem,o=n.mediaKeys;return t.throwIfDestroyed(),t.log("Handle encrypted media sn: "+e.frag.sn+" "+e.frag.type+": "+e.frag.level+" using key "+a),t.attemptSetMediaKeys(i,o).then((function(){t.throwIfDestroyed();var e=t.createMediaKeySessionContext({keySystem:i,mediaKeys:o,decryptdata:r});return t.generateRequestWithPreferredKeySession(e,"cenc",r.pssh,"playlist-key")}))}))).catch((function(e){return t.handleError(e)})),i},t.throwIfDestroyed=function(e){if(!this.hls)throw new Error("invalid state")},t.handleError=function(e){this.hls&&(this.error(e.message),e instanceof Li?this.hls.trigger(_.ERROR,e.data):this.hls.trigger(_.ERROR,{type:k.KEY_SYSTEM_ERROR,details:E.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))},t.getKeySystemForKeyPromise=function(e){var t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){var n=q(e.keyFormat),a=n?[n]:Z(this.config);return this.attemptKeySystemAccess(a)}return r},t.getKeySystemSelectionPromise=function(e){if(e.length||(e=Z(this.config)),0===e.length)throw new Li({type:k.KEY_SYSTEM_ERROR,details:E.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(e)},t._onMediaEncrypted=function(e){var t=this,r=e.initDataType,n=e.initData;if(this.debug('"'+e.type+'" event: init data type: "'+r+'"'),null!==n){var a,i;if("sinf"===r&&this.config.drmSystems[G.FAIRPLAY]){var o=Ee(new Uint8Array(n));try{var s=F(JSON.parse(o).sinf),l=Oe(new Uint8Array(s));if(!l)return;a=l.subarray(8,24),i=G.FAIRPLAY}catch(e){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{var u=function(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;var t={version:0,systemId:"",kids:null,data:null},r=new DataView(e),n=r.getUint32(0);if(e.byteLength!==n&&n>44)return null;if(1886614376!==r.getUint32(4))return null;if(t.version=r.getUint32(8)>>>24,t.version>1)return null;t.systemId=ye(new Uint8Array(e,12,16));var a=r.getUint32(28);if(0===t.version){if(n-32<a)return null;t.data=new Uint8Array(e,32,a)}else if(1===t.version){t.kids=[];for(var i=0;i<a;i++)t.kids.push(new Uint8Array(e,32+16*i,16))}return t}(n);if(null===u)return;0===u.version&&u.systemId===Y&&u.data&&(a=u.data.subarray(8,24)),i=function(e){if(e===Y)return G.WIDEVINE}(u.systemId)}if(i&&a){for(var c,d=ye(a),p=this.keyIdToKeySessionPromise,h=this.mediaKeySessions,f=p[d],m=function(){var e=h[g],i=e.decryptdata;if(i.pssh||!i.keyId)return 0;var o=ye(i.keyId);return d===o||-1!==i.uri.replace(/-/g,"").indexOf(d)?(f=p[o],delete p[o],i.pssh=new Uint8Array(n),i.keyId=a,f=p[d]=f.then((function(){return t.generateRequestWithPreferredKeySession(e,r,n,"encrypted-event-key-match")})),1):void 0},g=0;g<h.length&&(0===(c=m())||1!==c);g++);f||(f=p[d]=this.getKeySystemSelectionPromise([i]).then((function(e){var i,o=e.keySystem,s=e.mediaKeys;t.throwIfDestroyed();var l=new He("ISO-23001-7",d,null!=(i=X(o))?i:"");return l.pssh=new Uint8Array(n),l.keyId=a,t.attemptSetMediaKeys(o,s).then((function(){t.throwIfDestroyed();var e=t.createMediaKeySessionContext({decryptdata:l,keySystem:o,mediaKeys:s});return t.generateRequestWithPreferredKeySession(e,r,n,"encrypted-event-no-match")}))}))),f.catch((function(e){return t.handleError(e)}))}}},t._onWaitingForKey=function(e){this.log('"'+e.type+'" event')},t.attemptSetMediaKeys=function(e,t){var r=this,n=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+e+'"');var a=Promise.all(n).then((function(){if(!r.media)throw new Error("Attempted to set mediaKeys without media element attached");return r.media.setMediaKeys(t)}));return this.setMediaKeysQueue.push(a),a.then((function(){r.log('Media-keys set for "'+e+'"'),n.push(a),r.setMediaKeysQueue=r.setMediaKeysQueue.filter((function(e){return-1===n.indexOf(e)}))}))},t.generateRequestWithPreferredKeySession=function(e,t,r,n){var a,i,o=this,s=null==(a=this.config.drmSystems)||null==(i=a[e.keySystem])?void 0:i.generateRequest;if(s)try{var l=s.call(this.hls,t,r,e);if(!l)throw new Error("Invalid response from configured generateRequest filter");t=l.initDataType,r=e.decryptdata.pssh=l.initData?new Uint8Array(l.initData):null}catch(e){var u;if(this.warn(e.message),null!=(u=this.hls)&&u.config.debug)throw e}if(null===r)return this.log('Skipping key-session request for "'+n+'" (no initData)'),Promise.resolve(e);var c=this.getKeyIdString(e.decryptdata);this.log('Generating key-session request for "'+n+'": '+c+" (init data type: "+t+" length: "+(r?r.byteLength:null)+")");var d=new ga,p=e._onmessage=function(t){var r=e.mediaKeysSession;if(r){var n=t.messageType,a=t.message;o.log('"'+n+'" message event for session "'+r.sessionId+'" message size: '+a.byteLength),"license-request"===n||"license-renewal"===n?o.renewLicense(e,a).catch((function(e){o.handleError(e),d.emit("error",e)})):"license-release"===n?e.keySystem===G.FAIRPLAY&&(o.updateKeySession(e,V("acknowledged")),o.removeSession(e)):o.warn('unhandled media key message type "'+n+'"')}else d.emit("error",new Error("invalid state"))},h=e._onkeystatuseschange=function(t){if(e.mediaKeysSession){o.onKeyStatusChange(e);var r=e.keyStatus;d.emit("keyStatus",r),"expired"===r&&(o.warn(e.keySystem+" expired for key "+c),o.renewKeySession(e))}else d.emit("error",new Error("invalid state"))};e.mediaKeysSession.addEventListener("message",p),e.mediaKeysSession.addEventListener("keystatuseschange",h);var f=new Promise((function(e,t){d.on("error",t),d.on("keyStatus",(function(r){r.startsWith("usable")?e():"output-restricted"===r?t(new Li({type:k.KEY_SYSTEM_ERROR,details:E.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===r?t(new Li({type:k.KEY_SYSTEM_ERROR,details:E.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},'key status changed to "'+r+'"')):"expired"===r?t(new Error("key expired while generating request")):o.warn('unhandled key status change "'+r+'"')}))}));return e.mediaKeysSession.generateRequest(t,r).then((function(){var t;o.log('Request generated for key-session "'+(null==(t=e.mediaKeysSession)?void 0:t.sessionId)+'" keyId: '+c)})).catch((function(e){throw new Li({type:k.KEY_SYSTEM_ERROR,details:E.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},"Error generating key-session request: "+e)})).then((function(){return f})).catch((function(t){throw d.removeAllListeners(),o.removeSession(e),t})).then((function(){return d.removeAllListeners(),e}))},t.onKeyStatusChange=function(e){var t=this;e.mediaKeysSession.keyStatuses.forEach((function(r,n){t.log('key status change "'+r+'" for keyStatuses keyId: '+ye("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))+" session keyId: "+ye(new Uint8Array(e.decryptdata.keyId||[]))+" uri: "+e.decryptdata.uri),e.keyStatus=r}))},t.fetchServerCertificate=function(e){var t=this.config,r=new(0,t.loader)(t),a=this.getServerCertificateUrl(e);return a?(this.log('Fetching server certificate for "'+e+'"'),new Promise((function(i,o){var s={responseType:"arraybuffer",url:a},l=t.certLoadPolicy.default,u={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:function(e,t,r,n){i(e.data)},onError:function(t,r,i,l){o(new Li({type:k.KEY_SYSTEM_ERROR,details:E.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:n({url:s.url,data:void 0},t)},'"'+e+'" certificate request failed ('+a+"). Status: "+t.code+" ("+t.text+")"))},onTimeout:function(t,r,n){o(new Li({type:k.KEY_SYSTEM_ERROR,details:E.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:n,response:{url:s.url,data:void 0}},'"'+e+'" certificate request timed out ('+a+")"))},onAbort:function(e,t,r){o(new Error("aborted"))}};r.load(s,u,c)}))):Promise.resolve()},t.setMediaKeysServerCertificate=function(e,t,r){var n=this;return new Promise((function(a,i){e.setServerCertificate(r).then((function(i){n.log("setServerCertificate "+(i?"success":"not supported by CDM")+" ("+(null==r?void 0:r.byteLength)+') on "'+t+'"'),a(e)})).catch((function(e){i(new Li({type:k.KEY_SYSTEM_ERROR,details:E.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))},t.renewLicense=function(e,t){var r=this;return this.requestLicense(e,new Uint8Array(t)).then((function(t){return r.updateKeySession(e,new Uint8Array(t)).catch((function(e){throw new Li({type:k.KEY_SYSTEM_ERROR,details:E.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))}))},t.unpackPlayReadyKeyMessage=function(e,t){var r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;var n=(new DOMParser).parseFromString(r,"application/xml"),a=n.querySelectorAll("HttpHeader");if(a.length>0)for(var i,o=0,s=a.length;o<s;o++){var l,u,c=null==(l=(i=a[o]).querySelector("name"))?void 0:l.textContent,d=null==(u=i.querySelector("value"))?void 0:u.textContent;c&&d&&e.setRequestHeader(c,d)}var p=n.querySelector("Challenge"),h=null==p?void 0:p.textContent;if(!h)throw new Error("Cannot find <Challenge> in key message");return V(atob(h))},t.setupLicenseXHR=function(e,t,r,n){var a=this,i=this.config.licenseXhrSetup;return i?Promise.resolve().then((function(){if(!r.decryptdata)throw new Error("Key removed");return i.call(a.hls,e,t,r,n)})).catch((function(o){if(!r.decryptdata)throw o;return e.open("POST",t,!0),i.call(a.hls,e,t,r,n)})).then((function(r){return e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:r||n}})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:n}))},t.requestLicense=function(e,t){var r=this,n=this.config.keyLoadPolicy.default;return new Promise((function(a,i){var o=r.getLicenseServerUrl(e.keySystem);r.log("Sending license request to URL: "+o);var s=new XMLHttpRequest;s.responseType="arraybuffer",s.onreadystatechange=function(){if(!r.hls||!e.mediaKeysSession)return i(new Error("invalid state"));if(4===s.readyState)if(200===s.status){r._requestLicenseFailureCount=0;var l=s.response;r.log("License received "+(l instanceof ArrayBuffer?l.byteLength:l));var u=r.config.licenseResponseCallback;if(u)try{l=u.call(r.hls,s,o,e)}catch(e){r.error(e)}a(l)}else{var c=n.errorRetry,d=c?c.maxNumRetry:0;if(r._requestLicenseFailureCount++,r._requestLicenseFailureCount>d||s.status>=400&&s.status<500)i(new Li({type:k.KEY_SYSTEM_ERROR,details:E.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:s,response:{url:o,data:void 0,code:s.status,text:s.statusText}},"License Request XHR failed ("+o+"). Status: "+s.status+" ("+s.statusText+")"));else{var p=d-r._requestLicenseFailureCount+1;r.warn("Retrying license request, "+p+" attempts left"),r.requestLicense(e,t).then(a,i)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=s,r.setupLicenseXHR(s,o,e,t).then((function(t){var n=t.xhr,a=t.licenseChallenge;e.keySystem==G.PLAYREADY&&(a=r.unpackPlayReadyKeyMessage(n,a)),n.send(a)}))}))},t.onMediaAttached=function(e,t){if(this.config.emeEnabled){var r=t.media;this.media=r,r.addEventListener("encrypted",this.onMediaEncrypted),r.addEventListener("waitingforkey",this.onWaitingForKey)}},t.onMediaDetached=function(){var t=this,r=this.media,n=this.mediaKeySessions;r&&(r.removeEventListener("encrypted",this.onMediaEncrypted),r.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},He.clearKeyUriToKeyIdMap();var a=n.length;e.CDMCleanupPromise=Promise.all(n.map((function(e){return t.removeSession(e)})).concat(null==r?void 0:r.setMediaKeys(null).catch((function(e){t.log("Could not clear media keys: "+e)})))).then((function(){a&&(t.log("finished closing key sessions and clearing media keys"),n.length=0)})).catch((function(e){t.log("Could not close sessions and clear media keys: "+e)}))},t.onManifestLoading=function(){this.keyFormatPromise=null},t.onManifestLoaded=function(e,t){var r=t.sessionKeys;if(r&&this.config.emeEnabled&&!this.keyFormatPromise){var n=r.reduce((function(e,t){return-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e}),[]);this.log("Selecting key-system from session-keys "+n.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(n)}},t.removeSession=function(e){var t=this,r=e.mediaKeysSession,n=e.licenseXhr;if(r){this.log("Remove licenses and keys and close session "+r.sessionId),e._onmessage&&(r.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(r.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;var a=this.mediaKeySessions.indexOf(e);return a>-1&&this.mediaKeySessions.splice(a,1),r.remove().catch((function(e){t.log("Could not remove session: "+e)})).then((function(){return r.close()})).catch((function(e){t.log("Could not close session: "+e)}))}},e}();Ii.CDMCleanupPromise=void 0;var Mi,Ri,Di,Oi,Li=function(e){function t(t,r){var n;return(n=e.call(this,r)||this).data=void 0,t.error||(t.error=new Error(r)),n.data=t,t.err=t.error,n}return l(t,e),t}(p(Error));!function(e){e.MANIFEST="m",e.AUDIO="a",e.VIDEO="v",e.MUXED="av",e.INIT="i",e.CAPTION="c",e.TIMED_TEXT="tt",e.KEY="k",e.OTHER="o"}(Mi||(Mi={})),function(e){e.DASH="d",e.HLS="h",e.SMOOTH="s",e.OTHER="o"}(Ri||(Ri={})),function(e){e.OBJECT="CMCD-Object",e.REQUEST="CMCD-Request",e.SESSION="CMCD-Session",e.STATUS="CMCD-Status"}(Di||(Di={}));var Ni=((Oi={})[Di.OBJECT]=["br","d","ot","tb"],Oi[Di.REQUEST]=["bl","dl","mtp","nor","nrr","su"],Oi[Di.SESSION]=["cid","pr","sf","sid","st","v"],Oi[Di.STATUS]=["bs","rtp"],Oi),Ui=function e(t,r){this.value=void 0,this.params=void 0,Array.isArray(t)&&(t=t.map((function(t){return t instanceof e?t:new e(t)}))),this.value=t,this.params=r},ji=function(e){this.description=void 0,this.description=e},Bi="Dict";var Fi="Bare Item",Vi="Boolean",Hi="Byte Sequence",Gi="Decimal",$i="Integer",Ki=/[\x00-\x1f\x7f]+/,Wi="Token",zi="Key";function qi(e,t,r){return function(e,t,r,n){return new Error("failed to "+e+' "'+(a=t,(Array.isArray(a)?JSON.stringify(a):a instanceof Map?"Map{}":a instanceof Set?"Set{}":"object"==typeof a?JSON.stringify(a):String(a))+'" as ')+r,{cause:n});var a}("serialize",e,t,r)}function Yi(e){if(function(e){return e<-999999999999999||999999999999999<e}(e))throw qi(e,$i);return e.toString()}function Xi(e,t){if(e<0)return-Xi(-e,t);var r=Math.pow(10,t);if(Math.abs(e*r%1-.5)<Number.EPSILON){var n=Math.floor(e*r);return(n%2==0?n:n+1)/r}return Math.round(e*r)/r}function Zi(e){var t=Xi(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw qi(e,Gi);var r=t.toString();return r.includes(".")?r:r+".0"}var Qi="String";function Ji(e){var t,r=(t=e).description||t.toString().slice(7,-1);if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(r))throw qi(r,Wi);return r}function eo(e){switch(typeof e){case"number":if(!g(e))throw qi(e,Fi);return Number.isInteger(e)?Yi(e):Zi(e);case"string":return function(e){if(Ki.test(e))throw qi(e,Qi);return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}(e);case"symbol":return Ji(e);case"boolean":return function(e){if("boolean"!=typeof e)throw qi(e,Vi);return e?"?1":"?0"}(e);case"object":if(e instanceof Date)return function(e){return"@"+Yi(e.getTime()/1e3)}(e);if(e instanceof Uint8Array)return function(e){if(!1===ArrayBuffer.isView(e))throw qi(e,Hi);return":"+(t=e,btoa(String.fromCharCode.apply(String,t))+":");var t}(e);if(e instanceof ji)return Ji(e);default:throw qi(e,Fi)}}function to(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw qi(e,zi);return e}function ro(e){return null==e?"":Object.entries(e).map((function(e){var t=e[0],r=e[1];return!0===r?";"+to(t):";"+to(t)+"="+eo(r)})).join("")}function no(e){return e instanceof Ui?""+eo(e.value)+ro(e.params):eo(e)}var ao=function(e){return"ot"===e||"sf"===e||"st"===e},io=function(e){return"number"==typeof e?g(e):null!=e&&""!==e&&!1!==e},oo=function(e){return Math.round(e)},so=function(e){return 100*oo(e/100)},lo={br:oo,d:oo,bl:so,dl:so,mtp:so,nor:function(e,t){return null!=t&&t.baseUrl&&(e=function(e,t){var r=new URL(e),n=new URL(t);if(r.origin!==n.origin)return e;for(var a=r.pathname.split("/").slice(1),i=n.pathname.split("/").slice(1,-1);a[0]===i[0];)a.shift(),i.shift();for(;i.length;)i.shift(),a.unshift("..");return a.join("/")}(e,t.baseUrl)),encodeURIComponent(e)},rtp:so,tb:oo};function uo(e,t){return void 0===t&&(t={}),e?function(e,t){return function(e,t){var r;if(void 0===t&&(t={whitespace:!0}),"object"!=typeof e)throw qi(e,Bi);var n=e instanceof Map?e.entries():Object.entries(e),a=null!=(r=t)&&r.whitespace?" ":"";return Array.from(n).map((function(e){var t=e[0],r=e[1];r instanceof Ui==0&&(r=new Ui(r));var n,a=to(t);return!0===r.value?a+=ro(r.params):(a+="=",Array.isArray(r.value)?a+="("+(n=r).value.map(no).join(" ")+")"+ro(n.params):a+=no(r)),a})).join(","+a)}(e,t)}(function(e,t){var r={};if(null==e||"object"!=typeof e)return r;var n=Object.keys(e).sort(),a=s({},lo,null==t?void 0:t.formatters),i=null==t?void 0:t.filter;return n.forEach((function(n){if(null==i||!i(n)){var o=e[n],s=a[n];s&&(o=s(o,t)),"v"===n&&1===o||"pr"==n&&1===o||io(o)&&(ao(n)&&"string"==typeof o&&(o=new ji(o)),r[n]=o)}})),r}(e,t),s({whitespace:!1},t)):""}var co=/CMCD=[^&#]+/;var po=function(){function e(e){var t=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){t.initialized&&(t.starved=!0),t.buffering=!0},this.onPlaying=function(){t.initialized||(t.initialized=!0),t.buffering=!1},this.applyPlaylistData=function(e){try{t.apply(e,{ot:Mi.MANIFEST,su:!t.initialized})}catch(e){C.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=function(e){try{var r=e.frag,n=t.hls.levels[r.level],a=t.getObjectType(r),i={d:1e3*r.duration,ot:a};a!==Mi.VIDEO&&a!==Mi.AUDIO&&a!=Mi.MUXED||(i.br=n.bitrate/1e3,i.tb=t.getTopBandwidth(a)/1e3,i.bl=t.getBufferLength(a)),t.apply(e,i)}catch(e){C.warn("Could not generate segment CMCD data.",e)}},this.hls=e;var r=this.config=e.config,n=r.cmcd;null!=n&&(r.pLoader=this.createPlaylistLoader(),r.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||function(){try{return crypto.randomUUID()}catch(n){try{var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(e){var r=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==e?t:3&t|8).toString(16)}))}}}(),this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.includeKeys=n.includeKeys,this.registerListeners())}var t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHED,this.onMediaDetached,this),e.on(_.BUFFER_CREATED,this.onBufferCreated,this)},t.unregisterListeners=function(){var e=this.hls;e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHED,this.onMediaDetached,this),e.off(_.BUFFER_CREATED,this.onBufferCreated,this)},t.destroy=function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null},t.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},t.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},t.onBufferCreated=function(e,t){var r,n;this.audioBuffer=null==(r=t.tracks.audio)?void 0:r.buffer,this.videoBuffer=null==(n=t.tracks.video)?void 0:n.buffer},t.createData=function(){var e;return{v:1,sf:Ri.HLS,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},t.apply=function(e,t){void 0===t&&(t={}),s(t,this.createData());var r=t.ot===Mi.INIT||t.ot===Mi.VIDEO||t.ot===Mi.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);var n=this.includeKeys;n&&(t=Object.keys(t).reduce((function(e,r){return n.includes(r)&&(e[r]=t[r]),e}),{})),this.useHeaders?(e.headers||(e.headers={}),function(e,t,r){s(e,function(e,t){var r;if(void 0===t&&(t={}),!e)return{};var n=Object.entries(e),a=Object.entries(Ni).concat(Object.entries((null==(r=t)?void 0:r.customHeaderMap)||{})),i=n.reduce((function(e,t){var r,n=t[0],i=t[1],o=(null==(r=a.find((function(e){return e[1].includes(n)})))?void 0:r[0])||Di.REQUEST;return null!=e[o]||(e[o]={}),e[o][n]=i,e}),{});return Object.entries(i).reduce((function(e,r){var n=r[0],a=r[1];return e[n]=uo(a,t),e}),{})}(t,r))}(e.headers,t)):e.url=function(e,t,r){var n=function(e,t){if(void 0===t&&(t={}),!e)return"";var r=uo(e,t);return"CMCD="+encodeURIComponent(r)}(t,r);if(!n)return e;if(co.test(e))return e.replace(co,n);var a=e.includes("?")?"&":"?";return""+e+a+n}(e.url,t)},t.getObjectType=function(e){var t=e.type;return"subtitle"===t?Mi.TIMED_TEXT:"initSegment"===e.sn?Mi.INIT:"audio"===t?Mi.AUDIO:"main"===t?this.hls.audioTracks.length?Mi.VIDEO:Mi.MUXED:void 0},t.getTopBandwidth=function(e){var t,r=0,n=this.hls;if(e===Mi.AUDIO)t=n.audioTracks;else{var a=n.maxAutoLevel,i=a>-1?a+1:n.levels.length;t=n.levels.slice(0,i)}for(var o,s=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t);!(o=s()).done;){var l=o.value;l.bitrate>r&&(r=l.bitrate)}return r>0?r:NaN},t.getBufferLength=function(e){var t=this.hls.media,r=e===Mi.AUDIO?this.audioBuffer:this.videoBuffer;return r&&t?1e3*Dr.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len:NaN},t.createPlaylistLoader=function(){var e=this.config.pLoader,t=this.applyPlaylistData,r=e||this.config.loader;return function(){function e(e){this.loader=void 0,this.loader=new r(e)}var n=e.prototype;return n.destroy=function(){this.loader.destroy()},n.abort=function(){this.loader.abort()},n.load=function(e,r,n){t(e),this.loader.load(e,r,n)},o(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),e}()},t.createFragmentLoader=function(){var e=this.config.fLoader,t=this.applyFragmentData,r=e||this.config.loader;return function(){function e(e){this.loader=void 0,this.loader=new r(e)}var n=e.prototype;return n.destroy=function(){this.loader.destroy()},n.abort=function(){this.loader.abort()},n.load=function(e,r,n){t(e),this.loader.load(e,r,n)},o(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),e}()},e}(),ho=function(){function e(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=C.log.bind(C,"[content-steering]:"),this.registerListeners()}var t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(_.ERROR,this.onError,this)},t.unregisterListeners=function(){var e=this.hls;e&&(e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(_.ERROR,this.onError,this))},t.startLoad=function(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){var e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}},t.stopLoad=function(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()},t.clearTimeout=function(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)},t.destroy=function(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null},t.removeLevel=function(e){var t=this.levels;t&&(this.levels=t.filter((function(t){return t!==e})))},t.onManifestLoading=function(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null},t.onManifestLoaded=function(e,t){var r=t.contentSteering;null!==r&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())},t.onManifestParsed=function(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks},t.onError=function(e,t){var r=t.errorAction;if(2===(null==r?void 0:r.action)&&1===r.flags){var n=this.levels,a=this.pathwayPriority,i=this.pathwayId;if(t.context){var o=t.context,s=o.groupId,l=o.pathwayId,u=o.type;s&&n?i=this.getPathwayForGroupId(s,u,i):l&&(i=l)}i in this.penalizedPathways||(this.penalizedPathways[i]=performance.now()),!a&&n&&(a=n.reduce((function(e,t){return-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e}),[])),a&&a.length>1&&(this.updatePathwayPriority(a),r.resolved=this.pathwayId!==i),r.resolved||C.warn("Could not resolve "+t.details+' ("'+t.error.message+'") with content-steering for Pathway: '+i+" levels: "+(n?n.length:n)+" priorities: "+JSON.stringify(a)+" penalized: "+JSON.stringify(this.penalizedPathways))}},t.filterParsedLevels=function(e){this.levels=e;var t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){var r=e[0].pathwayId;this.log("No levels found in Pathway "+this.pathwayId+'. Setting initial Pathway to "'+r+'"'),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length?(this.log("Found "+t.length+"/"+e.length+' levels in Pathway "'+this.pathwayId+'"'),t):e},t.getLevelsForPathway=function(e){return null===this.levels?[]:this.levels.filter((function(t){return e===t.pathwayId}))},t.updatePathwayPriority=function(e){var t;this.pathwayPriority=e;var r=this.penalizedPathways,n=performance.now();Object.keys(r).forEach((function(e){n-r[e]>3e5&&delete r[e]}));for(var a=0;a<e.length;a++){var i=e[a];if(!(i in r)){if(i===this.pathwayId)return;var o=this.hls.nextLoadLevel,s=this.hls.levels[o];if((t=this.getLevelsForPathway(i)).length>0){this.log('Setting Pathway to "'+i+'"'),this.pathwayId=i,tr(t),this.hls.trigger(_.LEVELS_UPDATED,{levels:t});var l=this.hls.levels[o];s&&l&&this.levels&&(l.attrs["STABLE-VARIANT-ID"]!==s.attrs["STABLE-VARIANT-ID"]&&l.bitrate!==s.bitrate&&this.log("Unstable Pathways change from bitrate "+s.bitrate+" to "+l.bitrate),this.hls.nextLoadLevel=o);break}}}},t.getPathwayForGroupId=function(e,t,r){for(var n=this.getLevelsForPathway(r).concat(this.levels||[]),a=0;a<n.length;a++)if(t===Et&&n[a].hasAudioGroup(e)||t===bt&&n[a].hasSubtitleGroup(e))return n[a].pathwayId;return r},t.clonePathways=function(e){var t=this,r=this.levels;if(r){var n={},a={};e.forEach((function(e){var i=e.ID,o=e["BASE-ID"],s=e["URI-REPLACEMENT"];if(!r.some((function(e){return e.pathwayId===i}))){var l=t.getLevelsForPathway(o).map((function(e){var t=new w(e.attrs);t["PATHWAY-ID"]=i;var r=t.AUDIO&&t.AUDIO+"_clone_"+i,o=t.SUBTITLES&&t.SUBTITLES+"_clone_"+i;r&&(n[t.AUDIO]=r,t.AUDIO=r),o&&(a[t.SUBTITLES]=o,t.SUBTITLES=o);var l=mo(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",s),u=new Wt({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:l,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(var c=1;c<e.audioGroups.length;c++)u.addGroupId("audio",e.audioGroups[c]+"_clone_"+i);if(e.subtitleGroups)for(var d=1;d<e.subtitleGroups.length;d++)u.addGroupId("text",e.subtitleGroups[d]+"_clone_"+i);return u}));r.push.apply(r,l),fo(t.audioTracks,n,s,i),fo(t.subtitleTracks,a,s,i)}}))}},t.loadSteeringManifest=function(e){var t,r=this,n=this.hls.config,a=n.loader;this.loader&&this.loader.destroy(),this.loader=new a(n);try{t=new self.URL(e)}catch(t){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: "+e)}if("data:"!==t.protocol){var i=0|(this.hls.bandwidthEstimate||n.abrEwmaDefaultEstimate);t.searchParams.set("_HLS_pathway",this.pathwayId),t.searchParams.set("_HLS_throughput",""+i)}var o={responseType:"json",url:t.href},s=n.steeringManifestLoadPolicy.default,l=s.errorRetry||s.timeoutRetry||{},u={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},c={onSuccess:function(e,n,a,i){r.log('Loaded steering manifest: "'+t+'"');var o=e.data;if(1===o.VERSION){r.updated=performance.now(),r.timeToLoad=o.TTL;var s=o["RELOAD-URI"],l=o["PATHWAY-CLONES"],u=o["PATHWAY-PRIORITY"];if(s)try{r.uri=new self.URL(s,t).href}catch(e){return r.enabled=!1,void r.log("Failed to parse Steering Manifest RELOAD-URI: "+s)}r.scheduleRefresh(r.uri||a.url),l&&r.clonePathways(l);var c={steeringManifest:o,url:t.toString()};r.hls.trigger(_.STEERING_MANIFEST_LOADED,c),u&&r.updatePathwayPriority(u)}else r.log("Steering VERSION "+o.VERSION+" not supported!")},onError:function(e,t,n,a){if(r.log("Error loading steering manifest: "+e.code+" "+e.text+" ("+t.url+")"),r.stopLoad(),410===e.code)return r.enabled=!1,void r.log("Steering manifest "+t.url+" no longer available");var i=1e3*r.timeToLoad;if(429!==e.code)r.scheduleRefresh(r.uri||t.url,i);else{var o=r.loader;if("function"==typeof(null==o?void 0:o.getResponseHeader)){var s=o.getResponseHeader("Retry-After");s&&(i=1e3*parseFloat(s))}r.log("Steering manifest "+t.url+" rate limited")}},onTimeout:function(e,t,n){r.log("Timeout loading steering manifest ("+t.url+")"),r.scheduleRefresh(r.uri||t.url)}};this.log("Requesting steering manifest: "+t),this.loader.load(o,u,c)},t.scheduleRefresh=function(e,t){var r=this;void 0===t&&(t=1e3*this.timeToLoad),this.clearTimeout(),this.reloadTimer=self.setTimeout((function(){var t,n=null==(t=r.hls)?void 0:t.media;!n||n.ended?r.scheduleRefresh(e,1e3*r.timeToLoad):r.loadSteeringManifest(e)}),t)},e}();function fo(e,t,r,n){e&&Object.keys(t).forEach((function(a){var i=e.filter((function(e){return e.groupId===a})).map((function(e){var i=s({},e);return i.details=void 0,i.attrs=new w(i.attrs),i.url=i.attrs.URI=mo(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",r),i.groupId=i.attrs["GROUP-ID"]=t[a],i.attrs["PATHWAY-ID"]=n,i}));e.push.apply(e,i)}))}function mo(e,t,r,n){var a,i=n.HOST,o=n.PARAMS,s=n[r];t&&(a=null==s?void 0:s[t])&&(e=a);var l=new self.URL(e);return i&&!a&&(l.host=i),o&&Object.keys(o).sort().forEach((function(e){e&&l.searchParams.set(e,o[e])})),l.href}var go=/^age:\s*[\d.]+\s*$/im,yo=function(){function e(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new R,this.retryDelay=0}var t=e.prototype;return t.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null,this.stats=null},t.abortInternal=function(){var e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))},t.abort=function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},t.load=function(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()},t.loadInternal=function(){var e=this,t=this.config,r=this.context;if(t&&r){var n=this.loader=new self.XMLHttpRequest,a=this.stats;a.loading.first=0,a.loaded=0,a.aborted=!1;var i=this.xhrSetup;i?Promise.resolve().then((function(){if(!e.stats.aborted)return i(n,r.url)})).catch((function(e){return n.open("GET",r.url,!0),i(n,r.url)})).then((function(){e.stats.aborted||e.openAndSendXhr(n,r,t)})).catch((function(t){e.callbacks.onError({code:n.status,text:t.message},r,n,a)})):this.openAndSendXhr(n,r,t)}},t.openAndSendXhr=function(e,t,r){e.readyState||e.open("GET",t.url,!0);var n=t.headers,a=r.loadPolicy,i=a.maxTimeToFirstByteMs,o=a.maxLoadTimeMs;if(n)for(var s in n)e.setRequestHeader(s,n[s]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=i&&g(i)?i:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()},t.readystatechange=function(){var e=this.context,t=this.loader,r=this.stats;if(e&&t){var n=t.readyState,a=this.config;if(!r.aborted&&n>=2&&(0===r.loading.first&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),4===n)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;var i=t.status,o="text"!==t.responseType;if(i>=200&&i<300&&(o&&t.response||null!==t.responseText)){r.loading.end=Math.max(self.performance.now(),r.loading.first);var s=o?t.response:t.responseText,l="arraybuffer"===t.responseType?s.byteLength:s.length;if(r.loaded=r.total=l,r.bwEstimate=8e3*r.total/(r.loading.end-r.loading.first),!this.callbacks)return;var u=this.callbacks.onProgress;if(u&&u(r,e,s,t),!this.callbacks)return;var c={url:t.responseURL,data:s,code:i};this.callbacks.onSuccess(c,r,e,t)}else{var d=a.loadPolicy.errorRetry;or(d,r.retry,!1,{url:e.url,data:void 0,code:i})?this.retry(d):(C.error(i+" while loading "+e.url),this.callbacks.onError({code:i,text:t.statusText},e,t,r))}}}},t.loadtimeout=function(){var e,t=null==(e=this.config)?void 0:e.loadPolicy.timeoutRetry;if(or(t,this.stats.retry,!0))this.retry(t);else{var r;C.warn("timeout while loading "+(null==(r=this.context)?void 0:r.url));var n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))}},t.retry=function(e){var t=this.context,r=this.stats;this.retryDelay=ar(e,r.retry),r.retry++,C.warn((status?"HTTP Status "+status:"Timeout")+" while loading "+(null==t?void 0:t.url)+", retrying "+r.retry+"/"+e.maxNumRetry+" in "+this.retryDelay+"ms"),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)},t.loadprogress=function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)},t.getCacheAge=function(){var e=null;if(this.loader&&go.test(this.loader.getAllResponseHeaders())){var t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e},t.getResponseHeader=function(e){return this.loader&&new RegExp("^"+e+":\\s*[\\d.]+\\s*$","im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null},e}(),vo=/(\d+)-(\d+)\/(\d+)/,_o=function(){function e(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||ko,this.controller=new self.AbortController,this.stats=new R}var t=e.prototype;return t.destroy=function(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null},t.abortInternal=function(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())},t.abort=function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},t.load=function(e,t,r){var n=this,a=this.stats;if(a.loading.start)throw new Error("Loader can only be used once.");a.loading.start=self.performance.now();var i=function(e,t){var r={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(s({},e.headers))};return e.rangeEnd&&r.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),r}(e,this.controller.signal),o=r.onProgress,l="arraybuffer"===e.responseType,u=l?"byteLength":"length",c=t.loadPolicy,d=c.maxTimeToFirstByteMs,p=c.maxLoadTimeMs;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,i),self.clearTimeout(this.requestTimeout),t.timeout=d&&g(d)?d:p,this.requestTimeout=self.setTimeout((function(){n.abortInternal(),r.onTimeout(a,e,n.response)}),t.timeout),self.fetch(this.request).then((function(i){n.response=n.loader=i;var s=Math.max(self.performance.now(),a.loading.start);if(self.clearTimeout(n.requestTimeout),t.timeout=p,n.requestTimeout=self.setTimeout((function(){n.abortInternal(),r.onTimeout(a,e,n.response)}),p-(s-a.loading.start)),!i.ok){var u=i.status,c=i.statusText;throw new bo(c||"fetch, bad network response",u,i)}return a.loading.first=s,a.total=function(e){var t=e.get("Content-Range");if(t){var r=function(e){var t=vo.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(g(r))return r}var n=e.get("Content-Length");if(n)return parseInt(n)}(i.headers)||a.total,o&&g(t.highWaterMark)?n.loadProgressively(i,a,e,t.highWaterMark,o):l?i.arrayBuffer():"json"===e.responseType?i.json():i.text()})).then((function(i){var s=n.response;if(!s)throw new Error("loader destroyed");self.clearTimeout(n.requestTimeout),a.loading.end=Math.max(self.performance.now(),a.loading.first);var l=i[u];l&&(a.loaded=a.total=l);var c={url:s.url,data:i,code:s.status};o&&!g(t.highWaterMark)&&o(a,e,i,s),r.onSuccess(c,a,e,s)})).catch((function(t){if(self.clearTimeout(n.requestTimeout),!a.aborted){var i=t&&t.code||0,o=t?t.message:null;r.onError({code:i,text:o},e,t?t.details:null,a)}}))},t.getCacheAge=function(){var e=null;if(this.response){var t=this.response.headers.get("age");e=t?parseFloat(t):null}return e},t.getResponseHeader=function(e){return this.response?this.response.headers.get(e):null},t.loadProgressively=function(e,t,r,n,a){void 0===n&&(n=0);var i=new ln,o=e.body.getReader();return function s(){return o.read().then((function(o){if(o.done)return i.dataLength&&a(t,r,i.flush(),e),Promise.resolve(new ArrayBuffer(0));var l=o.value,u=l.length;return t.loaded+=u,u<n||i.dataLength?(i.push(l),i.dataLength>=n&&a(t,r,i.flush(),e)):a(t,r,l,e),s()})).catch((function(){return Promise.reject()}))}()},e}();function ko(e,t){return new self.Request(e.url,t)}var Eo,bo=function(e){function t(t,r,n){var a;return(a=e.call(this,t)||this).code=void 0,a.details=void 0,a.code=r,a.details=n,a}return l(t,e),t}(p(Error)),To=/\s/,Ao=n(n({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:yo,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:Tr,bufferController:Ma,capLevelController:Pi,errorController:dr,fpsController:xi,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:J,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:{newCue:function(e,t,r,n){for(var a,i,o,s,l,u=[],c=self.VTTCue||self.TextTrackCue,d=0;d<n.rows.length;d++)if(o=!0,s=0,l="",!(a=n.rows[d]).isEmpty()){for(var p,h=0;h<a.chars.length;h++)To.test(a.chars[h].uchar)&&o?s++:(l+=a.chars[h].uchar,o=!1);a.cueStartTime=t,t===r&&(r+=1e-4),s>=16?s--:s++;var f=si(l.trim()),m=pi(t,r,f);null!=e&&null!=(p=e.cues)&&p.getCueById(m)||((i=new c(t,r,f)).id=m,i.line=d+1,i.align="left",i.position=10+Math.min(80,10*Math.floor(8*s/32)),u.push(i))}return e&&u.length&&(u.sort((function(e,t){return"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line})),u.forEach((function(t){return It(e,t)}))),u}},enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:Ca,subtitleTrackController:xa,timelineController:Ai,audioStreamController:Aa,audioTrackController:Sa,emeController:Ii,cmcdController:po,contentSteeringController:ho});function So(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(So):Object.keys(e).reduce((function(t,r){return t[r]=So(e[r]),t}),{}):e}var Co=function(e){function t(t,r){var n;return(n=e.call(this,t,"[level-controller]")||this)._levels=[],n._firstLevel=-1,n._maxAutoLevel=-1,n._startLevel=void 0,n.currentLevel=null,n.currentLevelIndex=-1,n.manualLevelIndex=-1,n.steering=void 0,n.onParsedComplete=void 0,n.steering=r,n._registerListeners(),n}l(t,e);var r=t.prototype;return r._registerListeners=function(){var e=this.hls;e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(_.FRAG_BUFFERED,this.onFragBuffered,this),e.on(_.ERROR,this.onError,this)},r._unregisterListeners=function(){var e=this.hls;e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(_.FRAG_BUFFERED,this.onFragBuffered,this),e.off(_.ERROR,this.onError,this)},r.destroy=function(){this._unregisterListeners(),this.steering=null,this.resetLevels(),e.prototype.destroy.call(this)},r.stopLoad=function(){this._levels.forEach((function(e){e.loadError=0,e.fragmentError=0})),e.prototype.stopLoad.call(this)},r.resetLevels=function(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1},r.onManifestLoading=function(e,t){this.resetLevels()},r.onManifestLoaded=function(e,t){var r=this.hls.config.preferManagedMediaSource,n=[],a={},i={},o=!1,s=!1,l=!1;t.levels.forEach((function(e){var t,u,c=e.attrs,d=e.audioCodec,p=e.videoCodec;-1!==(null==(t=d)?void 0:t.indexOf("mp4a.40.34"))&&(Eo||(Eo=/chrome|firefox/i.test(navigator.userAgent)),Eo&&(e.audioCodec=d=void 0)),d&&(e.audioCodec=d=at(d,r)),0===(null==(u=p)?void 0:u.indexOf("avc1"))&&(p=e.videoCodec=function(e){var t=e.split(".");if(t.length>2){var r=t.shift()+".";return(r+=parseInt(t.shift()).toString(16))+("000"+parseInt(t.shift()).toString(16)).slice(-4)}return e}(p));var h=e.width,f=e.height,m=e.unknownCodecs;if(o||(o=!(!h||!f)),s||(s=!!p),l||(l=!!d),!(null!=m&&m.length||d&&!Ze(d,"audio",r)||p&&!Ze(p,"video",r))){var g=c.CODECS,y=c["FRAME-RATE"],v=c["HDCP-LEVEL"],_=c["PATHWAY-ID"],k=c.RESOLUTION,E=c["VIDEO-RANGE"],b=(_||".")+"-"+e.bitrate+"-"+k+"-"+y+"-"+g+"-"+E+"-"+v;if(a[b])if(a[b].uri===e.url||e.attrs["PATHWAY-ID"])a[b].addGroupId("audio",c.AUDIO),a[b].addGroupId("text",c.SUBTITLES);else{var T=i[b]+=1;e.attrs["PATHWAY-ID"]=new Array(T+1).join(".");var A=new Wt(e);a[b]=A,n.push(A)}else{var S=new Wt(e);a[b]=S,i[b]=1,n.push(S)}}})),this.filterAndSortMediaOptions(n,t,o,s,l)},r.filterAndSortMediaOptions=function(e,t,r,n,a){var i=this,o=[],s=[],l=e;if((r||n)&&a&&(l=l.filter((function(e){var t,r=e.videoCodec,n=e.videoRange,a=e.width,i=e.height;return(!!r||!(!a||!i))&&!!(t=n)&&Gt.indexOf(t)>-1}))),0!==l.length){if(t.audioTracks){var u=this.hls.config.preferManagedMediaSource;Po(o=t.audioTracks.filter((function(e){return!e.audioCodec||Ze(e.audioCodec,"audio",u)})))}t.subtitles&&Po(s=t.subtitles);var c=l.slice(0);l.sort((function(e,t){if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return Gt.indexOf(e.videoRange)-Gt.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){var n=et(e.videoCodec),a=et(t.videoCodec);if(n!==a)return a-n}if(e.uri===t.uri&&e.codecSet!==t.codecSet){var i=tt(e.codecSet),o=tt(t.codecSet);if(i!==o)return o-i}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0}));var d=c[0];if(this.steering&&(l=this.steering.filterParsedLevels(l)).length!==c.length)for(var p=0;p<c.length;p++)if(c[p].pathwayId===l[0].pathwayId){d=c[p];break}this._levels=l;for(var h=0;h<l.length;h++)if(l[h]===d){var f;this._firstLevel=h;var m=d.bitrate,g=this.hls.bandwidthEstimate;if(this.log("manifest loaded, "+l.length+" level(s) found, first bitrate: "+m),void 0===(null==(f=this.hls.userConfig)?void 0:f.abrEwmaDefaultEstimate)){var y=Math.min(m,this.hls.config.abrEwmaDefaultEstimateMax);y>g&&g===Ao.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=y)}break}var v=a&&!n,b={levels:l,audioTracks:o,subtitleTracks:s,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:n,altAudio:!v&&o.some((function(e){return!!e.url}))};this.hls.trigger(_.MANIFEST_PARSED,b),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else Promise.resolve().then((function(){if(i.hls){t.levels.length&&i.warn("One or more CODECS in variant not supported: "+JSON.stringify(t.levels[0].attrs));var e=new Error("no level with compatible codecs found in manifest");i.hls.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}}))},r.onError=function(e,t){!t.fatal&&t.context&&t.context.type===kt&&t.context.level===this.level&&this.checkRetry(t)},r.onFragBuffered=function(e,t){var r=t.frag;if(void 0!==r&&r.type===Tt){var n=r.elementaryStreams;if(!Object.keys(n).some((function(e){return!!n[e]})))return;var a=this._levels[r.level];null!=a&&a.loadError&&(this.log("Resetting level error count of "+a.loadError+" on frag buffered"),a.loadError=0)}},r.onLevelLoaded=function(e,t){var r,n,a=t.level,i=t.details,o=this._levels[a];if(!o)return this.warn("Invalid level index "+a),void(null!=(n=t.deliveryDirectives)&&n.skip&&(i.deltaUpdateFailed=!0));a===this.currentLevelIndex?(0===o.fragmentError&&(o.loadError=0),this.playlistLoaded(a,t,o.details)):null!=(r=t.deliveryDirectives)&&r.skip&&(i.deltaUpdateFailed=!0)},r.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this);var r=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){var a=n.uri;if(t)try{a=t.addDirectives(a)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}var i=n.attrs["PATHWAY-ID"];this.log("Loading level index "+r+(void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:"")+" with"+(i?" Pathway "+i:"")+" "+a),this.clearTimer(),this.hls.trigger(_.LEVEL_LOADING,{url:a,level:r,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}},r.removeLevel=function(e){var t,r=this,n=this._levels.filter((function(t,n){return n!==e||(r.steering&&r.steering.removeLevel(t),t===r.currentLevel&&(r.currentLevel=null,r.currentLevelIndex=-1,t.details&&t.details.fragments.forEach((function(e){return e.level=-1}))),!1)}));tr(n),this._levels=n,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(_.LEVELS_UPDATED,{levels:n})},r.onLevelsUpdated=function(e,t){var r=t.levels;this._levels=r},r.checkMaxAutoUpdated=function(){var e=this.hls,t=e.autoLevelCapping,r=e.maxAutoLevel,n=e.maxHdcpLevel;this._maxAutoLevel!==r&&(this._maxAutoLevel=r,this.hls.trigger(_.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:r,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))},o(t,[{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;if(0!==t.length){if(e<0||e>=t.length){var r=new Error("invalid level idx"),n=e<0;if(this.hls.trigger(_.ERROR,{type:k.OTHER_ERROR,details:E.LEVEL_SWITCH_ERROR,level:e,fatal:n,error:r,reason:r.message}),n)return;e=Math.min(e,t.length-1)}var a=this.currentLevelIndex,i=this.currentLevel,o=i?i.attrs["PATHWAY-ID"]:void 0,s=t[e],l=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=s,a!==e||!s.details||!i||o!==l){this.log("Switching to level "+e+" ("+(s.height?s.height+"p ":"")+(s.videoRange?s.videoRange+" ":"")+(s.codecSet?s.codecSet+" ":"")+"@"+s.bitrate+")"+(l?" with Pathway "+l:"")+" from level "+a+(o?" with Pathway "+o:""));var u={level:e,attrs:s.attrs,details:s.details,bitrate:s.bitrate,averageBitrate:s.averageBitrate,maxBitrate:s.maxBitrate,realBitrate:s.realBitrate,width:s.width,height:s.height,codecSet:s.codecSet,audioCodec:s.audioCodec,videoCodec:s.videoCodec,audioGroups:s.audioGroups,subtitleGroups:s.subtitleGroups,loaded:s.loaded,loadError:s.loadError,fragmentError:s.fragmentError,name:s.name,id:s.id,uri:s.uri,url:s.url,urlId:0,audioGroupIds:s.audioGroupIds,textGroupIds:s.textGroupIds};this.hls.trigger(_.LEVEL_SWITCHING,u);var c=s.details;if(!c||c.live){var d=this.switchParams(s.uri,null==i?void 0:i.details,c);this.loadPlaylist(d)}}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}]),t}(pr);function Po(e){var t={};e.forEach((function(e){var r=e.groupId||"";e.id=t[r]=t[r]||0,t[r]++}))}var xo=function(){function e(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}var t=e.prototype;return t.abort=function(e){for(var t in this.keyUriToKeyInfo){var r=this.keyUriToKeyInfo[t].loader;if(r){var n;if(e&&e!==(null==(n=r.context)?void 0:n.frag.type))return;r.abort()}}},t.detach=function(){for(var e in this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}},t.destroy=function(){for(var e in this.detach(),this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}},t.createKeyLoadError=function(e,t,r,n,a){return void 0===t&&(t=E.KEY_LOAD_ERROR),new Gr({type:k.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:a,error:r,networkDetails:n})},t.loadClear=function(e,t){var r=this;if(this.emeController&&this.config.emeEnabled)for(var n=e.sn,a=e.cc,i=function(){var e=t[o];if(a<=e.cc&&("initSegment"===n||"initSegment"===e.sn||n<e.sn))return r.emeController.selectKeySystemFormat(e).then((function(t){e.setKeyFormat(t)})),1},o=0;o<t.length&&!i();o++);},t.load=function(e){var t=this;return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then((function(r){return t.loadInternal(e,r)})):this.loadInternal(e)},t.loadInternal=function(e,t){var r,n;t&&e.setKeyFormat(t);var a=e.decryptdata;if(!a){var i=new Error(t?"Expected frag.decryptdata to be defined after setting format "+t:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,E.KEY_LOAD_ERROR,i))}var o=a.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,E.KEY_LOAD_ERROR,new Error('Invalid key URI: "'+o+'"')));var s,l=this.keyUriToKeyInfo[o];if(null!=(r=l)&&r.decryptdata.key)return a.key=l.decryptdata.key,Promise.resolve({frag:e,keyInfo:l});if(null!=(n=l)&&n.keyLoadPromise)switch(null==(s=l.mediaKeySessionContext)?void 0:s.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return l.keyLoadPromise.then((function(t){return a.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:l}}))}switch(l=this.keyUriToKeyInfo[o]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===a.keyFormat?this.loadKeyHTTP(l,e):this.loadKeyEME(l,e);case"AES-128":return this.loadKeyHTTP(l,e);default:return Promise.reject(this.createKeyLoadError(e,E.KEY_LOAD_ERROR,new Error('Key supplied with unsupported METHOD: "'+a.method+'"')))}},t.loadKeyEME=function(e,t){var r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var n=this.emeController.loadKey(r);if(n)return(e.keyLoadPromise=n.then((function(t){return e.mediaKeySessionContext=t,r}))).catch((function(t){throw e.keyLoadPromise=null,t}))}return Promise.resolve(r)},t.loadKeyHTTP=function(e,t){var r=this,a=this.config,i=new(0,a.loader)(a);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((function(o,s){var l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=a.keyLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:function(e,t,n,a){var i=n.frag,l=n.keyInfo,u=n.url;if(!i.decryptdata||l!==r.keyUriToKeyInfo[u])return s(r.createKeyLoadError(i,E.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),a));l.decryptdata.key=i.decryptdata.key=new Uint8Array(e.data),i.keyLoader=null,l.loader=null,o({frag:i,keyInfo:l})},onError:function(e,a,i,o){r.resetLoader(a),s(r.createKeyLoadError(t,E.KEY_LOAD_ERROR,new Error("HTTP Error "+e.code+" loading key "+e.text),i,n({url:l.url,data:void 0},e)))},onTimeout:function(e,n,a){r.resetLoader(n),s(r.createKeyLoadError(t,E.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),a))},onAbort:function(e,n,a){r.resetLoader(n),s(r.createKeyLoadError(t,E.INTERNAL_ABORTED,new Error("key loading aborted"),a))}};i.load(l,c,d)}))},t.resetLoader=function(e){var t=e.frag,r=e.keyInfo,n=e.url,a=r.loader;t.keyLoader===a&&(t.keyLoader=null,r.loader=null),delete this.keyUriToKeyInfo[n],a&&a.destroy()},e}();function wo(){return self.SourceBuffer||self.WebKitSourceBuffer}function Io(){if(!Ye())return!1;var e=wo();return!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove}var Mo=function(){function e(e,t,r,n){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=r,this.hls=n}var t=e.prototype;return t.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},t.poll=function(e,t){var r=this.config,n=this.media,a=this.stalled;if(null!==n){var i=n.currentTime,o=n.seeking,s=this.seeking&&!o,l=!this.seeking&&o;if(this.seeking=o,i===e)if(l||s)this.stalled=null;else if(n.paused&&!o||n.ended||0===n.playbackRate||!Dr.getBuffered(n).length)this.nudgeRetry=0;else{var u=Dr.bufferInfo(n,i,0),c=u.nextStart||0;if(o){var d=u.len>2,p=!c||t&&t.start<=i||c-i>2&&!this.fragmentTracker.getPartialFragment(i);if(d||p)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var h;if(!(u.len>0||c))return;var f=Math.max(c,u.start||0)-i,m=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,g=(null==m||null==(h=m.details)?void 0:h.live)?2*m.details.targetduration:2,y=this.fragmentTracker.getPartialFragment(i);if(f>0&&(f<=g||y))return void(n.paused||this._trySkipBufferHole(y))}var v=self.performance.now();if(null!==a){var _=v-a;if(o||!(_>=250)||(this._reportStall(u),this.media)){var k=Dr.bufferInfo(n,i,r.maxBufferHole);this._tryFixBufferStall(k,_)}}else this.stalled=v}else if(this.moved=!0,o||(this.nudgeRetry=0),null!==a){if(this.stallReported){var E=self.performance.now()-a;C.warn("playback not stuck anymore @"+i+", after "+Math.round(E)+"ms"),this.stallReported=!1}this.stalled=null}}},t._tryFixBufferStall=function(e,t){var r=this.config,n=this.fragmentTracker,a=this.media;if(null!==a){var i=a.currentTime,o=n.getPartialFragment(i);if(o&&(this._trySkipBufferHole(o)||!this.media))return;(e.len>r.maxBufferHole||e.nextStart&&e.nextStart-i<r.maxBufferHole)&&t>1e3*r.highBufferWatchdogPeriod&&(C.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},t._reportStall=function(e){var t=this.hls,r=this.media;if(!this.stallReported&&r){this.stallReported=!0;var n=new Error("Playback stalling at @"+r.currentTime+" due to low buffer ("+JSON.stringify(e)+")");C.warn(n.message),t.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.BUFFER_STALLED_ERROR,fatal:!1,error:n,buffer:e.len})}},t._trySkipBufferHole=function(e){var t=this.config,r=this.hls,n=this.media;if(null===n)return 0;var a=n.currentTime,i=Dr.bufferInfo(n,a,0),o=a<i.start?i.start:i.nextStart;if(o){var s=i.len<=t.maxBufferHole,l=i.len>0&&i.len<1&&n.readyState<3,u=o-a;if(u>0&&(s||l)){if(u>t.maxBufferHole){var c=this.fragmentTracker,d=!1;if(0===a){var p=c.getAppendedFrag(0,Tt);p&&o<p.end&&(d=!0)}if(!d){var h=e||c.getAppendedFrag(a,Tt);if(h){for(var f=!1,m=h.end;m<o;){var g=c.getPartialFragment(m);if(!g){f=!0;break}m+=g.duration}if(f)return 0}}}var y=Math.max(o+.05,a+.1);if(C.warn("skipping hole, adjusting currentTime from "+a+" to "+y),this.moved=!0,this.stalled=null,n.currentTime=y,e&&!e.gap){var v=new Error("fragment loaded with buffer holes, seeking from "+a+" to "+y);r.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:v,reason:v.message,frag:e})}return y}}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,n=this.nudgeRetry;if(null!==r){var a=r.currentTime;if(this.nudgeRetry++,n<e.nudgeMaxRetry){var i=a+(n+1)*e.nudgeOffset,o=new Error("Nudging 'currentTime' from "+a+" to "+i);C.warn(o.message),r.currentTime=i,t.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{var s=new Error("Playhead still not moving while enough data buffered @"+a+" after "+e.nudgeMaxRetry+" nudges");C.error(s.message),t.trigger(_.ERROR,{type:k.MEDIA_ERROR,details:E.BUFFER_STALLED_ERROR,error:s,fatal:!0})}}},e}(),Ro=function(e){function t(t,r,n){var a;return(a=e.call(this,t,r,n,"[stream-controller]",Tt)||this).audioCodecSwap=!1,a.gapController=null,a.level=-1,a._forceStartLoad=!1,a.altAudio=!1,a.audioOnly=!1,a.fragPlaying=null,a.onvplaying=null,a.onvseeked=null,a.fragLastKbps=0,a.couldBacktrack=!1,a.backtrackFragment=null,a.audioCodecSwitch=!1,a.videoBuffer=null,a._registerListeners(),a}l(t,e);var r=t.prototype;return r._registerListeners=function(){var e=this.hls;e.on(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(_.MANIFEST_LOADING,this.onManifestLoading,this),e.on(_.MANIFEST_PARSED,this.onManifestParsed,this),e.on(_.LEVEL_LOADING,this.onLevelLoading,this),e.on(_.LEVEL_LOADED,this.onLevelLoaded,this),e.on(_.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(_.ERROR,this.onError,this),e.on(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(_.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(_.BUFFER_CREATED,this.onBufferCreated,this),e.on(_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(_.FRAG_BUFFERED,this.onFragBuffered,this)},r._unregisterListeners=function(){var e=this.hls;e.off(_.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(_.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(_.MANIFEST_LOADING,this.onManifestLoading,this),e.off(_.MANIFEST_PARSED,this.onManifestParsed,this),e.off(_.LEVEL_LOADED,this.onLevelLoaded,this),e.off(_.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(_.ERROR,this.onError,this),e.off(_.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(_.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(_.BUFFER_CREATED,this.onBufferCreated,this),e.off(_.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(_.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(_.FRAG_BUFFERED,this.onFragBuffered,this)},r.onHandlerDestroying=function(){this._unregisterListeners(),e.prototype.onHandlerDestroying.call(this)},r.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){var n=r.startLevel;-1===n&&(r.config.testBandwidth&&this.levels.length>1?(n=0,this.bitrateTest=!0):n=r.firstAutoLevel),r.nextLoadLevel=n,this.level=r.loadLevel,this.loadedmetadata=!1}t>0&&-1===e&&(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=Yr,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=qr},r.stopLoad=function(){this._forceStartLoad=!1,e.prototype.stopLoad.call(this)},r.doTick=function(){switch(this.state){case on:var e=this.levels,t=this.level,r=null==e?void 0:e[t],n=null==r?void 0:r.details;if(n&&(!n.live||this.levelLastLoaded===r)){if(this.waitForCdnTuneIn(n))break;this.state=Yr;break}if(this.hls.nextLoadLevel!==this.level){this.state=Yr;break}break;case Qr:var a,i=self.performance.now(),o=this.retryDate;if(!o||i>=o||null!=(a=this.media)&&a.seeking){var s=this.levels,l=this.level,u=null==s?void 0:s[l];this.resetStartWhenNotLoaded(u||null),this.state=Yr}}this.state===Yr&&this.doTickIdle(),this.onTickEnd()},r.onTickEnd=function(){e.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},r.doTickIdle=function(){var e=this.hls,t=this.levelLastLoaded,r=this.levels,n=this.media;if(null!==t&&(n||!this.startFragRequested&&e.config.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)){var a=e.nextLoadLevel;if(null!=r&&r[a]){var i=r[a],o=this.getMainFwdBufferInfo();if(null!==o){var s=this.getLevelDetails();if(s&&this._streamEnded(o,s)){var l={};return this.altAudio&&(l.type="video"),this.hls.trigger(_.BUFFER_EOS,l),void(this.state=rn)}e.loadLevel!==a&&-1===e.manualLevel&&this.log("Adapting to level "+a+" from level "+this.level),this.level=e.nextLoadLevel=a;var u=i.details;if(!u||this.state===on||u.live&&this.levelLastLoaded!==i)return this.level=a,void(this.state=on);var c=o.len,d=this.getMaxBufferLength(i.maxBitrate);if(!(c>=d)){this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);var p=this.backtrackFragment?this.backtrackFragment.start:o.end,h=this.getNextFragment(p,u);if(this.couldBacktrack&&!this.fragPrevious&&h&&"initSegment"!==h.sn&&this.fragmentTracker.getState(h)!==xr){var f,m=(null!=(f=this.backtrackFragment)?f:h).sn-u.startSN,g=u.fragments[m-1];g&&h.cc===g.cc&&(h=g,this.fragmentTracker.removeFragment(g))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(h&&this.isLoopLoading(h,p)){if(!h.gap){var y=this.audioOnly&&!this.altAudio?D:O,v=(y===O?this.videoBuffer:this.mediaBuffer)||this.media;v&&this.afterBufferFlushed(v,y,Tt)}h=this.getNextFragmentLoopLoading(h,u,o,Tt,d)}h&&(!h.initSegment||h.initSegment.data||this.bitrateTest||(h=h.initSegment),this.loadFragment(h,i,p))}}}}},r.loadFragment=function(t,r,n){var a=this.fragmentTracker.getState(t);this.fragCurrent=t,a===Sr||a===Pr?"initSegment"===t.sn?this._loadInitSegment(t,r):this.bitrateTest?(this.log("Fragment "+t.sn+" of level "+t.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(t,r)):(this.startFragRequested=!0,e.prototype.loadFragment.call(this,t,r,n)):this.clearTrackerIfNeeded(t)},r.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,Tt)},r.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.end+.5):null},r.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},r.nextLevelSwitch=function(){var e=this.levels,t=this.media;if(null!=t&&t.readyState){var r,n=this.getAppendedFrag(t.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);var a=this.getLevelDetails();if(null!=a&&a.live){var i=this.getMainFwdBufferInfo();if(!i||i.len<2*a.targetduration)return}if(!t.paused&&e){var o=e[this.hls.nextLoadLevel],s=this.fragLastKbps;r=s&&this.fragCurrent?this.fragCurrent.duration*o.maxBitrate/(1e3*s)+1:0}else r=0;var l=this.getBufferedFrag(t.currentTime+r);if(l){var u=this.followingBufferedFrag(l);if(u){this.abortCurrentFrag();var c=u.maxStartPTS?u.maxStartPTS:u.start,d=u.duration,p=Math.max(l.end,c+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(p,Number.POSITIVE_INFINITY)}}}},r.abortCurrentFrag=function(){var e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Xr:case Zr:case Qr:case en:case tn:this.state=Yr}this.nextLoadPosition=this.getLoadPosition()},r.flushMainBuffer=function(t,r){e.prototype.flushMainBuffer.call(this,t,r,this.altAudio?"video":null)},r.onMediaAttached=function(t,r){e.prototype.onMediaAttached.call(this,t,r);var n=r.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new Mo(this.config,n,this.fragmentTracker,this.hls)},r.onMediaDetaching=function(){var t=this.media;t&&this.onvplaying&&this.onvseeked&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),e.prototype.onMediaDetaching.call(this)},r.onMediaPlaying=function(){this.tick()},r.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:null;g(t)&&this.log("Media seeked to "+t.toFixed(3));var r=this.getMainFwdBufferInfo();null!==r&&0!==r.len?this.tick():this.warn('Main forward buffer length on "seeked" event '+(r?r.len:"empty")+")")},r.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(_.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1},r.onManifestParsed=function(e,t){var r,n,a=!1,i=!1;t.levels.forEach((function(e){var t=e.audioCodec;t&&(a=a||-1!==t.indexOf("mp4a.40.2"),i=i||-1!==t.indexOf("mp4a.40.5"))})),this.audioCodecSwitch=a&&i&&!("function"==typeof(null==(n=wo())||null==(r=n.prototype)?void 0:r.changeType)),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1},r.onLevelLoading=function(e,t){var r=this.levels;if(r&&this.state===Yr){var n=r[t.level];(!n.details||n.details.live&&this.levelLastLoaded!==n||this.waitForCdnTuneIn(n.details))&&(this.state=on)}},r.onLevelLoaded=function(e,t){var r,n=this.levels,a=t.level,i=t.details,o=i.totalduration;if(n){this.log("Level "+a+" loaded ["+i.startSN+","+i.endSN+"]"+(i.lastPartSn?"[part-"+i.lastPartSn+"-"+i.lastPartIndex+"]":"")+", cc ["+i.startCC+", "+i.endCC+"] duration:"+o);var s=n[a],l=this.fragCurrent;!l||this.state!==Zr&&this.state!==Qr||l.level!==t.level&&l.loader&&this.abortCurrentFrag();var u=0;if(i.live||null!=(r=s.details)&&r.live){var c;if(this.checkLiveUpdate(i),i.deltaUpdateFailed)return;u=this.alignPlaylists(i,s.details,null==(c=this.levelLastLoaded)?void 0:c.details)}if(s.details=i,this.levelLastLoaded=s,this.hls.trigger(_.LEVEL_UPDATED,{details:i,level:a}),this.state===on){if(this.waitForCdnTuneIn(i))return;this.state=Yr}this.startFragRequested?i.live&&this.synchronizeToLiveEdge(i):this.setStartPosition(i,u),this.tick()}else this.warn("Levels were reset while loading level "+a)},r._handleFragmentLoadProgress=function(e){var t,r=e.frag,n=e.part,a=e.payload,i=this.levels;if(i){var o=i[r.level],s=o.details;if(!s)return this.warn("Dropping fragment "+r.sn+" of level "+r.level+" after level details were reset"),void this.fragmentTracker.removeFragment(r);var l=o.videoCodec,u=s.PTSKnown||!s.live,c=null==(t=r.initSegment)?void 0:t.data,d=this._getAudioCodec(o),p=this.transmuxer=this.transmuxer||new ka(this.hls,Tt,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),h=n?n.index:-1,f=-1!==h,m=new Or(r.level,r.sn,r.stats.chunkCount,a.byteLength,h,f),g=this.initPTS[r.cc];p.push(a,c,d,l,r,n,s.totalduration,u,m,g)}else this.warn("Levels were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered")},r.onAudioTrackSwitching=function(e,t){var r=this.altAudio;if(!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n&&(this.log("Switching to main audio track, cancel main fragment load"),n.abortRequests(),this.fragmentTracker.removeFragment(n)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var a=this.hls;r&&(a.trigger(_.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),a.trigger(_.AUDIO_TRACK_SWITCHED,t)}},r.onAudioTrackSwitched=function(e,t){var r=t.id,n=!!this.hls.audioTracks[r].url;if(n){var a=this.videoBuffer;a&&this.mediaBuffer!==a&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=a)}this.altAudio=n,this.tick()},r.onBufferCreated=function(e,t){var r,n,a=t.tracks,i=!1;for(var o in a){var s=a[o];if("main"===s.id){if(n=o,r=s,"video"===o){var l=a[o];l&&(this.videoBuffer=l.buffer)}}else i=!0}i&&r?(this.log("Alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media},r.onFragBuffered=function(e,t){var r=t.frag,n=t.part;if(!r||r.type===Tt){if(this.fragContextChanged(r))return this.warn("Fragment "+r.sn+(n?" p: "+n.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===tn&&(this.state=Yr));var a=n?n.stats:r.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),"initSegment"!==r.sn&&(this.fragPrevious=r),this.fragBufferedComplete(r,n)}},r.onError=function(e,t){var r;if(t.fatal)this.state=nn;else switch(t.details){case E.FRAG_GAP:case E.FRAG_PARSING_ERROR:case E.FRAG_DECRYPT_ERROR:case E.FRAG_LOAD_ERROR:case E.FRAG_LOAD_TIMEOUT:case E.KEY_LOAD_ERROR:case E.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Tt,t);break;case E.LEVEL_LOAD_ERROR:case E.LEVEL_LOAD_TIMEOUT:case E.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==on||(null==(r=t.context)?void 0:r.type)!==kt||(this.state=Yr);break;case E.BUFFER_APPEND_ERROR:case E.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;if(t.details===E.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case E.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}},r.checkBuffer=function(){var e=this.media,t=this.gapController;if(e&&t&&e.readyState){if(this.loadedmetadata||!Dr.getBuffered(e).length){var r=this.state!==Yr?this.fragCurrent:null;t.poll(this.lastCurrentTime,r)}this.lastCurrentTime=e.currentTime}},r.onFragLoadEmergencyAborted=function(){this.state=Yr,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},r.onBufferFlushed=function(e,t){var r=t.type;if(r!==D||this.audioOnly&&!this.altAudio){var n=(r===O?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,r,Tt),this.tick()}},r.onLevelsUpdated=function(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels},r.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},r.seekToStartPos=function(){var e=this.media;if(e){var t=e.currentTime,r=this.startPosition;if(r>=0&&t<r){if(e.seeking)return void this.log("could not seek to "+r+", already seeking at "+t);var n=Dr.getBuffered(e),a=(n.length?n.start(0):0)-r;a>0&&(a<this.config.maxBufferHole||a<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+a+" to match buffer start"),r+=a,this.startPosition=r),this.log("seek to target start position "+r+" from current time "+t),e.currentTime=r}}},r._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t},r._loadBitrateTestFrag=function(e,t){var r=this;e.bitrateTest=!0,this._doFragLoad(e,t).then((function(n){var a=r.hls;if(n&&!r.fragContextChanged(e)){t.fragmentError=0,r.state=Yr,r.startFragRequested=!1,r.bitrateTest=!1;var i=e.stats;i.parsing.start=i.parsing.end=i.buffering.start=i.buffering.end=self.performance.now(),a.trigger(_.FRAG_LOADED,n),e.bitrateTest=!1}}))},r._handleTransmuxComplete=function(e){var t,r="main",n=this.hls,a=e.remuxResult,i=e.chunkMeta,o=this.getCurrentContext(i);if(o){var s=o.frag,l=o.part,u=o.level,c=a.video,d=a.text,p=a.id3,h=a.initSegment,f=u.details,m=this.altAudio?void 0:a.audio;if(this.fragContextChanged(s))this.fragmentTracker.removeFragment(s);else{if(this.state=en,h){if(null!=h&&h.tracks){var y=s.initSegment||s;this._bufferInitSegment(u,h.tracks,y,i),n.trigger(_.FRAG_PARSING_INIT_SEGMENT,{frag:y,id:r,tracks:h.tracks})}var v=h.initPTS,k=h.timescale;g(v)&&(this.initPTS[s.cc]={baseTime:v,timescale:k},n.trigger(_.INIT_PTS_FOUND,{frag:s,id:r,initPTS:v,timescale:k}))}if(c&&f&&"initSegment"!==s.sn){var E=f.fragments[s.sn-1-f.startSN],b=s.sn===f.startSN,T=!E||s.cc>E.cc;if(!1!==a.independent){var A=c.startPTS,S=c.endPTS,C=c.startDTS,P=c.endDTS;if(l)l.elementaryStreams[c.type]={startPTS:A,endPTS:S,startDTS:C,endDTS:P};else if(c.firstKeyFrame&&c.independent&&1===i.id&&!T&&(this.couldBacktrack=!0),c.dropped&&c.independent){var x=this.getMainFwdBufferInfo(),w=(x?x.end:this.getLoadPosition())+this.config.maxBufferHole,I=c.firstKeyFramePTS?c.firstKeyFramePTS:A;if(!b&&w<I-this.config.maxBufferHole&&!T)return void this.backtrack(s);T&&(s.gap=!0),s.setElementaryStreamInfo(c.type,s.start,S,s.start,P,!0)}else b&&A>2&&(s.gap=!0);s.setElementaryStreamInfo(c.type,A,S,C,P),this.backtrackFragment&&(this.backtrackFragment=s),this.bufferFragmentData(c,s,l,i,b||T)}else{if(!b&&!T)return void this.backtrack(s);s.gap=!0}}if(m){var M=m.startPTS,R=m.endPTS,O=m.startDTS,L=m.endDTS;l&&(l.elementaryStreams[D]={startPTS:M,endPTS:R,startDTS:O,endDTS:L}),s.setElementaryStreamInfo(D,M,R,O,L),this.bufferFragmentData(m,s,l,i)}if(f&&null!=p&&null!=(t=p.samples)&&t.length){var N={id:r,frag:s,details:f,samples:p.samples};n.trigger(_.FRAG_PARSING_METADATA,N)}if(f&&d){var U={id:r,frag:s,details:f,samples:d.samples};n.trigger(_.FRAG_PARSING_USERDATA,U)}}}else this.resetWhenMissingContext(i)},r._bufferInitSegment=function(e,t,r,n){var a=this;if(this.state===en){this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;var i=t.audio,o=t.video,s=t.audiovideo;if(i){var l=e.audioCodec,u=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(l&&(l=-1!==l.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==i.metadata.channelCount&&-1===u.indexOf("firefox")&&(l="mp4a.40.5")),l&&-1!==l.indexOf("mp4a.40.5")&&-1!==u.indexOf("android")&&"audio/mpeg"!==i.container&&(l="mp4a.40.2",this.log("Android: force audio codec to "+l)),e.audioCodec&&e.audioCodec!==l&&this.log('Swapping manifest audio codec "'+e.audioCodec+'" for "'+l+'"'),i.levelCodec=l,i.id="main",this.log("Init audio buffer, container:"+i.container+", codecs[selected/level/parsed]=["+(l||"")+"/"+(e.audioCodec||"")+"/"+i.codec+"]")}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log("Init video buffer, container:"+o.container+", codecs[level/parsed]=["+(e.videoCodec||"")+"/"+o.codec+"]")),s&&this.log("Init audiovideo buffer, container:"+s.container+", codecs[level/parsed]=["+e.codecs+"/"+s.codec+"]"),this.hls.trigger(_.BUFFER_CODECS,t),Object.keys(t).forEach((function(e){var i=t[e].initSegment;null!=i&&i.byteLength&&a.hls.trigger(_.BUFFER_APPENDING,{type:e,data:i,frag:r,part:null,chunkMeta:n,parent:r.type})})),this.tickImmediate()}},r.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Tt)},r.backtrack=function(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Yr},r.checkFragmentChanged=function(){var e=this.media,t=null;if(e&&e.readyState>1&&!1===e.seeking){var r=e.currentTime;if(Dr.isBuffered(e,r)?t=this.getAppendedFrag(r):Dr.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;var n=this.fragPlaying,a=t.level;n&&t.sn===n.sn&&n.level===a||(this.fragPlaying=t,this.hls.trigger(_.FRAG_CHANGED,{frag:t}),n&&n.level===a||this.hls.trigger(_.LEVEL_SWITCHED,{level:a}))}}},o(t,[{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentFrag",get:function(){var e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}},{key:"currentProgramDateTime",get:function(){var e=this.media;if(e){var t=e.currentTime,r=this.currentFrag;if(r&&g(t)&&g(r.programDateTime)){var n=r.programDateTime+1e3*(t-r.start);return new Date(n)}}return null}},{key:"currentLevel",get:function(){var e=this.currentFrag;return e?e.level:-1}},{key:"nextBufferedFrag",get:function(){var e=this.currentFrag;return e?this.followingBufferedFrag(e):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),t}(sn),Do=function(){function e(t){void 0===t&&(t={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new ga,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,S(t.debug||!1,"Hls instance");var r=this.config=function(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');var r=So(e),a=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((function(e){var n=("level"===e?"playlist":e)+"LoadPolicy",i=void 0===t[n],o=[];a.forEach((function(a){var s=e+"Loading"+a,l=t[s];if(void 0!==l&&i){o.push(s);var u=r[n].default;switch(t[n]={default:u},a){case"TimeOut":u.maxLoadTimeMs=l,u.maxTimeToFirstByteMs=l;break;case"MaxRetry":u.errorRetry.maxNumRetry=l,u.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":u.errorRetry.retryDelayMs=l,u.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":u.errorRetry.maxRetryDelayMs=l,u.timeoutRetry.maxRetryDelayMs=l}}})),o.length&&C.warn('hls.js config: "'+o.join('", "')+'" setting(s) are deprecated, use "'+n+'": '+JSON.stringify(t[n]))})),n(n({},r),t)}(e.DefaultConfig,t);this.userConfig=t,r.progressive&&function(e){var t=e.loader;t!==_o&&t!==yo?(C.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}()&&(e.loader=_o,e.progressive=!0,e.enableSoftwareAES=!0,C.log("[config]: Progressive streaming enabled, using FetchLoader"))}(r);var a=r.abrController,i=r.bufferController,o=r.capLevelController,s=r.errorController,l=r.fpsController,u=new s(this),c=this.abrController=new a(this),d=this.bufferController=new i(this),p=this.capLevelController=new o(this),h=new l(this),f=new xt(this),m=new Ft(this),g=r.contentSteeringController,y=g?new g(this):null,v=this.levelController=new Co(this,y),k=new wr(this),E=new xo(this.config),b=this.streamController=new Ro(this,k,E);p.setStreamController(b),h.setStreamController(b);var T=[f,v,b];y&&T.splice(1,0,y),this.networkControllers=T;var A=[c,d,p,h,m,k];this.audioTrackController=this.createController(r.audioTrackController,T);var P=r.audioStreamController;P&&T.push(new P(this,k,E)),this.subtitleTrackController=this.createController(r.subtitleTrackController,T);var x=r.subtitleStreamController;x&&T.push(new x(this,k,E)),this.createController(r.timelineController,A),E.emeController=this.emeController=this.createController(r.emeController,A),this.cmcdController=this.createController(r.cmcdController,A),this.latencyController=this.createController(Vt,A),this.coreComponents=A,T.push(u);var w=u.onErrorOut;"function"==typeof w&&this.on(_.ERROR,w,u)}e.isMSESupported=function(){return Io()},e.isSupported=function(){return function(){if(!Io())return!1;var e=Ye();return"function"==typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((function(t){return e.isTypeSupported(Je(t,"video"))}))||["mp4a.40.2","fLaC"].some((function(t){return e.isTypeSupported(Je(t,"audio"))})))}()},e.getMediaSource=function(){return Ye()};var t=e.prototype;return t.createController=function(e,t){if(e){var r=new e(this);return t&&t.push(r),r}return null},t.on=function(e,t,r){void 0===r&&(r=this),this._emitter.on(e,t,r)},t.once=function(e,t,r){void 0===r&&(r=this),this._emitter.once(e,t,r)},t.removeAllListeners=function(e){this._emitter.removeAllListeners(e)},t.off=function(e,t,r,n){void 0===r&&(r=this),this._emitter.off(e,t,r,n)},t.listeners=function(e){return this._emitter.listeners(e)},t.emit=function(e,t,r){return this._emitter.emit(e,t,r)},t.trigger=function(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){if(C.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),!this.triggeringException){this.triggeringException=!0;var r=e===_.ERROR;this.trigger(_.ERROR,{type:k.OTHER_ERROR,details:E.INTERNAL_EXCEPTION,fatal:r,event:e,error:t}),this.triggeringException=!1}}return!1},t.listenerCount=function(e){return this._emitter.listenerCount(e)},t.destroy=function(){C.log("destroy"),this.trigger(_.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((function(e){return e.destroy()})),this.networkControllers.length=0,this.coreComponents.forEach((function(e){return e.destroy()})),this.coreComponents.length=0;var e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null},t.attachMedia=function(e){C.log("attachMedia"),this._media=e,this.trigger(_.MEDIA_ATTACHING,{media:e})},t.detachMedia=function(){C.log("detachMedia"),this.trigger(_.MEDIA_DETACHING,void 0),this._media=null},t.loadSource=function(e){this.stopLoad();var t=this.media,r=this.url,n=this.url=m.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,C.log("loadSource:"+n),t&&r&&(r!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(_.MANIFEST_LOADING,{url:e})},t.startLoad=function(e){void 0===e&&(e=-1),C.log("startLoad("+e+")"),this.started=!0,this.networkControllers.forEach((function(t){t.startLoad(e)}))},t.stopLoad=function(){C.log("stopLoad"),this.started=!1,this.networkControllers.forEach((function(e){e.stopLoad()}))},t.resumeBuffering=function(){this.started&&this.networkControllers.forEach((function(e){"fragmentLoader"in e&&e.startLoad(-1)}))},t.pauseBuffering=function(){this.networkControllers.forEach((function(e){"fragmentLoader"in e&&e.stopLoad()}))},t.swapAudioCodec=function(){C.log("swapAudioCodec"),this.streamController.swapAudioCodec()},t.recoverMediaError=function(){C.log("recoverMediaError");var e=this._media;this.detachMedia(),e&&this.attachMedia(e)},t.removeLevel=function(e){this.levelController.removeLevel(e)},t.setAudioOption=function(e){var t;return null==(t=this.audioTrackController)?void 0:t.setAudioOption(e)},t.setSubtitleOption=function(e){var t;return null==(t=this.subtitleTrackController)||t.setSubtitleOption(e),null},o(e,[{key:"levels",get:function(){return this.levelController.levels||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){C.log("set currentLevel:"+e),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){C.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){C.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){C.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){var e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e},set:function(e){C.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping!==e&&(C.log("set autoLevelCapping:"+e),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}},{key:"bandwidthEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN},set:function(e){this.abrController.resetEstimator(e)}},{key:"ttfbEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimateTTFB():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(e){(function(e){return Ht.indexOf(e)>-1})(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var e=this.levels,t=this.config.minAutoBitrate;if(!e)return 0;for(var r=e.length,n=0;n<r;n++)if(e[n].maxBitrate>=t)return n;return 0}},{key:"maxAutoLevel",get:function(){var e,t=this.levels,r=this.autoLevelCapping,n=this.maxHdcpLevel;if(e=-1===r&&null!=t&&t.length?t.length-1:r,n)for(var a=e;a--;){var i=t[a].attrs["HDCP-LEVEL"];if(i&&i<=n)return a}return e}},{key:"firstAutoLevel",get:function(){return this.abrController.firstAutoLevel}},{key:"nextAutoLevel",get:function(){return this.abrController.nextAutoLevel},set:function(e){this.abrController.nextAutoLevel=e}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"allAudioTracks",get:function(){var e=this.audioTrackController;return e?e.allAudioTracks:[]}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"allSubtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(e){this.config.lowLatencyMode=e}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.5.8"}},{key:"Events",get:function(){return _}},{key:"ErrorTypes",get:function(){return k}},{key:"ErrorDetails",get:function(){return E}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:Ao},set:function(t){e.defaultConfig=t}}]),e}();return Do.defaultConfig=void 0,Do},module.exports=r()}(!1)},673:(__unused_webpack_module,exports,__webpack_require__)=>{(function(){var innerGlobal="undefined"!=typeof window?window:__webpack_require__.g,exportTo={};for(var k in function(window,global,module){var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},$jscomp.arrayIterator=function(e){return{next:$jscomp.arrayIteratorImpl(e)}},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.SIMPLE_FROUND_POLYFILL=!1,$jscomp.ISOLATE_POLYFILLS=!1,$jscomp.FORCE_POLYFILL_PROMISE=!1,$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e},$jscomp.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},$jscomp.global=$jscomp.getGlobal(this),$jscomp.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE,$jscomp.polyfills={},$jscomp.propertyToPolyfillSymbol={},$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(e,t){var r=$jscomp.propertyToPolyfillSymbol[t];return null==r?e[t]:void 0!==(r=e[r])?r:e[t]};$jscomp.polyfill=function(e,t,r,n){t&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(e,t,r,n):$jscomp.polyfillUnisolated(e,t,r,n))},$jscomp.polyfillUnisolated=function(e,t,r,n){for(r=$jscomp.global,e=e.split("."),n=0;n<e.length-1;n++){var a=e[n];if(!(a in r))return;r=r[a]}(t=t(n=r[e=e[e.length-1]]))!=n&&null!=t&&$jscomp.defineProperty(r,e,{configurable:!0,writable:!0,value:t})},$jscomp.polyfillIsolated=function(e,t,r,n){var a=e.split(".");e=1===a.length,n=a[0],n=!e&&n in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var i=0;i<a.length-1;i++){var o=a[i];if(!(o in n))return;n=n[o]}a=a[a.length-1],null!=(t=t(r=$jscomp.IS_SYMBOL_NATIVE&&"es6"===r?n[a]:null))&&(e?$jscomp.defineProperty($jscomp.polyfills,a,{configurable:!0,writable:!0,value:t}):t!==r&&(void 0===$jscomp.propertyToPolyfillSymbol[a]&&(r=1e9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[a]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(a):$jscomp.POLYFILL_PREFIX+r+"$"+a),$jscomp.defineProperty(n,$jscomp.propertyToPolyfillSymbol[a],{configurable:!0,writable:!0,value:t})))},$jscomp.initSymbol=function(){},$jscomp.polyfill("Symbol",(function(e){if(e)return e;var t=function(e,t){this.$jscomp$symbol$id_=e,$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:t})};t.prototype.toString=function(){return this.$jscomp$symbol$id_};var r="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",n=0,a=function(e){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new t(r+(e||"")+"_"+n++,e)};return a}),"es6","es3"),$jscomp.polyfill("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r=0;r<t.length;r++){var n=$jscomp.global[t[r]];"function"==typeof n&&"function"!=typeof n.prototype[e]&&$jscomp.defineProperty(n.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return e}),"es6","es3"),$jscomp.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},$jscomp.createTemplateTagFirstArg=function(e){return e.raw=e},$jscomp.createTemplateTagFirstArgWithRaw=function(e,t){return e.raw=t,e},$jscomp.makeIterator=function(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):$jscomp.arrayIterator(e)},$jscomp.arrayFromIterator=function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r},$jscomp.arrayFromIterable=function(e){return e instanceof Array?e:$jscomp.arrayFromIterator($jscomp.makeIterator(e))},$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(e){var t=function(){};return t.prototype=e,new t},$jscomp.getConstructImplementation=function(){if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(function(){function e(){}return new e,Reflect.construct(e,[],(function(){})),new e instanceof e}())return Reflect.construct;var e=Reflect.construct;return function(t,r,n){return t=e(t,r),n&&Reflect.setPrototypeOf(t,n.prototype),t}}return function(e,t,r){return void 0===r&&(r=e),r=$jscomp.objectCreate(r.prototype||Object.prototype),Function.prototype.apply.call(e,r,t)||r}},$jscomp.construct=$jscomp.getConstructImplementation(),$jscomp.underscoreProtoCanBeSet=function(){var e={};try{return e.__proto__={a:!0},e.a}catch(e){}return!1},$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null,$jscomp.inherits=function(e,t){if(e.prototype=$jscomp.objectCreate(t.prototype),e.prototype.constructor=e,$jscomp.setPrototypeOf){var r=$jscomp.setPrototypeOf;r(e,t)}else for(r in t)if("prototype"!=r)if(Object.defineProperties){var n=Object.getOwnPropertyDescriptor(t,r);n&&Object.defineProperty(e,r,n)}else e[r]=t[r];e.superClass_=t.prototype},$jscomp.generator={},$jscomp.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object")},$jscomp.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1},$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},$jscomp.generator.Context.prototype.next_=function(e){this.yieldResult=e},$jscomp.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},$jscomp.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},$jscomp.generator.Context.prototype.yield=function(e,t){return this.nextAddress=t,{value:e}},$jscomp.generator.Context.prototype.yieldAll=function(e,t){var r=(e=$jscomp.makeIterator(e)).next();if($jscomp.generator.ensureIteratorResultIsObject_(r),!r.done)return this.yieldAllIterator_=e,this.yield(r.value,t);this.yieldResult=r.value,this.nextAddress=t},$jscomp.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(e,t){this.catchAddress_=e,null!=t&&(this.finallyAddress_=t)},$jscomp.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},$jscomp.generator.Context.prototype.leaveTryBlock=function(e,t){this.nextAddress=e,this.catchAddress_=t||0},$jscomp.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},$jscomp.generator.Context.prototype.enterFinallyBlock=function(e,t,r){r?this.finallyContexts_[r]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=t||0},$jscomp.generator.Context.prototype.leaveFinallyBlock=function(e,t){if(t=this.finallyContexts_.splice(t||0)[0],t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();null!=t.jumpTo&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},$jscomp.generator.Context.prototype.forIn=function(e){return new $jscomp.generator.Context.PropertyIterator(e)},$jscomp.generator.Context.PropertyIterator=function(e){for(var t in this.object_=e,this.properties_=[],e)this.properties_.push(t);this.properties_.reverse()},$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var e=this.properties_.pop();if(e in this.object_)return e}return null},$jscomp.generator.Engine_=function(e){this.context_=new $jscomp.generator.Context,this.program_=e},$jscomp.generator.Engine_.prototype.next_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},$jscomp.generator.Engine_.prototype.return_=function(e){this.context_.start_();var t=this.context_.yieldAllIterator_;return t?this.yieldAllStep_("return"in t?t.return:function(e){return{value:e,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},$jscomp.generator.Engine_.prototype.throw_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},$jscomp.generator.Engine_.prototype.yieldAllStep_=function(e,t,r){try{var n=e.call(this.context_.yieldAllIterator_,t);if($jscomp.generator.ensureIteratorResultIsObject_(n),!n.done)return this.context_.stop_(),n;var a=n.value}catch(e){return this.context_.yieldAllIterator_=null,this.context_.throw_(e),this.nextStep_()}return this.context_.yieldAllIterator_=null,r.call(this.context_,a),this.nextStep_()},$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(e){this.context_.yieldResult=void 0,this.context_.throw_(e)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},$jscomp.generator.Generator_=function(e){this.next=function(t){return e.next_(t)},this.throw=function(t){return e.throw_(t)},this.return=function(t){return e.return_(t)},this[Symbol.iterator]=function(){return this}},$jscomp.generator.createGenerator=function(e,t){return t=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(t)),$jscomp.setPrototypeOf&&e.prototype&&$jscomp.setPrototypeOf(t,e.prototype),t},$jscomp.asyncExecutePromiseGenerator=function(e){function t(t){return e.next(t)}function r(t){return e.throw(t)}return new Promise((function(n,a){!function e(i){i.done?n(i.value):Promise.resolve(i.value).then(t,r).then(e,a)}(e.next())}))},$jscomp.asyncExecutePromiseGeneratorFunction=function(e){return $jscomp.asyncExecutePromiseGenerator(e())},$jscomp.asyncExecutePromiseGeneratorProgram=function(e){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(e)))},$jscomp.getRestArguments=function(){for(var e=Number(this),t=[],r=e;r<arguments.length;r++)t[r-e]=arguments[r];return t},$jscomp.polyfill("Reflect",(function(e){return e||{}}),"es6","es3"),$jscomp.polyfill("Reflect.construct",(function(e){return $jscomp.construct}),"es6","es3"),$jscomp.polyfill("Reflect.setPrototypeOf",(function(e){if(e)return e;if($jscomp.setPrototypeOf){var t=$jscomp.setPrototypeOf;return function(e,r){try{return t(e,r),!0}catch(e){return!1}}}return null}),"es6","es5"),$jscomp.polyfill("Promise",(function(e){function t(){this.batch_=null}function r(e){return e instanceof a?e:new a((function(t,r){t(e)}))}if(e&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&void 0===$jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return e;t.prototype.asyncExecute=function(e){if(null==this.batch_){this.batch_=[];var t=this;this.asyncExecuteFunction((function(){t.executeBatch_()}))}this.batch_.push(e)};var n=$jscomp.global.setTimeout;t.prototype.asyncExecuteFunction=function(e){n(e,0)},t.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=this.batch_;this.batch_=[];for(var t=0;t<e.length;++t){var r=e[t];e[t]=null;try{r()}catch(e){this.asyncThrow_(e)}}}this.batch_=null},t.prototype.asyncThrow_=function(e){this.asyncExecuteFunction((function(){throw e}))};var a=function(e){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[],this.isRejectionHandled_=!1;var t=this.createResolveAndReject_();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}};a.prototype.createResolveAndReject_=function(){function e(e){return function(n){r||(r=!0,e.call(t,n))}}var t=this,r=!1;return{resolve:e(this.resolveTo_),reject:e(this.reject_)}},a.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof a)this.settleSameAsPromise_(e);else{e:switch(typeof e){case"object":var t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}},a.prototype.resolveToNonPromiseObj_=function(e){var t=void 0;try{t=e.then}catch(e){return void this.reject_(e)}"function"==typeof t?this.settleSameAsThenable_(t,e):this.fulfill_(e)},a.prototype.reject_=function(e){this.settle_(2,e)},a.prototype.fulfill_=function(e){this.settle_(1,e)},a.prototype.settle_=function(e,t){if(0!=this.state_)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.state_);this.state_=e,this.result_=t,2===this.state_&&this.scheduleUnhandledRejectionCheck_(),this.executeOnSettledCallbacks_()},a.prototype.scheduleUnhandledRejectionCheck_=function(){var e=this;n((function(){if(e.notifyUnhandledRejection_()){var t=$jscomp.global.console;void 0!==t&&t.error(e.result_)}}),1)},a.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var e=$jscomp.global.CustomEvent,t=$jscomp.global.Event,r=$jscomp.global.dispatchEvent;return void 0===r||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=$jscomp.global.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.result_,r(e))},a.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=0;e<this.onSettledCallbacks_.length;++e)i.asyncExecute(this.onSettledCallbacks_[e]);this.onSettledCallbacks_=null}};var i=new t;return a.prototype.settleSameAsPromise_=function(e){var t=this.createResolveAndReject_();e.callWhenSettled_(t.resolve,t.reject)},a.prototype.settleSameAsThenable_=function(e,t){var r=this.createResolveAndReject_();try{e.call(t,r.resolve,r.reject)}catch(e){r.reject(e)}},a.prototype.then=function(e,t){function r(e,t){return"function"==typeof e?function(t){try{n(e(t))}catch(e){i(e)}}:t}var n,i,o=new a((function(e,t){n=e,i=t}));return this.callWhenSettled_(r(e,n),r(t,i)),o},a.prototype.catch=function(e){return this.then(void 0,e)},a.prototype.callWhenSettled_=function(e,t){function r(){switch(n.state_){case 1:e(n.result_);break;case 2:t(n.result_);break;default:throw Error("Unexpected state: "+n.state_)}}var n=this;null==this.onSettledCallbacks_?i.asyncExecute(r):this.onSettledCallbacks_.push(r),this.isRejectionHandled_=!0},a.resolve=r,a.reject=function(e){return new a((function(t,r){r(e)}))},a.race=function(e){return new a((function(t,n){for(var a=$jscomp.makeIterator(e),i=a.next();!i.done;i=a.next())r(i.value).callWhenSettled_(t,n)}))},a.all=function(e){var t=$jscomp.makeIterator(e),n=t.next();return n.done?r([]):new a((function(e,a){function i(t){return function(r){o[t]=r,0==--s&&e(o)}}var o=[],s=0;do{o.push(void 0),s++,r(n.value).callWhenSettled_(i(o.length-1),a),n=t.next()}while(!n.done)}))},a}),"es6","es3"),$jscomp.checkEs6ConformanceViaProxy=function(){try{var e={},t=Object.create(new $jscomp.global.Proxy(e,{get:function(r,n,a){return r==e&&"q"==n&&a==t}}));return!0===t.q}catch(e){return!1}},$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy(),$jscomp.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},$jscomp.polyfill("WeakMap",(function(e){function t(){}function r(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function n(e){if(!$jscomp.owns(e,i)){var r=new t;$jscomp.defineProperty(e,i,{value:r})}}function a(e){if(!$jscomp.ISOLATE_POLYFILLS){var r=Object[e];r&&(Object[e]=function(e){return e instanceof t?e:(Object.isExtensible(e)&&n(e),r(e))})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),r=Object.seal({}),n=new e([[t,2],[r,3]]);return 2==n.get(t)&&3==n.get(r)&&(n.delete(t),n.set(r,4),!n.has(t)&&4==n.get(r))}catch(e){return!1}}())return e;var i="$jscomp_hidden_"+Math.random();a("freeze"),a("preventExtensions"),a("seal");var o=0,s=function(e){if(this.id_=(o+=Math.random()+1).toString(),e){e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};return s.prototype.set=function(e,t){if(!r(e))throw Error("Invalid WeakMap key");if(n(e),!$jscomp.owns(e,i))throw Error("WeakMap key fail: "+e);return e[i][this.id_]=t,this},s.prototype.get=function(e){return r(e)&&$jscomp.owns(e,i)?e[i][this.id_]:void 0},s.prototype.has=function(e){return r(e)&&$jscomp.owns(e,i)&&$jscomp.owns(e[i],this.id_)},s.prototype.delete=function(e){return!!(r(e)&&$jscomp.owns(e,i)&&$jscomp.owns(e[i],this.id_))&&delete e[i][this.id_]},s}),"es6","es3"),$jscomp.MapEntry=function(){},$jscomp.polyfill("Map",(function(e){if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if($jscomp.ASSUME_NO_NATIVE_MAP||!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),r=new e($jscomp.makeIterator([[t,"s"]]));if("s"!=r.get(t)||1!=r.size||r.get({x:4})||r.set({x:4},"t")!=r||2!=r.size)return!1;var n=r.entries(),a=n.next();return!a.done&&a.value[0]==t&&"s"==a.value[1]&&!((a=n.next()).done||4!=a.value[0].x||"t"!=a.value[1]||!n.next().done)}catch(e){return!1}}())return e;var t=new WeakMap,r=function(e){if(this.data_={},this.head_=i(),this.size=0,e){e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};r.prototype.set=function(e,t){var r=n(this,e=0===e?0:e);return r.list||(r.list=this.data_[r.id]=[]),r.entry?r.entry.value=t:(r.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:e,value:t},r.list.push(r.entry),this.head_.previous.next=r.entry,this.head_.previous=r.entry,this.size++),this},r.prototype.delete=function(e){return!(!(e=n(this,e)).entry||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.data_[e.id],e.entry.previous.next=e.entry.next,e.entry.next.previous=e.entry.previous,e.entry.head=null,this.size--,!0)},r.prototype.clear=function(){this.data_={},this.head_=this.head_.previous=i(),this.size=0},r.prototype.has=function(e){return!!n(this,e).entry},r.prototype.get=function(e){return(e=n(this,e).entry)&&e.value},r.prototype.entries=function(){return a(this,(function(e){return[e.key,e.value]}))},r.prototype.keys=function(){return a(this,(function(e){return e.key}))},r.prototype.values=function(){return a(this,(function(e){return e.value}))},r.prototype.forEach=function(e,t){for(var r,n=this.entries();!(r=n.next()).done;)r=r.value,e.call(t,r[1],r[0],this)},r.prototype[Symbol.iterator]=r.prototype.entries;var n=function(e,r){var n=r&&typeof r;"object"==n||"function"==n?t.has(r)?n=t.get(r):(n=""+ ++o,t.set(r,n)):n="p_"+r;var a=e.data_[n];if(a&&$jscomp.owns(e.data_,n))for(e=0;e<a.length;e++){var i=a[e];if(r!=r&&i.key!=i.key||r===i.key)return{id:n,list:a,index:e,entry:i}}return{id:n,list:a,index:-1,entry:void 0}},a=function(e,t){var r=e.head_;return $jscomp.iteratorPrototype((function(){if(r){for(;r.head!=e.head_;)r=r.previous;for(;r.next!=r.head;)return r=r.next,{done:!1,value:t(r)};r=null}return{done:!0,value:void 0}}))},i=function(){var e={};return e.previous=e.next=e.head=e},o=0;return r}),"es6","es3"),$jscomp.polyfill("Set",(function(e){if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if($jscomp.ASSUME_NO_NATIVE_SET||!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),r=new e($jscomp.makeIterator([t]));if(!r.has(t)||1!=r.size||r.add(t)!=r||1!=r.size||r.add({x:4})!=r||2!=r.size)return!1;var n=r.entries(),a=n.next();return!a.done&&a.value[0]==t&&a.value[1]==t&&(!(a=n.next()).done&&a.value[0]!=t&&4==a.value[0].x&&a.value[1]==a.value[0]&&n.next().done)}catch(e){return!1}}())return e;var t=function(e){if(this.map_=new Map,e){e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.map_.size};return t.prototype.add=function(e){return e=0===e?0:e,this.map_.set(e,e),this.size=this.map_.size,this},t.prototype.delete=function(e){return e=this.map_.delete(e),this.size=this.map_.size,e},t.prototype.clear=function(){this.map_.clear(),this.size=0},t.prototype.has=function(e){return this.map_.has(e)},t.prototype.entries=function(){return this.map_.entries()},t.prototype.values=function(){return this.map_.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var r=this;this.map_.forEach((function(n){return e.call(t,n,n,r)}))},t}),"es6","es3"),$jscomp.iteratorFromArray=function(e,t){e instanceof String&&(e+="");var r=0,n=!1,a={next:function(){if(!n&&r<e.length){var a=r++;return{value:t(a,e[a]),done:!1}}return n=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a},$jscomp.polyfill("Array.prototype.keys",(function(e){return e||function(){return $jscomp.iteratorFromArray(this,(function(e){return e}))}}),"es6","es3"),$jscomp.findInternal=function(e,t,r){e instanceof String&&(e=String(e));for(var n=e.length,a=0;a<n;a++){var i=e[a];if(t.call(r,i,a,e))return{i:a,v:i}}return{i:-1,v:void 0}},$jscomp.polyfill("Array.prototype.findIndex",(function(e){return e||function(e,t){return $jscomp.findInternal(this,e,t).i}}),"es6","es3"),$jscomp.polyfill("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}}),"es6","es3"),$jscomp.polyfill("Array.prototype.includes",(function(e){return e||function(e,t){var r=this;r instanceof String&&(r=String(r));var n=r.length;for(0>(t=t||0)&&(t=Math.max(t+n,0));t<n;t++){var a=r[t];if(a===e||Object.is(a,e))return!0}return!1}}),"es7","es3"),$jscomp.checkStringArgs=function(e,t,r){if(null==e)throw new TypeError("The 'this' value for String.prototype."+r+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+r+" must not be a regular expression");return e+""},$jscomp.polyfill("String.prototype.includes",(function(e){return e||function(e,t){return-1!==$jscomp.checkStringArgs(this,e,"includes").indexOf(e,t||0)}}),"es6","es3"),$jscomp.polyfill("Array.prototype.find",(function(e){return e||function(e,t){return $jscomp.findInternal(this,e,t).v}}),"es6","es3"),$jscomp.polyfill("String.prototype.startsWith",(function(e){return e||function(e,t){var r=$jscomp.checkStringArgs(this,e,"startsWith");e+="";var n=r.length,a=e.length;t=Math.max(0,Math.min(0|t,r.length));for(var i=0;i<a&&t<n;)if(r[t++]!=e[i++])return!1;return i>=a}}),"es6","es3"),$jscomp.polyfill("WeakSet",(function(e){if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),r=Object.seal({}),n=new e([t]);return!(!n.has(t)||n.has(r))&&(n.delete(t),n.add(r),!n.has(t)&&n.has(r))}catch(e){return!1}}())return e;var t=function(e){if(this.map_=new WeakMap,e){e=$jscomp.makeIterator(e);for(var t;!(t=e.next()).done;)this.add(t.value)}};return t.prototype.add=function(e){return this.map_.set(e,!0),this},t.prototype.has=function(e){return this.map_.has(e)},t.prototype.delete=function(e){return this.map_.delete(e)},t}),"es6","es3"),$jscomp.polyfill("Array.from",(function(e){return e||function(e,t,r){t=null!=t?t:function(e){return e};var n=[],a="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof a){e=a.call(e);for(var i=0;!(a=e.next()).done;)n.push(t.call(r,a.value,i++))}else for(a=e.length,i=0;i<a;i++)n.push(t.call(r,e[i],i));return n}}),"es6","es3"),$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(e,t){for(var r=1;r<arguments.length;r++){var n=arguments[r];if(n)for(var a in n)$jscomp.owns(n,a)&&(e[a]=n[a])}return e},$jscomp.polyfill("Object.assign",(function(e){return e||$jscomp.assign}),"es6","es3"),$jscomp.polyfill("Array.prototype.values",(function(e){return e||function(){return $jscomp.iteratorFromArray(this,(function(e,t){return t}))}}),"es8","es3"),$jscomp.polyfill("Promise.prototype.finally",(function(e){return e||function(e){return this.then((function(t){return Promise.resolve(e()).then((function(){return t}))}),(function(t){return Promise.resolve(e()).then((function(){throw t}))}))}}),"es9","es3"),$jscomp.polyfill("Array.prototype.entries",(function(e){return e||function(){return $jscomp.iteratorFromArray(this,(function(e,t){return[e,t]}))}}),"es6","es3"),$jscomp.polyfill("String.prototype.repeat",(function(e){return e||function(e){var t=$jscomp.checkStringArgs(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var r="";e;)1&e&&(r+=t),(e>>>=1)&&(t+=t);return r}}),"es6","es3"),$jscomp.polyfill("Number.isNaN",(function(e){return e||function(e){return"number"==typeof e&&isNaN(e)}}),"es6","es3"),$jscomp.polyfill("Number.isFinite",(function(e){return e||function(e){return"number"==typeof e&&(!isNaN(e)&&1/0!==e&&-1/0!==e)}}),"es6","es3"),$jscomp.polyfill("Object.values",(function(e){return e||function(e){var t,r=[];for(t in e)$jscomp.owns(e,t)&&r.push(e[t]);return r}}),"es8","es3"),$jscomp.polyfill("Math.log2",(function(e){return e||function(e){return Math.log(e)/Math.LN2}}),"es6","es3"),$jscomp.polyfill("Number.MAX_SAFE_INTEGER",(function(){return 9007199254740991}),"es6","es3"),$jscomp.polyfill("Math.trunc",(function(e){return e||function(e){if(e=Number(e),isNaN(e)||1/0===e||-1/0===e||0===e)return e;var t=Math.floor(Math.abs(e));return 0>e?-t:t}}),"es6","es3"),$jscomp.polyfill("Object.entries",(function(e){return e||function(e){var t,r=[];for(t in e)$jscomp.owns(e,t)&&r.push([t,e[t]]);return r}}),"es8","es3");var COMPILED=!0,goog=goog||{};if(goog.global=this||self,goog.exportPath_=function(e,t,r,n){e=e.split("."),n=n||goog.global,e[0]in n||void 0===n.execScript||n.execScript("var "+e[0]);for(var a;e.length&&(a=e.shift());)if(e.length||void 0===t)n=n[a]&&n[a]!==Object.prototype[a]?n[a]:n[a]={};else if(!r&&goog.isObject(t)&&goog.isObject(n[a]))for(var i in t)t.hasOwnProperty(i)&&(n[a][i]=t[i]);else n[a]=t},goog.define=function(e,t){if(!COMPILED){var r=goog.global.CLOSURE_UNCOMPILED_DEFINES,n=goog.global.CLOSURE_DEFINES;r&&void 0===r.nodeType&&Object.prototype.hasOwnProperty.call(r,e)?t=r[e]:n&&void 0===n.nodeType&&Object.prototype.hasOwnProperty.call(n,e)&&(t=n[e])}return t},goog.FEATURESET_YEAR=2012,goog.DEBUG=!0,goog.LOCALE="en",goog.getLocale=function(){return goog.LOCALE},goog.TRUSTED_SITE=!0,goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG,goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1,goog.provide=function(e){if(goog.isInModuleLoader_())throw Error("goog.provide cannot be used within a module.");if(!COMPILED&&goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');goog.constructNamespace_(e)},goog.constructNamespace_=function(e,t,r){if(!COMPILED){delete goog.implicitNamespaces_[e];for(var n=e;(n=n.substring(0,n.lastIndexOf(".")))&&!goog.getObjectByName(n);)goog.implicitNamespaces_[n]=!0}goog.exportPath_(e,t,r)},goog.NONCE_PATTERN_=/^[\w+/_-]+[=]{0,2}$/,goog.getScriptNonce_=function(e){return(e=(e=(e||goog.global).document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&goog.NONCE_PATTERN_.test(e)?e:""},goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,goog.module=function(e){if("string"!=typeof e||!e||-1==e.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInGoogModuleLoader_())throw Error("Module "+e+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");if(goog.moduleLoaderState_.moduleName=e,!COMPILED){if(goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete goog.implicitNamespaces_[e]}},goog.module.get=function(e){return goog.module.getInternal_(e)},goog.module.getInternal_=function(e){if(!COMPILED){if(e in goog.loadedModules_)return goog.loadedModules_[e].exports;if(!goog.implicitNamespaces_[e])return null!=(e=goog.getObjectByName(e))?e:null}return null},goog.ModuleType={ES6:"es6",GOOG:"goog"},goog.moduleLoaderState_=null,goog.isInModuleLoader_=function(){return goog.isInGoogModuleLoader_()||goog.isInEs6ModuleLoader_()},goog.isInGoogModuleLoader_=function(){return!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.GOOG},goog.isInEs6ModuleLoader_=function(){if(goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.ES6)return!0;var e=goog.global.$jscomp;return!!e&&("function"==typeof e.getCurrentModulePath&&!!e.getCurrentModulePath())},goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInGoogModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0},goog.declareModuleId=function(e){if(!COMPILED){if(!goog.isInEs6ModuleLoader_())throw Error("goog.declareModuleId may only be called from within an ES6 module");if(goog.moduleLoaderState_&&goog.moduleLoaderState_.moduleName)throw Error("goog.declareModuleId may only be called once per module.");if(e in goog.loadedModules_)throw Error('Module with namespace "'+e+'" already exists.')}if(goog.moduleLoaderState_)goog.moduleLoaderState_.moduleName=e;else{var t=goog.global.$jscomp;if(!t||"function"!=typeof t.getCurrentModulePath)throw Error('Module with namespace "'+e+'" has been loaded incorrectly.');t=t.require(t.getCurrentModulePath()),goog.loadedModules_[e]={exports:t,type:goog.ModuleType.ES6,moduleId:e}}},goog.setTestOnly=function(e){if(goog.DISALLOW_TEST_ONLY_CODE)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},goog.forwardDeclare=function(e){},COMPILED||(goog.isProvided_=function(e){return e in goog.loadedModules_||!goog.implicitNamespaces_[e]&&null!=goog.getObjectByName(e)},goog.implicitNamespaces_={"goog.module":!0}),goog.getObjectByName=function(e,t){e=e.split("."),t=t||goog.global;for(var r=0;r<e.length;r++)if(null==(t=t[e[r]]))return null;return t},goog.addDependency=function(e,t,r,n){!COMPILED&&goog.DEPENDENCIES_ENABLED&&goog.debugLoader_.addDependency(e,t,r,n)},goog.ENABLE_DEBUG_LOADER=!1,goog.logToConsole_=function(e){goog.global.console&&goog.global.console.error(e)},goog.require=function(e){if(!COMPILED){if(goog.ENABLE_DEBUG_LOADER&&goog.debugLoader_.requested(e),goog.isProvided_(e)){if(goog.isInModuleLoader_())return goog.module.getInternal_(e)}else if(goog.ENABLE_DEBUG_LOADER){var t=goog.moduleLoaderState_;goog.moduleLoaderState_=null;try{goog.debugLoader_.load_(e)}finally{goog.moduleLoaderState_=t}}return null}},goog.requireType=function(e){return{}},goog.basePath="",goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(e){e.instance_=void 0,e.getInstance=function(){return e.instance_?e.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e),e.instance_=new e)}},goog.instantiatedSingletons_=[],goog.LOAD_MODULE_USING_EVAL=!0,goog.SEAL_MODULE_EXPORTS=goog.DEBUG,goog.loadedModules_={},goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER,goog.TRANSPILE="detect",goog.ASSUME_ES_MODULES_TRANSPILED=!1,goog.TRUSTED_TYPES_POLICY_NAME="goog",goog.hasBadLetScoping=null,goog.loadModule=function(e){var t=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:!1,type:goog.ModuleType.GOOG};var r={},n=r;if("function"==typeof e)n=e.call(void 0,n);else{if("string"!=typeof e)throw Error("Invalid module definition");n=goog.loadModuleFromSource_.call(void 0,n,e)}var a=goog.moduleLoaderState_.moduleName;if("string"!=typeof a||!a)throw Error('Invalid module name "'+a+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(a,n,r!==n):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof n&&null!=n&&Object.seal(n),goog.loadedModules_[a]={exports:n,type:goog.ModuleType.GOOG,moduleId:goog.moduleLoaderState_.moduleName}}finally{goog.moduleLoaderState_=t}},goog.loadModuleFromSource_=function(a,b){return eval(goog.CLOSURE_EVAL_PREFILTER_.createScript(b)),a},goog.normalizePath_=function(e){e=e.split("/");for(var t=0;t<e.length;)"."==e[t]?e.splice(t,1):t&&".."==e[t]&&e[t-1]&&".."!=e[t-1]?e.splice(--t,2):t++;return e.join("/")},goog.loadFileSync_=function(e){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(e);try{var t=new goog.global.XMLHttpRequest;return t.open("get",e,!1),t.send(),0==t.status||200==t.status?t.responseText:null}catch(e){return null}},goog.typeOf=function(e){var t=typeof e;return"object"!=t?t:e?Array.isArray(e)?"array":t:"null"},goog.isArrayLike=function(e){var t=goog.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length},goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear},goog.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},goog.getUid=function(e){return Object.prototype.hasOwnProperty.call(e,goog.UID_PROPERTY_)&&e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(e){return!!e[goog.UID_PROPERTY_]},goog.removeUid=function(e){null!==e&&"removeAttribute"in e&&e.removeAttribute(goog.UID_PROPERTY_);try{delete e[goog.UID_PROPERTY_]}catch(e){}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.cloneObject=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if("function"==typeof e.clone)return e.clone();if("undefined"!=typeof Map&&e instanceof Map)return new Map(e);if("undefined"!=typeof Set&&e instanceof Set)return new Set(e);for(var r in t="array"==t?[]:{},e)t[r]=goog.cloneObject(e[r]);return t}return e},goog.bindNative_=function(e,t,r){return e.call.apply(e.bind,arguments)},goog.bindJs_=function(e,t,r){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),e.apply(t,r)}}return function(){return e.apply(t,arguments)}},goog.bind=function(e,t,r){return Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}},goog.now=function(){return Date.now()},goog.globalEval=function(e){(0,eval)(e)},goog.getCssName=function(e,t){if("."==String(e).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+e);var r=function(e){return goog.cssNameMapping_[e]||e},n=function(e){e=e.split("-");for(var t=[],n=0;n<e.length;n++)t.push(r(e[n]));return t.join("-")};return n=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?r:n:function(e){return e},e=t?e+"-"+n(t):n(e),goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(e):e},goog.setCssNameMapping=function(e,t){goog.cssNameMapping_=e,goog.cssNameMappingStyle_=t},!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING),goog.GetMsgOptions=function(){},goog.getMsg=function(e,t,r){return r&&r.html&&(e=e.replace(/</g,"&lt;")),r&&r.unescapeHtmlEntities&&(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&amp;/g,"&")),t&&(e=e.replace(/\{\$([^}]+)}/g,(function(e,r){return null!=t&&r in t?t[r]:e}))),e},goog.getMsgWithFallback=function(e,t){return e},goog.exportSymbol=function(e,t,r){goog.exportPath_(e,t,!0,r)},goog.exportProperty=function(e,t,r){e[t]=r},goog.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.base=function(e,r,n){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[r].apply(e,a)}},goog.scope=function(e){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a module.");e.call(goog.global)},COMPILED||(goog.global.COMPILED=COMPILED),goog.defineClass=function(e,t){var r=t.constructor,n=t.statics;return r&&r!=Object.prototype.constructor||(r=function(){throw Error("cannot instantiate an interface (no constructor defined).")}),r=goog.defineClass.createSealingConstructor_(r,e),e&&goog.inherits(r,e),delete t.constructor,delete t.statics,goog.defineClass.applyProperties_(r.prototype,t),null!=n&&(n instanceof Function?n(r):goog.defineClass.applyProperties_(r,n)),r},goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG,goog.defineClass.createSealingConstructor_=function(e,t){return goog.defineClass.SEAL_CLASS_INSTANCES?function(){var t=e.apply(this,arguments)||this;return t[goog.UID_PROPERTY_]=t[goog.UID_PROPERTY_],t}:e},goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.defineClass.applyProperties_=function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);for(var n=0;n<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;n++)r=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[n],Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},goog.identity_=function(e){return e},goog.createTrustedTypesPolicy=function(e){var t=null,r=goog.global.trustedTypes;if(!r||!r.createPolicy)return t;try{t=r.createPolicy(e,{createHTML:goog.identity_,createScript:goog.identity_,createScriptURL:goog.identity_})}catch(e){goog.logToConsole_(e.message)}return t},!COMPILED&&goog.DEPENDENCIES_ENABLED&&(goog.isEdge_=function(){return!!(goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"").match(/Edge\/(\d+)(\.\d)*/i)},goog.inHtmlDocument_=function(){var e=goog.global.document;return null!=e&&"write"in e},goog.isDocumentLoading_=function(){var e=goog.global.document;return e.attachEvent?"complete"!=e.readyState:"loading"==e.readyState},goog.findBasePath_=function(){if(null!=goog.global.CLOSURE_BASE_PATH&&"string"==typeof goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_()){var e=goog.global.document,t=e.currentScript;for(t=(e=t?[t]:e.getElementsByTagName("SCRIPT")).length-1;0<=t;--t){var r=e[t].src,n=r.lastIndexOf("?");if(n=-1==n?r.length:n,"base.js"==r.slice(n-7,n)){goog.basePath=r.slice(0,n-7);break}}}},goog.findBasePath_(),goog.protectScriptTag_=function(e){return e.replace(/<\/(SCRIPT)/gi,"\\x3c/$1")},goog.DebugLoader_=function(){this.dependencies_={},this.idToPath_={},this.written_={},this.loadingDeps_=[],this.depsToLoad_=[],this.paused_=!1,this.factory_=new goog.DependencyFactory,this.deferredCallbacks_={},this.deferredQueue_=[]},goog.DebugLoader_.prototype.bootstrap=function(e,t){function r(){n&&(goog.global.setTimeout(n,0),n=null)}var n=t;if(e.length){t=[];for(var a=0;a<e.length;a++){var i=this.getPathFromDeps_(e[a]);if(!i)throw Error("Unregonized namespace: "+e[a]);t.push(this.dependencies_[i])}i=goog.require;var o=0;for(a=0;a<e.length;a++)i(e[a]),t[a].onLoad((function(){++o==e.length&&r()}))}else r()},goog.DebugLoader_.prototype.loadClosureDeps=function(){this.depsToLoad_.push(this.factory_.createDependency(goog.normalizePath_(goog.basePath+"deps.js"),"deps.js",[],[],{})),this.loadDeps_()},goog.DebugLoader_.prototype.requested=function(e,t){(e=this.getPathFromDeps_(e))&&(t||this.areDepsLoaded_(this.dependencies_[e].requires))&&(t=this.deferredCallbacks_[e])&&(delete this.deferredCallbacks_[e],t())},goog.DebugLoader_.prototype.setDependencyFactory=function(e){this.factory_=e},goog.DebugLoader_.prototype.load_=function(e){if(this.getPathFromDeps_(e)){var t=this,r=[],n=function(e){var a=t.getPathFromDeps_(e);if(!a)throw Error("Bad dependency path or symbol: "+e);if(!t.written_[a]){for(t.written_[a]=!0,e=t.dependencies_[a],a=0;a<e.requires.length;a++)goog.isProvided_(e.requires[a])||n(e.requires[a]);r.push(e)}};n(e),e=!!this.depsToLoad_.length,this.depsToLoad_=this.depsToLoad_.concat(r),this.paused_||e||this.loadDeps_()}else goog.logToConsole_("goog.require could not find: "+e)},goog.DebugLoader_.prototype.loadDeps_=function(){for(var e=this,t=this.paused_;this.depsToLoad_.length&&!t;)!function(){var r=!1,n=e.depsToLoad_.shift(),a=!1;e.loading_(n);var i={pause:function(){if(r)throw Error("Cannot call pause after the call to load.");t=!0},resume:function(){r?e.resume_():t=!1},loaded:function(){if(a)throw Error("Double call to loaded.");a=!0,e.loaded_(n)},pending:function(){for(var t=[],r=0;r<e.loadingDeps_.length;r++)t.push(e.loadingDeps_[r]);return t},setModuleState:function(e){goog.moduleLoaderState_={type:e,moduleName:"",declareLegacyNamespace:!1}},registerEs6ModuleExports:function(e,t,r){r&&(goog.loadedModules_[r]={exports:t,type:goog.ModuleType.ES6,moduleId:r||""})},registerGoogModuleExports:function(e,t){goog.loadedModules_[e]={exports:t,type:goog.ModuleType.GOOG,moduleId:e}},clearModuleState:function(){goog.moduleLoaderState_=null},defer:function(t){if(r)throw Error("Cannot register with defer after the call to load.");e.defer_(n,t)},areDepsLoaded:function(){return e.areDepsLoaded_(n.requires)}};try{n.load(i)}finally{r=!0}}();t&&this.pause_()},goog.DebugLoader_.prototype.pause_=function(){this.paused_=!0},goog.DebugLoader_.prototype.resume_=function(){this.paused_&&(this.paused_=!1,this.loadDeps_())},goog.DebugLoader_.prototype.loading_=function(e){this.loadingDeps_.push(e)},goog.DebugLoader_.prototype.loaded_=function(e){for(var t=0;t<this.loadingDeps_.length;t++)if(this.loadingDeps_[t]==e){this.loadingDeps_.splice(t,1);break}for(t=0;t<this.deferredQueue_.length;t++)if(this.deferredQueue_[t]==e.path){this.deferredQueue_.splice(t,1);break}if(this.loadingDeps_.length==this.deferredQueue_.length&&!this.depsToLoad_.length)for(;this.deferredQueue_.length;)this.requested(this.deferredQueue_.shift(),!0);e.loaded()},goog.DebugLoader_.prototype.areDepsLoaded_=function(e){for(var t=0;t<e.length;t++){var r=this.getPathFromDeps_(e[t]);if(!r||!(r in this.deferredCallbacks_)&&!goog.isProvided_(e[t]))return!1}return!0},goog.DebugLoader_.prototype.getPathFromDeps_=function(e){return e in this.idToPath_?this.idToPath_[e]:e in this.dependencies_?e:null},goog.DebugLoader_.prototype.defer_=function(e,t){this.deferredCallbacks_[e.path]=t,this.deferredQueue_.push(e.path)},goog.LoadController=function(){},goog.LoadController.prototype.pause=function(){},goog.LoadController.prototype.resume=function(){},goog.LoadController.prototype.loaded=function(){},goog.LoadController.prototype.pending=function(){},goog.LoadController.prototype.registerEs6ModuleExports=function(e,t,r){},goog.LoadController.prototype.setModuleState=function(e){},goog.LoadController.prototype.clearModuleState=function(){},goog.LoadController.prototype.defer=function(e){},goog.LoadController.prototype.areDepsLoaded=function(){},goog.Dependency=function(e,t,r,n,a){this.path=e,this.relativePath=t,this.provides=r,this.requires=n,this.loadFlags=a,this.loaded_=!1,this.loadCallbacks_=[]},goog.Dependency.prototype.getPathName=function(){var e=this.path,t=e.indexOf("://");return 0<=t&&(0<=(t=(e=e.substring(t+3)).indexOf("/"))&&(e=e.substring(t+1))),e},goog.Dependency.prototype.onLoad=function(e){this.loaded_?e():this.loadCallbacks_.push(e)},goog.Dependency.prototype.loaded=function(){this.loaded_=!0;var e=this.loadCallbacks_;this.loadCallbacks_=[];for(var t=0;t<e.length;t++)e[t]()},goog.Dependency.defer_=!1,goog.Dependency.callbackMap_={},goog.Dependency.registerCallback_=function(e){var t=Math.random().toString(32);return goog.Dependency.callbackMap_[t]=e,t},goog.Dependency.unregisterCallback_=function(e){delete goog.Dependency.callbackMap_[e]},goog.Dependency.callback_=function(e,t){if(!(e in goog.Dependency.callbackMap_))throw Error("Callback key "+e+" does not exist (was base.js loaded more than once?).");for(var r=goog.Dependency.callbackMap_[e],n=[],a=1;a<arguments.length;a++)n.push(arguments[a]);r.apply(void 0,n)},goog.Dependency.prototype.load=function(e){if(goog.global.CLOSURE_IMPORT_SCRIPT)goog.global.CLOSURE_IMPORT_SCRIPT(this.path)?e.loaded():e.pause();else if(goog.inHtmlDocument_()){var t=goog.global.document;if("complete"==t.readyState&&!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING){if(/\bdeps.js$/.test(this.path))return void e.loaded();throw Error('Cannot write "'+this.path+'" after document load')}var r=goog.getScriptNonce_();if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&goog.isDocumentLoading_()){var n=function(t){t.readyState&&"complete"!=t.readyState?t.onload=n:(goog.Dependency.unregisterCallback_(a),e.loaded())},a=goog.Dependency.registerCallback_(n);r=r?' nonce="'+r+'"':"";var i='<script src="'+this.path+'"'+r+(goog.Dependency.defer_?" defer":"")+' id="script-'+a+'"><\/script>';i+="<script"+r+">",i=goog.Dependency.defer_?i+"document.getElementById('script-"+a+"').onload = function() {\n  goog.Dependency.callback_('"+a+"', this);\n};\n":i+"goog.Dependency.callback_('"+a+"', document.getElementById('script-"+a+"'));",i+="<\/script>",t.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(i):i)}else{var o=t.createElement("script");o.defer=goog.Dependency.defer_,o.async=!1,r&&(o.nonce=r),o.onload=function(){o.onload=null,e.loaded()},o.src=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScriptURL(this.path):this.path,t.head.appendChild(o)}}else goog.logToConsole_("Cannot use default debug loader outside of HTML documents."),"deps.js"==this.relativePath?(goog.logToConsole_("Consider setting CLOSURE_IMPORT_SCRIPT before loading base.js, or setting CLOSURE_NO_DEPS to true."),e.loaded()):e.pause()},goog.Es6ModuleDependency=function(e,t,r,n,a){goog.Dependency.call(this,e,t,r,n,a)},goog.inherits(goog.Es6ModuleDependency,goog.Dependency),goog.Es6ModuleDependency.prototype.load=function(e){if(goog.global.CLOSURE_IMPORT_SCRIPT)goog.global.CLOSURE_IMPORT_SCRIPT(this.path)?e.loaded():e.pause();else if(goog.inHtmlDocument_()){var t=goog.global.document,r=this;if(goog.isDocumentLoading_()){var n=function(e,r){var n="",a=goog.getScriptNonce_();a&&(n=' nonce="'+a+'"'),e=r?'<script type="module" crossorigin'+n+">"+r+"<\/script>":'<script type="module" crossorigin src="'+e+'"'+n+"><\/script>",t.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(e):e)};goog.Dependency.defer_=!0}else n=function(e,r){var n=t.createElement("script");n.defer=!0,n.async=!1,n.type="module",n.setAttribute("crossorigin",!0);var a=goog.getScriptNonce_();a&&(n.nonce=a),r?n.text=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScript(r):r:n.src=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScriptURL(e):e,t.head.appendChild(n)};var a=goog.Dependency.registerCallback_((function(){goog.Dependency.unregisterCallback_(a),e.setModuleState(goog.ModuleType.ES6)}));n(void 0,'goog.Dependency.callback_("'+a+'")'),n(this.path,void 0);var i=goog.Dependency.registerCallback_((function(t){goog.Dependency.unregisterCallback_(i),e.registerEs6ModuleExports(r.path,t,goog.moduleLoaderState_.moduleName)}));n(void 0,'import * as m from "'+this.path+'"; goog.Dependency.callback_("'+i+'", m)');var o=goog.Dependency.registerCallback_((function(){goog.Dependency.unregisterCallback_(o),e.clearModuleState(),e.loaded()}));n(void 0,'goog.Dependency.callback_("'+o+'")')}else goog.logToConsole_("Cannot use default debug loader outside of HTML documents."),e.pause()},goog.TransformedDependency=function(e,t,r,n,a){goog.Dependency.call(this,e,t,r,n,a),this.contents_=null,this.lazyFetch_=!goog.inHtmlDocument_()||!("noModule"in goog.global.document.createElement("script"))},goog.inherits(goog.TransformedDependency,goog.Dependency),goog.TransformedDependency.prototype.load=function(e){function t(){o.contents_=goog.loadFileSync_(o.path),o.contents_&&(o.contents_=o.transform(o.contents_),o.contents_&&(o.contents_+="\n//# sourceURL="+o.path))}function r(){if(o.lazyFetch_&&t(),o.contents_){s&&e.setModuleState(goog.ModuleType.ES6);try{var r=o.contents_;if(o.contents_=null,goog.globalEval(goog.CLOSURE_EVAL_PREFILTER_.createScript(r)),s)var n=goog.moduleLoaderState_.moduleName}finally{s&&e.clearModuleState()}s&&goog.global.$jscomp.require.ensure([o.getPathName()],(function(){e.registerEs6ModuleExports(o.path,goog.global.$jscomp.require(o.getPathName()),n)})),e.loaded()}}var n,a,i,o=this;if(goog.global.CLOSURE_IMPORT_SCRIPT)t(),this.contents_&&goog.global.CLOSURE_IMPORT_SCRIPT("",this.contents_)?(this.contents_=null,e.loaded()):e.pause();else{var s=this.loadFlags.module==goog.ModuleType.ES6;this.lazyFetch_||t();var l=1<e.pending().length;if(goog.Dependency.defer_&&(l||goog.isDocumentLoading_()))e.defer((function(){r()}));else{var u=goog.global.document;if(l=goog.inHtmlDocument_()&&("ActiveXObject"in goog.global||goog.isEdge_()),s&&goog.inHtmlDocument_()&&goog.isDocumentLoading_()&&!l){goog.Dependency.defer_=!0,e.pause();var c=u.onreadystatechange;u.onreadystatechange=function(){"interactive"==u.readyState&&(u.onreadystatechange=c,r(),e.resume()),"function"==typeof c&&c.apply(void 0,arguments)}}else goog.inHtmlDocument_()&&goog.isDocumentLoading_()?(n=goog.global.document,a=goog.Dependency.registerCallback_((function(){goog.Dependency.unregisterCallback_(a),r()})),i="<script"+((i=goog.getScriptNonce_())?' nonce="'+i+'"':"")+">"+goog.protectScriptTag_('goog.Dependency.callback_("'+a+'");')+"<\/script>",n.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(i):i)):r()}}},goog.TransformedDependency.prototype.transform=function(e){},goog.PreTranspiledEs6ModuleDependency=function(e,t,r,n,a){goog.TransformedDependency.call(this,e,t,r,n,a)},goog.inherits(goog.PreTranspiledEs6ModuleDependency,goog.TransformedDependency),goog.PreTranspiledEs6ModuleDependency.prototype.transform=function(e){return e},goog.GoogModuleDependency=function(e,t,r,n,a){goog.TransformedDependency.call(this,e,t,r,n,a)},goog.inherits(goog.GoogModuleDependency,goog.TransformedDependency),goog.GoogModuleDependency.prototype.transform=function(e){return goog.LOAD_MODULE_USING_EVAL&&void 0!==goog.global.JSON?"goog.loadModule("+goog.global.JSON.stringify(e+"\n//# sourceURL="+this.path+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+e+"\n;return exports});\n//# sourceURL="+this.path+"\n"},goog.DebugLoader_.prototype.addDependency=function(e,t,r,n){t=t||[],e=e.replace(/\\/g,"/");var a=goog.normalizePath_(goog.basePath+e);for(n&&"boolean"!=typeof n||(n=n?{module:goog.ModuleType.GOOG}:{}),r=this.factory_.createDependency(a,e,t,r,n),this.dependencies_[a]=r,r=0;r<t.length;r++)this.idToPath_[t[r]]=a;this.idToPath_[e]=a},goog.DependencyFactory=function(){},goog.DependencyFactory.prototype.createDependency=function(e,t,r,n,a){return a.module==goog.ModuleType.GOOG?new goog.GoogModuleDependency(e,t,r,n,a):a.module==goog.ModuleType.ES6?goog.ASSUME_ES_MODULES_TRANSPILED?new goog.PreTranspiledEs6ModuleDependency(e,t,r,n,a):new goog.Es6ModuleDependency(e,t,r,n,a):new goog.Dependency(e,t,r,n,a)},goog.debugLoader_=new goog.DebugLoader_,goog.loadClosureDeps=function(){goog.debugLoader_.loadClosureDeps()},goog.setDependencyFactory=function(e){goog.debugLoader_.setDependencyFactory(e)},goog.TRUSTED_TYPES_POLICY_=goog.TRUSTED_TYPES_POLICY_NAME?goog.createTrustedTypesPolicy(goog.TRUSTED_TYPES_POLICY_NAME+"#base"):null,goog.global.CLOSURE_NO_DEPS||goog.debugLoader_.loadClosureDeps(),goog.bootstrap=function(e,t){goog.debugLoader_.bootstrap(e,t)}),!COMPILED){var isChrome87=!1;try{isChrome87=eval(goog.global.trustedTypes.emptyScript)!==goog.global.trustedTypes.emptyScript}catch(e){}goog.CLOSURE_EVAL_PREFILTER_=goog.global.trustedTypes&&isChrome87&&goog.createTrustedTypesPolicy("goog#base#devonly#eval")||{createScript:goog.identity_}}goog.asserts=function(){},goog.asserts.assert=function(e,t){},goog.asserts.ENABLE_ASSERTS=!0,goog.asserts.ENABLE_ASSERTS&&console.assert&&console.assert.bind&&(goog.asserts.assert=console.assert.bind(console));var shaka={abr:{}};if(shaka.abr.Ewma=function(e){goog.asserts.assert(0<e,"expected halfLife to be positive"),this.alpha_=Math.exp(Math.log(.5)/e),this.totalWeight_=this.estimate_=0},shaka.abr.Ewma.prototype.updateAlpha=function(e){goog.asserts.assert(0<e,"expected halfLife to be positive"),this.alpha_=Math.exp(Math.log(.5)/e)},shaka.abr.Ewma.prototype.sample=function(e,t){var r=Math.pow(this.alpha_,e);t=t*(1-r)+r*this.estimate_,isNaN(t)||(this.estimate_=t,this.totalWeight_+=e)},shaka.abr.Ewma.prototype.getEstimate=function(){return this.estimate_/(1-Math.pow(this.alpha_,this.totalWeight_))},shaka.abr.EwmaBandwidthEstimator=function(){this.fast_=new shaka.abr.Ewma(2),this.slow_=new shaka.abr.Ewma(5),this.bytesSampled_=0,this.minTotalBytes_=128e3,this.minBytes_=16e3},shaka.abr.EwmaBandwidthEstimator.prototype.configure=function(e){this.minTotalBytes_=e.minTotalBytes,this.minBytes_=e.minBytes,this.fast_.updateAlpha(e.fastHalfLife),this.slow_.updateAlpha(e.slowHalfLife)},shaka.abr.EwmaBandwidthEstimator.prototype.sample=function(e,t){if(!(t<this.minBytes_)){var r=8e3*t/e;e/=1e3,this.bytesSampled_+=t,this.fast_.sample(e,r),this.slow_.sample(e,r)}},shaka.abr.EwmaBandwidthEstimator.prototype.getBandwidthEstimate=function(e){return this.bytesSampled_<this.minTotalBytes_?e:Math.min(this.fast_.getEstimate(),this.slow_.getEstimate())},shaka.abr.EwmaBandwidthEstimator.prototype.hasGoodEstimate=function(){return this.bytesSampled_>=this.minTotalBytes_},shaka.log=function(){},shaka.log.alwaysError=function(){},shaka.log.alwaysWarn=function(){},shaka.log.warnOnce=function(e){var t=$jscomp.getRestArguments.apply(1,arguments);shaka.log.oneTimeWarningIssued_.has(e)||(shaka.log.oneTimeWarningIssued_.add(e),shaka.log.alwaysWarn.apply(shaka.log,$jscomp.arrayFromIterable(t)))},shaka.log.error=function(){},shaka.log.warning=function(){},shaka.log.info=function(){},shaka.log.debug=function(){},shaka.log.v1=function(){},shaka.log.v2=function(){},shaka.log.Level={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4,V1:5,V2:6},shaka.log.MAX_LOG_LEVEL=4,shaka.log.oneTimeWarningIssued_=new Set,window.console){var $jscomp$compprop0={};shaka.log.logMap_=($jscomp$compprop0[shaka.log.Level.ERROR]=function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.error.apply(console,$jscomp.arrayFromIterable(e))},$jscomp$compprop0[shaka.log.Level.WARNING]=function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.warn.apply(console,$jscomp.arrayFromIterable(e))},$jscomp$compprop0[shaka.log.Level.INFO]=function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.info.apply(console,$jscomp.arrayFromIterable(e))},$jscomp$compprop0[shaka.log.Level.DEBUG]=function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.log.apply(console,$jscomp.arrayFromIterable(e))},$jscomp$compprop0[shaka.log.Level.V1]=function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.debug.apply(console,$jscomp.arrayFromIterable(e))},$jscomp$compprop0[shaka.log.Level.V2]=function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.debug.apply(console,$jscomp.arrayFromIterable(e))},$jscomp$compprop0),shaka.log.alwaysWarn=function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.warn.apply(console,$jscomp.arrayFromIterable(e))},shaka.log.alwaysError=function(){var e=$jscomp.getRestArguments.apply(0,arguments);return console.error.apply(console,$jscomp.arrayFromIterable(e))},goog.DEBUG?(goog.exportSymbol("shaka.log",shaka.log),shaka.log.setLevel=function(e){var t=function(t){return t<=e?(goog.asserts.assert(shaka.log.logMap_[t],"Unexpected log level"),shaka.log.logMap_[t]):function(){}};shaka.log.currentLevel=e,shaka.log.error=t(shaka.log.Level.ERROR),shaka.log.warning=t(shaka.log.Level.WARNING),shaka.log.info=t(shaka.log.Level.INFO),shaka.log.debug=t(shaka.log.Level.DEBUG),shaka.log.v1=t(shaka.log.Level.V1),shaka.log.v2=t(shaka.log.Level.V2)},shaka.log.setLevel(shaka.log.MAX_LOG_LEVEL)):(shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.ERROR&&(shaka.log.error=shaka.log.logMap_[shaka.log.Level.ERROR]),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.WARNING&&(shaka.log.warning=shaka.log.logMap_[shaka.log.Level.WARNING]),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.INFO&&(shaka.log.info=shaka.log.logMap_[shaka.log.Level.INFO]),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.DEBUG&&(shaka.log.debug=shaka.log.logMap_[shaka.log.Level.DEBUG]),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.V1&&(shaka.log.v1=shaka.log.logMap_[shaka.log.Level.V1]),shaka.log.MAX_LOG_LEVEL>=shaka.log.Level.V2&&(shaka.log.v2=shaka.log.logMap_[shaka.log.Level.V2]))}shaka.util={},shaka.util.IReleasable=function(){},shaka.util.IReleasable.prototype.release=function(){},shaka.util.MultiMap=function(){this.map_={}},shaka.util.MultiMap.prototype.push=function(e,t){this.map_.hasOwnProperty(e)?this.map_[e].push(t):this.map_[e]=[t]},shaka.util.MultiMap.prototype.get=function(e){return(e=this.map_[e])?e.slice():null},shaka.util.MultiMap.prototype.getAll=function(){var e,t=[];for(e in this.map_)t.push.apply(t,$jscomp.arrayFromIterable(this.map_[e]));return t},shaka.util.MultiMap.prototype.remove=function(e,t){e in this.map_&&(this.map_[e]=this.map_[e].filter((function(e){return e!=t})),0==this.map_[e].length&&delete this.map_[e])},shaka.util.MultiMap.prototype.clear=function(){this.map_={}},shaka.util.MultiMap.prototype.forEach=function(e){for(var t in this.map_)e(t,this.map_[t])},shaka.util.MultiMap.prototype.size=function(){return Object.keys(this.map_).length},shaka.util.MultiMap.prototype.keys=function(){return Object.keys(this.map_)},shaka.util.EventManager=function(){this.bindingMap_=new shaka.util.MultiMap},shaka.util.EventManager.prototype.release=function(){this.removeAll(),this.bindingMap_=null},shaka.util.EventManager.prototype.listen=function(e,t,r,n){this.bindingMap_&&(e=new shaka.util.EventManager.Binding_(e,t,r,n),this.bindingMap_.push(t,e))},shaka.util.EventManager.prototype.listenOnce=function(e,t,r,n){var a=this,i=function(n){a.unlisten(e,t,i),r(n)};this.listen(e,t,i,n)},shaka.util.EventManager.prototype.unlisten=function(e,t,r){if(this.bindingMap_)for(var n=this.bindingMap_.get(t)||[],a=(n=$jscomp.makeIterator(n)).next();!a.done;a=n.next())(a=a.value).target!=e||r!=a.listener&&r||(a.unlisten(),this.bindingMap_.remove(t,a))},shaka.util.EventManager.prototype.removeAll=function(){if(this.bindingMap_){for(var e=this.bindingMap_.getAll(),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())t.value.unlisten();this.bindingMap_.clear()}},goog.exportSymbol("shaka.util.EventManager",shaka.util.EventManager),goog.exportProperty(shaka.util.EventManager.prototype,"removeAll",shaka.util.EventManager.prototype.removeAll),goog.exportProperty(shaka.util.EventManager.prototype,"unlisten",shaka.util.EventManager.prototype.unlisten),goog.exportProperty(shaka.util.EventManager.prototype,"listenOnce",shaka.util.EventManager.prototype.listenOnce),goog.exportProperty(shaka.util.EventManager.prototype,"listen",shaka.util.EventManager.prototype.listen),goog.exportProperty(shaka.util.EventManager.prototype,"release",shaka.util.EventManager.prototype.release),shaka.util.EventManager.Binding_=function(e,t,r,n){this.target=e,this.type=t,this.listener=r,this.options=shaka.util.EventManager.Binding_.convertOptions_(e,n),this.target.addEventListener(t,r,this.options)},shaka.util.EventManager.Binding_.prototype.unlisten=function(){goog.asserts.assert(this.target,"Missing target"),this.target.removeEventListener(this.type,this.listener,this.options),this.listener=this.target=null,this.options=!1},shaka.util.EventManager.Binding_.convertOptions_=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var r=new Set(["passive","capture"]),n=Object.keys(t).filter((function(e){return!r.has(e)}));return goog.asserts.assert(0==n.length,"Unsupported flag(s) to addEventListener: "+n.join(",")),shaka.util.EventManager.Binding_.doesSupportObject_(e)?t:t.capture||!1},shaka.util.EventManager.Binding_.doesSupportObject_=function(e){var t=shaka.util.EventManager.Binding_.supportsObject_;if(null==t){t=!1;try{var r={},n={get:function(){return t=!0,!1}};Object.defineProperty(r,"passive",n),Object.defineProperty(r,"capture",n),n=function(){},e.addEventListener("test",n,r),e.removeEventListener("test",n,r)}catch(e){t=!1}shaka.util.EventManager.Binding_.supportsObject_=t}return t||!1},shaka.util.EventManager.Binding_.supportsObject_=void 0,shaka.media={},shaka.media.Capabilities=function(){},shaka.media.Capabilities.isTypeSupported=function(e){var t=shaka.media.Capabilities.MediaSourceTypeSupportMap;if(t.has(e))return t.get(e);if(window.ManagedMediaSource){var r=ManagedMediaSource.isTypeSupported(e);return t.set(e,r),r}return!!window.MediaSource&&(r=MediaSource.isTypeSupported(e),t.set(e,r),r)},shaka.media.Capabilities.isChangeTypeSupported=function(){return!!window.SourceBuffer&&!!SourceBuffer.prototype&&!!SourceBuffer.prototype.changeType},shaka.media.Capabilities.MediaSourceTypeSupportMap=new Map,shaka.deprecate={},shaka.deprecate.Version=function(e,t){this.major_=e,this.minor_=t},shaka.deprecate.Version.prototype.major=function(){return this.major_},shaka.deprecate.Version.prototype.minor=function(){return this.minor_},shaka.deprecate.Version.prototype.compareTo=function(e){var t=this.minor_-e.minor_;return this.major_-e.major_||t},shaka.deprecate.Version.prototype.toString=function(){return"v"+this.major_+"."+this.minor_},shaka.deprecate.Version.parse=function(e){return e=e.substring(1).split(".",2),new shaka.deprecate.Version(Number(e[0]),Number(e[1]))},shaka.deprecate.Enforcer=function(e,t,r){this.libraryVersion_=e,this.onPending_=t,this.onExpired_=r},shaka.deprecate.Enforcer.prototype.enforce=function(e,t,r){(0<e.compareTo(this.libraryVersion_)?this.onPending_:this.onExpired_)(this.libraryVersion_,e,t,r)},shaka.Deprecate=function(){},shaka.Deprecate.init=function(e){goog.asserts.assert(null==shaka.Deprecate.enforcer_,"Deprecate.init should only be called once."),shaka.Deprecate.enforcer_=new shaka.deprecate.Enforcer(shaka.deprecate.Version.parse(e),shaka.Deprecate.onPending_,shaka.Deprecate.onExpired_)},shaka.Deprecate.deprecateFeature=function(e,t,r){var n=shaka.Deprecate.enforcer_;goog.asserts.assert(n,"Missing deprecation enforcer. Was |init| called?"),e=new shaka.deprecate.Version(e,0),n.enforce(e,t,r)},shaka.Deprecate.onPending_=function(e,t,r,n){shaka.log.alwaysWarn([r,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",n].join(" "))},shaka.Deprecate.onExpired_=function(e,t,r,n){e=[r,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",n].join(" "),shaka.log.alwaysError(e),goog.asserts.assert(!1,e)},shaka.Deprecate.enforcer_=null,shaka.cea={},shaka.cea.DummyCaptionDecoder=function(){},shaka.cea.DummyCaptionDecoder.prototype.extract=function(e,t){},shaka.cea.DummyCaptionDecoder.prototype.decode=function(){return[]},shaka.cea.DummyCaptionDecoder.prototype.clear=function(){},shaka.cea.DummyCaptionDecoder.prototype.getStreams=function(){return[]},shaka.cea.DummyCeaParser=function(){},shaka.cea.DummyCeaParser.prototype.init=function(e){},shaka.cea.DummyCeaParser.prototype.parse=function(e){return[]},shaka.util.BufferUtils=function(){},shaka.util.BufferUtils.equal=function(e,t){var r=shaka.util.BufferUtils;if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if(r.unsafeGetArrayBuffer_(e)==r.unsafeGetArrayBuffer_(t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;r=shaka.util.BufferUtils.toUint8(e),t=shaka.util.BufferUtils.toUint8(t);for(var n=0;n<e.byteLength;n++)if(r[n]!=t[n])return!1;return!0},shaka.util.BufferUtils.unsafeGetArrayBuffer_=function(e){return e instanceof ArrayBuffer?e:e.buffer},shaka.util.BufferUtils.toArrayBuffer=function(e){return e instanceof ArrayBuffer?e:0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer},shaka.util.BufferUtils.toUint8=function(e,t,r){return r=void 0===r?1/0:r,shaka.util.BufferUtils.view_(e,void 0===t?0:t,r,Uint8Array)},shaka.util.BufferUtils.toUint16=function(e,t,r){return r=void 0===r?1/0:r,shaka.util.BufferUtils.view_(e,void 0===t?0:t,r,Uint16Array)},shaka.util.BufferUtils.toDataView=function(e,t,r){return r=void 0===r?1/0:r,shaka.util.BufferUtils.view_(e,void 0===t?0:t,r,DataView)},shaka.util.BufferUtils.view_=function(e,t,r,n){var a=shaka.util.BufferUtils.unsafeGetArrayBuffer_(e),i=1;"BYTES_PER_ELEMENT"in n&&(i=n.BYTES_PER_ELEMENT);var o=((e.byteOffset||0)+e.byteLength)/i;return new n(a,e=Math.floor(Math.max(0,Math.min(((e.byteOffset||0)+t)/i,o))),Math.floor(Math.min(e+Math.max(r,0),o))-e)},goog.exportSymbol("shaka.util.BufferUtils",shaka.util.BufferUtils),goog.exportProperty(shaka.util.BufferUtils,"toDataView",shaka.util.BufferUtils.toDataView),goog.exportProperty(shaka.util.BufferUtils,"toUint16",shaka.util.BufferUtils.toUint16),goog.exportProperty(shaka.util.BufferUtils,"toUint8",shaka.util.BufferUtils.toUint8),goog.exportProperty(shaka.util.BufferUtils,"toArrayBuffer",shaka.util.BufferUtils.toArrayBuffer),goog.exportProperty(shaka.util.BufferUtils,"equal",shaka.util.BufferUtils.equal),shaka.media.IClosedCaptionParser=function(){},shaka.media.IClosedCaptionParser.prototype.init=function(e,t){},shaka.media.IClosedCaptionParser.prototype.parseFrom=function(e){},shaka.media.IClosedCaptionParser.prototype.reset=function(){},shaka.media.IClosedCaptionParser.prototype.getStreams=function(){},goog.exportSymbol("shaka.media.IClosedCaptionParser",shaka.media.IClosedCaptionParser),shaka.media.ClosedCaptionParser=function(e){this.ceaParser_=new shaka.cea.DummyCeaParser,(e=shaka.media.ClosedCaptionParser.findParser(e.toLowerCase()))&&(this.ceaParser_=e()),this.ceaDecoder_=new shaka.cea.DummyCaptionDecoder,(e=shaka.media.ClosedCaptionParser.findDecoder())&&(this.ceaDecoder_=e())},shaka.media.ClosedCaptionParser.prototype.init=function(e,t){t=void 0!==t&&t,shaka.log.debug("Passing new init segment to CEA parser"),t||(this.reset(),this.ceaParser_.init(e))},shaka.media.ClosedCaptionParser.prototype.parseFrom=function(e){e=this.ceaParser_.parse(e);for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){t=t.value;var r=shaka.util.BufferUtils.toUint8(t.packet);0<r.length&&this.ceaDecoder_.extract(r,t.pts)}return this.ceaDecoder_.decode()},shaka.media.ClosedCaptionParser.prototype.reset=function(){this.ceaDecoder_.clear()},shaka.media.ClosedCaptionParser.prototype.getStreams=function(){return this.ceaDecoder_.getStreams()},shaka.media.ClosedCaptionParser.registerParser=function(e,t){shaka.media.ClosedCaptionParser.parserMap_[e]=t},shaka.media.ClosedCaptionParser.unregisterParser=function(e){delete shaka.media.ClosedCaptionParser.parserMap_[e]},shaka.media.ClosedCaptionParser.findParser=function(e){return shaka.media.ClosedCaptionParser.parserMap_[e]},shaka.media.ClosedCaptionParser.registerDecoder=function(e){shaka.media.ClosedCaptionParser.decoderFactory_=e},shaka.media.ClosedCaptionParser.unregisterDecoder=function(){shaka.media.ClosedCaptionParser.decoderFactory_=null},shaka.media.ClosedCaptionParser.findDecoder=function(){return shaka.media.ClosedCaptionParser.decoderFactory_},goog.exportSymbol("shaka.media.ClosedCaptionParser",shaka.media.ClosedCaptionParser),goog.exportProperty(shaka.media.ClosedCaptionParser,"findDecoder",shaka.media.ClosedCaptionParser.findDecoder),goog.exportProperty(shaka.media.ClosedCaptionParser,"unregisterDecoder",shaka.media.ClosedCaptionParser.unregisterDecoder),goog.exportProperty(shaka.media.ClosedCaptionParser,"registerDecoder",shaka.media.ClosedCaptionParser.registerDecoder),goog.exportProperty(shaka.media.ClosedCaptionParser,"findParser",shaka.media.ClosedCaptionParser.findParser),goog.exportProperty(shaka.media.ClosedCaptionParser,"unregisterParser",shaka.media.ClosedCaptionParser.unregisterParser),goog.exportProperty(shaka.media.ClosedCaptionParser,"registerParser",shaka.media.ClosedCaptionParser.registerParser),shaka.media.ClosedCaptionParser.parserMap_={},shaka.media.ClosedCaptionParser.decoderFactory_=null,shaka.util.ArrayUtils=function(){},shaka.util.ArrayUtils.defaultEquals=function(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t},shaka.util.ArrayUtils.remove=function(e,t){-1<(t=e.indexOf(t))&&e.splice(t,1)},shaka.util.ArrayUtils.count=function(e,t){for(var r=0,n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())r+=t(n.value)?1:0;return r},shaka.util.ArrayUtils.hasSameElements=function(e,t,r){if(r||(r=shaka.util.ArrayUtils.defaultEquals),e.length!=t.length)return!1;t=t.slice();for(var n={},a=(e=$jscomp.makeIterator(e)).next();!a.done;n={$jscomp$loop$prop$item$849:n.$jscomp$loop$prop$item$849},a=e.next()){if(n.$jscomp$loop$prop$item$849=a.value,-1==(a=t.findIndex(function(e){return function(t){return r(e.$jscomp$loop$prop$item$849,t)}}(n))))return!1;t[a]=t[t.length-1],t.pop()}return 0==t.length},shaka.util.ArrayUtils.equal=function(e,t,r){if(r||(r=shaka.util.ArrayUtils.defaultEquals),e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1;return!0},shaka.text={},shaka.text.Cue=function(e,t,r){var n=shaka.text.Cue;this.startTime=e,this.endTime=t,this.payload=r,this.region=new shaka.text.CueRegion,this.position=null,this.positionAlign=n.positionAlign.AUTO,this.size=0,this.textAlign=n.textAlign.CENTER,this.direction=n.direction.HORIZONTAL_LEFT_TO_RIGHT,this.writingMode=n.writingMode.HORIZONTAL_TOP_TO_BOTTOM,this.lineInterpretation=n.lineInterpretation.LINE_NUMBER,this.line=null,this.lineHeight="",this.lineAlign=n.lineAlign.START,this.displayAlign=n.displayAlign.AFTER,this.fontSize=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=n.fontWeight.NORMAL,this.fontStyle=n.fontStyle.NORMAL,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textCombineUpright="",this.textDecoration=[],this.textStrokeWidth=this.textStrokeColor=this.textShadow="",this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.rubyTag=null,this.cellResolution={columns:32,rows:15}},shaka.text.Cue.lineBreak=function(e,t){return(e=new shaka.text.Cue(e,t,"")).lineBreak=!0,e},shaka.text.Cue.prototype.clone=function(){var e,t=new shaka.text.Cue(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t},shaka.text.Cue.equal=function(e,t){if(e.startTime!=t.startTime||e.endTime!=t.endTime||e.payload!=t.payload)return!1;for(var r in e)if("startTime"!=r&&"endTime"!=r&&"payload"!=r)if("nestedCues"==r){if(!shaka.util.ArrayUtils.equal(e.nestedCues,t.nestedCues,shaka.text.Cue.equal))return!1}else if("region"==r||"cellResolution"==r){for(var n in e[r])if(e[r][n]!=t[r][n])return!1}else if(Array.isArray(e[r])){if(!shaka.util.ArrayUtils.equal(e[r],t[r]))return!1}else if(e[r]!=t[r])return!1;return!0},goog.exportSymbol("shaka.text.Cue",shaka.text.Cue),goog.exportProperty(shaka.text.Cue,"equal",shaka.text.Cue.equal),goog.exportProperty(shaka.text.Cue.prototype,"clone",shaka.text.Cue.prototype.clone),shaka.text.Cue.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:"auto"},goog.exportProperty(shaka.text.Cue,"positionAlign",shaka.text.Cue.positionAlign),shaka.text.Cue.textAlign={LEFT:"left",RIGHT:"right",CENTER:"center",START:"start",END:"end"},goog.exportProperty(shaka.text.Cue,"textAlign",shaka.text.Cue.textAlign),shaka.text.Cue.displayAlign={BEFORE:"before",CENTER:"center",AFTER:"after"},goog.exportProperty(shaka.text.Cue,"displayAlign",shaka.text.Cue.displayAlign),shaka.text.Cue.direction={HORIZONTAL_LEFT_TO_RIGHT:"ltr",HORIZONTAL_RIGHT_TO_LEFT:"rtl"},goog.exportProperty(shaka.text.Cue,"direction",shaka.text.Cue.direction),shaka.text.Cue.writingMode={HORIZONTAL_TOP_TO_BOTTOM:"horizontal-tb",VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"},goog.exportProperty(shaka.text.Cue,"writingMode",shaka.text.Cue.writingMode),shaka.text.Cue.lineInterpretation={LINE_NUMBER:0,PERCENTAGE:1},goog.exportProperty(shaka.text.Cue,"lineInterpretation",shaka.text.Cue.lineInterpretation),shaka.text.Cue.lineAlign={CENTER:"center",START:"start",END:"end"},goog.exportProperty(shaka.text.Cue,"lineAlign",shaka.text.Cue.lineAlign),shaka.text.Cue.defaultTextColor={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"},goog.exportProperty(shaka.text.Cue,"defaultTextColor",shaka.text.Cue.defaultTextColor),shaka.text.Cue.defaultTextBackgroundColor={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"},goog.exportProperty(shaka.text.Cue,"defaultTextBackgroundColor",shaka.text.Cue.defaultTextBackgroundColor),shaka.text.Cue.fontWeight={NORMAL:400,BOLD:700},goog.exportProperty(shaka.text.Cue,"fontWeight",shaka.text.Cue.fontWeight),shaka.text.Cue.fontStyle={NORMAL:"normal",ITALIC:"italic",OBLIQUE:"oblique"},goog.exportProperty(shaka.text.Cue,"fontStyle",shaka.text.Cue.fontStyle),shaka.text.Cue.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},goog.exportProperty(shaka.text.Cue,"textDecoration",shaka.text.Cue.textDecoration),shaka.text.CueRegion=function(){var e=shaka.text.CueRegion;this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=e.units.PERCENTAGE,this.scroll=e.scrollMode.NONE},goog.exportSymbol("shaka.text.CueRegion",shaka.text.CueRegion),shaka.text.CueRegion.units={PX:0,PERCENTAGE:1,LINES:2},goog.exportProperty(shaka.text.CueRegion,"units",shaka.text.CueRegion.units),shaka.text.CueRegion.scrollMode={NONE:"",UP:"up"},goog.exportProperty(shaka.text.CueRegion,"scrollMode",shaka.text.CueRegion.scrollMode),shaka.util.IDestroyable=function(){},shaka.util.IDestroyable.prototype.destroy=function(){},shaka.transmuxer={},shaka.transmuxer.TransmuxerEngine=function(){},shaka.transmuxer.TransmuxerEngine.prototype.destroy=function(){},shaka.transmuxer.TransmuxerEngine.registerTransmuxer=function(e,t,r){var n=shaka.transmuxer.TransmuxerEngine;e=n.normalizeMimeType_(e),n.transmuxerMap_[e+"-"+r]={priority:r,plugin:t}},shaka.transmuxer.TransmuxerEngine.unregisterTransmuxer=function(e,t){var r=shaka.transmuxer.TransmuxerEngine;e=r.normalizeMimeType_(e),delete r.transmuxerMap_[e+"-"+t]},shaka.transmuxer.TransmuxerEngine.findTransmuxer=function(e,t){for(var r=shaka.transmuxer.TransmuxerEngine,n=r.normalizeMimeType_(e),a=$jscomp.makeIterator([r.PluginPriority.APPLICATION,r.PluginPriority.PREFERRED,r.PluginPriority.PREFERRED_SECONDARY,r.PluginPriority.FALLBACK]),i=a.next();!i.done;i=a.next())if(i=r.transmuxerMap_[n+"-"+i.value]){var o=i.plugin(),s=o.isSupported(e,t);if(o.destroy(),s)return i.plugin}return null},shaka.transmuxer.TransmuxerEngine.normalizeMimeType_=function(e){return e.toLowerCase().split(";")[0]},shaka.transmuxer.TransmuxerEngine.isSupported=function(e,t){return!!shaka.transmuxer.TransmuxerEngine.findTransmuxer(e)},shaka.transmuxer.TransmuxerEngine.convertCodecs=function(e,t){var r=shaka.transmuxer.TransmuxerEngine.findTransmuxer(t);return r?(e=(r=r()).convertCodecs(e,t),r.destroy(),e):t},goog.exportSymbol("shaka.transmuxer.TransmuxerEngine",shaka.transmuxer.TransmuxerEngine),goog.exportProperty(shaka.transmuxer.TransmuxerEngine,"findTransmuxer",shaka.transmuxer.TransmuxerEngine.findTransmuxer),goog.exportProperty(shaka.transmuxer.TransmuxerEngine,"unregisterTransmuxer",shaka.transmuxer.TransmuxerEngine.unregisterTransmuxer),goog.exportProperty(shaka.transmuxer.TransmuxerEngine,"registerTransmuxer",shaka.transmuxer.TransmuxerEngine.registerTransmuxer),goog.exportProperty(shaka.transmuxer.TransmuxerEngine.prototype,"destroy",shaka.transmuxer.TransmuxerEngine.prototype.destroy),shaka.transmuxer.TransmuxerEngine.transmuxerMap_={},shaka.transmuxer.TransmuxerEngine.PluginPriority={FALLBACK:1,PREFERRED_SECONDARY:2,PREFERRED:3,APPLICATION:4},goog.exportProperty(shaka.transmuxer.TransmuxerEngine,"PluginPriority",shaka.transmuxer.TransmuxerEngine.PluginPriority),goog.uri={},goog.uri.utils={},goog.uri.utils.splitRe_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),goog.uri.utils.ComponentIndex={SCHEME:1,USER_INFO:2,DOMAIN:3,PORT:4,PATH:5,QUERY_DATA:6,FRAGMENT:7},goog.uri.utils.split=function(e){return e.match(goog.uri.utils.splitRe_)},goog.Uri=function(e){var t;e instanceof goog.Uri?(this.setScheme(e.getScheme()),this.setUserInfo(e.getUserInfo()),this.setDomain(e.getDomain()),this.setPort(e.getPort()),this.setPath(e.getPath()),this.setQueryData(e.getQueryData().clone()),this.setFragment(e.getFragment())):e&&(t=goog.uri.utils.split(String(e)))?(this.setScheme(t[goog.uri.utils.ComponentIndex.SCHEME]||"",!0),this.setUserInfo(t[goog.uri.utils.ComponentIndex.USER_INFO]||"",!0),this.setDomain(t[goog.uri.utils.ComponentIndex.DOMAIN]||"",!0),this.setPort(t[goog.uri.utils.ComponentIndex.PORT]),this.setPath(t[goog.uri.utils.ComponentIndex.PATH]||"",!0),this.setQueryData(t[goog.uri.utils.ComponentIndex.QUERY_DATA]||"",!0),this.setFragment(t[goog.uri.utils.ComponentIndex.FRAGMENT]||"",!0)):this.queryData_=new goog.Uri.QueryData(null,null)},goog.Uri.prototype.scheme_="",goog.Uri.prototype.userInfo_="",goog.Uri.prototype.domain_="",goog.Uri.prototype.port_=null,goog.Uri.prototype.path_="",goog.Uri.prototype.fragment_="",goog.Uri.prototype.toString=function(){var e=[],t=this.getScheme();if(t&&e.push(goog.Uri.encodeSpecialChars_(t,goog.Uri.reDisallowedInSchemeOrUserInfo_,!0),":"),t=this.getDomain()){e.push("//");var r=this.getUserInfo();r&&e.push(goog.Uri.encodeSpecialChars_(r,goog.Uri.reDisallowedInSchemeOrUserInfo_,!0),"@"),e.push(goog.Uri.removeDoubleEncoding_(encodeURIComponent(t))),null!=(t=this.getPort())&&e.push(":",String(t))}return(t=this.getPath())&&(this.hasDomain()&&"/"!=t.charAt(0)&&e.push("/"),e.push(goog.Uri.encodeSpecialChars_(t,"/"==t.charAt(0)?goog.Uri.reDisallowedInAbsolutePath_:goog.Uri.reDisallowedInRelativePath_,!0))),(t=this.getEncodedQuery())&&e.push("?",t),(t=this.getFragment())&&e.push("#",goog.Uri.encodeSpecialChars_(t,goog.Uri.reDisallowedInFragment_)),e.join("")},goog.Uri.prototype.resolve=function(e){var t=this.clone();"data"===t.scheme_&&(t=new goog.Uri);var r=e.hasScheme();r?t.setScheme(e.getScheme()):r=e.hasUserInfo(),r?t.setUserInfo(e.getUserInfo()):r=e.hasDomain(),r?t.setDomain(e.getDomain()):r=e.hasPort();var n=e.getPath();if(r)t.setPort(e.getPort());else if(r=e.hasPath()){if("/"!=n.charAt(0))if(this.hasDomain()&&!this.hasPath())n="/"+n;else{var a=t.getPath().lastIndexOf("/");-1!=a&&(n=t.getPath().substr(0,a+1)+n)}n=goog.Uri.removeDotSegments(n)}return r?t.setPath(n):r=e.hasQuery(),r?t.setQueryData(e.getQueryData().clone()):r=e.hasFragment(),r&&t.setFragment(e.getFragment()),t},goog.Uri.prototype.clone=function(){return new goog.Uri(this)},goog.Uri.prototype.getScheme=function(){return this.scheme_},goog.Uri.prototype.setScheme=function(e,t){return(this.scheme_=t?goog.Uri.decodeOrEmpty_(e,!0):e)&&(this.scheme_=this.scheme_.replace(/:$/,"")),this},goog.Uri.prototype.hasScheme=function(){return!!this.scheme_},goog.Uri.prototype.getUserInfo=function(){return this.userInfo_},goog.Uri.prototype.setUserInfo=function(e,t){return this.userInfo_=t?goog.Uri.decodeOrEmpty_(e):e,this},goog.Uri.prototype.hasUserInfo=function(){return!!this.userInfo_},goog.Uri.prototype.getDomain=function(){return this.domain_},goog.Uri.prototype.setDomain=function(e,t){return this.domain_=t?goog.Uri.decodeOrEmpty_(e,!0):e,this},goog.Uri.prototype.hasDomain=function(){return!!this.domain_},goog.Uri.prototype.getPort=function(){return this.port_},goog.Uri.prototype.setPort=function(e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);this.port_=e}else this.port_=null;return this},goog.Uri.prototype.hasPort=function(){return null!=this.port_},goog.Uri.prototype.getPath=function(){return this.path_},goog.Uri.prototype.setPath=function(e,t){return this.path_=t?goog.Uri.decodeOrEmpty_(e,!0):e,this},goog.Uri.prototype.hasPath=function(){return!!this.path_},goog.Uri.prototype.hasQuery=function(){return""!==this.queryData_.toString()},goog.Uri.prototype.setQueryData=function(e,t){return e instanceof goog.Uri.QueryData?this.queryData_=e:(t||(e=goog.Uri.encodeSpecialChars_(e,goog.Uri.reDisallowedInQuery_)),this.queryData_=new goog.Uri.QueryData(e,null)),this},goog.Uri.prototype.getEncodedQuery=function(){return this.queryData_.toString()},goog.Uri.prototype.getDecodedQuery=function(){return this.queryData_.toDecodedString()},goog.Uri.prototype.getQueryData=function(){return this.queryData_},goog.Uri.prototype.getFragment=function(){return this.fragment_},goog.Uri.prototype.setFragment=function(e,t){return this.fragment_=t?goog.Uri.decodeOrEmpty_(e):e,this},goog.Uri.prototype.hasFragment=function(){return!!this.fragment_},goog.Uri.removeDotSegments=function(e){if(".."==e||"."==e)return"";if(-1==e.indexOf("./")&&-1==e.indexOf("/."))return e;var t=0==e.lastIndexOf("/",0);e=e.split("/");for(var r=[],n=0;n<e.length;){var a=e[n++];"."==a?t&&n==e.length&&r.push(""):".."==a?((1<r.length||1==r.length&&""!=r[0])&&r.pop(),t&&n==e.length&&r.push("")):(r.push(a),t=!0)}return r.join("/")},goog.Uri.decodeOrEmpty_=function(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""},goog.Uri.encodeSpecialChars_=function(e,t,r){return null!=e?(e=encodeURI(e).replace(t,goog.Uri.encodeChar_),r&&(e=goog.Uri.removeDoubleEncoding_(e)),e):null},goog.Uri.encodeChar_=function(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)},goog.Uri.removeDoubleEncoding_=function(e){return e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")},goog.Uri.reDisallowedInSchemeOrUserInfo_=/[#\/\?@]/g,goog.Uri.reDisallowedInRelativePath_=/[#\?:]/g,goog.Uri.reDisallowedInAbsolutePath_=/[#\?]/g,goog.Uri.reDisallowedInQuery_=/[#\?@]/g,goog.Uri.reDisallowedInFragment_=/#/g,goog.Uri.QueryData=function(e,t){this.encodedQuery_=e||null},goog.Uri.QueryData.prototype.ensureKeyMapInitialized_=function(){if(!this.keyMap_&&(this.keyMap_={},this.count_=0,this.encodedQuery_))for(var e=this.encodedQuery_.split("&"),t=0;t<e.length;t++){var r=e[t].indexOf("="),n=null;if(0<=r){var a=e[t].substring(0,r);n=e[t].substring(r+1)}else a=e[t];a=decodeURIComponent(a.replace(/\+/g," ")),n=n||"",this.add(a,decodeURIComponent(n.replace(/\+/g," ")))}},goog.Uri.QueryData.prototype.keyMap_=null,goog.Uri.QueryData.prototype.count_=null,goog.Uri.QueryData.prototype.getCount=function(){return this.ensureKeyMapInitialized_(),this.count_},goog.Uri.QueryData.prototype.add=function(e,t){this.ensureKeyMapInitialized_(),this.encodedQuery_=null;var r=this.keyMap_.hasOwnProperty(e)?this.keyMap_[e]:null;return r||(this.keyMap_[e]=r=[]),r.push(t),goog.asserts.assert(null!=this.count_,"Should not be null."),this.count_++,this},goog.Uri.QueryData.prototype.set=function(e,t){return this.ensureKeyMapInitialized_(),this.encodedQuery_=null,this.keyMap_.hasOwnProperty(e)?this.keyMap_[e]=[t]:this.add(e,t),this},goog.Uri.QueryData.prototype.get=function(e){return this.ensureKeyMapInitialized_(),this.keyMap_[e]||[]},goog.Uri.QueryData.prototype.toString=function(){if(this.encodedQuery_)return this.encodedQuery_;if(!this.keyMap_)return"";var e,t=[];for(e in this.keyMap_)for(var r=encodeURIComponent(e),n=this.keyMap_[e],a=0;a<n.length;a++){var i=r;""!==n[a]&&(i+="="+encodeURIComponent(n[a])),t.push(i)}return this.encodedQuery_=t.join("&")},goog.Uri.QueryData.prototype.toDecodedString=function(){return goog.Uri.decodeOrEmpty_(this.toString())},goog.Uri.QueryData.prototype.clone=function(){var e=new goog.Uri.QueryData;if(e.encodedQuery_=this.encodedQuery_,this.keyMap_){var t,r={};for(t in this.keyMap_)r[t]=this.keyMap_[t].concat();e.keyMap_=r,e.count_=this.count_}return e},shaka.util.Error=function(e,t,r){var n=$jscomp.getRestArguments.apply(3,arguments);if(this.severity=e,this.category=t,this.code=r,this.data=n,this.handled=!1,n="Shaka Error "+this.code,goog.DEBUG){var a,i=n="UNKNOWN";for(a in shaka.util.Error.Category)shaka.util.Error.Category[a]==this.category&&(n=a);for(var o in shaka.util.Error.Code)shaka.util.Error.Code[o]==this.code&&(i=o);n="Shaka Error "+n+"."+i+" ("+this.data.toString()+")"}if(this.message=n,shaka.util.Error.createStack)try{throw Error(this.message||"Shaka Error")}catch(e){this.stack=e.stack}},shaka.util.Error.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},goog.exportSymbol("shaka.util.Error",shaka.util.Error),shaka.util.Error.createStack=!0,shaka.util.Error.Severity={RECOVERABLE:1,CRITICAL:2},goog.exportProperty(shaka.util.Error,"Severity",shaka.util.Error.Severity),shaka.util.Error.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},goog.exportProperty(shaka.util.Error,"Category",shaka.util.Error.Category),shaka.util.Error.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,CHAPTERS_TRACK_FAILED:2015,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_CODEC_UNKNOWN:3021,MSS_TRANSMUXING_FAILED:3022,TRANSMUXING_NO_VIDEO_DATA:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,AES_128_INVALID_IV_LENGTH:4048,AES_128_INVALID_KEY_LENGTH:4049,DASH_CONFLICTING_AES_128:4050,DASH_UNSUPPORTED_AES_128:4051,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,SRC_EQUALS_PRELOAD_NOT_SUPPORTED:7005,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004,MT_AD_MANAGER_NOT_INITIALIZED:10005},goog.exportProperty(shaka.util.Error,"Code",shaka.util.Error.Code),shaka.util.Lazy=function(e){this.gen_=e,this.value_=void 0},shaka.util.Lazy.prototype.value=function(){return null==this.value_&&(this.value_=this.gen_(),goog.asserts.assert(null!=this.value_,"Unable to create lazy value")),this.value_},shaka.util.Lazy.prototype.reset=function(){this.value_=void 0},shaka.util.DelayedTick=function(e){this.onTick_=e,this.cancelPending_=null},shaka.util.DelayedTick.prototype.tickAfter=function(e){var t=this;this.stop();var r=!0,n=null;return this.cancelPending_=function(){window.clearTimeout(n),r=!1},n=window.setTimeout((function(){r&&t.onTick_()}),1e3*e),this},shaka.util.DelayedTick.prototype.stop=function(){this.cancelPending_&&(this.cancelPending_(),this.cancelPending_=null)},shaka.util.Timer=function(e){this.onTick_=e,this.ticker_=null},shaka.util.Timer.prototype.tickNow=function(){return this.stop(),this.onTick_(),this},shaka.util.Timer.prototype.tickAfter=function(e){var t=this;return this.stop(),this.ticker_=new shaka.util.DelayedTick((function(){t.onTick_()})).tickAfter(e),this},shaka.util.Timer.prototype.tickEvery=function(e){var t=this;return this.stop(),goog.DEBUG&&shaka.util.Timer.activeTimers.set(this,Error("Timer created").stack),this.ticker_=new shaka.util.DelayedTick((function(){t.ticker_.tickAfter(e),t.onTick_()})).tickAfter(e),this},shaka.util.Timer.prototype.stop=function(){this.ticker_&&(this.ticker_.stop(),this.ticker_=null),goog.DEBUG&&shaka.util.Timer.activeTimers.delete(this)},goog.exportSymbol("shaka.util.Timer",shaka.util.Timer),goog.exportProperty(shaka.util.Timer.prototype,"stop",shaka.util.Timer.prototype.stop),goog.exportProperty(shaka.util.Timer.prototype,"tickEvery",shaka.util.Timer.prototype.tickEvery),goog.exportProperty(shaka.util.Timer.prototype,"tickAfter",shaka.util.Timer.prototype.tickAfter),goog.exportProperty(shaka.util.Timer.prototype,"tickNow",shaka.util.Timer.prototype.tickNow),goog.DEBUG&&(shaka.util.Timer.activeTimers=new Map),shaka.util.Platform=function(){},shaka.util.Platform.supportsMediaSource=function(){var e=window.ManagedMediaSource||window.MediaSource;return!(!e||!e.isTypeSupported)},shaka.util.Platform.supportsMediaType=function(e){return""!=shaka.util.Platform.anyMediaElement().canPlayType(e)},shaka.util.Platform.isEdge=function(){return!!navigator.userAgent.match(/Edge?\//)},shaka.util.Platform.isLegacyEdge=function(){return!!navigator.userAgent.match(/Edge\//)},shaka.util.Platform.isIE=function(){return shaka.util.Platform.userAgentContains_("Trident/")},shaka.util.Platform.isXboxOne=function(){return shaka.util.Platform.userAgentContains_("Xbox One")},shaka.util.Platform.isTizen=function(){return shaka.util.Platform.userAgentContains_("Tizen")},shaka.util.Platform.isTizen6=function(){return shaka.util.Platform.userAgentContains_("Tizen 6")},shaka.util.Platform.isTizen5_0=function(){return shaka.util.Platform.userAgentContains_("Tizen 5.0")},shaka.util.Platform.isTizen5=function(){return shaka.util.Platform.userAgentContains_("Tizen 5")},shaka.util.Platform.isTizen4=function(){return shaka.util.Platform.userAgentContains_("Tizen 4")},shaka.util.Platform.isTizen3=function(){return shaka.util.Platform.userAgentContains_("Tizen 3")},shaka.util.Platform.isTizen2=function(){return shaka.util.Platform.userAgentContains_("Tizen 2")},shaka.util.Platform.isWebOS=function(){return shaka.util.Platform.userAgentContains_("Web0S")},shaka.util.Platform.isWebOS3=function(){return shaka.util.Platform.isWebOS()&&38===shaka.util.Platform.chromeVersion()},shaka.util.Platform.isWebOS4=function(){return shaka.util.Platform.isWebOS()&&53===shaka.util.Platform.chromeVersion()},shaka.util.Platform.isWebOS5=function(){return shaka.util.Platform.isWebOS()&&68===shaka.util.Platform.chromeVersion()},shaka.util.Platform.isChromecast=function(){return shaka.util.Platform.userAgentContains_("CrKey")},shaka.util.Platform.isAndroidCastDevice=function(){var e=shaka.util.Platform;return e.isChromecast()&&e.isAndroid()},shaka.util.Platform.isFuchsiaCastDevice=function(){var e=shaka.util.Platform;return e.isChromecast()&&e.isFuchsia()},shaka.util.Platform.chromeVersion=function(){if(!shaka.util.Platform.isChrome())return null;var e=navigator.userAgent.match(/Chrome\/(\d+)/);return e?parseInt(e[1],10):null},shaka.util.Platform.isChrome=function(){return shaka.util.Platform.userAgentContains_("Chrome")&&!shaka.util.Platform.isLegacyEdge()},shaka.util.Platform.isFirefox=function(){return shaka.util.Platform.userAgentContains_("Firefox")},shaka.util.Platform.isApple=function(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!shaka.util.Platform.isTizen()&&!shaka.util.Platform.isEOS()&&!shaka.util.Platform.isAPL()&&!shaka.util.Platform.isVirginMedia()&&!shaka.util.Platform.isOrange()&&!shaka.util.Platform.isPS4()&&!shaka.util.Platform.isAmazonFireTV()&&!shaka.util.Platform.isWPE()&&!shaka.util.Platform.isZenterio()},shaka.util.Platform.isPS5=function(){return shaka.util.Platform.userAgentContains_("PlayStation 5")},shaka.util.Platform.isPS4=function(){return shaka.util.Platform.userAgentContains_("PlayStation 4")},shaka.util.Platform.isHisense=function(){return shaka.util.Platform.userAgentContains_("Hisense")||shaka.util.Platform.userAgentContains_("VIDAA")},shaka.util.Platform.isVirginMedia=function(){return shaka.util.Platform.userAgentContains_("VirginMedia")},shaka.util.Platform.isOrange=function(){return shaka.util.Platform.userAgentContains_("SOPOpenBrowser")},shaka.util.Platform.isAmazonFireTV=function(){return shaka.util.Platform.userAgentContains_("AFT")},shaka.util.Platform.isWPE=function(){return shaka.util.Platform.userAgentContains_("WPE")},shaka.util.Platform.isZenterio=function(){return shaka.util.Platform.userAgentContains_("DT_STB_BCM")},shaka.util.Platform.safariVersion=function(){if(!shaka.util.Platform.isApple())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null},shaka.util.Platform.isSafari=function(){return!!shaka.util.Platform.safariVersion()},shaka.util.Platform.isEOS=function(){return shaka.util.Platform.userAgentContains_("PC=EOS")},shaka.util.Platform.isAPL=function(){return shaka.util.Platform.userAgentContains_("PC=APL")},shaka.util.Platform.isMobile=function(){return!!/(?:iPhone|iPad|iPod|Android)/.test(navigator.userAgent)||shaka.util.Platform.isApple()&&1<navigator.maxTouchPoints},shaka.util.Platform.isMac=function(){return navigator.userAgentData&&navigator.userAgentData.platform?"macos"==navigator.userAgentData.platform.toLowerCase():!!navigator.platform&&navigator.platform.toLowerCase().includes("mac")},shaka.util.Platform.isWindows=function(){return navigator.userAgentData&&navigator.userAgentData.platform?"windows"==navigator.userAgentData.platform.toLowerCase():!!navigator.platform&&navigator.platform.toLowerCase().includes("windows")},shaka.util.Platform.isAndroid=function(){return shaka.util.Platform.userAgentContains_("Android")},shaka.util.Platform.isFuchsia=function(){return shaka.util.Platform.userAgentContains_("Fuchsia")},shaka.util.Platform.isSmartTV=function(){var e=shaka.util.Platform;return!!(e.isTizen()||e.isWebOS()||e.isXboxOne()||e.isPS4()||e.isPS5()||e.isAmazonFireTV()||e.isEOS()||e.isAPL()||e.isVirginMedia()||e.isOrange()||e.isWPE()||e.isChromecast()||e.isHisense()||e.isZenterio())},shaka.util.Platform.userAgentContains_=function(e){return(navigator.userAgent||"").includes(e)},shaka.util.Platform.anyMediaElement=function(){var e=shaka.util.Platform;return e.cachedMediaElement_||(e.cacheExpirationTimer_||(e.cacheExpirationTimer_=new shaka.util.Timer((function(){e.cachedMediaElement_=null}))),e.cachedMediaElement_=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0],e.cachedMediaElement_||(e.cachedMediaElement_=document.createElement("video")),e.cacheExpirationTimer_.tickAfter(1)),e.cachedMediaElement_},shaka.util.Platform.requiresEncryptionInfoInAllInitSegments=function(){var e=shaka.util.Platform;return e.isTizen()||e.isXboxOne()||e.isOrange()},shaka.util.Platform.supportsSequenceMode=function(){var e=shaka.util.Platform;return!(e.isTizen3()||e.isTizen2()||e.isWebOS3()||e.isPS4())},shaka.util.Platform.supportsSmoothCodecSwitching=function(){var e=shaka.util.Platform;return!(e.isTizen2()||e.isTizen3()||e.isTizen4()||e.isTizen5()||e.isTizen6()||e.isWebOS3()||e.isWebOS4()||e.isWebOS5()||e.isChromecast()&&!e.isAndroidCastDevice()&&!e.isFuchsiaCastDevice()||e.isWindows()&&e.isEdge())},shaka.util.Platform.isMediaKeysPolyfilled=function(){return!!window.shakaMediaKeysPolyfill},shaka.util.Platform.detectMaxHardwareResolution=function(){var e,t,r,n,a,i,o,s,l,u,c,d,p,h,f;return $jscomp.asyncExecutePromiseGeneratorProgram((function(m){switch(m.nextAddress){case 1:if(e=shaka.util.Platform,t={width:1/0,height:1/0},e.isChromecast()){if(d=window.cast&&cast.__platform__&&cast.__platform__.canDisplayType,t.width=1280,t.height=720,m.setCatchFinallyBlocks(15),!(p=d)){m.jumpTo(17);break}return m.yield(cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160'),18)}if(e.isTizen()){t.width=1920,t.height=1080;try{webapis.systeminfo&&webapis.systeminfo.getMaxVideoResolution?(r=webapis.systeminfo.getMaxVideoResolution(),t.width=r.width,t.height=r.height):webapis.productinfo.is8KPanelSupported&&webapis.productinfo.is8KPanelSupported()?(t.width=7680,t.height=4320):webapis.productinfo.isUdPanelSupported&&webapis.productinfo.isUdPanelSupported()&&(t.width=3840,t.height=2160)}catch(e){shaka.log.alwaysWarn("Tizen: Error detecting screen size, default screen size 1920x1080.")}m.jumpTo(3);break}if(e.isXboxOne()){n=new Windows.Media.Protection.ProtectionCapabilities,a=Windows.Media.Protection.ProtectionCapabilityResult,i=null;try{do{i=n.isTypeSupported('video/mp4;codecs="hvc1,mp4a";features="decode-res-x=3840,decode-res-y=2160,decode-bitrate=20000,decode-fps=30,decode-bpc=10,display-res-x=3840,display-res-y=2160,display-bpc=8"',"com.microsoft.playready.recommendation")}while(i===a.maybe)}catch(e){i=a.notSupported}i===a.probably?(t.width=3840,t.height=2160):(t.width=1920,t.height=1080),m.jumpTo(3);break}if(e.isWebOS()){try{o=JSON.parse(window.PalmSystem.deviceInfo),t.width=Math.max(1920,o.screenWidth),t.height=Math.max(1080,o.screenHeight)}catch(e){shaka.log.alwaysWarn("WebOS: Error detecting screen size, default screen size 1920x1080."),t.width=1920,t.height=1080}m.jumpTo(3);break}if(e.isHisense()){window.Hisense_Get4KSupportState&&window.Hisense_Get4KSupportState()?(t.width=3840,t.height=2160):(t.width=1920,t.height=1080),m.jumpTo(3);break}if(!e.isPS4()&&!e.isPS5()){m.jumpTo(3);break}return s=!1,m.setCatchFinallyBlocks(9),m.yield(window.msdk.device.getDisplayInfo(),11);case 11:l=m.yieldResult,s="4K"===l.resolution,m.leaveTryBlock(10);break;case 9:return m.enterCatchBlock(),m.setCatchFinallyBlocks(12),m.yield(window.msdk.device.getDisplayInfoImmediate(),14);case 14:u=m.yieldResult,s="4K"===u.resolution,m.leaveTryBlock(10);break;case 12:c=m.enterCatchBlock(),shaka.log.alwaysWarn("PlayStation: Failed to get the display info:",c);case 10:s?(t.width=3840,t.height=2160):(t.width=1920,t.height=1080),m.jumpTo(3);break;case 18:p=m.yieldResult;case 17:if(p){t.width=3840,t.height=2160,m.jumpTo(19);break}if(!(h=d)){m.jumpTo(20);break}return m.yield(cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=1920; height=1080'),21);case 21:h=m.yieldResult;case 20:h&&(t.width=1920,t.height=1080);case 19:m.leaveTryBlock(3);break;case 15:f=m.enterCatchBlock(),shaka.log.alwaysError("Failed to check canDisplayType:",f);case 3:return m.return(t)}}))},shaka.util.Platform.cacheExpirationTimer_=null,shaka.util.Platform.cachedMediaElement_=null,shaka.util.StringUtils=function(){},shaka.util.StringUtils.fromUTF8=function(e){if(!e)return"";if(239==(e=shaka.util.BufferUtils.toUint8(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),window.TextDecoder&&!shaka.util.Platform.isPS4())return(e=(new TextDecoder).decode(e)).includes("�")&&shaka.log.alwaysError('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),e;for(var t="",r=0;r<e.length;++r){var n=65533;if(0==(128&e[r])?n=e[r]:e.length>=r+2&&192==(224&e[r])&&128==(192&e[r+1])?(n=(31&e[r])<<6|63&e[r+1],r+=1):e.length>=r+3&&224==(240&e[r])&&128==(192&e[r+1])&&128==(192&e[r+2])?(n=(15&e[r])<<12|(63&e[r+1])<<6|63&e[r+2],r+=2):e.length>=r+4&&240==(241&e[r])&&128==(192&e[r+1])&&128==(192&e[r+2])&&128==(192&e[r+3])&&(n=(7&e[r])<<18|(63&e[r+1])<<12|(63&e[r+2])<<6|63&e[r+3],r+=3),65535>=n)t+=String.fromCharCode(n);else{var a=1023&(n-=65536);t+=String.fromCharCode(55296+(n>>10)),t+=String.fromCharCode(56320+a)}}return t},shaka.util.StringUtils.fromUTF16=function(e,t,r){if(!e)return"";if(!r&&0!=e.byteLength%2)throw shaka.log.error("Data has an incorrect length, must be even."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.BAD_ENCODING);r=Math.floor(e.byteLength/2);var n=new Uint16Array(r);e=shaka.util.BufferUtils.toDataView(e);for(var a=0;a<r;a++)n[a]=e.getUint16(2*a,t);return shaka.util.StringUtils.fromCharCode(n)},shaka.util.StringUtils.fromBytesAutoDetect=function(e){var t=shaka.util.StringUtils;if(!e)return"";var r=shaka.util.BufferUtils.toUint8(e);if(239==r[0]&&187==r[1]&&191==r[2])return t.fromUTF8(r);if(254==r[0]&&255==r[1])return t.fromUTF16(r.subarray(2),!1);if(255==r[0]&&254==r[1])return t.fromUTF16(r.subarray(2),!0);var n=function(e){return r.byteLength<=e||32<=r[e]&&126>=r[e]};if(shaka.log.debug("Unable to find byte-order-mark, making an educated guess."),0==r[0]&&0==r[2])return t.fromUTF16(e,!1);if(0==r[1]&&0==r[3])return t.fromUTF16(e,!0);if(n(0)&&n(1)&&n(2)&&n(3))return t.fromUTF8(e);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.UNABLE_TO_DETECT_ENCODING)},shaka.util.StringUtils.toUTF8=function(e){if(window.TextEncoder&&!shaka.util.Platform.isPS4()){var t=new TextEncoder;return shaka.util.BufferUtils.toArrayBuffer(t.encode(e))}e=encodeURIComponent(e),e=unescape(e),t=new Uint8Array(e.length);for(var r=0;r<e.length;r++)t[r]=e[r].charCodeAt(0);return shaka.util.BufferUtils.toArrayBuffer(t)},shaka.util.StringUtils.toUTF16=function(e,t){for(var r=new ArrayBuffer(2*e.length),n=new DataView(r),a=0;a<e.length;++a){var i=e.charCodeAt(a);n.setUint16(2*a,i,t)}return r},shaka.util.StringUtils.fromCharCode=function(e){return shaka.util.StringUtils.fromCharCodeImpl_.value()(e)},shaka.util.StringUtils.resetFromCharCode=function(){shaka.util.StringUtils.fromCharCodeImpl_.reset()},shaka.util.StringUtils.htmlUnescape=function(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&apos;":"'","&nbsp;":" ","&lrm;":"‎","&rlm;":"‏"},r=/&(?:amp|lt|gt|quot|apos|#(0+)?39|nbsp|lrm|rlm);/g,n=RegExp(r.source);return e&&n.test(e)?e.replace(r,(function(e){return t[e]||"'"})):e||""},goog.exportSymbol("shaka.util.StringUtils",shaka.util.StringUtils),goog.exportProperty(shaka.util.StringUtils,"resetFromCharCode",shaka.util.StringUtils.resetFromCharCode),goog.exportProperty(shaka.util.StringUtils,"toUTF16",shaka.util.StringUtils.toUTF16),goog.exportProperty(shaka.util.StringUtils,"toUTF8",shaka.util.StringUtils.toUTF8),goog.exportProperty(shaka.util.StringUtils,"fromBytesAutoDetect",shaka.util.StringUtils.fromBytesAutoDetect),goog.exportProperty(shaka.util.StringUtils,"fromUTF16",shaka.util.StringUtils.fromUTF16),goog.exportProperty(shaka.util.StringUtils,"fromUTF8",shaka.util.StringUtils.fromUTF8),shaka.util.StringUtils.fromCharCodeImpl_=new shaka.util.Lazy((function(){for(var e=function(e){try{var t=new Uint8Array(e),r=String.fromCharCode.apply(null,t);return goog.asserts.assert(r,"Should get value"),0<r.length}catch(e){return!1}},t={$jscomp$loop$prop$size$851:65536};0<t.$jscomp$loop$prop$size$851;(t={$jscomp$loop$prop$size$851:t.$jscomp$loop$prop$size$851}).$jscomp$loop$prop$size$851/=2)if(e(t.$jscomp$loop$prop$size$851))return function(e){return function(t){for(var r="",n=0;n<t.length;n+=e.$jscomp$loop$prop$size$851){var a=t.subarray(n,n+e.$jscomp$loop$prop$size$851);r+=String.fromCharCode.apply(null,a)}return r}}(t);return goog.asserts.assert(!1,"Unable to create a fromCharCode method"),null})),shaka.util.Uint8ArrayUtils=function(){},shaka.util.Uint8ArrayUtils.toStandardBase64=function(e){return e=shaka.util.StringUtils.fromCharCode(shaka.util.BufferUtils.toUint8(e)),btoa(e)},shaka.util.Uint8ArrayUtils.toBase64=function(e,t){return t=null==t||t,e=shaka.util.Uint8ArrayUtils.toStandardBase64(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")},shaka.util.Uint8ArrayUtils.fromBase64=function(e){e=window.atob(e.replace(/-/g,"+").replace(/_/g,"/"));for(var t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t},shaka.util.Uint8ArrayUtils.fromHex=function(e){for(var t=e.length/2,r=new Uint8Array(t),n=0;n<t;n++)r[n]=window.parseInt(e.substr(2*n,2),16);return r},shaka.util.Uint8ArrayUtils.toHex=function(e){var t=shaka.util.BufferUtils.toUint8(e);e="";for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())1==(r=(r=r.value).toString(16)).length&&(r="0"+r),e+=r;return e},shaka.util.Uint8ArrayUtils.concat=function(){for(var e=$jscomp.getRestArguments.apply(0,arguments),t=shaka.util.BufferUtils,r=0,n=0;n<e.length;++n)r+=e[n].byteLength;r=new Uint8Array(r);for(var a=n=0;a<e.length;++a){var i=e[a];i instanceof Uint8Array?r.set(i,n):r.set(t.toUint8(i),n),n+=i.byteLength}return r},goog.exportSymbol("shaka.util.Uint8ArrayUtils",shaka.util.Uint8ArrayUtils),goog.exportProperty(shaka.util.Uint8ArrayUtils,"concat",shaka.util.Uint8ArrayUtils.concat),goog.exportProperty(shaka.util.Uint8ArrayUtils,"toHex",shaka.util.Uint8ArrayUtils.toHex),goog.exportProperty(shaka.util.Uint8ArrayUtils,"fromHex",shaka.util.Uint8ArrayUtils.fromHex),goog.exportProperty(shaka.util.Uint8ArrayUtils,"fromBase64",shaka.util.Uint8ArrayUtils.fromBase64),goog.exportProperty(shaka.util.Uint8ArrayUtils,"toBase64",shaka.util.Uint8ArrayUtils.toBase64),goog.exportProperty(shaka.util.Uint8ArrayUtils,"toStandardBase64",shaka.util.Uint8ArrayUtils.toStandardBase64),shaka.util.ManifestParserUtils=function(){},shaka.util.ManifestParserUtils.resolveUris=function(e,t){if(0==t.length)return e;if(1==e.length&&1==t.length){var r=new goog.Uri(e[0]);return t=new goog.Uri(t[0]),[r.resolve(t).toString()]}t=t.map((function(e){return new goog.Uri(e)})),r=[];for(var n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){n=new goog.Uri(n.value);for(var a=$jscomp.makeIterator(t),i=a.next();!i.done;i=a.next())r.push(n.resolve(i.value).toString())}return r},shaka.util.ManifestParserUtils.createDrmInfo=function(e,t,r){return{keySystem:e,encryptionScheme:t,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:r||[],keyIds:new Set}},shaka.util.ManifestParserUtils.createDrmInfoFromClearKeys=function(e,t){t=void 0===t?"cenc":t;var r=shaka.util.StringUtils,n=shaka.util.Uint8ArrayUtils,a=[],i=[],o=[];e.forEach((function(e,t){var r=t;22!=r.length&&(r=n.toBase64(n.fromHex(t),!1));var s=e;22!=s.length&&(s=n.toBase64(n.fromHex(e),!1)),e={kty:"oct",kid:r,k:s},a.push(e),i.push(e.kid),o.push(t)})),e=JSON.stringify({keys:a});var s=JSON.stringify({kids:i});return r=[{initData:shaka.util.BufferUtils.toUint8(r.toUTF8(s)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",encryptionScheme:t,licenseServerUri:"data:application/json;base64,"+window.btoa(e),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:r,keyIds:new Set(o)}},shaka.util.ManifestParserUtils.guessCodecs=function(e,t){if(1==t.length)return t[0];if(null!=(e=shaka.util.ManifestParserUtils.guessCodecsSafe(e,t)))return e;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_COULD_NOT_GUESS_CODECS,t)},shaka.util.ManifestParserUtils.guessCodecsSafe=function(e,t){for(var r=$jscomp.makeIterator(shaka.util.ManifestParserUtils.CODEC_REGEXPS_BY_CONTENT_TYPE_[e]),n=r.next();!n.done;n=r.next()){n=n.value;for(var a=$jscomp.makeIterator(t),i=a.next();!i.done;i=a.next())if(i=i.value,n.test(i.trim()))return i.trim()}return e==shaka.util.ManifestParserUtils.ContentType.TEXT?"":null},shaka.util.ManifestParserUtils.guessAllCodecsSafe=function(e,t){for(var r=[],n=(e=$jscomp.makeIterator(shaka.util.ManifestParserUtils.CODEC_REGEXPS_BY_CONTENT_TYPE_[e])).next();!n.done;n=e.next()){n=n.value;for(var a=$jscomp.makeIterator(t),i=a.next();!i.done;i=a.next())i=i.value,n.test(i.trim())&&r.push(i.trim())}return r},shaka.util.ManifestParserUtils.ContentType={VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image",APPLICATION:"application"},shaka.util.ManifestParserUtils.TextStreamKind={SUBTITLE:"subtitle",CLOSED_CAPTION:"caption"},shaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS=1/15,shaka.util.ManifestParserUtils.VIDEO_CODEC_REGEXPS_=[/^avc/,/^hev/,/^hvc/,/^vvc/,/^vvi/,/^vp0?[89]/,/^av01/,/^dvh/,/^dva/,/^dav/],shaka.util.ManifestParserUtils.AUDIO_CODEC_REGEXPS_=[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4$/,/^dts[cex]$/,/^iamf/],shaka.util.ManifestParserUtils.TEXT_CODEC_REGEXPS_=[/^vtt$/,/^wvtt/,/^stpp/],shaka.util.ManifestParserUtils.CODEC_REGEXPS_BY_CONTENT_TYPE_={audio:shaka.util.ManifestParserUtils.AUDIO_CODEC_REGEXPS_,video:shaka.util.ManifestParserUtils.VIDEO_CODEC_REGEXPS_,text:shaka.util.ManifestParserUtils.TEXT_CODEC_REGEXPS_},shaka.util.MimeUtils=function(){},shaka.util.MimeUtils.getFullType=function(e,t){var r=e;return t&&!shaka.util.MimeUtils.RAW_FORMATS.includes(e)&&(r+='; codecs="'+t+'"'),r},shaka.util.MimeUtils.getFullTypeWithAllCodecs=function(e,t){return t&&(e+='; codecs="'+t+'"'),e},shaka.util.MimeUtils.getFullOrConvertedType=function(e,t,r){var n=shaka.util.MimeUtils,a=n.getFullType(e,t);t=n.getFullTypeWithAllCodecs(e,t),n=shaka.util.ManifestParserUtils.ContentType;var i=shaka.transmuxer.TransmuxerEngine;return i.isSupported(t,r)?i.convertCodecs(r,t):"video/mp2t"!=e&&r==n.AUDIO?a.replace("video","audio"):a},shaka.util.MimeUtils.getExtendedType=function(e,t,r){var n=[t];return shaka.util.MimeUtils.EXTENDED_MIME_PARAMETERS_.forEach((function(t,a){var i=e[a];"codecs"==a?shaka.util.MimeUtils.RAW_FORMATS.includes(e.mimeType)||n.push('codecs="'+r+'"'):i&&n.push(t+'="'+i+'"')})),"PQ"==e.hdr&&n.push('eotf="smpte2084"'),n.join(";")},shaka.util.MimeUtils.getContainerType=function(e){return e.split(";")[0].split("/")[1]},shaka.util.MimeUtils.splitCodecs=function(e){return e.split(",")},shaka.util.MimeUtils.getNormalizedCodec=function(e){var t=shaka.util.MimeUtils.getCodecParts_(e);switch(e=t[0],t=t[1].toLowerCase(),!0){case"mp4a"===e&&"69"===t:case"mp4a"===e&&"6b"===t:case"mp4a"===e&&"40.34"===t:return"mp3";case"mp4a"===e&&"66"===t:case"mp4a"===e&&"67"===t:case"mp4a"===e&&"68"===t:case"mp4a"===e&&"40.2"===t:case"mp4a"===e&&"40.02"===t:case"mp4a"===e&&"40.5"===t:case"mp4a"===e&&"40.05"===t:case"mp4a"===e&&"40.29"===t:case"mp4a"===e&&"40.42"===t:return"aac";case"mp4a"===e&&"a5"===t:return"ac-3";case"mp4a"===e&&"a6"===t:return"ec-3";case"mp4a"===e&&"b2"===t:return"dtsx";case"mp4a"===e&&"a9"===t:return"dtsc";case"avc1"===e:case"avc3"===e:return"avc";case"hvc1"===e:case"hev1"===e:return"hevc";case"dvh1"===e:case"dvhe"===e:return"dovi"}return e},shaka.util.MimeUtils.getCodecBase=function(e){for(var t=[],r=(e=$jscomp.makeIterator(e.split(","))).next();!r.done;r=e.next())r=shaka.util.MimeUtils.getCodecParts_(r.value),t.push(r[0]);return t.sort().join(",")},shaka.util.MimeUtils.getBasicType=function(e){return e.split(";")[0]},shaka.util.MimeUtils.getCodecs=function(e){return(e=e.split(/ *; */)).shift(),(e=e.find((function(e){return e.startsWith("codecs=")})))?e.split("=")[1].replace(/^"|"$/g,""):""},shaka.util.MimeUtils.isHlsType=function(e){return"application/x-mpegurl"===e||"application/vnd.apple.mpegurl"===e},shaka.util.MimeUtils.getCodecParts_=function(e){var t=e.split(".");return e=t[0],t.shift(),[e,t=t.join(".")]},goog.exportSymbol("shaka.util.MimeUtils",shaka.util.MimeUtils),goog.exportProperty(shaka.util.MimeUtils,"getFullTypeWithAllCodecs",shaka.util.MimeUtils.getFullTypeWithAllCodecs),goog.exportProperty(shaka.util.MimeUtils,"getFullType",shaka.util.MimeUtils.getFullType),shaka.util.MimeUtils.EXTENDED_MIME_PARAMETERS_=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels"),shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE="application/cea-608",shaka.util.MimeUtils.CEA708_CLOSED_CAPTION_MIMETYPE="application/cea-708",shaka.util.MimeUtils.RAW_FORMATS=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],shaka.text.TextEngine=function(e){this.parser_=null,this.displayer_=e,this.segmentRelativeVttTiming_=!1,this.appendWindowStart_=this.timestampOffset_=0,this.appendWindowEnd_=1/0,this.bufferEnd_=this.bufferStart_=null,this.selectedClosedCaptionId_="",this.modifyCueCallback_=function(e,t){},this.closedCaptionsMap_=new Map},shaka.text.TextEngine.registerParser=function(e,t){shaka.text.TextEngine.parserMap_[e]=t},shaka.text.TextEngine.unregisterParser=function(e){delete shaka.text.TextEngine.parserMap_[e]},shaka.text.TextEngine.findParser=function(e){return shaka.text.TextEngine.parserMap_[e]},shaka.text.TextEngine.isTypeSupported=function(e){return!!shaka.text.TextEngine.parserMap_[e]||(e==shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE||e==shaka.util.MimeUtils.CEA708_CLOSED_CAPTION_MIMETYPE)&&!!shaka.media.ClosedCaptionParser.findDecoder()},shaka.text.TextEngine.prototype.destroy=function(){return this.displayer_=this.parser_=null,this.closedCaptionsMap_.clear(),Promise.resolve()},shaka.text.TextEngine.prototype.setDisplayer=function(e){this.displayer_=e},shaka.text.TextEngine.prototype.initParser=function(e,t,r,n){e==shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE||e==shaka.util.MimeUtils.CEA708_CLOSED_CAPTION_MIMETYPE?this.parser_=null:(e=shaka.text.TextEngine.parserMap_[e],goog.asserts.assert(e,"Text type negotiation should have happened already"),this.parser_=e(),this.parser_.setSequenceMode?this.parser_.setSequenceMode(t):shaka.Deprecate.deprecateFeature(5,"Text parsers w/ setSequenceMode",'Text parsers should have a "setSequenceMode" method!'),this.parser_.setManifestType?this.parser_.setManifestType(n):shaka.Deprecate.deprecateFeature(5,"Text parsers w/ setManifestType",'Text parsers should have a "setManifestType" method!'),this.segmentRelativeVttTiming_=r)},shaka.text.TextEngine.prototype.setModifyCueCallback=function(e){this.modifyCueCallback_=e},shaka.text.TextEngine.prototype.appendBuffer=function(e,t,r,n){var a,i,o,s,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){if(1==p.nextAddress)return goog.asserts.assert(d.parser_,"The parser should already be initialized"),p.yield(Promise.resolve(),2);if(!d.parser_||!d.displayer_)return p.return();if(null==t||null==r)return d.parser_.parseInit(shaka.util.BufferUtils.toUint8(e)),p.return();for(a=d.segmentRelativeVttTiming_?t:d.timestampOffset_,i={periodStart:d.timestampOffset_,segmentStart:t,segmentEnd:r,vttOffset:a},o=d.parser_.parseMedia(shaka.util.BufferUtils.toUint8(e),i,n),s=$jscomp.makeIterator(o),l=s.next();!l.done;l=s.next())u=l.value,d.modifyCueCallback_(u,n||null,i);c=o.filter((function(e){return e.startTime>=d.appendWindowStart_&&e.startTime<d.appendWindowEnd_})),d.displayer_.append(c),null==d.bufferStart_?d.bufferStart_=Math.max(t,d.appendWindowStart_):(goog.asserts.assert(null!=d.bufferEnd_,"There should already be a buffered range end."),goog.asserts.assert(1>=t-d.bufferEnd_,"There should not be a gap in text references >1s")),d.bufferEnd_=Math.min(r,d.appendWindowEnd_),p.jumpToEnd()}))},shaka.text.TextEngine.prototype.remove=function(e,t){var r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return n.yield(Promise.resolve(),2);r.displayer_&&r.displayer_.remove(e,t)&&(null==r.bufferStart_?goog.asserts.assert(null==r.bufferEnd_,"end must be null if startTime is null"):(goog.asserts.assert(null!=r.bufferEnd_,"end must be non-null if startTime is non-null"),t<=r.bufferStart_||e>=r.bufferEnd_||(e<=r.bufferStart_&&t>=r.bufferEnd_?r.bufferStart_=r.bufferEnd_=null:e<=r.bufferStart_&&t<r.bufferEnd_?r.bufferStart_=t:e>r.bufferStart_&&t>=r.bufferEnd_?r.bufferEnd_=e:goog.asserts.assert(!1,"removal from the middle is not supported by TextEngine")))),n.jumpToEnd()}))},shaka.text.TextEngine.prototype.setTimestampOffset=function(e){this.timestampOffset_=e},shaka.text.TextEngine.prototype.setAppendWindow=function(e,t){this.appendWindowStart_=e,this.appendWindowEnd_=t},shaka.text.TextEngine.prototype.bufferStart=function(){return this.bufferStart_},shaka.text.TextEngine.prototype.bufferEnd=function(){return this.bufferEnd_},shaka.text.TextEngine.prototype.isBuffered=function(e){return null!=this.bufferStart_&&null!=this.bufferEnd_&&(e>=this.bufferStart_&&e<this.bufferEnd_)},shaka.text.TextEngine.prototype.bufferedAheadOf=function(e){return null==this.bufferEnd_||this.bufferEnd_<e?0:(goog.asserts.assert(null!=this.bufferStart_,"start should not be null if end is not null"),this.bufferEnd_-Math.max(e,this.bufferStart_))},shaka.text.TextEngine.prototype.setSelectedClosedCaptionId=function(e,t){if(this.selectedClosedCaptionId_=e,e=this.closedCaptionsMap_.get(e))for(var r=$jscomp.makeIterator(e.keys()),n=r.next();!n.done;n=r.next())(n=e.get(n.value).filter((function(e){return e.endTime<=t})))&&this.displayer_.append(n)},shaka.text.TextEngine.prototype.applyVideoTimestampOffsetRecursive_=function(e,t){e.startTime+=t,e.endTime+=t;for(var r=(e=$jscomp.makeIterator(e.nestedCues)).next();!r.done;r=e.next())this.applyVideoTimestampOffsetRecursive_(r.value,t)},shaka.text.TextEngine.prototype.storeAndAppendClosedCaptions=function(e,t,r,n){for(var a=t+" "+r,i=new Map,o=(e=$jscomp.makeIterator(e)).next();!o.done;o=e.next()){var s=o.value;o=s.stream,s=s.cue,i.has(o)||i.set(o,new Map),i.get(o).has(a)||i.get(o).set(a,[]),this.applyVideoTimestampOffsetRecursive_(s,n),s.startTime>=this.appendWindowStart_&&s.startTime<this.appendWindowEnd_&&(i.get(o).get(a).push(s),o==this.selectedClosedCaptionId_&&this.displayer_.append([s]))}for(a=(n=$jscomp.makeIterator(i.keys())).next();!a.done;a=n.next())for(a=a.value,this.closedCaptionsMap_.has(a)||this.closedCaptionsMap_.set(a,new Map),o=(e=$jscomp.makeIterator(i.get(a).keys())).next();!o.done;o=e.next())o=o.value,s=i.get(a).get(o),this.closedCaptionsMap_.get(a).set(o,s);this.bufferStart_=null==this.bufferStart_?Math.max(t,this.appendWindowStart_):Math.min(this.bufferStart_,Math.max(t,this.appendWindowStart_)),this.bufferEnd_=Math.max(this.bufferEnd_,Math.min(r,this.appendWindowEnd_))},shaka.text.TextEngine.prototype.getNumberOfClosedCaptionChannels=function(){return this.closedCaptionsMap_.size},shaka.text.TextEngine.prototype.getNumberOfClosedCaptionsInChannel=function(e){return(e=this.closedCaptionsMap_.get(e))?e.size:0},goog.exportSymbol("shaka.text.TextEngine",shaka.text.TextEngine),goog.exportProperty(shaka.text.TextEngine.prototype,"destroy",shaka.text.TextEngine.prototype.destroy),goog.exportProperty(shaka.text.TextEngine,"findParser",shaka.text.TextEngine.findParser),goog.exportProperty(shaka.text.TextEngine,"unregisterParser",shaka.text.TextEngine.unregisterParser),goog.exportProperty(shaka.text.TextEngine,"registerParser",shaka.text.TextEngine.registerParser),shaka.text.TextEngine.parserMap_={},shaka.util.Functional=function(){},shaka.util.Functional.createFallbackPromiseChain=function(e,t){return e.reduce((function(e,r){return e.catch((function(){return t(r)}))}),Promise.reject())},shaka.util.Functional.collapseArrays=function(e,t){return e.concat(t)},shaka.util.Functional.ignored=function(){},shaka.util.Functional.noop=function(){},shaka.util.Functional.isNotNull=function(e){return null!=e},shaka.util.LanguageUtils=function(){},shaka.util.LanguageUtils.areLocaleCompatible=function(e,t){var r=shaka.util.LanguageUtils;return(e=r.normalize(e))==(t=r.normalize(t))},shaka.util.LanguageUtils.areLanguageCompatible=function(e,t){var r=shaka.util.LanguageUtils;return e=r.normalize(e),t=r.normalize(t),e=r.disassembleLocale_(e),t=r.disassembleLocale_(t),e[0]==t[0]},shaka.util.LanguageUtils.isParentOf=function(e,t){var r=shaka.util.LanguageUtils;return e=r.normalize(e),t=r.normalize(t),e=r.disassembleLocale_(e),t=r.disassembleLocale_(t),e[0]==t[0]&&1==e.length&&2==t.length},shaka.util.LanguageUtils.isSiblingOf=function(e,t){var r=shaka.util.LanguageUtils;return e=r.normalize(e),t=r.normalize(t),e=r.disassembleLocale_(e),t=r.disassembleLocale_(t),2==e.length&&2==t.length&&e[0]==t[0]},shaka.util.LanguageUtils.normalize=function(e){var t=shaka.util.LanguageUtils,r=(e=$jscomp.makeIterator(e.split("-x-"))).next().value;r=void 0===r?"":r,e=void 0===(e=e.next().value)?"":e;var n=$jscomp.makeIterator(r.split("-"));return r=void 0===(r=n.next().value)?"":r,n=void 0===(n=n.next().value)?"":n,e=e?"x-"+e:"",r=r.toLowerCase(),r=t.isoMap_.get(r)||r,((t=n.toUpperCase())?r+"-"+t:r)+(e?"-"+e:"")},shaka.util.LanguageUtils.areSiblings=function(e,t){var r=shaka.util.LanguageUtils,n=r.getBase(e);return r=r.getBase(t),e!=n&&t!=r&&n==r},shaka.util.LanguageUtils.relatedness=function(e,t){var r=shaka.util.LanguageUtils;return e=r.normalize(e),(t=r.normalize(t))==e?4:r.isParentOf(t,e)?3:r.isSiblingOf(t,e)?2:r.isParentOf(e,t)?1:0},shaka.util.LanguageUtils.getBase=function(e){var t=shaka.util.LanguageUtils,r=e.indexOf("-");return e=(e=0<=r?e.substring(0,r):e).toLowerCase(),t.isoMap_.get(e)||e},shaka.util.LanguageUtils.getLocaleForText=function(e){var t=shaka.util.LanguageUtils;return goog.asserts.assert(e.type==shaka.util.ManifestParserUtils.ContentType.TEXT,"Can only get language from text streams"),t.normalize(e.language||"und")},shaka.util.LanguageUtils.getLocaleForVariant=function(e){var t=shaka.util.LanguageUtils;return e.language?t.normalize(e.language):e.audio&&e.audio.language?t.normalize(e.audio.language):e.video&&e.video.language?t.normalize(e.video.language):"und"},shaka.util.LanguageUtils.findClosestLocale=function(e,t){var r=shaka.util.LanguageUtils;e=r.normalize(e);var n=new Set,a=$jscomp.makeIterator(t);for(t=a.next();!t.done;t=a.next())n.add(r.normalize(t.value));for(t=(a=$jscomp.makeIterator(n)).next();!t.done;t=a.next())if((t=t.value)==e)return t;for(t=(a=$jscomp.makeIterator(n)).next();!t.done;t=a.next())if(t=t.value,r.isParentOf(t,e))return t;for(t=(a=$jscomp.makeIterator(n)).next();!t.done;t=a.next())if(t=t.value,r.isSiblingOf(t,e))return t;for(t=(n=$jscomp.makeIterator(n)).next();!t.done;t=n.next())if(t=t.value,r.isParentOf(e,t))return t;return null},shaka.util.LanguageUtils.disassembleLocale_=function(e){var t=e.split("-");return goog.asserts.assert(2>=t.length,["Locales should not have more than 2 components. ",e," has too many components."].join()),t},goog.exportSymbol("shaka.util.LanguageUtils",shaka.util.LanguageUtils),goog.exportProperty(shaka.util.LanguageUtils,"findClosestLocale",shaka.util.LanguageUtils.findClosestLocale),goog.exportProperty(shaka.util.LanguageUtils,"getLocaleForVariant",shaka.util.LanguageUtils.getLocaleForVariant),goog.exportProperty(shaka.util.LanguageUtils,"getLocaleForText",shaka.util.LanguageUtils.getLocaleForText),goog.exportProperty(shaka.util.LanguageUtils,"getBase",shaka.util.LanguageUtils.getBase),goog.exportProperty(shaka.util.LanguageUtils,"relatedness",shaka.util.LanguageUtils.relatedness),goog.exportProperty(shaka.util.LanguageUtils,"areSiblings",shaka.util.LanguageUtils.areSiblings),goog.exportProperty(shaka.util.LanguageUtils,"normalize",shaka.util.LanguageUtils.normalize),goog.exportProperty(shaka.util.LanguageUtils,"isSiblingOf",shaka.util.LanguageUtils.isSiblingOf),goog.exportProperty(shaka.util.LanguageUtils,"isParentOf",shaka.util.LanguageUtils.isParentOf),goog.exportProperty(shaka.util.LanguageUtils,"areLanguageCompatible",shaka.util.LanguageUtils.areLanguageCompatible),goog.exportProperty(shaka.util.LanguageUtils,"areLocaleCompatible",shaka.util.LanguageUtils.areLocaleCompatible),shaka.util.LanguageUtils.isoMap_=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]),shaka.util.ObjectUtils=function(){},shaka.util.ObjectUtils.cloneObject=function(e){var t=new WeakSet,r=function(e){switch(typeof e){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return e;default:if(!e||e.buffer instanceof ArrayBuffer)return e;if(t.has(e))return null;var n=e.constructor==Array;if(e.constructor!=Object&&!n)return null;t.add(e);var a,i=n?[]:{};for(a in e)i[a]=r(e[a]);return n&&(i.length=e.length),i}};return r(e)},shaka.util.ObjectUtils.shallowCloneObject=function(e){var t,r={};for(t in e)r[t]=e[t];return r},shaka.util.StreamUtils=function(){},shaka.util.StreamUtils.chooseCodecsAndFilterManifest=function(e,t,r,n){var a=shaka.util.StreamUtils,i=shaka.util.MimeUtils,o=e.variants;if((t.length||r.length)&&(o=a.choosePreferredCodecs(o,t,r)),n.length){for(t=new shaka.util.MultiMap,o=(r=$jscomp.makeIterator(o)).next();!o.done;o=r.next())o=o.value,t.push(String(o.video.width||0),o);var s=[];t.forEach((function(e,t){e=0;for(var r=[],a={},i=(t=$jscomp.makeIterator(t)).next();!i.done;a={$jscomp$loop$prop$variant$543$853:a.$jscomp$loop$prop$variant$543$853},i=t.next())a.$jscomp$loop$prop$variant$543$853=i.value,(i=n.filter(function(e){return function(t){return e.$jscomp$loop$prop$variant$543$853.decodingInfos[0][t]}}(a)).length)>e?(e=i,r=[a.$jscomp$loop$prop$variant$543$853]):i==e&&r.push(a.$jscomp$loop$prop$variant$543$853);s.push.apply(s,$jscomp.arrayFromIterable(r))})),o=s}for(r=new Set,t=new Set,o=(a=$jscomp.makeIterator(o)).next();!o.done;o=a.next())(o=o.value).audio&&r.add(o.audio),o.video&&t.add(o.video);r=Array.from(r).sort((function(e,t){return e.bandwidth-t.bandwidth}));var l=[];for(o=new Map,a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next()){var u=(a=a.value).language+(a.channelsCount||0)+(a.audioSamplingRate||0)+a.roles.join(",")+a.label+a.groupId+a.fastSwitching,c=o.get(u)||[];if(c.length){var d=c[c.length-1],p=i.getNormalizedCodec(d.codecs),h=i.getNormalizedCodec(a.codecs);p==h&&a.bandwidth>d.bandwidth&&(c.push(a),l.push(a.id))}else c.push(a),l.push(a.id);o.set(u,c)}r=Array.from(t).sort((function(e,t){return e.bandwidth&&t.bandwidth?e.bandwidth-t.bandwidth:e.width-t.width})),t=shaka.media.Capabilities.isChangeTypeSupported();var f=[];for(o=new Map,a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next()){if(a=a.value,u=Math.round(a.frameRate||0)+(a.hdr||"")+a.fastSwitching,(c=o.get(u)||[]).length){if(d=c[c.length-1],!t&&(p=i.getNormalizedCodec(d.codecs))!==(h=i.getNormalizedCodec(a.codecs)))continue;a.width>d.width||a.height>d.height?(c.push(a),f.push(a.id)):a.width==d.width&&a.height==d.height&&((p=i.getNormalizedCodec(d.codecs))==(h=i.getNormalizedCodec(a.codecs))&&a.bandwidth>d.bandwidth&&(c.push(a),f.push(a.id)))}else c.push(a),f.push(a.id);o.set(u,c)}e.variants=e.variants.filter((function(e){var t=e.audio,r=e.video;return!(t&&!l.includes(t.id)||r&&!f.includes(r.id))||(shaka.log.debug("Dropping Variant (better codec available)",e),!1)}))},shaka.util.StreamUtils.choosePreferredCodecs=function(e,t,r){for(var n={},a=(t=$jscomp.makeIterator(t)).next();!a.done;n={$jscomp$loop$prop$videoCodec$855:n.$jscomp$loop$prop$videoCodec$855},a=t.next())if(n.$jscomp$loop$prop$videoCodec$855=a.value,(a=e.filter(function(e){return function(t){return t.video&&t.video.codecs.startsWith(e.$jscomp$loop$prop$videoCodec$855)}}(n))).length){e=a;break}for(n={},t=(r=$jscomp.makeIterator(r)).next();!t.done;n={$jscomp$loop$prop$audioCodec$857:n.$jscomp$loop$prop$audioCodec$857},t=r.next())if(n.$jscomp$loop$prop$audioCodec$857=t.value,(t=e.filter(function(e){return function(t){return t.audio&&t.audio.codecs.startsWith(e.$jscomp$loop$prop$audioCodec$857)}}(n))).length){e=t;break}return e},shaka.util.StreamUtils.filterByRestrictions=function(e,t,r){e.variants=e.variants.filter((function(e){return shaka.util.StreamUtils.meetsRestrictions(e,t,r)}))},shaka.util.StreamUtils.meetsRestrictions=function(e,t,r){var n=function(e,t,r){return e>=t&&e<=r},a=e.video;if(a&&a.width&&a.height){var i=a.width,o=a.height;if(o>i&&(i=(o=$jscomp.makeIterator([o,i])).next().value,o=o.next().value),!n(i,t.minWidth,Math.min(t.maxWidth,r.width))||!n(o,t.minHeight,Math.min(t.maxHeight,r.height))||!n(a.width*a.height,t.minPixels,t.maxPixels))return!1}return!(e&&e.video&&e.video.frameRate&&!n(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||!n(e.bandwidth,t.minBandwidth,t.maxBandwidth))},shaka.util.StreamUtils.applyRestrictions=function(e,t,r){for(var n=!1,a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next()){var i=(a=a.value).allowedByApplication;a.allowedByApplication=shaka.util.StreamUtils.meetsRestrictions(a,t,r),i!=a.allowedByApplication&&(n=!0)}return n},shaka.util.StreamUtils.filterManifest=function(e,t,r){return r=void 0===r?[]:r,$jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?n.yield(shaka.util.StreamUtils.filterManifestByMediaCapabilities(e,t,0<t.offlineSessionIds.length,r),2):(shaka.util.StreamUtils.filterTextStreams_(t),n.yield(shaka.util.StreamUtils.filterImageStreams_(t),0))}))},shaka.util.StreamUtils.filterManifestByMediaCapabilities=function(e,t,r,n){var a,i,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){if(1==s.nextAddress)return goog.asserts.assert(navigator.mediaCapabilities,"MediaCapabilities should be valid."),s.yield(shaka.util.StreamUtils.getDecodingInfosForVariants(t.variants,r,!1,n),2);a=null,e&&(i=e.getDrmInfo())&&(a=i.keySystem),o=shaka.util.StreamUtils,t.variants=t.variants.filter((function(e){var t=o.checkVariantSupported_(e,a);return t||shaka.log.debug("Dropping variant - not compatible with platform",o.getVariantSummaryString_(e)),t})),s.jumpToEnd()}))},shaka.util.StreamUtils.checkVariantSupported_=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType,n=shaka.media.Capabilities,a=shaka.util.ManifestParserUtils,i=shaka.util.MimeUtils,o=shaka.util.StreamUtils,s=shaka.util.Platform.isXboxOne(),l=shaka.util.Platform.isFirefox()&&shaka.util.Platform.isAndroid(),u=e.video,c=u&&u.width||0,d=u&&u.height||0;if(s&&u&&(1920<c||1080<d)&&(u.codecs.includes("avc1.")||u.codecs.includes("avc3.")))return!1;if(u){if(s=o.getCorrectVideoCodecs(u.codecs),u.codecs.includes(",")){if(c=u.codecs.split(","),s=a.guessCodecs(r.VIDEO,c),s=o.getCorrectVideoCodecs(s),a=a.guessCodecs(r.AUDIO,c),a=o.getCorrectAudioCodecs(a,u.mimeType),c=i.getFullOrConvertedType(u.mimeType,a,r.AUDIO),!n.isTypeSupported(c))return!1;s=[s,a].join()}if(a=i.getFullOrConvertedType(u.mimeType,s,r.VIDEO),!n.isTypeSupported(a))return!1;u.codecs=s}if(u=e.audio,l&&u&&u.encrypted&&u.codecs.toLowerCase().includes("opus"))return!1;if(u){if(o=o.getCorrectAudioCodecs(u.codecs,u.mimeType),r=i.getFullOrConvertedType(u.mimeType,o,r.AUDIO),!n.isTypeSupported(r))return!1;u.codecs=o}return e.decodingInfos.some((function(e){return!(!e.supported||t&&(e=e.keySystemAccess)&&e.keySystem!=t)}))},shaka.util.StreamUtils.alphabeticalKeyOrderStringify_=function(e){var t=[];for(r in e)t.push(r);t.sort();for(var r=[],n=(t=$jscomp.makeIterator(t)).next();!n.done;n=t.next()){var a=n.value;n=JSON.stringify(a),(a=e[a])instanceof Object?(a=shaka.util.StreamUtils.alphabeticalKeyOrderStringify_(a),r.push(n+":"+a)):(a=JSON.stringify(a),r.push(n+":"+a))}return"{"+r.join(",")+"}"},shaka.util.StreamUtils.getDecodingInfosForVariant_=function(e,t){var r,n,a,i,o,s,l,u;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){for(r=function(e,t){if(e){var r=shaka.util.ObjectUtils.shallowCloneObject(e);return r.supported=e.supported&&t.supported,r.powerEfficient=e.powerEfficient&&t.powerEfficient,r.smooth=e.smooth&&t.smooth,t.keySystemAccess&&!r.keySystemAccess&&(r.keySystemAccess=t.keySystemAccess),r}return t},n=shaka.util.StreamUtils,a=null,i=[],o={},s=$jscomp.makeIterator(t),l=s.next();!l.done;o={$jscomp$loop$prop$cache$859:o.$jscomp$loop$prop$cache$859,$jscomp$loop$prop$cacheKey$860:o.$jscomp$loop$prop$cacheKey$860},l=s.next())u=l.value,o.$jscomp$loop$prop$cacheKey$860=n.alphabeticalKeyOrderStringify_(u),o.$jscomp$loop$prop$cache$859=n.decodingConfigCache_,o.$jscomp$loop$prop$cache$859[o.$jscomp$loop$prop$cacheKey$860]?(shaka.log.v2("Using cached results of mediaCapabilities.decodingInfo","for key",o.$jscomp$loop$prop$cacheKey$860),a=r(a,o.$jscomp$loop$prop$cache$859[o.$jscomp$loop$prop$cacheKey$860])):i.push(n.checkEachDecodingConfigCombination_(u).then(function(e){return function(t){for(var n=null,i=(t=$jscomp.makeIterator(t||[])).next();!i.done;i=t.next())n=r(n,i.value);n&&(e.$jscomp$loop$prop$cache$859[e.$jscomp$loop$prop$cacheKey$860]=n,a=r(a,n))}}(o)));return c.yield(Promise.all(i),2)}a&&e.decodingInfos.push(a),c.jumpToEnd()}))},shaka.util.StreamUtils.checkEachDecodingConfigCombination_=function(e){var t=[""];e.video&&(t=shaka.util.MimeUtils.getCodecs(e.video.contentType).split(","));var r=[""];e.audio&&(r=shaka.util.MimeUtils.getCodecs(e.audio.contentType).split(","));for(var n=[],a=(t=$jscomp.makeIterator(t)).next();!a.done;a=t.next()){a=a.value;for(var i={},o=$jscomp.makeIterator(r),s=o.next();!s.done;i={$jscomp$loop$prop$copy$862:i.$jscomp$loop$prop$copy$862},s=o.next()){if(s=s.value,i.$jscomp$loop$prop$copy$862=shaka.util.ObjectUtils.cloneObject(e),e.video){var l=shaka.util.MimeUtils.getBasicType(i.$jscomp$loop$prop$copy$862.video.contentType);i.$jscomp$loop$prop$copy$862.video.contentType=shaka.util.MimeUtils.getFullType(l,a)}e.audio&&(l=shaka.util.MimeUtils.getBasicType(i.$jscomp$loop$prop$copy$862.audio.contentType),i.$jscomp$loop$prop$copy$862.audio.contentType=shaka.util.MimeUtils.getFullType(l,s)),n.push(new Promise(function(e){return function(t,r){navigator.mediaCapabilities.decodingInfo(e.$jscomp$loop$prop$copy$862).then((function(e){t(e)})).catch(r)}}(i)))}}return Promise.all(n).catch((function(t){return shaka.log.info("MediaCapabilities.decodingInfo() failed.",JSON.stringify(e),t),null}))},shaka.util.StreamUtils.getDecodingInfosForVariants=function(e,t,r,n){var a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_;return $jscomp.asyncExecutePromiseGeneratorProgram((function(k){switch(k.nextAddress){case 1:if(e.some((function(e){return e.decodingInfos.length})))return shaka.log.debug("Already got the variants' decodingInfo."),k.return();a={},i=$jscomp.makeIterator(n),o=i.next();case 2:if(o.done){k.jumpTo(4);break}a.$jscomp$loop$prop$preferredKeySystem$864=o.value,s=!1,l=$jscomp.makeIterator(e),u=l.next();case 5:if(u.done){k.jumpTo(7);break}c=u.value,d=shaka.util.StreamUtils.getDecodingConfigs_(c,t,r).filter((E=a,function(e){return((e=e[0]).keySystemConfiguration&&e.keySystemConfiguration.keySystem)===E.$jscomp$loop$prop$preferredKeySystem$864})),p=$jscomp.makeIterator(d),h=p.next();case 8:if(h.done){k.jumpTo(10);break}return f=h.value,k.yield(shaka.util.StreamUtils.getDecodingInfosForVariant_(c,f),9);case 9:h=p.next(),k.jumpTo(8);break;case 10:c.decodingInfos.length&&(s=!0),u=l.next(),k.jumpTo(5);break;case 7:if(s)return k.return();a={$jscomp$loop$prop$preferredKeySystem$864:a.$jscomp$loop$prop$preferredKeySystem$864},o=i.next(),k.jumpTo(2);break;case 4:m=$jscomp.makeIterator(e),u=m.next();case 12:if(u.done){k.jumpTo(0);break}g=u.value,y=shaka.util.StreamUtils.getDecodingConfigs_(g,t,r).filter((function(e){return!(e=(e=e[0]).keySystemConfiguration&&e.keySystemConfiguration.keySystem)||!n.includes(e)})),v=$jscomp.makeIterator(y),h=v.next();case 15:if(h.done){u=m.next(),k.jumpTo(12);break}return _=h.value,k.yield(shaka.util.StreamUtils.getDecodingInfosForVariant_(g,_),16);case 16:h=v.next(),k.jumpTo(15)}var E}))},shaka.util.StreamUtils.getDecodingConfigs_=function(e,t,r){var n=e.audio,a=e.video,i=shaka.util.ManifestParserUtils.ContentType,o=shaka.util.ManifestParserUtils,s=shaka.util.MimeUtils,l=shaka.util.StreamUtils,u=[],c=[];if(a)for(var d=$jscomp.makeIterator(a.fullMimeTypes),p=d.next();!p.done;p=d.next()){p=p.value;var h=s.getCodecs(p);if(h.includes(",")&&!n){var f=h.split(","),m=s.getBasicType(p);h=o.guessCodecs(i.VIDEO,f),f=o.guessCodecs(i.AUDIO,f),f=l.getCorrectAudioCodecs(f,m),m=s.getFullOrConvertedType(m,f,i.AUDIO),c.push({contentType:m,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1})}if(h=l.getCorrectVideoCodecs(h),p={contentType:s.getFullOrConvertedType(s.getBasicType(p),h,i.VIDEO),width:a.width||64,height:a.height||64,bitrate:a.bandwidth||e.bandwidth||1,framerate:a.frameRate||1},a.hdr)switch(a.hdr){case"SDR":p.transferFunction="srgb";break;case"PQ":p.transferFunction="pq";break;case"HLG":p.transferFunction="hlg"}u.push(p)}if(n)for(p=(o=$jscomp.makeIterator(n.fullMimeTypes)).next();!p.done;p=o.next())p=p.value,d=s.getBasicType(p),p=l.getCorrectAudioCodecs(s.getCodecs(p),d),d=s.getFullOrConvertedType(d,p,i.AUDIO),c.push({contentType:d,channels:n.channelsCount||2,bitrate:n.bandwidth||e.bandwidth||1,samplerate:n.audioSamplingRate||1,spatialRendering:n.spatialAudio});for(i=[],0==u.length&&u.push(null),0==c.length&&c.push(null),s=(u=$jscomp.makeIterator(u)).next();!s.done;s=u.next())for(s=s.value,o=(l=$jscomp.makeIterator(c)).next();!o.done;o=l.next())o=o.value,d={type:r?"file":"media-source"},s&&(d.video=s),o&&(d.audio=o),i.push(d);if(!(c=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])).length)return[i];for(e=[],r=new Map,m=(c=$jscomp.makeIterator(c)).next();!m.done;m=c.next())u=m.value,r.get(u.keySystem)||r.set(u.keySystem,[]),r.get(u.keySystem).push(u);for(c=t?"required":"optional",t=t?["persistent-license"]:["temporary"],s=(u=$jscomp.makeIterator(r.keys())).next();!s.done;s=u.next()){for(s=s.value,l=[],d=(o=$jscomp.makeIterator(i)).next();!d.done;d=o.next()){for(d=Object.assign({},d.value),h=r.get(s),p={keySystem:s,initDataType:"cenc",persistentState:c,distinctiveIdentifier:"optional",sessionTypes:t},m=(h=$jscomp.makeIterator(h)).next();!m.done;m=h.next()){if((m=m.value).initData&&m.initData.length){f=new Set;for(var g=$jscomp.makeIterator(m.initData),y=g.next();!y.done;y=g.next())f.add(y.value.initDataType);1<f.size&&shaka.log.v2("DrmInfo contains more than one initDataType,","and we use the initDataType of the first initData.",m),p.initDataType=m.initData[0].initDataType}m.distinctiveIdentifierRequired&&(p.distinctiveIdentifier="required"),m.persistentStateRequired&&(p.persistentState="required"),m.sessionType&&(p.sessionTypes=[m.sessionType]),n&&(""!=m.audioRobustness?p.audio?p.audio.robustness=p.audio.robustness||m.audioRobustness:p.audio={robustness:m.audioRobustness}:p.audio||(p.audio={})),a&&(""!=m.videoRobustness?p.video?p.video.robustness=p.video.robustness||m.videoRobustness:p.video={robustness:m.videoRobustness}:p.video||(p.video={}))}d.keySystemConfiguration=p,l.push(d)}e.push(l)}return e},shaka.util.StreamUtils.getCorrectAudioCodecs=function(e,t){return"flac"==e.toLowerCase()?shaka.util.Platform.isSafari()?"fLaC":"flac":"opus"===e.toLowerCase()?shaka.util.Platform.isSafari()&&"mp4"==shaka.util.MimeUtils.getContainerType(t)?"Opus":"opus":e},shaka.util.StreamUtils.getCorrectVideoCodecs=function(e){if(e.includes("avc1")){var t=e.split(".");if(3==t.length)return e=t.shift()+".",(e+=parseInt(t.shift(),10).toString(16))+("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if("vp9"==e)return"vp09.00.41.08";return e},shaka.util.StreamUtils.filterManifestByCurrentVariant=function(e,t){var r=shaka.util.StreamUtils;t.variants=t.variants.filter((function(t){var n=t.audio;return t=t.video,n&&e&&e.audio&&!r.areStreamsCompatible_(n,e.audio)?(shaka.log.debug("Dropping variant - not compatible with active audio","active audio",r.getStreamSummaryString_(e.audio),"variant.audio",r.getStreamSummaryString_(n)),!1):!(t&&e&&e.video&&!r.areStreamsCompatible_(t,e.video))||(shaka.log.debug("Dropping variant - not compatible with active video","active video",r.getStreamSummaryString_(e.video),"variant.video",r.getStreamSummaryString_(t)),!1)}))},shaka.util.StreamUtils.filterTextStreams_=function(e){e.textStreams=e.textStreams.filter((function(e){var t=shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs);return(t=shaka.text.TextEngine.isTypeSupported(t))||shaka.log.debug("Dropping text stream. Is not supported by the platform.",e),t}))},shaka.util.StreamUtils.filterImageStreams_=function(e){var t,r,n,a,i,o,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:t=[],r=$jscomp.makeIterator(e.imageStreams),n=r.next();case 2:if(n.done){l.jumpTo(4);break}if(a=n.value,"application/mp4"==(i=a.mimeType)&&"mjpg"==a.codecs&&(i="image/jpg"),shaka.util.StreamUtils.supportedImageMimeTypes_.has(i)){l.jumpTo(5);break}if(!(o=shaka.util.StreamUtils.minImage_.get(i))){shaka.util.StreamUtils.supportedImageMimeTypes_.set(i,!1),l.jumpTo(5);break}return l.yield(shaka.util.StreamUtils.isImageSupported_(o),7);case 7:s=l.yieldResult,shaka.util.StreamUtils.supportedImageMimeTypes_.set(i,s);case 5:shaka.util.StreamUtils.supportedImageMimeTypes_.get(i)?t.push(a):shaka.log.debug("Dropping image stream. Is not supported by the platform.",a),n=r.next(),l.jumpTo(2);break;case 4:e.imageStreams=t,l.jumpToEnd()}}))},shaka.util.StreamUtils.isImageSupported_=function(e){return new Promise((function(t){var r=new Image;r.src=e,"decode"in r?r.decode().then((function(){t(!0)})).catch((function(){t(!1)})):r.onload=r.onerror=function(){t(2===r.height)}}))},shaka.util.StreamUtils.areStreamsCompatible_=function(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]},shaka.util.StreamUtils.variantToTrack=function(e){var t=e.audio,r=e.video,n=t?t.mimeType:null,a=r?r.mimeType:null,i=t?t.codecs:null,o=r?r.codecs:null,s=[];o&&s.push(o),i&&s.push(i);var l=[];r&&l.push(r.mimeType),t&&l.push(t.mimeType),l=l[0]||null;var u=[];t&&u.push(t.kind),r&&u.push(r.kind),u=u[0]||null;var c=new Set;if(t)for(var d=$jscomp.makeIterator(t.roles),p=d.next();!p.done;p=d.next())c.add(p.value);if(r)for(p=(d=$jscomp.makeIterator(r.roles)).next();!p.done;p=d.next())c.add(p.value);return e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:u,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,videoLayout:null,mimeType:l,audioMimeType:n,videoMimeType:a,codecs:s.join(", "),audioCodec:i,videoCodec:o,primary:e.primary,roles:Array.from(c),audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},r&&(e.videoId=r.id,e.originalVideoId=r.originalId,e.width=r.width||null,e.height=r.height||null,e.frameRate=r.frameRate||null,e.pixelAspectRatio=r.pixelAspectRatio||null,e.videoBandwidth=r.bandwidth||null,e.hdr=r.hdr||null,e.videoLayout=r.videoLayout||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles,e.accessibilityPurpose=t.accessibilityPurpose,e.originalLanguage=t.originalLanguage),e},shaka.util.StreamUtils.textStreamToTrack=function(e){return{id:e.id,active:!1,type:shaka.util.ManifestParserUtils.ContentType.TEXT,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,forced:e.forced,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId,originalImageId:null,accessibilityPurpose:e.accessibilityPurpose,originalLanguage:e.originalLanguage}},shaka.util.StreamUtils.imageStreamToTrack=function(e){var t=shaka.util.ManifestParserUtils.ContentType,r=e.width||null,n=e.height||null,a=null;e.segmentIndex&&(a=e.segmentIndex.get(0));var i=e.tilesLayout;return a&&(i=a.getTilesLayout()||i),i&&null!=r&&(r/=Number(i.split("x")[0])),i&&null!=n&&(n/=Number(i.split("x")[1])),{id:e.id,active:!1,type:t.IMAGE,bandwidth:e.bandwidth||0,language:"",label:null,kind:null,width:r,height:n,frameRate:null,pixelAspectRatio:null,hdr:null,videoLayout:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:i||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:e.originalId,accessibilityPurpose:null,originalLanguage:null}},shaka.util.StreamUtils.html5TrackId=function(e){return e.__shaka_id||(e.__shaka_id=shaka.util.StreamUtils.nextTrackId_++),e.__shaka_id},shaka.util.StreamUtils.html5TextTrackToTrack=function(e){var t=shaka.util.StreamUtils.html5TrackToGenericShakaTrack_(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="unknown"),"subtitles"==e.kind&&(t.mimeType="text/vtt"),e.kind&&(t.roles=[e.kind]),"forced"==e.kind&&(t.forced=!0),t},shaka.util.StreamUtils.html5AudioTrackToTrack=function(e){var t=shaka.util.StreamUtils.html5TrackToGenericShakaTrack_(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind],t.label=e.label),t},shaka.util.StreamUtils.html5TrackToGenericShakaTrack_=function(e){var t=e.language;return{id:shaka.util.StreamUtils.html5TrackId(e),active:!1,type:"",bandwidth:0,language:shaka.util.LanguageUtils.normalize(t||"und"),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,videoLayout:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:t}},shaka.util.StreamUtils.isPlayable=function(e){return e.allowedByApplication&&e.allowedByKeySystem&&0==e.disabledUntilTime},shaka.util.StreamUtils.getPlayableVariants=function(e){return e.filter((function(e){return shaka.util.StreamUtils.isPlayable(e)}))},shaka.util.StreamUtils.filterStreamsByLanguageAndRole=function(e,t,r,n){var a=shaka.util.LanguageUtils,i=e,o=e.filter((function(e){return e.primary}));o.length&&(i=o);var s=i.length?i[0].language:"";if(i=i.filter((function(e){return e.language==s})),t){var l=a.findClosestLocale(a.normalize(t),e.map((function(e){return e.language})));l&&(i=e.filter((function(e){return a.normalize(e.language)==l})))}if(i=i.filter((function(e){return e.forced==n})),r){if((e=shaka.util.StreamUtils.filterStreamsByRole_(i,r)).length)return e;shaka.log.warning("No exact match for the text role could be found.")}else if((e=i.filter((function(e){return 0==e.roles.length}))).length)return e;return(e=i.map((function(e){return e.roles})).reduce(shaka.util.Functional.collapseArrays,[])).length?shaka.util.StreamUtils.filterStreamsByRole_(i,e[0]):i},shaka.util.StreamUtils.filterStreamsByRole_=function(e,t){return e.filter((function(e){return e.roles.includes(t)}))},shaka.util.StreamUtils.isAudio=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.AUDIO},shaka.util.StreamUtils.isVideo=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.VIDEO},shaka.util.StreamUtils.getVariantStreams=function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t},shaka.util.StreamUtils.isFastSwitching=function(e){return!!(e.audio&&e.audio.fastSwitching||e.video&&e.video.fastSwitching)},shaka.util.StreamUtils.getVariantSummaryString_=function(e){var t=[];return e.audio&&t.push(shaka.util.StreamUtils.getStreamSummaryString_(e.audio)),e.video&&t.push(shaka.util.StreamUtils.getStreamSummaryString_(e.video)),t.join(", ")},shaka.util.StreamUtils.getStreamSummaryString_=function(e){return shaka.util.StreamUtils.isAudio(e)?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:shaka.util.StreamUtils.isVideo(e)?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"},goog.exportSymbol("shaka.util.StreamUtils",shaka.util.StreamUtils),goog.exportProperty(shaka.util.StreamUtils,"meetsRestrictions",shaka.util.StreamUtils.meetsRestrictions),shaka.util.StreamUtils.decodingConfigCache_={},shaka.util.StreamUtils.nextTrackId_=0,shaka.util.StreamUtils.DecodingAttributes={SMOOTH:"smooth",POWER:"powerEfficient"},shaka.util.StreamUtils.supportedImageMimeTypes_=(new Map).set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),shaka.util.StreamUtils.minWebPImage_="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA",shaka.util.StreamUtils.minAvifImage_="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",shaka.util.StreamUtils.minImage_=(new Map).set("image/webp",shaka.util.StreamUtils.minWebPImage_).set("image/avif",shaka.util.StreamUtils.minAvifImage_),shaka.abr.SimpleAbrManager=function(){var e=this;this.switch_=null,this.enabled_=!1,this.bandwidthEstimator_=new shaka.abr.EwmaBandwidthEstimator,this.eventManager_=new shaka.util.EventManager,navigator.connection&&navigator.connection.addEventListener&&this.eventManager_.listen(navigator.connection,"change",(function(){if(e.enabled_&&e.config_.useNetworkInformation){e.bandwidthEstimator_=new shaka.abr.EwmaBandwidthEstimator,e.config_&&e.bandwidthEstimator_.configure(e.config_.advanced);var t=e.chooseVariant();t&&navigator.onLine&&e.switch_(t,e.config_.clearBufferSwitch,e.config_.safeMarginSwitch)}})),this.variants_=[],this.playbackRate_=1,this.startupComplete_=!1,this.resizeObserver_=this.mediaElement_=this.config_=this.lastTimeChosenMs_=null,this.resizeObserverTimer_=new shaka.util.Timer((function(){if(e.config_.restrictToElementSize){var t=e.chooseVariant();t&&e.switch_(t,e.config_.clearBufferSwitch,e.config_.safeMarginSwitch)}})),this.cmsdManager_=null},shaka.abr.SimpleAbrManager.prototype.stop=function(){this.switch_=null,this.enabled_=!1,this.variants_=[],this.playbackRate_=1,this.mediaElement_=this.lastTimeChosenMs_=null,this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null),this.resizeObserverTimer_.stop(),this.cmsdManager_=null},shaka.abr.SimpleAbrManager.prototype.release=function(){this.eventManager_.release(),this.resizeObserverTimer_=null},shaka.abr.SimpleAbrManager.prototype.init=function(e){this.switch_=e},shaka.abr.SimpleAbrManager.prototype.chooseVariant=function(e){e=void 0!==e&&e;var t=1/0,r=1/0;if(this.config_.restrictToScreenSize&&(r=this.config_.ignoreDevicePixelRatio?1:window.devicePixelRatio,t=window.screen.height*r,r*=window.screen.width),this.resizeObserver_&&this.config_.restrictToElementSize){var n=this.config_.ignoreDevicePixelRatio?1:window.devicePixelRatio;t=Math.min(t,this.mediaElement_.clientHeight*n),r=Math.min(r,this.mediaElement_.clientWidth*n)}var a=this.variants_.filter((function(e){return!shaka.util.StreamUtils.isFastSwitching(e)}));if(a.length||(a=this.variants_),n=a,e&&a.length!=this.variants_.length&&(n=this.variants_.filter((function(e){return shaka.util.StreamUtils.isFastSwitching(e)}))),e=this.filterAndSortVariants_(this.config_.restrictions,n,1/0,1/0),1/0!=t||1/0!=r){for(e=this.getResolutionList_(e),a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())if((a=a.value).height>=t&&a.width>=r){t=a.height,r=a.width;break}e=this.filterAndSortVariants_(this.config_.restrictions,n,t,r)}for(t=this.getBandwidthEstimate(),n.length&&!e.length&&(shaka.log.warning("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),e=[(e=this.filterAndSortVariants_(null,n,1/0,1/0))[0]]),r=e[0]||null,n=0;n<e.length;n++){a=e[n];for(var i=isNaN(this.playbackRate_)?1:Math.abs(this.playbackRate_),o=i*a.bandwidth,s=o/this.config_.bandwidthDowngradeTarget,l={bandwidth:1/0},u=n+1;u<e.length;u++)if(a.bandwidth!=e[u].bandwidth){l=e[u];break}i=i*l.bandwidth/this.config_.bandwidthUpgradeTarget,shaka.log.v2("Bandwidth ranges:",(o/1e6).toFixed(3),(s/1e6).toFixed(3),(i/1e6).toFixed(3)),t>=s&&t<=i&&r.bandwidth!=a.bandwidth&&(r=a)}return this.lastTimeChosenMs_=Date.now(),r},shaka.abr.SimpleAbrManager.prototype.enable=function(){this.enabled_=!0},shaka.abr.SimpleAbrManager.prototype.disable=function(){this.enabled_=!1},shaka.abr.SimpleAbrManager.prototype.segmentDownloaded=function(e,t,r,n){shaka.log.v2("Segment downloaded:","contentType="+(n&&n.contentType),"deltaTimeMs="+e,"numBytes="+t,"lastTimeChosenMs="+this.lastTimeChosenMs_,"enabled="+this.enabled_),goog.asserts.assert(0<=e,"expected a non-negative duration"),this.bandwidthEstimator_.sample(e,t),r&&null!=this.lastTimeChosenMs_&&this.enabled_&&this.suggestStreams_()},shaka.abr.SimpleAbrManager.prototype.trySuggestStreams=function(){null!=this.lastTimeChosenMs_&&this.enabled_&&this.suggestStreams_()},shaka.abr.SimpleAbrManager.prototype.getBandwidthEstimate=function(){var e=this.getDefaultBandwidth_();return e=this.bandwidthEstimator_.getBandwidthEstimate(e),this.cmsdManager_?this.cmsdManager_.getBandwidthEstimate(e):e},shaka.abr.SimpleAbrManager.prototype.setVariants=function(e){this.variants_=e},shaka.abr.SimpleAbrManager.prototype.playbackRateChanged=function(e){this.playbackRate_=e},shaka.abr.SimpleAbrManager.prototype.setMediaElement=function(e){var t=this;this.mediaElement_=e,this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null),this.mediaElement_&&"ResizeObserver"in window&&(this.resizeObserver_=new ResizeObserver((function(){t.resizeObserverTimer_.tickAfter(shaka.abr.SimpleAbrManager.RESIZE_OBSERVER_BATCH_TIME)})),this.resizeObserver_.observe(this.mediaElement_))},shaka.abr.SimpleAbrManager.prototype.setCmsdManager=function(e){this.cmsdManager_=e},shaka.abr.SimpleAbrManager.prototype.configure=function(e){this.config_=e,this.bandwidthEstimator_&&this.config_&&this.bandwidthEstimator_.configure(this.config_.advanced)},shaka.abr.SimpleAbrManager.prototype.suggestStreams_=function(){if(shaka.log.v2("Suggesting Streams..."),goog.asserts.assert(null!=this.lastTimeChosenMs_,"lastTimeChosenMs_ should not be null"),this.startupComplete_){if(Date.now()-this.lastTimeChosenMs_<1e3*this.config_.switchInterval)return void shaka.log.v2("Still within switch interval...")}else{if(!this.bandwidthEstimator_.hasGoodEstimate())return void shaka.log.v2("Still waiting for a good estimate...");this.startupComplete_=!0}var e=this.chooseVariant(),t=this.getBandwidthEstimate();t=Math.round(t/1e3),e&&(shaka.log.debug("Calling switch_(), bandwidth="+t+" kbps"),this.switch_(e,this.config_.clearBufferSwitch,this.config_.safeMarginSwitch))},shaka.abr.SimpleAbrManager.prototype.getDefaultBandwidth_=function(){var e=this.config_.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&this.config_.useNetworkInformation&&(e=1e6*navigator.connection.downlink),e},shaka.abr.SimpleAbrManager.prototype.filterAndSortVariants_=function(e,t,r,n){if(this.cmsdManager_){var a=this.cmsdManager_.getMaxBitrate();a&&(t=t.filter((function(e){return!e.bandwidth||!a||e.bandwidth<=a})))}return e&&(t=t.filter((function(t){return goog.asserts.assert(e,"Restrictions should exist!"),shaka.util.StreamUtils.meetsRestrictions(t,e,{width:n,height:r})}))),t.sort((function(e,t){return e.bandwidth-t.bandwidth}))},shaka.abr.SimpleAbrManager.prototype.getResolutionList_=function(e){for(var t=[],r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=r.value.video)&&r.height&&r.width&&t.push({height:r.height,width:r.width});return t.sort((function(e,t){return e.width-t.width}))},goog.exportSymbol("shaka.abr.SimpleAbrManager",shaka.abr.SimpleAbrManager),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"configure",shaka.abr.SimpleAbrManager.prototype.configure),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"setCmsdManager",shaka.abr.SimpleAbrManager.prototype.setCmsdManager),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"setMediaElement",shaka.abr.SimpleAbrManager.prototype.setMediaElement),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"playbackRateChanged",shaka.abr.SimpleAbrManager.prototype.playbackRateChanged),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"setVariants",shaka.abr.SimpleAbrManager.prototype.setVariants),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"getBandwidthEstimate",shaka.abr.SimpleAbrManager.prototype.getBandwidthEstimate),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"trySuggestStreams",shaka.abr.SimpleAbrManager.prototype.trySuggestStreams),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"segmentDownloaded",shaka.abr.SimpleAbrManager.prototype.segmentDownloaded),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"disable",shaka.abr.SimpleAbrManager.prototype.disable),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"enable",shaka.abr.SimpleAbrManager.prototype.enable),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"chooseVariant",shaka.abr.SimpleAbrManager.prototype.chooseVariant),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"init",shaka.abr.SimpleAbrManager.prototype.init),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"release",shaka.abr.SimpleAbrManager.prototype.release),goog.exportProperty(shaka.abr.SimpleAbrManager.prototype,"stop",shaka.abr.SimpleAbrManager.prototype.stop),shaka.abr.SimpleAbrManager.RESIZE_OBSERVER_BATCH_TIME=1,shaka.config={},shaka.config.AutoShowText={NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3},goog.exportSymbol("shaka.config.AutoShowText",shaka.config.AutoShowText),shaka.config.CodecSwitchingStrategy={RELOAD:"reload",SMOOTH:"smooth"},goog.exportSymbol("shaka.config.CodecSwitchingStrategy",shaka.config.CodecSwitchingStrategy),shaka.media.AdaptationSet=function(e,t,r,n){for(r=void 0===r||r,n=void 0!==n&&n,this.root_=e,this.variants_=new Set([e]),t=t||[],t=(e=$jscomp.makeIterator(t)).next();!t.done;t=e.next())this.add(t.value,r,n)},shaka.media.AdaptationSet.prototype.add=function(e,t,r){return this.canInclude(e,t,r)?(this.variants_.add(e),!0):(shaka.log.warning("Rejecting variant - not compatible with root."),!1)},shaka.media.AdaptationSet.prototype.canInclude=function(e,t,r){return shaka.media.AdaptationSet.areAdaptable(this.root_,e,void 0===t||t,void 0!==r&&r)},shaka.media.AdaptationSet.areAdaptable=function(e,t,r,n){var a=shaka.media.AdaptationSet;return!!e.audio==!!t.audio&&!!e.video==!!t.video&&e.language==t.language&&(goog.asserts.assert(!!e.audio==!!t.audio,"Both should either have audio or not have audio."),!(e.audio&&t.audio&&!a.areAudiosCompatible_(e.audio,t.audio,r,n))&&(goog.asserts.assert(!!e.video==!!t.video,"Both should either have video or not have video."),!(e.video&&t.video&&!a.areVideosCompatible_(e.video,t.video,r))))},shaka.media.AdaptationSet.prototype.values=function(){return this.variants_.values()},shaka.media.AdaptationSet.areAudiosCompatible_=function(e,t,r,n){var a=shaka.media.AdaptationSet;return!((!e.channelsCount||!t.channelsCount||2<e.channelsCount||2<t.channelsCount)&&e.channelsCount!=t.channelsCount||r&&!a.canTransitionBetween_(e,t)||!a.areRolesEqual_(e.roles,t.roles)||n&&e.groupId!==t.groupId)},shaka.media.AdaptationSet.areVideosCompatible_=function(e,t,r){var n=shaka.media.AdaptationSet;return!(r&&!n.canTransitionBetween_(e,t)||!n.areRolesEqual_(e.roles,t.roles))},shaka.media.AdaptationSet.canTransitionBetween_=function(e,t){if(e.mimeType!=t.mimeType)return!1;if(e=shaka.util.MimeUtils.splitCodecs(e.codecs).map((function(e){return shaka.util.MimeUtils.getCodecBase(e)})),t=shaka.util.MimeUtils.splitCodecs(t.codecs).map((function(e){return shaka.util.MimeUtils.getCodecBase(e)})),e.length!=t.length)return!1;e.sort(),t.sort();for(var r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0},shaka.media.AdaptationSet.areRolesEqual_=function(e,t){if(e=new Set(e),t=new Set(t),e.delete("main"),t.delete("main"),e.size!=t.size)return!1;for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())if(!t.has(r.value))return!1;return!0},shaka.media.AdaptationSetCriteria=function(){},shaka.media.AdaptationSetCriteria.prototype.create=function(e){},shaka.media.ExampleBasedCriteria=function(e,t,r){t=void 0===t?shaka.config.CodecSwitchingStrategy.RELOAD:t,r=void 0!==r&&r,this.example_=e,this.codecSwitchingStrategy_=t,this.enableAudioGroups_=r,this.fallback_=new shaka.media.PreferenceBasedCriteria(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"",!1,"","","",t,r)},shaka.media.ExampleBasedCriteria.prototype.create=function(e){var t=this,r=this.codecSwitchingStrategy_==shaka.config.CodecSwitchingStrategy.SMOOTH&&shaka.media.Capabilities.isChangeTypeSupported(),n=e.filter((function(e){return shaka.media.AdaptationSet.areAdaptable(t.example_,e,!r,t.enableAudioGroups_)}));return n.length?new shaka.media.AdaptationSet(n[0],n,!r,this.enableAudioGroups_):this.fallback_.create(e)},shaka.media.PreferenceBasedCriteria=function(e,t,r,n,a,i,o,s,l,u){l=void 0===l?shaka.config.CodecSwitchingStrategy.RELOAD:l,this.language_=e,this.role_=t,this.channelCount_=r,this.hdrLevel_=n,this.spatialAudio_=a,this.videoLayout_=i,this.audioLabel_=void 0===o?"":o,this.videoLabel_=void 0===s?"":s,this.codecSwitchingStrategy_=l,this.enableAudioGroups_=void 0!==u&&u},shaka.media.PreferenceBasedCriteria.prototype.create=function(e){var t=shaka.media.PreferenceBasedCriteria,r=[];r=t.filterByLanguage_(e,this.language_);var n=e.filter((function(e){return e.primary}));return r=r.length?r:n.length?n:e,(e=t.filterVariantsByRole_(r,this.role_)).length?r=e:shaka.log.warning("No exact match for variant role could be found."),this.videoLayout_&&((e=t.filterVariantsByVideoLayout_(r,this.videoLayout_)).length?r=e:shaka.log.warning("No exact match for the video layout could be found.")),this.hdrLevel_&&((e=t.filterVariantsByHDRLevel_(r,this.hdrLevel_)).length?r=e:shaka.log.warning("No exact match for the hdr level could be found.")),this.channelCount_&&((e=t.filterVariantsByAudioChannelCount_(r,this.channelCount_)).length?r=e:shaka.log.warning("No exact match for the channel count could be found.")),this.audioLabel_&&((e=t.filterVariantsByAudioLabel_(r,this.audioLabel_)).length?r=e:shaka.log.warning("No exact match for audio label could be found.")),this.videoLabel_&&((e=t.filterVariantsByVideoLabel_(r,this.videoLabel_)).length?r=e:shaka.log.warning("No exact match for video label could be found.")),(t=t.filterVariantsBySpatialAudio_(r,this.spatialAudio_)).length?r=t:shaka.log.warning("No exact match for spatial audio could be found."),t=this.codecSwitchingStrategy_==shaka.config.CodecSwitchingStrategy.SMOOTH&&shaka.media.Capabilities.isChangeTypeSupported(),new shaka.media.AdaptationSet(r[0],r,!t,this.enableAudioGroups_)},shaka.media.PreferenceBasedCriteria.filterByLanguage_=function(e,t){var r=shaka.util.LanguageUtils;t=r.normalize(t);var n=r.findClosestLocale(t,e.map((function(e){return r.getLocaleForVariant(e)})));return n?e.filter((function(e){return n==r.getLocaleForVariant(e)})):[]},shaka.media.PreferenceBasedCriteria.filterVariantsByRole_=function(e,t){return e.filter((function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)}))},shaka.media.PreferenceBasedCriteria.filterVariantsByAudioLabel_=function(e,t){return e.filter((function(e){return!(!e.audio||!e.audio.label)&&(e=e.audio.label.toLowerCase())==t.toLowerCase()}))},shaka.media.PreferenceBasedCriteria.filterVariantsByVideoLabel_=function(e,t){return e.filter((function(e){return!(!e.video||!e.video.label)&&(e=e.video.label.toLowerCase())==t.toLowerCase()}))},shaka.media.PreferenceBasedCriteria.filterVariantsByAudioChannelCount_=function(e,t){return e.filter((function(e){return!e.audio||!e.audio.channelsCount||e.audio.channelsCount==t}))},shaka.media.PreferenceBasedCriteria.filterVariantsByHDRLevel_=function(e,t){return"AUTO"==t&&(t=window.matchMedia("(color-gamut: p3)").matches?"PQ":"SDR"),e.filter((function(e){return!e.video||!e.video.hdr||e.video.hdr==t}))},shaka.media.PreferenceBasedCriteria.filterVariantsByVideoLayout_=function(e,t){return e.filter((function(e){return!e.video||!e.video.videoLayout||e.video.videoLayout==t}))},shaka.media.PreferenceBasedCriteria.filterVariantsBySpatialAudio_=function(e,t){return e.filter((function(e){return!e.audio||e.audio.spatialAudio==t}))},shaka.media.BufferingObserver=function(e,t){var r=shaka.media.BufferingObserver.State;this.previousState_=r.SATISFIED,this.thresholds_=(new Map).set(r.SATISFIED,t).set(r.STARVING,e),this.lastRebufferTime_=0},shaka.media.BufferingObserver.prototype.setThresholds=function(e,t){var r=shaka.media.BufferingObserver.State;this.thresholds_.set(r.SATISFIED,t).set(r.STARVING,e)},shaka.media.BufferingObserver.prototype.update=function(e,t){var r=shaka.media.BufferingObserver.State,n=this.thresholds_.get(this.previousState_),a=this.previousState_;return this.previousState_=e=t||e>=n?r.SATISFIED:r.STARVING,(a=a!=e)&&e===r.SATISFIED&&(this.lastRebufferTime_=Date.now()),a},shaka.media.BufferingObserver.prototype.setState=function(e){this.previousState_=e},shaka.media.BufferingObserver.prototype.getState=function(){return this.previousState_},shaka.media.BufferingObserver.prototype.getLastRebufferTime=function(){return this.lastRebufferTime_},shaka.media.BufferingObserver.prototype.resetLastRebufferTime=function(){this.lastRebufferTime_=0},shaka.media.BufferingObserver.State={STARVING:0,SATISFIED:1},shaka.net={},shaka.net.Backoff=function(e,t){t=void 0!==t&&t;var r=shaka.net.Backoff.defaultRetryParameters();this.maxAttempts_=null==e.maxAttempts?r.maxAttempts:e.maxAttempts,goog.asserts.assert(1<=this.maxAttempts_,"maxAttempts should be >= 1"),this.baseDelay_=null==e.baseDelay?r.baseDelay:e.baseDelay,goog.asserts.assert(0<=this.baseDelay_,"baseDelay should be >= 0"),this.fuzzFactor_=null==e.fuzzFactor?r.fuzzFactor:e.fuzzFactor,goog.asserts.assert(0<=this.fuzzFactor_,"fuzzFactor should be >= 0"),this.backoffFactor_=null==e.backoffFactor?r.backoffFactor:e.backoffFactor,goog.asserts.assert(0<=this.backoffFactor_,"backoffFactor should be >= 0"),this.numAttempts_=0,this.nextUnfuzzedDelay_=this.baseDelay_,(this.autoReset_=t)&&(goog.asserts.assert(2<=this.maxAttempts_,"maxAttempts must be >= 2 for autoReset == true"),this.numAttempts_=1)},shaka.net.Backoff.prototype.attempt=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress){if(r.numAttempts_>=r.maxAttempts_){if(!r.autoReset_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.ATTEMPTS_EXHAUSTED);r.reset_()}return e=r.numAttempts_,r.numAttempts_++,0==e?(goog.asserts.assert(!r.autoReset_,"Failed to delay with auto-reset!"),n.return()):(t=shaka.net.Backoff.fuzz_(r.nextUnfuzzedDelay_,r.fuzzFactor_),n.yield(new Promise((function(e){shaka.net.Backoff.defer(t,e)})),2))}r.nextUnfuzzedDelay_*=r.backoffFactor_,n.jumpToEnd()}))},shaka.net.Backoff.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}},shaka.net.Backoff.fuzz_=function(e,t){return e*(1+(2*Math.random()-1)*t)},shaka.net.Backoff.prototype.reset_=function(){goog.asserts.assert(this.autoReset_,"Should only be used for auto-reset!"),this.numAttempts_=1,this.nextUnfuzzedDelay_=this.baseDelay_},shaka.net.Backoff.defer=function(e,t){new shaka.util.Timer(t).tickAfter(e/1e3)},shaka.util.PublicPromise=function(){var e,t,r=new Promise((function(r,n){e=r,t=n}));return r.resolve=e,r.reject=t,r},shaka.util.PublicPromise.prototype.resolve=function(e){},shaka.util.PublicPromise.prototype.reject=function(e){},shaka.util.AbortableOperation=function(e,t){this.promise=e,this.onAbort_=t,this.aborted_=!1},shaka.util.AbortableOperation.failed=function(e){return new shaka.util.AbortableOperation(Promise.reject(e),(function(){return Promise.resolve()}))},shaka.util.AbortableOperation.aborted=function(){var e=Promise.reject(shaka.util.AbortableOperation.abortError());return e.catch((function(){})),new shaka.util.AbortableOperation(e,(function(){return Promise.resolve()}))},shaka.util.AbortableOperation.abortError=function(){return new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED)},shaka.util.AbortableOperation.completed=function(e){return new shaka.util.AbortableOperation(Promise.resolve(e),(function(){return Promise.resolve()}))},shaka.util.AbortableOperation.notAbortable=function(e){return new shaka.util.AbortableOperation(e,(function(){return e.catch((function(){}))}))},shaka.util.AbortableOperation.prototype.abort=function(){return this.aborted_=!0,this.onAbort_()},shaka.util.AbortableOperation.all=function(e){return new shaka.util.AbortableOperation(Promise.all(e.map((function(e){return e.promise}))),(function(){return Promise.all(e.map((function(e){return e.abort()})))}))},shaka.util.AbortableOperation.prototype.finally=function(e){return this.promise.then((function(t){return e(!0)}),(function(t){return e(!1)})),this},shaka.util.AbortableOperation.prototype.chain=function(e,t){var r=this,n=new shaka.util.PublicPromise,a=shaka.util.AbortableOperation.abortError(),i=function(){return n.reject(a),r.abort()},o=function(o){return function(s){if(r.aborted_&&o)n.reject(a);else{var l=o?e:t;l?i=shaka.util.AbortableOperation.wrapChainCallback_(l,s,n):(o?n.resolve:n.reject)(s)}}};return this.promise.then(o(!0),o(!1)),new shaka.util.AbortableOperation(n,(function(){return i()}))},shaka.util.AbortableOperation.wrapChainCallback_=function(e,t,r){try{var n=e(t);return n&&n.promise&&n.abort?(r.resolve(n.promise),function(){return n.abort()}):(r.resolve(n),function(){return Promise.resolve(n).then((function(){}),(function(){}))})}catch(e){return r.reject(e),function(){return Promise.resolve()}}},goog.exportSymbol("shaka.util.AbortableOperation",shaka.util.AbortableOperation),goog.exportProperty(shaka.util.AbortableOperation.prototype,"chain",shaka.util.AbortableOperation.prototype.chain),goog.exportProperty(shaka.util.AbortableOperation.prototype,"finally",shaka.util.AbortableOperation.prototype.finally),goog.exportProperty(shaka.util.AbortableOperation,"all",shaka.util.AbortableOperation.all),goog.exportProperty(shaka.util.AbortableOperation.prototype,"abort",shaka.util.AbortableOperation.prototype.abort),goog.exportProperty(shaka.util.AbortableOperation,"notAbortable",shaka.util.AbortableOperation.notAbortable),goog.exportProperty(shaka.util.AbortableOperation,"completed",shaka.util.AbortableOperation.completed),goog.exportProperty(shaka.util.AbortableOperation,"aborted",shaka.util.AbortableOperation.aborted),goog.exportProperty(shaka.util.AbortableOperation,"failed",shaka.util.AbortableOperation.failed),shaka.util.FakeEvent=function(e,t){if(t)if(t instanceof Map)for(var r=$jscomp.makeIterator(t.keys()),n=r.next();!n.done;n=r.next())n=n.value,Object.defineProperty(this,n,{value:t.get(n),writable:!0,enumerable:!0});else for(r in t=shaka.util.FakeEvent.recastDictAsObject_(t))Object.defineProperty(this,r,{value:t[r],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now(),this.type=e,this.isTrusted=!1,this.target=this.currentTarget=null,this.stopped=!1},shaka.util.FakeEvent.fromRealEvent=function(e){var t,r=new shaka.util.FakeEvent(e.type);for(t in e)Object.defineProperty(r,t,{value:e[t],writable:!0,enumerable:!0});return r},shaka.util.FakeEvent.recastDictAsObject_=function(e){return goog.asserts.assert(!(e instanceof Map),"dict should not be a map"),e},shaka.util.FakeEvent.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},shaka.util.FakeEvent.prototype.stopImmediatePropagation=function(){this.stopped=!0},shaka.util.FakeEvent.prototype.stopPropagation=function(){},goog.exportSymbol("shaka.util.FakeEvent",shaka.util.FakeEvent),shaka.util.FakeEvent.EventName={AbrStatusChanged:"abrstatuschanged",Adaptation:"adaptation",Buffering:"buffering",Complete:"complete",DownloadFailed:"downloadfailed",DownloadHeadersReceived:"downloadheadersreceived",DrmSessionUpdate:"drmsessionupdate",Emsg:"emsg",Prft:"prft",Error:"error",ExpirationUpdated:"expirationupdated",FirstQuartile:"firstquartile",GapJumped:"gapjumped",KeyStatusChanged:"keystatuschanged",Loaded:"loaded",Loading:"loading",ManifestParsed:"manifestparsed",ManifestUpdated:"manifestupdated",MediaQualityChanged:"mediaqualitychanged",Metadata:"metadata",Midpoint:"midpoint",NoSpatialVideoInfoEvent:"nospatialvideoinfo",OnStateChange:"onstatechange",RateChange:"ratechange",SegmentAppended:"segmentappended",SessionDataEvent:"sessiondata",SpatialVideoInfoEvent:"spatialvideoinfo",StallDetected:"stalldetected",Started:"started",StateChanged:"statechanged",Streaming:"streaming",TextChanged:"textchanged",TextTrackVisibility:"texttrackvisibility",ThirdQuartile:"thirdquartile",TimelineRegionAdded:"timelineregionadded",TimelineRegionEnter:"timelineregionenter",TimelineRegionExit:"timelineregionexit",TracksChanged:"trackschanged",Unloading:"unloading",VariantChanged:"variantchanged"},shaka.util.FakeEventTarget=function(){this.listeners_=new shaka.util.MultiMap,this.dispatchTarget=this},shaka.util.FakeEventTarget.prototype.addEventListener=function(e,t,r){this.listeners_&&this.listeners_.push(e,t)},shaka.util.FakeEventTarget.prototype.listenToAllEvents=function(e){this.addEventListener(shaka.util.FakeEventTarget.ALL_EVENTS_,e)},shaka.util.FakeEventTarget.prototype.removeEventListener=function(e,t,r){this.listeners_&&this.listeners_.remove(e,t)},shaka.util.FakeEventTarget.prototype.dispatchEvent=function(e){if(goog.asserts.assert(e instanceof shaka.util.FakeEvent,"FakeEventTarget can only dispatch FakeEvents!"),!this.listeners_)return!0;var t=this.listeners_.get(e.type)||[],r=this.listeners_.get(shaka.util.FakeEventTarget.ALL_EVENTS_);for(r&&(t=t.concat(r)),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next()){r=r.value,e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;try{r.handleEvent?r.handleEvent(e):r.call(this,e)}catch(e){shaka.log.error("Uncaught exception in event handler",e,e?e.message:null,e?e.stack:null)}if(e.stopped)break}return e.defaultPrevented},shaka.util.FakeEventTarget.prototype.release=function(){this.listeners_=null},shaka.util.FakeEventTarget.ALL_EVENTS_="All",shaka.util.OperationManager=function(){this.operations_=[]},shaka.util.OperationManager.prototype.manage=function(e){var t=this;this.operations_.push(e.finally((function(){shaka.util.ArrayUtils.remove(t.operations_,e)})))},shaka.util.OperationManager.prototype.destroy=function(){for(var e=[],t=$jscomp.makeIterator(this.operations_),r=t.next();!r.done;r=t.next())(r=r.value).promise.catch((function(){})),e.push(r.abort());return this.operations_=[],Promise.all(e)},shaka.net.NetworkingEngine=function(e,t,r,n,a,i){shaka.util.FakeEventTarget.call(this),this.destroyed_=!1,this.operationManager_=new shaka.util.OperationManager,this.requestFilters_=new Set,this.responseFilters_=new Set,this.onProgressUpdated_=e||null,this.onHeadersReceived_=t||null,this.onDownloadFailed_=r||null,this.onRequest_=n||null,this.onRetry_=a||null,this.onResponse_=i||null,this.forceHTTPS_=!1},$jscomp.inherits(shaka.net.NetworkingEngine,shaka.util.FakeEventTarget),shaka.net.NetworkingEngine.prototype.setForceHTTPS=function(e){this.forceHTTPS_=e},shaka.net.NetworkingEngine.registerScheme=function(e,t,r,n){n=void 0!==n&&n,goog.asserts.assert(null==r||0<r,"explicit priority must be > 0"),r=r||shaka.net.NetworkingEngine.PluginPriority.APPLICATION;var a=shaka.net.NetworkingEngine.schemes_[e];(!a||r>=a.priority)&&(shaka.net.NetworkingEngine.schemes_[e]={priority:r,plugin:t,progressSupport:n})},shaka.net.NetworkingEngine.unregisterScheme=function(e){delete shaka.net.NetworkingEngine.schemes_[e]},shaka.net.NetworkingEngine.prototype.copyFiltersInto=function(e){for(var t=$jscomp.makeIterator(this.requestFilters_),r=t.next();!r.done;r=t.next())e.requestFilters_.add(r.value);for(r=(t=$jscomp.makeIterator(this.responseFilters_)).next();!r.done;r=t.next())e.responseFilters_.add(r.value)},shaka.net.NetworkingEngine.prototype.registerRequestFilter=function(e){this.requestFilters_.add(e)},shaka.net.NetworkingEngine.prototype.unregisterRequestFilter=function(e){this.requestFilters_.delete(e)},shaka.net.NetworkingEngine.prototype.clearAllRequestFilters=function(){this.requestFilters_.clear()},shaka.net.NetworkingEngine.prototype.registerResponseFilter=function(e){this.responseFilters_.add(e)},shaka.net.NetworkingEngine.prototype.unregisterResponseFilter=function(e){this.responseFilters_.delete(e)},shaka.net.NetworkingEngine.prototype.clearAllResponseFilters=function(){this.responseFilters_.clear()},shaka.net.NetworkingEngine.defaultRetryParameters=function(){return shaka.net.Backoff.defaultRetryParameters()},shaka.net.NetworkingEngine.makeRequest=function(e,t,r){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:void 0===r?null:r}},shaka.net.NetworkingEngine.prototype.destroy=function(){return this.destroyed_=!0,this.requestFilters_.clear(),this.responseFilters_.clear(),shaka.util.FakeEventTarget.prototype.release.call(this),this.operationManager_.destroy()},shaka.net.NetworkingEngine.prototype.request=function(e,t,r){var n=this,a=shaka.util.ObjectUtils,i=new shaka.net.NetworkingEngine.NumBytesRemainingClass;if(this.destroyed_)return(a=Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED))).catch((function(){})),new shaka.net.NetworkingEngine.PendingRequest(a,(function(){return Promise.resolve()}),i);goog.asserts.assert(t.uris&&t.uris.length,"Request without URIs!"),t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?a.cloneObject(t.retryParameters):shaka.net.NetworkingEngine.defaultRetryParameters(),t.uris=a.cloneObject(t.uris);var o=(a=this.filterRequest_(e,t,r)).chain((function(){return n.makeRequestWithRetry_(e,t,r,i)})),s=o.chain((function(t){return n.filterResponse_(e,t,r)})),l=Date.now(),u=0;a.promise.then((function(){u=Date.now()-l}),(function(){}));var c=0;o.promise.then((function(){c=Date.now()}),(function(){}));var d=s.chain((function(a){var i=Date.now()-c,o=a.response;return o.timeMs+=u,o.timeMs+=i,a.gotProgress||!n.onProgressUpdated_||o.fromCache||"HEAD"==t.method||e!=shaka.net.NetworkingEngine.RequestType.SEGMENT||(a=n.allowSwitch_(r),n.onProgressUpdated_(o.timeMs,o.data.byteLength,a)),n.onResponse_&&n.onResponse_(e,o,r),o}),(function(e){throw e&&(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type"),e.severity=shaka.util.Error.Severity.CRITICAL),e}));return a=new shaka.net.NetworkingEngine.PendingRequest(d.promise,(function(){return d.abort()}),i),this.operationManager_.manage(a),a},shaka.net.NetworkingEngine.prototype.filterRequest_=function(e,t,r){var n=shaka.util.AbortableOperation.completed(void 0),a=function(a){n=n.chain((function(){return t.body&&(t.body=shaka.util.BufferUtils.toArrayBuffer(t.body)),a(e,t,r)}))};this.onRequest_&&a(this.onRequest_);for(var i=$jscomp.makeIterator(this.requestFilters_),o=i.next();!o.done;o=i.next())a(o.value);return n.chain(void 0,(function(e){if(e instanceof shaka.util.Error&&e.code==shaka.util.Error.Code.OPERATION_ABORTED)throw e;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.REQUEST_FILTER_ERROR,e)}))},shaka.net.NetworkingEngine.prototype.makeRequestWithRetry_=function(e,t,r,n){var a=new shaka.net.Backoff(t.retryParameters,!1);return this.send_(e,t,r,a,0,null,n)},shaka.net.NetworkingEngine.prototype.send_=function(e,t,r,n,a,i,o){var s=this;this.forceHTTPS_&&(t.uris[a]=t.uris[a].replace("http://","https://")),0<a&&this.onRetry_&&this.onRetry_(e,r,t.uris[a],t.uris[a-1]);var l=new goog.Uri(t.uris[a]),u=l.getScheme(),c=!1;u||(u=shaka.net.NetworkingEngine.getLocationProtocol_(),goog.asserts.assert(":"==u[u.length-1],"location.protocol expected to end with a colon!"),u=u.slice(0,-1),l.setScheme(u),t.uris[a]=l.toString()),u=u.toLowerCase();var d=(u=shaka.net.NetworkingEngine.schemes_[u])?u.plugin:null;if(!d)return shaka.util.AbortableOperation.failed(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.UNSUPPORTED_SCHEME,l));var p,h=u.progressSupport,f=null,m=null,g=!1,y=!1;return shaka.util.AbortableOperation.notAbortable(n.attempt()).chain((function(){if(s.destroyed_)return shaka.util.AbortableOperation.aborted();p=Date.now();var n=shaka.net.NetworkingEngine.RequestType.SEGMENT,i=0;t.requestStartTime=Date.now();var l=d(t.uris[a],t,e,(function(a,l,u){if(f&&f.stop(),m&&m.tickAfter(v/1e3),s.onProgressUpdated_&&e==n){i++,t.packetNumber=i;var d=s.allowSwitch_(r);s.onProgressUpdated_(a,l,d,t),c=!0,o.setBytes(u)}}),(function(r){s.onHeadersReceived_&&s.onHeadersReceived_(r,t,e),y=!0,t.timeToFirstByte=Date.now()-t.requestStartTime}));if(!h)return l;var u=t.retryParameters.connectionTimeout;u&&(f=new shaka.util.Timer((function(){g=!0,l.abort()}))).tickAfter(u/1e3);var v=t.retryParameters.stallTimeout;return v&&(m=new shaka.util.Timer((function(){g=!0,l.abort()}))),l})).chain((function(r){f&&f.stop(),m&&m.stop(),null==r.timeMs&&(r.timeMs=Date.now()-p);var n={response:r,gotProgress:c};return!y&&s.onHeadersReceived_&&s.onHeadersReceived_(r.headers,t,e),n}),(function(l){if(f&&f.stop(),m&&m.stop(),s.onDownloadFailed_){var u=null,c=0;l instanceof shaka.util.Error&&(u=l,l.code==shaka.util.Error.Code.BAD_HTTP_STATUS&&(c=l.data[1])),s.onDownloadFailed_(t,u,c,g)}if(s.destroyed_)return shaka.util.AbortableOperation.aborted();if(g&&(l=new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.TIMEOUT,t.uris[a],e)),l instanceof shaka.util.Error){if(l.code==shaka.util.Error.Code.OPERATION_ABORTED)throw l;if(l.code==shaka.util.Error.Code.ATTEMPTS_EXHAUSTED)throw goog.asserts.assert(i,"Should have last error"),i;if(l.severity==shaka.util.Error.Severity.RECOVERABLE)return u=(new Map).set("error",l),u=new shaka.util.FakeEvent("retry",u),s.dispatchEvent(u),a=(a+1)%t.uris.length,s.send_(e,t,r,n,a,l,o)}throw l}))},shaka.net.NetworkingEngine.prototype.filterResponse_=function(e,t,r){for(var n=shaka.util.AbortableOperation.completed(void 0),a={},i=$jscomp.makeIterator(this.responseFilters_),o=i.next();!o.done;a={$jscomp$loop$prop$responseFilter$866:a.$jscomp$loop$prop$responseFilter$866},o=i.next())a.$jscomp$loop$prop$responseFilter$866=o.value,n=n.chain(function(n){return function(){var a=t.response;return a.data&&(a.data=shaka.util.BufferUtils.toArrayBuffer(a.data)),n.$jscomp$loop$prop$responseFilter$866(e,a,r)}}(a));return n.chain((function(){return t}),(function(e){var t=shaka.util.Error.Severity.CRITICAL;if(e instanceof shaka.util.Error){if(e.code==shaka.util.Error.Code.OPERATION_ABORTED)throw e;t=e.severity}throw new shaka.util.Error(t,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.RESPONSE_FILTER_ERROR,e)}))},shaka.net.NetworkingEngine.prototype.allowSwitch_=function(e){if(e){var t=e.segment;if(e=e.stream,t&&e&&e.fastSwitching&&t.isPartial())return!1}return!0},shaka.net.NetworkingEngine.getLocationProtocol_=function(){return location.protocol},goog.exportSymbol("shaka.net.NetworkingEngine",shaka.net.NetworkingEngine),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"request",shaka.net.NetworkingEngine.prototype.request),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"destroy",shaka.net.NetworkingEngine.prototype.destroy),goog.exportProperty(shaka.net.NetworkingEngine,"makeRequest",shaka.net.NetworkingEngine.makeRequest),goog.exportProperty(shaka.net.NetworkingEngine,"defaultRetryParameters",shaka.net.NetworkingEngine.defaultRetryParameters),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"clearAllResponseFilters",shaka.net.NetworkingEngine.prototype.clearAllResponseFilters),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"unregisterResponseFilter",shaka.net.NetworkingEngine.prototype.unregisterResponseFilter),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"registerResponseFilter",shaka.net.NetworkingEngine.prototype.registerResponseFilter),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"clearAllRequestFilters",shaka.net.NetworkingEngine.prototype.clearAllRequestFilters),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"unregisterRequestFilter",shaka.net.NetworkingEngine.prototype.unregisterRequestFilter),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"registerRequestFilter",shaka.net.NetworkingEngine.prototype.registerRequestFilter),goog.exportProperty(shaka.net.NetworkingEngine,"unregisterScheme",shaka.net.NetworkingEngine.unregisterScheme),goog.exportProperty(shaka.net.NetworkingEngine,"registerScheme",shaka.net.NetworkingEngine.registerScheme),goog.exportProperty(shaka.net.NetworkingEngine.prototype,"setForceHTTPS",shaka.net.NetworkingEngine.prototype.setForceHTTPS),shaka.net.NetworkingEngine.NumBytesRemainingClass=function(){this.bytesToLoad_=0},shaka.net.NetworkingEngine.NumBytesRemainingClass.prototype.setBytes=function(e){this.bytesToLoad_=e},shaka.net.NetworkingEngine.NumBytesRemainingClass.prototype.getBytes=function(){return this.bytesToLoad_},goog.exportProperty(shaka.net.NetworkingEngine,"NumBytesRemainingClass",shaka.net.NetworkingEngine.NumBytesRemainingClass),shaka.net.NetworkingEngine.PendingRequest=function(e,t,r){shaka.util.AbortableOperation.call(this,e,t),this.bytesRemaining_=r},$jscomp.inherits(shaka.net.NetworkingEngine.PendingRequest,shaka.util.AbortableOperation),shaka.net.NetworkingEngine.PendingRequest.prototype.getBytesRemaining=function(){return this.bytesRemaining_.getBytes()},goog.exportProperty(shaka.net.NetworkingEngine,"PendingRequest",shaka.net.NetworkingEngine.PendingRequest),shaka.net.NetworkingEngine.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6,ADS:7,CONTENT_STEERING:8},goog.exportProperty(shaka.net.NetworkingEngine,"RequestType",shaka.net.NetworkingEngine.RequestType),shaka.net.NetworkingEngine.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5},goog.exportProperty(shaka.net.NetworkingEngine,"AdvancedRequestType",shaka.net.NetworkingEngine.AdvancedRequestType),shaka.net.NetworkingEngine.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3},goog.exportProperty(shaka.net.NetworkingEngine,"PluginPriority",shaka.net.NetworkingEngine.PluginPriority),shaka.net.NetworkingEngine.schemes_={},shaka.util.Destroyer=function(e){this.destroyed_=!1,this.waitOnDestroy_=new shaka.util.PublicPromise,this.onDestroy_=e},shaka.util.Destroyer.prototype.destroyed=function(){return this.destroyed_},shaka.util.Destroyer.prototype.destroy=function(){var e=this;return this.destroyed_?this.waitOnDestroy_:(this.destroyed_=!0,this.onDestroy_().then((function(){e.waitOnDestroy_.resolve()}),(function(){e.waitOnDestroy_.resolve()})))},shaka.util.Destroyer.prototype.ensureNotDestroyed=function(e){if(this.destroyed_){if(e instanceof shaka.util.Error&&e.code==shaka.util.Error.Code.OBJECT_DESTROYED)throw e;throw shaka.util.Destroyer.destroyedError(e)}},shaka.util.Destroyer.destroyedError=function(e){return new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OBJECT_DESTROYED,e)},shaka.util.Iterables=function(){},shaka.util.Iterables.map=function(e,t){for(var r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())r.push(t(n.value));return r},shaka.util.Iterables.every=function(e,t){for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())if(!t(r.value))return!1;return!0},shaka.util.Iterables.some=function(e,t){for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())if(t(r.value))return!0;return!1},shaka.util.Iterables.filter=function(e,t){for(var r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())t(n=n.value)&&r.push(n);return r},shaka.util.MapUtils=function(){},shaka.util.MapUtils.asMap=function(e){for(var t=new Map,r=$jscomp.makeIterator(Object.keys(e)),n=r.next();!n.done;n=r.next())n=n.value,t.set(n,e[n]);return t},shaka.util.MapUtils.asObject=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},shaka.util.MapUtils.hasSameElements=function(e,t){if(!e&&!t)return!0;if(e&&!t||t&&!e)return!1;if(e.size!=t.size)return!1;for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){var n=$jscomp.makeIterator(r.value);if(r=n.next().value,n=n.next().value,!t.has(r))return!1;if((r=t.get(r))!=n||null==r)return!1}return!0},shaka.util.DataViewReader=function(e,t){this.dataView_=shaka.util.BufferUtils.toDataView(e),this.littleEndian_=t==shaka.util.DataViewReader.Endianness.LITTLE_ENDIAN,this.position_=0},shaka.util.DataViewReader.prototype.getDataView=function(){return this.dataView_},shaka.util.DataViewReader.prototype.hasMoreData=function(){return this.position_<this.dataView_.byteLength},shaka.util.DataViewReader.prototype.getPosition=function(){return this.position_},shaka.util.DataViewReader.prototype.getLength=function(){return this.dataView_.byteLength},shaka.util.DataViewReader.prototype.readUint8=function(){try{var e=this.dataView_.getUint8(this.position_);return this.position_+=1,e}catch(e){throw this.outOfBounds_()}},shaka.util.DataViewReader.prototype.readUint16=function(){try{var e=this.dataView_.getUint16(this.position_,this.littleEndian_);return this.position_+=2,e}catch(e){throw this.outOfBounds_()}},shaka.util.DataViewReader.prototype.readUint32=function(){try{var e=this.dataView_.getUint32(this.position_,this.littleEndian_);return this.position_+=4,e}catch(e){throw this.outOfBounds_()}},shaka.util.DataViewReader.prototype.readInt32=function(){try{var e=this.dataView_.getInt32(this.position_,this.littleEndian_);return this.position_+=4,e}catch(e){throw this.outOfBounds_()}},shaka.util.DataViewReader.prototype.readUint64=function(){try{if(this.littleEndian_)var e=this.dataView_.getUint32(this.position_,!0),t=this.dataView_.getUint32(this.position_+4,!0);else t=this.dataView_.getUint32(this.position_,!1),e=this.dataView_.getUint32(this.position_+4,!1)}catch(e){throw this.outOfBounds_()}if(2097151<t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.JS_INTEGER_OVERFLOW);return this.position_+=8,t*Math.pow(2,32)+e},shaka.util.DataViewReader.prototype.readBytes=function(e){if(goog.asserts.assert(0<=e,"Bad call to DataViewReader.readBytes"),this.position_+e>this.dataView_.byteLength)throw this.outOfBounds_();var t=shaka.util.BufferUtils.toUint8(this.dataView_,this.position_,e);return this.position_+=e,t},shaka.util.DataViewReader.prototype.skip=function(e){if(goog.asserts.assert(0<=e,"Bad call to DataViewReader.skip"),this.position_+e>this.dataView_.byteLength)throw this.outOfBounds_();this.position_+=e},shaka.util.DataViewReader.prototype.rewind=function(e){if(goog.asserts.assert(0<=e,"Bad call to DataViewReader.rewind"),this.position_<e)throw this.outOfBounds_();this.position_-=e},shaka.util.DataViewReader.prototype.seek=function(e){if(goog.asserts.assert(0<=e,"Bad call to DataViewReader.seek"),0>e||e>this.dataView_.byteLength)throw this.outOfBounds_();this.position_=e},shaka.util.DataViewReader.prototype.readTerminatedString=function(){for(var e=this.position_;this.hasMoreData()&&0!=this.dataView_.getUint8(this.position_);)this.position_+=1;return e=shaka.util.BufferUtils.toUint8(this.dataView_,e,this.position_-e),this.position_+=1,shaka.util.StringUtils.fromUTF8(e)},shaka.util.DataViewReader.prototype.outOfBounds_=function(){return new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS)},goog.exportSymbol("shaka.util.DataViewReader",shaka.util.DataViewReader),goog.exportProperty(shaka.util.DataViewReader.prototype,"readTerminatedString",shaka.util.DataViewReader.prototype.readTerminatedString),goog.exportProperty(shaka.util.DataViewReader.prototype,"seek",shaka.util.DataViewReader.prototype.seek),goog.exportProperty(shaka.util.DataViewReader.prototype,"rewind",shaka.util.DataViewReader.prototype.rewind),goog.exportProperty(shaka.util.DataViewReader.prototype,"skip",shaka.util.DataViewReader.prototype.skip),goog.exportProperty(shaka.util.DataViewReader.prototype,"readBytes",shaka.util.DataViewReader.prototype.readBytes),goog.exportProperty(shaka.util.DataViewReader.prototype,"readUint64",shaka.util.DataViewReader.prototype.readUint64),goog.exportProperty(shaka.util.DataViewReader.prototype,"readInt32",shaka.util.DataViewReader.prototype.readInt32),goog.exportProperty(shaka.util.DataViewReader.prototype,"readUint32",shaka.util.DataViewReader.prototype.readUint32),goog.exportProperty(shaka.util.DataViewReader.prototype,"readUint16",shaka.util.DataViewReader.prototype.readUint16),goog.exportProperty(shaka.util.DataViewReader.prototype,"readUint8",shaka.util.DataViewReader.prototype.readUint8),goog.exportProperty(shaka.util.DataViewReader.prototype,"getLength",shaka.util.DataViewReader.prototype.getLength),goog.exportProperty(shaka.util.DataViewReader.prototype,"getPosition",shaka.util.DataViewReader.prototype.getPosition),goog.exportProperty(shaka.util.DataViewReader.prototype,"hasMoreData",shaka.util.DataViewReader.prototype.hasMoreData),shaka.util.DataViewReader.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:1},goog.exportProperty(shaka.util.DataViewReader,"Endianness",shaka.util.DataViewReader.Endianness),shaka.util.Mp4Parser=function(){this.headers_=[],this.boxDefinitions_=[],this.done_=!1},shaka.util.Mp4Parser.prototype.box=function(e,t){return e=shaka.util.Mp4Parser.typeFromString_(e),this.headers_[e]=shaka.util.Mp4Parser.BoxType_.BASIC_BOX,this.boxDefinitions_[e]=t,this},shaka.util.Mp4Parser.prototype.fullBox=function(e,t){return e=shaka.util.Mp4Parser.typeFromString_(e),this.headers_[e]=shaka.util.Mp4Parser.BoxType_.FULL_BOX,this.boxDefinitions_[e]=t,this},shaka.util.Mp4Parser.prototype.stop=function(){this.done_=!0},shaka.util.Mp4Parser.prototype.parse=function(e,t,r){for(e=new shaka.util.DataViewReader(e,shaka.util.DataViewReader.Endianness.BIG_ENDIAN),this.done_=!1;e.hasMoreData()&&!this.done_;)this.parseNext(0,e,t,r)},shaka.util.Mp4Parser.prototype.parseNext=function(e,t,r,n){var a=t.getPosition();if(n&&a+8>t.getLength())this.done_=!0;else{var i=t.readUint32(),o=t.readUint32(),s=shaka.util.Mp4Parser.typeToString(o),l=!1;switch(shaka.log.v2("Parsing MP4 box",s),i){case 0:i=t.getLength()-a;break;case 1:if(n&&t.getPosition()+8>t.getLength())return void(this.done_=!0);i=t.readUint64(),l=!0}var u=this.boxDefinitions_[o];if(u){var c=null,d=null;if(this.headers_[o]==shaka.util.Mp4Parser.BoxType_.FULL_BOX){if(n&&t.getPosition()+4>t.getLength())return void(this.done_=!0);c=(d=t.readUint32())>>>24,d&=16777215}o=a+i,r&&o>t.getLength()&&(o=t.getLength()),n&&o>t.getLength()?this.done_=!0:(n=o-t.getPosition(),t=0<n?t.readBytes(n):new Uint8Array(0),u({name:s,parser:this,partialOkay:r||!1,version:c,flags:d,reader:t=new shaka.util.DataViewReader(t,shaka.util.DataViewReader.Endianness.BIG_ENDIAN),size:i,start:a+e,has64BitSize:l}))}else e=Math.min(a+i-t.getPosition(),t.getLength()-t.getPosition()),t.skip(e)}},shaka.util.Mp4Parser.children=function(e){for(var t=shaka.util.Mp4Parser.headerSize(e);e.reader.hasMoreData()&&!e.parser.done_;)e.parser.parseNext(e.start+t,e.reader,e.partialOkay)},shaka.util.Mp4Parser.sampleDescription=function(e){for(var t=shaka.util.Mp4Parser.headerSize(e),r=e.reader.readUint32(),n=0;n<r&&(e.parser.parseNext(e.start+t,e.reader,e.partialOkay),!e.parser.done_);n++);},shaka.util.Mp4Parser.visualSampleEntry=function(e){var t=shaka.util.Mp4Parser.headerSize(e);for(e.reader.skip(78);e.reader.hasMoreData()&&!e.parser.done_;)e.parser.parseNext(e.start+t,e.reader,e.partialOkay)},shaka.util.Mp4Parser.audioSampleEntry=function(e){var t=shaka.util.Mp4Parser.headerSize(e);e.reader.skip(8);var r=e.reader.readUint16();for(e.reader.skip(6),2==r?e.reader.skip(48):e.reader.skip(12),1==r&&e.reader.skip(16);e.reader.hasMoreData()&&!e.parser.done_;)e.parser.parseNext(e.start+t,e.reader,e.partialOkay)},shaka.util.Mp4Parser.allData=function(e){return function(t){var r=t.reader.getLength()-t.reader.getPosition();e(t.reader.readBytes(r))}},shaka.util.Mp4Parser.typeFromString_=function(e){goog.asserts.assert(4==e.length,"Mp4 box names must be 4 characters long");for(var t=0,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())t=t<<8|r.value.charCodeAt(0);return t},shaka.util.Mp4Parser.typeToString=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},shaka.util.Mp4Parser.headerSize=function(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)},goog.exportSymbol("shaka.util.Mp4Parser",shaka.util.Mp4Parser),goog.exportProperty(shaka.util.Mp4Parser,"headerSize",shaka.util.Mp4Parser.headerSize),goog.exportProperty(shaka.util.Mp4Parser,"typeToString",shaka.util.Mp4Parser.typeToString),goog.exportProperty(shaka.util.Mp4Parser,"allData",shaka.util.Mp4Parser.allData),goog.exportProperty(shaka.util.Mp4Parser,"audioSampleEntry",shaka.util.Mp4Parser.audioSampleEntry),goog.exportProperty(shaka.util.Mp4Parser,"visualSampleEntry",shaka.util.Mp4Parser.visualSampleEntry),goog.exportProperty(shaka.util.Mp4Parser,"sampleDescription",shaka.util.Mp4Parser.sampleDescription),goog.exportProperty(shaka.util.Mp4Parser,"children",shaka.util.Mp4Parser.children),goog.exportProperty(shaka.util.Mp4Parser.prototype,"parseNext",shaka.util.Mp4Parser.prototype.parseNext),goog.exportProperty(shaka.util.Mp4Parser.prototype,"parse",shaka.util.Mp4Parser.prototype.parse),goog.exportProperty(shaka.util.Mp4Parser.prototype,"stop",shaka.util.Mp4Parser.prototype.stop),goog.exportProperty(shaka.util.Mp4Parser.prototype,"fullBox",shaka.util.Mp4Parser.prototype.fullBox),goog.exportProperty(shaka.util.Mp4Parser.prototype,"box",shaka.util.Mp4Parser.prototype.box),shaka.util.Mp4Parser.BoxType_={BASIC_BOX:0,FULL_BOX:1},shaka.util.Pssh=function(e){var t=this;this.systemIds=[],this.cencKeyIds=[],this.data=[],(new shaka.util.Mp4Parser).box("moov",shaka.util.Mp4Parser.children).box("moof",shaka.util.Mp4Parser.children).fullBox("pssh",(function(e){return t.parsePsshBox_(e)})).parse(e),0==this.data.length&&shaka.log.v2("No pssh box found!")},shaka.util.Pssh.prototype.parsePsshBox_=function(e){if(goog.asserts.assert(null!=e.version,"PSSH boxes are full boxes and must have a valid version"),goog.asserts.assert(null!=e.flags,"PSSH boxes are full boxes and must have a valid flag"),1<e.version)shaka.log.warning("Unrecognized PSSH version found!");else{var t=e.reader.getDataView();if(goog.asserts.assert(12<=t.byteOffset,"DataView at incorrect position"),t=shaka.util.BufferUtils.toUint8(t,-12,e.size),this.data.push(t),this.systemIds.push(shaka.util.Uint8ArrayUtils.toHex(e.reader.readBytes(16))),0<e.version){t=e.reader.readUint32();for(var r=0;r<t;r++){var n=shaka.util.Uint8ArrayUtils.toHex(e.reader.readBytes(16));this.cencKeyIds.push(n)}}}},shaka.util.Pssh.createPssh=function(e,t,r,n){goog.asserts.assert(16==t.byteLength,"Invalid system ID length");var a=e.length,i=12+t.length+4+a;0<n&&(i+=4+16*r.size);var o=new Uint8Array(i),s=shaka.util.BufferUtils.toDataView(o),l=0;if(s.setUint32(l,i),l+=4,s.setUint32(l,1886614376),l+=4,1>n?s.setUint32(l,0):s.setUint32(l,16777216),l+=4,o.set(t,l),l+=t.length,0<n)for(s.setUint32(l,r.size),l+=4,t=shaka.util.Uint8ArrayUtils,n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next())n=t.fromHex(n.value),o.set(n,l),l+=n.length;return s.setUint32(l,a),l+=4,o.set(e,l),goog.asserts.assert(l+a===i,"PSSH invalid length."),o},shaka.util.Pssh.normaliseInitData=function(e){if(!e)return e;var t=new shaka.util.Pssh(e);if(1>=t.data.length)return e;e=[];for(var r={},n=(t=$jscomp.makeIterator(t.data)).next();!n.done;r={$jscomp$loop$prop$initData$569$868:r.$jscomp$loop$prop$initData$569$868},n=t.next())r.$jscomp$loop$prop$initData$569$868=n.value,e.some(function(e){return function(t){return shaka.util.BufferUtils.equal(t,e.$jscomp$loop$prop$initData$569$868)}}(r))||e.push(r.$jscomp$loop$prop$initData$569$868);return shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(e))},shaka.util.TXml=function(){},shaka.util.TXml.parseXml=function(e,t){return e=shaka.util.StringUtils.fromBytesAutoDetect(e),shaka.util.TXml.parseXmlString(e,t)},shaka.util.TXml.parseXmlString=function(e,t){return e=shaka.util.TXml.parse(e),!t&&e.length?e[0]:(e=e.find((function(e){return e.tagName===t})))?e:(shaka.log.error("parseXml root element not found!"),null)},shaka.util.TXml.getKnownNameSpace=function(e){return shaka.util.TXml.knownNameSpaces_.has(e)?shaka.util.TXml.knownNameSpaces_.get(e):""},shaka.util.TXml.setKnownNameSpace=function(e,t){shaka.util.TXml.knownNameSpaces_.set(e,t)},shaka.util.TXml.parse=function(e){function t(){for(var t=r;-1==="\r\n\t>/= ".indexOf(e[r])&&e[r];)r++;return e.slice(t,r)}var r=0;return function n(a,i){i=void 0!==i&&i;for(var o=[];e[r];)if(60==e.charCodeAt(r)){if(47===e.charCodeAt(r+1)){i=r+2,r=e.indexOf(">",r);var s=(i=e.substring(i,r)).indexOf(a);if(-1==s){var l=a.indexOf(".");0<l&&(a=a.substring(0,l),s=i.indexOf(a))}if(-1==s)throw o=e.substring(0,r).split("\n"),Error("Unexpected close tag\nLine: "+(o.length-1)+"\nColumn: "+(o[o.length-1].length+1)+"\nChar: "+e[r]);r+1&&(r+=1);break}if(33===e.charCodeAt(r+1)){if(45==e.charCodeAt(r+2)){for(;-1!==r&&(62!==e.charCodeAt(r)||45!=e.charCodeAt(r-1)||45!=e.charCodeAt(r-2)||-1==r);)r=e.indexOf(">",r+1);-1===r&&(r=e.length)}else if(91===e.charCodeAt(r+2)&&91===e.charCodeAt(r+8)&&"cdata"===e.substr(r+3,5).toLowerCase()){-1==(s=e.indexOf("]]>",r))?(o.push(e.substr(r+9)),r=e.length):(o.push(e.substring(r+9,s)),r=s+3);continue}r++;continue}e:{l=i,r++;var u=t(),c={};for(s=[];62!==e.charCodeAt(r)&&e[r];){var d=e.charCodeAt(r);if(64<d&&91>d||96<d&&123>d){d=t();for(var p=e.charCodeAt(r);p&&39!==p&&34!==p&&!(64<p&&91>p||96<p&&123>p)&&62!==p;)r++,p=e.charCodeAt(r);var h=r+1;if(r=e.indexOf(e[r],h),h=e.slice(h,r),39===p||34===p){if(-1===r){for(l={tagName:u,attributes:c,children:s,parent:null},u=0;u<s.length;u++)"string"!=typeof s[u]&&(s[u].parent=l);s=l;break e}}else h=null,r--;d.startsWith("xmlns:")&&(p=d.split(":"),shaka.util.TXml.setKnownNameSpace(h,p[1])),"tt"===u&&"xml:space"===d&&"preserve"===h&&(l=!0),c[d]=h}r++}for(47!==e.charCodeAt(r-1)?(r++,s=n(u,l)):r++,l={tagName:u,attributes:c,children:s,parent:null},u=s.length,c=0;c<u;c++)"string"!=typeof(d=s[c])?d.parent=l:c==u-1&&"\n"==d&&s.pop();s=l}if(o.push(s),"string"==typeof s)break;"?"===s.tagName[0]&&s.children&&(o.push.apply(o,$jscomp.arrayFromIterable(s.children)),s.children=[])}else s=r,-2===(r=e.indexOf("<",r)-1)&&(r=e.length),s=e.slice(s,r+1),i?0<s.length&&o.push(s):(o.length&&1==s.length&&"\n"==s[0]||0<s.trim().length)&&o.push(s),r++;return o}("")},shaka.util.TXml.isNode=function(e){return!!e.tagName},shaka.util.TXml.isText=function(e){return"string"==typeof e},shaka.util.TXml.getChildNodes=function(e){var t=[];if(!e.children)return[];for(var r=(e=$jscomp.makeIterator(e.children)).next();!r.done;r=e.next())"string"!=typeof(r=r.value)&&t.push(r);return t},shaka.util.TXml.findChildren=function(e,t){var r=[];if(!e.children)return[];for(var n=(e=$jscomp.makeIterator(e.children)).next();!n.done;n=e.next())(n=n.value).tagName===t&&r.push(n);return r},shaka.util.TXml.getTextContents=function(e){var t=shaka.util.StringUtils;return"string"==typeof e?t.htmlUnescape(e):""===(e=e.children.reduce((function(e,t){return"string"==typeof t?e+t:e}),""))?null:t.htmlUnescape(e)},shaka.util.TXml.getContents=function(e){return Array.from(e.children).every((function(e){return"string"==typeof e}))?((e=shaka.util.TXml.getTextContents(e))&&(e=e.trim()),e):null},shaka.util.TXml.getElementsByTagName=function(e,t,r){if(r=void 0===r?[]:r,e.tagName===t&&r.push(e),e.children)for(var n=(e=$jscomp.makeIterator(e.children)).next();!n.done;n=e.next())shaka.util.TXml.getElementsByTagName(n.value,t,r);return r},shaka.util.TXml.findChild=function(e,t){return 1!=(e=shaka.util.TXml.findChildren(e,t)).length?null:e[0]},shaka.util.TXml.findChildNS=function(e,t,r){return 1!=(e=shaka.util.TXml.findChildrenNS(e,t,r)).length?null:e[0]},shaka.util.TXml.parseAttr=function(e,t,r,n){n=void 0===n?null:n;var a=null;return null!=(e=e.attributes[t])&&(a=r(e)),null==a?n:a},shaka.util.TXml.getAttributeNS=function(e,t,r){return t=shaka.util.TXml.getKnownNameSpace(t),e.attributes[t+":"+r]||null},shaka.util.TXml.findChildrenNS=function(e,t,r){t=shaka.util.TXml.getKnownNameSpace(t);var n=[];if(e.children)for(var a=(e=$jscomp.makeIterator(e.children)).next();!a.done;a=e.next())(a=a.value)&&a.tagName===t+":"+r&&n.push(a);return n},shaka.util.TXml.getAttributeNSList=function(e,t,r){for(var n=(t=$jscomp.makeIterator(t)).next();!n.done;n=t.next())if(n=shaka.util.TXml.getAttributeNS(e,n.value,r))return n;return null},shaka.util.TXml.parseDate=function(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null},shaka.util.TXml.parseDuration=function(e){if(!e)return null;var t=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e);return t?(e=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null),isFinite(e)?e:null):(shaka.log.warning("Invalid duration string:",e),null)},shaka.util.TXml.parseRange=function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null},shaka.util.TXml.parseInt=function(e){return 0==(e=Number(e))%1?e:null},shaka.util.TXml.parsePositiveInt=function(e){return 0==(e=Number(e))%1&&0<e?e:null},shaka.util.TXml.parseNonNegativeInt=function(e){return 0==(e=Number(e))%1&&0<=e?e:null},shaka.util.TXml.parseFloat=function(e){return e=Number(e),isNaN(e)?null:e},shaka.util.TXml.parseBoolean=function(e){return!!e&&"true"===e.toLowerCase()},shaka.util.TXml.evalDivision=function(e){var t,r=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(r)?null:r},shaka.util.TXml.parseXpath=function(e){var t=[];e=e.split(/\/+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/);for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){var n=r.value;r=n.match(/\b([A-Z])\w+/),n=n.match(/(@id='(.*?)')/),r&&t.push({name:r[0],id:n?n[0].match(/'(.*?)'/)[0].replace(/'/gm,""):null})}return t},shaka.util.TXml.txmlNodeToDomElement=function(e,t,r){t=void 0===t||t,r=void 0===r||r;var n,a=shaka.util.TXml,i=document.createElement(e.tagName);for(n in e.attributes)i.setAttribute(n,e.attributes[n]);if(t&&e.parent&&"?xml"!=e.parent.tagName&&a.txmlNodeToDomElement(e.parent,!0,!1).appendChild(i),r)for(t=(e=$jscomp.makeIterator(e.children)).next();!t.done;t=e.next())t="string"==typeof(t=t.value)?new Text(t):a.txmlNodeToDomElement(t,!1,!0),i.appendChild(t);return i},shaka.util.TXml.knownNameSpaces_=new Map([]),shaka.media.DrmEngine=function(e){var t=this;this.playerInterface_=e,this.supportedTypes_=new Set,this.video_=this.mediaKeys_=null,this.initializedForStorage_=this.initialized_=!1,this.licenseTimeSeconds_=0,this.currentDrmInfo_=null,this.eventManager_=new shaka.util.EventManager,this.activeSessions_=new Map,this.storedPersistentSessions_=new Map,this.allSessionsLoaded_=new shaka.util.PublicPromise,this.config_=null,this.onError_=function(r){r.severity==shaka.util.Error.Severity.CRITICAL&&t.allSessionsLoaded_.reject(r),e.onError(r)},this.keyStatusByKeyId_=new Map,this.announcedKeyStatusByKeyId_=new Map,this.keyStatusTimer_=new shaka.util.Timer((function(){return t.processKeyStatusChanges_()})),this.usePersistentLicenses_=!1,this.mediaKeyMessageEvents_=[],this.initialRequestsSent_=!1,this.expirationTimer_=new shaka.util.Timer((function(){t.pollExpiration_()})),this.allSessionsLoaded_.catch((function(){})),this.destroyer_=new shaka.util.Destroyer((function(){return t.destroyNow_()})),this.srcEquals_=!1,this.manifestInitData_=this.mediaKeysAttached_=null},shaka.media.DrmEngine.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.media.DrmEngine.prototype.destroyNow_=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){switch(t.nextAddress){case 1:return e.eventManager_.release(),e.eventManager_=null,e.allSessionsLoaded_.reject(),e.expirationTimer_.stop(),e.expirationTimer_=null,e.keyStatusTimer_.stop(),e.keyStatusTimer_=null,t.yield(e.closeOpenSessions_(),2);case 2:if(!e.video_){t.jumpTo(3);break}return goog.asserts.assert(!e.video_.src,"video src must be removed first!"),t.setCatchFinallyBlocks(4),t.yield(e.video_.setMediaKeys(null),6);case 6:t.leaveTryBlock(5);break;case 4:t.enterCatchBlock();case 5:e.video_=null;case 3:e.currentDrmInfo_=null,e.supportedTypes_.clear(),e.mediaKeys_=null,e.storedPersistentSessions_=new Map,e.config_=null,e.onError_=function(){},e.playerInterface_=null,e.srcEquals_=!1,e.mediaKeysAttached_=null,t.jumpToEnd()}}))},shaka.media.DrmEngine.prototype.configure=function(e){this.config_=e,this.expirationTimer_&&this.expirationTimer_.tickEvery(this.config_.updateExpirationTime)},shaka.media.DrmEngine.prototype.setSrcEquals=function(e){this.srcEquals_=e},shaka.media.DrmEngine.prototype.initForStorage=function(e,t){return this.initializedForStorage_=!0,this.storedPersistentSessions_=new Map,this.usePersistentLicenses_=t,this.init_(e)},shaka.media.DrmEngine.prototype.initForPlayback=function(e,t){this.storedPersistentSessions_=new Map;for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())this.storedPersistentSessions_.set(r.value,{initData:null,initDataType:null});for(r=(t=$jscomp.makeIterator(this.config_.persistentSessionsMetadata)).next();!r.done;r=t.next())r=r.value,this.storedPersistentSessions_.set(r.sessionId,{initData:r.initData,initDataType:r.initDataType});return this.usePersistentLicenses_=0<this.storedPersistentSessions_.size,this.init_(e)},shaka.media.DrmEngine.prototype.initForRemoval=function(e,t,r,n,a){var i=new Map;return(n={audioCapabilities:n,videoCapabilities:a,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:e}).drmInfos=[{keySystem:e,licenseServerUri:t,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:r,serverCertificateUri:"",initData:null,keyIds:null}],i.set(e,n),this.queryMediaKeys_(i,[])},shaka.media.DrmEngine.prototype.init_=function(e){var t,r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(v){if(1==v.nextAddress){if(goog.asserts.assert(y.config_,"DrmEngine configure() must be called before init()!"),t=y.configureClearKey_())for(r=$jscomp.makeIterator(e),n=r.next();!n.done;n=r.next())(a=n.value).video&&(a.video.drmInfos=[t]),a.audio&&(a.audio.drmInfos=[t]);for((i=e.some((function(e){return!!(e.video&&e.video.drmInfos.length||e.audio&&e.audio.drmInfos.length)})))||(o=shaka.util.MapUtils.asMap(y.config_.servers),shaka.media.DrmEngine.replaceDrmInfo_(e,o)),s=new Set,l=$jscomp.makeIterator(e),n=l.next();!n.done;n=l.next())for(u=n.value,c=y.getVariantDrmInfos_(u),d=$jscomp.makeIterator(c),p=d.next();!p.done;p=d.next())h=p.value,s.add(h);for(f=$jscomp.makeIterator(s),p=f.next();!p.done;p=f.next())m=p.value,shaka.media.DrmEngine.fillInDrmInfoDefaults_(m,shaka.util.MapUtils.asMap(y.config_.servers),shaka.util.MapUtils.asMap(y.config_.advanced||{}),y.config_.keySystemsMapping);return v.yield(shaka.util.StreamUtils.getDecodingInfosForVariants(e,y.usePersistentLicenses_,y.srcEquals_,y.config_.preferredKeySystems),2)}return y.destroyer_.ensureNotDestroyed(),i||Object.keys(y.config_.servers).length?(g=y.queryMediaKeys_(void 0,e),v.return(i?g:g.catch((function(){})))):(y.initialized_=!0,v.return(Promise.resolve()))}))},shaka.media.DrmEngine.prototype.attachMediaKeys_=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){switch(r.nextAddress){case 1:if(t.video_.mediaKeys)return r.return();if(!t.mediaKeysAttached_){r.jumpTo(2);break}return r.yield(t.mediaKeysAttached_,3);case 3:return t.destroyer_.ensureNotDestroyed(),r.return();case 2:return r.setCatchFinallyBlocks(4),t.mediaKeysAttached_=t.video_.setMediaKeys(t.mediaKeys_),r.yield(t.mediaKeysAttached_,6);case 6:r.leaveTryBlock(5);break;case 4:e=r.enterCatchBlock(),goog.asserts.assert(e instanceof Error,"Wrong error type!"),t.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_ATTACH_TO_VIDEO,e.message));case 5:t.destroyer_.ensureNotDestroyed(),r.jumpToEnd()}}))},shaka.media.DrmEngine.prototype.onEncryptedEvent_=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return r.yield(t.attachMediaKeys_(),2);t.newInitData(e.initDataType,shaka.util.BufferUtils.toUint8(e.initData)),r.jumpToEnd()}))},shaka.media.DrmEngine.prototype.attach=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return t.mediaKeys_?(t.video_=e,t.eventManager_.listenOnce(t.video_,"play",(function(){return t.onPlay_()})),"webkitCurrentPlaybackTargetIsWireless"in t.video_&&t.eventManager_.listen(t.video_,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return t.closeOpenSessions_()})),t.manifestInitData_=t.currentDrmInfo_&&t.currentDrmInfo_.initData.find((function(e){return 0<e.initData.length}))||null,t.manifestInitData_||"com.apple.fps"!==t.currentDrmInfo_.keySystem||t.storedPersistentSessions_.size?r.yield(t.attachMediaKeys_(),2):r.jumpTo(2)):(t.eventManager_.listenOnce(e,"encrypted",(function(e){t.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.ENCRYPTED_CONTENT_WITHOUT_DRM_INFO))})),r.return());t.createOrLoad().catch((function(){})),t.manifestInitData_||t.storedPersistentSessions_.size||t.config_.parseInbandPsshEnabled||t.eventManager_.listen(t.video_,"encrypted",(function(e){return t.onEncryptedEvent_(e)})),r.jumpToEnd()}))},shaka.media.DrmEngine.prototype.hasManifestInitData=function(){return!!this.manifestInitData_},shaka.media.DrmEngine.prototype.setServerCertificate=function(){var e,t,r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:if(goog.asserts.assert(i.initialized_,"Must call init() before setServerCertificate"),!i.mediaKeys_||!i.currentDrmInfo_)return o.return();if(!i.currentDrmInfo_.serverCertificateUri||i.currentDrmInfo_.serverCertificate&&i.currentDrmInfo_.serverCertificate.length){o.jumpTo(2);break}return e=shaka.net.NetworkingEngine.makeRequest([i.currentDrmInfo_.serverCertificateUri],i.config_.retryParameters),o.setCatchFinallyBlocks(3),t=i.playerInterface_.netEngine.request(shaka.net.NetworkingEngine.RequestType.SERVER_CERTIFICATE,e),o.yield(t.promise,5);case 5:r=o.yieldResult,i.currentDrmInfo_.serverCertificate=shaka.util.BufferUtils.toUint8(r.data),o.leaveTryBlock(4);break;case 3:throw n=o.enterCatchBlock(),goog.asserts.assert(n instanceof shaka.util.Error,"Wrong NetworkingEngine error type!"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.SERVER_CERTIFICATE_REQUEST_FAILED,n);case 4:if(i.destroyer_.destroyed())return o.return();case 2:return i.currentDrmInfo_.serverCertificate&&i.currentDrmInfo_.serverCertificate.length?(o.setCatchFinallyBlocks(6),o.yield(i.mediaKeys_.setServerCertificate(i.currentDrmInfo_.serverCertificate),8)):o.return();case 8:o.yieldResult||shaka.log.warning("Server certificates are not supported by the key system.  The server certificate has been ignored."),o.leaveTryBlock(0);break;case 6:throw a=o.enterCatchBlock(),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.INVALID_SERVER_CERTIFICATE,a.message)}}))},shaka.media.DrmEngine.prototype.removeSession=function(e){var t,r,n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(goog.asserts.assert(a.mediaKeys_,"Must call init() before removeSession"),i.yield(a.loadOfflineSession_(e,{initData:null,initDataType:null}),2)):3!=i.nextAddress?(t=i.yieldResult)?(r=[],(n=a.activeSessions_.get(t))&&(n.updatePromise=new shaka.util.PublicPromise,r.push(n.updatePromise)),shaka.log.v2("Attempting to remove session",e),r.push(t.remove()),i.yield(Promise.all(r),3)):(shaka.log.v2("Ignoring attempt to remove missing session",e),i.return()):(a.activeSessions_.delete(t),void i.jumpToEnd())}))},shaka.media.DrmEngine.prototype.createOrLoad=function(){var e,t,r,n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){if(1==i.nextAddress)return a.storedPersistentSessions_.size?(a.storedPersistentSessions_.forEach((function(e,t){a.loadOfflineSession_(t,e)})),i.yield(a.allSessionsLoaded_,3)):i.jumpTo(2);if(2!=i.nextAddress){if(0<(a.currentDrmInfo_&&a.currentDrmInfo_.keyIds||new Set([])).size&&a.areAllKeysUsable_())return i.return(a.allSessionsLoaded_);a.allSessionsLoaded_=new shaka.util.PublicPromise,a.allSessionsLoaded_.catch((function(){}))}for(e=(a.currentDrmInfo_?a.currentDrmInfo_.initData:[])||[],t=$jscomp.makeIterator(e),r=t.next();!r.done;r=t.next())n=r.value,a.newInitData(n.initDataType,n.initData);return a.areAllSessionsLoaded_()&&a.allSessionsLoaded_.resolve(),i.return(a.allSessionsLoaded_)}))},shaka.media.DrmEngine.prototype.newInitData=function(e,t){if(t.length){for(var r=this.activeSessions_.values(),n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next())if(shaka.util.BufferUtils.equal(t,n.value.initData)&&this.config_.ignoreDuplicateInitData)return void shaka.log.debug("Ignoring duplicate init data.");0<this.activeSessions_.size&&this.areAllSessionsLoaded_()&&(this.allSessionsLoaded_.resolve(),this.allSessionsLoaded_=new shaka.util.PublicPromise,this.allSessionsLoaded_.catch((function(){}))),this.createSession(e,t,this.currentDrmInfo_.sessionType)}},shaka.media.DrmEngine.prototype.initialized=function(){return this.initialized_},shaka.media.DrmEngine.keySystem=function(e){return e?e.keySystem:""},shaka.media.DrmEngine.isPlayReadyKeySystem=function(e){return!!e&&!!e.match(/^com\.(microsoft|chromecast)\.playready/)},shaka.media.DrmEngine.isFairPlayKeySystem=function(e){return!!e&&!!e.match(/^com\.apple\.fps/)},shaka.media.DrmEngine.prototype.willSupport=function(e){if(shaka.util.Platform.isLegacyEdge())return!0;if(e=e.toLowerCase(),shaka.util.Platform.isTizen()&&e.includes('codecs="ac-3"')){var t=e.replace("ac-3","ec-3");return this.supportedTypes_.has(e)||this.supportedTypes_.has(t)}return this.supportedTypes_.has(e)},shaka.media.DrmEngine.prototype.getSessionIds=function(){var e=this.activeSessions_.keys();return e=shaka.util.Iterables.map(e,(function(e){return e.sessionId})),Array.from(e)},shaka.media.DrmEngine.prototype.getActiveSessionsMetadata=function(){var e=this,t=this.activeSessions_.keys();return t=shaka.util.Iterables.map(t,(function(t){var r=e.activeSessions_.get(t);return{sessionId:t.sessionId,sessionType:r.type,initData:r.initData,initDataType:r.initDataType}})),Array.from(t)},shaka.media.DrmEngine.prototype.getExpiration=function(){for(var e=1/0,t=this.activeSessions_.keys(),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())r=r.value,isNaN(r.expiration)||(e=Math.min(e,r.expiration));return e},shaka.media.DrmEngine.prototype.getLicenseTime=function(){return this.licenseTimeSeconds_?this.licenseTimeSeconds_:NaN},shaka.media.DrmEngine.prototype.getDrmInfo=function(){return this.currentDrmInfo_},shaka.media.DrmEngine.prototype.getMediaKeys=function(){return this.mediaKeys_},shaka.media.DrmEngine.prototype.getKeyStatuses=function(){return shaka.util.MapUtils.asObject(this.announcedKeyStatusByKeyId_)},shaka.media.DrmEngine.prototype.getMediaKeySessions=function(){return Array.from(this.activeSessions_.keys())},shaka.media.DrmEngine.computeMimeType_=function(e,t){t=shaka.util.MimeUtils.getFullType(e.mimeType,t||e.codecs);var r=shaka.transmuxer.TransmuxerEngine;return r.isSupported(t,e.type)?r.convertCodecs(e.type,t):t},shaka.media.DrmEngine.prototype.queryMediaKeys_=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h,f,m,g=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(y){switch(y.nextAddress){case 1:if(r=new Map,t.length){n=g.getKeySystemAccessFromVariants_(t,r),y.jumpTo(2);break}return y.yield(g.getKeySystemAccessByConfigs_(e),3);case 3:n=y.yieldResult;case 2:if(!(a=n))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE);for(g.destroyer_.ensureNotDestroyed(),y.setCatchFinallyBlocks(4),g.supportedTypes_.clear(),i=a.getConfiguration(),shaka.log.v2("Got MediaKeySystemAccess with configuration",i),o=i.audioCapabilities||[],s=i.videoCapabilities||[],l=$jscomp.makeIterator(o),u=l.next();!u.done;u=l.next())c=u.value,g.supportedTypes_.add(c.contentType.toLowerCase());for(d=$jscomp.makeIterator(s),u=d.next();!u.done;u=d.next())p=u.value,g.supportedTypes_.add(p.contentType.toLowerCase());if(goog.asserts.assert(g.supportedTypes_.size,"We should get at least one supported MIME type"),g.currentDrmInfo_=t.length?g.createDrmInfoByInfos_(a.keySystem,r.get(a.keySystem)):shaka.media.DrmEngine.createDrmInfoByConfigs_(a.keySystem,e.get(a.keySystem)),!g.currentDrmInfo_.licenseServerUri)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.NO_LICENSE_SERVER_GIVEN,g.currentDrmInfo_.keySystem);return y.yield(a.createMediaKeys(),6);case 6:if(h=y.yieldResult,g.destroyer_.ensureNotDestroyed(),shaka.log.info("Created MediaKeys object for key system",g.currentDrmInfo_.keySystem),g.mediaKeys_=h,""==g.config_.minHdcpVersion||!("getStatusForPolicy"in g.mediaKeys_)){y.jumpTo(7);break}return y.setCatchFinallyBlocks(8),y.yield(g.mediaKeys_.getStatusForPolicy({minHdcpVersion:g.config_.minHdcpVersion}),10);case 10:if("usable"!=y.yieldResult)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.MIN_HDCP_VERSION_NOT_MATCH);g.destroyer_.ensureNotDestroyed(),y.leaveTryBlock(7,4);break;case 8:if((f=y.enterCatchBlock(4))instanceof shaka.util.Error)throw f;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.ERROR_CHECKING_HDCP_VERSION,f.message);case 7:return g.initialized_=!0,y.yield(g.setServerCertificate(),11);case 11:g.destroyer_.ensureNotDestroyed(),y.leaveTryBlock(0);break;case 4:if(m=y.enterCatchBlock(),g.destroyer_.ensureNotDestroyed(m),g.currentDrmInfo_=null,g.supportedTypes_.clear(),m instanceof shaka.util.Error)throw m;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_CREATE_CDM,m.message)}}))},shaka.media.DrmEngine.prototype.getKeySystemAccessFromVariants_=function(e,t){for(var r=$jscomp.makeIterator(e),n=r.next();!n.done;n=r.next()){var a=this.getVariantDrmInfos_(n.value);for(n=(a=$jscomp.makeIterator(a)).next();!n.done;n=a.next()){var i=n.value;t.has(i.keySystem)||t.set(i.keySystem,[]),t.get(i.keySystem).push(i)}}if(1==t.size&&t.has(""))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.NO_RECOGNIZED_KEY_SYSTEMS);for(r={},i=(a=$jscomp.makeIterator(this.config_.preferredKeySystems)).next();!i.done;r={$jscomp$loop$prop$preferredKeySystem$870:r.$jscomp$loop$prop$preferredKeySystem$870},i=a.next())for(r.$jscomp$loop$prop$preferredKeySystem$870=i.value,n=(i=$jscomp.makeIterator(e)).next();!n.done;n=i.next())if(n=n.value.decodingInfos.find(function(e){return function(t){return t.supported&&null!=t.keySystemAccess&&t.keySystemAccess.keySystem==e.$jscomp$loop$prop$preferredKeySystem$870}}(r)))return n.keySystemAccess;for(a=(r=$jscomp.makeIterator([!0,!1])).next();!a.done;a=r.next())for(a=a.value,n=(i=$jscomp.makeIterator(e)).next();!n.done;n=i.next()){var o=$jscomp.makeIterator(n.value.decodingInfos);for(n=o.next();!n.done;n=o.next()){var s=n.value;if(s.supported&&s.keySystemAccess){n=t.get(s.keySystemAccess.keySystem);var l=$jscomp.makeIterator(n);for(n=l.next();!n.done;n=l.next())if(!!n.value.licenseServerUri==a)return s.keySystemAccess}}}return null},shaka.media.DrmEngine.prototype.getKeySystemAccessByConfigs_=function(e){var t,r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(v){switch(v.nextAddress){case 1:if(1==e.size&&e.has(""))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.NO_RECOGNIZED_KEY_SYSTEMS);for(r=$jscomp.makeIterator(e.values()),n=r.next();!n.done;n=r.next())0==(a=n.value).audioCapabilities.length&&delete a.audioCapabilities,0==a.videoCapabilities.length&&delete a.videoCapabilities;i=$jscomp.makeIterator(y.config_.preferredKeySystems),o=i.next();case 2:if(o.done){v.jumpTo(4);break}if(s=o.value,!e.has(s)){v.jumpTo(3);break}return l=e.get(s),v.setCatchFinallyBlocks(6),v.yield(navigator.requestMediaKeySystemAccess(s,[l]),8);case 8:return t=v.yieldResult,v.return(t);case 6:u=v.enterCatchBlock(),shaka.log.v2("Requesting",s,"failed with config",l,u);case 7:y.destroyer_.ensureNotDestroyed();case 3:o=i.next(),v.jumpTo(2);break;case 4:c=$jscomp.makeIterator([!0,!1]),d=c.next();case 9:if(d.done){v.jumpTo(11);break}p=d.value,h=$jscomp.makeIterator(e.keys()),o=h.next();case 12:if(o.done){d=c.next(),v.jumpTo(9);break}if(f=o.value,m=e.get(f),m.drmInfos.some((function(e){return!!e.licenseServerUri}))!=p){v.jumpTo(13);break}return v.setCatchFinallyBlocks(15),v.yield(navigator.requestMediaKeySystemAccess(f,[m]),17);case 17:return t=v.yieldResult,v.return(t);case 15:g=v.enterCatchBlock(),shaka.log.v2("Requesting",f,"failed with config",m,g);case 16:y.destroyer_.ensureNotDestroyed();case 13:o=h.next(),v.jumpTo(12);break;case 11:return v.return(t)}}))},shaka.media.DrmEngine.prototype.configureClearKey_=function(){var e=shaka.util.MapUtils.asMap(this.config_.clearKeys);return 0==e.size?null:shaka.util.ManifestParserUtils.createDrmInfoFromClearKeys(e)},shaka.media.DrmEngine.prototype.checkSessionsLoaded_=function(){this.areAllSessionsLoaded_()&&this.allSessionsLoaded_.resolve()},shaka.media.DrmEngine.prototype.setLoadSessionTimeoutTimer_=function(e){var t=this;new shaka.util.Timer((function(){e.loaded=!0,t.checkSessionsLoaded_()})).tickAfter(shaka.media.DrmEngine.SESSION_LOAD_TIMEOUT_)},shaka.media.DrmEngine.prototype.loadOfflineSession_=function(e,t){var r,n,a,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:try{shaka.log.v1("Attempting to load an offline session",e),r=u.mediaKeys_.createSession("persistent-license")}catch(e){return n=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_CREATE_SESSION,e.message),u.onError_(n),c.return(Promise.reject(n))}return u.eventManager_.listen(r,"message",(function(e){return u.onSessionMessage_(e)})),u.eventManager_.listen(r,"keystatuseschange",(function(e){return u.onKeyStatusesChange_(e)})),a={initData:t.initData,initDataType:t.initDataType,loaded:!1,oldExpiration:1/0,updatePromise:null,type:"persistent-license"},u.activeSessions_.set(r,a),c.setCatchFinallyBlocks(2),c.yield(r.load(e),4);case 4:return i=c.yieldResult,u.destroyer_.ensureNotDestroyed(),shaka.log.v2("Loaded offline session",e,i),i||(u.activeSessions_.delete(r),o=u.config_.persistentSessionOnlinePlayback?shaka.util.Error.Severity.RECOVERABLE:shaka.util.Error.Severity.CRITICAL,u.onError_(new shaka.util.Error(o,shaka.util.Error.Category.DRM,shaka.util.Error.Code.OFFLINE_SESSION_REMOVED)),a.loaded=!0),u.setLoadSessionTimeoutTimer_(a),u.checkSessionsLoaded_(),c.return(r);case 2:s=c.enterCatchBlock(),u.destroyer_.ensureNotDestroyed(s),u.activeSessions_.delete(r),l=u.config_.persistentSessionOnlinePlayback?shaka.util.Error.Severity.RECOVERABLE:shaka.util.Error.Severity.CRITICAL,u.onError_(new shaka.util.Error(l,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_CREATE_SESSION,s.message)),a.loaded=!0,u.checkSessionsLoaded_();case 3:return c.return(Promise.resolve())}}))},shaka.media.DrmEngine.prototype.createSession=function(e,t,r){var n=this;goog.asserts.assert(this.mediaKeys_,"mediaKeys_ should be valid when creating temporary session.");try{shaka.log.info("Creating new",r,"session");var a=this.mediaKeys_.createSession(r)}catch(e){return void this.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_CREATE_SESSION,e.message))}this.eventManager_.listen(a,"message",(function(e){return n.onSessionMessage_(e)})),this.eventManager_.listen(a,"keystatuseschange",(function(e){return n.onKeyStatusesChange_(e)})),this.activeSessions_.set(a,{initData:t,initDataType:e,loaded:!1,oldExpiration:1/0,updatePromise:null,type:r});try{t=this.config_.initDataTransform(t,e,this.currentDrmInfo_)}catch(t){return e=t,t instanceof shaka.util.Error||(e=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.INIT_DATA_TRANSFORM_ERROR,t)),void this.onError_(e)}this.config_.logLicenseExchange&&(r=shaka.util.Uint8ArrayUtils.toBase64(t),shaka.log.info("EME init data: type=",e,"data=",r)),a.generateRequest(e,t).catch((function(e){if(!n.destroyer_.destroyed()){goog.asserts.assert(e instanceof Error,"Wrong error type!"),n.activeSessions_.delete(a);var t=e.errorCode;if(t&&t.systemCode){var r=t.systemCode;0>r&&(r+=Math.pow(2,32)),r="0x"+r.toString(16)}n.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.FAILED_TO_GENERATE_LICENSE_REQUEST,e.message,e,r))}}))},shaka.media.DrmEngine.prototype.onSessionMessage_=function(e){this.delayLicenseRequest_()?this.mediaKeyMessageEvents_.push(e):this.sendLicenseRequest_(e)},shaka.media.DrmEngine.prototype.delayLicenseRequest_=function(){return!!this.video_&&(this.config_.delayLicenseRequestUntilPlayed&&this.video_.paused&&!this.initialRequestsSent_)},shaka.media.DrmEngine.prototype.sendLicenseRequest_=function(e){var t,r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(v){switch(v.nextAddress){case 1:return t=e.target,shaka.log.v1("Sending license request for session",t.sessionId,"of type",e.messageType),y.config_.logLicenseExchange&&(r=shaka.util.Uint8ArrayUtils.toBase64(e.message),shaka.log.info("EME license request",r)),n=y.activeSessions_.get(t),a=y.currentDrmInfo_.licenseServerUri,i=y.config_.advanced[y.currentDrmInfo_.keySystem],"individualization-request"==e.messageType&&i&&i.individualizationServer&&(a=i.individualizationServer),o=shaka.net.NetworkingEngine.RequestType.LICENSE,(s=shaka.net.NetworkingEngine.makeRequest([a],y.config_.retryParameters)).body=e.message,s.method="POST",s.licenseRequestType=e.messageType,s.sessionId=t.sessionId,s.drmInfo=y.currentDrmInfo_,n&&(s.initData=n.initData,s.initDataType=n.initDataType),shaka.media.DrmEngine.isPlayReadyKeySystem(y.currentDrmInfo_.keySystem)&&y.unpackPlayReadyRequest_(s),l=Date.now(),v.setCatchFinallyBlocks(2),c=y.playerInterface_.netEngine.request(o,s),v.yield(c.promise,4);case 4:u=v.yieldResult,v.leaveTryBlock(3);break;case 2:return d=v.enterCatchBlock(),y.destroyer_.destroyed()?v.return():(goog.asserts.assert(d instanceof shaka.util.Error,"Wrong NetworkingEngine error type!"),p=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.LICENSE_REQUEST_FAILED,d),1==y.activeSessions_.size?(y.onError_(p),n&&n.updatePromise&&n.updatePromise.reject(p)):(n&&n.updatePromise&&n.updatePromise.reject(p),y.activeSessions_.delete(t),y.areAllSessionsLoaded_()&&(y.allSessionsLoaded_.resolve(),y.keyStatusTimer_.tickAfter(.1))),v.return());case 3:return y.destroyer_.destroyed()?v.return():(y.licenseTimeSeconds_+=(Date.now()-l)/1e3,y.config_.logLicenseExchange&&(h=shaka.util.Uint8ArrayUtils.toBase64(u.data),shaka.log.info("EME license response",h)),v.setCatchFinallyBlocks(5),shaka.log.v1("Updating session",t.sessionId),v.yield(t.update(u.data),7));case 7:v.leaveTryBlock(6);break;case 5:return f=v.enterCatchBlock(),m=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.LICENSE_RESPONSE_REJECTED,f.message),y.onError_(m),n&&n.updatePromise&&n.updatePromise.reject(m),v.return();case 6:if(y.destroyer_.destroyed())return v.return();g=new shaka.util.FakeEvent("drmsessionupdate"),y.playerInterface_.onEvent(g),n&&(n.updatePromise&&n.updatePromise.resolve(),y.setLoadSessionTimeoutTimer_(n)),v.jumpToEnd()}}))},shaka.media.DrmEngine.prototype.unpackPlayReadyRequest_=function(e){var t=shaka.util.TXml,r=shaka.util.StringUtils.fromUTF16(e.body,!0,!0);if(r.includes("PlayReadyKeyMessage")){shaka.log.debug("Unwrapping PlayReady request."),r=t.parseXmlString(r,"PlayReadyKeyMessage"),goog.asserts.assert(r,"Failed to parse PlayReady XML!");for(var n=t.getElementsByTagName(r,"HttpHeader"),a=(n=$jscomp.makeIterator(n)).next();!a.done;a=n.next()){var i=a.value;a=t.getElementsByTagName(i,"name")[0],i=t.getElementsByTagName(i,"value")[0],goog.asserts.assert(a&&i,"Malformed PlayReady headers!"),e.headers[shaka.util.TXml.getTextContents(a)]=shaka.util.TXml.getTextContents(i)}t=t.getElementsByTagName(r,"Challenge")[0],goog.asserts.assert(t,"Malformed PlayReady challenge!"),goog.asserts.assert("base64encoded"==t.attributes.encoding,"Unexpected PlayReady challenge encoding!"),e.body=shaka.util.Uint8ArrayUtils.fromBase64(shaka.util.TXml.getTextContents(t))}else shaka.log.debug("PlayReady request is already unwrapped."),e.headers["Content-Type"]="text/xml; charset=utf-8"},shaka.media.DrmEngine.prototype.onKeyStatusesChange_=function(e){var t=this;e=e.target,shaka.log.v2("Key status changed for session",e.sessionId);var r=this.activeSessions_.get(e),n=!1;e.keyStatuses.forEach((function(e,a){if("string"==typeof a){var i=a;a=e,e=i}if(shaka.media.DrmEngine.isPlayReadyKeySystem(t.currentDrmInfo_.keySystem)&&16==a.byteLength&&(shaka.util.Platform.isEdge()||shaka.util.Platform.isPS4())){var o=(i=shaka.util.BufferUtils.toDataView(a)).getUint32(0,!0),s=i.getUint16(4,!0),l=i.getUint16(6,!0);i.setUint32(0,o,!1),i.setUint16(4,s,!1),i.setUint16(6,l,!1)}"status-pending"!=e&&(r.loaded=!0),r||goog.asserts.assert("usable"!=e,"Usable keys found in closed session"),"expired"==e&&(n=!0),a=shaka.util.Uint8ArrayUtils.toHex(a).slice(0,32),t.keyStatusByKeyId_.set(a,e)}));var a=e.expiration-Date.now();(0>a||n&&1e3>a)&&r&&!r.updatePromise&&(shaka.log.debug("Session has expired",e.sessionId),this.activeSessions_.delete(e),e.close().catch((function(){}))),this.areAllSessionsLoaded_()&&(this.allSessionsLoaded_.resolve(),this.keyStatusTimer_.tickAfter(shaka.media.DrmEngine.KEY_STATUS_BATCH_TIME))},shaka.media.DrmEngine.prototype.processKeyStatusChanges_=function(){var e=this.keyStatusByKeyId_,t=this.announcedKeyStatusByKeyId_;t.clear(),e.forEach((function(e,r){return t.set(r,e)})),(e=Array.from(t.values())).length&&e.every((function(e){return"expired"==e}))&&this.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.EXPIRED)),this.playerInterface_.onKeyStatus(shaka.util.MapUtils.asObject(t))},shaka.media.DrmEngine.isBrowserSupported=function(){return!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)},shaka.media.DrmEngine.probeSupport=function(){var e,t,r,n,a,i;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?(goog.asserts.assert(shaka.media.DrmEngine.isBrowserSupported(),"Must have basic EME support"),e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.microsoft.playready.recommendation com.apple.fps.1_0 com.apple.fps".split(" "),r=[{videoCapabilities:t=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],persistentState:"required",sessionTypes:["persistent-license"]},{initDataTypes:["cenc"],videoCapabilities:t}],n=new Map,a=function(e){var t,a,i;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:if(o.setCatchFinallyBlocks(2),"org.w3.clearkey"===e&&shaka.util.Platform.isSafari())throw Error("Unsupported keySystem");return o.yield(navigator.requestMediaKeySystemAccess(e,r),4);case 4:return t=o.yieldResult,i=!!(a=t.getConfiguration().sessionTypes)&&a.includes("persistent-license"),shaka.util.Platform.isTizen3()&&(i=!1),n.set(e,{persistentState:i}),o.yield(t.createMediaKeys(),5);case 5:o.leaveTryBlock(0);break;case 2:o.enterCatchBlock(),n.set(e,null),o.jumpToEnd()}}))},i=e.map((function(e){return a(e)})),o.yield(Promise.all(i),2)):o.return(shaka.util.MapUtils.asObject(n))}))};shaka.media.DrmEngine.prototype.onPlay_=function(){for(var e=$jscomp.makeIterator(this.mediaKeyMessageEvents_),t=e.next();!t.done;t=e.next())this.sendLicenseRequest_(t.value);this.initialRequestsSent_=!0,this.mediaKeyMessageEvents_=[]},shaka.media.DrmEngine.prototype.closeSession_=function(e){var t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(t=shaka.media.DrmEngine,r=new Promise((function(e,r){new shaka.util.Timer(r).tickAfter(t.CLOSE_TIMEOUT_)})),n.setCatchFinallyBlocks(2),n.yield(Promise.race([Promise.all([e.close(),e.closed]),r]),4)):2!=n.nextAddress?n.leaveTryBlock(0):(n.enterCatchBlock(),shaka.log.warning("Timeout waiting for session close"),void n.jumpToEnd())}))},shaka.media.DrmEngine.prototype.closeOpenSessions_=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return e=Array.from(t.activeSessions_.entries()),t.activeSessions_.clear(),r.yield(Promise.all(e.map((function(e){var r,n=(e=$jscomp.makeIterator(e)).next().value,a=e.next().value;return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return 1==e.nextAddress?(e.setCatchFinallyBlocks(2),t.initializedForStorage_||t.storedPersistentSessions_.has(n.sessionId)||"persistent-license"!==a.type||t.config_.persistentSessionOnlinePlayback?(shaka.log.v1("Closing session",n.sessionId,a),e.yield(t.closeSession_(n),5)):(shaka.log.v1("Removing session",n.sessionId),e.yield(n.remove(),5))):2!=e.nextAddress?e.leaveTryBlock(0):(r=e.enterCatchBlock(),shaka.log.error("Failed to close or remove the session",r),void e.jumpToEnd())}))}))),0)}))},shaka.media.DrmEngine.prototype.supportsVariant=function(e){var t=e.audio,r=e.video;if(t&&t.encrypted&&(t=shaka.media.DrmEngine.computeMimeType_(t),!this.willSupport(t))||r&&r.encrypted&&(r=shaka.media.DrmEngine.computeMimeType_(r),!this.willSupport(r)))return!1;var n=shaka.media.DrmEngine.keySystem(this.currentDrmInfo_);return 0==(e=this.getVariantDrmInfos_(e)).length||e.some((function(e){return e.keySystem==n}))},shaka.media.DrmEngine.areDrmCompatible=function(e,t){return!e.length||!t.length||e===t||0<shaka.media.DrmEngine.getCommonDrmInfos(e,t).length},shaka.media.DrmEngine.getCommonDrmInfos=function(e,t){if(!e.length)return t;if(!t.length)return e;for(var r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){n=n.value;for(var a=$jscomp.makeIterator(t),i=a.next();!i.done;i=a.next())if(i=i.value,n.keySystem==i.keySystem){a=new Map;for(var o=(n.initData||[]).concat(i.initData||[]),s=(o=$jscomp.makeIterator(o)).next();!s.done;s=o.next())s=s.value,a.set(s.keyId,s);a=Array.from(a.values()),o=n.keyIds&&i.keyIds?new Set([].concat($jscomp.arrayFromIterable(n.keyIds),$jscomp.arrayFromIterable(i.keyIds))):n.keyIds||i.keyIds,r.push({keySystem:n.keySystem,licenseServerUri:n.licenseServerUri||i.licenseServerUri,distinctiveIdentifierRequired:n.distinctiveIdentifierRequired||i.distinctiveIdentifierRequired,persistentStateRequired:n.persistentStateRequired||i.persistentStateRequired,videoRobustness:n.videoRobustness||i.videoRobustness,audioRobustness:n.audioRobustness||i.audioRobustness,serverCertificate:n.serverCertificate||i.serverCertificate,serverCertificateUri:n.serverCertificateUri||i.serverCertificateUri,initData:a,keyIds:o});break}}return r},shaka.media.DrmEngine.prototype.getVariantDrmInfos_=function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])},shaka.media.DrmEngine.prototype.pollExpiration_=function(){var e=this;this.activeSessions_.forEach((function(t,r){var n=t.oldExpiration,a=r.expiration;isNaN(a)&&(a=1/0),a!=n&&(e.playerInterface_.onExpirationUpdated(r.sessionId,a),t.oldExpiration=a)}))},shaka.media.DrmEngine.prototype.areAllSessionsLoaded_=function(){var e=this.activeSessions_.values();return shaka.util.Iterables.every(e,(function(e){return e.loaded}))},shaka.media.DrmEngine.prototype.areAllKeysUsable_=function(){for(var e=this.currentDrmInfo_&&this.currentDrmInfo_.keyIds||new Set([]),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())if("usable"!==this.keyStatusByKeyId_.get(t.value))return!1;return!0},shaka.media.DrmEngine.replaceDrmInfo_=function(e,t){var r=[];for(t.forEach((function(e,t){r.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})})),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())(t=t.value).video&&(t.video.drmInfos=r),t.audio&&(t.audio.drmInfos=r)},shaka.media.DrmEngine.prototype.createDrmInfoByInfos_=function(e,t){var r=[],n=[],a=[],i=[],o=[],s=new Set;shaka.media.DrmEngine.processDrmInfos_(t,r,n,i,a,o,s),1<r.length&&shaka.log.warning("Multiple unique encryption schemes found! Only the first will be used."),1<i.length&&shaka.log.warning("Multiple unique server certificates found! Only the first will be used."),1<n.length&&shaka.log.warning("Multiple unique license server URIs found! Only the first will be used."),1<a.length&&shaka.log.warning("Multiple unique server certificate URIs found! Only the first will be used.");var l=this.usePersistentLicenses_?"persistent-license":"temporary";for(e={keySystem:e,encryptionScheme:r[0],licenseServerUri:n[0],distinctiveIdentifierRequired:t[0].distinctiveIdentifierRequired,persistentStateRequired:t[0].persistentStateRequired,sessionType:t[0].sessionType||l,audioRobustness:t[0].audioRobustness||"",videoRobustness:t[0].videoRobustness||"",serverCertificate:i[0],serverCertificateUri:a[0],initData:o,keyIds:s},r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())(r=r.value).distinctiveIdentifierRequired&&(e.distinctiveIdentifierRequired=r.distinctiveIdentifierRequired),r.persistentStateRequired&&(e.persistentStateRequired=r.persistentStateRequired);return e},shaka.media.DrmEngine.createDrmInfoByConfigs_=function(e,t){var r=[],n=[],a=[],i=[],o=[],s=new Set;return shaka.media.DrmEngine.processDrmInfos_(t.drmInfos,r,n,i,a,o,s),1<r.length&&shaka.log.warning("Multiple unique encryption schemes found! Only the first will be used."),1<i.length&&shaka.log.warning("Multiple unique server certificates found! Only the first will be used."),1<a.length&&shaka.log.warning("Multiple unique server certificate URIs found! Only the first will be used."),1<n.length&&shaka.log.warning("Multiple unique license server URIs found! Only the first will be used."),{keySystem:e,encryptionScheme:r[0],licenseServerUri:n[0],distinctiveIdentifierRequired:"required"==t.distinctiveIdentifier,persistentStateRequired:"required"==t.persistentState,sessionType:t.sessionTypes[0]||"temporary",audioRobustness:(t.audioCapabilities?t.audioCapabilities[0].robustness:"")||"",videoRobustness:(t.videoCapabilities?t.videoCapabilities[0].robustness:"")||"",serverCertificate:i[0],serverCertificateUri:a[0],initData:o,keyIds:s}},shaka.media.DrmEngine.processDrmInfos_=function(e,t,r,n,a,i,o){for(var s=[],l={},u=(e=$jscomp.makeIterator(e)).next();!u.done;l={$jscomp$loop$prop$drmInfo$872:l.$jscomp$loop$prop$drmInfo$872},u=e.next()){if(l.$jscomp$loop$prop$drmInfo$872=u.value,t.includes(l.$jscomp$loop$prop$drmInfo$872.encryptionScheme)||t.push(l.$jscomp$loop$prop$drmInfo$872.encryptionScheme),"org.w3.clearkey"==l.$jscomp$loop$prop$drmInfo$872.keySystem&&l.$jscomp$loop$prop$drmInfo$872.licenseServerUri.startsWith("data:application/json;base64,")?s.includes(l.$jscomp$loop$prop$drmInfo$872.licenseServerUri)||s.push(l.$jscomp$loop$prop$drmInfo$872.licenseServerUri):r.includes(l.$jscomp$loop$prop$drmInfo$872.licenseServerUri)||r.push(l.$jscomp$loop$prop$drmInfo$872.licenseServerUri),a.includes(l.$jscomp$loop$prop$drmInfo$872.serverCertificateUri)||a.push(l.$jscomp$loop$prop$drmInfo$872.serverCertificateUri),l.$jscomp$loop$prop$drmInfo$872.serverCertificate&&(n.some(function(e){return function(t){return shaka.util.BufferUtils.equal(t,e.$jscomp$loop$prop$drmInfo$872.serverCertificate)}}(l))||n.push(l.$jscomp$loop$prop$drmInfo$872.serverCertificate)),l.$jscomp$loop$prop$drmInfo$872.initData){u={};for(var c=$jscomp.makeIterator(l.$jscomp$loop$prop$drmInfo$872.initData),d=c.next();!d.done;u={$jscomp$loop$prop$initDataOverride$874:u.$jscomp$loop$prop$initDataOverride$874},d=c.next())u.$jscomp$loop$prop$initDataOverride$874=d.value,i.some(function(e){return function(t){var r=e.$jscomp$loop$prop$initDataOverride$874;return t=!(!t.keyId||t.keyId!=r.keyId)||t.initDataType==r.initDataType&&shaka.util.BufferUtils.equal(t.initData,r.initData)}}(u))||i.push(u.$jscomp$loop$prop$initDataOverride$874)}if(l.$jscomp$loop$prop$drmInfo$872.keyIds)for(c=(u=$jscomp.makeIterator(l.$jscomp$loop$prop$drmInfo$872.keyIds)).next();!c.done;c=u.next())o.add(c.value)}if(1==s.length)r.push(s[0]);else if(0<s.length){for(t=[],n=(s=$jscomp.makeIterator(s)).next();!n.done;n=s.next())n=window.atob(n.value.split("data:application/json;base64,").pop()),n=JSON.parse(n),t.push.apply(t,$jscomp.arrayFromIterable(n.keys));s=JSON.stringify({keys:t}),r.push("data:application/json;base64,"+window.btoa(s))}},shaka.media.DrmEngine.fillInDrmInfoDefaults_=function(e,t,r,n){var a=e.keySystem;!a||"org.w3.clearkey"==a&&e.licenseServerUri||(t.size&&(t=t.get(a)||"",e.licenseServerUri=t),e.keyIds||(e.keyIds=new Set),(r=r.get(a))&&(e.distinctiveIdentifierRequired||(e.distinctiveIdentifierRequired=r.distinctiveIdentifierRequired),e.persistentStateRequired||(e.persistentStateRequired=r.persistentStateRequired),e.videoRobustness||(e.videoRobustness=r.videoRobustness),e.audioRobustness||(e.audioRobustness=r.audioRobustness),e.serverCertificate||(e.serverCertificate=r.serverCertificate),r.sessionType&&(e.sessionType=r.sessionType),e.serverCertificateUri||(e.serverCertificateUri=r.serverCertificateUri)),n[a]&&(e.keySystem=n[a]),window.cast&&window.cast.__platform__&&"com.microsoft.playready"==a&&(e.keySystem="com.chromecast.playready"))},shaka.media.DrmEngine.prototype.parseInbandPssh=function(e,t){if(!this.config_.parseInbandPsshEnabled||this.manifestInitData_)return Promise.resolve();var r=shaka.util.ManifestParserUtils.ContentType;if(![r.AUDIO,r.VIDEO].includes(e))return Promise.resolve();t=new shaka.util.Pssh(shaka.util.BufferUtils.toUint8(t)),r=0;var n=$jscomp.makeIterator(t.data);for(e=n.next();!e.done;e=n.next())r+=e.value.length;if(0==r)return Promise.resolve();for(r=new Uint8Array(r),n=0,e=(t=$jscomp.makeIterator(t.data)).next();!e.done;e=t.next())e=e.value,r.set(e,n),n+=e.length;return this.newInitData("cenc",r),this.allSessionsLoaded_},shaka.media.DrmEngine.CLOSE_TIMEOUT_=1,shaka.media.DrmEngine.SESSION_LOAD_TIMEOUT_=5,shaka.media.DrmEngine.KEY_STATUS_BATCH_TIME=.5,shaka.media.DrmEngine.DUMMY_KEY_ID=new shaka.util.Lazy((function(){return shaka.util.BufferUtils.toArrayBuffer(new Uint8Array([0]))})),shaka.media.ManifestFilterer=function(e,t,r){goog.asserts.assert(e,"Must have config"),this.config_=e,this.maxHwRes_=t,this.drmEngine_=r},shaka.media.ManifestFilterer.prototype.setDrmEngine=function(e){this.drmEngine_=e},shaka.media.ManifestFilterer.prototype.filterManifest=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(goog.asserts.assert(e,"Manifest should exist!"),r.yield(shaka.util.StreamUtils.filterManifest(t.drmEngine_,e,t.config_.drm.preferredKeySystems),2)):(shaka.util.StreamUtils.chooseCodecsAndFilterManifest(e,t.config_.preferredVideoCodecs,t.config_.preferredAudioCodecs,t.config_.preferredDecodingAttributes),t.checkPlayableVariants_(e),r.return(t.filterManifestWithRestrictions(e)))}))},shaka.media.ManifestFilterer.prototype.applyRestrictions=function(e){return shaka.util.StreamUtils.applyRestrictions(e.variants,this.config_.restrictions,this.maxHwRes_)},shaka.media.ManifestFilterer.prototype.filterManifestWithRestrictions=function(e){var t=this.applyRestrictions(e);if(e){var r=this.drmEngine_?this.drmEngine_.getDrmInfo():null;if(r&&this.drmEngine_.getMediaKeys())for(var n=$jscomp.makeIterator(e.variants),a=n.next();!a.done;a=n.next())a=a.value,this.processDrmInfos(r.keySystem,a.video),this.processDrmInfos(r.keySystem,a.audio);this.checkRestrictedVariants(e)}return t},shaka.media.ManifestFilterer.prototype.checkPlayableVariants_=function(e){if(!e.variants.some(shaka.util.StreamUtils.isPlayable))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.CONTENT_UNSUPPORTED_BY_BROWSER)},shaka.media.ManifestFilterer.prototype.processDrmInfos=function(e,t){if(t)for(var r=(t=$jscomp.makeIterator(t.drmInfos)).next();!r.done;r=t.next())if((r=r.value).keySystem==e)for(var n=(r=$jscomp.makeIterator(r.initData||[])).next();!n.done;n=r.next())n=n.value,this.drmEngine_.newInitData(n.initDataType,n.initData)},shaka.media.ManifestFilterer.prototype.checkRestrictedVariants=function(e){var t=shaka.media.ManifestFilterer.restrictedStatuses,r=this.drmEngine_?this.drmEngine_.getKeyStatuses():{},n=Object.keys(r);n=n.length&&"00"==n[0];for(var a=!1,i=!1,o=new Set,s=new Set,l=(e=$jscomp.makeIterator(e.variants)).next();!l.done;l=e.next()){var u=[];(l=l.value).audio&&u.push(l.audio),l.video&&u.push(l.video);for(var c=(u=$jscomp.makeIterator(u)).next();!c.done;c=u.next())if((c=c.value).keyIds.size)for(var d=(c=$jscomp.makeIterator(c.keyIds)).next();!d.done;d=c.next()){d=d.value;var p=r[n?"00":d];p?t.includes(p)&&s.add(p):o.add(d)}l.allowedByApplication?l.allowedByKeySystem&&(a=!0):i=!0}if(!a)throw t={hasAppRestrictions:i,missingKeys:Array.from(o),restrictedKeyStatuses:Array.from(s)},new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.RESTRICTIONS_CANNOT_BE_MET,t)},shaka.media.ManifestFilterer.restrictedStatuses=["output-restricted","internal-error"],shaka.media.ManifestParser=function(){},shaka.media.ManifestParser.registerParserByExtension=function(e,t){shaka.Deprecate.deprecateFeature(5,"ManifestParser.registerParserByExtension","Please use an ManifestParser with registerParserByMime function.")},shaka.media.ManifestParser.registerParserByMime=function(e,t){shaka.media.ManifestParser.parsersByMime[e]=t},shaka.media.ManifestParser.unregisterParserByMime=function(e){delete shaka.media.ManifestParser.parsersByMime[e]},shaka.media.ManifestParser.probeSupport=function(){var e=shaka.media.ManifestParser,t={};if(shaka.util.Platform.supportsMediaSource())for(var r in e.parsersByMime)t[r]=!0;for(var n=(r=$jscomp.makeIterator(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!n.done;n=r.next())n=n.value,shaka.util.Platform.supportsMediaSource()?t[n]=!!e.parsersByMime[n]:t[n]=shaka.util.Platform.supportsMediaType(n);return t},shaka.media.ManifestParser.getFactory=function(e,t){var r=shaka.media.ManifestParser;if(t){if(r=r.parsersByMime[t.toLowerCase()])return r;shaka.log.warning("Could not determine manifest type using MIME type ",t)}throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.UNABLE_TO_GUESS_MANIFEST_TYPE,e,t)},shaka.media.ManifestParser.isSupported=function(e){return!!shaka.util.Platform.supportsMediaSource()&&e in shaka.media.ManifestParser.parsersByMime},goog.exportSymbol("shaka.media.ManifestParser",shaka.media.ManifestParser),goog.exportProperty(shaka.media.ManifestParser,"unregisterParserByMime",shaka.media.ManifestParser.unregisterParserByMime),goog.exportProperty(shaka.media.ManifestParser,"registerParserByMime",shaka.media.ManifestParser.registerParserByMime),goog.exportProperty(shaka.media.ManifestParser,"registerParserByExtension",shaka.media.ManifestParser.registerParserByExtension),shaka.media.ManifestParser.HLS="HLS",shaka.media.ManifestParser.DASH="DASH",shaka.media.ManifestParser.MSS="MSS",shaka.media.ManifestParser.UNKNOWN="UNKNOWN",shaka.media.ManifestParser.AccessibilityPurpose={VISUALLY_IMPAIRED:"visually impaired",HARD_OF_HEARING:"hard of hearing"},goog.exportProperty(shaka.media.ManifestParser,"AccessibilityPurpose",shaka.media.ManifestParser.AccessibilityPurpose),shaka.media.ManifestParser.parsersByMime={},shaka.media.ContentWorkarounds=function(){},shaka.media.ContentWorkarounds.fakeEncryption=function(e){var t=shaka.media.ContentWorkarounds;e=shaka.util.BufferUtils.toUint8(e);var r,n=!1,a=[],i=function(e){a.push(e),shaka.util.Mp4Parser.children(e)},o=function(e){n=!0},s=[];if((new shaka.util.Mp4Parser).box("moov",i).box("trak",i).box("mdia",i).box("minf",i).box("stbl",i).fullBox("stsd",(function(e){r=e,a.push(e),shaka.util.Mp4Parser.sampleDescription(e)})).fullBox("encv",o).fullBox("enca",o).fullBox("dvav",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCV_})})).fullBox("dva1",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCV_})})).fullBox("dvh1",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCV_})})).fullBox("dvhe",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCV_})})).fullBox("hev1",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCV_})})).fullBox("hvc1",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCV_})})).fullBox("avc1",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCV_})})).fullBox("avc3",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCV_})})).fullBox("ac-3",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCA_})})).fullBox("ec-3",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCA_})})).fullBox("ac-4",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCA_})})).fullBox("mp4a",(function(e){s.push({box:e,newType:t.BOX_TYPE_ENCA_})})).parse(e),n)return shaka.log.debug("Init segment already indicates encryption."),e;if(0==s.length||!r)throw shaka.log.error("Failed to find boxes needed to fake encryption!"),shaka.log.v2("Failed init segment (hex):",shaka.util.Uint8ArrayUtils.toHex(e)),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.CONTENT_TRANSFORMATION_FAILED);for(s.reverse(),o=(i=$jscomp.makeIterator(s)).next();!o.done;o=i.next()){o=o.value;var l=shaka.util.Mp4Parser.typeToString(o.newType);shaka.log.debug('Inserting "'+l+'" box into init segment.'),e=t.insertEncryptionMetadata_(e,r,o.box,a,o.newType)}return e},shaka.media.ContentWorkarounds.insertEncryptionMetadata_=function(e,t,r,n,a){var i=shaka.media.ContentWorkarounds,o=i.createEncryptionMetadata_(e,r,a);a=new Uint8Array(e.byteLength+o.byteLength),r=shaka.util.Platform.isXboxOne()?r.start:r.start+r.size;var s=e.subarray(0,r);for(e=e.subarray(r),a.set(s),a.set(o,r),a.set(e,r+o.byteLength),e=(n=$jscomp.makeIterator(n)).next();!e.done;e=n.next())e=e.value,goog.asserts.assert(e.start<r,"Ancestor MP4 box found in the wrong location!  Modified init segment will not make sense!"),i.updateBoxSize_(a,e.start,e.size+o.byteLength);return i=shaka.util.BufferUtils.toDataView(a,t.start),t=shaka.util.Mp4Parser.headerSize(t),o=i.getUint32(t),i.setUint32(t,o+1),a},shaka.media.ContentWorkarounds.createEncryptionMetadata_=function(e,t,r){var n=shaka.media.ContentWorkarounds,a=n.CANNED_SINF_BOX_.value(),i=e.subarray(t.start,t.start+t.size),o=shaka.util.BufferUtils.toDataView(i);return(e=new Uint8Array(t.size+a.byteLength)).set(i,0),(i=shaka.util.BufferUtils.toDataView(e)).setUint32(n.BOX_TYPE_OFFSET_,r),e.set(a,t.size),r=o.getUint32(n.BOX_TYPE_OFFSET_),i.setUint32(t.size+n.CANNED_SINF_BOX_FORMAT_OFFSET_,r),n.updateBoxSize_(e,0,e.byteLength),e},shaka.media.ContentWorkarounds.updateBoxSize_=function(e,t,r){var n=shaka.media.ContentWorkarounds;0!=(t=(e=shaka.util.BufferUtils.toDataView(e,t)).getUint32(n.BOX_SIZE_OFFSET_))&&(1==t?(e.setUint32(n.BOX_SIZE_64_OFFSET_,r>>32),e.setUint32(n.BOX_SIZE_64_OFFSET_+4,4294967295&r)):e.setUint32(n.BOX_SIZE_OFFSET_,r))},shaka.media.ContentWorkarounds.CANNED_SINF_BOX_=new shaka.util.Lazy((function(){return new Uint8Array([0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])})),shaka.media.ContentWorkarounds.CANNED_SINF_BOX_FORMAT_OFFSET_=16,shaka.media.ContentWorkarounds.BOX_SIZE_OFFSET_=0,shaka.media.ContentWorkarounds.BOX_TYPE_OFFSET_=4,shaka.media.ContentWorkarounds.BOX_SIZE_64_OFFSET_=8,shaka.media.ContentWorkarounds.BOX_TYPE_ENCV_=1701733238,shaka.media.ContentWorkarounds.BOX_TYPE_ENCA_=1701733217,shaka.media.InitSegmentReference=function(e,t,r,n,a,i,o){this.getUris=e,this.startByte=t,this.endByte=r,this.mediaQuality=void 0===n?null:n,this.timescale=void 0===a?null:a,this.segmentData=void 0===i?null:i,this.aesKey=void 0===o?null:o,this.mimeType=this.codecs=null},shaka.media.InitSegmentReference.prototype.getStartByte=function(){return this.startByte},shaka.media.InitSegmentReference.prototype.getEndByte=function(){return this.endByte},shaka.media.InitSegmentReference.prototype.getSize=function(){return this.endByte?this.endByte-this.startByte:null},shaka.media.InitSegmentReference.prototype.getMediaQuality=function(){return this.mediaQuality},shaka.media.InitSegmentReference.prototype.getSegmentData=function(){return this.segmentData},shaka.media.InitSegmentReference.equal=function(e,t){var r=shaka.util.ArrayUtils,n=shaka.util.BufferUtils;return e===t||(e&&t?e.getStartByte()==t.getStartByte()&&e.getEndByte()==t.getEndByte()&&r.equal(e.getUris().sort(),t.getUris().sort())&&n.equal(e.getSegmentData(),t.getSegmentData()):e==t)},goog.exportSymbol("shaka.media.InitSegmentReference",shaka.media.InitSegmentReference),goog.exportProperty(shaka.media.InitSegmentReference.prototype,"getEndByte",shaka.media.InitSegmentReference.prototype.getEndByte),goog.exportProperty(shaka.media.InitSegmentReference.prototype,"getStartByte",shaka.media.InitSegmentReference.prototype.getStartByte),shaka.media.SegmentReference=function(e,t,r,n,a,i,o,s,l,u,c,d,p,h,f,m){for(u=void 0===u?[]:u,c=void 0===c?"":c,d=void 0===d?null:d,p=void 0===p?null:p,h=void 0===h?shaka.media.SegmentReference.Status.AVAILABLE:h,f=void 0===f?null:f,m=void 0!==m&&m,goog.asserts.assert(e<=t,"startTime must be less than or equal to endTime"),goog.asserts.assert(null==a||n<a,"startByte must be < endByte"),this.startTime=e,this.trueEndTime=this.endTime=t,this.getUrisInner=r,this.startByte=n,this.endByte=a,this.initSegmentReference=i,this.timestampOffset=o,this.appendWindowStart=s,this.appendWindowEnd=l,this.partialReferences=u,this.tilesLayout=c,this.tileDuration=d,this.syncTime=p,this.status=h,this.preload=!1,this.independent=!0,this.byterangeOptimization=!1,this.aesKey=f,this.thumbnailSprite=null,this.discontinuitySequence=0,this.allPartialSegments=m,this.lastPartial=this.partial=!1,t=(e=$jscomp.makeIterator(this.partialReferences)).next();!t.done;t=e.next())t.value.markAsPartial();this.allPartialSegments&&this.partialReferences.length&&this.partialReferences[this.partialReferences.length-1].markAsLastPartial(),this.segmentData=this.mimeType=this.codecs=null},shaka.media.SegmentReference.prototype.getUris=function(){return this.getUrisInner()},shaka.media.SegmentReference.prototype.getStartTime=function(){return this.startTime},shaka.media.SegmentReference.prototype.getEndTime=function(){return this.endTime},shaka.media.SegmentReference.prototype.getStartByte=function(){return this.startByte},shaka.media.SegmentReference.prototype.getEndByte=function(){return this.endByte},shaka.media.SegmentReference.prototype.getSize=function(){return this.endByte?this.endByte-this.startByte:null},shaka.media.SegmentReference.prototype.hasPartialSegments=function(){return 0<this.partialReferences.length},shaka.media.SegmentReference.prototype.hasAllPartialSegments=function(){return this.allPartialSegments},shaka.media.SegmentReference.prototype.getTilesLayout=function(){return this.tilesLayout},shaka.media.SegmentReference.prototype.getTileDuration=function(){return this.tileDuration},shaka.media.SegmentReference.prototype.getStatus=function(){return this.status},shaka.media.SegmentReference.prototype.markAsUnavailable=function(){this.status=shaka.media.SegmentReference.Status.UNAVAILABLE},shaka.media.SegmentReference.prototype.markAsPreload=function(){this.preload=!0},shaka.media.SegmentReference.prototype.isPreload=function(){return this.preload},shaka.media.SegmentReference.prototype.markAsNonIndependent=function(){this.independent=!1},shaka.media.SegmentReference.prototype.isIndependent=function(){return this.independent},shaka.media.SegmentReference.prototype.markAsPartial=function(){this.partial=!0},shaka.media.SegmentReference.prototype.isPartial=function(){return this.partial},shaka.media.SegmentReference.prototype.markAsLastPartial=function(){this.lastPartial=!0},shaka.media.SegmentReference.prototype.isLastPartial=function(){return this.lastPartial},shaka.media.SegmentReference.prototype.markAsByterangeOptimization=function(){this.byterangeOptimization=!0},shaka.media.SegmentReference.prototype.hasByterangeOptimization=function(){return this.byterangeOptimization},shaka.media.SegmentReference.prototype.setThumbnailSprite=function(e){this.thumbnailSprite=e},shaka.media.SegmentReference.prototype.getThumbnailSprite=function(){return this.thumbnailSprite},shaka.media.SegmentReference.prototype.offset=function(e){this.startTime+=e,this.endTime+=e,this.trueEndTime+=e;for(var t=$jscomp.makeIterator(this.partialReferences),r=t.next();!r.done;r=t.next())(r=r.value).startTime+=e,r.endTime+=e,r.trueEndTime+=e},shaka.media.SegmentReference.prototype.syncAgainst=function(e){null==this.syncTime?shaka.log.alwaysError("Sync attempted without sync time!"):(e=this.syncTime-e-this.startTime,.001<=Math.abs(e)&&this.offset(e))},shaka.media.SegmentReference.prototype.setSegmentData=function(e){this.segmentData=e},shaka.media.SegmentReference.prototype.getSegmentData=function(){return this.segmentData},shaka.media.SegmentReference.prototype.updateInitSegmentReference=function(e){this.initSegmentReference=e;for(var t=$jscomp.makeIterator(this.partialReferences),r=t.next();!r.done;r=t.next())r.value.updateInitSegmentReference(e)},goog.exportSymbol("shaka.media.SegmentReference",shaka.media.SegmentReference),goog.exportProperty(shaka.media.SegmentReference.prototype,"getSegmentData",shaka.media.SegmentReference.prototype.getSegmentData),goog.exportProperty(shaka.media.SegmentReference.prototype,"setSegmentData",shaka.media.SegmentReference.prototype.setSegmentData),goog.exportProperty(shaka.media.SegmentReference.prototype,"syncAgainst",shaka.media.SegmentReference.prototype.syncAgainst),goog.exportProperty(shaka.media.SegmentReference.prototype,"offset",shaka.media.SegmentReference.prototype.offset),goog.exportProperty(shaka.media.SegmentReference.prototype,"getThumbnailSprite",shaka.media.SegmentReference.prototype.getThumbnailSprite),goog.exportProperty(shaka.media.SegmentReference.prototype,"setThumbnailSprite",shaka.media.SegmentReference.prototype.setThumbnailSprite),goog.exportProperty(shaka.media.SegmentReference.prototype,"hasByterangeOptimization",shaka.media.SegmentReference.prototype.hasByterangeOptimization),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsByterangeOptimization",shaka.media.SegmentReference.prototype.markAsByterangeOptimization),goog.exportProperty(shaka.media.SegmentReference.prototype,"isLastPartial",shaka.media.SegmentReference.prototype.isLastPartial),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsLastPartial",shaka.media.SegmentReference.prototype.markAsLastPartial),goog.exportProperty(shaka.media.SegmentReference.prototype,"isPartial",shaka.media.SegmentReference.prototype.isPartial),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsPartial",shaka.media.SegmentReference.prototype.markAsPartial),goog.exportProperty(shaka.media.SegmentReference.prototype,"isIndependent",shaka.media.SegmentReference.prototype.isIndependent),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsNonIndependent",shaka.media.SegmentReference.prototype.markAsNonIndependent),goog.exportProperty(shaka.media.SegmentReference.prototype,"isPreload",shaka.media.SegmentReference.prototype.isPreload),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsPreload",shaka.media.SegmentReference.prototype.markAsPreload),goog.exportProperty(shaka.media.SegmentReference.prototype,"markAsUnavailable",shaka.media.SegmentReference.prototype.markAsUnavailable),goog.exportProperty(shaka.media.SegmentReference.prototype,"getStatus",shaka.media.SegmentReference.prototype.getStatus),goog.exportProperty(shaka.media.SegmentReference.prototype,"getTileDuration",shaka.media.SegmentReference.prototype.getTileDuration),goog.exportProperty(shaka.media.SegmentReference.prototype,"getTilesLayout",shaka.media.SegmentReference.prototype.getTilesLayout),goog.exportProperty(shaka.media.SegmentReference.prototype,"getEndByte",shaka.media.SegmentReference.prototype.getEndByte),goog.exportProperty(shaka.media.SegmentReference.prototype,"getStartByte",shaka.media.SegmentReference.prototype.getStartByte),goog.exportProperty(shaka.media.SegmentReference.prototype,"getEndTime",shaka.media.SegmentReference.prototype.getEndTime),goog.exportProperty(shaka.media.SegmentReference.prototype,"getStartTime",shaka.media.SegmentReference.prototype.getStartTime),goog.exportProperty(shaka.media.SegmentReference.prototype,"getUris",shaka.media.SegmentReference.prototype.getUris),shaka.media.SegmentReference.Status={AVAILABLE:0,UNAVAILABLE:1,MISSING:2},goog.exportProperty(shaka.media.SegmentReference,"Status",shaka.media.SegmentReference.Status),shaka.media.TimeRangesUtils=function(){},shaka.media.TimeRangesUtils.bufferStart=function(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:1==e.length&&0>e.start(0)?0:e.length?e.start(0):null},shaka.media.TimeRangesUtils.bufferEnd=function(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null},shaka.media.TimeRangesUtils.isBuffered=function(e,t){return!(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1))&&t>=e.start(0)},shaka.media.TimeRangesUtils.bufferedAheadOf=function(e,t){if(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0))return 0;for(var r=0,n=(e=$jscomp.makeIterator(shaka.media.TimeRangesUtils.getBufferedInfo(e))).next();!n.done;n=e.next()){var a=n.value;n=a.start,(a=a.end)>t&&(r+=a-Math.max(n,t))}return r},shaka.media.TimeRangesUtils.getGapIndex=function(e,t,r){var n=shaka.media.TimeRangesUtils;return!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)?null:0<=(e=n.getBufferedInfo(e).findIndex((function(e,n,a){return e.start>t&&(0==n||a[n-1].end-t<=r)})))?e:null},shaka.media.TimeRangesUtils.getBufferedInfo=function(e){if(!e)return[];for(var t=[],r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t},shaka.media.TimeRangesUtils.computeAddedRange=function(e,t){var r=shaka.media.TimeRangesUtils;if(!e||!e.length)return null;if(!t||!t.length)return r.getBufferedInfo(t).pop();for(t=r.getBufferedInfo(t).reverse(),e=r.getBufferedInfo(e).reverse(),t=(r=$jscomp.makeIterator(t)).next();!t.done;t=r.next()){t=t.value;for(var n=!1,a=$jscomp.makeIterator(e),i=a.next();!i.done;i=a.next())if((i=i.value).end>=t.start&&i.end<=t.end&&(n=!0,t.end>i.end))return{start:i.end,end:t.end};if(!n)return t}return null},shaka.util.Id3Utils=function(){},shaka.util.Id3Utils.isHeader_=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]},shaka.util.Id3Utils.isFooter_=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]},shaka.util.Id3Utils.readSize_=function(e,t){var r=(127&e[t])<<21;return r|=(127&e[t+1])<<14,(r|=(127&e[t+2])<<7)|127&e[t+3]},shaka.util.Id3Utils.getFrameData_=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),r=shaka.util.Id3Utils.readSize_(e,4);return{type:t,size:r,data:e.subarray(10,10+r)}},shaka.util.Id3Utils.decodeFrame_=function(e){var t=shaka.util.BufferUtils,r=shaka.util.StringUtils,n={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if("APIC"===e.type){if(2>e.size)return null;if(e.data[0]!==shaka.util.Id3Utils.UTF8_encoding)return shaka.log.warning("Ignore frame with unrecognized character encoding"),null;var a=e.data.subarray(1).indexOf(0);if(-1===a)return null;var i=r.fromUTF8(t.toUint8(e.data,1,a)),o=e.data[2+a],s=e.data.subarray(3+a).indexOf(0);if(-1===s)return null;var l=r.fromUTF8(t.toUint8(e.data,3+a,s));return e="--\x3e"===i?r.fromUTF8(t.toUint8(e.data,4+a+s)):t.toArrayBuffer(e.data.subarray(4+a+s)),n.mimeType=i,n.pictureType=o,n.description=l,n.data=e,n}return"TXXX"===e.type||"WXXX"===e.type?2>e.size?null:e.data[0]!==shaka.util.Id3Utils.UTF8_encoding?(shaka.log.warning("Ignore frame with unrecognized character encoding"),null):-1===(o=e.data.subarray(1).indexOf(0))?null:(i=r.fromUTF8(t.toUint8(e.data,1,o)),e=r.fromUTF8(t.toUint8(e.data,2+o)).replace(/\0*$/,""),n.description=i,n.data=e,n):"PRIV"===e.type?2>e.size||-1===(i=e.data.indexOf(0))?null:(r=r.fromUTF8(t.toUint8(e.data,0,i)),n.description=r,"com.apple.streaming.transportStreamTimestamp"==r?(t=e.data.subarray(r.length+1),e=1&t[3],t=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7],t/=45,e&&(t+=47721858.84),n.data=t):(e=t.toArrayBuffer(e.data.subarray(r.length+1)),n.data=e),n):"T"===e.type[0]?2>e.size?null:e.data[0]!==shaka.util.Id3Utils.UTF8_encoding?(shaka.log.warning("Ignore frame with unrecognized character encoding"),null):(e=r.fromUTF8(e.data.subarray(1)).replace(/\0*$/,""),n.data=e,n):"W"===e.type[0]?(e=r.fromUTF8(e.data).replace(/\0*$/,""),n.data=e,n):e.data?(shaka.log.warning("Unrecognized ID3 frame type:",e.type),n.data=t.toArrayBuffer(e.data),n):null},shaka.util.Id3Utils.getID3Frames=function(e){for(var t=shaka.util.Id3Utils,r=0,n=[];t.isHeader_(e,r);){var a=t.readSize_(e,r+6);for(e[r+5]>>6&1&&(r+=10),a=(r+=10)+a;r+10<a;){var i=t.getFrameData_(e.subarray(r)),o=t.decodeFrame_(i);o&&n.push(o),r+=i.size+10}t.isFooter_(e,r)&&(r+=10)}return n},shaka.util.Id3Utils.getID3Data=function(e,t){t=void 0===t?0:t;for(var r=shaka.util.Id3Utils,n=t,a=0;r.isHeader_(e,t);){e[t+5]>>6&1&&(a+=10),a+=10,a+=r.readSize_(e,t+6),r.isFooter_(e,t+10)&&(a+=10),t+=a}return 0<a?e.subarray(n,n+a):new Uint8Array([])},goog.exportSymbol("shaka.util.Id3Utils",shaka.util.Id3Utils),goog.exportProperty(shaka.util.Id3Utils,"getID3Data",shaka.util.Id3Utils.getID3Data),goog.exportProperty(shaka.util.Id3Utils,"getID3Frames",shaka.util.Id3Utils.getID3Frames),shaka.util.Id3Utils.UTF8_encoding=3,shaka.util.Mp4BoxParsers=function(){},shaka.util.Mp4BoxParsers.parseTFHD=function(e,t){var r=null,n=null,a=null,i=e.readUint32();return 1&t&&(a=e.readUint64()),2&t&&e.skip(4),8&t&&(r=e.readUint32()),16&t&&(n=e.readUint32()),{trackId:i,defaultSampleDuration:r,defaultSampleSize:n,baseDataOffset:a}},shaka.util.Mp4BoxParsers.parseTFDT=function(e,t){return{baseMediaDecodeTime:1==t?e.readUint64():e.readUint32()}},shaka.util.Mp4BoxParsers.parseTFDTInaccurate=function(e,t){return 1==t?(t=e.readUint32(),e=e.readUint32(),{baseMediaDecodeTime:t*Math.pow(2,32)+e}):{baseMediaDecodeTime:e.readUint32()}},shaka.util.Mp4BoxParsers.parsePRFTInaccurate=function(e,t){e.readUint32();var r=e.readUint32();return r=1e3*r+e.readUint32()/Math.pow(2,32)*1e3,0===t?e=e.readUint32():(t=e.readUint32(),e=e.readUint32(),e=t*Math.pow(2,32)+e),{mediaTime:e,ntpTimestamp:r}},shaka.util.Mp4BoxParsers.parseMDHD=function(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),t=e.readUint32(),e.skip(4),e=e.readUint16(),{timescale:t,language:e=String.fromCharCode(96+(e>>10))+String.fromCharCode(96+((960&e)>>5))+String.fromCharCode(96+(31&e))}},shaka.util.Mp4BoxParsers.parseTREX=function(e){return e.skip(4),e.skip(4),{defaultSampleDuration:e.readUint32(),defaultSampleSize:e=e.readUint32()}},shaka.util.Mp4BoxParsers.parseTRUN=function(e,t,r){var n=e.readUint32(),a=[],i=null;1&r&&(i=e.readUint32()),4&r&&e.skip(4);for(var o=0;o<n;o++){var s={sampleDuration:null,sampleSize:null,sampleCompositionTimeOffset:null};256&r&&(s.sampleDuration=e.readUint32()),512&r&&(s.sampleSize=e.readUint32()),1024&r&&e.skip(4),2048&r&&(s.sampleCompositionTimeOffset=0==t?e.readUint32():e.readInt32()),a.push(s)}return{sampleCount:n,sampleData:a,dataOffset:i}},shaka.util.Mp4BoxParsers.parseTKHD=function(e,t){1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4));var r=e.readUint32();return 1==t?e.skip(8):e.skip(4),e.skip(4),e.skip(8),e.skip(2),e.skip(2),e.skip(2),e.skip(2),e.skip(36),{trackId:r,width:t=e.readUint16()+e.readUint16()/16,height:e=e.readUint16()+e.readUint16()/16}},shaka.util.Mp4BoxParsers.parseMP4A=function(e){e.skip(6),e.skip(2),e.skip(8);var t=e.readUint16();return e.skip(2),e.skip(2),e.skip(2),{channelCount:t,sampleRate:e=e.readUint16()+e.readUint16()/65536}},shaka.util.Mp4BoxParsers.parseESDS=function(e){for(var t,r,n="mp4a";e.hasMoreData();){t=e.readUint8();for(var a=e.readUint8();128&a;)a=e.readUint8();if(3==t)e.readUint16(),128&(a=e.readUint8())&&e.readUint16(),64&a&&e.skip(e.readUint8()),32&a&&e.readUint16();else if(4==t)r=e.readUint8(),e.skip(12);else if(5==t)break}return r&&(n+="."+shaka.util.Mp4BoxParsers.toHex_(r),5==t&&e.hasMoreData()&&(31===(r=(248&(t=e.readUint8()))>>3)&&e.hasMoreData()&&(r=32+((7&t)<<3)+((224&e.readUint8())>>5)),n+="."+r)),{codec:n}},shaka.util.Mp4BoxParsers.parseAVCC=function(e,t,r){return r=shaka.util.Mp4BoxParsers,t.skip(1),{codec:e+"."+r.toHex_(t.readUint8())+r.toHex_(t.readUint8())+r.toHex_(t.readUint8())}},shaka.util.Mp4BoxParsers.parseHVCC=function(e,t,r){var n=shaka.util.Mp4BoxParsers;t.skip(1);var a=["","A","B","C"][(r=t.readUint8())>>6],i=31&r,o=t.readUint32(),s=(32&r)>>5?"H":"L";for(r=[t.readUint8(),t.readUint8(),t.readUint8(),t.readUint8(),t.readUint8(),t.readUint8()],t=t.readUint8(),e=e+"."+a+i+"."+n.toHex_(n.reverseBits_(o),!0),e+="."+s+t,t="",n=r.length;n--;)((a=r[n])||t)&&(t="."+a.toString(16).toUpperCase()+t);return{codec:e+=t}},shaka.util.Mp4BoxParsers.parseDVCC=function(e,t,r){r=shaka.util.Mp4BoxParsers,t.skip(2);var n=t.readUint8();return t=n<<5&32|(t=t.readUint8())>>3&31,{codec:e+"."+r.addLeadingZero_(n>>1&127)+"."+r.addLeadingZero_(t)}},shaka.util.Mp4BoxParsers.parseVPCC=function(e,t,r){r=shaka.util.Mp4BoxParsers;var n=t.readUint8(),a=t.readUint8();return t=t.readUint8()>>4&15,{codec:e+"."+r.addLeadingZero_(n)+"."+r.addLeadingZero_(a)+"."+r.addLeadingZero_(t)}},shaka.util.Mp4BoxParsers.parseAV1C=function(e,t,r){r=shaka.util.Mp4BoxParsers,t.skip(1);var n=t.readUint8(),a=t.readUint8(),i=a>>>7?"H":"M",o=(64&a)>>6;o=2===(t=n>>>5)&&o?(32&a)>>5?12:10:o?10:8;var s=(16&a)>>4,l=(8&a)>>3,u=(4&a)>>2;return a&=3,{codec:e+"."+t+"."+r.addLeadingZero_(31&n)+i+"."+r.addLeadingZero_(o)+"."+s+"."+l+u+a+"."+r.addLeadingZero_(1)+"."+r.addLeadingZero_(1)+"."+r.addLeadingZero_(1)+".0"}},shaka.util.Mp4BoxParsers.parseFRMA=function(e){return e=e.readUint32(),{codec:shaka.util.Mp4Parser.typeToString(e)}},shaka.util.Mp4BoxParsers.parseTENC=function(e){var t=shaka.util.Uint8ArrayUtils;return e.readUint8(),e.readUint8(),e.readUint8(),e.readUint8(),{defaultKID:t.toHex(e.readBytes(16))}},shaka.util.Mp4BoxParsers.parseHDLR=function(e){return e.skip(8),{handlerType:e.readTerminatedString()}},shaka.util.Mp4BoxParsers.parsePRJI=function(e){return{projection:e.readTerminatedString()}},shaka.util.Mp4BoxParsers.parseHFOV=function(e){return{hfov:e.readUint32()/1e3}},shaka.util.Mp4BoxParsers.parseCOLR=function(e){var t=null,r=e.readBytes(4),n=""+String.fromCharCode(r[0]);if(n+=String.fromCharCode(r[1]),n+=String.fromCharCode(r[2]),"nclx"===(n+=String.fromCharCode(r[3])))switch(e.readUint16(),r=e.readUint16(),e.readUint16(),r){case 1:case 6:case 13:case 14:case 15:t="SDR";break;case 16:t="PQ";break;case 18:t="HLG"}return{videoRange:t}},shaka.util.Mp4BoxParsers.toHex_=function(e,t){return t=void 0!==t&&t,e=e.toString(16).toUpperCase(),t?e:("0"+e).slice(-2)},shaka.util.Mp4BoxParsers.reverseBits_=function(e){for(var t=0,r=0;32>r&&(t|=1&e,31!=r);r++)t<<=1,e>>=1;return t},shaka.util.Mp4BoxParsers.addLeadingZero_=function(e){return(10>e?"0":"")+e},shaka.util.ExpGolomb=function(e,t){this.data_=e,void 0!==t&&t&&(this.data_=this.ebsp2rbsp_(e)),this.workingBytesAvailable_=this.data_.byteLength,this.workingBitsAvailable_=this.workingWord_=0},shaka.util.ExpGolomb.prototype.ebsp2rbsp_=function(e){for(var t=new Uint8Array(e.byteLength),r=0,n=0;n<e.byteLength;n++)2<=n&&3==e[n]&&0==e[n-1]&&0==e[n-2]||(t[r]=e[n],r++);return shaka.util.BufferUtils.toUint8(t,0,r)},shaka.util.ExpGolomb.prototype.loadWord_=function(){var e=this.data_.byteLength-this.workingBytesAvailable_,t=new Uint8Array(4),r=Math.min(4,this.workingBytesAvailable_);0!==r&&(t.set(this.data_.subarray(e,e+r)),this.workingWord_=new shaka.util.DataViewReader(t,shaka.util.DataViewReader.Endianness.BIG_ENDIAN).readUint32(),this.workingBitsAvailable_=8*r,this.workingBytesAvailable_-=r)},shaka.util.ExpGolomb.prototype.skipBits=function(e){if(this.workingBitsAvailable_<=e){e-=this.workingBitsAvailable_;var t=Math.floor(e/8);e-=8*t,this.workingBitsAvailable_-=t,this.loadWord_()}this.workingWord_<<=e,this.workingBitsAvailable_-=e},shaka.util.ExpGolomb.prototype.readBits=function(e){var t=Math.min(this.workingBitsAvailable_,e),r=this.workingWord_>>>32-t;return this.workingBitsAvailable_-=t,0<this.workingBitsAvailable_?this.workingWord_<<=t:0<this.workingBytesAvailable_&&this.loadWord_(),0<(t=e-t)?r<<t|this.readBits(t):r},shaka.util.ExpGolomb.prototype.skipLeadingZeros_=function(){var e;for(e=0;e<this.workingBitsAvailable_;++e)if(0!=(this.workingWord_&2147483648>>>e))return this.workingWord_<<=e,this.workingBitsAvailable_-=e,e;return this.loadWord_(),e+this.skipLeadingZeros_()},shaka.util.ExpGolomb.prototype.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros_())},shaka.util.ExpGolomb.prototype.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros_();return this.readBits(e+1)-1},shaka.util.ExpGolomb.prototype.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},shaka.util.ExpGolomb.prototype.readBoolean=function(){return 1===this.readBits(1)},shaka.util.ExpGolomb.prototype.readUnsignedByte=function(){return this.readBits(8)},shaka.util.ExpGolomb.prototype.skipScalingList=function(e){for(var t=8,r=8,n=0;n<e;n++)0!==r&&(r=(t+(r=this.readExpGolomb())+256)%256),t=0===r?t:r},shaka.util.ExpGolomb.prototype.readSliceType=function(){return this.readUnsignedByte(),this.readUnsignedExpGolomb(),this.readUnsignedExpGolomb()},goog.exportSymbol("shaka.util.ExpGolomb",shaka.util.ExpGolomb),shaka.util.TsParser=function(){this.pmtId_=null,this.pmtParsed_=!1,this.videoCodec_=this.videoPid_=null,this.videoData_=[],this.videoPes_=[],this.audioCodec_=this.audioPid_=null,this.audioData_=[],this.audioPes_=[],this.id3Pid_=null,this.id3Data_=[],this.opusMetadata_=this.referenceDts_=this.referencePts_=null},shaka.util.TsParser.prototype.clearData=function(){this.videoData_=[],this.videoPes_=[],this.audioData_=[],this.audioPes_=[],this.id3Data_=[]},shaka.util.TsParser.prototype.parse=function(e){var t=shaka.util.TsParser.PacketLength_;if(e.length<3*t)return this;for(var r=Math.max(0,shaka.util.TsParser.syncOffset(e)),n=e.length-(e.length+r)%t,a=!1,i=r;i<n;i+=t)if(71==e[i]){var o=!!(64&e[i+1]),s=((31&e[i+1])<<8)+e[i+2];if(1<(48&e[i+3])>>4){var l=i+5+e[i+4];if(l==i+t)continue}else l=i+4;switch(s){case 0:o&&(l+=e[l]+1),this.pmtId_=this.getPmtId_(e,l);break;case 17:case 8191:break;case this.pmtId_:o&&(l+=e[l]+1),-1!=(o=this.parsePMT_(e,l)).video&&(this.videoPid_=o.video,this.videoCodec_=o.videoCodec),-1!=o.audio&&(this.audioPid_=o.audio,this.audioCodec_=o.audioCodec),-1!=o.id3&&(this.id3Pid_=o.id3),a&&!this.pmtParsed_&&(shaka.log.debug("reparse from beginning"),a=!1,i=r-t),this.pmtParsed_=!0;break;case this.videoPid_:s=e.subarray(l,i+t),o?this.videoData_.push([s]):this.videoData_.length&&this.videoData_[this.videoData_.length-1]&&this.videoData_[this.videoData_.length-1].push(s);break;case this.audioPid_:s=e.subarray(l,i+t),o?this.audioData_.push([s]):this.audioData_.length&&this.audioData_[this.audioData_.length-1]&&this.audioData_[this.audioData_.length-1].push(s);break;case this.id3Pid_:s=e.subarray(l,i+t),o?this.id3Data_.push([s]):this.id3Data_.length&&this.id3Data_[this.id3Data_.length-1]&&this.id3Data_[this.id3Data_.length-1].push(s);break;default:a=!0}}else shaka.log.warning("Found TS packet that do not start with 0x47");return this},shaka.util.TsParser.prototype.getPmtId_=function(e,t){return(31&e[t+10])<<8|e[t+11]},shaka.util.TsParser.prototype.parsePMT_=function(e,t){var r=shaka.util.StringUtils,n={audio:-1,video:-1,id3:-1,audioCodec:"",videoCodec:""},a=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){var i=(31&e[t+1])<<8|e[t+2],o=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 6:if(0<o)for(var s=t+5,l=o;2<l;){var u=e[s+1]+2;switch(e[s]){case 5:var c=e.subarray(s+2,s+u);c=r.fromCharCode(c),-1==n.audio&&"Opus"===c?(n.audio=i,n.audioCodec="opus"):-1==n.video&&"AV01"===c&&(n.video=i,n.videoCodec="av1");break;case 106:-1==n.audio&&(n.audio=i,n.audioCodec="ac3");break;case 122:-1==n.audio&&(n.audio=i,n.audioCodec="ec3");break;case 124:-1==n.audio&&(n.audio=i,n.audioCodec="aac");break;case 127:"opus"==n.audioCodec&&(c=null,128===e[s+2]&&(c=e[s+3]),null!=c&&(this.opusMetadata_={channelCount:0==(15&c)?2:15&c,channelConfigCode:c,sampleRate:48e3}))}s+=u,l-=u}break;case 15:-1==n.audio&&(n.audio=i,n.audioCodec="aac");break;case 17:-1==n.audio&&(n.audio=i,n.audioCodec="aac-loas");break;case 21:-1==n.id3&&(n.id3=i);break;case 27:-1==n.video&&(n.video=i,n.videoCodec="avc");break;case 3:case 4:-1==n.audio&&(n.audio=i,n.audioCodec="mp3");break;case 36:-1==n.video&&(n.video=i,n.videoCodec="hvc");break;case 129:-1==n.audio&&(n.audio=i,n.audioCodec="ac3");break;case 132:case 135:-1==n.audio&&(n.audio=i,n.audioCodec="ec3")}t+=o+5}return n},shaka.util.TsParser.prototype.parsePES_=function(e){if(1!=(e[0]<<16|e[1]<<8|e[2]))return null;var t={data:new Uint8Array(0),packetLength:e[4]<<8|e[5],pts:null,dts:null,nalus:[]};if(t.packetLength&&t.packetLength>e.byteLength-6)return null;var r=e[7];if(192&r){var n=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2;null==this.referencePts_&&(this.referencePts_=n),t.pts=this.handleRollover_(n,this.referencePts_),this.referencePts_=t.pts,t.dts=t.pts,64&r&&(r=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2,null==this.referenceDts_&&(this.referenceDts_=r),t.dts=this.handleRollover_(r,this.referenceDts_)),this.referenceDts_=t.dts}return r=e[8]+9,e.byteLength<=r?null:(t.data=e.subarray(r),t)},shaka.util.TsParser.prototype.parseAvcNalus=function(e,t){return shaka.Deprecate.deprecateFeature(5,"TsParser.parseAvcNalus","Please use parseNalus function instead."),this.parseNalus(e)},shaka.util.TsParser.prototype.parseNalus=function(e,t,r){var n=shaka.util.TsParser.Timescale;n=e.pts?e.pts/n:null;var a=(e=e.data).byteLength,i=1;"hvc"==this.videoCodec_&&(i=2);for(var o,s=r||0,l=[],u=-1,c=0,d=0;d<a;++d){var p=e[d];if(p){if(2<=s&&1==p){if(t&&!l.length&&-1==u&&(p=d-(3<s?3:s),r&&0!=p&&(p=e.subarray(0,p),t.data=shaka.util.Uint8ArrayUtils.concat(t.data,p),t.fullData=shaka.util.Uint8ArrayUtils.concat(t.fullData,p))),0<=u?(s=d-((3<s?3:s)+1),u={data:e.subarray(u+i,s+1),fullData:e.subarray(u,s+1),type:c,time:n},l.push(u)):t&&!l.length&&(0<(u=d-s)&&(u=e.subarray(0,u),t.data=shaka.util.Uint8ArrayUtils.concat(t.data,u),t.fullData=shaka.util.Uint8ArrayUtils.concat(t.fullData,u))),d>=a-i)return shaka.log.warning("Malformed TS, incomplete NALU, ignoring."),l;u=++d,c="hvc"==this.videoCodec_?e[d]>>1&63:31&e[d]}s=0}else s++;d>=a-1&&0<=u&&0<=s&&(o={data:e.subarray(u+i,a),fullData:e.subarray(u,a),type:c,time:n})}return o&&l.push(o),!l.length&&t&&(t.data=shaka.util.Uint8ArrayUtils.concat(t.data,e),t.fullData=shaka.util.Uint8ArrayUtils.concat(t.fullData,e)),l},shaka.util.TsParser.prototype.getMetadata=function(){for(var e=shaka.util.TsParser.Timescale,t=[],r=$jscomp.makeIterator(this.id3Data_),n=r.next();!n.done;n=r.next())n=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(n.value)),(n=this.parsePES_(n))&&t.push({cueTime:n.pts?n.pts/e:null,data:n.data,frames:shaka.util.Id3Utils.getID3Frames(n.data),dts:n.dts,pts:n.pts});return t},shaka.util.TsParser.prototype.getAudioData=function(){if(this.audioData_.length&&!this.audioPes_.length){for(var e=!1,t=$jscomp.makeIterator(this.audioData_),r=t.next();!r.done;r=t.next()){var n=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(r.value)),a=this.parsePES_(n);r=this.audioPes_.length?this.audioPes_[this.audioPes_.length-1]:null,a&&null!=a.pts&&null!=a.dts&&(!r||r.pts!=a.pts&&r.dts!=a.dts)?(this.audioPes_.length&&a.dts<(r.dts||0)&&(e=!0),this.audioPes_.push(a)):this.audioPes_.length&&(n=a?a.data:n)&&((r=this.audioPes_.pop()).data=shaka.util.Uint8ArrayUtils.concat(r.data,n),this.audioPes_.push(r))}e&&(this.audioPes_=this.audioPes_.sort((function(e,t){var r=(e.pts||0)-(t.pts||0);return(e.dts||0)-(t.dts||0)||r})))}return this.audioPes_},shaka.util.TsParser.prototype.getVideoData=function(e){if(e=void 0===e||e,this.videoData_.length&&!this.videoPes_.length){for(var t=!1,r=$jscomp.makeIterator(this.videoData_),n=r.next();!n.done;n=r.next()){var a=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(n.value)),i=this.parsePES_(a);n=this.videoPes_.length?this.videoPes_[this.videoPes_.length-1]:null,i&&null!=i.pts&&null!=i.dts&&(!n||n.pts!=i.pts&&n.dts!=i.dts)?(this.videoPes_.length&&i.dts<(n.dts||0)&&(t=!0),this.videoPes_.push(i)):this.videoPes_.length&&(a=i?i.data:a)&&((n=this.videoPes_.pop()).data=shaka.util.Uint8ArrayUtils.concat(n.data,a),this.videoPes_.push(n))}if(e){var o;for(n=(r=$jscomp.makeIterator(this.videoPes_)).next();!n.done;n=r.next())(n=n.value).nalus=this.parseNalus(n,o,void 0),n.nalus.length&&(o=n.nalus[n.nalus.length-1]);this.videoPes_=this.videoPes_.filter((function(e){return e.nalus.length}))}t&&(this.videoPes_=this.videoPes_.sort((function(e,t){var r=(e.pts||0)-(t.pts||0);return(e.dts||0)-(t.dts||0)||r})))}return e?this.videoPes_:(e=this.videoPes_,this.videoPes_=[],e)},shaka.util.TsParser.prototype.getStartTime=function(e){var t=shaka.util.TsParser.Timescale;if("audio"==e){e=null;var r=this.getAudioData();return r.length&&(e=r[0],e=Math.min(e.dts,e.pts)/t),e}return"video"==e?(e=null,(r=this.getVideoData(!1)).length&&(e=r[0],e=Math.min(e.dts,e.pts)/t),e):null},shaka.util.TsParser.prototype.getCodecs=function(){return{audio:this.audioCodec_,video:this.videoCodec_}},shaka.util.TsParser.prototype.getVideoNalus=function(){for(var e=[],t=$jscomp.makeIterator(this.getVideoData()),r=t.next();!r.done;r=t.next())e.push.apply(e,$jscomp.arrayFromIterable(r.value.nalus));return e},shaka.util.TsParser.prototype.getVideoResolution=function(){shaka.Deprecate.deprecateFeature(5,"TsParser.getVideoResolution","Please use getVideoInfo function instead.");var e=this.getVideoInfo();return{height:e.height,width:e.width}},shaka.util.TsParser.prototype.getVideoInfo=function(){return"hvc"==this.videoCodec_?this.getHvcInfo_():this.getAvcInfo_()},shaka.util.TsParser.prototype.getAvcInfo_=function(){var e=shaka.util.TsParser,t={height:null,width:null,codec:null},r=this.getVideoNalus();if(!r.length)return t;if(!(r=r.find((function(t){return t.type==e.H264_NALU_TYPE_SPS_}))))return t;var n=(r=new shaka.util.ExpGolomb(r.data)).readUnsignedByte(),a=r.readUnsignedByte(),i=r.readUnsignedByte();if(r.skipExpGolomb(),e.PROFILES_WITH_OPTIONAL_SPS_DATA_.includes(n)){var o=r.readUnsignedExpGolomb();if(3===o&&r.skipBits(1),r.skipExpGolomb(),r.skipExpGolomb(),r.skipBits(1),r.readBoolean()){o=3!==o?8:12;for(var s=0;s<o;s++)r.readBoolean()&&(6>s?r.skipScalingList(16):r.skipScalingList(64))}}if(r.skipExpGolomb(),0===(o=r.readUnsignedExpGolomb()))r.readUnsignedExpGolomb();else if(1===o)for(r.skipBits(1),r.skipExpGolomb(),r.skipExpGolomb(),o=r.readUnsignedExpGolomb(),s=0;s<o;s++)r.skipExpGolomb();r.skipExpGolomb(),r.skipBits(1),o=r.readUnsignedExpGolomb(),s=r.readUnsignedExpGolomb();var l=r.readBits(1);0===l&&r.skipBits(1),r.skipBits(1);var u=0,c=0,d=0,p=0;return r.readBoolean()&&(u=r.readUnsignedExpGolomb(),c=r.readUnsignedExpGolomb(),d=r.readUnsignedExpGolomb(),p=r.readUnsignedExpGolomb()),t.height=String((2-l)*(s+1)*16-2*d-2*p),t.width=String(16*(o+1)-2*u-2*c),t.codec="avc1."+this.byteToHex_(n)+this.byteToHex_(a)+this.byteToHex_(i),t},shaka.util.TsParser.prototype.getHvcInfo_=function(){var e=shaka.util.TsParser,t={height:null,width:null,codec:null},r=this.getVideoNalus();if(!r.length)return t;if(!(r=r.find((function(t){return t.type==e.H265_NALU_TYPE_SPS_}))))return t;var n=new shaka.util.ExpGolomb(r.fullData,!0);n.readUnsignedByte(),n.readUnsignedByte(),n.readBits(4);var a=n.readBits(3);n.readBoolean();var i=n.readBits(2),o=n.readBits(1),s=n.readBits(5),l=n.readBits(32);r=n.readUnsignedByte();for(var u=n.readUnsignedByte(),c=n.readUnsignedByte(),d=n.readUnsignedByte(),p=n.readUnsignedByte(),h=n.readUnsignedByte(),f=n.readUnsignedByte(),m=[],g=[],y=0;y<a;y++)m.push(n.readBoolean()),g.push(n.readBoolean());if(0<a)for(y=a;8>y;y++)n.readBits(2);for(y=0;y<a;y++)m[y]&&n.readBits(88),g[y]&&n.readUnsignedByte();n.readUnsignedExpGolomb(),3==(a=n.readUnsignedExpGolomb())&&n.readBits(1),m=n.readUnsignedExpGolomb(),g=n.readUnsignedExpGolomb();var v=y=0,_=0,k=0;return n.readBoolean()&&(y+=n.readUnsignedExpGolomb(),v+=n.readUnsignedExpGolomb(),_+=n.readUnsignedExpGolomb(),k+=n.readUnsignedExpGolomb()),t.width=String(m-(y+v)*(1===a||2===a?2:1)),t.height=String(g-(_+k)*(1===a?2:1)),o=1==o?"H":"L",s="hvc1."+(n=["","A","B","C"][i])+s+"."+(l=function(e){for(var t=0,r=0;32>r;r++)t|=(e>>r&1)<<31-r;return t>>>0}(l)).toString(16).toUpperCase(),s+="."+o+f,h&&(s+="."+h.toString(16).toUpperCase()),p&&(s+="."+p.toString(16).toUpperCase()),d&&(s+="."+d.toString(16).toUpperCase()),c&&(s+="."+c.toString(16).toUpperCase()),u&&(s+="."+u.toString(16).toUpperCase()),r&&(s+="."+r.toString(16).toUpperCase()),t.codec=s,t},shaka.util.TsParser.prototype.getOpusMetadata=function(){return this.opusMetadata_},shaka.util.TsParser.prototype.byteToHex_=function(e){return("0"+e.toString(16).toUpperCase()).slice(-2)},shaka.util.TsParser.prototype.handleRollover_=function(e,t){var r=1;for(e>t&&(r=-1);4294967296<Math.abs(t-e);)e+=8589934592*r;return e},shaka.util.TsParser.probe=function(e){return!(0>(e=shaka.util.TsParser.syncOffset(e)))&&(0<e&&shaka.log.warning("MPEG2-TS detected but first sync word found @ offset "+e+", junk ahead ?"),!0)},shaka.util.TsParser.syncOffset=function(e){for(var t=shaka.util.TsParser.PacketLength_,r=Math.min(1e3,e.length-3*t),n=0;n<r;){if(71==e[n]&&71==e[n+t]&&71==e[n+2*t])return n;n++}return-1},goog.exportSymbol("shaka.util.TsParser",shaka.util.TsParser),goog.exportProperty(shaka.util.TsParser,"syncOffset",shaka.util.TsParser.syncOffset),goog.exportProperty(shaka.util.TsParser,"probe",shaka.util.TsParser.probe),goog.exportProperty(shaka.util.TsParser.prototype,"getVideoInfo",shaka.util.TsParser.prototype.getVideoInfo),goog.exportProperty(shaka.util.TsParser.prototype,"getVideoResolution",shaka.util.TsParser.prototype.getVideoResolution),goog.exportProperty(shaka.util.TsParser.prototype,"getVideoNalus",shaka.util.TsParser.prototype.getVideoNalus),goog.exportProperty(shaka.util.TsParser.prototype,"getCodecs",shaka.util.TsParser.prototype.getCodecs),goog.exportProperty(shaka.util.TsParser.prototype,"getStartTime",shaka.util.TsParser.prototype.getStartTime),goog.exportProperty(shaka.util.TsParser.prototype,"getVideoData",shaka.util.TsParser.prototype.getVideoData),goog.exportProperty(shaka.util.TsParser.prototype,"getAudioData",shaka.util.TsParser.prototype.getAudioData),goog.exportProperty(shaka.util.TsParser.prototype,"getMetadata",shaka.util.TsParser.prototype.getMetadata),goog.exportProperty(shaka.util.TsParser.prototype,"parseNalus",shaka.util.TsParser.prototype.parseNalus),goog.exportProperty(shaka.util.TsParser.prototype,"parseAvcNalus",shaka.util.TsParser.prototype.parseAvcNalus),goog.exportProperty(shaka.util.TsParser.prototype,"parse",shaka.util.TsParser.prototype.parse),goog.exportProperty(shaka.util.TsParser.prototype,"clearData",shaka.util.TsParser.prototype.clearData),shaka.util.TsParser.Timescale=9e4,goog.exportProperty(shaka.util.TsParser,"Timescale",shaka.util.TsParser.Timescale),shaka.util.TsParser.PacketLength_=188,shaka.util.TsParser.H264_NALU_TYPE_SPS_=7,shaka.util.TsParser.H265_NALU_TYPE_SPS_=33,shaka.util.TsParser.PROFILES_WITH_OPTIONAL_SPS_DATA_=[100,110,122,244,44,83,86,118,128,138,139,134],shaka.lcevc={},shaka.lcevc.Dec=function(e,t,r){this.dec_=null,this.variantId_=-1,this.media_=e,this.canvas_=t,this.decConfig_=r,this.toBeDeprecated_=!1,this.create_()},shaka.lcevc.Dec.prototype.appendBuffer=function(e,t){this.dec_&&this.dec_.appendBuffer(e,"video",this.variantId_,-t)},shaka.lcevc.Dec.prototype.hideCanvas=function(){this.dec_&&this.canvas_.classList.add("shaka-hidden")},shaka.lcevc.Dec.prototype.create_=function(){this.isSupported_()&&!this.dec_&&this.lcevcLib_.SupportObject.webGLSupport(this.canvas_)&&(this.canvas_.classList.remove("shaka-hidden"),this.dec_=this.toBeDeprecated_?new this.lcevcLib_.LcevcDil(this.media_,this.canvas_,this.decConfig_):new this.lcevcLib_.LCEVCdec(this.media_,this.canvas_,this.decConfig_))},shaka.lcevc.Dec.prototype.release=function(){this.dec_&&(this.dec_.close(),this.dec_=null)},shaka.lcevc.Dec.prototype.isSupported_=function(){if("undefined"==typeof libDPIModule&&shaka.log.alwaysWarn("Could not find LCEVC Library dependencies on this page"),"undefined"!=typeof LCEVCdec)this.lcevcLib_=LCEVCdec;else{if("undefined"==typeof LcevcDil)return shaka.log.alwaysWarn("Could not find LCEVC Library on this page"),!1;this.lcevcLib_=LcevcDil,this.toBeDeprecated_=!0,shaka.Deprecate.deprecateFeature(5,"LcevcDil","lcevc_dil.js is deprecated, please use lcevc_dec.js instead")}return void 0===this.lcevcLib_.SupportObject?(shaka.log.alwaysWarn("Could not find LCEVC Library on this page"),!1):(this.lcevcLib_.SupportObject.SupportStatus||shaka.log.alwaysWarn(this.lcevcLib_.SupportObject.SupportError),void 0!==this.lcevcLib_&&"undefined"!=typeof libDPIModule&&this.canvas_ instanceof HTMLCanvasElement&&this.lcevcLib_.SupportObject.SupportStatus)},shaka.lcevc.Dec.prototype.updateVariant=function(e,t){var r=shaka.lcevc.Dec.ContainerFormat.MPEG2_TS,n=shaka.lcevc.Dec.StreamingFormat.OTHER;switch(e.mimeType){case"video/webm":r=shaka.lcevc.Dec.ContainerFormat.WEBM;break;case"video/mp4":r=shaka.lcevc.Dec.ContainerFormat.MP4}switch(t){case"DASH":n=shaka.lcevc.Dec.StreamingFormat.DASH;break;case"HLS":n=shaka.lcevc.Dec.StreamingFormat.HLS}this.dec_&&(this.variantId_=e.id,this.dec_.setLevelSwitching(e.id,!0),this.dec_.setContainerFormat(r),this.toBeDeprecated_||this.dec_.setStreamingFormat(n))},goog.exportSymbol("shaka.lcevc.Dec",shaka.lcevc.Dec),goog.exportProperty(shaka.lcevc.Dec.prototype,"release",shaka.lcevc.Dec.prototype.release),shaka.lcevc.Dec.ContainerFormat={MPEG2_TS:0,WEBM:1,MP4:2},shaka.lcevc.Dec.StreamingFormat={HLS:0,DASH:1,OTHER:-1},shaka.media.MediaSourceEngine=function(e,t,r,n){var a=this;this.video_=e,this.config_=null,this.textDisplayer_=t,this.sourceBuffers_={},this.sourceBufferTypes_={},this.expectedEncryption_={},this.textEngine_=null,this.segmentRelativeVttTiming_=!1,e=function(e,t,r){},this.onMetadata_=r||e,this.lcevcDec_=n||null,this.queues_={},this.eventManager_=new shaka.util.EventManager,this.transmuxers_={},this.captionParser_=null,this.mediaSourceOpen_=new shaka.util.PublicPromise,this.url_="",this.playbackHasBegun_=!1,this.mediaSource_=this.createMediaSource(this.mediaSourceOpen_),this.reloadingMediaSource_=!1,this.destroyer_=new shaka.util.Destroyer((function(){return a.doDestroy_()})),this.sequenceMode_=!1,this.manifestType_=shaka.media.ManifestParser.UNKNOWN,this.attemptTimestampOffsetCalculation_=this.ignoreManifestTimestampsInSegmentsMode_=!1,this.textSequenceModeOffset_=new shaka.util.PublicPromise,this.needSplitMuxedContent_=!1,this.streamingAllowed_=!0,this.tsParser_=this.lastDuration_=null},shaka.media.MediaSourceEngine.prototype.createMediaSource=function(e){var t=this;if(window.ManagedMediaSource){this.video_.disableRemotePlayback=!0;var r=new ManagedMediaSource;return this.eventManager_.listen(r,"startstreaming",(function(){t.streamingAllowed_=!0})),this.eventManager_.listen(r,"endstreaming",(function(){t.streamingAllowed_=!1})),this.eventManager_.listenOnce(r,"sourceopen",(function(){return t.onSourceOpen_(e)})),this.eventManager_.listenOnce(this.video_,"playing",(function(){t.playbackHasBegun_=!0})),this.url_=shaka.media.MediaSourceEngine.createObjectURL(r),this.video_.src=this.url_,r}return r=new MediaSource,this.eventManager_.listenOnce(r,"sourceopen",(function(){return t.onSourceOpen_(e)})),this.eventManager_.listenOnce(this.video_,"playing",(function(){t.playbackHasBegun_=!0})),this.url_=shaka.media.MediaSourceEngine.createObjectURL(r),this.video_.src=this.url_,r},shaka.media.MediaSourceEngine.prototype.onSourceOpen_=function(e){goog.asserts.assert(this.url_,"Must have object URL"),URL.revokeObjectURL(this.url_),e.resolve()},shaka.media.MediaSourceEngine.isStreamSupported=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h,f,m;return $jscomp.asyncExecutePromiseGeneratorProgram((function(g){if(1==g.nextAddress)return e.createSegmentIndex?g.yield(e.createSegmentIndex(),2):g.jumpTo(2);if(!e.segmentIndex)return g.return(!1);if(e.segmentIndex.isEmpty())return g.return(!0);for(r=shaka.util.MimeUtils,n=shaka.transmuxer.TransmuxerEngine,a=shaka.util.ManifestParserUtils.ContentType,i=shaka.util.StreamUtils,o=new Set,s=$jscomp.makeIterator(e.segmentIndex),l=s.next();!l.done;l=s.next())if(u=l.value,c=u.mimeType||e.mimeType||"",d=u.codecs||e.codecs||"",p=c+":"+d,!o.has(p))if(o.add(p),t==a.TEXT){if(h=r.getFullType(c,d),!shaka.text.TextEngine.isTypeSupported(h))return g.return(!1)}else if(t==a.VIDEO?d=i.getCorrectVideoCodecs(d):t==a.AUDIO&&(d=i.getCorrectAudioCodecs(d,c)),f=r.getExtendedType(e,c,d),m=r.getFullTypeWithAllCodecs(c,d),!shaka.media.Capabilities.isTypeSupported(f)&&!n.isSupported(m,e.type))return g.return(!1);return g.return(!0)}))},shaka.media.MediaSourceEngine.probeSupport=function(){for(var e='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",video/mp4; codecs="dvh1.20.01",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="ac-4",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat($jscomp.arrayFromIterable(shaka.util.MimeUtils.RAW_FORMATS)),t={},r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){r=r.value,shaka.text.TextEngine.isTypeSupported(r)?t[r]=!0:shaka.util.Platform.supportsMediaSource()?t[r]=shaka.media.Capabilities.isTypeSupported(r)||shaka.transmuxer.TransmuxerEngine.isSupported(r):t[r]=shaka.util.Platform.supportsMediaType(r);var n=r.split(";")[0];t[n]=t[n]||t[r]}return t},shaka.media.MediaSourceEngine.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.media.MediaSourceEngine.prototype.doDestroy_=function(){var e,t,r,n,a,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){for(r in e=shaka.util.Functional,t=[],u.queues_)for(n=u.queues_[r],a=n[0],u.queues_[r]=n.slice(0,1),a&&t.push(a.p.catch(e.noop)),i=$jscomp.makeIterator(n.slice(1)),o=i.next();!o.done;o=i.next())o.value.p.reject(shaka.util.Destroyer.destroyedError());for(s in u.textEngine_&&t.push(u.textEngine_.destroy()),u.textDisplayer_&&t.push(u.textDisplayer_.destroy()),u.transmuxers_)t.push(u.transmuxers_[s].destroy());return c.yield(Promise.all(t),2)}if(u.eventManager_&&(u.eventManager_.release(),u.eventManager_=null),u.video_&&(u.video_.removeAttribute("src"),u.video_.load(),u.video_=null),u.config_=null,u.mediaSource_=null,u.textEngine_=null,u.textDisplayer_=null,u.sourceBuffers_={},u.transmuxers_={},u.captionParser_=null,goog.DEBUG)for(l in u.queues_)goog.asserts.assert(0==u.queues_[l].length,l+" queue should be empty after destroy!");u.queues_={},u.lcevcDec_=null,u.tsParser_=null,c.jumpToEnd()}))},shaka.media.MediaSourceEngine.prototype.open=function(){return this.mediaSourceOpen_},shaka.media.MediaSourceEngine.prototype.init=function(e,t,r,n){t=void 0!==t&&t,r=void 0===r?shaka.media.ManifestParser.UNKNOWN:r,n=void 0!==n&&n;var a,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:return a=shaka.util.ManifestParserUtils.ContentType,c.yield(u.mediaSourceOpen_,2);case 2:u.sequenceMode_=t,u.manifestType_=r,u.ignoreManifestTimestampsInSegmentsMode_=n,u.attemptTimestampOffsetCalculation_=!u.sequenceMode_&&u.manifestType_==shaka.media.ManifestParser.HLS&&!u.ignoreManifestTimestampsInSegmentsMode_,u.tsParser_=null,i=$jscomp.makeIterator(e.keys()),o=i.next();case 3:if(o.done){c.jumpTo(0);break}return s=o.value,l=e.get(s),c.yield(u.initSourceBuffer_(s,l,l.codecs),6);case 6:u.needSplitMuxedContent_?(u.queues_[a.AUDIO]=[],u.queues_[a.VIDEO]=[]):u.queues_[s]=[],o=i.next(),c.jumpTo(3)}}))},shaka.media.MediaSourceEngine.prototype.initSourceBuffer_=function(e,t,r){var n,a,i,o,s,l,u,c,d,p,h,f,m=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(g){switch(g.nextAddress){case 1:return n=shaka.util.ManifestParserUtils.ContentType,a=goog.asserts,i=a.assert,g.yield(shaka.media.MediaSourceEngine.isStreamSupported(t,e),2);case 2:if(i.call(a,g.yieldResult,"Type negotiation should happen before MediaSourceEngine.init!"),o=shaka.util.MimeUtils.getFullType(t.mimeType,r),e==n.TEXT){m.reinitText(o,m.sequenceMode_,t.external),g.jumpTo(0);break}if(s=m.config_.forceTransmux,(!shaka.media.Capabilities.isTypeSupported(o)||!m.sequenceMode_&&shaka.util.MimeUtils.RAW_FORMATS.includes(o))&&(s=!0),l=shaka.util.MimeUtils.getFullTypeWithAllCodecs(t.mimeType,r),!s){g.jumpTo(4);break}if(u=shaka.util.ManifestParserUtils.guessCodecsSafe(n.AUDIO,(r||"").split(",")),c=shaka.util.ManifestParserUtils.guessCodecsSafe(n.VIDEO,(r||"").split(",")),!u||!c){g.jumpTo(5);break}return m.needSplitMuxedContent_=!0,g.yield(m.initSourceBuffer_(n.AUDIO,t,u),6);case 6:return g.yield(m.initSourceBuffer_(n.VIDEO,t,c),7);case 7:return g.return();case 5:(d=shaka.transmuxer.TransmuxerEngine.findTransmuxer(l))&&(p=d(),m.transmuxers_[e]=p,o=p.convertCodecs(e,l));case 4:h=m.addExtraFeaturesToMimeType_(o),m.destroyer_.ensureNotDestroyed();try{f=m.mediaSource_.addSourceBuffer(h)}catch(e){throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW,e,"The mediaSource_ status was "+m.mediaSource_.readyState+" expected 'open'")}m.sequenceMode_&&(f.mode=shaka.media.MediaSourceEngine.SourceBufferMode_.SEQUENCE),m.eventManager_.listen(f,"error",(function(){return m.onError_(e)})),m.eventManager_.listen(f,"updateend",(function(){return m.onUpdateEnd_(e)})),m.sourceBuffers_[e]=f,m.sourceBufferTypes_[e]=o,m.expectedEncryption_[e]=!!t.drmInfos.length,g.jumpToEnd()}}))},shaka.media.MediaSourceEngine.prototype.configure=function(e){this.config_=e,this.textEngine_&&this.textEngine_.setModifyCueCallback(e.modifyCueCallback)},shaka.media.MediaSourceEngine.prototype.isStreamingAllowed=function(){return this.streamingAllowed_},shaka.media.MediaSourceEngine.prototype.reinitText=function(e,t,r){this.textEngine_||(this.textEngine_=new shaka.text.TextEngine(this.textDisplayer_),this.textEngine_.setModifyCueCallback(this.config_.modifyCueCallback)),this.textEngine_.initParser(e,t,r||this.segmentRelativeVttTiming_,this.manifestType_)},shaka.media.MediaSourceEngine.prototype.ended=function(){return!this.reloadingMediaSource_&&(!this.mediaSource_||"ended"==this.mediaSource_.readyState)},shaka.media.MediaSourceEngine.prototype.bufferStart=function(e){return this.reloadingMediaSource_||!Object.keys(this.sourceBuffers_).length?null:e==shaka.util.ManifestParserUtils.ContentType.TEXT?this.textEngine_.bufferStart():shaka.media.TimeRangesUtils.bufferStart(this.getBuffered_(e))},shaka.media.MediaSourceEngine.prototype.bufferEnd=function(e){return this.reloadingMediaSource_?null:e==shaka.util.ManifestParserUtils.ContentType.TEXT?this.textEngine_.bufferEnd():shaka.media.TimeRangesUtils.bufferEnd(this.getBuffered_(e))},shaka.media.MediaSourceEngine.prototype.isBuffered=function(e,t){return!this.reloadingMediaSource_&&(e==shaka.util.ManifestParserUtils.ContentType.TEXT?this.textEngine_.isBuffered(t):(e=this.getBuffered_(e),shaka.media.TimeRangesUtils.isBuffered(e,t)))},shaka.media.MediaSourceEngine.prototype.bufferedAheadOf=function(e,t){return this.reloadingMediaSource_?0:e==shaka.util.ManifestParserUtils.ContentType.TEXT?this.textEngine_.bufferedAheadOf(t):(e=this.getBuffered_(e),shaka.media.TimeRangesUtils.bufferedAheadOf(e,t))},shaka.media.MediaSourceEngine.prototype.getBufferedInfo=function(){var e=shaka.util.ManifestParserUtils.ContentType,t=shaka.media.TimeRangesUtils;if(e={total:this.reloadingMediaSource_?[]:t.getBufferedInfo(this.video_.buffered),audio:this.reloadingMediaSource_?[]:t.getBufferedInfo(this.getBuffered_(e.AUDIO)),video:this.reloadingMediaSource_?[]:t.getBufferedInfo(this.getBuffered_(e.VIDEO)),text:[]},this.textEngine_){t=this.textEngine_.bufferStart();var r=this.textEngine_.bufferEnd();null!=t&&null!=r&&e.text.push({start:t,end:r})}return e},shaka.media.MediaSourceEngine.prototype.getBuffered_=function(e){try{return this.sourceBuffers_[e].buffered}catch(t){return e in this.sourceBuffers_&&shaka.log.error("failed to get buffered range for "+e,t),null}},shaka.media.MediaSourceEngine.prototype.getCaptionParser=function(e){return new shaka.media.ClosedCaptionParser(e)},shaka.media.MediaSourceEngine.prototype.getTimestampAndDispatchMetadata_=function(e,t,r,n,a){var i=null,o=shaka.util.BufferUtils.toUint8(t);if(shaka.util.MimeUtils.RAW_FORMATS.includes(n))(a=shaka.util.Id3Utils.getID3Frames(o)).length&&r&&((e=a.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&e.data&&(i=Math.round(e.data)/1e3),this.onMetadata_([{cueTime:r.startTime,data:o,frames:a,dts:r.startTime,pts:r.startTime}],0,r.endTime));else if(n.includes("/mp4")&&r&&0==r.timestampOffset&&r.initSegmentReference&&r.initSegmentReference.timescale){var s=r.initSegmentReference.timescale;if(!isNaN(s)){r=shaka.util.Mp4Parser;var l=0,u=!1;(new r).box("moof",r.children).box("traf",r.children).fullBox("tfdt",(function(e){goog.asserts.assert(0==e.version||1==e.version,"TFDT version can only be 0 or 1"),l=shaka.util.Mp4BoxParsers.parseTFDTInaccurate(e.reader,e.version).baseMediaDecodeTime/s,u=!0,e.parser.stop()})).parse(t,!0),u&&(i=l)}}else!n.includes("/mp4")&&!n.includes("/webm")&&shaka.util.TsParser.probe(o)&&(this.tsParser_?this.tsParser_.clearData():this.tsParser_=new shaka.util.TsParser,null!=(e=(o=this.tsParser_.parse(o)).getStartTime(e))&&(i=e),(o=o.getMetadata()).length)&&this.onMetadata_(o,a,r?r.endTime:null);return i},shaka.media.MediaSourceEngine.prototype.appendBuffer=function(e,t,r,n,a,i,o,s,l){i=void 0!==i&&i,o=void 0!==o&&o,s=void 0!==s&&s,l=void 0!==l&&l;var u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(S){switch(S.nextAddress){case 1:if(u=shaka.util.ManifestParserUtils.ContentType,e!=u.TEXT){S.jumpTo(2);break}if(!A.sequenceMode_){S.jumpTo(3);break}return S.yield(A.textSequenceModeOffset_,4);case 4:c=S.yieldResult,A.textEngine_.setTimestampOffset(c);case 3:return S.yield(A.textEngine_.appendBuffer(t,r?r.startTime:null,r?r.endTime:null,r?r.getUris()[0]:null),5);case 5:return S.return();case 2:if(l||!A.needSplitMuxedContent_){S.jumpTo(6);break}return S.yield(A.appendBuffer(u.AUDIO,t,r,n,a,i,o,s,!0),7);case 7:return S.yield(A.appendBuffer(u.VIDEO,t,r,n,a,i,o,s,!0),8);case 8:return S.return();case 6:if(!A.sourceBuffers_[e])return shaka.log.warning("Attempted to restore a non-existent source buffer"),S.return();if(d=A.sourceBuffers_[e].timestampOffset,p=A.sourceBufferTypes_[e],A.transmuxers_[e]&&(p=A.transmuxers_[e].getOriginalMimeType()),r&&(null!=(h=A.getTimestampAndDispatchMetadata_(e,t,r,p,d))&&(f=r.startTime-h,(.001<=Math.abs(d-f)||i||o)&&(!s||0<f||!d)&&(d=f,A.attemptTimestampOffsetCalculation_&&(A.enqueueOperation_(e,(function(){return A.abort_(e)})),A.enqueueOperation_(e,(function(){return A.setTimestampOffset_(e,d)})))),m=e==u.VIDEO||!(u.VIDEO in A.sourceBuffers_),A.sequenceMode_&&m&&A.textSequenceModeOffset_.resolve(d))),a&&e==u.VIDEO&&(A.textEngine_||A.reinitText(shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE,A.sequenceMode_,!1),A.captionParser_||(g=p.split(";",1)[0],A.captionParser_=A.getCaptionParser(g)),r?(y=A.captionParser_.parseFrom(t)).length&&A.textEngine_.storeAndAppendClosedCaptions(y,r.startTime,r.endTime,d):A.captionParser_.init(t,o)),!A.transmuxers_[e]){S.jumpTo(9);break}return S.yield(A.transmuxers_[e].transmux(t,n,r,A.mediaSource_.duration,e),10);case 10:t=S.yieldResult;case 9:return t=A.workAroundBrokenPlatforms_(t,r?r.startTime:null,e),r&&A.sequenceMode_&&e!=u.TEXT&&(i||o)&&(v=r.startTime,A.enqueueOperation_(e,(function(){return A.abort_(e)})),A.enqueueOperation_(e,(function(){return A.setTimestampOffset_(e,v)}))),_=null,S.yield(A.enqueueOperation_(e,(function(){goog.DEBUG&&r&&!r.isPreload()&&!s&&(_=A.getBuffered_(e)),A.append_(e,t,d)})),11);case 11:goog.DEBUG&&r&&!r.isPreload()&&!s&&(k=A.getBuffered_(e),E=shaka.media.TimeRangesUtils.computeAddedRange(_,k))&&(b=r.endTime-r.startTime,T=Math.abs(E.end-r.endTime),.1<b&&T>b/2&&shaka.log.error("Possible encoding problem detected!","Unexpected buffered range for reference",r,"from URIs",r.getUris(),"should be",{start:r.startTime,end:r.endTime},"but got",E)),S.jumpToEnd()}}))},shaka.media.MediaSourceEngine.prototype.setSelectedClosedCaptionId=function(e){var t=this.bufferEnd(shaka.util.ManifestParserUtils.ContentType.VIDEO)||0;this.textEngine_.setSelectedClosedCaptionId(e,t)},shaka.media.MediaSourceEngine.prototype.clearSelectedClosedCaptionId=function(){this.textEngine_&&this.textEngine_.setSelectedClosedCaptionId("",0)},shaka.media.MediaSourceEngine.prototype.remove=function(e,t,r){var n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(n=shaka.util.ManifestParserUtils.ContentType,e==n.TEXT?i.yield(a.textEngine_.remove(t,r),0):i.yield(a.enqueueOperation_(e,(function(){return a.remove_(e,t,r)})),4)):a.needSplitMuxedContent_?i.yield(a.enqueueOperation_(n.AUDIO,(function(){return a.remove_(n.AUDIO,t,r)})),0):i.jumpTo(0)}))},shaka.media.MediaSourceEngine.prototype.clear=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(t=shaka.util.ManifestParserUtils.ContentType,e==t.TEXT?r.textEngine_?n.yield(r.textEngine_.remove(0,1/0),0):n.return():n.yield(r.enqueueOperation_(e,(function(){return r.remove_(e,0,r.mediaSource_.duration)})),4)):r.needSplitMuxedContent_?n.yield(r.enqueueOperation_(t.AUDIO,(function(){return r.remove_(t.AUDIO,0,r.mediaSource_.duration)})),0):n.jumpTo(0)}))},shaka.media.MediaSourceEngine.prototype.resetCaptionParser=function(){this.captionParser_&&this.captionParser_.reset()},shaka.media.MediaSourceEngine.prototype.flush=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(t=shaka.util.ManifestParserUtils.ContentType,e==t.TEXT?n.return():n.yield(r.enqueueOperation_(e,(function(){return r.flush_(e)})),2)):r.needSplitMuxedContent_?n.yield(r.enqueueOperation_(t.AUDIO,(function(){return r.flush_(t.AUDIO)})),0):n.jumpTo(0)}))},shaka.media.MediaSourceEngine.prototype.setStreamProperties=function(e,t,r,n,a,i,o,s){var l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){return 1==d.nextAddress?(l=shaka.util.ManifestParserUtils.ContentType,e==l.TEXT?(a||c.textEngine_.setTimestampOffset(t),c.textEngine_.setAppendWindow(r,n),d.return()):(u=[],d.yield(c.codecSwitchIfNecessary_(e,i,o,s),2))):(d.yieldResult||(u.push(c.enqueueOperation_(e,(function(){return c.abort_(e)}))),c.needSplitMuxedContent_&&u.push(c.enqueueOperation_(l.AUDIO,(function(){return c.abort_(l.AUDIO)})))),a||(u.push(c.enqueueOperation_(e,(function(){return c.setTimestampOffset_(e,t)}))),c.needSplitMuxedContent_&&u.push(c.enqueueOperation_(l.AUDIO,(function(){return c.setTimestampOffset_(l.AUDIO,t)})))),u.push(c.enqueueOperation_(e,(function(){return c.setAppendWindow_(e,r,n)}))),c.needSplitMuxedContent_&&u.push(c.enqueueOperation_(l.AUDIO,(function(){return c.setAppendWindow_(l.AUDIO,r,n)}))),d.yield(Promise.all(u),0))}))},shaka.media.MediaSourceEngine.prototype.resync=function(e,t){var r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(r=shaka.util.ManifestParserUtils.ContentType,e==r.TEXT?a.return():(e==r.VIDEO&&(n.textSequenceModeOffset_=new shaka.util.PublicPromise),n.enqueueOperation_(e,(function(){return n.abort_(e)})),n.needSplitMuxedContent_&&n.enqueueOperation_(r.AUDIO,(function(){return n.abort_(r.AUDIO)})),a.yield(n.enqueueOperation_(e,(function(){return n.setTimestampOffset_(e,t)})),2))):n.needSplitMuxedContent_?a.yield(n.enqueueOperation_(r.AUDIO,(function(){return n.setTimestampOffset_(r.AUDIO,t)})),0):a.jumpTo(0)}))},shaka.media.MediaSourceEngine.prototype.endOfStream=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return r.yield(t.enqueueBlockingOperation_((function(){t.ended()||"closed"===t.mediaSource_.readyState||(e?t.mediaSource_.endOfStream(e):t.mediaSource_.endOfStream())})),0)}))},shaka.media.MediaSourceEngine.prototype.setDuration=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return r.yield(t.enqueueBlockingOperation_((function(){if(e<t.mediaSource_.duration)for(var r in t.sourceBuffers_){var n={start:function(){},p:new shaka.util.PublicPromise};t.queues_[r].unshift(n)}t.mediaSource_.duration=e,t.lastDuration_=e})),0)}))},shaka.media.MediaSourceEngine.prototype.getDuration=function(){return this.mediaSource_.duration},shaka.media.MediaSourceEngine.prototype.append_=function(e,t,r){e==shaka.util.ManifestParserUtils.ContentType.VIDEO&&this.lcevcDec_&&this.lcevcDec_.appendBuffer(t,r),this.sourceBuffers_[e].appendBuffer(t)},shaka.media.MediaSourceEngine.prototype.remove_=function(e,t,r){r<=t?this.onUpdateEnd_(e):this.sourceBuffers_[e].remove(t,r)},shaka.media.MediaSourceEngine.prototype.abort_=function(e){var t=this.sourceBuffers_[e].appendWindowStart,r=this.sourceBuffers_[e].appendWindowEnd;this.sourceBuffers_[e].abort(),this.sourceBuffers_[e].appendWindowStart=t,this.sourceBuffers_[e].appendWindowEnd=r,this.onUpdateEnd_(e)},shaka.media.MediaSourceEngine.prototype.flush_=function(e){goog.asserts.assert(0==this.video_.buffered.length,"MediaSourceEngine.flush_ should only be used after clearing all data!"),this.video_.currentTime-=.001,this.onUpdateEnd_(e)},shaka.media.MediaSourceEngine.prototype.setTimestampOffset_=function(e,t){0>t&&(t+=.001),this.sourceBuffers_[e].timestampOffset=t,this.onUpdateEnd_(e)},shaka.media.MediaSourceEngine.prototype.setAppendWindow_=function(e,t,r){this.sourceBuffers_[e].appendWindowStart=0,this.sourceBuffers_[e].appendWindowEnd=r,this.sourceBuffers_[e].appendWindowStart=t,this.onUpdateEnd_(e)},shaka.media.MediaSourceEngine.prototype.onError_=function(e){var t=this.queues_[e][0];goog.asserts.assert(t,"Spurious error event!"),goog.asserts.assert(!this.sourceBuffers_[e].updating,"SourceBuffer should not be updating on error!"),t.p.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_FAILED,this.video_.error?this.video_.error.code:0))},shaka.media.MediaSourceEngine.prototype.onUpdateEnd_=function(e){if(!this.reloadingMediaSource_){var t=this.queues_[e][0];goog.asserts.assert(t,"Spurious updateend event!"),t&&(goog.asserts.assert(!this.sourceBuffers_[e].updating,"SourceBuffer should not be updating on updateend!"),t.p.resolve(),this.popFromQueue_(e))}},shaka.media.MediaSourceEngine.prototype.enqueueOperation_=function(e,t){return this.destroyer_.ensureNotDestroyed(),t={start:t,p:new shaka.util.PublicPromise},this.queues_[e].push(t),1==this.queues_[e].length&&this.startOperation_(e),t.p},shaka.media.MediaSourceEngine.prototype.enqueueBlockingOperation_=function(e){var t,r,n,a,i,o,s,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){switch(d.nextAddress){case 1:for(n in c.destroyer_.ensureNotDestroyed(),t=[],r={},c.sourceBuffers_)r.$jscomp$loop$prop$ready$876=new shaka.util.PublicPromise,a={start:function(e){return function(){return e.$jscomp$loop$prop$ready$876.resolve()}}(r),p:r.$jscomp$loop$prop$ready$876},c.queues_[n].push(a),t.push(r.$jscomp$loop$prop$ready$876),1==c.queues_[n].length&&a.start(),r={$jscomp$loop$prop$ready$876:r.$jscomp$loop$prop$ready$876};return d.setCatchFinallyBlocks(2),d.yield(Promise.all(t),4);case 4:d.leaveTryBlock(3);break;case 2:if(i=d.enterCatchBlock(),goog.asserts.assert(c.destroyer_.destroyed(),"Should be destroyed by now"),goog.DEBUG)for(o in c.sourceBuffers_)c.queues_[o].length&&(goog.asserts.assert(1==c.queues_[o].length,"Should be at most one item in queue!"),goog.asserts.assert(t.includes(c.queues_[o][0].p),"The item in queue should be one of our waiters!"),c.queues_[o].shift());throw i;case 3:if(goog.DEBUG)for(s in c.sourceBuffers_)goog.asserts.assert(0==c.sourceBuffers_[s].updating,"SourceBuffers should not be updating after a blocking op!");return d.setCatchFinallyBlocks(5,6),d.yield(e(),6);case 6:for(l in d.enterFinallyBlock(),c.sourceBuffers_)c.popFromQueue_(l);d.leaveFinallyBlock(0);break;case 5:throw u=d.enterCatchBlock(),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW,u,c.video_.error||"No error in the media element")}}))},shaka.media.MediaSourceEngine.prototype.popFromQueue_=function(e){this.queues_[e].shift(),this.startOperation_(e)},shaka.media.MediaSourceEngine.prototype.startOperation_=function(e){var t=this.queues_[e][0];if(t)try{t.start()}catch(r){"QuotaExceededError"==r.name?t.p.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.QUOTA_EXCEEDED_ERROR,e)):t.p.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW,r,this.video_.error||"No error in the media element")),this.popFromQueue_(e)}},shaka.media.MediaSourceEngine.prototype.getTextDisplayer=function(){return goog.asserts.assert(this.textDisplayer_,"TextDisplayer should only be null when this is destroyed"),this.textDisplayer_},shaka.media.MediaSourceEngine.prototype.setTextDisplayer=function(e){var t=this.textDisplayer_;this.textDisplayer_=e,t&&(e.setTextVisibility(t.isTextVisible()),t.destroy()),this.textEngine_&&this.textEngine_.setDisplayer(e)},shaka.media.MediaSourceEngine.prototype.setSegmentRelativeVttTiming=function(e){this.segmentRelativeVttTiming_=e},shaka.media.MediaSourceEngine.prototype.workAroundBrokenPlatforms_=function(e,t,r){var n=this.expectedEncryption_[r];return this.config_.insertFakeEncryptionInInit&&null==t&&n&&shaka.util.Platform.requiresEncryptionInfoInAllInitSegments()&&"mp4"==shaka.util.MimeUtils.getContainerType(this.sourceBufferTypes_[r])&&(shaka.log.debug("Forcing fake encryption information in init segment."),e=shaka.media.ContentWorkarounds.fakeEncryption(e)),e},shaka.media.MediaSourceEngine.prototype.change_=function(e,t,r){e===shaka.util.ManifestParserUtils.ContentType.TEXT?shaka.log.debug("Change not supported for "+e):(shaka.log.debug("Change Type: "+this.sourceBufferTypes_[e]+" -> "+t),shaka.media.Capabilities.isChangeTypeSupported()?(this.transmuxers_[e]&&(this.transmuxers_[e].destroy(),delete this.transmuxers_[e]),r&&(this.transmuxers_[e]=r),r=this.addExtraFeaturesToMimeType_(t),this.sourceBuffers_[e].changeType(r),this.sourceBufferTypes_[e]=t):shaka.log.debug("Change Type not supported"),this.onUpdateEnd_(e))},shaka.media.MediaSourceEngine.prototype.changeType=function(e,t,r){var n=this;return this.enqueueOperation_(e,(function(){return n.change_(e,t,r)}))},shaka.media.MediaSourceEngine.prototype.reset_=function(e){var t,r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(C){switch(C.nextAddress){case 1:for(s in t=shaka.util.Functional,r=shaka.util.ManifestParserUtils.ContentType,S.reloadingMediaSource_=!0,S.needSplitMuxedContent_=!1,n=S.video_.currentTime,a=S.video_.autoplay,i=S.video_.paused,S.playbackHasBegun_&&(S.video_.autoplay=!1),C.setFinallyBlock(2),S.eventManager_.removeAll(),o=[],S.transmuxers_)o.push(S.transmuxers_[s].destroy());for(l in S.queues_)for(u=S.queues_[l],c=u[0],S.queues_[l]=u.slice(0,1),c&&o.push(c.p.catch(t.noop)),d=$jscomp.makeIterator(u.slice(1)),p=d.next();!p.done;p=d.next())p.value.p.reject(shaka.util.Destroyer.destroyedError());for(h in S.sourceBuffers_){f=S.sourceBuffers_[h];try{S.mediaSource_.removeSourceBuffer(f)}catch(e){}}return C.yield(Promise.all(o),4);case 4:return S.transmuxers_={},S.sourceBuffers_={},m=S.mediaSource_.duration,S.mediaSourceOpen_=new shaka.util.PublicPromise,S.mediaSource_=S.createMediaSource(S.mediaSourceOpen_),C.yield(S.mediaSourceOpen_,5);case 5:!isNaN(m)&&m?S.mediaSource_.duration=m:!isNaN(S.lastDuration_)&&S.lastDuration_&&(S.mediaSource_.duration=S.lastDuration_),g=new shaka.util.PublicPromise,y=S.mediaSource_.sourceBuffers,v=e.size,_=0,k=function(){++_===v&&(g.resolve(),S.eventManager_.unlisten(y,"addsourcebuffer",k))},S.eventManager_.listen(y,"addsourcebuffer",k),E=$jscomp.makeIterator(e.keys()),b=E.next();case 6:return b.done?(S.video_.currentTime=n,C.yield(g,2)):(T=b.value,A=e.get(T),C.yield(S.initSourceBuffer_(T,A,A.codecs),9));case 9:S.needSplitMuxedContent_?(S.queues_[r.AUDIO]=[],S.queues_[r.VIDEO]=[]):S.queues_[T]=[],b=E.next(),C.jumpTo(6);break;case 2:C.enterFinallyBlock(),S.reloadingMediaSource_=!1,S.destroyer_.ensureNotDestroyed(),S.eventManager_.listenOnce(S.video_,"canplaythrough",(function(){S.destroyer_.destroyed()||(S.video_.autoplay=a,i||S.video_.play())})),C.leaveFinallyBlock(0)}}))},shaka.media.MediaSourceEngine.prototype.reset=function(e){var t=this;return this.enqueueBlockingOperation_((function(){return t.reset_(e)}))},shaka.media.MediaSourceEngine.prototype.codecSwitchIfNecessary_=function(e,t,r,n){var a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(b){return 1==b.nextAddress?(a=shaka.util.ManifestParserUtils.ContentType,e==a.TEXT?b.return(!1):(i=shaka.util.MimeUtils,o=i.getCodecBase(i.getCodecs(E.sourceBufferTypes_[e])),s=i.getBasicType(E.sourceBufferTypes_[e]),u=!1,c=shaka.util.MimeUtils.getFullType(t,r),d=E.config_.forceTransmux,(!shaka.media.Capabilities.isTypeSupported(c)||!E.sequenceMode_&&shaka.util.MimeUtils.RAW_FORMATS.includes(c))&&(d=!0),p=shaka.transmuxer.TransmuxerEngine,d&&(h=shaka.util.MimeUtils.getFullTypeWithAllCodecs(t,r),f=p.findTransmuxer(h))&&(l=f(),m=shaka.util.ManifestParserUtils.guessCodecsSafe(a.AUDIO,(r||"").split(",")),g=shaka.util.ManifestParserUtils.guessCodecsSafe(a.VIDEO,(r||"").split(",")),m&&g?(u=!0,y=g,e==a.AUDIO&&(y=m),c=l.convertCodecs(e,shaka.util.MimeUtils.getFullTypeWithAllCodecs(t,y))):c=l.convertCodecs(e,h)),v=i.getCodecBase(i.getCodecs(c)),_=i.getBasicType(c),o===v&&s===_?b.return(!1):(k=!0,(E.needSplitMuxedContent_||u&&l&&!E.transmuxers_[e])&&(k=!1),k&&E.config_.codecSwitchingStrategy===shaka.config.CodecSwitchingStrategy.SMOOTH&&shaka.media.Capabilities.isChangeTypeSupported()?b.yield(E.changeType(e,c,l),3):(l&&l.destroy(),b.yield(E.reset(n),3))))):b.return(!0)}))},shaka.media.MediaSourceEngine.prototype.isCodecSwitchNecessary_=function(e,t,r,n){if(e==shaka.util.ManifestParserUtils.ContentType.TEXT)return!1;var a=shaka.util.MimeUtils;t=a.getCodecBase(a.getCodecs(this.sourceBufferTypes_[e]));var i=a.getBasicType(this.sourceBufferTypes_[e]),o=shaka.util.MimeUtils.getFullType(r,n),s=this.config_.forceTransmux;return(!shaka.media.Capabilities.isTypeSupported(o)||!this.sequenceMode_&&shaka.util.MimeUtils.RAW_FORMATS.includes(o))&&(s=!0),r=shaka.util.MimeUtils.getFullTypeWithAllCodecs(r,n),n=shaka.transmuxer.TransmuxerEngine,s&&(s=n.findTransmuxer(r))&&(o=(s=s()).convertCodecs(e,r),s.destroy()),e=a.getCodecBase(a.getCodecs(o)),a=a.getBasicType(o),t!==e||i!==a},shaka.media.MediaSourceEngine.prototype.isResetMediaSourceNecessary=function(e,t,r,n){return!!this.isCodecSwitchNecessary_(e,t,r,n)&&(this.config_.codecSwitchingStrategy!==shaka.config.CodecSwitchingStrategy.SMOOTH||!shaka.media.Capabilities.isChangeTypeSupported()||this.needSplitMuxedContent_)},shaka.media.MediaSourceEngine.prototype.updateLcevcDec=function(e){this.lcevcDec_=e},shaka.media.MediaSourceEngine.prototype.addExtraFeaturesToMimeType_=function(e){return e+=this.config_.addExtraFeaturesToSourceBuffer(e),shaka.log.debug("Using full mime type",e),e},shaka.media.MediaSourceEngine.createObjectURL=window.URL.createObjectURL,shaka.media.MediaSourceEngine.SourceBufferMode_={SEQUENCE:"sequence",SEGMENTS:"segments"},shaka.media.PresentationTimeline=function(e,t,r){this.presentationStartTime_=e,this.presentationDelay_=t,this.segmentAvailabilityDuration_=this.duration_=1/0,this.maxSegmentDuration_=1,this.maxSegmentEndTime_=this.minSegmentStartTime_=null,this.clockOffset_=0,this.static_=!0,this.userSeekStart_=0,this.autoCorrectDrift_=void 0===r||r,this.availabilityTimeOffset_=0,this.startTimeLocked_=!1,this.initialProgramDateTime_=null},shaka.media.PresentationTimeline.prototype.getDuration=function(){return this.duration_},shaka.media.PresentationTimeline.prototype.getMaxSegmentDuration=function(){return this.maxSegmentDuration_},shaka.media.PresentationTimeline.prototype.setPresentationStartTime=function(e){goog.asserts.assert(0<=e,"presentationStartTime must be >= 0"),this.presentationStartTime_=e},shaka.media.PresentationTimeline.prototype.setDuration=function(e){goog.asserts.assert(0<e,"duration must be > 0"),this.duration_=e},shaka.media.PresentationTimeline.prototype.getPresentationStartTime=function(){return this.presentationStartTime_},shaka.media.PresentationTimeline.prototype.setClockOffset=function(e){this.clockOffset_=e},shaka.media.PresentationTimeline.prototype.setStatic=function(e){this.static_=e},shaka.media.PresentationTimeline.prototype.setSegmentAvailabilityDuration=function(e){goog.asserts.assert(0<=e,"segmentAvailabilityDuration must be >= 0"),this.segmentAvailabilityDuration_=e},shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityDuration=function(){return this.segmentAvailabilityDuration_},shaka.media.PresentationTimeline.prototype.setDelay=function(e){goog.asserts.assert(0<=e,"delay must be >= 0"),this.presentationDelay_=e},shaka.media.PresentationTimeline.prototype.getDelay=function(){return this.presentationDelay_},shaka.media.PresentationTimeline.prototype.notifyTimeRange=function(e,t){if(0!=e.length){var r=e[e.length-1].end+t;this.notifyMinSegmentStartTime(e[0].start+t),this.maxSegmentDuration_=e.reduce((function(e,t){return Math.max(e,t.end-t.start)}),this.maxSegmentDuration_),this.maxSegmentEndTime_=Math.max(this.maxSegmentEndTime_,r),null!=this.presentationStartTime_&&this.autoCorrectDrift_&&!this.startTimeLocked_&&(this.presentationStartTime_=(Date.now()+this.clockOffset_)/1e3-this.maxSegmentEndTime_-this.maxSegmentDuration_),shaka.log.v1("notifySegments:","maxSegmentDuration="+this.maxSegmentDuration_)}},shaka.media.PresentationTimeline.prototype.notifySegments=function(e){if(0!=e.length){for(var t=e[0].startTime,r=e[0].endTime,n=(Date.now()+this.clockOffset_)/1e3,a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())n<(a=a.value).startTime||(t=Math.min(t,a.startTime),r=Math.max(r,a.endTime),this.maxSegmentDuration_=Math.max(this.maxSegmentDuration_,a.endTime-a.startTime));this.notifyMinSegmentStartTime(t),this.maxSegmentEndTime_=Math.max(this.maxSegmentEndTime_,r),null!=this.presentationStartTime_&&this.autoCorrectDrift_&&!this.startTimeLocked_&&(this.presentationStartTime_=n-this.maxSegmentEndTime_-this.maxSegmentDuration_),shaka.log.v1("notifySegments:","maxSegmentDuration="+this.maxSegmentDuration_)}},shaka.media.PresentationTimeline.prototype.lockStartTime=function(){this.startTimeLocked_=!0},shaka.media.PresentationTimeline.prototype.isStartTimeLocked=function(){return this.startTimeLocked_},shaka.media.PresentationTimeline.prototype.setInitialProgramDateTime=function(e){this.initialProgramDateTime_=e},shaka.media.PresentationTimeline.prototype.getInitialProgramDateTime=function(){return this.initialProgramDateTime_},shaka.media.PresentationTimeline.prototype.notifyMinSegmentStartTime=function(e){this.minSegmentStartTime_=null==this.minSegmentStartTime_?e:Math.min(this.minSegmentStartTime_,e)},shaka.media.PresentationTimeline.prototype.notifyMaxSegmentDuration=function(e){this.maxSegmentDuration_=Math.max(this.maxSegmentDuration_,e),shaka.log.v1("notifyNewSegmentDuration:","maxSegmentDuration="+this.maxSegmentDuration_)},shaka.media.PresentationTimeline.prototype.offset=function(e){null!=this.minSegmentStartTime_&&(this.minSegmentStartTime_+=e),null!=this.maxSegmentEndTime_&&(this.maxSegmentEndTime_+=e)},shaka.media.PresentationTimeline.prototype.isLive=function(){return 1/0==this.duration_&&!this.static_},shaka.media.PresentationTimeline.prototype.isInProgress=function(){return 1/0!=this.duration_&&!this.static_},shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityStart=function(){goog.asserts.assert(0<=this.segmentAvailabilityDuration_,"The availability duration should be positive");var e=this.getSegmentAvailabilityEnd()-this.segmentAvailabilityDuration_;return Math.max(this.userSeekStart_,e)},shaka.media.PresentationTimeline.prototype.setUserSeekStart=function(e){this.userSeekStart_=e},shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityEnd=function(){return this.isLive()||this.isInProgress()?Math.min(this.getLiveEdge_()+this.availabilityTimeOffset_,this.duration_):this.maxSegmentEndTime_?Math.min(this.maxSegmentEndTime_,this.duration_):this.duration_},shaka.media.PresentationTimeline.prototype.getSafeSeekRangeStart=function(e){var t=Math.max(this.minSegmentStartTime_,this.userSeekStart_);if(1/0==this.segmentAvailabilityDuration_)return Math.ceil(1e3*t)/1e3;var r=this.getSegmentAvailabilityEnd()-this.segmentAvailabilityDuration_;return e=Math.min(r+e,this.getSeekRangeEnd()),Math.max(t,e)},shaka.media.PresentationTimeline.prototype.getSeekRangeStart=function(){return this.getSafeSeekRangeStart(0)},shaka.media.PresentationTimeline.prototype.getSeekRangeEnd=function(){var e=this.isLive()||this.isInProgress()?this.presentationDelay_:0;return Math.max(0,this.getSegmentAvailabilityEnd()-e)},shaka.media.PresentationTimeline.prototype.usingPresentationStartTime=function(){return!(null==this.presentationStartTime_||null!=this.maxSegmentEndTime_&&this.autoCorrectDrift_)},shaka.media.PresentationTimeline.prototype.getLiveEdge_=function(){goog.asserts.assert(null!=this.presentationStartTime_,"Cannot compute timeline live edge without start time");var e=(Date.now()+this.clockOffset_)/1e3;return Math.max(0,e-this.maxSegmentDuration_-this.presentationStartTime_)},shaka.media.PresentationTimeline.prototype.setAvailabilityTimeOffset=function(e){this.availabilityTimeOffset_=e},shaka.media.PresentationTimeline.prototype.assertIsValid=function(){goog.DEBUG&&(this.isLive()?goog.asserts.assert(null!=this.presentationStartTime_,"Detected as live stream, but does not match our model of live!"):this.isInProgress()?goog.asserts.assert(null!=this.presentationStartTime_&&1/0==this.segmentAvailabilityDuration_,"Detected as IPR stream, but does not match our model of IPR!"):goog.asserts.assert(1/0==this.segmentAvailabilityDuration_&&1/0!=this.duration_&&this.static_,"Detected as VOD stream, but does not match our model of VOD!"))},goog.exportSymbol("shaka.media.PresentationTimeline",shaka.media.PresentationTimeline),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setAvailabilityTimeOffset",shaka.media.PresentationTimeline.prototype.setAvailabilityTimeOffset),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"usingPresentationStartTime",shaka.media.PresentationTimeline.prototype.usingPresentationStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSeekRangeEnd",shaka.media.PresentationTimeline.prototype.getSeekRangeEnd),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSeekRangeStart",shaka.media.PresentationTimeline.prototype.getSeekRangeStart),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSafeSeekRangeStart",shaka.media.PresentationTimeline.prototype.getSafeSeekRangeStart),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSegmentAvailabilityEnd",shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityEnd),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setUserSeekStart",shaka.media.PresentationTimeline.prototype.setUserSeekStart),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSegmentAvailabilityStart",shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityStart),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"isInProgress",shaka.media.PresentationTimeline.prototype.isInProgress),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"isLive",shaka.media.PresentationTimeline.prototype.isLive),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"offset",shaka.media.PresentationTimeline.prototype.offset),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"notifyMaxSegmentDuration",shaka.media.PresentationTimeline.prototype.notifyMaxSegmentDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"notifyMinSegmentStartTime",shaka.media.PresentationTimeline.prototype.notifyMinSegmentStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getInitialProgramDateTime",shaka.media.PresentationTimeline.prototype.getInitialProgramDateTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setInitialProgramDateTime",shaka.media.PresentationTimeline.prototype.setInitialProgramDateTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"isStartTimeLocked",shaka.media.PresentationTimeline.prototype.isStartTimeLocked),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"lockStartTime",shaka.media.PresentationTimeline.prototype.lockStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"notifySegments",shaka.media.PresentationTimeline.prototype.notifySegments),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"notifyTimeRange",shaka.media.PresentationTimeline.prototype.notifyTimeRange),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getDelay",shaka.media.PresentationTimeline.prototype.getDelay),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setDelay",shaka.media.PresentationTimeline.prototype.setDelay),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getSegmentAvailabilityDuration",shaka.media.PresentationTimeline.prototype.getSegmentAvailabilityDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setSegmentAvailabilityDuration",shaka.media.PresentationTimeline.prototype.setSegmentAvailabilityDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setStatic",shaka.media.PresentationTimeline.prototype.setStatic),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setClockOffset",shaka.media.PresentationTimeline.prototype.setClockOffset),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getPresentationStartTime",shaka.media.PresentationTimeline.prototype.getPresentationStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setDuration",shaka.media.PresentationTimeline.prototype.setDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"setPresentationStartTime",shaka.media.PresentationTimeline.prototype.setPresentationStartTime),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getMaxSegmentDuration",shaka.media.PresentationTimeline.prototype.getMaxSegmentDuration),goog.exportProperty(shaka.media.PresentationTimeline.prototype,"getDuration",shaka.media.PresentationTimeline.prototype.getDuration),shaka.media.StallDetector=function(e,t,r){this.onEvent_=r,this.implementation_=e,this.wasMakingProgress_=e.shouldBeMakingProgress(),this.value_=e.getPresentationSeconds(),this.lastUpdateSeconds_=e.getWallSeconds(),this.didJump_=!1,this.stallsDetected_=0,this.stallThresholdSeconds_=t,this.onStall_=function(){}},shaka.media.StallDetector.prototype.release=function(){this.onEvent_=this.implementation_=null,this.onStall_=function(){}},shaka.media.StallDetector.prototype.onStall=function(e){this.onStall_=e},shaka.media.StallDetector.prototype.getStallsDetected=function(){return this.stallsDetected_},shaka.media.StallDetector.prototype.poll=function(){var e=this.implementation_,t=e.shouldBeMakingProgress(),r=e.getPresentationSeconds(),n=e.getWallSeconds();return this.value_==r&&this.wasMakingProgress_==t||(this.lastUpdateSeconds_=n,this.value_=r,this.wasMakingProgress_=t,this.didJump_=!1),(t=(r=n-this.lastUpdateSeconds_)>=this.stallThresholdSeconds_&&t&&!this.didJump_)&&(this.onStall_(this.value_,r),this.didJump_=!0,this.value_=e.getPresentationSeconds(),this.stallsDetected_++,this.onEvent_(new shaka.util.FakeEvent(shaka.util.FakeEvent.EventName.StallDetected))),t},shaka.media.StallDetector.Implementation=function(){},shaka.media.StallDetector.Implementation.prototype.shouldBeMakingProgress=function(){},shaka.media.StallDetector.Implementation.prototype.getPresentationSeconds=function(){},shaka.media.StallDetector.Implementation.prototype.getWallSeconds=function(){},shaka.media.StallDetector.MediaElementImplementation=function(e){this.mediaElement_=e},shaka.media.StallDetector.MediaElementImplementation.prototype.shouldBeMakingProgress=function(){return!this.mediaElement_.paused&&0!=this.mediaElement_.playbackRate&&0!=this.mediaElement_.buffered.length&&shaka.media.StallDetector.MediaElementImplementation.hasContentFor_(this.mediaElement_.buffered,this.mediaElement_.currentTime)},shaka.media.StallDetector.MediaElementImplementation.prototype.getPresentationSeconds=function(){return this.mediaElement_.currentTime},shaka.media.StallDetector.MediaElementImplementation.prototype.getWallSeconds=function(){return Date.now()/1e3},shaka.media.StallDetector.MediaElementImplementation.hasContentFor_=function(e,t){for(var r=(e=$jscomp.makeIterator(shaka.media.TimeRangesUtils.getBufferedInfo(e))).next();!r.done;r=e.next())if(!(t<(r=r.value).start-.1||t>r.end-.5))return!0;return!1},shaka.media.GapJumpingController=function(e,t,r,n,a){var i=this;this.onEvent_=a,this.video_=e,this.timeline_=t,this.config_=r,this.eventManager_=new shaka.util.EventManager,this.seekingEventReceived_=!1,this.prevReadyState_=e.readyState,this.gapsJumped_=this.startTime_=0,this.stallDetector_=n,this.hadSegmentAppended_=!1,this.eventManager_.listen(e,"waiting",(function(){return i.onPollGapJump_()})),this.gapJumpTimer_=new shaka.util.Timer((function(){i.onPollGapJump_()})).tickEvery(this.config_.gapJumpTimerTime)},shaka.media.GapJumpingController.prototype.release=function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),null!=this.gapJumpTimer_&&(this.gapJumpTimer_.stop(),this.gapJumpTimer_=null),this.stallDetector_&&(this.stallDetector_.release(),this.stallDetector_=null),this.video_=this.timeline_=this.onEvent_=null},shaka.media.GapJumpingController.prototype.onSegmentAppended=function(){this.hadSegmentAppended_=!0,this.onPollGapJump_()},shaka.media.GapJumpingController.prototype.onStarted=function(e){this.video_.seeking&&!this.seekingEventReceived_&&(this.seekingEventReceived_=!0,this.startTime_=e)},shaka.media.GapJumpingController.prototype.onSeeking=function(){this.seekingEventReceived_=!0,this.hadSegmentAppended_=!1},shaka.media.GapJumpingController.prototype.getGapsJumped=function(){return this.gapsJumped_},shaka.media.GapJumpingController.prototype.onPollGapJump_=function(){if(0!=this.video_.readyState){if(this.video_.seeking){if(!this.seekingEventReceived_)return}else this.seekingEventReceived_=!1;if((!this.video_.paused||this.video_.currentTime==this.startTime_&&(this.video_.autoplay||this.video_.currentTime!=this.startTime_))&&(this.video_.readyState!=this.prevReadyState_&&(this.prevReadyState_=this.video_.readyState),!this.stallDetector_||!this.stallDetector_.poll())){var e=this.video_.currentTime,t=this.video_.buffered,r=shaka.media.TimeRangesUtils.getGapIndex(t,e,this.config_.gapDetectionThreshold);if(null!=r&&(0!=r||this.hadSegmentAppended_)){var n=t.start(r);(shaka.util.Platform.isLegacyEdge()||shaka.util.Platform.isXboxOne())&&(n=Math.ceil(100*(n+.01))/100);var a=this.timeline_.getSeekRangeEnd();n>=a||((a=n-e)<shaka.media.GapJumpingController.BROWSER_GAP_TOLERANCE||(0==r?shaka.log.info("Jumping forward",a,"seconds because of gap before start time of",n):shaka.log.info("Jumping forward",a,"seconds because of gap starting at",t.end(r-1),"and ending at",n),this.video_.currentTime=n,e==this.startTime_&&(this.startTime_=n),this.gapsJumped_++,this.onEvent_(new shaka.util.FakeEvent(shaka.util.FakeEvent.EventName.GapJumped))))}}}},shaka.media.GapJumpingController.BROWSER_GAP_TOLERANCE=.001,shaka.util.MediaReadyState=function(){},shaka.util.MediaReadyState.waitForReadyState=function(e,t,r,n){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?n():(t=shaka.util.MediaReadyState.READY_STATES_TO_EVENT_NAMES_.value().get(t),r.listenOnce(e,t,n))},shaka.util.MediaReadyState.READY_STATES_TO_EVENT_NAMES_=new shaka.util.Lazy((function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])})),shaka.media.VideoWrapper=function(e,t,r,n){var a=this;this.video_=e,this.onSeek_=t,this.onStarted_=r,this.startTime_=null,this.getStartTime_=function(){return null==a.startTime_&&(a.startTime_=n()),a.startTime_},this.started_=!1,this.eventManager_=new shaka.util.EventManager,this.mover_=new shaka.media.VideoWrapper.PlayheadMover(e,10),shaka.util.MediaReadyState.waitForReadyState(this.video_,HTMLMediaElement.HAVE_METADATA,this.eventManager_,(function(){a.setStartTime_(a.getStartTime_())}))},shaka.media.VideoWrapper.prototype.release=function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),null!=this.mover_&&(this.mover_.release(),this.mover_=null),this.onSeek_=function(){},this.video_=null},shaka.media.VideoWrapper.prototype.getTime=function(){return this.started_?this.video_.currentTime:this.getStartTime_()},shaka.media.VideoWrapper.prototype.setTime=function(e){var t=this;0<this.video_.readyState?this.mover_.moveTo(e):shaka.util.MediaReadyState.waitForReadyState(this.video_,HTMLMediaElement.HAVE_METADATA,this.eventManager_,(function(){t.setStartTime_(t.getStartTime_())}))},shaka.media.VideoWrapper.prototype.setStartTime_=function(e){var t=this;.001>Math.abs(this.video_.currentTime-e)?this.startListeningToSeeks_():(this.eventManager_.listenOnce(this.video_,"seeking",(function(){t.startListeningToSeeks_()})),this.mover_.moveTo(this.video_.currentTime&&0!=this.video_.currentTime?this.video_.currentTime:e))},shaka.media.VideoWrapper.prototype.startListeningToSeeks_=function(){var e=this;goog.asserts.assert(0<this.video_.readyState,"The media element should be ready before we listen for seeking."),this.started_=!0,this.eventManager_.listen(this.video_,"seeking",(function(){return e.onSeek_()})),this.onStarted_(this.video_.currentTime)},shaka.media.VideoWrapper.PlayheadMover=function(e,t){var r=this;this.mediaElement_=e,this.maxAttempts_=t,this.targetTime_=this.originTime_=this.remainingAttempts_=0,this.timer_=new shaka.util.Timer((function(){return r.onTick_()}))},shaka.media.VideoWrapper.PlayheadMover.prototype.release=function(){this.timer_&&(this.timer_.stop(),this.timer_=null),this.mediaElement_=null},shaka.media.VideoWrapper.PlayheadMover.prototype.moveTo=function(e){this.originTime_=this.mediaElement_.currentTime,this.targetTime_=e,this.remainingAttempts_=this.maxAttempts_,this.mediaElement_.currentTime=e,this.timer_.tickEvery(.1)},shaka.media.VideoWrapper.PlayheadMover.prototype.onTick_=function(){0>=this.remainingAttempts_?(shaka.log.warning(["Failed to move playhead from",this.originTime_,"to",this.targetTime_].join(" ")),this.timer_.stop()):this.mediaElement_.currentTime!=this.originTime_?this.timer_.stop():(this.mediaElement_.currentTime=this.targetTime_,this.remainingAttempts_--)},shaka.media.Playhead=function(){},shaka.media.Playhead.prototype.ready=function(){},shaka.media.Playhead.prototype.setStartTime=function(e){},shaka.media.Playhead.prototype.getStallsDetected=function(){},shaka.media.Playhead.prototype.getGapsJumped=function(){},shaka.media.Playhead.prototype.getTime=function(){},shaka.media.Playhead.prototype.notifyOfBufferingChange=function(){},shaka.media.SrcEqualsPlayhead=function(e){this.mediaElement_=e,this.started_=!1,this.startTime_=null,this.eventManager_=new shaka.util.EventManager},shaka.media.SrcEqualsPlayhead.prototype.ready=function(){var e=this;goog.asserts.assert(null!=this.mediaElement_,"Playhead should not be released before calling ready()");shaka.util.MediaReadyState.waitForReadyState(this.mediaElement_,HTMLMediaElement.HAVE_CURRENT_DATA,this.eventManager_,(function(){null==e.startTime_||0==e.startTime_?e.started_=!0:(e.eventManager_.listenOnce(e.mediaElement_,"seeking",(function(){e.started_=!0})),e.mediaElement_.currentTime=Math.max(0,e.mediaElement_.currentTime+e.startTime_))}))},shaka.media.SrcEqualsPlayhead.prototype.release=function(){this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.mediaElement_=null},shaka.media.SrcEqualsPlayhead.prototype.setStartTime=function(e){this.startTime_=this.started_?this.startTime_:e},shaka.media.SrcEqualsPlayhead.prototype.getTime=function(){return(this.started_?this.mediaElement_.currentTime:this.startTime_)||0},shaka.media.SrcEqualsPlayhead.prototype.getStallsDetected=function(){return 0},shaka.media.SrcEqualsPlayhead.prototype.getGapsJumped=function(){return 0},shaka.media.SrcEqualsPlayhead.prototype.notifyOfBufferingChange=function(){},shaka.media.MediaSourcePlayhead=function(e,t,r,n,a,i){var o=this;this.minSeekRange_=3,this.mediaElement_=e,this.timeline_=t.presentationTimeline,this.minBufferTime_=t.minBufferTime||0,this.config_=r,this.onSeek_=a,this.lastCorrectiveSeek_=null,this.stallDetector_=this.createStallDetector_(e,r,i),this.gapController_=new shaka.media.GapJumpingController(e,t.presentationTimeline,r,this.stallDetector_,i),this.videoWrapper_=new shaka.media.VideoWrapper(e,(function(){return o.onSeeking_()}),(function(e){return o.onStarted_(e)}),(function(){return o.getStartTime_(n)})),this.checkWindowTimer_=new shaka.util.Timer((function(){o.onPollWindow_()}))},shaka.media.MediaSourcePlayhead.prototype.ready=function(){this.checkWindowTimer_.tickEvery(.25)},shaka.media.MediaSourcePlayhead.prototype.release=function(){this.videoWrapper_&&(this.videoWrapper_.release(),this.videoWrapper_=null),this.gapController_&&(this.gapController_.release(),this.gapController_=null),this.checkWindowTimer_&&(this.checkWindowTimer_.stop(),this.checkWindowTimer_=null),this.mediaElement_=this.videoWrapper_=this.timeline_=this.config_=null,this.onSeek_=function(){}},shaka.media.MediaSourcePlayhead.prototype.setStartTime=function(e){this.videoWrapper_.setTime(e)},shaka.media.MediaSourcePlayhead.prototype.getTime=function(){var e=this.videoWrapper_.getTime();return 0<this.mediaElement_.readyState&&!this.mediaElement_.paused?this.clampTime_(e):e},shaka.media.MediaSourcePlayhead.prototype.getStallsDetected=function(){return this.stallDetector_?this.stallDetector_.getStallsDetected():0},shaka.media.MediaSourcePlayhead.prototype.getGapsJumped=function(){return this.gapController_.getGapsJumped()},shaka.media.MediaSourcePlayhead.prototype.getStartTime_=function(e){return null==e?e=1/0>this.timeline_.getDuration()?this.timeline_.getSeekRangeStart():this.timeline_.getSeekRangeEnd():0>e&&(e=this.timeline_.getSeekRangeEnd()+e),this.clampSeekToDuration_(this.clampTime_(e))},shaka.media.MediaSourcePlayhead.prototype.notifyOfBufferingChange=function(){this.gapController_.onSegmentAppended()},shaka.media.MediaSourcePlayhead.prototype.onPollWindow_=function(){if(0!=this.mediaElement_.readyState&&!this.mediaElement_.paused){var e=this.videoWrapper_.getTime(),t=this.timeline_.getSeekRangeStart(),r=this.timeline_.getSeekRangeEnd();r-t<this.minSeekRange_&&(t=r-this.minSeekRange_),e<t&&(t=this.reposition_(e),shaka.log.info("Jumping forward "+(t-e)+" seconds to catch up with the seek range."),this.mediaElement_.currentTime=t)}},shaka.media.MediaSourcePlayhead.prototype.onStarted_=function(e){this.gapController_.onStarted(e)},shaka.media.MediaSourcePlayhead.prototype.onSeeking_=function(){this.gapController_.onSeeking();var e=this.videoWrapper_.getTime(),t=this.reposition_(e);if(Math.abs(t-e)>shaka.media.GapJumpingController.BROWSER_GAP_TOLERANCE){var r=Date.now()/1e3;if(!this.lastCorrectiveSeek_||this.lastCorrectiveSeek_<r-1)return this.lastCorrectiveSeek_=r,void this.videoWrapper_.setTime(t)}shaka.log.v1("Seek to "+e),this.onSeek_()},shaka.media.MediaSourcePlayhead.prototype.clampSeekToDuration_=function(e){var t=this.timeline_.getDuration();return e>=t?(goog.asserts.assert(0<=this.config_.durationBackoff,"Duration backoff must be non-negative!"),t-this.config_.durationBackoff):e},shaka.media.MediaSourcePlayhead.prototype.reposition_=function(e){goog.asserts.assert(this.config_,"Cannot reposition playhead when it has beeen destroyed");var t=Math.max(this.minBufferTime_,this.config_.rebufferingGoal),r=this.config_.safeSeekOffset,n=this.timeline_.getSeekRangeStart(),a=this.timeline_.getSeekRangeEnd(),i=this.timeline_.getDuration();a-n<this.minSeekRange_&&(n=a-this.minSeekRange_);var o=this.timeline_.getSafeSeekRangeStart(t),s=this.timeline_.getSafeSeekRangeStart(r);return t=this.timeline_.getSafeSeekRangeStart(t+r),e>=i?(shaka.log.v1("Playhead past duration."),this.clampSeekToDuration_(e)):e>a?(shaka.log.v1("Playhead past end."),a):e<n?shaka.media.TimeRangesUtils.isBuffered(this.mediaElement_.buffered,s)?(shaka.log.v1("Playhead before start & start is buffered"),s):(shaka.log.v1("Playhead before start & start is unbuffered"),t):e>=o||shaka.media.TimeRangesUtils.isBuffered(this.mediaElement_.buffered,e)?(shaka.log.v1("Playhead in safe region or in buffered region."),e):(shaka.log.v1("Playhead outside safe region & in unbuffered region."),t)},shaka.media.MediaSourcePlayhead.prototype.clampTime_=function(e){var t=this.timeline_.getSeekRangeStart();return e<t||e>(t=this.timeline_.getSeekRangeEnd())?t:e},shaka.media.MediaSourcePlayhead.prototype.createStallDetector_=function(e,t,r){if(!t.stallEnabled)return null;var n=t.stallThreshold,a=t.stallSkip;return(t=new shaka.media.StallDetector(new shaka.media.StallDetector.MediaElementImplementation(e),n,r)).onStall((function(t,r){shaka.log.debug("Stall detected at "+t+" for "+r+" seconds."),a?(shaka.log.debug("Seeking forward "+a+" seconds to break stall."),e.currentTime+=a):(shaka.log.debug("Pausing and unpausing to break stall."),e.pause(),e.play())})),t},shaka.media.SegmentIndex=function(e){goog.DEBUG&&shaka.media.SegmentIndex.assertCorrectReferences_(e),this.references=e,this.timer_=null,this.numEvicted_=0,this.immutable_=!1},shaka.media.SegmentIndex.prototype.getIsImmutable=function(){return this.immutable_},shaka.media.SegmentIndex.prototype.getNumReferences=function(){return this.references.length},shaka.media.SegmentIndex.prototype.getNumEvicted=function(){return this.numEvicted_},shaka.media.SegmentIndex.prototype.release=function(){this.immutable_||(this.references=[],this.timer_&&this.timer_.stop(),this.timer_=null)},shaka.media.SegmentIndex.prototype.markImmutable=function(){this.immutable_=!0},shaka.media.SegmentIndex.prototype.forEachTopLevelReference=function(e){for(var t=$jscomp.makeIterator(this.references),r=t.next();!r.done;r=t.next())e(r.value)},shaka.media.SegmentIndex.prototype.earliestReference=function(){return this.references[0]||null},shaka.media.SegmentIndex.prototype.dropFirstReferences=function(e){this.references.splice(0,e)},shaka.media.SegmentIndex.prototype.find=function(e){for(var t=this.references.length-1,r=t;0<=r;--r){var n=this.references[r],a=r<t?this.references[r+1].startTime:n.endTime;if(e>=n.startTime&&e<a)return r+this.numEvicted_}return this.references.length&&e<this.references[0].startTime?this.numEvicted_:null},shaka.media.SegmentIndex.prototype.get=function(e){return 0==this.references.length||0>(e-=this.numEvicted_)||e>=this.references.length?null:this.references[e]},shaka.media.SegmentIndex.prototype.offset=function(e){if(!this.immutable_)for(var t=$jscomp.makeIterator(this.references),r=t.next();!r.done;r=t.next())r.value.offset(e)},shaka.media.SegmentIndex.prototype.merge=function(e){if(goog.DEBUG&&shaka.media.SegmentIndex.assertCorrectReferences_(e),!this.immutable_&&e.length){var t=Math.round(1e3*e[0].startTime)/1e3;this.references=this.references.filter((function(e){return Math.round(1e3*e.startTime)/1e3<t})),this.references.push.apply(this.references,$jscomp.arrayFromIterable(e)),goog.DEBUG&&shaka.media.SegmentIndex.assertCorrectReferences_(this.references)}},shaka.media.SegmentIndex.prototype.mergeAndEvict=function(e,t){var r=this;e=e.filter((function(e){return e.endTime>t&&(0==r.references.length||e.endTime>r.references[0].startTime)}));var n=this.references[0];this.merge(e),e=this.references[0],n&&goog.asserts.assert(n.startTime==e.startTime,"SegmentIndex.merge should not change the first reference time!"),this.evict(t)},shaka.media.SegmentIndex.prototype.evict=function(e){if(!this.immutable_){var t=this.references.length;this.references=this.references.filter((function(t){return t.endTime>e})),this.numEvicted_+=t-this.references.length}},shaka.media.SegmentIndex.prototype.fit=function(e,t,r){if(r=void 0!==r&&r,goog.asserts.assert(null!=t,"Content duration must be known for static content!"),goog.asserts.assert(1/0!=t,"Content duration must be finite for static content!"),!this.immutable_){for(;this.references.length&&this.references[this.references.length-1].startTime>=t;)this.references.pop();for(;this.references.length&&this.references[0].endTime<=e;)this.references.shift(),r||this.numEvicted_++;0!=this.references.length&&(e=this.references[this.references.length-1],(t=new shaka.media.SegmentReference(e.startTime,t,e.getUrisInner,e.startByte,e.endByte,e.initSegmentReference,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.partialReferences,e.tilesLayout,e.tileDuration,e.syncTime,e.status,e.aesKey)).mimeType=e.mimeType,t.codecs=e.codecs,t.discontinuitySequence=e.discontinuitySequence,this.references[this.references.length-1]=t)}},shaka.media.SegmentIndex.prototype.updateEvery=function(e,t){var r=this;goog.asserts.assert(!this.timer_,"SegmentIndex timer already started!"),this.immutable_||(this.timer_&&this.timer_.stop(),this.timer_=new shaka.util.Timer((function(){var e=t();e?r.references.push.apply(r.references,$jscomp.arrayFromIterable(e)):(r.timer_.stop(),r.timer_=null)})),this.timer_.tickEvery(e))},shaka.media.SegmentIndex.prototype[Symbol.iterator]=function(){var e=this.getIteratorForTime(0);return goog.asserts.assert(null!=e,"Iterator for 0 should never be null!"),e},shaka.media.SegmentIndex.prototype.getIteratorForTime=function(e,t,r){t=void 0!==t&&t,r=void 0!==r&&r;var n=this.find(e);if(null==n)return null;n--;var a=this.get(n+1),i=-1;if(a&&a.hasPartialSegments())for(var o=a.partialReferences.length-1;0<=o;--o){var s=a.partialReferences[o];if(e>=s.startTime&&e<s.endTime){if(!t){for(;o&&!s.isIndependent();)o--,s=a.partialReferences[o];if(!s.isIndependent())return shaka.log.alwaysError("No independent partial segment found!"),null}n++,i=o-1;break}}return new shaka.media.SegmentIterator(this,n,i,r)},shaka.media.SegmentIndex.prototype.isEmpty=function(){return 0==this.getNumReferences()},shaka.media.SegmentIndex.forSingleSegment=function(e,t,r){return e=new shaka.media.SegmentReference(e,e+t,(function(){return r}),0,null,null,e,e,e+t),new shaka.media.SegmentIndex([e])},goog.exportSymbol("shaka.media.SegmentIndex",shaka.media.SegmentIndex),goog.exportProperty(shaka.media.SegmentIndex,"forSingleSegment",shaka.media.SegmentIndex.forSingleSegment),goog.exportProperty(shaka.media.SegmentIndex.prototype,"getIteratorForTime",shaka.media.SegmentIndex.prototype.getIteratorForTime),goog.exportProperty(shaka.media.SegmentIndex.prototype,"updateEvery",shaka.media.SegmentIndex.prototype.updateEvery),goog.exportProperty(shaka.media.SegmentIndex.prototype,"fit",shaka.media.SegmentIndex.prototype.fit),goog.exportProperty(shaka.media.SegmentIndex.prototype,"evict",shaka.media.SegmentIndex.prototype.evict),goog.exportProperty(shaka.media.SegmentIndex.prototype,"mergeAndEvict",shaka.media.SegmentIndex.prototype.mergeAndEvict),goog.exportProperty(shaka.media.SegmentIndex.prototype,"offset",shaka.media.SegmentIndex.prototype.offset),goog.exportProperty(shaka.media.SegmentIndex.prototype,"get",shaka.media.SegmentIndex.prototype.get),goog.exportProperty(shaka.media.SegmentIndex.prototype,"find",shaka.media.SegmentIndex.prototype.find),goog.exportProperty(shaka.media.SegmentIndex.prototype,"markImmutable",shaka.media.SegmentIndex.prototype.markImmutable),goog.exportProperty(shaka.media.SegmentIndex.prototype,"release",shaka.media.SegmentIndex.prototype.release),goog.exportProperty(shaka.media.SegmentIndex.prototype,"getNumEvicted",shaka.media.SegmentIndex.prototype.getNumEvicted),goog.exportProperty(shaka.media.SegmentIndex.prototype,"getNumReferences",shaka.media.SegmentIndex.prototype.getNumReferences),goog.DEBUG&&(shaka.media.SegmentIndex.assertCorrectReferences_=function(e){goog.asserts.assert(e.every((function(t,r){return 0==r||((r=e[r-1]).startTime<t.startTime||!(r.startTime>t.startTime)&&r.endTime<=t.endTime)})),"SegmentReferences are incorrect")}),shaka.media.SegmentIterator=function(e,t,r,n){this.segmentIndex_=e,this.currentPosition_=t,this.currentPartialPosition_=r,this.reverse=n},shaka.media.SegmentIterator.prototype.setReverse=function(e){this.reverse=e},shaka.media.SegmentIterator.prototype.currentPosition=function(){return this.currentPosition_},shaka.media.SegmentIterator.prototype.current=function(){var e=this.segmentIndex_.get(this.currentPosition_);return e&&e.hasPartialSegments()&&e.hasAllPartialSegments()&&this.currentPartialPosition_>=e.partialReferences.length&&(this.currentPosition_++,this.currentPartialPosition_=0,e=this.segmentIndex_.get(this.currentPosition_)),e&&e.hasPartialSegments()?e.partialReferences[this.currentPartialPosition_]:e},shaka.media.SegmentIterator.prototype.next=function(){var e=this.segmentIndex_.get(this.currentPosition_);return this.reverse?e&&e.hasPartialSegments()?(this.currentPartialPosition_--,0>this.currentPartialPosition_&&(this.currentPosition_--,(e=this.segmentIndex_.get(this.currentPosition_))&&e.hasPartialSegments()?this.currentPartialPosition_=e.partialReferences.length-1:this.currentPartialPosition_=0)):(this.currentPosition_--,this.currentPartialPosition_=0):e&&e.hasPartialSegments()?(this.currentPartialPosition_++,e.hasAllPartialSegments()&&this.currentPartialPosition_==e.partialReferences.length&&(this.currentPosition_++,this.currentPartialPosition_=0)):(this.currentPosition_++,this.currentPartialPosition_=0),{value:e=this.current(),done:!e}},goog.exportSymbol("shaka.media.SegmentIterator",shaka.media.SegmentIterator),goog.exportProperty(shaka.media.SegmentIterator.prototype,"next",shaka.media.SegmentIterator.prototype.next),goog.exportProperty(shaka.media.SegmentIterator.prototype,"current",shaka.media.SegmentIterator.prototype.current),goog.exportProperty(shaka.media.SegmentIterator.prototype,"currentPosition",shaka.media.SegmentIterator.prototype.currentPosition),goog.exportProperty(shaka.media.SegmentIterator.prototype,"setReverse",shaka.media.SegmentIterator.prototype.setReverse),shaka.media.MetaSegmentIndex=function(){shaka.media.SegmentIndex.call(this,[]),this.indexes_=[]},$jscomp.inherits(shaka.media.MetaSegmentIndex,shaka.media.SegmentIndex),shaka.media.MetaSegmentIndex.prototype.appendSegmentIndex=function(e){goog.asserts.assert(0==this.indexes_.length||0==e.getNumEvicted(),"Should not append a new segment index with already-evicted segments"),this.indexes_.push(e)},shaka.media.MetaSegmentIndex.prototype.clone=function(){var e=new shaka.media.MetaSegmentIndex;return e.indexes_=this.indexes_.slice(),e},shaka.media.MetaSegmentIndex.prototype.release=function(){for(var e=$jscomp.makeIterator(this.indexes_),t=e.next();!t.done;t=e.next())t.value.release();this.indexes_=[]},shaka.media.MetaSegmentIndex.prototype.forEachTopLevelReference=function(e){for(var t=$jscomp.makeIterator(this.indexes_),r=t.next();!r.done;r=t.next())r.value.forEachTopLevelReference(e)},shaka.media.MetaSegmentIndex.prototype.find=function(e){for(var t=0,r=$jscomp.makeIterator(this.indexes_),n=r.next();!n.done;n=r.next()){var a=(n=n.value).find(e);if(null!=a)return a+t;t+=n.getNumEvicted()+n.getNumReferences()}return null},shaka.media.MetaSegmentIndex.prototype.get=function(e){for(var t=0,r=!1,n=$jscomp.makeIterator(this.indexes_),a=n.next();!a.done;a=n.next()){a=a.value,goog.asserts.assert(!r||0==a.getNumEvicted(),"Should not see evicted segments after available segments");var i=a.get(e-t);if(i)return i;i=a.getNumReferences(),t+=a.getNumEvicted()+i,r=r||0!=i}return null},shaka.media.MetaSegmentIndex.prototype.offset=function(e){goog.asserts.assert(!1,"offset() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.merge=function(e){goog.asserts.assert(!1,"merge() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.evict=function(e){goog.asserts.assert(!1,"evict() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.mergeAndEvict=function(e,t){goog.asserts.assert(!1,"mergeAndEvict() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.fit=function(e,t){goog.asserts.assert(!1,"fit() should not be used in MetaSegmentIndex!")},shaka.media.MetaSegmentIndex.prototype.updateEvery=function(e,t){goog.asserts.assert(!1,"updateEvery() should not be used in MetaSegmentIndex!")},goog.exportSymbol("shaka.media.MetaSegmentIndex",shaka.media.MetaSegmentIndex),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"updateEvery",shaka.media.MetaSegmentIndex.prototype.updateEvery),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"fit",shaka.media.MetaSegmentIndex.prototype.fit),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"mergeAndEvict",shaka.media.MetaSegmentIndex.prototype.mergeAndEvict),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"evict",shaka.media.MetaSegmentIndex.prototype.evict),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"merge",shaka.media.MetaSegmentIndex.prototype.merge),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"offset",shaka.media.MetaSegmentIndex.prototype.offset),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"get",shaka.media.MetaSegmentIndex.prototype.get),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"find",shaka.media.MetaSegmentIndex.prototype.find),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"forEachTopLevelReference",shaka.media.MetaSegmentIndex.prototype.forEachTopLevelReference),goog.exportProperty(shaka.media.MetaSegmentIndex.prototype,"release",shaka.media.MetaSegmentIndex.prototype.release),shaka.media.PlayRateController=function(e){var t=this;this.harness_=e,this.isBuffering_=!1,this.rate_=this.harness_.getRate(),this.pollRate_=.25,this.timer_=new shaka.util.Timer((function(){t.harness_.movePlayhead(t.rate_*t.pollRate_)}))},shaka.media.PlayRateController.prototype.release=function(){this.set(this.getDefaultRate()),this.timer_&&(this.timer_.stop(),this.timer_=null),this.harness_=null},shaka.media.PlayRateController.prototype.setBuffering=function(e){this.isBuffering_=e,this.apply_()},shaka.media.PlayRateController.prototype.set=function(e){goog.asserts.assert(0!=e,"Should never set rate of 0 explicitly!"),this.rate_=e,this.apply_()},shaka.media.PlayRateController.prototype.getRealRate=function(){return this.rate_},shaka.media.PlayRateController.prototype.getDefaultRate=function(){return this.harness_.getDefaultRate()},shaka.media.PlayRateController.prototype.apply_=function(){this.timer_.stop();var e=this.calculateCurrentRate_();if(shaka.log.v1("Changing effective playback rate to",e),0<=e)try{return void this.applyRate_(e)}catch(e){}this.timer_.tickEvery(this.pollRate_),this.applyRate_(0)},shaka.media.PlayRateController.prototype.calculateCurrentRate_=function(){return this.isBuffering_?0:this.rate_},shaka.media.PlayRateController.prototype.applyRate_=function(e){var t=this.harness_.getRate();return t!=e&&this.harness_.setRate(e),t!=e},shaka.media.IPlayheadObserver=function(){},shaka.media.IPlayheadObserver.prototype.poll=function(e,t){},shaka.media.PlayheadObserverManager=function(e){var t=this;this.mediaElement_=e,this.observers_=new Set,this.pollingLoop_=new shaka.util.Timer((function(){t.pollAllObservers_(!1)})).tickEvery(.25)},shaka.media.PlayheadObserverManager.prototype.release=function(){this.pollingLoop_.stop();for(var e=$jscomp.makeIterator(this.observers_),t=e.next();!t.done;t=e.next())t.value.release();this.observers_.clear()},shaka.media.PlayheadObserverManager.prototype.manage=function(e){this.observers_.add(e)},shaka.media.PlayheadObserverManager.prototype.notifyOfSeek=function(){this.pollAllObservers_(!0)},shaka.media.PlayheadObserverManager.prototype.pollAllObservers_=function(e){for(var t=$jscomp.makeIterator(this.observers_),r=t.next();!r.done;r=t.next())r.value.poll(this.mediaElement_.currentTime,e)},shaka.util.StateHistory=function(){this.open_=null,this.closed_=[]},shaka.util.StateHistory.prototype.update=function(e){return null==this.open_?(this.start_(e),!0):this.update_(e)},shaka.util.StateHistory.prototype.getTimeSpentIn=function(e){var t=0;this.open_&&this.open_.state==e&&(t+=this.open_.duration);for(var r=$jscomp.makeIterator(this.closed_),n=r.next();!n.done;n=r.next())t+=(n=n.value).state==e?n.duration:0;return t},shaka.util.StateHistory.prototype.getCopy=function(){for(var e=function(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}},t=[],r=$jscomp.makeIterator(this.closed_),n=r.next();!n.done;n=r.next())t.push(e(n.value));return this.open_&&t.push(e(this.open_)),t},shaka.util.StateHistory.prototype.start_=function(e){goog.asserts.assert(null==this.open_,"There must be no open entry in order when we start"),shaka.log.v1("Changing Player state to",e),this.open_={timestamp:this.getNowInSeconds_(),state:e,duration:0}},shaka.util.StateHistory.prototype.update_=function(e){goog.asserts.assert(this.open_,"There must be an open entry in order to update it");var t=this.getNowInSeconds_();return this.open_.duration=t-this.open_.timestamp,this.open_.state!=e&&(shaka.log.v1("Changing Player state to",e),this.closed_.push(this.open_),this.open_={timestamp:t,state:e,duration:0},!0)},shaka.util.StateHistory.prototype.getNowInSeconds_=function(){return Date.now()/1e3},shaka.util.SwitchHistory=function(){this.currentText_=this.currentVariant_=null,this.history_=[]},shaka.util.SwitchHistory.prototype.updateCurrentVariant=function(e,t){this.currentVariant_!=e&&(this.currentVariant_=e,this.history_.push({timestamp:this.getNowInSeconds_(),id:e.id,type:"variant",fromAdaptation:t,bandwidth:e.bandwidth}))},shaka.util.SwitchHistory.prototype.updateCurrentText=function(e,t){this.currentText_!=e&&(this.currentText_=e,this.history_.push({timestamp:this.getNowInSeconds_(),id:e.id,type:"text",fromAdaptation:t,bandwidth:null}))},shaka.util.SwitchHistory.prototype.getCopy=function(){for(var e=[],t=$jscomp.makeIterator(this.history_),r=t.next();!r.done;r=t.next())e.push(this.clone_(r.value));return e},shaka.util.SwitchHistory.prototype.getNowInSeconds_=function(){return Date.now()/1e3},shaka.util.SwitchHistory.prototype.clone_=function(e){return{timestamp:e.timestamp,id:e.id,type:e.type,fromAdaptation:e.fromAdaptation,bandwidth:e.bandwidth}},shaka.util.Stats=function(){this.bytesDownloaded_=this.bandwidthEstimate_=this.currentStreamBandwidth_=this.maxSegmentDurationSeconds_=this.liveLatencySeconds_=this.licenseTimeSeconds_=this.drmTimeSeconds_=this.manifestTimeSeconds_=this.loadLatencySeconds_=this.completionPercent_=this.totalGapsJumped_=this.totalStallsDetected_=this.totalCorruptedFrames_=this.totalDecodedFrames_=this.totalDroppedFrames_=this.height_=this.width_=NaN,this.stateHistory_=new shaka.util.StateHistory,this.switchHistory_=new shaka.util.SwitchHistory},shaka.util.Stats.prototype.setDroppedFrames=function(e,t){this.totalDroppedFrames_=e,this.totalDecodedFrames_=t},shaka.util.Stats.prototype.setCorruptedFrames=function(e){this.totalCorruptedFrames_=e},shaka.util.Stats.prototype.setStallsDetected=function(e){this.totalStallsDetected_=e},shaka.util.Stats.prototype.setGapsJumped=function(e){this.totalGapsJumped_=e},shaka.util.Stats.prototype.setResolution=function(e,t){this.width_=e,this.height_=t},shaka.util.Stats.prototype.setLoadLatency=function(e){this.loadLatencySeconds_=e},shaka.util.Stats.prototype.setManifestTime=function(e){this.manifestTimeSeconds_=e},shaka.util.Stats.prototype.setCompletionPercent=function(e){isNaN(this.completionPercent_)?this.completionPercent_=e:this.completionPercent_=Math.max(this.completionPercent_,e)},shaka.util.Stats.prototype.setDrmTime=function(e){this.drmTimeSeconds_=e},shaka.util.Stats.prototype.setLicenseTime=function(e){this.licenseTimeSeconds_=e},shaka.util.Stats.prototype.setLiveLatency=function(e){this.liveLatencySeconds_=e},shaka.util.Stats.prototype.setMaxSegmentDuration=function(e){this.maxSegmentDurationSeconds_=e},shaka.util.Stats.prototype.setCurrentStreamBandwidth=function(e){this.currentStreamBandwidth_=e},shaka.util.Stats.prototype.setBandwidthEstimate=function(e){this.bandwidthEstimate_=e},shaka.util.Stats.prototype.addBytesDownloaded=function(e){isNaN(this.bytesDownloaded_)?this.bytesDownloaded_=e:this.bytesDownloaded_+=e},shaka.util.Stats.prototype.getStateHistory=function(){return this.stateHistory_},shaka.util.Stats.prototype.getSwitchHistory=function(){return this.switchHistory_},shaka.util.Stats.prototype.getBlob=function(){return{width:this.width_,height:this.height_,streamBandwidth:this.currentStreamBandwidth_,decodedFrames:this.totalDecodedFrames_,droppedFrames:this.totalDroppedFrames_,corruptedFrames:this.totalCorruptedFrames_,stallsDetected:this.totalStallsDetected_,gapsJumped:this.totalGapsJumped_,estimatedBandwidth:this.bandwidthEstimate_,completionPercent:this.completionPercent_,loadLatency:this.loadLatencySeconds_,manifestTimeSeconds:this.manifestTimeSeconds_,drmTimeSeconds:this.drmTimeSeconds_,playTime:this.stateHistory_.getTimeSpentIn("playing"),pauseTime:this.stateHistory_.getTimeSpentIn("paused"),bufferingTime:this.stateHistory_.getTimeSpentIn("buffering"),licenseTime:this.licenseTimeSeconds_,liveLatency:this.liveLatencySeconds_,maxSegmentDuration:this.maxSegmentDurationSeconds_,bytesDownloaded:this.bytesDownloaded_,stateHistory:this.stateHistory_.getCopy(),switchHistory:this.switchHistory_.getCopy()}},shaka.util.Stats.getEmptyBlob=function(){return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,bytesDownloaded:NaN,switchHistory:[],stateHistory:[]}},shaka.media.SegmentPrefetch=function(e,t,r){this.prefetchLimit_=e,this.stream_=t,this.prefetchPosTime_=0,this.fetchDispatcher_=r,this.segmentPrefetchMap_=new Map,this.initSegmentPrefetchMap_=new Map},shaka.media.SegmentPrefetch.prototype.replaceFetchDispatcher=function(e){this.fetchDispatcher_=e;for(var t=$jscomp.makeIterator(this.segmentPrefetchMap_.values()),r=t.next();!r.done;r=t.next())r.value.replaceFetchDispatcher(e)},shaka.media.SegmentPrefetch.prototype.getLastKnownPosition=function(){return this.prefetchPosTime_},shaka.media.SegmentPrefetch.prototype.prefetchSegmentsByTime=function(e,t){t=void 0!==t&&t,goog.asserts.assert(0<this.prefetchLimit_,"SegmentPrefetch can not be used when prefetchLimit <= 0.");var r=shaka.media.SegmentPrefetch.logPrefix_(this.stream_);if(this.stream_.segmentIndex){if((e=this.stream_.segmentIndex.getIteratorForTime(Math.max(e,this.prefetchPosTime_),!0))&&(r=e.next().value,t&&(r=e.next().value),r)){for(;this.segmentPrefetchMap_.size<this.prefetchLimit_&&null!=r&&(t=!0,r.isPreload()&&null!=r.endByte&&(t=!1),r.getStatus()==shaka.media.SegmentReference.Status.MISSING&&(t=!1),t&&r.initSegmentReference&&this.prefetchInitSegment(r.initSegmentReference),t&&!this.segmentPrefetchMap_.has(r)&&((t=new shaka.media.SegmentPrefetchOperation(this.fetchDispatcher_)).dispatchFetch(r,this.stream_),this.segmentPrefetchMap_.set(r,t)),this.prefetchPosTime_=r.startTime,!(this.stream_.fastSwitching&&r.isPartial()&&r.isLastPartial()));)r=e.next().value;this.clearInitSegments_()}}else shaka.log.debug(r,"missing segmentIndex")},shaka.media.SegmentPrefetch.prototype.prefetchInitSegment=function(e){goog.asserts.assert(0<this.prefetchLimit_,"SegmentPrefetch can not be used when prefetchLimit <= 0.");var t=shaka.media.SegmentPrefetch.logPrefix_(this.stream_);this.stream_.segmentIndex?Array.from(this.initSegmentPrefetchMap_.keys()).some((function(t){return shaka.media.InitSegmentReference.equal(t,e)}))||((t=new shaka.media.SegmentPrefetchOperation(this.fetchDispatcher_)).dispatchFetch(e,this.stream_),this.initSegmentPrefetchMap_.set(e,t)):shaka.log.debug(t,"missing segmentIndex")},shaka.media.SegmentPrefetch.prototype.getPrefetchedSegment=function(e,t){goog.asserts.assert(0<this.prefetchLimit_,"SegmentPrefetch can not be used when prefetchLimit <= 0.");var r=shaka.media.SegmentPrefetch.logPrefix_(this.stream_),n=this.segmentPrefetchMap_;if(e instanceof shaka.media.InitSegmentReference&&(n=this.initSegmentPrefetchMap_),n.has(e)){var a=n.get(e);return t&&a.setStreamDataCallback(t),e instanceof shaka.media.SegmentReference?shaka.log.debug(r,"reused prefetched segment at time:",e.startTime,"mapSize",n.size):shaka.log.debug(r,"reused prefetched init segment at time, mapSize",n.size),a.getOperation()}return e instanceof shaka.media.SegmentReference?shaka.log.debug(r,"missed segment at time:",e.startTime,"mapSize",n.size):shaka.log.debug(r,"missed init segment at time, mapSize",n.size),null},shaka.media.SegmentPrefetch.prototype.clearMap_=function(e){for(var t=(e=$jscomp.makeIterator(e.keys())).next();!t.done;t=e.next())(t=t.value)&&this.abortPrefetchedSegment_(t)},shaka.media.SegmentPrefetch.prototype.clearAll=function(){this.clearMap_(this.segmentPrefetchMap_),this.clearMap_(this.initSegmentPrefetchMap_);var e=shaka.media.SegmentPrefetch.logPrefix_(this.stream_);shaka.log.debug(e,"cleared all"),this.prefetchPosTime_=0},shaka.media.SegmentPrefetch.prototype.removeReference=function(e){this.abortPrefetchedSegment_(e)},shaka.media.SegmentPrefetch.prototype.evict=function(e,t){t=void 0!==t&&t;for(var r=$jscomp.makeIterator(this.segmentPrefetchMap_.keys()),n=r.next();!n.done;n=r.next())e>(n=n.value).endTime&&this.abortPrefetchedSegment_(n);t&&this.clearInitSegments_()},shaka.media.SegmentPrefetch.prototype.clearInitSegments_=function(){for(var e=Array.from(this.segmentPrefetchMap_.keys()),t={},r=$jscomp.makeIterator(this.initSegmentPrefetchMap_.keys()),n=r.next();!n.done;t={$jscomp$loop$prop$initSegmentReference$878:t.$jscomp$loop$prop$initSegmentReference$878},n=r.next())t.$jscomp$loop$prop$initSegmentReference$878=n.value,e.some(function(e){return function(t){return shaka.media.InitSegmentReference.equal(t.initSegmentReference,e.$jscomp$loop$prop$initSegmentReference$878)}}(t))||this.abortPrefetchedSegment_(t.$jscomp$loop$prop$initSegmentReference$878)},shaka.media.SegmentPrefetch.prototype.resetLimit=function(e){goog.asserts.assert(0<=e,"The new prefetch limit must be >= 0.");var t=shaka.media.SegmentPrefetch.logPrefix_(this.stream_);for(shaka.log.debug(t,"resetting prefetch limit to",e),this.prefetchLimit_=e,t=Array.from(this.segmentPrefetchMap_.keys());t.length>e;){var r=t.pop();r&&this.abortPrefetchedSegment_(r)}this.clearInitSegments_()},shaka.media.SegmentPrefetch.prototype.switchStream=function(e){e&&e!==this.stream_&&(this.clearAll(),this.stream_=e)},shaka.media.SegmentPrefetch.prototype.getStream=function(){return this.stream_},shaka.media.SegmentPrefetch.prototype.abortPrefetchedSegment_=function(e){var t=shaka.media.SegmentPrefetch.logPrefix_(this.stream_),r=this.segmentPrefetchMap_;e instanceof shaka.media.InitSegmentReference&&(r=this.initSegmentPrefetchMap_);var n=r.get(e);r.delete(e),n&&(n.abort(),e instanceof shaka.media.SegmentReference?shaka.log.debug(t,"pop and abort prefetched segment at time:",e.startTime):shaka.log.debug(t,"pop and abort prefetched init segment"))},shaka.media.SegmentPrefetch.logPrefix_=function(e){return"SegmentPrefetch("+e.type+":"+e.id+")"},shaka.media.SegmentPrefetchOperation=function(e){this.fetchDispatcher_=e,this.operation_=this.streamDataCallback_=null},shaka.media.SegmentPrefetchOperation.prototype.replaceFetchDispatcher=function(e){this.fetchDispatcher_=e},shaka.media.SegmentPrefetchOperation.prototype.dispatchFetch=function(e,t){var r=this,n=new Uint8Array(0);this.operation_=this.fetchDispatcher_(e,t,(function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress)return n=0<n.byteLength?shaka.util.Uint8ArrayUtils.concat(n,e):e,r.streamDataCallback_?t.yield(r.streamDataCallback_(n),3):t.jumpTo(0);n=new Uint8Array(0),t.jumpToEnd()}))}))},shaka.media.SegmentPrefetchOperation.prototype.getOperation=function(){return this.operation_},shaka.media.SegmentPrefetchOperation.prototype.setStreamDataCallback=function(e){this.streamDataCallback_=e},shaka.media.SegmentPrefetchOperation.prototype.abort=function(){this.operation_&&this.operation_.abort()},shaka.media.RegionTimeline=function(e){shaka.util.FakeEventTarget.call(this);var t=this;this.regions_=new Set,this.getSeekRange_=e,this.filterTimer_=new shaka.util.Timer((function(){t.filterBySeekRange_()})).tickEvery(shaka.media.RegionTimeline.REGION_FILTER_INTERVAL)},$jscomp.inherits(shaka.media.RegionTimeline,shaka.util.FakeEventTarget),shaka.media.RegionTimeline.prototype.release=function(){this.regions_.clear(),this.filterTimer_.stop(),shaka.util.FakeEventTarget.prototype.release.call(this)},shaka.media.RegionTimeline.prototype.addRegion=function(e){null==this.findSimilarRegion_(e)&&(this.regions_.add(e),e=new shaka.util.FakeEvent("regionadd",new Map([["region",e]])),this.dispatchEvent(e))},shaka.media.RegionTimeline.prototype.filterBySeekRange_=function(){for(var e=this.getSeekRange_(),t=$jscomp.makeIterator(this.regions_),r=t.next();!r.done;r=t.next())(r=r.value).endTime<e.start&&(this.regions_.delete(r),r=new shaka.util.FakeEvent("regionremove",new Map([["region",r]])),this.dispatchEvent(r))},shaka.media.RegionTimeline.prototype.findSimilarRegion_=function(e){for(var t=$jscomp.makeIterator(this.regions_),r=t.next();!r.done;r=t.next())if((r=r.value).schemeIdUri==e.schemeIdUri&&r.id==e.id&&r.startTime==e.startTime&&r.endTime==e.endTime)return r;return null},shaka.media.RegionTimeline.prototype.regions=function(){return this.regions_},shaka.media.RegionTimeline.REGION_FILTER_INTERVAL=2,shaka.media.QualityObserver=function(e){shaka.util.FakeEventTarget.call(this),this.contentTypeStates_=new Map,this.getBufferedInfo_=e},$jscomp.inherits(shaka.media.QualityObserver,shaka.util.FakeEventTarget),shaka.media.QualityObserver.prototype.release=function(){this.contentTypeStates_.clear(),shaka.util.FakeEventTarget.prototype.release.call(this)},shaka.media.QualityObserver.prototype.getContentTypeState_=function(e){var t=this.contentTypeStates_.get(e);return t||(t={qualityChangePositions:[],currentQuality:null,contentType:e},this.contentTypeStates_.set(e,t)),t},shaka.media.QualityObserver.prototype.addMediaQualityChange=function(e,t){var r=this.getContentTypeState_(e.contentType);this.purgeQualityChangePositions_(r),e={mediaQuality:e,position:t};var n=(r=r.qualityChangePositions).findIndex((function(e){return e.position>=t}));0<=n?r.splice(n,r[n].position==t?1:0,e):r.push(e)},shaka.media.QualityObserver.getMediaQualityAtPosition_=function(e,t){for(var r=(t=t.qualityChangePositions).length-1;0<=r;r--){var n=t[r];if(n.position<=e)return n.mediaQuality}return null},shaka.media.QualityObserver.mediaQualitiesAreTheSame_=function(e,t){return e===t||!(!e||!t)&&(e.bandwidth==t.bandwidth&&e.audioSamplingRate==t.audioSamplingRate&&e.codecs==t.codecs&&e.contentType==t.contentType&&e.frameRate==t.frameRate&&e.height==t.height&&e.mimeType==t.mimeType&&e.channelsCount==t.channelsCount&&e.pixelAspectRatio==t.pixelAspectRatio&&e.width==t.width)},shaka.media.QualityObserver.prototype.poll=function(e,t){for(var r=(t=$jscomp.makeIterator(this.contentTypeStates_.values())).next();!r.done;r=t.next()){r=r.value;var n=shaka.media.QualityObserver.getMediaQualityAtPosition_(e,r);n&&!shaka.media.QualityObserver.mediaQualitiesAreTheSame_(r.currentQuality,n)&&this.positionIsBuffered_(e,n.contentType)&&(r.currentQuality=n,shaka.log.debug("Media quality changed at position "+e+" "+JSON.stringify(n)),r=new shaka.util.FakeEvent("qualitychange",new Map([["quality",n],["position",e]])),this.dispatchEvent(r))}},shaka.media.QualityObserver.prototype.positionIsBuffered_=function(e,t){if((t=this.getBufferedInfo_()[t])&&0<t.length){var r=t[t.length-1].end;if(e>=t[0].start&&e<r)return!0}return!1},shaka.media.QualityObserver.prototype.purgeQualityChangePositions_=function(e){var t=this.getBufferedInfo_()[e.contentType];if(t&&0<t.length){var r=t[0].start,n=t[t.length-1].end,a=e.qualityChangePositions;e.qualityChangePositions=a.filter((function(e,t){return!(e.position<=r&&t+1<a.length&&a[t+1].position<=r||e.position>=n)}))}else e.qualityChangePositions=[]},shaka.util.Networking=function(){},shaka.util.Networking.createSegmentRequest=function(e,t,r,n,a){return e=shaka.net.NetworkingEngine.makeRequest(e,n,a),0==t&&null==r||(e.headers.Range=r?"bytes="+t+"-"+r:"bytes="+t+"-"),e},shaka.media.StreamingEngine=function(e,t){var r=this;this.playerInterface_=t,this.manifest_=e,this.config_=null,this.bufferingGoalScale_=1,this.currentTextStream_=this.currentVariant_=null,this.textStreamSequenceId_=0,this.parsedPrftEventRaised_=!1,this.mediaStates_=new Map,this.startupComplete_=!1,this.failureCallbackBackoff_=null,this.fatalError_=!1,this.destroyer_=new shaka.util.Destroyer((function(){return r.doDestroy_()})),this.lastMediaSourceReset_=Date.now()/1e3,this.audioPrefetchMap_=new Map,this.spatialVideoInfo_={projection:null,hfov:null}},shaka.media.StreamingEngine.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.media.StreamingEngine.prototype.doDestroy_=function(){var e,t,r,n,a,i,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){if(1==s.nextAddress){for(e=[],t=$jscomp.makeIterator(o.mediaStates_.values()),r=t.next();!r.done;r=t.next())n=r.value,o.cancelUpdate_(n),e.push(o.abortOperations_(n));for(a=$jscomp.makeIterator(o.audioPrefetchMap_.values()),i=a.next();!i.done;i=a.next())i.value.clearAll();return s.yield(Promise.all(e),2)}o.mediaStates_.clear(),o.audioPrefetchMap_.clear(),o.playerInterface_=null,o.manifest_=null,o.config_=null,s.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.configure=function(e){this.config_=e,this.failureCallbackBackoff_=new shaka.net.Backoff({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0);var t=shaka.util.ManifestParserUtils.ContentType;if(e.disableAudioPrefetch){var r=this.mediaStates_.get(t.AUDIO);r&&r.segmentPrefetch&&(r.segmentPrefetch.clearAll(),r.segmentPrefetch=null);for(var n=(r=$jscomp.makeIterator(this.audioPrefetchMap_.keys())).next();!n.done;n=r.next())n=n.value,this.audioPrefetchMap_.get(n).clearAll(),this.audioPrefetchMap_.delete(n)}for(e.disableTextPrefetch&&(r=this.mediaStates_.get(t.TEXT))&&r.segmentPrefetch&&(r.segmentPrefetch.clearAll(),r.segmentPrefetch=null),e.disableVideoPrefetch&&(t=this.mediaStates_.get(t.VIDEO))&&t.segmentPrefetch&&(t.segmentPrefetch.clearAll(),t.segmentPrefetch=null),r=(t=$jscomp.makeIterator(this.mediaStates_.keys())).next();!r.done;r=t.next())(r=this.mediaStates_.get(r.value)).segmentPrefetch?(r.segmentPrefetch.resetLimit(e.segmentPrefetchLimit),0<e.segmentPrefetchLimit||(r.segmentPrefetch=null)):0<e.segmentPrefetchLimit&&(r.segmentPrefetch=this.createSegmentPrefetch_(r.stream));e.disableAudioPrefetch||this.updatePrefetchMapForAudio_()},shaka.media.StreamingEngine.prototype.start=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return goog.asserts.assert(t.config_,"StreamingEngine configure() must be called before init()!"),r.yield(t.initStreams_(e||new Map),2);t.destroyer_.ensureNotDestroyed(),shaka.log.debug("init: completed initial Stream setup"),t.startupComplete_=!0,r.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.getCurrentVariant=function(){return this.currentVariant_},shaka.media.StreamingEngine.prototype.getCurrentTextStream=function(){return this.currentTextStream_},shaka.media.StreamingEngine.prototype.loadNewTextStream_=function(e){var t,r,n,a,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:return t=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(!s.mediaStates_.has(t.TEXT),"Should not call loadNewTextStream_ while streaming text!"),s.textStreamSequenceId_++,r=s.textStreamSequenceId_,l.setCatchFinallyBlocks(2),l.yield(s.playerInterface_.mediaSourceEngine.clear(t.TEXT),4);case 4:l.leaveTryBlock(3);break;case 2:n=l.enterCatchBlock(),s.playerInterface_&&s.playerInterface_.onError(n);case 3:a=shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs),s.playerInterface_.mediaSourceEngine.reinitText(a,s.manifest_.sequenceMode,e.external),i=s.playerInterface_.mediaSourceEngine.getTextDisplayer(),(i.isTextVisible()||s.config_.alwaysStreamText)&&s.textStreamSequenceId_==r&&(o=s.createMediaState_(e),s.mediaStates_.set(t.TEXT,o),s.scheduleUpdate_(o,0)),l.jumpToEnd()}}))},shaka.media.StreamingEngine.prototype.unloadTextStream=function(){var e=shaka.util.ManifestParserUtils.ContentType,t=this.mediaStates_.get(e.TEXT);t&&(this.cancelUpdate_(t),this.abortOperations_(t).catch((function(){})),this.mediaStates_.delete(e.TEXT)),this.currentTextStream_=null},shaka.media.StreamingEngine.prototype.setTrickPlay=function(e){var t=shaka.util.ManifestParserUtils.ContentType;if(this.updateSegmentIteratorReverse_(),t=this.mediaStates_.get(t.VIDEO)){var r=t.stream;r&&(shaka.log.debug("setTrickPlay",e),e?(e=r.trickModeVideo)&&!t.restoreStreamAfterTrickPlay&&(shaka.log.debug("Engaging trick mode stream",e),this.switchInternal_(e,!1,0,!1),t.restoreStreamAfterTrickPlay=r):(e=t.restoreStreamAfterTrickPlay)&&(shaka.log.debug("Restoring non-trick-mode stream",e),t.restoreStreamAfterTrickPlay=null,this.switchInternal_(e,!0,0,!1)))}},shaka.media.StreamingEngine.prototype.switchVariant=function(e,t,r,n,a){t=void 0!==t&&t,r=void 0===r?0:r,n=void 0!==n&&n,a=void 0!==a&&a,this.currentVariant_=e,this.startupComplete_&&(e.video&&this.switchInternal_(e.video,t,r,n,a),e.audio&&this.switchInternal_(e.audio,t,r,n,a))},shaka.media.StreamingEngine.prototype.switchTextStream=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return r.currentTextStream_=e,r.startupComplete_?(t=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(e&&e.type==t.TEXT,"Wrong stream type passed to switchTextStream!"),e.segmentIndex?n.jumpTo(2):n.yield(e.createSegmentIndex(),2)):n.return();r.switchInternal_(e,!0,0,!1),n.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.reloadTextStream=function(){var e=this.mediaStates_.get(shaka.util.ManifestParserUtils.ContentType.TEXT);e&&this.switchInternal_(e.stream,!0,0,!0)},shaka.media.StreamingEngine.prototype.switchInternal_=function(e,t,r,n,a){var i=this,o=shaka.util.ManifestParserUtils.ContentType,s=this.mediaStates_.get(e.type);s||e.type!=o.TEXT?(goog.asserts.assert(s,"switch: expected mediaState to exist"),s&&(s.restoreStreamAfterTrickPlay&&(shaka.log.debug("switch during trick play mode",e),e.trickModeVideo?(s.restoreStreamAfterTrickPlay=e,e=e.trickModeVideo,shaka.log.debug("switch found trick play stream",e)):(s.restoreStreamAfterTrickPlay=null,shaka.log.debug("switch found no special trick play stream"))),s.stream!=e||n?(this.audioPrefetchMap_.has(e)?s.segmentPrefetch=this.audioPrefetchMap_.get(e):s.segmentPrefetch&&s.segmentPrefetch.switchStream(e),e.type==o.TEXT&&(n=shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs),this.playerInterface_.mediaSourceEngine.reinitText(n,this.manifest_.sequenceMode,e.external)),this.audioPrefetchMap_.has(s.stream)||s.stream.closeSegmentIndex&&s.stream.closeSegmentIndex(),s.stream=e,s.segmentIterator=null,s.adaptation=!!a,e=shaka.media.StreamingEngine.logPrefix_(s),shaka.log.debug("switch: switching to Stream "+e),t&&(s.clearingBuffer?s.waitingToFlushBuffer=!0:s.performingUpdate?(s.waitingToClearBuffer=!0,s.clearBufferSafeMargin=r,s.waitingToFlushBuffer=!0):(this.cancelUpdate_(s),this.clearBuffer_(s,!0,r).catch((function(e){i.playerInterface_&&(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),i.playerInterface_.onError(e))})))),this.makeAbortDecision_(s).catch((function(e){i.playerInterface_&&(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),i.playerInterface_.onError(e))}))):(t=shaka.media.StreamingEngine.logPrefix_(s),shaka.log.debug("switch: Stream "+t+" already active")))):this.loadNewTextStream_(e)},shaka.media.StreamingEngine.prototype.makeAbortDecision_=function(e){var t,r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?e.operation?(t=e.stream,r=e.operation,t.segmentIndex?a.jumpTo(2):a.yield(t.createSegmentIndex(),2)):a.return():e.operation!=r||e.stream!=t?a.return():(goog.asserts.assert(e.stream.segmentIndex,"Segment index should exist by now!"),n.shouldAbortCurrentRequest_(e)&&(shaka.log.info("Aborting current segment request."),e.operation.abort()),void a.jumpToEnd())}))},shaka.media.StreamingEngine.prototype.shouldAbortCurrentRequest_=function(e){goog.asserts.assert(e.operation,"Abort logic requires an ongoing operation!"),goog.asserts.assert(e.stream&&e.stream.segmentIndex,"Abort logic requires a segment index");var t=this.playerInterface_.getPresentationTime(),r=this.playerInterface_.mediaSourceEngine.bufferEnd(e.type),n=this.getTimeNeeded_(e,t),a=null==(n=e.stream.segmentIndex.find(n))?null:e.stream.segmentIndex.get(n);return n=a?a.getSize():null,a&&!n&&(n=(a.getEndTime()-a.getStartTime())*(e.stream.bandwidth||0)/8),!!n&&((a=a.initSegmentReference)&&(n+=a.getSize()||0),8*n/(a=this.playerInterface_.getBandwidthEstimate())<(r||0)-t-Math.max(this.manifest_.minBufferTime||0,this.config_.rebufferingGoal)||e.operation.getBytesRemaining()>n)},shaka.media.StreamingEngine.prototype.seeked=function(){if(this.playerInterface_){for(var e=this.playerInterface_.getPresentationTime(),t=shaka.util.ManifestParserUtils.ContentType,r=!1,n=$jscomp.makeIterator(this.mediaStates_.keys()),a=n.next();!a.done;a=n.next()){a=a.value;var i=this.mediaStates_.get(a),o=shaka.media.StreamingEngine.logPrefix_(i),s=null;i.segmentIterator&&(s=i.segmentIterator.current()),(!s||s.startTime>e||s.endTime<e)&&(i.segmentIterator=null),this.playerInterface_.mediaSourceEngine.isBuffered(a,e)||((null!=this.playerInterface_.mediaSourceEngine.bufferEnd(a)||i.performingUpdate)&&(this.forceClearBuffer_(i),r=!0),i.operation&&(i.operation.abort(),shaka.log.debug(o,"Aborting operation due to seek"),i.operation=null),a===t.TEXT&&this.playerInterface_.mediaSourceEngine.resetCaptionParser(),i.seeked=!0)}r||shaka.log.debug("(all): seeked: buffered seek: presentationTime="+e)}},shaka.media.StreamingEngine.prototype.forceClearBuffer_=function(e){var t=this,r=shaka.media.StreamingEngine.logPrefix_(e);e.clearingBuffer?shaka.log.debug(r,"clear: already clearing the buffer"):e.waitingToClearBuffer?shaka.log.debug(r,"clear: already waiting"):e.performingUpdate?(shaka.log.debug(r,"clear: currently updating"),e.waitingToClearBuffer=!0,e.clearBufferSafeMargin=0):null==this.playerInterface_.mediaSourceEngine.bufferStart(e.type)?(shaka.log.debug(r,"clear: nothing buffered"),null==e.updateTimer&&this.scheduleUpdate_(e,0)):(shaka.log.debug(r,"clear: handling right now"),this.cancelUpdate_(e),this.clearBuffer_(e,!1,0).catch((function(e){t.playerInterface_&&(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),t.playerInterface_.onError(e))})))},shaka.media.StreamingEngine.prototype.initStreams_=function(e){var t,r,n,a,i,o,s,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){if(1==p.nextAddress){if(t=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(d.config_,"StreamingEngine configure() must be called before init()!"),!d.currentVariant_)throw shaka.log.error("init: no Streams chosen"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STREAMING,shaka.util.Error.Code.STREAMING_ENGINE_STARTUP_INVALID_STATE);return r=new Map,n=new Set,d.currentVariant_.audio&&(r.set(t.AUDIO,d.currentVariant_.audio),n.add(d.currentVariant_.audio)),d.currentVariant_.video&&(r.set(t.VIDEO,d.currentVariant_.video),n.add(d.currentVariant_.video)),d.currentTextStream_&&(r.set(t.TEXT,d.currentTextStream_),n.add(d.currentTextStream_)),a=d.playerInterface_.mediaSourceEngine,p.yield(a.init(r,d.manifest_.sequenceMode,d.manifest_.type,d.manifest_.ignoreManifestTimestampsInSegmentsMode),2)}for(d.destroyer_.ensureNotDestroyed(),d.updateDuration(),i=$jscomp.makeIterator(r.keys()),o=i.next();!o.done;o=i.next())s=o.value,l=r.get(s),d.mediaStates_.has(s)||(u=d.createMediaState_(l),e.has(l.id)&&((c=e.get(l.id)).replaceFetchDispatcher((function(e,t,r){return d.dispatchFetch_(e,t,r)})),u.segmentPrefetch=c),d.mediaStates_.set(s,u),d.scheduleUpdate_(u,0));p.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.createMediaState_=function(e){return{stream:e,type:e.type,segmentIterator:null,segmentPrefetch:this.createSegmentPrefetch_(e),lastSegmentReference:null,lastInitSegmentReference:null,lastTimestampOffset:null,lastAppendWindowStart:null,lastAppendWindowEnd:null,restoreStreamAfterTrickPlay:null,endOfStream:!1,performingUpdate:!1,updateTimer:null,waitingToClearBuffer:!1,clearBufferSafeMargin:0,waitingToFlushBuffer:!1,clearingBuffer:!1,seeked:!0,recovering:!1,hasError:!1,operation:null}},shaka.media.StreamingEngine.prototype.createSegmentPrefetch_=function(e){var t=this,r=shaka.util.ManifestParserUtils.ContentType;if(e.type===r.VIDEO&&this.config_.disableVideoPrefetch||e.type===r.AUDIO&&this.config_.disableAudioPrefetch)return null;var n=shaka.util.MimeUtils,a=n.CEA608_CLOSED_CAPTION_MIMETYPE;return n=n.CEA708_CLOSED_CAPTION_MIMETYPE,e.type===r.TEXT&&(e.mimeType==a||e.mimeType==n)||e.type===r.TEXT&&this.config_.disableTextPrefetch?null:this.audioPrefetchMap_.has(e)?this.audioPrefetchMap_.get(e):(r=(r=this.mediaStates_.get(e.type))&&r.segmentPrefetch)&&e===r.getStream()?r:0<this.config_.segmentPrefetchLimit?new shaka.media.SegmentPrefetch(this.config_.segmentPrefetchLimit,e,(function(e,r,n){return t.dispatchFetch_(e,r,n)})):null},shaka.media.StreamingEngine.prototype.updatePrefetchMapForAudio_=function(){for(var e=this.config_.segmentPrefetchLimit,t=this.config_.prefetchAudioLanguages,r=shaka.util.LanguageUtils,n={},a=$jscomp.makeIterator(this.manifest_.variants),i=a.next();!i.done;n={$jscomp$loop$prop$variant$881:n.$jscomp$loop$prop$variant$881},i=a.next())if(n.$jscomp$loop$prop$variant$881=i.value,n.$jscomp$loop$prop$variant$881.audio)if(this.audioPrefetchMap_.has(n.$jscomp$loop$prop$variant$881.audio)){if((i=this.audioPrefetchMap_.get(n.$jscomp$loop$prop$variant$881.audio)).resetLimit(e),!(0<e&&t.some(function(e){return function(t){return r.areLanguageCompatible(e.$jscomp$loop$prop$variant$881.audio.language,t)}}(n)))){var o=this.mediaStates_.get(n.$jscomp$loop$prop$variant$881.audio.type);i!==(o&&o.segmentPrefetch)&&i.clearAll(),this.audioPrefetchMap_.delete(n.$jscomp$loop$prop$variant$881.audio)}}else 0>=e||!t.some(function(e){return function(t){return r.areLanguageCompatible(e.$jscomp$loop$prop$variant$881.audio.language,t)}}(n))||!(i=this.createSegmentPrefetch_(n.$jscomp$loop$prop$variant$881.audio))||(n.$jscomp$loop$prop$variant$881.audio.segmentIndex||n.$jscomp$loop$prop$variant$881.audio.createSegmentIndex(),this.audioPrefetchMap_.set(n.$jscomp$loop$prop$variant$881.audio,i))},shaka.media.StreamingEngine.prototype.updateDuration=function(){var e=this.manifest_.presentationTimeline.getDuration();1/0>e?this.playerInterface_.mediaSourceEngine.setDuration(e):this.playerInterface_.mediaSourceEngine.setDuration(this.config_.infiniteLiveStreamDuration?1/0:Math.pow(2,32))},shaka.media.StreamingEngine.prototype.onUpdate_=function(e){var t,r,n,a,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:if(s.destroyer_.ensureNotDestroyed(),t=shaka.media.StreamingEngine.logPrefix_(e),goog.asserts.assert(!e.performingUpdate&&null!=e.updateTimer,t+" unexpected call to onUpdate_()"),e.performingUpdate||null==e.updateTimer)return l.return();if(goog.asserts.assert(!e.clearingBuffer,t+" onUpdate_() should not be called when clearing the buffer"),e.clearingBuffer)return l.return();if(e.updateTimer=null,!e.waitingToClearBuffer){l.jumpTo(2);break}return shaka.log.debug(t,"skipping update and clearing the buffer"),l.yield(s.clearBuffer_(e,e.waitingToFlushBuffer,e.clearBufferSafeMargin),3);case 3:return l.return();case 2:if(e.stream.segmentIndex){l.jumpTo(4);break}return r=e.stream,l.yield(e.stream.createSegmentIndex(),5);case 5:if(r!=e.stream)return r.closeSegmentIndex&&(goog.asserts.assert(!e.stream.segmentIndex,"mediastate.stream should not have segmentIndex yet."),r.closeSegmentIndex()),e.performingUpdate||e.updateTimer||s.scheduleUpdate_(e,0),l.return();case 4:l.setCatchFinallyBlocks(6),null!=(n=s.update_(e))&&(s.scheduleUpdate_(e,n),e.hasError=!1),l.leaveTryBlock(7);break;case 6:return a=l.enterCatchBlock(),l.yield(s.handleStreamingError_(e,a),8);case 8:return l.return();case 7:if(i=Array.from(s.mediaStates_.values()),!s.startupComplete_||!i.every((function(e){return e.endOfStream}))){l.jumpTo(0);break}return shaka.log.v1(t,"calling endOfStream()..."),l.yield(s.playerInterface_.mediaSourceEngine.endOfStream(),10);case 10:s.destroyer_.ensureNotDestroyed(),0!=(o=s.playerInterface_.mediaSourceEngine.getDuration())&&o<s.manifest_.presentationTimeline.getDuration()&&s.manifest_.presentationTimeline.setDuration(o),l.jumpToEnd()}}))},shaka.media.StreamingEngine.prototype.update_=function(e){goog.asserts.assert(this.manifest_,"manifest_ should not be null"),goog.asserts.assert(this.config_,"config_ should not be null");var t=shaka.util.ManifestParserUtils.ContentType;if(shaka.media.StreamingEngine.isEmbeddedText_(e))return this.playerInterface_.mediaSourceEngine.setSelectedClosedCaptionId(e.stream.originalId||""),null;if(e.type==t.TEXT&&this.playerInterface_.mediaSourceEngine.clearSelectedClosedCaptionId(),!this.playerInterface_.mediaSourceEngine.isStreamingAllowed()&&e.type!=t.TEXT)return this.config_.updateIntervalSeconds/2;var r=shaka.media.StreamingEngine.logPrefix_(e),n=this.playerInterface_.getPresentationTime();if(e.type===t.AUDIO)for(var a=$jscomp.makeIterator(this.audioPrefetchMap_.keys()),i=a.next();!i.done;i=a.next())(i=this.audioPrefetchMap_.get(i.value)).evict(n,!0),i.prefetchSegmentsByTime(n);a=this.getTimeNeeded_(e,n),shaka.log.v2(r,"timeNeeded="+a),i=this.playerInterface_.mediaSourceEngine.bufferedAheadOf(e.type,n),shaka.log.v2(r,"update_:","presentationTime="+n,"bufferedAhead="+i);var o=Math.max(1,Math.max(this.manifest_.minBufferTime||0,this.config_.rebufferingGoal,this.config_.bufferingGoal)*this.bufferingGoalScale_),s=this.manifest_.presentationTimeline.getDuration()-a,l=this.playerInterface_.mediaSourceEngine.bufferEnd(e.type);if(1e-6>s&&l)return shaka.log.debug(r,"buffered to end of presentation"),e.endOfStream=!0,e.type==t.VIDEO&&(e=this.mediaStates_.get(t.TEXT))&&shaka.media.StreamingEngine.isEmbeddedText_(e)&&(e.endOfStream=!0),null;if(e.endOfStream=!1,i>=o)return shaka.log.v2(r,"buffering goal met"),this.config_.updateIntervalSeconds/2;if(!(t=this.getSegmentReferenceNeeded_(e,n,l)))return this.config_.updateIntervalSeconds;for(i=1/0,o=Array.from(this.mediaStates_.values()),s=(o=$jscomp.makeIterator(o)).next();!s.done;s=o.next())s=s.value,shaka.media.StreamingEngine.isEmbeddedText_(s)||s.segmentIterator&&!s.segmentIterator.current()||(s=this.getTimeNeeded_(s,n),i=Math.min(i,s));return a>=i+(o=this.manifest_.presentationTimeline.getMaxSegmentDuration()*shaka.media.StreamingEngine.MAX_RUN_AHEAD_SEGMENTS_)?(shaka.log.v2(r,"waiting for other streams to buffer"),this.config_.updateIntervalSeconds):(e.segmentPrefetch&&e.segmentIterator&&!this.audioPrefetchMap_.has(e.stream)&&(e.segmentPrefetch.evict(n),e.segmentPrefetch.prefetchSegmentsByTime(t.startTime)),this.fetchAndAppend_(e,n,t).catch((function(){})),null)},shaka.media.StreamingEngine.prototype.getTimeNeeded_=function(e,t){return e.lastSegmentReference?e.lastSegmentReference.endTime:t},shaka.media.StreamingEngine.prototype.getSegmentReferenceNeeded_=function(e,t,r){var n=shaka.media.StreamingEngine.logPrefix_(e);if(goog.asserts.assert(e.stream.segmentIndex,"segment index should have been generated already"),e.segmentIterator)return e.segmentIterator.current();if(e.lastSegmentReference||r)return t=e.lastSegmentReference?e.lastSegmentReference.endTime:r,goog.asserts.assert(null!=t,"Should have a time to search"),shaka.log.v1(n,"looking up segment from new stream endTime:",t),r=0>this.playerInterface_.getPlaybackRate(),e.segmentIterator=e.stream.segmentIndex.getIteratorForTime(t,!1,r),null==(e=e.segmentIterator&&e.segmentIterator.next().value)&&shaka.log.warning(n,"cannot find segment","endTime:",t),e;r=this.config_.inaccurateManifestTolerance;var a=Math.max(t-r,0);shaka.log.v1(n,"looking up segment","lookupTime:",a,"presentationTime:",t);var i=0>this.playerInterface_.getPlaybackRate(),o=null;return r&&(e.segmentIterator=e.stream.segmentIndex.getIteratorForTime(a,!1,i),o=e.segmentIterator&&e.segmentIterator.next().value),o||(e.segmentIterator=e.stream.segmentIndex.getIteratorForTime(t,!1,i),o=e.segmentIterator&&e.segmentIterator.next().value),null==o&&shaka.log.warning(n,"cannot find segment","lookupTime:",a,"presentationTime:",t),o},shaka.media.StreamingEngine.prototype.fetchAndAppend_=function(e,t,r){var n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(T){switch(T.nextAddress){case 1:if(n=shaka.util.ManifestParserUtils.ContentType,a=shaka.media.StreamingEngine,i=a.logPrefix_(e),shaka.log.v1(i,"fetchAndAppend_:","presentationTime="+t,"reference.startTime="+r.startTime,"reference.endTime="+r.endTime),o=e.stream,s=e.segmentIterator,e.performingUpdate=!0,T.setCatchFinallyBlocks(2),r.getStatus()==shaka.media.SegmentReference.Status.MISSING)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.SEGMENT_MISSING);return T.yield(b.initSourceBuffer_(e,r),4);case 4:return b.destroyer_.ensureNotDestroyed(),b.fatalError_?T.return():(shaka.log.v2(i,"fetching segment"),l="video/mp4"==o.mimeType||"audio/mp4"==o.mimeType,u=window.ReadableStream,b.config_.lowLatencyMode&&u&&l&&(b.manifest_.type!=shaka.media.ManifestParser.HLS||r.hasByterangeOptimization())?(p=new Uint8Array(0),f=h=!1,g=function(n){var a,i,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:if(h)return l.return();if(f=!0,b.destroyer_.ensureNotDestroyed(),b.fatalError_)return l.return();if(l.setCatchFinallyBlocks(2),p=b.concatArray_(p,n),a=!1,i=0,(new shaka.util.Mp4Parser).box("mdat",(function(e){i=e.size+e.start,a=!0})).parse(p,!1,!0),!a){l.jumpTo(4);break}return s=p.subarray(0,i),p=p.subarray(i),l.yield(b.append_(e,t,o,r,s,!0),5);case 5:e.segmentPrefetch&&e.segmentIterator&&e.segmentPrefetch.prefetchSegmentsByTime(r.startTime,!0);case 4:l.leaveTryBlock(0);break;case 2:m=l.enterCatchBlock(),l.jumpToEnd()}}))},T.yield(b.fetch_(e,r,g),9)):(b.config_.lowLatencyMode&&!u&&shaka.log.warning("Low latency streaming mode is enabled, but ReadableStream is not supported by the browser."),c=b.fetch_(e,r),T.yield(c,7)));case 7:return d=T.yieldResult,b.destroyer_.ensureNotDestroyed(),b.fatalError_?T.return():(b.destroyer_.ensureNotDestroyed(),e.waitingToClearBuffer?(shaka.log.info(i,"waitingToClearBuffer, skip append"),e.performingUpdate=!1,b.scheduleUpdate_(e,0),T.return()):T.yield(b.append_(e,t,o,r,d),6));case 9:if(y=T.yieldResult,m)throw m;if(f){T.jumpTo(10);break}return h=!0,b.destroyer_.ensureNotDestroyed(),b.fatalError_?T.return():e.waitingToClearBuffer?(shaka.log.info(i,"waitingToClearBuffer, skip append"),e.performingUpdate=!1,b.scheduleUpdate_(e,0),T.return()):T.yield(b.append_(e,t,o,r,y),10);case 10:e.segmentPrefetch&&e.segmentIterator&&e.segmentPrefetch.prefetchSegmentsByTime(r.startTime,!0);case 6:if(b.destroyer_.ensureNotDestroyed(),b.fatalError_)return T.return();e.lastSegmentReference=r,v=s.next().value,shaka.log.v2(i,"advancing to next segment",v),e.performingUpdate=!1,e.recovering=!1,_=b.playerInterface_.mediaSourceEngine.getBufferedInfo(),k=_[e.type],shaka.log.v1(i,"finished fetch and append",JSON.stringify(k)),e.waitingToClearBuffer||b.playerInterface_.onSegmentAppended(r,e.stream),b.scheduleUpdate_(e,0),T.leaveTryBlock(0);break;case 2:if(E=T.enterCatchBlock(),b.destroyer_.ensureNotDestroyed(E),b.fatalError_)return T.return();if(goog.asserts.assert(E instanceof shaka.util.Error,"Should only receive a Shaka error"),e.performingUpdate=!1,E.code==shaka.util.Error.Code.OPERATION_ABORTED)e.performingUpdate=!1,b.cancelUpdate_(e),b.scheduleUpdate_(e,0),T.jumpTo(0);else if(e.type==n.TEXT&&b.config_.ignoreTextStreamFailures)E.code==shaka.util.Error.Code.BAD_HTTP_STATUS?shaka.log.warning(i,"Text stream failed to download. Proceeding without it."):shaka.log.warning(i,"Text stream failed to parse. Proceeding without it."),b.mediaStates_.delete(n.TEXT),T.jumpTo(0);else{if(E.code!=shaka.util.Error.Code.QUOTA_EXCEEDED_ERROR)return shaka.log.error(i,"failed fetch and append: code="+E.code),e.hasError=!0,E.category==shaka.util.Error.Category.NETWORK&&e.segmentPrefetch&&e.segmentPrefetch.removeReference(r),E.severity=shaka.util.Error.Severity.CRITICAL,T.yield(b.handleStreamingError_(e,E),0);b.handleQuotaExceeded_(e,E),T.jumpTo(0)}}}))},shaka.media.StreamingEngine.prototype.aesDecrypt_=function(e,t,r){var n,a,i,o,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress)return(n=t).cryptoKey?l.jumpTo(2):(goog.asserts.assert(n.fetchKey,"If AES cryptoKey was not preloaded, fetchKey function should be provided"),l.yield(n.fetchKey(),3));if(2!=l.nextAddress&&goog.asserts.assert(n.cryptoKey,"AES cryptoKey should now be set"),!(a=n.iv))for(a=shaka.util.BufferUtils.toUint8(new ArrayBuffer(16)),i=n.firstMediaSequenceNumber+r,o=a.byteLength-1;0<=o;o--)a[o]=255&i,i>>=8;return s="CBC"==t.blockCipherMode?{name:"AES-CBC",iv:a}:{name:"AES-CTR",counter:a,length:64},l.return(window.crypto.subtle.decrypt(s,n.cryptoKey,e))}))},shaka.media.StreamingEngine.prototype.retry=function(e){if(this.destroyer_.destroyed())return shaka.log.error("Unable to retry after StreamingEngine is destroyed!"),!1;if(this.fatalError_)return shaka.log.error("Unable to retry after StreamingEngine encountered a fatal error!"),!1;for(var t=$jscomp.makeIterator(this.mediaStates_.values()),r=t.next();!r.done;r=t.next()){r=r.value;var n=shaka.media.StreamingEngine.logPrefix_(r);!r.hasError||r.performingUpdate||r.updateTimer||(shaka.log.info(n,"Retrying after failure..."),r.hasError=!1,this.scheduleUpdate_(r,e))}return!0},shaka.media.StreamingEngine.prototype.concatArray_=function(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r},shaka.media.StreamingEngine.prototype.handleQuotaExceeded_=function(e,t){var r=shaka.media.StreamingEngine.logPrefix_(e);if(Array.from(this.mediaStates_.values()).some((function(t){return t!=e&&t.recovering})))shaka.log.debug(r,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{if(0<this.config_.maxDisabledTime&&this.playerInterface_.disableStream(e.stream,this.config_.maxDisabledTime))return;var n=Math.round(100*this.bufferingGoalScale_);if(20<n)this.bufferingGoalScale_-=.2;else{if(!(4<n))return shaka.log.error(r,"MediaSource threw QuotaExceededError too many times"),this.fatalError_=e.hasError=!0,void this.playerInterface_.onError(t);this.bufferingGoalScale_-=.04}shaka.log.warning(r,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*this.bufferingGoalScale_))+"%"),e.recovering=!0}this.scheduleUpdate_(e,4)},shaka.media.StreamingEngine.prototype.initSourceBuffer_=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(v){switch(v.nextAddress){case 1:if(r=shaka.util.ManifestParserUtils.ContentType,n=shaka.util.MimeUtils,a=shaka.media.StreamingEngine,i=a.logPrefix_(e),o=[],s=Math.max(0,t.appendWindowStart-a.APPEND_WINDOW_START_FUDGE_),l=t.appendWindowEnd+a.APPEND_WINDOW_END_FUDGE_,goog.asserts.assert(t.startTime<=l,i+" segment should start before append window end"),u=n.getCodecBase(e.stream.codecs),c=n.getBasicType(e.stream.mimeType),(d=t.timestampOffset)==e.lastTimestampOffset&&s==e.lastAppendWindowStart&&l==e.lastAppendWindowEnd&&u==e.lastCodecs&&c==e.lastMimeType){v.jumpTo(2);break}if(shaka.log.v1(i,"setting timestamp offset to "+d),shaka.log.v1(i,"setting append window start to "+s),shaka.log.v1(i,"setting append window end to "+l),!(e.lastCodecs&&e.lastMimeType&&y.playerInterface_.mediaSourceEngine.isResetMediaSourceNecessary(e.type,e.stream,c,u))){v.jumpTo(3);break}if(p=null,e.type===r.VIDEO?p=y.mediaStates_.get(r.AUDIO):e.type===r.AUDIO&&(p=y.mediaStates_.get(r.VIDEO)),!p){v.jumpTo(3);break}return v.yield(y.abortOperations_(p).catch((function(){})),5);case 5:p.lastInitSegmentReference=null,y.forceClearBuffer_(p);case 3:return h=function(){var n,a,i;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){if(1==o.nextAddress)return n=new Map,y.currentVariant_.audio&&n.set(r.AUDIO,y.currentVariant_.audio),y.currentVariant_.video&&n.set(r.VIDEO,y.currentVariant_.video),o.setCatchFinallyBlocks(2),e.lastAppendWindowStart=s,e.lastAppendWindowEnd=l,e.lastCodecs=u,e.lastMimeType=c,e.lastTimestampOffset=d,a=y.manifest_.sequenceMode||y.manifest_.type==shaka.media.ManifestParser.HLS,o.yield(y.playerInterface_.mediaSourceEngine.setStreamProperties(e.type,d,s,l,a,t.mimeType||e.stream.mimeType,t.codecs||e.stream.codecs,n),4);if(2!=o.nextAddress)return o.leaveTryBlock(0);throw i=o.enterCatchBlock(),e.lastAppendWindowStart=null,e.lastAppendWindowEnd=null,e.lastCodecs=null,e.lastTimestampOffset=null,i}))},v.yield(h(),2);case 2:return shaka.media.InitSegmentReference.equal(t.initSegmentReference,e.lastInitSegmentReference)||(e.lastInitSegmentReference=t.initSegmentReference,t.isIndependent()&&t.initSegmentReference&&(shaka.log.v1(i,"fetching init segment"),f=y.fetch_(e,t.initSegmentReference),m=function(){var n,a,o,s,l,u,c,d,p;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){switch(h.nextAddress){case 1:return h.setCatchFinallyBlocks(2),h.yield(f,4);case 4:return n=h.yieldResult,y.destroyer_.ensureNotDestroyed(),a=null,o=new Map,s={projection:null,hfov:null},l=new shaka.util.Mp4Parser,u=shaka.util.Mp4Parser,c=shaka.util.Mp4BoxParsers,l.box("moov",u.children).box("trak",u.children).box("mdia",u.children).fullBox("mdhd",(function(e){goog.asserts.assert(null!=e.version,"MDHD is a full box and should have a valid version."),a=c.parseMDHD(e.reader,e.version).timescale})).box("hdlr",(function(e){switch(c.parseHDLR(e.reader).handlerType){case"soun":o.set(r.AUDIO,a);break;case"vide":o.set(r.VIDEO,a)}a=null})).box("minf",u.children).box("stbl",u.children).fullBox("stsd",u.sampleDescription).box("encv",u.visualSampleEntry).box("avc1",u.visualSampleEntry).box("avc3",u.visualSampleEntry).box("hev1",u.visualSampleEntry).box("hvc1",u.visualSampleEntry).box("dvav",u.visualSampleEntry).box("dva1",u.visualSampleEntry).box("dvh1",u.visualSampleEntry).box("dvhe",u.visualSampleEntry).box("vexu",u.children).box("proj",u.children).fullBox("prji",(function(e){e=c.parsePRJI(e.reader),s.projection=e.projection})).box("hfov",(function(e){e=c.parseHFOV(e.reader),s.hfov=e.hfov})).parse(n),y.updateSpatialVideoInfo_(s),o.has(e.type)?t.initSegmentReference.timescale=o.get(e.type):null!=a&&(t.initSegmentReference.timescale=a),shaka.log.v1(i,"appending init segment"),d=e.stream.closedCaptions&&0<e.stream.closedCaptions.size,h.yield(y.playerInterface_.beforeAppendSegment(e.type,n),5);case 5:return h.yield(y.playerInterface_.mediaSourceEngine.appendBuffer(e.type,n,null,e.stream,d),6);case 6:h.leaveTryBlock(0);break;case 2:throw p=h.enterCatchBlock(),e.lastInitSegmentReference=null,p}}))},y.playerInterface_.onInitSegmentAppended(t.startTime,t.initSegmentReference),o.push(m()))),y.manifest_.sequenceMode&&(g=e.lastSegmentReference?e.lastSegmentReference.discontinuitySequence:null,t.discontinuitySequence!=g&&o.push(y.playerInterface_.mediaSourceEngine.resync(e.type,t.startTime))),v.yield(Promise.all(o),0)}}))},shaka.media.StreamingEngine.prototype.append_=function(e,t,r,n,a,i){i=void 0!==i&&i;var o,s,l,u,c,d,p,h=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(f){switch(f.nextAddress){case 1:return o=shaka.media.StreamingEngine.logPrefix_(e),s=r.closedCaptions&&0<r.closedCaptions.size,u=null!=r.emsgSchemeIdUris&&0<r.emsgSchemeIdUris.length||h.config_.dispatchAllEmsgBoxes,c=h.config_.parsePrftBox&&!h.parsedPrftEventRaised_,(u||c)&&(l=new shaka.util.Mp4Parser),u&&l.fullBox("emsg",(function(e){return h.parseEMSG_(n,r.emsgSchemeIdUris,e)})),c&&l.fullBox("prft",(function(e){return h.parsePrft_(n,e)})),(u||c)&&l.parse(a),f.yield(h.evict_(e,t),2);case 2:return h.destroyer_.ensureNotDestroyed(),d=e.seeked,e.seeked=!1,p=e.adaptation,e.adaptation=!1,f.yield(h.playerInterface_.beforeAppendSegment(e.type,a),3);case 3:return f.yield(h.playerInterface_.mediaSourceEngine.appendBuffer(e.type,a,n,r,s,d,p,i),4);case 4:h.destroyer_.ensureNotDestroyed(),shaka.log.v2(o,"appended media segment"),f.jumpToEnd()}}))},shaka.media.StreamingEngine.prototype.parseEMSG_=function(e,t,r){if(0===r.version)var n=r.reader.readTerminatedString(),a=r.reader.readTerminatedString(),i=r.reader.readUint32(),o=r.reader.readUint32(),s=r.reader.readUint32(),l=r.reader.readUint32(),u=e.startTime+o/i;else i=r.reader.readUint32(),o=(u=r.reader.readUint64()/i+e.timestampOffset)-e.startTime,s=r.reader.readUint32(),l=r.reader.readUint32(),n=r.reader.readTerminatedString(),a=r.reader.readTerminatedString();r=r.reader.readBytes(r.reader.getLength()-r.reader.getPosition()),(t&&t.includes(n)||this.config_.dispatchAllEmsgBoxes)&&("urn:mpeg:dash:event:2012"==n?this.playerInterface_.onManifestUpdate():(i={startTime:u,endTime:u+s/i,schemeIdUri:n,value:a,timescale:i,presentationTimeDelta:o,eventDuration:s,id:l,messageData:r},t=shaka.util.FakeEvent.EventName.Emsg,i=(new Map).set("detail",i),(t=new shaka.util.FakeEvent(t,i)).cancelable=!0,this.playerInterface_.onEvent(t),t.defaultPrevented||"https://aomedia.org/emsg/ID3"!=n&&"https://developer.apple.com/streaming/emsg-id3"!=n||(!(n=shaka.util.Id3Utils.getID3Frames(r)).length||!e)||this.playerInterface_.onMetadata([{cueTime:e.startTime,data:r,frames:n,dts:e.startTime,pts:e.startTime}],0,e.endTime)))},shaka.media.StreamingEngine.prototype.parsePrft_=function(e,t){if(!this.parsedPrftEventRaised_&&e.initSegmentReference.timescale){goog.asserts.assert(0==t.version||1==t.version,"PRFT version can only be 0 or 1"),t=shaka.util.Mp4BoxParsers.parsePRFTInaccurate(t.reader,t.version),e=e.initSegmentReference.timescale;var r=this.convertNtp(t.ntpTimestamp);e={wallClockTime:r,programStartDate:new Date(r-t.mediaTime/e*1e3)},t=shaka.util.FakeEvent.EventName.Prft,e=(new Map).set("detail",e),t=new shaka.util.FakeEvent(t,e),this.playerInterface_.onEvent(t),this.parsedPrftEventRaised_=!0}},shaka.media.StreamingEngine.prototype.convertNtp=function(e){var t=new Date(Date.UTC(1900,0,1,0,0,0));return new Date(t.getTime()+e).getTime()},shaka.media.StreamingEngine.prototype.evict_=function(e,t){var r,n,a,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress)return r=shaka.media.StreamingEngine.logPrefix_(e),shaka.log.v2(r,"checking buffer length"),n=Math.max(s.config_.bufferBehind,s.manifest_.presentationTimeline.getMaxSegmentDuration()),null==(a=s.playerInterface_.mediaSourceEngine.bufferStart(e.type))?(shaka.log.v2(r,"buffer behind okay because nothing buffered:","presentationTime="+t,"bufferBehind="+n),l.return()):(o=(i=t-a)-n)<=s.config_.evictionGoal?(shaka.log.v2(r,"buffer behind okay:","presentationTime="+t,"bufferedBehind="+i,"bufferBehind="+n,"evictionGoal="+s.config_.evictionGoal,"underflow="+Math.abs(o)),l.return()):(shaka.log.v1(r,"buffer behind too large:","presentationTime="+t,"bufferedBehind="+i,"bufferBehind="+n,"evictionGoal="+s.config_.evictionGoal,"overflow="+o),l.yield(s.playerInterface_.mediaSourceEngine.remove(e.type,a,a+o),2));s.destroyer_.ensureNotDestroyed(),shaka.log.v1(r,"evicted "+o+" seconds"),l.jumpToEnd()}))},shaka.media.StreamingEngine.isEmbeddedText_=function(e){var t=shaka.util.MimeUtils,r=t.CEA608_CLOSED_CAPTION_MIMETYPE;return t=t.CEA708_CLOSED_CAPTION_MIMETYPE,e&&e.type==shaka.util.ManifestParserUtils.ContentType.TEXT&&(e.stream.mimeType==r||e.stream.mimeType==t)},shaka.media.StreamingEngine.prototype.fetch_=function(e,t,r){var n,a,i,o,s,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){switch(u.nextAddress){case 1:return(n=t.getSegmentData())?u.return(n):(a=null,e.segmentPrefetch&&(a=e.segmentPrefetch.getPrefetchedSegment(t,r)),a||(a=l.dispatchFetch_(t,e.stream,r)),i=0,e.segmentIterator&&(i=e.segmentIterator.currentPosition()),e.operation=a,u.yield(a.promise,2));case 2:if(o=u.yieldResult,e.operation=null,s=o.data,!t.aesKey){u.jumpTo(3);break}return u.yield(l.aesDecrypt_(s,t.aesKey,i),4);case 4:s=u.yieldResult;case 3:return u.return(s)}}))},shaka.media.StreamingEngine.prototype.dispatchFetch_=function(e,t,r){return goog.asserts.assert(this.playerInterface_.netEngine,"Must have net engine"),shaka.media.StreamingEngine.dispatchFetch(e,t,r||null,this.config_.retryParameters,this.playerInterface_.netEngine)},shaka.media.StreamingEngine.dispatchFetch=function(e,t,r,n,a){var i=shaka.net.NetworkingEngine.RequestType.SEGMENT,o=e instanceof shaka.media.SegmentReference?e:void 0,s=o?shaka.net.NetworkingEngine.AdvancedRequestType.MEDIA_SEGMENT:shaka.net.NetworkingEngine.AdvancedRequestType.INIT_SEGMENT;return(r=shaka.util.Networking.createSegmentRequest(e.getUris(),e.startByte,e.endByte,n,r)).contentType=t.type,shaka.log.v2("fetching: reference=",e),a.request(i,r,{type:s,stream:t,segment:o})},shaka.media.StreamingEngine.prototype.clearBuffer_=function(e,t,r){var n,a,i,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return 1==s.nextAddress?(n=shaka.media.StreamingEngine.logPrefix_(e),goog.asserts.assert(!e.performingUpdate&&null==e.updateTimer,n+" unexpected call to clearBuffer_()"),e.waitingToClearBuffer=!1,e.waitingToFlushBuffer=!1,e.clearBufferSafeMargin=0,e.clearingBuffer=!0,e.lastSegmentReference=null,e.lastInitSegmentReference=null,e.segmentIterator=null,shaka.log.debug(n,"clearing buffer"),e.segmentPrefetch&&!o.audioPrefetchMap_.has(e.stream)&&e.segmentPrefetch.clearAll(),r?(a=o.playerInterface_.getPresentationTime(),i=o.playerInterface_.mediaSourceEngine.getDuration(),s.yield(o.playerInterface_.mediaSourceEngine.remove(e.type,a+r,i),3)):s.yield(o.playerInterface_.mediaSourceEngine.clear(e.type),4)):3!=s.nextAddress?(o.destroyer_.ensureNotDestroyed(),t?s.yield(o.playerInterface_.mediaSourceEngine.flush(e.type),3):s.jumpTo(3)):(o.destroyer_.ensureNotDestroyed(),shaka.log.debug(n,"cleared buffer"),e.clearingBuffer=!1,e.endOfStream=!1,e.performingUpdate||e.updateTimer||o.scheduleUpdate_(e,0),void s.jumpToEnd())}))},shaka.media.StreamingEngine.prototype.scheduleUpdate_=function(e,t){var r=this,n=shaka.media.StreamingEngine.logPrefix_(e),a=e.type;a!=shaka.util.ManifestParserUtils.ContentType.TEXT||this.mediaStates_.has(a)?(shaka.log.v2(n,"updating in "+t+" seconds"),goog.asserts.assert(null==e.updateTimer,n+" did not expect update to be scheduled"),e.updateTimer=new shaka.util.DelayedTick((function(){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(n.setCatchFinallyBlocks(2),n.yield(r.onUpdate_(e),4)):2!=n.nextAddress?n.leaveTryBlock(0):(t=n.enterCatchBlock(),r.playerInterface_&&r.playerInterface_.onError(t),void n.jumpToEnd())}))})).tickAfter(t)):shaka.log.v1(n,"Text stream is unloaded. No update is needed.")},shaka.media.StreamingEngine.prototype.cancelUpdate_=function(e){null!=e.updateTimer&&(e.updateTimer.stop(),e.updateTimer=null)},shaka.media.StreamingEngine.prototype.abortOperations_=function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return e.operation?t.yield(e.operation.abort(),0):t.jumpTo(0)}))},shaka.media.StreamingEngine.prototype.handleStreamingError_=function(e,t){var r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress)return a.yield(n.failureCallbackBackoff_.attempt(),2);n.destroyer_.ensureNotDestroyed(),r=n.getDisabledTime_(t),t.category===shaka.util.Error.Category.NETWORK&&0<r&&(t.handled=n.playerInterface_.disableStream(e.stream,r),t.handled&&(t.severity=shaka.util.Error.Severity.RECOVERABLE)),n.playerInterface_.onError(t),t.handled||n.config_.failureCallback(t),a.jumpToEnd()}))},shaka.media.StreamingEngine.prototype.getDisabledTime_=function(e){return 0===this.config_.maxDisabledTime&&e.code==shaka.util.Error.Code.SEGMENT_MISSING?1:this.config_.maxDisabledTime},shaka.media.StreamingEngine.prototype.resetMediaSource=function(){var e,t,r,n,a,i,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return 1==s.nextAddress?(e=Date.now()/1e3,t=o.config_.minTimeBetweenRecoveries,!o.config_.allowMediaSourceRecoveries||e-o.lastMediaSourceReset_<t?s.return(!1):(o.lastMediaSourceReset_=e,r=shaka.util.ManifestParserUtils.ContentType,(n=o.mediaStates_.get(r.AUDIO))&&(n.lastInitSegmentReference=null,o.forceClearBuffer_(n),o.abortOperations_(n).catch((function(){}))),(a=o.mediaStates_.get(r.VIDEO))&&(a.lastInitSegmentReference=null,o.forceClearBuffer_(a),o.abortOperations_(a).catch((function(){}))),i=new Map,o.currentVariant_.audio&&i.set(r.AUDIO,o.currentVariant_.audio),o.currentVariant_.video&&i.set(r.VIDEO,o.currentVariant_.video),s.yield(o.playerInterface_.mediaSourceEngine.reset(i),2))):s.return(!0)}))},shaka.media.StreamingEngine.prototype.updateSpatialVideoInfo_=function(e){if(this.spatialVideoInfo_.projection!=e.projection||this.spatialVideoInfo_.hfov!=e.hfov){var t=shaka.util.FakeEvent.EventName;if(null!=e.projection||null!=e.hfov){t=t.SpatialVideoInfoEvent;var r=(new Map).set("detail",e);t=new shaka.util.FakeEvent(t,r)}else t=new shaka.util.FakeEvent(t.NoSpatialVideoInfoEvent);t.cancelable=!0,this.playerInterface_.onEvent(t),this.spatialVideoInfo_=e}},shaka.media.StreamingEngine.prototype.updateSegmentIteratorReverse_=function(){var e=shaka.util.ManifestParserUtils.ContentType,t=0>this.playerInterface_.getPlaybackRate(),r=this.mediaStates_.get(e.VIDEO);r&&r.segmentIterator&&r.segmentIterator.setReverse(t),(r=this.mediaStates_.get(e.AUDIO))&&r.segmentIterator&&r.segmentIterator.setReverse(t),(e=this.mediaStates_.get(e.TEXT))&&e.segmentIterator&&e.segmentIterator.setReverse(t)},shaka.media.StreamingEngine.logPrefix_=function(e){return"("+e.type+":"+e.stream.id+")"},shaka.media.StreamingEngine.APPEND_WINDOW_START_FUDGE_=.1,shaka.media.StreamingEngine.APPEND_WINDOW_END_FUDGE_=.01,shaka.media.StreamingEngine.MAX_RUN_AHEAD_SEGMENTS_=1,shaka.util.ConfigUtils=function(){},shaka.util.ConfigUtils.mergeConfigObjects=function(e,t,r,n,a){goog.asserts.assert(e,"Destination config must not be null!");var i,o=a in n,s=!0;for(i in t){var l=a+"."+i,u=o?n[a]:r[i];o||i in r?void 0===t[i]?void 0===u||o?delete e[i]:e[i]=shaka.util.ObjectUtils.cloneObject(u):u.constructor==Object&&t[i]&&t[i].constructor==Object?(e[i]||(e[i]=shaka.util.ObjectUtils.cloneObject(u)),l=shaka.util.ConfigUtils.mergeConfigObjects(e[i],t[i],u,n,l),s=s&&l):typeof t[i]!=typeof u||null==t[i]||"function"!=typeof t[i]&&t[i].constructor!=u.constructor?(shaka.log.alwaysError("Invalid config, wrong type for "+l),s=!1):("function"==typeof r[i]&&r[i].length!=t[i].length&&shaka.log.alwaysWarn("Unexpected number of arguments for "+l),e[i]=t[i]):(shaka.log.alwaysError("Invalid config, unrecognized key "+l),s=!1)}return s},shaka.util.ConfigUtils.convertToConfigObject=function(e,t){for(var r={},n=r,a=0,i=0;!(0>(a=e.indexOf(".",a)));)0!=a&&"\\"==e[a-1]||(n[i=e.substring(i,a).replace(/\\\./g,".")]={},n=n[i],i=a+1),a+=1;return n[e.substring(i).replace(/\\\./g,".")]=t,r},shaka.util.ConfigUtils.referenceParametersAndReturn=function(e,t){return e&&t},goog.exportSymbol("shaka.util.ConfigUtils",shaka.util.ConfigUtils),goog.exportProperty(shaka.util.ConfigUtils,"convertToConfigObject",shaka.util.ConfigUtils.convertToConfigObject),goog.exportProperty(shaka.util.ConfigUtils,"mergeConfigObjects",shaka.util.ConfigUtils.mergeConfigObjects),shaka.util.FairPlayUtils=function(){},shaka.util.FairPlayUtils.isFairPlaySupported=function(){var e;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},t.setCatchFinallyBlocks(2),t.yield(navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):2!=t.nextAddress?t.return(!0):(t.enterCatchBlock(),t.return(!1))}))},shaka.util.FairPlayUtils.defaultGetContentId=function(e){return e=shaka.util.StringUtils.fromBytesAutoDetect(e),new goog.Uri(e).getDomain()},shaka.util.FairPlayUtils.initDataTransform=function(e,t,r){if(!r||!r.byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.DRM,shaka.util.Error.Code.SERVER_CERTIFICATE_REQUIRED);t="string"==typeof t?shaka.util.StringUtils.toUTF16(t,!0):t,e=shaka.util.StringUtils.fromBytesAutoDetect(e),e=shaka.util.StringUtils.toUTF16(e,!0);var n=new Uint8Array(12+e.byteLength+t.byteLength+r.byteLength),a=0,i=function(e){shaka.util.BufferUtils.toDataView(n).setUint32(a,e.byteLength,!0),a+=4,n.set(shaka.util.BufferUtils.toUint8(e),a),a+=e.byteLength};return i(e),i(t),i(r),goog.asserts.assert(a==n.length,"Inconsistent init data length"),n},shaka.util.FairPlayUtils.basicInitDataTransform_=function(e,t,r){if("skd"!==t)return e;t=shaka.util.FairPlayUtils,r=r.serverCertificate;var n=shaka.util.StringUtils.fromBytesAutoDetect(e).split("skd://").pop();return t.initDataTransform(e,n,r)},shaka.util.FairPlayUtils.verimatrixInitDataTransform=function(e,t,r){return shaka.util.FairPlayUtils.basicInitDataTransform_(e,t,r)},shaka.util.FairPlayUtils.ezdrmInitDataTransform=function(e,t,r){if("skd"!==t)return e;t=shaka.util.FairPlayUtils,r=r.serverCertificate;var n=shaka.util.StringUtils.fromBytesAutoDetect(e).split(";").pop();return t.initDataTransform(e,n,r)},shaka.util.FairPlayUtils.conaxInitDataTransform=function(e,t,r){if("skd"!==t)return e;t=shaka.util.FairPlayUtils,r=r.serverCertificate;var n=shaka.util.StringUtils.fromBytesAutoDetect(e).split("skd://").pop().split("?").shift();n=window.atob(n);var a=new ArrayBuffer(2*n.length);a=shaka.util.BufferUtils.toUint16(a);for(var i=0,o=n.length;i<o;i++)a[i]=n.charCodeAt(i);return t.initDataTransform(e,a,r)},shaka.util.FairPlayUtils.expressplayInitDataTransform=function(e,t,r){return shaka.util.FairPlayUtils.basicInitDataTransform_(e,t,r)},shaka.util.FairPlayUtils.verimatrixFairPlayRequest=function(e,t,r){e===shaka.net.NetworkingEngine.RequestType.LICENSE&&(e=shaka.util.BufferUtils.toUint8(t.body),e=shaka.util.Uint8ArrayUtils.toBase64(e),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=shaka.util.StringUtils.toUTF8("spc="+e))},shaka.util.FairPlayUtils.octetStreamFairPlayRequest_=function(e,t,r){e===shaka.net.NetworkingEngine.RequestType.LICENSE&&(t.headers["Content-Type"]="application/octet-stream")},shaka.util.FairPlayUtils.ezdrmFairPlayRequest=function(e,t,r){shaka.util.FairPlayUtils.octetStreamFairPlayRequest_(e,t)},shaka.util.FairPlayUtils.conaxFairPlayRequest=function(e,t,r){shaka.util.FairPlayUtils.octetStreamFairPlayRequest_(e,t)},shaka.util.FairPlayUtils.expressplayFairPlayRequest=function(e,t,r){shaka.util.FairPlayUtils.octetStreamFairPlayRequest_(e,t)},shaka.util.FairPlayUtils.commonFairPlayResponse=function(e,t,r){if(e===shaka.net.NetworkingEngine.RequestType.LICENSE){try{var n=shaka.util.StringUtils.fromUTF8(t.data)}catch(e){return}e=!1,"<ckc>"===(n=n.trim()).substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6),e=!0);try{var a=JSON.parse(n);a.ckc&&(n=a.ckc,e=!0),a.CkcMessage&&(n=a.CkcMessage,e=!0),a.License&&(n=a.License,e=!0)}catch(e){}e&&(t.data=shaka.util.BufferUtils.toArrayBuffer(shaka.util.Uint8ArrayUtils.fromBase64(n)))}},goog.exportSymbol("shaka.util.FairPlayUtils",shaka.util.FairPlayUtils),goog.exportProperty(shaka.util.FairPlayUtils,"commonFairPlayResponse",shaka.util.FairPlayUtils.commonFairPlayResponse),goog.exportProperty(shaka.util.FairPlayUtils,"expressplayFairPlayRequest",shaka.util.FairPlayUtils.expressplayFairPlayRequest),goog.exportProperty(shaka.util.FairPlayUtils,"conaxFairPlayRequest",shaka.util.FairPlayUtils.conaxFairPlayRequest),goog.exportProperty(shaka.util.FairPlayUtils,"ezdrmFairPlayRequest",shaka.util.FairPlayUtils.ezdrmFairPlayRequest),goog.exportProperty(shaka.util.FairPlayUtils,"verimatrixFairPlayRequest",shaka.util.FairPlayUtils.verimatrixFairPlayRequest),goog.exportProperty(shaka.util.FairPlayUtils,"expressplayInitDataTransform",shaka.util.FairPlayUtils.expressplayInitDataTransform),goog.exportProperty(shaka.util.FairPlayUtils,"conaxInitDataTransform",shaka.util.FairPlayUtils.conaxInitDataTransform),goog.exportProperty(shaka.util.FairPlayUtils,"ezdrmInitDataTransform",shaka.util.FairPlayUtils.ezdrmInitDataTransform),goog.exportProperty(shaka.util.FairPlayUtils,"verimatrixInitDataTransform",shaka.util.FairPlayUtils.verimatrixInitDataTransform),goog.exportProperty(shaka.util.FairPlayUtils,"initDataTransform",shaka.util.FairPlayUtils.initDataTransform),goog.exportProperty(shaka.util.FairPlayUtils,"defaultGetContentId",shaka.util.FairPlayUtils.defaultGetContentId),goog.exportProperty(shaka.util.FairPlayUtils,"isFairPlaySupported",shaka.util.FairPlayUtils.isFairPlaySupported),shaka.util.PlayerConfiguration=function(){},shaka.util.PlayerConfiguration.createDefault=function(){var e=1/0;navigator.connection&&navigator.connection.saveData&&(e=360);var t={retryParameters:shaka.net.NetworkingEngine.defaultRetryParameters(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function(e,t,r){return shaka.util.Platform.isMediaKeysPolyfilled()&&"skd"==t&&(t=r.serverCertificate,r=shaka.util.FairPlayUtils.defaultGetContentId(e),e=shaka.util.FairPlayUtils.initDataTransform(e,r,t)),e},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:shaka.util.Platform.isXboxOne(),minHdcpVersion:"",ignoreDuplicateInitData:!shaka.util.Platform.isTizen2()};(shaka.util.Platform.isXboxOne()||shaka.util.Platform.isPS4())&&t.preferredKeySystems.push("com.microsoft.playready");var r=shaka.config.CodecSwitchingStrategy.RELOAD,n=!1;shaka.util.Platform.supportsSmoothCodecSwitching()&&(r=shaka.config.CodecSwitchingStrategy.SMOOTH,n=!0),n={retryParameters:shaka.net.NetworkingEngine.defaultRetryParameters(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,dash:{clockSyncUri:"",ignoreDrmInfo:!1,disableXlinkProcessing:!1,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"},manifestPreprocessor:shaka.util.PlayerConfiguration.defaultManifestPreprocessor,manifestPreprocessorTXml:shaka.util.PlayerConfiguration.defaultManifestPreprocessorTXml,sequenceMode:!1,enableAudioGroups:!1,multiTypeVariantsAllowed:n,useStreamOnceInPeriodFlattening:!1,updatePeriod:-1},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,ignoreManifestProgramDateTimeForTypes:[],mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',useSafariBehaviorForLive:!0,liveSegmentsDelay:3,sequenceMode:shaka.util.Platform.supportsSequenceMode(),ignoreManifestTimestampsInSegmentsMode:!1,disableCodecGuessing:!1,allowLowLatencyByteRangeOptimization:!0},mss:{manifestPreprocessor:shaka.util.PlayerConfiguration.defaultManifestPreprocessor,manifestPreprocessorTXml:shaka.util.PlayerConfiguration.defaultManifestPreprocessorTXml,sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}};var a={retryParameters:shaka.net.NetworkingEngine.defaultRetryParameters(),failureCallback:function(e){return shaka.log.error("Unhandled streaming error",e),shaka.util.ConfigUtils.referenceParametersAndReturn([e],void 0)},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,evictionGoal:1,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0,useNativeHlsForFairPlay:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,autoLowLatencyMode:!1,forceHTTPS:!1,preferNativeHls:!1,updateIntervalSeconds:1,dispatchAllEmsgBoxes:!1,observeQualityChanges:!1,maxDisabledTime:30,parsePrftBox:!1,segmentPrefetchLimit:0,prefetchAudioLanguages:[],disableAudioPrefetch:!1,disableTextPrefetch:!1,disableVideoPrefetch:!1,liveSync:!1,liveSyncMaxLatency:1,liveSyncPlaybackRate:1.1,liveSyncMinLatency:0,liveSyncMinPlaybackRate:.95,liveSyncPanicMode:!1,liveSyncPanicThreshold:60,allowMediaSourceRecoveries:!0,minTimeBetweenRecoveries:5,vodDynamicPlaybackRate:!1,vodDynamicPlaybackRateLowBufferRate:.95,vodDynamicPlaybackRateBufferRatio:.5,infiniteLiveStreamDuration:!1,loadTimeout:30};(shaka.util.Platform.isWebOS()||shaka.util.Platform.isTizen()||shaka.util.Platform.isChromecast()||shaka.util.Platform.isHisense())&&(a.stallSkip=0);var i={trackSelectionCallback:function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return t.return(e)}))},downloadSizeCallback:function(e){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?navigator.storage&&navigator.storage.estimate?r.yield(navigator.storage.estimate(),3):r.return(!0):(t=r.yieldResult,r.return(t.usage+e<.95*t.quota))}))},progressCallback:function(e,t){return shaka.util.ConfigUtils.referenceParametersAndReturn([e,t],void 0)},usePersistentLicense:!0,numberOfParallelDownloads:5};e={enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:e,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0},r={codecSwitchingStrategy:r,addExtraFeaturesToSourceBuffer:function(e){return shaka.util.ConfigUtils.referenceParametersAndReturn([e],"")},forceTransmux:!1,insertFakeEncryptionInInit:!0,modifyCueCallback:function(e,t){return shaka.util.ConfigUtils.referenceParametersAndReturn([e,t],void 0)}};var o=!1;(shaka.util.Platform.isWebOS()||shaka.util.Platform.isTizen()||shaka.util.Platform.isChromecast()||shaka.util.Platform.isHisense()||shaka.util.Platform.isPS5()||shaka.util.Platform.isPS4()||shaka.util.Platform.isXboxOne())&&(o=!0);var s={drm:t,manifest:n,streaming:a,mediaSource:r,offline:i,abrFactory:function(){return new shaka.abr.SimpleAbrManager},abr:e,autoShowText:shaka.config.AutoShowText.IF_SUBTITLES_MAY_BE_NEEDED,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoLayout:"",preferredVideoLabel:"",preferredVideoCodecs:[],preferredAudioCodecs:[],preferForcedSubs:!1,preferSpatialAudio:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayer:{captionsUpdatePeriod:.25},textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",rtpSafetyFactor:5,useHeaders:!1,includeKeys:[]},cmsd:{enabled:!0,applyMaximumSuggestedBitrate:!0,estimatedThroughputWeightRatio:.5},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1},ads:{customPlayheadTracker:!1,skipPlayDetection:o}};return i.trackSelectionCallback=function(e){return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return t.return(shaka.util.PlayerConfiguration.defaultTrackSelect(e,s.preferredAudioLanguage,s.preferredVideoHdrLevel))}))},s},shaka.util.PlayerConfiguration.mergeConfigObjects=function(e,t,r){var n={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:""}};return shaka.util.ConfigUtils.mergeConfigObjects(e,t,r||shaka.util.PlayerConfiguration.createDefault(),n,"")},shaka.util.PlayerConfiguration.defaultTrackSelect=function(e,t,r){var n=shaka.util.ManifestParserUtils.ContentType,a=shaka.util.LanguageUtils,i=r;"AUTO"==i&&(i=window.matchMedia("(color-gamut: p3)").matches?"PQ":"SDR");var o=e.filter((function(e){return!("variant"!=e.type||e.hdr&&e.hdr!=i)}));r=[];var s=a.findClosestLocale(t,o.map((function(e){return e.language})));s&&(r=o.filter((function(e){return a.normalize(e.language)==s}))),0==r.length&&(r=o.filter((function(e){return e.primary}))),0==r.length&&(1<new Set(o.map((function(e){return e.language}))).size&&shaka.log.warning("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),r=o);var l=r.filter((function(e){return e.height&&480>=e.height}));for(l.length&&(l.sort((function(e,t){return goog.asserts.assert(null!=e.height,"Null height"),goog.asserts.assert(null!=t.height,"Null height"),t.height-e.height})),r=l.filter((function(e){return e.height==l[0].height}))),t=[],r.length&&(o=Math.floor(r.length/2),r.sort((function(e,t){return e.bandwidth-t.bandwidth})),t.push(r[o])),r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=r.value).type!=n.TEXT&&r.type!=n.IMAGE||t.push(r);return t},shaka.util.PlayerConfiguration.defaultManifestPreprocessor=function(e){return shaka.util.ConfigUtils.referenceParametersAndReturn([e],e)},shaka.util.PlayerConfiguration.defaultManifestPreprocessorTXml=function(e){return shaka.util.ConfigUtils.referenceParametersAndReturn([e],e)},goog.exportSymbol("shaka.util.PlayerConfiguration",shaka.util.PlayerConfiguration),goog.exportProperty(shaka.util.PlayerConfiguration,"mergeConfigObjects",shaka.util.PlayerConfiguration.mergeConfigObjects),goog.exportProperty(shaka.util.PlayerConfiguration,"createDefault",shaka.util.PlayerConfiguration.createDefault),shaka.media.PreloadManager=function(e,t,r,n,a){shaka.util.FakeEventTarget.call(this),this.assetUri_=e,this.mimeType_=t,this.networkingEngine_=a.networkingEngine,this.startTime_=n,this.currentAdaptationSetCriteria_=null,this.startTimeOfLoad_=r,this.startTimeOfDrm_=0,this.createDrmEngine_=a.createDrmEngine,this.manifestFilterer_=a.manifestFilterer,this.manifestPlayerInterface_=a.manifestPlayerInterface,this.config_=a.config,this.parser_=this.parserFactory_=this.manifest_=null,this.parserEntrusted_=!1,this.regionTimeline_=a.regionTimeline,this.regionTimelineEntrusted_=!1,this.drmEngine_=null,this.drmEngineEntrusted_=!1,this.abrManager_=this.abrManagerFactory_=null,this.abrManagerEntrusted_=!1,this.segmentPrefetchById_=new Map,this.segmentPrefetchEntrusted_=!1,this.qualityObserver_=a.qualityObserver,this.stats_=new shaka.util.Stats,this.successPromise_=new shaka.util.PublicPromise,this.eventHandoffTarget_=null,this.destroyed_=!1,this.allowPrefetch_=a.allowPrefetch,this.prefetchedVariant_=null,this.allowMakeAbrManager_=a.allowMakeAbrManager,this.hasBeenAttached_=!1,this.queuedOperations_=[],this.latePhaseQueuedOperations_=[]},$jscomp.inherits(shaka.media.PreloadManager,shaka.util.FakeEventTarget),shaka.media.PreloadManager.prototype.addQueuedOperation=function(e,t){(e=e?this.latePhaseQueuedOperations_:this.queuedOperations_)?e.push(t):t()},shaka.media.PreloadManager.prototype.stopQueuingLatePhaseQueuedOperations=function(){if(this.latePhaseQueuedOperations_)for(var e=$jscomp.makeIterator(this.latePhaseQueuedOperations_),t=e.next();!t.done;t=e.next())(t=t.value)();this.latePhaseQueuedOperations_=null},shaka.media.PreloadManager.prototype.setEventHandoffTarget=function(e){if(this.eventHandoffTarget_=e,this.hasBeenAttached_=!0,this.queuedOperations_)for(var t=(e=$jscomp.makeIterator(this.queuedOperations_)).next();!t.done;t=e.next())(t=t.value)();this.queuedOperations_=null},shaka.media.PreloadManager.prototype.getStartTime=function(){return this.startTime_},shaka.media.PreloadManager.prototype.getStartTimeOfLoad=function(){return this.startTimeOfLoad_},shaka.media.PreloadManager.prototype.getStartTimeOfDRM=function(){return this.startTimeOfDrm_},shaka.media.PreloadManager.prototype.getMimeType=function(){return this.mimeType_},shaka.media.PreloadManager.prototype.getAssetUri=function(){return this.assetUri_},shaka.media.PreloadManager.prototype.getManifest=function(){return this.manifest_},shaka.media.PreloadManager.prototype.getParserFactory=function(){return this.parserFactory_},shaka.media.PreloadManager.prototype.getCurrentAdaptationSetCriteria=function(){return this.currentAdaptationSetCriteria_},shaka.media.PreloadManager.prototype.getAbrManagerFactory=function(){return this.abrManagerFactory_},shaka.media.PreloadManager.prototype.receiveAbrManager=function(){return this.abrManagerEntrusted_=!0,this.abrManager_},shaka.media.PreloadManager.prototype.getAbrManager=function(){return this.abrManager_},shaka.media.PreloadManager.prototype.receiveParser=function(){return this.parserEntrusted_=!0,this.parser_},shaka.media.PreloadManager.prototype.getParser=function(){return this.parser_},shaka.media.PreloadManager.prototype.receiveRegionTimeline=function(){return this.regionTimelineEntrusted_=!0,this.regionTimeline_},shaka.media.PreloadManager.prototype.getRegionTimeline=function(){return this.regionTimeline_},shaka.media.PreloadManager.prototype.getQualityObserver=function(){return this.qualityObserver_},shaka.media.PreloadManager.prototype.getStats=function(){return this.stats_},shaka.media.PreloadManager.prototype.getManifestFilterer=function(){return this.manifestFilterer_},shaka.media.PreloadManager.prototype.receiveDrmEngine=function(){return this.drmEngineEntrusted_=!0,this.drmEngine_},shaka.media.PreloadManager.prototype.getDrmEngine=function(){return this.drmEngine_},shaka.media.PreloadManager.prototype.getPrefetchedVariant=function(){return this.prefetchedVariant_},shaka.media.PreloadManager.prototype.receiveSegmentPrefetchesById=function(){return this.segmentPrefetchEntrusted_=!0,this.segmentPrefetchById_},shaka.media.PreloadManager.prototype.attachAbrManager=function(e,t){this.abrManager_=e,this.abrManagerFactory_=t},shaka.media.PreloadManager.prototype.attachAdaptationSetCriteria=function(e){this.currentAdaptationSetCriteria_=e},shaka.media.PreloadManager.prototype.attachManifest=function(e,t,r){this.manifest_=e,this.parser_=t,this.parserFactory_=r},shaka.media.PreloadManager.prototype.start=function(){var e,t=this;$jscomp.asyncExecutePromiseGeneratorProgram((function(r){switch(r.nextAddress){case 1:return r.yield(Promise.resolve(),2);case 2:return r.setCatchFinallyBlocks(3),r.yield(t.parseManifestInner_(),5);case 5:return t.throwIfDestroyed_(),r.yield(t.initializeDrmInner_(),6);case 6:return t.throwIfDestroyed_(),r.yield(t.chooseInitialVariantInner_(),7);case 7:t.throwIfDestroyed_(),t.successPromise_.resolve(),r.leaveTryBlock(0);break;case 3:e=r.enterCatchBlock(),t.successPromise_.reject(e),r.jumpToEnd()}}))},shaka.media.PreloadManager.prototype.dispatchEvent=function(e){return this.eventHandoffTarget_?this.eventHandoffTarget_.dispatchEvent(e):shaka.util.FakeEventTarget.prototype.dispatchEvent.call(this,e)},shaka.media.PreloadManager.prototype.onError=function(e){e.severity===shaka.util.Error.Severity.CRITICAL&&(this.successPromise_.reject(e),this.destroy());var t=this.makeEvent_(shaka.util.FakeEvent.EventName.Error,(new Map).set("detail",e));this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)},shaka.media.PreloadManager.prototype.throwIfDestroyed_=function(){if(this.isDestroyed())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OBJECT_DESTROYED)},shaka.media.PreloadManager.prototype.makeStateChangeEvent_=function(e){this.dispatchEvent(new shaka.util.FakeEvent(shaka.util.FakeEvent.EventName.OnStateChange,(new Map).set("state",e)))},shaka.media.PreloadManager.prototype.makeEvent_=function(e,t){return new shaka.util.FakeEvent(e,t)},shaka.media.PreloadManager.prototype.parseManifestInner_=function(){var e,t,r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){if(1==o.nextAddress)return i.makeStateChangeEvent_("manifest-parser"),i.parser_||(i.parserFactory_=shaka.media.ManifestParser.getFactory(i.assetUri_,i.mimeType_),goog.asserts.assert(i.parserFactory_,"Must have manifest parser"),i.parser_=i.parserFactory_(),i.parser_.configure(i.config_.manifest)),e=Date.now()/1e3,i.makeStateChangeEvent_("manifest"),i.manifest_?o.jumpTo(2):(t=i,o.yield(i.parser_.start(i.assetUri_,i.manifestPlayerInterface_),3));if(2!=o.nextAddress&&(t.manifest_=o.yieldResult),r=i.makeEvent_(shaka.util.FakeEvent.EventName.ManifestParsed),i.dispatchEvent(r),0==i.manifest_.variants.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.NO_VARIANTS);shaka.media.PreloadManager.filterForAVVariants_(i.manifest_),n=Date.now()/1e3,a=n-e,i.stats_.setManifestTime(a),o.jumpToEnd()}))},shaka.media.PreloadManager.prototype.initializeDrmInner_=function(){var e,t,r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){switch(a.nextAddress){case 1:if(goog.asserts.assert(n.manifest_,"The manifest should already be parsed."),n.makeStateChangeEvent_("drm-engine"),n.startTimeOfDrm_=Date.now()/1e3,n.drmEngine_=n.createDrmEngine_(),n.manifestFilterer_.setDrmEngine(n.drmEngine_),n.drmEngine_.configure(n.config_.drm),!n.manifestFilterer_.applyRestrictions(n.manifest_)){a.jumpTo(2);break}return e=n.makeEvent_(shaka.util.FakeEvent.EventName.TracksChanged),a.yield(Promise.resolve(),3);case 3:n.throwIfDestroyed_(),n.dispatchEvent(e);case 2:return t=shaka.util.StreamUtils.getPlayableVariants(n.manifest_.variants),a.yield(n.drmEngine_.initForPlayback(t,n.manifest_.offlineSessionIds),4);case 4:return n.throwIfDestroyed_(),a.yield(n.manifestFilterer_.filterManifest(n.manifest_),5);case 5:if(!a.yieldResult){a.jumpTo(0);break}return r=n.makeEvent_(shaka.util.FakeEvent.EventName.TracksChanged),a.yield(Promise.resolve(),7);case 7:n.dispatchEvent(r),a.jumpToEnd()}}))},shaka.media.PreloadManager.prototype.reconfigure=function(e){this.config_=e},shaka.media.PreloadManager.prototype.configure=function(e,t){e=shaka.util.ConfigUtils.convertToConfigObject(e,t),shaka.util.PlayerConfiguration.mergeConfigObjects(this.config_,e)},shaka.media.PreloadManager.prototype.getConfiguration=function(){return shaka.util.ObjectUtils.cloneObject(this.config_)},shaka.media.PreloadManager.prototype.chooseInitialVariantInner_=function(){if(goog.asserts.assert(this.manifest_,"The manifest should already be parsed."),this.currentAdaptationSetCriteria_||(this.currentAdaptationSetCriteria_=new shaka.media.PreferenceBasedCriteria(this.config_.preferredAudioLanguage,this.config_.preferredVariantRole,this.config_.preferredAudioChannelCount,this.config_.preferredVideoHdrLevel,this.config_.preferSpatialAudio,this.config_.preferredVideoLayout,this.config_.preferredAudioLabel,this.config_.preferredVideoLabel,this.config_.mediaSource.codecSwitchingStrategy,this.config_.manifest.dash.enableAudioGroups)),this.allowMakeAbrManager_){var e=this.config_.abrFactory;this.abrManagerFactory_=e,this.abrManager_=e(),this.abrManager_.configure(this.config_.abr)}if(this.allowPrefetch_){e=this.manifest_.presentationTimeline.isLive();var t=shaka.util.StreamUtils.getPlayableVariants(this.manifest_.variants);t=this.currentAdaptationSetCriteria_.create(t),this.abrManager_.configure(this.config_.abr),this.abrManager_.setVariants(Array.from(t.values())),(t=this.abrManager_.chooseVariant(!0))&&(this.prefetchedVariant_=t,t.video&&this.makePrefetchForStream_(t.video,e),t.audio&&this.makePrefetchForStream_(t.audio,e))}},shaka.media.PreloadManager.prototype.makePrefetchForStream_=function(e,t){var r,n,a,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress)return r=s.config_.streaming.segmentPrefetchLimit||2,n=new shaka.media.SegmentPrefetch(r,e,(function(e,t,r){return shaka.media.StreamingEngine.dispatchFetch(e,t,r||null,s.config_.streaming.retryParameters,s.networkingEngine_)})),s.segmentPrefetchById_.set(e.id,n),l.yield(e.createSegmentIndex(),2);a=s.startTime_||0,(o=(i=e.segmentIndex.getIteratorForTime(a))?i.current():null)||(o=e.segmentIndex.get(0)),o&&(t?o.initSegmentReference&&n.prefetchInitSegment(o.initSegmentReference):n.prefetchSegmentsByTime(o.startTime)),l.jumpToEnd()}))},shaka.media.PreloadManager.prototype.waitForFinish=function(){return this.successPromise_},shaka.media.PreloadManager.prototype.destroy=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){switch(n.nextAddress){case 1:if(r.destroyed_=!0,!r.parser_||r.parserEntrusted_){n.jumpTo(2);break}return n.yield(r.parser_.stop(),2);case 2:if(!r.abrManager_||r.abrManagerEntrusted_){n.jumpTo(4);break}return n.yield(r.abrManager_.stop(),4);case 4:if(r.regionTimeline_&&!r.regionTimelineEntrusted_&&r.regionTimeline_.release(),!r.drmEngine_||r.drmEngineEntrusted_){n.jumpTo(6);break}return n.yield(r.drmEngine_.destroy(),6);case 6:if(0<r.segmentPrefetchById_.size&&!r.segmentPrefetchEntrusted_)for(e=$jscomp.makeIterator(r.segmentPrefetchById_.values()),t=e.next();!t.done;t=e.next())t.value.clearAll();n.jumpToEnd()}}))},shaka.media.PreloadManager.prototype.isDestroyed=function(){return this.destroyed_},shaka.media.PreloadManager.prototype.hasBeenAttached=function(){return this.hasBeenAttached_},shaka.media.PreloadManager.filterForAVVariants_=function(e){var t=function(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")};e.variants.some(t)&&(shaka.log.debug("Found variant with audio and video content, so filtering out audio-only content."),e.variants=e.variants.filter(t))},goog.exportSymbol("shaka.media.PreloadManager",shaka.media.PreloadManager),goog.exportProperty(shaka.media.PreloadManager.prototype,"destroy",shaka.media.PreloadManager.prototype.destroy),goog.exportProperty(shaka.media.PreloadManager.prototype,"waitForFinish",shaka.media.PreloadManager.prototype.waitForFinish),shaka.media.RegionObserver=function(e,t){shaka.util.FakeEventTarget.call(this);var r=this;this.timeline_=e,this.startsPastZero_=t,this.oldPosition_=new Map;var n=shaka.media.RegionObserver.RelativePosition_;e=n.BEFORE_THE_REGION,t=n.IN_THE_REGION,n=n.AFTER_THE_REGION,this.rules_=[{weWere:null,weAre:t,invoke:function(e,t){return r.onEvent_("enter",e,t)}},{weWere:e,weAre:t,invoke:function(e,t){return r.onEvent_("enter",e,t)}},{weWere:n,weAre:t,invoke:function(e,t){return r.onEvent_("enter",e,t)}},{weWere:t,weAre:e,invoke:function(e,t){return r.onEvent_("exit",e,t)}},{weWere:t,weAre:n,invoke:function(e,t){return r.onEvent_("exit",e,t)}},{weWere:e,weAre:n,invoke:function(e,t){return r.onEvent_("skip",e,t)}},{weWere:n,weAre:e,invoke:function(e,t){return r.onEvent_("skip",e,t)}}],this.eventManager_=new shaka.util.EventManager,this.eventManager_.listen(this.timeline_,"regionremove",(function(e){r.oldPosition_.delete(e.region)}))},$jscomp.inherits(shaka.media.RegionObserver,shaka.util.FakeEventTarget),shaka.media.RegionObserver.prototype.release=function(){this.timeline_=null,this.oldPosition_.clear(),this.eventManager_.release(),this.eventManager_=null,shaka.util.FakeEventTarget.prototype.release.call(this)},shaka.media.RegionObserver.prototype.poll=function(e,t){var r=shaka.media.RegionObserver;if(!this.startsPastZero_||0!=e){this.startsPastZero_=!1;for(var n=$jscomp.makeIterator(this.timeline_.regions()),a=n.next();!a.done;a=n.next()){a=a.value;var i=this.oldPosition_.get(a),o=r.determinePositionRelativeTo_(a,e);this.oldPosition_.set(a,o);for(var s=$jscomp.makeIterator(this.rules_),l=s.next();!l.done;l=s.next())(l=l.value).weWere==i&&l.weAre==o&&l.invoke(a,t)}}},shaka.media.RegionObserver.prototype.onEvent_=function(e,t,r){e=new shaka.util.FakeEvent(e,new Map([["region",t],["seeking",r]])),this.dispatchEvent(e)},shaka.media.RegionObserver.determinePositionRelativeTo_=function(e,t){var r=shaka.media.RegionObserver.RelativePosition_;return t<e.startTime?r.BEFORE_THE_REGION:t>e.endTime?r.AFTER_THE_REGION:r.IN_THE_REGION},shaka.media.RegionObserver.RelativePosition_={BEFORE_THE_REGION:1,IN_THE_REGION:2,AFTER_THE_REGION:3},shaka.net.NetworkingUtils=function(){},shaka.net.NetworkingUtils.getMimeType=function(e,t,r){var n,a,i,o,s,l,u;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:return n=shaka.net.NetworkingUtils.getExtension_(e),(a=shaka.net.NetworkingUtils.EXTENSIONS_TO_MIME_TYPES_[n])?c.return(a):(i=shaka.net.NetworkingEngine.RequestType.MANIFEST,o=shaka.net.NetworkingEngine.makeRequest([e],r),c.setCatchFinallyBlocks(2),o.method="HEAD",c.yield(t.request(i,o).promise,4));case 4:s=c.yieldResult,a=s.headers["content-type"],c.leaveTryBlock(3);break;case 2:if(!(l=c.enterCatchBlock())||l.code!=shaka.util.Error.Code.HTTP_ERROR&&l.code!=shaka.util.Error.Code.BAD_HTTP_STATUS){c.jumpTo(3);break}return o.method="GET",c.yield(t.request(i,o).promise,6);case 6:u=c.yieldResult,a=u.headers["content-type"];case 3:return c.return(a?a.toLowerCase().split(";").shift():"")}}))},shaka.net.NetworkingUtils.getExtension_=function(e){return 1==(e=new goog.Uri(e).getPath().split("/").pop().split(".")).length?"":e.pop().toLowerCase()},shaka.net.NetworkingUtils.EXTENSIONS_TO_MIME_TYPES_={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mpd:"application/dash+xml",ism:"application/vnd.ms-sstr+xml",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav",sbv:"text/x-subviewer",srt:"text/srt",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml",lrc:"application/x-subtitle-lrc",ssa:"text/x-ssa",ass:"text/x-ssa"},shaka.text.Utils=function(){},shaka.text.Utils.flattenPayload_=function(e,t){if(e.lineBreak)return"\n";if(e.nestedCues.length)return e.nestedCues.map((function(t){return shaka.text.Utils.flattenPayload_(t,e)})).join("");var r=[],n=e.fontWeight>=shaka.text.Cue.fontWeight.BOLD,a=e.fontStyle==shaka.text.Cue.fontStyle.ITALIC,i=e.textDecoration.includes(shaka.text.Cue.textDecoration.UNDERLINE);return n&&r.push(["b"]),a&&r.push(["i"]),i&&r.push(["u"]),""==(a=e.color)&&t&&(a=t.color),n="",(a=shaka.text.Utils.getColorName_(a))&&(n+="."+a),""==(a=e.backgroundColor)&&t&&(a=t.backgroundColor),(t=shaka.text.Utils.getColorName_(a))&&(n+=".bg_"+t),n&&r.push(["c",n]),r.reduceRight((function(e,t){var r=$jscomp.makeIterator(t);return"<"+(t=r.next().value)+(void 0===(r=r.next().value)?"":r)+">"+e+"</"+t+">"}),e.payload)},shaka.text.Utils.getColorName_=function(e){var t=(e=e.toLowerCase()).replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i);switch(t?e="#"+(256|parseInt(t[1],10)).toString(16).slice(1)+(256|parseInt(t[2],10)).toString(16).slice(1)+(256|parseInt(t[3],10)).toString(16).slice(1):e.startsWith("#")&&7<e.length&&(e=e.slice(0,7)),e){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":case"#ff00ff":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null},shaka.text.Utils.getCuesToFlatten=function(e,t){for(var r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())if((n=n.value).isContainer)r.push.apply(r,$jscomp.arrayFromIterable(shaka.text.Utils.getCuesToFlatten(n.nestedCues,n)));else{var a=n.clone();a.nestedCues=[],a.payload=shaka.text.Utils.flattenPayload_(n,t),r.push(a)}return r},shaka.text.SimpleTextDisplayer=function(e,t){this.textTrack_=null;for(var r=$jscomp.makeIterator(Array.from(e.textTracks)),n=r.next();!n.done;n=r.next())(n=n.value).mode="disabled",n.label==t&&(this.textTrack_=n);this.textTrack_||(this.textTrack_=e.addTextTrack("subtitles",t)),this.textTrack_.mode="hidden"},shaka.text.SimpleTextDisplayer.prototype.configure=function(e){},shaka.text.SimpleTextDisplayer.prototype.remove=function(e,t){return!!this.textTrack_&&(shaka.text.SimpleTextDisplayer.removeWhere_(this.textTrack_,(function(r){return r.startTime<t&&r.endTime>e})),!0)},shaka.text.SimpleTextDisplayer.prototype.append=function(e){var t=shaka.text.Utils.getCuesToFlatten(e),r=[];e=this.textTrack_.cues?Array.from(this.textTrack_.cues):[];for(var n={},a=(t=$jscomp.makeIterator(t)).next();!a.done;n={$jscomp$loop$prop$inCue$883:n.$jscomp$loop$prop$inCue$883},a=t.next())n.$jscomp$loop$prop$inCue$883=a.value,e.some(function(e){return function(t){return t.startTime==e.$jscomp$loop$prop$inCue$883.startTime&&t.endTime==e.$jscomp$loop$prop$inCue$883.endTime&&t.text==e.$jscomp$loop$prop$inCue$883.payload}}(n))||(a=shaka.text.SimpleTextDisplayer.convertToTextTrackCue_(n.$jscomp$loop$prop$inCue$883))&&r.push(a);for(e=r.slice().sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?r.indexOf(t)-r.indexOf(e):r.indexOf(e)-r.indexOf(t)})),n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())this.textTrack_.addCue(n.value)},shaka.text.SimpleTextDisplayer.prototype.destroy=function(){return this.textTrack_&&(shaka.text.SimpleTextDisplayer.removeWhere_(this.textTrack_,(function(e){return!0})),this.textTrack_.mode="disabled"),this.textTrack_=null,Promise.resolve()},shaka.text.SimpleTextDisplayer.prototype.isTextVisible=function(){return"showing"==this.textTrack_.mode},shaka.text.SimpleTextDisplayer.prototype.setTextVisibility=function(e){this.textTrack_.mode=e?"showing":"hidden"},shaka.text.SimpleTextDisplayer.convertToTextTrackCue_=function(e){if(e.startTime>=e.endTime)return shaka.log.warning("Invalid cue times: "+e.startTime+" - "+e.endTime),null;var t=shaka.text.Cue,r=new VTTCue(e.startTime,e.endTime,e.payload);r.lineAlign=e.lineAlign,r.positionAlign=e.positionAlign,e.size&&(r.size=e.size);try{r.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=r.align&&(r.align="middle"),e.writingMode==t.writingMode.VERTICAL_LEFT_TO_RIGHT?r.vertical="lr":e.writingMode==t.writingMode.VERTICAL_RIGHT_TO_LEFT&&(r.vertical="rl"),e.lineInterpretation==t.lineInterpretation.PERCENTAGE&&(r.snapToLines=!1),null!=e.line&&(r.line=e.line),null!=e.position&&(r.position=e.position),r},shaka.text.SimpleTextDisplayer.removeWhere_=function(e,t){var r=e.mode,n="showing"==r?"showing":"hidden";e.mode=n,goog.asserts.assert(e.cues,'Cues should be accessible when mode is set to "'+n+'".');for(var a=(n=$jscomp.makeIterator(Array.from(e.cues))).next();!a.done;a=n.next())(a=a.value)&&t(a)&&e.removeCue(a);e.mode=r},goog.exportSymbol("shaka.text.SimpleTextDisplayer",shaka.text.SimpleTextDisplayer),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"setTextVisibility",shaka.text.SimpleTextDisplayer.prototype.setTextVisibility),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"isTextVisible",shaka.text.SimpleTextDisplayer.prototype.isTextVisible),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"destroy",shaka.text.SimpleTextDisplayer.prototype.destroy),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"append",shaka.text.SimpleTextDisplayer.prototype.append),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"remove",shaka.text.SimpleTextDisplayer.prototype.remove),goog.exportProperty(shaka.text.SimpleTextDisplayer.prototype,"configure",shaka.text.SimpleTextDisplayer.prototype.configure),shaka.text.StubTextDisplayer=function(){},shaka.text.StubTextDisplayer.prototype.configure=function(e){},shaka.text.StubTextDisplayer.prototype.remove=function(e,t){},shaka.text.StubTextDisplayer.prototype.append=function(e){},shaka.text.StubTextDisplayer.prototype.destroy=function(){},shaka.text.StubTextDisplayer.prototype.isTextVisible=function(){return!1},shaka.text.StubTextDisplayer.prototype.setTextVisibility=function(e){},goog.exportSymbol("shaka.text.StubTextDisplayer",shaka.text.StubTextDisplayer),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"setTextVisibility",shaka.text.StubTextDisplayer.prototype.setTextVisibility),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"isTextVisible",shaka.text.StubTextDisplayer.prototype.isTextVisible),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"destroy",shaka.text.StubTextDisplayer.prototype.destroy),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"append",shaka.text.StubTextDisplayer.prototype.append),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"remove",shaka.text.StubTextDisplayer.prototype.remove),goog.exportProperty(shaka.text.StubTextDisplayer.prototype,"configure",shaka.text.StubTextDisplayer.prototype.configure),shaka.util.Dom=function(){},shaka.util.Dom.createHTMLElement=function(e){return document.createElement(e)},shaka.util.Dom.createButton=function(){var e=document.createElement("button");return e.setAttribute("type","button"),e},shaka.util.Dom.asHTMLElement=function(e){return e},shaka.util.Dom.asHTMLCanvasElement=function(e){return e},shaka.util.Dom.asHTMLMediaElement=function(e){return e},shaka.util.Dom.getElementByClassName=function(e,t){return t=t.getElementsByClassName(e),goog.asserts.assert(1==t.length,"Should only be one element with class name "+e),shaka.util.Dom.asHTMLElement(t[0])},shaka.util.Dom.removeAllChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},goog.exportSymbol("shaka.util.Dom",shaka.util.Dom),goog.exportProperty(shaka.util.Dom,"removeAllChildren",shaka.util.Dom.removeAllChildren);shaka.text.UITextDisplayer=function(e,t,r){var n=this;goog.asserts.assert(t,"videoContainer should be valid."),this.isTextVisible_=!1,this.cues_=[],this.video_=e,this.videoContainer_=t,this.aspectRatio_=null,this.textContainer_=shaka.util.Dom.createHTMLElement("div"),this.textContainer_.classList.add("shaka-text-container"),this.textContainer_.style.textAlign="center",this.textContainer_.style.display="flex",this.textContainer_.style.flexDirection="column",this.textContainer_.style.alignItems="center",this.textContainer_.style.justifyContent="flex-end",this.videoContainer_.appendChild(this.textContainer_),r&&r.captionsUpdatePeriod||shaka.Deprecate.deprecateFeature(5,"UITextDisplayer w/ config","Please migrate to initializing UITextDisplayer with a config."),e=r&&r.captionsUpdatePeriod?r.captionsUpdatePeriod:.25,this.captionsTimer_=new shaka.util.Timer((function(){n.video_.paused||n.updateCaptions_()})).tickEvery(e),this.currentCuesMap_=new Map,this.eventManager_=new shaka.util.EventManager,this.eventManager_.listen(document,"fullscreenchange",(function(){n.updateCaptions_(!0)})),this.eventManager_.listen(this.video_,"seeking",(function(){n.updateCaptions_(!0)})),this.eventManager_.listen(this.video_,"resize",(function(){var e=n.video_,t=e.videoWidth;e=e.videoHeight,n.aspectRatio_=t&&e?t/e:null})),this.resizeObserver_=null,"ResizeObserver"in window&&(this.resizeObserver_=new ResizeObserver((function(){n.updateCaptions_(!0)})),this.resizeObserver_.observe(this.textContainer_)),this.regionElements_=new Map},shaka.text.UITextDisplayer.prototype.configure=function(e){this.captionsTimer_&&this.captionsTimer_.tickEvery(e.captionsUpdatePeriod)},shaka.text.UITextDisplayer.prototype.append=function(e){for(var t=[].concat($jscomp.arrayFromIterable(this.cues_)),r={},n=(e=$jscomp.makeIterator(e)).next();!n.done;r={$jscomp$loop$prop$cue$885:r.$jscomp$loop$prop$cue$885},n=e.next())r.$jscomp$loop$prop$cue$885=n.value,t.some(function(e){return function(t){return shaka.text.Cue.equal(t,e.$jscomp$loop$prop$cue$885)}}(r))||this.cues_.push(r.$jscomp$loop$prop$cue$885);this.updateCaptions_()},shaka.text.UITextDisplayer.prototype.destroy=function(){return this.textContainer_?(this.videoContainer_.removeChild(this.textContainer_),this.textContainer_=null,this.isTextVisible_=!1,this.cues_=[],this.captionsTimer_&&this.captionsTimer_.stop(),this.currentCuesMap_.clear(),this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),this.resizeObserver_&&(this.resizeObserver_.disconnect(),this.resizeObserver_=null),Promise.resolve()):Promise.resolve()},shaka.text.UITextDisplayer.prototype.remove=function(e,t){if(!this.textContainer_)return!1;var r=this.cues_.length;return this.cues_=this.cues_.filter((function(r){return r.startTime<e||r.endTime>=t})),this.updateCaptions_(r>this.cues_.length),!0},shaka.text.UITextDisplayer.prototype.isTextVisible=function(){return this.isTextVisible_},shaka.text.UITextDisplayer.prototype.setTextVisibility=function(e){this.isTextVisible_=e},shaka.text.UITextDisplayer.prototype.isElementUnderTextContainer_=function(e){for(;null!=e;){if(e==this.textContainer_)return!0;e=e.parentElement}return!1},shaka.text.UITextDisplayer.prototype.updateCuesRecursive_=function(e,t,r,n){for(var a=!1,i=[],o=[],s=(e=$jscomp.makeIterator(e)).next();!s.done;s=e.next()){s=s.value,n.push(s);var l=this.currentCuesMap_.get(s),u=s.startTime<=r&&s.endTime>r,c=l?l.wrapper:null;l&&(i.push(l.cueElement),l.regionElement&&i.push(l.regionElement),u||(a=!0,this.currentCuesMap_.delete(s),l=null)),u&&(o.push(s),l?this.isElementUnderTextContainer_(c)||(a=!0):(this.createCue_(s,n),c=(l=this.currentCuesMap_.get(s)).wrapper,a=!0)),0<s.nestedCues.length&&c&&this.updateCuesRecursive_(s.nestedCues,c,r,n),l=n.pop(),goog.asserts.assert(l==s,"Parent cues should be kept in order")}if(a){for(n=(r=$jscomp.makeIterator(i)).next();!n.done;n=r.next())(n=n.value).parentElement&&n.parentElement.removeChild(n);for(o.sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime})),s=(o=$jscomp.makeIterator(o)).next();!s.done;s=o.next())r=this.currentCuesMap_.get(s.value),goog.asserts.assert(r,"cueRegistry should exist."),r.regionElement?(r.regionElement.contains(t)&&r.regionElement.removeChild(t),t.appendChild(r.regionElement),r.regionElement.appendChild(r.cueElement)):t.appendChild(r.cueElement)}},shaka.text.UITextDisplayer.prototype.updateCaptions_=function(e){if(this.textContainer_){var t=this.video_.currentTime;if(!this.isTextVisible_||void 0!==e&&e){for(var r=(e=$jscomp.makeIterator(this.regionElements_.values())).next();!r.done;r=e.next())shaka.util.Dom.removeAllChildren(r.value);shaka.util.Dom.removeAllChildren(this.textContainer_),this.currentCuesMap_.clear(),this.regionElements_.clear()}if(this.isTextVisible_){if(e=new Map,goog.DEBUG)for(var n=(r=$jscomp.makeIterator(this.currentCuesMap_.keys())).next();!n.done;n=r.next())n=n.value,e.set(n,this.currentCuesMap_.get(n));if(this.updateCuesRecursive_(this.cues_,this.textContainer_,t,[]),goog.DEBUG)for(n=(t=$jscomp.makeIterator(e.keys())).next();!n.done;n=t.next())r=n.value,this.currentCuesMap_.has(r)||(r=e.get(r).cueElement,goog.asserts.assert(!r.parentNode,"Cue was not properly removed!"))}}},shaka.text.UITextDisplayer.prototype.generateRegionId_=function(e){var t=shaka.text.CueRegion.units.PERCENTAGE;return e.id+"_"+e.width+"x"+e.height+(e.heightUnits==t?"%":"px")+"-"+e.viewportAnchorX+"x"+e.viewportAnchorY+(e.viewportAnchorUnits==t?"%":"px")},shaka.text.UITextDisplayer.prototype.getRegionElement_=function(e){var t=e.region,r=this.aspectRatio_===4/3?2.5:1.9,n=this.generateRegionId_(t);if(this.regionElements_.has(n))return this.regionElements_.get(n);var a=shaka.util.Dom.createHTMLElement("span"),i=shaka.text.CueRegion.units.PERCENTAGE,o=t.heightUnits==i?"%":"px",s=t.widthUnits==i?"%":"px";i=t.viewportAnchorUnits==i?"%":"px",a.id="shaka-text-region---"+n,a.classList.add("shaka-text-region"),a.style.position="absolute";var l=shaka.text.CueRegion.units.LINES;return t.heightUnits===l&&t.widthUnits===l?(a.style.height=5.33*t.height+"%",a.style.width=t.width*r+"%"):(a.style.height=t.height+o,a.style.width=t.width+s),t.viewportAnchorUnits===l?(o=t.viewportAnchorY/75*100,s=t.viewportAnchorX/(this.aspectRatio_===4/3?160:210)*100,o-=t.regionAnchorY*t.height*5.33/100,s-=t.regionAnchorX*t.width*r/100,a.style.top=o+"%",a.style.left=s+"%"):(a.style.top=t.viewportAnchorY-t.regionAnchorY*t.height/100+i,a.style.left=t.viewportAnchorX-t.regionAnchorX*t.width/100+i),a.style.display="flex",a.style.flexDirection="column",a.style.alignItems="center",a.style.justifyContent=e.displayAlign==shaka.text.Cue.displayAlign.BEFORE?"flex-start":e.displayAlign==shaka.text.Cue.displayAlign.CENTER?"center":"flex-end",this.regionElements_.set(n,a),a},shaka.text.UITextDisplayer.prototype.createCue_=function(e,t){var r=1<t.length,n=r?"span":"div";e.lineBreak&&(n="br"),e.rubyTag&&(n=e.rubyTag),r=!r&&0<e.nestedCues.length;var a=shaka.util.Dom.createHTMLElement(n);"br"!=n&&this.setCaptionStyles_(a,e,t,r),t=null,e.region&&e.region.id&&(t=this.getRegionElement_(e)),n=a,r&&((n=shaka.util.Dom.createHTMLElement("span")).classList.add("shaka-text-wrapper"),n.style.backgroundColor=e.backgroundColor,n.style.lineHeight="normal",a.appendChild(n)),this.currentCuesMap_.set(e,{cueElement:a,wrapper:n,regionElement:t})},shaka.text.UITextDisplayer.prototype.computeCuePositionAlignment_=function(e){var t=shaka.text.Cue,r=e.direction,n=e.positionAlign;return e=e.textAlign,n!==t.positionAlign.AUTO?n:e===t.textAlign.LEFT||e===t.textAlign.START&&r===t.direction.HORIZONTAL_LEFT_TO_RIGHT||e===t.textAlign.END&&r===t.direction.HORIZONTAL_RIGHT_TO_LEFT?t.positionAlign.LEFT:e===t.textAlign.RIGHT||e===t.textAlign.START&&r===t.direction.HORIZONTAL_RIGHT_TO_LEFT||e===t.textAlign.END&&r===t.direction.HORIZONTAL_LEFT_TO_RIGHT?t.positionAlign.RIGHT:t.positionAlign.CENTER},shaka.text.UITextDisplayer.prototype.setCaptionStyles_=function(e,t,r,n){var a=shaka.text.Cue,i=e.style,o=0==t.nestedCues.length,s=1<r.length;i.whiteSpace="pre-wrap";var l=t.payload.replace(/\s+$/g,(function(e){return" ".repeat(e.length)}));if(i.webkitTextStrokeColor=t.textStrokeColor,i.webkitTextStrokeWidth=t.textStrokeWidth,i.color=t.color,i.direction=t.direction,i.opacity=t.opacity,i.paddingLeft=shaka.text.UITextDisplayer.convertLengthValue_(t.linePadding,t,this.videoContainer_),i.paddingRight=shaka.text.UITextDisplayer.convertLengthValue_(t.linePadding,t,this.videoContainer_),i.textCombineUpright=t.textCombineUpright,i.textShadow=t.textShadow,t.backgroundImage)i.backgroundImage="url('"+t.backgroundImage+"')",i.backgroundRepeat="no-repeat",i.backgroundSize="contain",i.backgroundPosition="center",i.width="100%",i.height="100%";else{if(t.nestedCues.length)var u=e;else u=shaka.util.Dom.createHTMLElement("span"),e.appendChild(u);t.border&&(u.style.border=t.border),!n&&((e=shaka.text.UITextDisplayer.inheritProperty_(r,(function(e){return e.backgroundColor})))?u.style.backgroundColor=e:l&&(u.style.backgroundColor="rgba(0, 0, 0, 0.8)"),e=shaka.text.UITextDisplayer.inheritProperty_(r,(function(e){return e.fontFamily})))&&(u.style.fontFamily=e),l&&(u.textContent=l)}s&&!r[r.length-1].isContainer?i.display="inline":(i.display="flex",i.flexDirection="column",i.alignItems="center",i.justifyContent=t.displayAlign==a.displayAlign.BEFORE?"flex-start":t.displayAlign==a.displayAlign.CENTER?"center":"flex-end"),o||(i.margin="0"),i.fontFamily=t.fontFamily,i.fontWeight=t.fontWeight.toString(),i.fontStyle=t.fontStyle,i.letterSpacing=t.letterSpacing,i.fontSize=shaka.text.UITextDisplayer.convertLengthValue_(t.fontSize,t,this.videoContainer_),null!=(r=t.line)&&((o=t.lineInterpretation)==a.lineInterpretation.LINE_NUMBER&&(o=a.lineInterpretation.PERCENTAGE,s=16,this.aspectRatio_&&1>this.aspectRatio_&&(s=32),r=0>r?100+r/s*100:r/s*100),o==a.lineInterpretation.PERCENTAGE&&(i.position="absolute",t.writingMode==a.writingMode.HORIZONTAL_TOP_TO_BOTTOM?(i.width="100%",t.lineAlign==a.lineAlign.START?i.top=r+"%":t.lineAlign==a.lineAlign.END&&(i.bottom=100-r+"%")):t.writingMode==a.writingMode.VERTICAL_LEFT_TO_RIGHT?(i.height="100%",t.lineAlign==a.lineAlign.START?i.left=r+"%":t.lineAlign==a.lineAlign.END&&(i.right=100-r+"%")):(i.height="100%",t.lineAlign==a.lineAlign.START?i.right=r+"%":t.lineAlign==a.lineAlign.END&&(i.left=100-r+"%")))),i.lineHeight=t.lineHeight,null!=t.position&&(t.writingMode==a.writingMode.HORIZONTAL_TOP_TO_BOTTOM?i.paddingLeft=t.position:i.paddingTop=t.position),(r=this.computeCuePositionAlignment_(t))==a.positionAlign.LEFT?i.cssFloat="left":r==a.positionAlign.RIGHT&&(i.cssFloat="right"),i.textAlign=t.textAlign,i.textDecoration=t.textDecoration.join(" "),i.writingMode=t.writingMode,"writingMode"in document.documentElement.style&&i.writingMode==t.writingMode||(i.webkitWritingMode=t.writingMode),t.size&&(t.writingMode==a.writingMode.HORIZONTAL_TOP_TO_BOTTOM?i.width=t.size+"%":i.height=t.size+"%")},shaka.text.UITextDisplayer.getLengthValueInfo_=function(e){return(e=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(e[1]),unit:e[2]}:null},shaka.text.UITextDisplayer.convertLengthValue_=function(e,t,r){var n=shaka.text.UITextDisplayer.getLengthValueInfo_(e);if(!n)return e;var a=n.value;switch(n.unit){case"%":return shaka.text.UITextDisplayer.getAbsoluteLengthInPixels_(a/100,t,r);case"c":return shaka.text.UITextDisplayer.getAbsoluteLengthInPixels_(a,t,r);default:return e}},shaka.text.UITextDisplayer.getAbsoluteLengthInPixels_=function(e,t,r){return r.clientHeight*e/t.cellResolution.rows+"px"},shaka.text.UITextDisplayer.inheritProperty_=function(e,t){for(var r=e.length-1;0<=r;r--){var n=t(e[r]);if(n||0===n)return n}return null},goog.exportSymbol("shaka.text.UITextDisplayer",shaka.text.UITextDisplayer),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"setTextVisibility",shaka.text.UITextDisplayer.prototype.setTextVisibility),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"isTextVisible",shaka.text.UITextDisplayer.prototype.isTextVisible),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"remove",shaka.text.UITextDisplayer.prototype.remove),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"destroy",shaka.text.UITextDisplayer.prototype.destroy),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"append",shaka.text.UITextDisplayer.prototype.append),goog.exportProperty(shaka.text.UITextDisplayer.prototype,"configure",shaka.text.UITextDisplayer.prototype.configure),shaka.text.WebVttGenerator=function(){},shaka.text.WebVttGenerator.convert=function(e,t){var r=function(e){for(var r=e,n=$jscomp.makeIterator(t),a=n.next();!a.done;a=n.next())(a=a.value).end&&a.start<e&&(r+=a.end-a.start);return(10>(e=Math.floor(r/3600))?"0":"")+e+":"+(10>(n=Math.floor(r/60%60))?"0":"")+n+":"+(10>(a=Math.floor(r%60))?"0":"")+a+"."+(100>(r=Math.floor(1e3*r%1e3))?10>r?"00":"0":"")+r},n=shaka.text.Utils.getCuesToFlatten(e);e="WEBVTT\n\n";for(var a=(n=$jscomp.makeIterator(n)).next();!a.done;a=n.next())e+=r((a=a.value).startTime)+" --\x3e "+r(a.endTime)+function(e){var t=[],r=shaka.text.Cue;switch(e.textAlign){case r.textAlign.LEFT:t.push("align:left");break;case r.textAlign.RIGHT:t.push("align:right");break;case r.textAlign.CENTER:t.push("align:middle");break;case r.textAlign.START:t.push("align:start");break;case r.textAlign.END:t.push("align:end")}switch(e.writingMode){case r.writingMode.VERTICAL_LEFT_TO_RIGHT:t.push("vertical:lr");break;case r.writingMode.VERTICAL_RIGHT_TO_LEFT:t.push("vertical:rl")}return t.length?" "+t.join(" "):""}(a)+"\n",e+=a.payload+"\n\n";return e},goog.exportSymbol("shaka.text.WebVttGenerator",shaka.text.WebVttGenerator),shaka.util.CmcdManager=function(e,t){this.playerInterface_=e,this.config_=t,this.sf_=void 0,this.playbackStarted_=!1,this.buffering_=!0,this.starved_=!1},shaka.util.CmcdManager.prototype.configure=function(e){this.config_=e},shaka.util.CmcdManager.prototype.setBuffering=function(e){e||this.playbackStarted_||(this.playbackStarted_=!0),this.playbackStarted_&&e&&(this.starved_=!0),this.buffering_=e},shaka.util.CmcdManager.prototype.applyData=function(e,t,r){if(r=void 0===r?{}:r,this.config_.enabled)if("HEAD"===t.method)this.apply_(t);else{var n=shaka.net.NetworkingEngine.RequestType,a=shaka.util.CmcdManager.ObjectType;switch(e){case n.MANIFEST:this.applyManifestData(t,r);break;case n.SEGMENT:this.applySegmentData(t,r);break;case n.LICENSE:case n.SERVER_CERTIFICATE:case n.KEY:this.apply_(t,{ot:a.KEY});break;case n.TIMING:this.apply_(t,{ot:a.OTHER})}}},shaka.util.CmcdManager.prototype.applyManifestData=function(e,t){try{this.config_.enabled&&(t.type&&(this.sf_=this.getStreamFormat_(t.type)),this.apply_(e,{ot:shaka.util.CmcdManager.ObjectType.MANIFEST,su:!this.playbackStarted_}))}catch(e){shaka.log.warnOnce("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",e)}},shaka.util.CmcdManager.prototype.applySegmentData=function(e,t){try{if(this.config_.enabled){var r=t.segment,n=0;r&&(n=r.endTime-r.startTime);var a={d:1e3*n,st:this.getStreamType_()};a.ot=this.getObjectType_(t);var i=shaka.util.CmcdManager.ObjectType,o=a.ot===i.VIDEO||a.ot===i.AUDIO||a.ot===i.MUXED||a.ot===i.TIMED_TEXT,s=t.stream;if(s){var l=this.playerInterface_.getPlaybackRate();if(o&&(a.bl=this.getBufferLength_(s.type),a.ot!==i.TIMED_TEXT)){var u=this.getRemainingBufferLength_(s.type);a.dl=l?u/Math.abs(l):u}if(s.bandwidth&&(a.br=s.bandwidth/1e3),s.segmentIndex&&r){var c=s.segmentIndex.getIteratorForTime(r.endTime,!0,0>l);if(c){var d=c.next().value;if(d&&d!=r&&(shaka.util.ArrayUtils.equal(r.getUris(),d.getUris())||(a.nor=this.urlToRelativePath_(d.getUris()[0],e.uris[0])),(d.startByte||d.endByte)&&(r.startByte!=d.startByte||r.endByte!=d.endByte))){var p=d.startByte+"-";d.endByte&&(p+=d.endByte),a.nrr=p}}var h=this.calculateRtp_(s,r);isNaN(h)||(a.rtp=h)}}o&&a.ot!==i.TIMED_TEXT&&(a.tb=this.getTopBandwidth_(a.ot)/1e3),this.apply_(e,a)}}catch(e){shaka.log.warnOnce("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",e)}},shaka.util.CmcdManager.prototype.applyTextData=function(e){try{this.config_.enabled&&this.apply_(e,{ot:shaka.util.CmcdManager.ObjectType.CAPTION,su:!0})}catch(e){shaka.log.warnOnce("CMCD_TEXT_ERROR","Could not generate text CMCD data.",e)}},shaka.util.CmcdManager.prototype.appendSrcData=function(e,t){try{if(!this.config_.enabled)return e;var r=this.createData_();r.ot=this.getObjectTypeFromMimeType_(t),r.su=!0;var n=shaka.util.CmcdManager.toQuery(r);return shaka.util.CmcdManager.appendQueryToUri(e,n)}catch(t){return shaka.log.warnOnce("CMCD_SRC_ERROR","Could not generate src CMCD data.",t),e}},shaka.util.CmcdManager.prototype.appendTextTrackData=function(e){try{if(!this.config_.enabled)return e;var t=this.createData_();t.ot=shaka.util.CmcdManager.ObjectType.CAPTION,t.su=!0;var r=shaka.util.CmcdManager.toQuery(t);return shaka.util.CmcdManager.appendQueryToUri(e,r)}catch(t){return shaka.log.warnOnce("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",t),e}},shaka.util.CmcdManager.prototype.createData_=function(){return this.config_.sessionId||(this.config_.sessionId=window.crypto.randomUUID()),{v:shaka.util.CmcdManager.Version,sf:this.sf_,sid:this.config_.sessionId,cid:this.config_.contentId,mtp:this.playerInterface_.getBandwidthEstimate()/1e3}},shaka.util.CmcdManager.prototype.apply_=function(e,t,r){if(t=void 0===t?{}:t,r=void 0===r?this.config_.useHeaders:r,this.config_.enabled){Object.assign(t,this.createData_()),t.pr=this.playerInterface_.getPlaybackRate();var n=t.ot===shaka.util.CmcdManager.ObjectType.VIDEO||t.ot===shaka.util.CmcdManager.ObjectType.MUXED;if(this.starved_&&n&&(t.bs=!0,t.su=!0,this.starved_=!1),null==t.su&&(t.su=this.buffering_),t=this.filterKeys_(t),r)r=shaka.util.CmcdManager.toHeaders(t),Object.keys(r).length&&Object.assign(e.headers,r);else{var a=shaka.util.CmcdManager.toQuery(t);a&&(e.uris=e.uris.map((function(e){return shaka.util.CmcdManager.appendQueryToUri(e,a)})))}}},shaka.util.CmcdManager.prototype.filterKeys_=function(e){var t=this.config_.includeKeys;return t.length?Object.keys(e).reduce((function(r,n){return t.includes(n)&&(r[n]=e[n]),r}),{}):e},shaka.util.CmcdManager.prototype.getObjectType_=function(e){if(e.type===shaka.net.NetworkingEngine.AdvancedRequestType.INIT_SEGMENT)return shaka.util.CmcdManager.ObjectType.INIT;if(e=e.stream){var t=e.type;if("video"==t)return e.codecs&&e.codecs.includes(",")?shaka.util.CmcdManager.ObjectType.MUXED:shaka.util.CmcdManager.ObjectType.VIDEO;if("audio"==t)return shaka.util.CmcdManager.ObjectType.AUDIO;if("text"==t)return"application/mp4"===e.mimeType?shaka.util.CmcdManager.ObjectType.TIMED_TEXT:shaka.util.CmcdManager.ObjectType.CAPTION}},shaka.util.CmcdManager.prototype.getObjectTypeFromMimeType_=function(e){switch(e.toLowerCase()){case"audio/mp4":case"audio/webm":case"audio/ogg":case"audio/mpeg":case"audio/aac":case"audio/flac":case"audio/wav":return shaka.util.CmcdManager.ObjectType.AUDIO;case"video/webm":case"video/mp4":case"video/mpeg":case"video/mp2t":return shaka.util.CmcdManager.ObjectType.MUXED;case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"application/dash+xml":case"video/vnd.mpeg.dash.mpd":case"application/vnd.ms-sstr+xml":return shaka.util.CmcdManager.ObjectType.MANIFEST}},shaka.util.CmcdManager.prototype.getBufferLength_=function(e){if(!(e=this.playerInterface_.getBufferedInfo()[e]).length)return NaN;var t=this.playerInterface_.getCurrentTime();return(e=e.find((function(e){return e.start<=t&&e.end>=t})))?1e3*(e.end-t):NaN},shaka.util.CmcdManager.prototype.getRemainingBufferLength_=function(e){if(!(e=this.playerInterface_.getBufferedInfo()[e]).length)return 0;var t=this.playerInterface_.getCurrentTime();return(e=e.find((function(e){return e.start<=t&&e.end>=t})))?1e3*(e.end-t):0},shaka.util.CmcdManager.prototype.urlToRelativePath_=function(e,t){var r=new URL(e);if(t=new URL(t),r.origin!==t.origin)return e;for(e=r.pathname.split("/").slice(1),r=t.pathname.split("/").slice(1,-1);e[0]===r[0];)e.shift(),r.shift();for(;r.length;)r.shift(),e.unshift("..");return e.join("/")},shaka.util.CmcdManager.prototype.calculateRtp_=function(e,t){var r=this.playerInterface_.getPlaybackRate()||1,n=this.getRemainingBufferLength_(e.type)||500;return(e=e.bandwidth)?e*(t.endTime-t.startTime)/1e3/(n/r/1e3)*this.config_.rtpSafetyFactor:NaN},shaka.util.CmcdManager.prototype.getStreamFormat_=function(e){var t=shaka.net.NetworkingEngine.AdvancedRequestType;switch(e){case t.MPD:return shaka.util.CmcdManager.StreamingFormat.DASH;case t.MASTER_PLAYLIST:case t.MEDIA_PLAYLIST:return shaka.util.CmcdManager.StreamingFormat.HLS;case t.MSS:return shaka.util.CmcdManager.StreamingFormat.SMOOTH}},shaka.util.CmcdManager.prototype.getStreamType_=function(){return this.playerInterface_.isLive()?shaka.util.CmcdManager.StreamType.LIVE:shaka.util.CmcdManager.StreamType.VOD},shaka.util.CmcdManager.prototype.getTopBandwidth_=function(e){var t=this.playerInterface_.getVariantTracks();if(!t.length)return NaN;for(var r=t[0],n=(t=$jscomp.makeIterator(t)).next();!n.done;n=t.next())"variant"===(n=n.value).type&&n.bandwidth>r.bandwidth&&(r=n);switch(t=shaka.util.CmcdManager.ObjectType,e){case t.VIDEO:return r.videoBandwidth||NaN;case t.AUDIO:return r.audioBandwidth||NaN;default:return r.bandwidth}},shaka.util.CmcdManager.serialize=function(e){var t=[],r=function(e){return Math.round(e)},n=function(e){return 100*r(e/100)};n={br:r,d:r,bl:n,dl:n,mtp:n,nor:function(e){return encodeURIComponent(e)},rtp:n,tb:r};for(var a,i=Object.keys(e||{}).sort(),o=(i=$jscomp.makeIterator(i)).next();!o.done;o=i.next()){var s=e[o=o.value];if(!(a=s,Number.isNaN(a)||null==a||""===a||!1===a||"v"===o&&1===s||"pr"==o&&1===s)){var l=n[o];l&&(s=l(s));var u;u="string"===(l=typeof s)&&"ot"!==o&&"sf"!==o&&"st"!==o?o+"="+JSON.stringify(s):"boolean"===l?o:"symbol"===l?o+"="+s.description:o+"="+s,t.push(u)}}return t.join(",")},shaka.util.CmcdManager.toHeaders=function(e){for(var t=Object.keys(e),r={},n=["Object","Request","Session","Status"],a=[{},{},{},{}],i={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},o=(t=$jscomp.makeIterator(t)).next();!o.done;o=t.next())a[null!=i[o=o.value]?i[o]:1][o]=e[o];for(e=0;e<a.length;e++)(i=shaka.util.CmcdManager.serialize(a[e]))&&(r["CMCD-"+n[e]]=i);return r},shaka.util.CmcdManager.toQuery=function(e){return shaka.util.CmcdManager.serialize(e)},shaka.util.CmcdManager.appendQueryToUri=function(e,t){return!t||e.includes("offline:")?e:((e=new goog.Uri(e)).getQueryData().set("CMCD",t),e.toString())},shaka.util.CmcdManager.ObjectType={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},shaka.util.CmcdManager.StreamType={VOD:"v",LIVE:"l"},shaka.util.CmcdManager.StreamingFormat={DASH:"d",HLS:"h",SMOOTH:"s",OTHER:"o"},goog.exportSymbol("shaka.util.CmcdManager.StreamingFormat",shaka.util.CmcdManager.StreamingFormat),shaka.util.CmcdManager.Version=1,shaka.util.CmsdManager=function(e){this.config_=e,this.dynamicParams_=this.staticParams_=null},shaka.util.CmsdManager.prototype.configure=function(e){this.config_=e},shaka.util.CmsdManager.prototype.reset=function(){this.dynamicParams_=this.staticParams_=null},shaka.util.CmsdManager.prototype.processHeaders=function(e){if(this.config_.enabled){var t=shaka.util.CmsdManager,r=e[t.CMSD_STATIC_HEADER_NAME_];r&&(r=this.parseCMSDStatic_(r))&&(this.staticParams_=r),(e=e[t.CMSD_DYNAMIC_HEADER_NAME_])&&(e=this.parseCMSDDynamic_(e))&&(this.dynamicParams_=e)}},shaka.util.CmsdManager.prototype.getMaxBitrate=function(){var e=shaka.util.CmsdManager.KEYS_.MAX_SUGGESTED_BITRATE;return this.config_.enabled&&this.config_.applyMaximumSuggestedBitrate&&this.dynamicParams_&&this.dynamicParams_.has(e)?1e3*this.dynamicParams_.get(e):null},shaka.util.CmsdManager.prototype.getEstimatedThroughput=function(){var e=shaka.util.CmsdManager.KEYS_.ESTIMATED_THROUGHPUT;return this.config_.enabled&&this.dynamicParams_&&this.dynamicParams_.has(e)?1e3*this.dynamicParams_.get(e):null},shaka.util.CmsdManager.prototype.getResponseDelay=function(){var e=shaka.util.CmsdManager.KEYS_.RESPONSE_DELAY;return this.config_.enabled&&this.dynamicParams_&&this.dynamicParams_.has(e)?this.dynamicParams_.get(e):null},shaka.util.CmsdManager.prototype.getRoundTripTime=function(){var e=shaka.util.CmsdManager.KEYS_.ROUND_TRIP_TIME;return this.config_.enabled&&this.dynamicParams_&&this.dynamicParams_.has(e)?this.dynamicParams_.get(e):null},shaka.util.CmsdManager.prototype.getBandwidthEstimate=function(e){var t=this.getEstimatedThroughput();if(!t)return e;var r=this.config_.estimatedThroughputWeightRatio;return 0<r&&1>=r?e*(1-r)+t*r:e},shaka.util.CmsdManager.prototype.parseCMSDStatic_=function(e){try{var t=new Map,r=e.split(",");for(e=0;e<r.length;e++){var n=r[e].split("="),a=n[0],i=this.parseParameterValue_(n[1]);t.set(a,i)}return t}catch(e){return shaka.log.warning("Failed to parse CMSD-Static response header value:",e),null}},shaka.util.CmsdManager.prototype.parseCMSDDynamic_=function(e){try{var t=new Map,r=e.split(";");for(e=1;e<r.length;e++){var n=r[e].split("="),a=n[0],i=this.parseParameterValue_(n[1]);t.set(a,i)}return t}catch(e){return shaka.log.warning("Failed to parse CMSD-Dynamic response header value:",e),null}},shaka.util.CmsdManager.prototype.parseParameterValue_=function(e){return!e||"false"!==e.toLowerCase()&&(/^[-0-9]/.test(e)?parseInt(e,10):e.replace(/["]+/g,""))},goog.exportSymbol("shaka.util.CmsdManager",shaka.util.CmsdManager),goog.exportProperty(shaka.util.CmsdManager.prototype,"getBandwidthEstimate",shaka.util.CmsdManager.prototype.getBandwidthEstimate),goog.exportProperty(shaka.util.CmsdManager.prototype,"getRoundTripTime",shaka.util.CmsdManager.prototype.getRoundTripTime),goog.exportProperty(shaka.util.CmsdManager.prototype,"getResponseDelay",shaka.util.CmsdManager.prototype.getResponseDelay),goog.exportProperty(shaka.util.CmsdManager.prototype,"getEstimatedThroughput",shaka.util.CmsdManager.prototype.getEstimatedThroughput),goog.exportProperty(shaka.util.CmsdManager.prototype,"getMaxBitrate",shaka.util.CmsdManager.prototype.getMaxBitrate),shaka.util.CmsdManager.CMSD_STATIC_HEADER_NAME_="cmsd-static",shaka.util.CmsdManager.CMSD_DYNAMIC_HEADER_NAME_="cmsd-dynamic",shaka.util.CmsdManager.KEYS_={AVAILABILITY_TIME:"at",DURESS:"du",ENCODED_BITRATE:"br",ESTIMATED_THROUGHPUT:"etp",HELD_TIME:"ht",INTERMEDIARY_IDENTIFIER:"n",MAX_SUGGESTED_BITRATE:"mb",NEXT_OBJECT_RESPONSE:"nor",NEXT_RANGE_RESPONSE:"nrr",OBJECT_DURATION:"d",OBJECT_TYPE:"ot",RESPONSE_DELAY:"rd",ROUND_TRIP_TIME:"rtt",STARTUP:"su",STREAM_TYPE:"st",STREAMING_FORMAT:"sf",VERSION:"v"},shaka.util.Mutex=function(){this.acquiredIdentifier=null,this.unlockQueue=[]},shaka.util.Mutex.prototype.acquire=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return shaka.log.v2(e+" has requested mutex"),t.acquiredIdentifier?r.yield(new Promise((function(e){return t.unlockQueue.push(e)})),2):r.jumpTo(2);t.acquiredIdentifier=e,shaka.log.v2(e+" has acquired mutex"),r.jumpToEnd()}))},shaka.util.Mutex.prototype.release=function(){shaka.log.v2(this.acquiredIdentifier+" has released mutex"),0<this.unlockQueue.length?this.unlockQueue.shift()():this.acquiredIdentifier=null},shaka.util.Mutex.prototype.releaseAll=function(){for(;this.acquiredIdentifier;)this.release()},shaka.Player=function(e,t){shaka.util.FakeEventTarget.call(this);var r=this;this.loadMode_=shaka.Player.LoadMode.NOT_LOADED,this.videoContainer_=this.video_=null,this.isTextVisible_=!1,this.globalEventManager_=new shaka.util.EventManager,this.attachEventManager_=new shaka.util.EventManager,this.loadEventManager_=new shaka.util.EventManager,this.trickPlayEventManager_=new shaka.util.EventManager,this.playhead_=this.mediaSourceEngine_=this.drmEngine_=this.networkingEngine_=null,this.operationId_=0,this.mutex_=new shaka.util.Mutex,this.startTime_=this.mimeType_=this.assetUri_=this.manifest_=this.parserFactory_=this.parser_=this.streamingEngine_=this.qualityObserver_=this.lcevcDec_=this.lcevcCanvas_=this.cmsdManager_=this.cmcdManager_=this.regionTimeline_=this.bufferObserver_=this.bufferPoller_=this.playRateController_=this.playheadObservers_=null,this.fullyLoaded_=!1,this.abrManagerFactory_=this.abrManager_=null,this.nextExternalStreamId_=1e9,this.externalSrcEqualsThumbnailsStreams_=[],this.completionPercent_=NaN,this.config_=this.defaultConfig_(),this.maxHwRes_={width:1/0,height:1/0},this.manifestFilterer_=new shaka.media.ManifestFilterer(this.config_,this.maxHwRes_,null),this.createdPreloadManagers_=[],this.stats_=null,this.currentAdaptationSetCriteria_=new shaka.media.PreferenceBasedCriteria(this.config_.preferredAudioLanguage,this.config_.preferredVariantRole,this.config_.preferredAudioChannelCount,this.config_.preferredVideoHdrLevel,this.config_.preferSpatialAudio,this.config_.preferredVideoLayout,this.config_.preferredAudioLabel,this.config_.preferredVideoLabel,this.config_.mediaSource.codecSwitchingStrategy,this.config_.manifest.dash.enableAudioGroups),this.currentTextLanguage_=this.config_.preferredTextLanguage,this.currentTextRole_=this.config_.preferredTextRole,this.currentTextForced_=this.config_.preferForcedSubs,this.cleanupOnUnload_=[],t&&t(this),this.cmcdManager_=this.createCmcd_(),this.cmsdManager_=this.createCmsd_(),this.networkingEngine_=this.createNetworkingEngine(),this.networkingEngine_.setForceHTTPS(this.config_.streaming.forceHTTPS),this.adManager_=null,shaka.Player.adManagerFactory_&&(this.adManager_=shaka.Player.adManagerFactory_(),this.adManager_.configure(this.config_.ads)),this.globalEventManager_.listen(window,"online",(function(){r.restoreDisabledVariants_(),r.retryStreaming()})),this.checkVariantsTimer_=new shaka.util.Timer((function(){return r.checkVariants_()})),e&&(shaka.Deprecate.deprecateFeature(5,"Player w/ mediaElement","Please migrate from initializing Player with a mediaElement; use the attach method instead."),this.attach(e,!0))},$jscomp.inherits(shaka.Player,shaka.util.FakeEventTarget),shaka.Player.prototype.createLcevcDec_=function(e){null==this.lcevcDec_&&(this.lcevcDec_=new shaka.lcevc.Dec(this.video_,this.lcevcCanvas_,e),this.mediaSourceEngine_&&this.mediaSourceEngine_.updateLcevcDec(this.lcevcDec_))},shaka.Player.prototype.closeLcevcDec_=function(){null!=this.lcevcDec_&&(this.lcevcDec_.hideCanvas(),this.lcevcDec_.release(),this.lcevcDec_=null)},shaka.Player.prototype.setupLcevc_=function(e){if(e.lcevc.enabled){var t=this.getVariantTracks();t&&t[0]&&"video/mp2t"==t[0].videoMimeType&&(shaka.util.Platform.isEdge()||shaka.util.Platform.isLegacyEdge())&&(e.mediaSource.forceTransmux||shaka.log.alwaysWarn("LCEVC Warning: For MPEG-2 TS decoding the config.mediaSource.forceTransmux must be enabled.")),this.closeLcevcDec_(),this.createLcevcDec_(e.lcevc)}else this.closeLcevcDec_()},shaka.Player.makeEvent_=function(e,t){return new shaka.util.FakeEvent(e,t)},shaka.Player.prototype.destroy=function(){var e,t,r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:return i.loadMode_==shaka.Player.LoadMode.DESTROYED?o.return():(i.closeLcevcDec_(),e=i.detach(),i.loadMode_=shaka.Player.LoadMode.DESTROYED,o.yield(e,2));case 2:for(t=[],r=$jscomp.makeIterator(i.createdPreloadManagers_),n=r.next();!n.done;n=r.next())(a=n.value).isDestroyed()||t.push(a.destroy());return i.createdPreloadManagers_=[],o.yield(Promise.all(t),3);case 3:if(i.globalEventManager_&&(i.globalEventManager_.release(),i.globalEventManager_=null),i.attachEventManager_&&(i.attachEventManager_.release(),i.attachEventManager_=null),i.loadEventManager_&&(i.loadEventManager_.release(),i.loadEventManager_=null),i.trickPlayEventManager_&&(i.trickPlayEventManager_.release(),i.trickPlayEventManager_=null),i.abrManagerFactory_=null,i.config_=null,i.stats_=null,i.videoContainer_=null,i.cmcdManager_=null,i.cmsdManager_=null,!i.networkingEngine_){o.jumpTo(4);break}return o.yield(i.networkingEngine_.destroy(),5);case 5:i.networkingEngine_=null;case 4:i.abrManager_&&(i.abrManager_.release(),i.abrManager_=null),shaka.util.FakeEventTarget.prototype.release.call(i),o.jumpToEnd()}}))},shaka.Player.registerSupportPlugin=function(e,t){shaka.Player.supportPlugins_[e]=t},shaka.Player.setAdManagerFactory=function(e){shaka.Player.adManagerFactory_=e},shaka.Player.isBrowserSupported=function(){if(window.Promise||shaka.log.alwaysWarn("A Promise implementation or polyfill is required"),!(window.Promise&&window.Uint8Array&&Array.prototype.forEach)||shaka.util.Platform.isIE())return!1;var e=shaka.util.Platform.safariVersion();return!(e&&9>e||!shaka.media.DrmEngine.isBrowserSupported())&&(!!shaka.util.Platform.supportsMediaSource()||shaka.util.Platform.supportsMediaType("application/x-mpegurl"))},shaka.Player.probeSupport=function(e){var t,r,n,a,i,o;return e=void 0===e||e,$jscomp.asyncExecutePromiseGeneratorProgram((function(s){if(1==s.nextAddress)return goog.asserts.assert(shaka.Player.isBrowserSupported(),"Must have basic support"),t={},e?s.yield(shaka.media.DrmEngine.probeSupport(),3):s.jumpTo(2);for(o in 2!=s.nextAddress&&(t=s.yieldResult),r=shaka.media.ManifestParser.probeSupport(),n=shaka.media.MediaSourceEngine.probeSupport(),a={manifest:r,media:n,drm:t},i=shaka.Player.supportPlugins_)a[o]=i[o]();return s.return(a)}))},shaka.Player.prototype.makeStateChangeEvent_=function(e){this.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.OnStateChange,(new Map).set("state",e)))},shaka.Player.prototype.attach=function(e,t){t=void 0===t||t;var r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:if(i.loadMode_==shaka.Player.LoadMode.DESTROYED)throw i.createAbortLoadError_();if(r=i.video_&&i.video_==e,!i.video_||i.video_==e){o.jumpTo(2);break}return o.yield(i.detach(),2);case 2:return o.yield(i.atomicOperationAcquireMutex_("attach"),4);case 4:if(o.yieldResult)return o.return();if(o.setCatchFinallyBlocks(5,6),r||(i.makeStateChangeEvent_("attach"),n=function(e){return i.onVideoError_(e)},i.attachEventManager_.listen(e,"error",n),i.video_=e),!t||!shaka.util.Platform.supportsMediaSource()||i.mediaSourceEngine_){o.jumpTo(6);break}return o.yield(i.initializeMediaSourceEngineInner_(),6);case 6:o.enterFinallyBlock(),i.mutex_.release(),o.leaveFinallyBlock(0);break;case 5:return a=o.enterCatchBlock(),o.yield(i.detach(),10);case 10:throw a}}))},shaka.Player.prototype.attachCanvas=function(e){this.lcevcCanvas_=e},shaka.Player.prototype.detach=function(e){e=void 0!==e&&e;var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress){if(t.loadMode_==shaka.Player.LoadMode.DESTROYED)throw t.createAbortLoadError_();return r.yield(t.unload(!1,e),2)}if(3!=r.nextAddress)return r.yield(t.atomicOperationAcquireMutex_("detach"),3);if(r.yieldResult)return r.return();try{t.video_&&(t.attachEventManager_.removeAll(),t.video_=null),t.makeStateChangeEvent_("detach"),t.adManager_&&!e&&t.adManager_.release()}finally{t.mutex_.release()}r.jumpToEnd()}))},shaka.Player.prototype.atomicOperationAcquireMutex_=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(t=++r.operationId_,n.yield(r.mutex_.acquire(e),2)):t!=r.operationId_?(r.mutex_.release(),n.return(!0)):n.return(!1)}))},shaka.Player.prototype.unload=function(e,t){e=void 0===e||e,t=void 0!==t&&t;var r,n,a,i,o,s,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){switch(p.nextAddress){case 1:return d.loadMode_!=shaka.Player.LoadMode.DESTROYED&&(d.loadMode_=shaka.Player.LoadMode.NOT_LOADED),p.yield(d.atomicOperationAcquireMutex_("unload"),2);case 2:return p.yieldResult?p.return():(p.setFinallyBlock(3),d.fullyLoaded_=!1,d.makeStateChangeEvent_("unload"),e&&!shaka.util.Platform.supportsMediaSource()&&(e=!1),d.closeLcevcDec_(),r=d.cleanupOnUnload_.map((function(e){return e()})),d.cleanupOnUnload_=[],p.yield(Promise.all(r),5));case 5:if(d.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Unloading)),d.regionTimeline_&&(d.regionTimeline_.release(),d.regionTimeline_=null),d.video_&&(d.loadEventManager_.removeAll(),d.trickPlayEventManager_.removeAll()),d.checkVariantsTimer_.stop(),d.playheadObservers_&&(d.playheadObservers_.release(),d.playheadObservers_=null),d.bufferPoller_&&(d.bufferPoller_.stop(),d.bufferPoller_=null),!d.parser_){p.jumpTo(6);break}return p.yield(d.parser_.stop(),7);case 7:d.parser_=null,d.parserFactory_=null;case 6:if(!d.abrManager_){p.jumpTo(8);break}return p.yield(d.abrManager_.stop(),8);case 8:if(!d.streamingEngine_){p.jumpTo(10);break}return p.yield(d.streamingEngine_.destroy(),11);case 11:d.streamingEngine_=null;case 10:if(d.playRateController_&&(d.playRateController_.release(),d.playRateController_=null),d.playhead_&&(d.playhead_.release(),d.playhead_=null),!d.mediaSourceEngine_){p.jumpTo(12);break}return p.yield(d.mediaSourceEngine_.destroy(),13);case 13:d.mediaSourceEngine_=null;case 12:if(d.adManager_&&!t&&d.adManager_.onAssetUnload(),d.cmsdManager_&&d.cmsdManager_.reset(),d.video_&&shaka.util.Dom.removeAllChildren(d.video_),!d.video_||!d.video_.src){p.jumpTo(14);break}return p.yield(new Promise((function(e){return new shaka.util.Timer(e).tickAfter(.1)})),15);case 15:d.video_.removeAttribute("src"),d.video_.load();case 14:if(!d.drmEngine_){p.jumpTo(16);break}return p.yield(d.drmEngine_.destroy(),17);case 17:d.drmEngine_=null;case 16:if(d.assetUri_=null,d.mimeType_=null,d.bufferObserver_=null,d.manifest_){for(n=$jscomp.makeIterator(d.manifest_.variants),a=n.next();!a.done;a=n.next())for(i=a.value,o=$jscomp.makeIterator([i.audio,i.video]),s=o.next();!s.done;s=o.next())(l=s.value)&&l.segmentIndex&&l.segmentIndex.release();for(u=$jscomp.makeIterator(d.manifest_.textStreams),s=u.next();!s.done;s=u.next())(c=s.value).segmentIndex&&c.segmentIndex.release()}d.manifest_=null,d.stats_=new shaka.util.Stats,d.lastTextFactory_=null,d.externalSrcEqualsThumbnailsStreams_=[],d.completionPercent_=NaN,d.updateBufferState_();case 3:p.enterFinallyBlock(),d.mutex_.release(),p.leaveFinallyBlock(4);break;case 4:if(e&&shaka.util.Platform.supportsMediaSource()&&!d.mediaSourceEngine_)return p.yield(d.initializeMediaSourceEngineInner_(),0);p.jumpTo(0)}}))},shaka.Player.prototype.updateStartTime=function(e){this.startTime_=e},shaka.Player.prototype.load=function(e,t,r){t=void 0===t?null:t;var n,a,i,o,s,l,u,c,d,p,h,f,m,g=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(y){switch(y.nextAddress){case 1:if(g.loadMode_==shaka.Player.LoadMode.DESTROYED)throw g.createAbortLoadError_();return n=null,a="",e instanceof shaka.media.PreloadManager?a=(n=e).getAssetUri()||"":a=e||"",y.yield(g.mutex_.acquire("load"),2);case 2:if(g.mutex_.release(),!g.video_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.NO_VIDEO_ELEMENT);if(!g.assetUri_){y.jumpTo(3);break}return y.yield(g.unload(!1),3);case 3:if(i=++g.operationId_,o=function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){if(1==e.nextAddress)return g.operationId_==i?e.jumpTo(0):n?e.yield(n.destroy(),3):e.jumpTo(3);throw g.createAbortLoadError_()}))},s=function(e,t){return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){switch(r.nextAddress){case 1:return r.setFinallyBlock(2),r.yield(g.mutex_.acquire(t),4);case 4:return r.yield(o(),5);case 5:return r.yield(e(),6);case 6:return r.yield(o(),7);case 7:n&&g.config_&&n.reconfigure(g.config_);case 2:r.enterFinallyBlock(),g.mutex_.release(),r.leaveFinallyBlock(0)}}))},y.setCatchFinallyBlocks(5,6),null==t&&n&&(t=n.getStartTime()),g.startTime_=t,g.fullyLoaded_=!1,g.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Loading)),n){r=n.getMimeType(),y.jumpTo(8);break}if(r){y.jumpTo(8);break}return y.yield(s((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){if(1==e.nextAddress)return e.yield(g.guessMimeType_(a),2);r=e.yieldResult,e.jumpToEnd()}))}),"guessMimeType_"),8);case 8:if(l=!!n,n){n.setEventHandoffTarget(g),g.stats_=n.getStats(),y.jumpTo(11);break}return y.yield(g.preloadInner_(a,t,r,!0),12);case 12:(n=y.yieldResult)?(n.setEventHandoffTarget(g),g.stats_=n.getStats(),n.start(),n.waitForFinish().catch((function(){}))):g.stats_=new shaka.util.Stats;case 11:if(u=!n,c=n?n.getStartTimeOfLoad():Date.now()/1e3,g.stats_=n?n.getStats():new shaka.util.Stats,g.assetUri_=a,g.mimeType_=r||null,u)return y.yield(s((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return goog.asserts.assert(r,"We should know the mimeType by now!"),e.yield(g.initializeSrcEqualsDrmInner_(r),0)}))}),"initializeSrcEqualsDrmInner_"),20);if(g.mediaSourceEngine_){y.jumpTo(15);break}return y.yield(s((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return e.yield(g.initializeMediaSourceEngineInner_(),0)}))}),"initializeMediaSourceEngineInner_"),15);case 15:return y.yield(s((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return e.yield(n.waitForFinish(),0)}))}),"waitForFinish"),17);case 17:return g.config_=n.getConfiguration(),g.manifestFilterer_=n.getManifestFilterer(),g.parserFactory_=n.getParserFactory(),g.parser_=n.receiveParser(),g.regionTimeline_=n.receiveRegionTimeline(),g.qualityObserver_=n.getQualityObserver(),g.manifest_=n.getManifest(),(d=n.getCurrentAdaptationSetCriteria())&&(g.currentAdaptationSetCriteria_=d),l&&g.video_&&"AUDIO"===g.video_.nodeName&&(g.makeManifestAudioOnly_(),g.configure("manifest.disableVideo",!0)),g.drmEngine_=n.receiveDrmEngine(),y.yield(s((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return e.yield(g.drmEngine_.attach(g.video_),0)}))}),"drmEngine_.attach"),18);case 18:return!(p=n.getAbrManagerFactory())||g.abrManagerFactory_&&g.abrManagerFactory_==p||(g.abrManager_=n.receiveAbrManager(),g.abrManagerFactory_=n.getAbrManagerFactory(),"function"!=typeof g.abrManager_.setMediaElement&&(shaka.Deprecate.deprecateFeature(5,"AbrManager w/o setMediaElement","Please use an AbrManager with setMediaElement function."),g.abrManager_.setMediaElement=function(){}),"function"!=typeof g.abrManager_.setCmsdManager&&(shaka.Deprecate.deprecateFeature(5,"AbrManager w/o setCmsdManager","Please use an AbrManager with setCmsdManager function."),g.abrManager_.setCmsdManager=function(){}),"function"!=typeof g.abrManager_.trySuggestStreams&&(shaka.Deprecate.deprecateFeature(5,"AbrManager w/o trySuggestStreams","Please use an AbrManager with trySuggestStreams function."),g.abrManager_.trySuggestStreams=function(){})),h=n.receiveSegmentPrefetchesById(),f=n.getPrefetchedVariant(),y.yield(s((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return e.yield(g.loadInner_(c,f,h),0)}))}),"loadInner_"),19);case 19:n.stopQueuingLatePhaseQueuedOperations(),y.jumpTo(14);break;case 20:return y.yield(s((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return goog.asserts.assert(r,"We should know the mimeType by now!"),e.yield(g.srcEqualsInner_(c,r),0)}))}),"srcEqualsInner_"),14);case 14:g.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Loaded));case 6:if(y.enterFinallyBlock(),!n){y.jumpTo(22);break}return y.yield(n.destroy(),22);case 22:y.leaveFinallyBlock(0);break;case 5:if((m=y.enterCatchBlock()).code==shaka.util.Error.Code.LOAD_INTERRUPTED){y.jumpTo(24);break}return y.yield(g.unload(!1),24);case 24:throw m}}))},shaka.Player.prototype.makeManifestAudioOnly_=function(){for(var e=$jscomp.makeIterator(this.manifest_.variants),t=e.next();!t.done;t=e.next())(t=t.value).video&&(t.video.closeSegmentIndex(),t.video=null),t.bandwidth=t.audio&&t.audio.bandwidth?t.audio.bandwidth:0;this.manifest_.variants=this.manifest_.variants.filter((function(e){return e.audio}))},shaka.Player.prototype.unloadAndSavePreload=function(e,t){e=void 0===e||e,t=void 0!==t&&t;var r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:if(r=null,!(i.manifest_&&i.parser_&&i.parserFactory_&&i.assetUri_)){o.jumpTo(2);break}return n=i.video_.currentTime,i.isLive()&&(n=null),a=Date.now()/1e3,o.yield(i.makePreloadManager_(i.assetUri_,n,i.mimeType_,a,!0,!1,!1),3);case 3:(r=o.yieldResult).attachManifest(i.manifest_,i.parser_,i.parserFactory_),r.attachAbrManager(i.abrManager_,i.abrManagerFactory_),r.attachAdaptationSetCriteria(i.currentAdaptationSetCriteria_),r.start(),i.manifest_=null,i.parser_=null,i.parserFactory_=null,i.abrManager_=null,i.abrManagerFactory_=null;case 2:return o.yield(i.unload(e,t),4);case 4:return o.return(r)}}))},shaka.Player.prototype.preload=function(e,t,r){t=void 0===t?null:t;var n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?i.yield(a.preloadInner_(e,t,r),2):((n=i.yieldResult)?n.start():a.onError_(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.SRC_EQUALS_PRELOAD_NOT_SUPPORTED)),i.return(n))}))},shaka.Player.prototype.preloadInner_=function(e,t,r,n){n=void 0!==n&&n;var a,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){return 1==l.nextAddress?(goog.asserts.assert(s.networkingEngine_,"Should have a net engine!"),goog.asserts.assert(s.config_,"Config must not be null!"),a=Date.now()/1e3,r?l.jumpTo(2):l.yield(s.guessMimeType_(e),3)):(2!=l.nextAddress&&(r=l.yieldResult),s.shouldUseSrcEquals_(e,r)?l.return(null):(i=!1,o=!0,n&&(s.abrManager_&&s.abrManagerFactory_==s.config_.abrFactory&&(o=!1),s.video_&&"AUDIO"===s.video_.nodeName&&(i=!0)),l.return(s.makePreloadManager_(e,t,r||null,a,!n,i,o))))}))},shaka.Player.prototype.makePreloadManager_=function(e,t,r,n,a,i,o){a=void 0===a||a,i=void 0!==i&&i,o=void 0===o||o;var s,l,u,c,d,p,h,f,m,g,y,v,_,k,E=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(b){return 1==b.nextAddress?(goog.asserts.assert(E.networkingEngine_,"Must have net engine"),s=null,l=shaka.util.ObjectUtils.cloneObject(E.config_),i&&(l.manifest.disableVideo=!0),u=function(){return goog.asserts.assert(s,"Must have preload manager"),s.hasBeenAttached()&&s.isDestroyed()?null:s},c=function(){return u()?u().getConfiguration():E.config_},d=function(e,t){u()?s.configure(e,t):E.configure(e,t)},1/0!=E.maxHwRes_.width||1/0!=E.maxHwRes_.height?b.jumpTo(2):b.yield(shaka.util.Platform.detectMaxHardwareResolution(),3)):(2!=b.nextAddress&&(p=b.yieldResult,E.maxHwRes_.width=p.width,E.maxHwRes_.height=p.height),h=new shaka.media.ManifestFilterer(l,E.maxHwRes_,null),f={networkingEngine:E.networkingEngine_,filter:function(e){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?r.yield(h.filterManifest(e),2):4!=r.nextAddress?r.yieldResult?(t=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.TracksChanged),r.yield(Promise.resolve(),4)):r.jumpTo(0):(s.dispatchEvent(t),void r.jumpToEnd())}))},makeTextStreamsForClosedCaptions:function(e){return E.makeTextStreamsForClosedCaptions_(e)},onTimelineRegionAdded:function(e){s.getRegionTimeline().addRegion(e)},onEvent:function(e){return s.dispatchEvent(e)},onError:function(e){return s.onError(e)},isLowLatencyMode:function(){return c().streaming.lowLatencyMode},isAutoLowLatencyMode:function(){return c().streaming.autoLowLatencyMode},enableLowLatencyMode:function(){d("streaming.lowLatencyMode",!0)},updateDuration:function(){E.streamingEngine_&&s.hasBeenAttached()&&E.streamingEngine_.updateDuration()},newDrmInfo:function(e){var t=s.getDrmEngine(),r=t?t.getDrmInfo():null;r&&t.getMediaKeys()&&h.processDrmInfos(r.keySystem,e)},onManifestUpdated:function(){var e=shaka.util.FakeEvent.EventName.ManifestUpdated,t=(new Map).set("isLive",E.isLive());s.dispatchEvent(shaka.Player.makeEvent_(e,t)),s.addQueuedOperation(!1,(function(){E.adManager_&&E.adManager_.onManifestUpdated(E.isLive())}))},getBandwidthEstimate:function(){return E.abrManager_.getBandwidthEstimate()}},(m=new shaka.media.RegionTimeline((function(){return E.seekRange()}))).addEventListener("regionadd",(function(e){var t=e.region;E.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionAdded,t,s),s.addQueuedOperation(!1,(function(){E.adManager_&&E.adManager_.onDashTimedMetadata(t)}))})),g=null,l.streaming.observeQualityChanges&&(g=new shaka.media.QualityObserver((function(){return E.getBufferedInfo()}))).addEventListener("qualitychange",(function(e){E.onMediaQualityChange_(e.quality,e.position)})),y=!0,v={netEngine:E.networkingEngine_,onError:function(e){return s.onError(e)},onKeyStatus:function(e){s.addQueuedOperation(!0,(function(){E.onKeyStatus_(e)}))},onExpirationUpdated:function(e,t){var r=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.ExpirationUpdated);s.dispatchEvent(r),(r=s.getParser())&&r.onExpirationUpdated&&r.onExpirationUpdated(e,t)},onEvent:function(e){s.dispatchEvent(e),e.type==shaka.util.FakeEvent.EventName.DrmSessionUpdate&&y&&(y=!1,e=Date.now()/1e3-s.getStartTimeOfDRM(),(E.stats_||s.getStats()).setDrmTime(e),E.lcevcDec_&&E.lcevcDec_.hideCanvas())}},_=E.createNetworkingEngine(u),E.networkingEngine_.copyFiltersInto(_),k={config:l,manifestPlayerInterface:f,regionTimeline:m,qualityObserver:g,createDrmEngine:function(){return E.createDrmEngine(v)},manifestFilterer:h,networkingEngine:_,allowPrefetch:a,allowMakeAbrManager:o},s=new shaka.media.PreloadManager(e,r,n,t,k),E.createdPreloadManagers_.push(s),b.return(s))}))},shaka.Player.prototype.guessMimeType_=function(e){var t,r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(goog.asserts.assert(n.networkingEngine_,"Should have a net engine!"),t=n.config_.manifest.retryParameters,a.yield(shaka.net.NetworkingUtils.getMimeType(e,n.networkingEngine_,t),2)):("application/x-mpegurl"==(r=a.yieldResult)&&shaka.util.Platform.isApple()&&(r="application/vnd.apple.mpegurl"),a.return(r))}))},shaka.Player.prototype.shouldUseSrcEquals_=function(e,t){e=shaka.util.Platform;var r=shaka.util.MimeUtils;if(!e.supportsMediaSource())return!0;if(t){var n=""!=(this.video_||e.anyMediaElement()).canPlayType(t);if(!n)return!1;var a=shaka.media.ManifestParser.isSupported(t);if(!a)return!0;if(goog.asserts.assert(n&&a,"Both native and MSE playback should be possible!"),r.isHlsType(t)){if(this.config_.streaming.preferNativeHls)return!0;if(e.isApple()&&(this.config_.drm.servers["com.apple.fps"]||this.config_.drm.servers["com.apple.fps.1_0"]))return this.config_.streaming.useNativeHlsForFairPlay;if(e.isApple())return this.config_.streaming.useNativeHlsOnSafari}}return!1},shaka.Player.prototype.initializeMediaSourceEngineInner_=function(){var e,t,r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){if(1==o.nextAddress)return goog.asserts.assert(shaka.util.Platform.supportsMediaSource(),"We should not be initializing media source on a platform that does not support media source."),goog.asserts.assert(i.video_,"We should have a media element when initializing media source."),goog.asserts.assert(null==i.mediaSourceEngine_,"We should not have a media source engine yet."),i.makeStateChangeEvent_("media-source"),e=i.config_.textDisplayFactory,(t=e()).configure?t.configure(i.config_.textDisplayer):shaka.Deprecate.deprecateFeature(5,"Text displayer w/ configure",'Text displayer should have a "configure" method!'),i.lastTextFactory_=e,r=i.createMediaSourceEngine(i.video_,t,(function(e,t,r){i.processTimedMetadataMediaSrc_(e,t,r)}),i.lcevcDec_),r.configure(i.config_.mediaSource),n=i.config_.manifest,a=n.segmentRelativeVttTiming,r.setSegmentRelativeVttTiming(a),o.yield(r.open(),2);i.mediaSourceEngine_=r,o.jumpToEnd()}))},shaka.Player.prototype.loadInner_=function(e,t,r){var n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(S){switch(S.nextAddress){case 1:for(goog.asserts.assert(A.video_,"We should have a media element by now."),goog.asserts.assert(A.manifest_,"The manifest should already be parsed."),goog.asserts.assert(A.assetUri_,"We should have an asset uri by now."),goog.asserts.assert(A.abrManager_,"We should have an abr manager by now."),A.makeStateChangeEvent_("load"),n=A.video_,A.playRateController_=new shaka.media.PlayRateController({getRate:function(){return n.playbackRate},getDefaultRate:function(){return n.defaultPlaybackRate},setRate:function(e){n.playbackRate=e},movePlayhead:function(e){n.currentTime+=e}}),a=function(){return A.updateStateHistory_()},i=function(){return A.onRateChange_()},A.loadEventManager_.listen(n,"playing",a),A.loadEventManager_.listen(n,"pause",a),A.loadEventManager_.listen(n,"ended",a),A.loadEventManager_.listen(n,"ratechange",i),A.setupLcevc_(A.config_),A.currentTextLanguage_=A.config_.preferredTextLanguage,A.currentTextRole_=A.config_.preferredTextRole,A.currentTextForced_=A.config_.preferForcedSubs,shaka.Player.applyPlayRange_(A.manifest_.presentationTimeline,A.config_.playRangeStart,A.config_.playRangeEnd),A.abrManager_.init((function(e,t,r){return A.switch_(e,t,r)})),A.abrManager_.setMediaElement(n),A.abrManager_.setCmsdManager(A.cmsdManager_),A.streamingEngine_=A.createStreamingEngine(),A.streamingEngine_.configure(A.config_.streaming),A.loadMode_=shaka.Player.LoadMode.MEDIA_SOURCE,n.textTracks&&A.loadEventManager_.listen(n.textTracks,"addtrack",(function(e){if(e.track&&"chapters"===(e=e.track,goog.asserts.assert(e instanceof TextTrack,"Wrong track type!"),e.kind))A.activateChaptersTrack_(e)})),A.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Streaming)),o=t,(s=A.streamingEngine_.getCurrentVariant())||o||(o=A.chooseVariant_(!0),goog.asserts.assert(o,"Must choose an initial variant!")),l=[],u=s||o,c=$jscomp.makeIterator([u.video,u.audio]),d=c.next();!d.done;d=c.next())(p=d.value)&&!p.segmentIndex&&l.push(p.createSegmentIndex());if(!(0<l.length)){S.jumpTo(2);break}return S.yield(Promise.all(l),2);case 2:if(A.parser_&&A.parser_.onInitialVariantChosen&&A.parser_.onInitialVariantChosen(u),shaka.Player.applyPlayRange_(A.manifest_.presentationTimeline,A.config_.playRangeStart,A.config_.playRangeEnd),h=function(e){A.playhead_=A.createPlayhead(e),A.playheadObservers_=A.createPlayheadObserversForMSE_(e),A.startBufferManagement_(n,Math.max(A.manifest_.minBufferTime,A.config_.streaming.rebufferingGoal))},A.config_.streaming.startAtSegmentBoundary||h(A.startTime_),s){S.jumpTo(4);break}if(goog.asserts.assert(o,"Must have choosen an initial variant!"),!A.config_.streaming.startAtSegmentBoundary){S.jumpTo(5);break}return f=A.manifest_.presentationTimeline,m=A.startTime_||A.video_.currentTime,g=f.getSeekRangeStart(),y=f.getSeekRangeEnd(),m<g?m=g:m>y&&(m=y),S.yield(A.adjustStartTime_(o,m),6);case 6:v=S.yieldResult,h(v);case 5:A.switchVariant_(o,!0,!1,0);case 4:return A.playhead_.ready(),A.getTextTracks().find((function(e){return e.active}))||((_=A.chooseTextStream_())&&A.addTextStreamToSwitchHistory_(_,!0),o&&A.setInitialTextState_(o,_),_&&A.shouldStreamText_()&&A.streamingEngine_.switchTextStream(_)),S.yield(A.streamingEngine_.start(r),7);case 7:A.config_.abr.enabled&&(A.abrManager_.enable(),A.onAbrStatusChanged_()),A.onTracksChanged_(),A.updateAbrManagerVariants_(),k=A.manifest_.variants.some((function(e){return e.primary})),A.config_.preferredAudioLanguage||k||shaka.log.warning("No preferred audio language set.  We have chosen an arbitrary language initially"),((E=A.isLive())&&(A.config_.streaming.liveSync||A.manifest_.serviceDescription||A.config_.streaming.liveSyncPanicMode)||A.config_.streaming.vodDynamicPlaybackRate)&&(b=function(){return A.onTimeUpdate_()},A.loadEventManager_.listen(n,"timeupdate",b)),E||(T=function(){return A.onVideoProgress_()},A.loadEventManager_.listen(n,"timeupdate",T),A.onVideoProgress_()),A.adManager_&&A.adManager_.onManifestUpdated(E),A.fullyLoaded_=!0,A.loadEventManager_.listenOnce(n,"loadedmetadata",(function(){var t=Date.now()/1e3-e;A.stats_.setLoadLatency(t)})),S.jumpToEnd()}}))},shaka.Player.prototype.initializeSrcEqualsDrmInner_=function(e){var t,r,n,a,i,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return 1==s.nextAddress?(t=shaka.util.ManifestParserUtils.ContentType,goog.asserts.assert(o.networkingEngine_,"|onInitializeSrcEqualsDrm_| should never be called after |destroy|"),goog.asserts.assert(o.config_,"|onInitializeSrcEqualsDrm_| should never be called after |destroy|"),r=Date.now()/1e3,n=!0,o.drmEngine_=o.createDrmEngine({netEngine:o.networkingEngine_,onError:function(e){o.onError_(e)},onKeyStatus:function(e){},onExpirationUpdated:function(e,t){e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.ExpirationUpdated),o.dispatchEvent(e)},onEvent:function(e){o.dispatchEvent(e),e.type==shaka.util.FakeEvent.EventName.DrmSessionUpdate&&n&&(n=!1,e=Date.now()/1e3-r,o.stats_.setDrmTime(e))}}),o.drmEngine_.configure(o.config_.drm),a={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},(i={id:0,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:e?shaka.util.MimeUtils.getBasicType(e):"",codecs:e?shaka.util.MimeUtils.getCodecs(e):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:t.VIDEO,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set}).fullMimeTypes.add(shaka.util.MimeUtils.getFullType(i.mimeType,i.codecs)),e.startsWith("audio/")?(i.type=t.AUDIO,a.audio=i):a.video=i,o.drmEngine_.setSrcEquals(!0),s.yield(o.drmEngine_.initForPlayback([a],[]),2)):s.yield(o.drmEngine_.attach(o.video_),0)}))},shaka.Player.prototype.srcEqualsInner_=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(f){if(1==f.nextAddress)return h.makeStateChangeEvent_("src-equals"),goog.asserts.assert(h.video_,"We should have a media element when loading."),goog.asserts.assert(h.assetUri_,"We should have a valid uri when loading."),r=h.video_,h.playhead_=new shaka.media.SrcEqualsPlayhead(r),n=!1,h.cleanupOnUnload_.push((function(){n=!0})),null!=h.startTime_&&h.playhead_.setStartTime(h.startTime_),h.playRateController_=new shaka.media.PlayRateController({getRate:function(){return r.playbackRate},getDefaultRate:function(){return r.defaultPlaybackRate},setRate:function(e){r.playbackRate=e},movePlayhead:function(e){r.currentTime+=e}}),a=h.config_.streaming.rebufferingGoal,h.startBufferManagement_(r,a),i=function(){return h.updateStateHistory_()},o=function(){return h.onRateChange_()},h.loadEventManager_.listen(r,"playing",i),h.loadEventManager_.listen(r,"pause",i),h.loadEventManager_.listen(r,"ended",i),h.loadEventManager_.listen(r,"ratechange",o),"none"!=r.preload&&h.loadEventManager_.listenOnce(r,"loadedmetadata",(function(){var t=Date.now()/1e3-e;h.stats_.setLoadLatency(t)})),r.audioTracks&&(h.loadEventManager_.listen(r.audioTracks,"addtrack",(function(){return h.onTracksChanged_()})),h.loadEventManager_.listen(r.audioTracks,"removetrack",(function(){return h.onTracksChanged_()})),h.loadEventManager_.listen(r.audioTracks,"change",(function(){return h.onTracksChanged_()}))),r.textTracks&&(h.loadEventManager_.listen(r.textTracks,"addtrack",(function(e){if(e.track)switch(e=e.track,goog.asserts.assert(e instanceof TextTrack,"Wrong track type!"),e.kind){case"metadata":h.processTimedMetadataSrcEqls_(e);break;case"chapters":h.activateChaptersTrack_(e);break;default:h.onTracksChanged_()}})),h.loadEventManager_.listen(r.textTracks,"removetrack",(function(){return h.onTracksChanged_()})),h.loadEventManager_.listen(r.textTracks,"change",(function(){return h.onTracksChanged_()}))),r.src=h.cmcdManager_.appendSrcData(h.assetUri_,t),(shaka.util.Platform.isTizen()||shaka.util.Platform.isWebOS())&&r.load(),"none"!=r.preload&&!r.autoplay&&shaka.util.MimeUtils.isHlsType(t)&&shaka.util.Platform.safariVersion()&&r.load(),h.loadMode_=shaka.Player.LoadMode.SRC_EQUALS,h.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Streaming)),s=new shaka.util.PublicPromise,shaka.util.MediaReadyState.waitForReadyState(r,HTMLMediaElement.HAVE_METADATA,h.loadEventManager_,(function(){h.playhead_.ready(),s.resolve()})),shaka.util.MediaReadyState.waitForReadyState(r,HTMLMediaElement.HAVE_CURRENT_DATA,h.loadEventManager_,(function(){var e;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?(h.setupPreferredAudioOnSrc_(),(e=h.getFilteredTextTracks_()).find((function(e){return"disabled"!=e.mode}))?(0<e.length&&(h.isTextVisible_=!0),t.jumpTo(2)):t.yield(new Promise((function(e){h.loadEventManager_.listenOnce(r.textTracks,"change",e),new shaka.util.Timer(e).tickAfter(1)})),2)):n?t.return():(h.setupPreferredTextOnSrc_(),void t.jumpToEnd())}))})),r.error?s.reject(h.videoErrorToShakaError_()):"none"==r.preload&&(shaka.log.alwaysWarn('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),s.resolve()),h.loadEventManager_.listenOnce(r,"error",(function(){s.reject(h.videoErrorToShakaError_())})),l=new Promise((function(e,t){new shaka.util.Timer(t).tickAfter(h.config_.streaming.loadTimeout)})),f.yield(Promise.race([s,l]),2);((u=h.isLive())&&(h.config_.streaming.liveSync||h.config_.streaming.liveSyncPanicMode)||h.config_.streaming.vodDynamicPlaybackRate)&&(c=function(){return h.onTimeUpdate_()},h.loadEventManager_.listen(r,"timeupdate",c)),u||(d=function(){return h.onVideoProgress_()},h.loadEventManager_.listen(r,"timeupdate",d),h.onVideoProgress_()),h.adManager_&&(h.adManager_.onManifestUpdated(u),u&&(p=h.seekRange().end,h.loadEventManager_.listen(r,"progress",(function(){var e=h.seekRange().end;p!=e&&(h.adManager_.onManifestUpdated(h.isLive()),p=e)})))),h.fullyLoaded_=!0,f.jumpToEnd()}))},shaka.Player.prototype.setupPreferredAudioOnSrc_=function(){var e=this.config_.preferredAudioLanguage;""!=e&&this.selectAudioLanguage(e,this.config_.preferredVariantRole)},shaka.Player.prototype.setupPreferredTextOnSrc_=function(){var e=this.config_.preferredTextLanguage;""!=e&&this.selectTextLanguage(e,this.config_.preferredTextRole,this.config_.preferForcedSubs)},shaka.Player.prototype.processTimedMetadataSrcEqls_=function(e){var t=this;if("metadata"==e.kind){e.mode="hidden",this.loadEventManager_.listen(e,"cuechange",(function(){if(e.activeCues)for(var r=$jscomp.makeIterator(e.activeCues),n=r.next();!n.done;n=r.next())n=n.value,t.dispatchMetadataEvent_(n.startTime,n.endTime,n.type,n.value),t.adManager_&&t.adManager_.onCueMetadataChange(n.value)}));var r=new shaka.util.Timer((function(){for(var e=t.getMetadataTracks_(),r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())r.value.mode="hidden"})).tickNow().tickAfter(.5);this.cleanupOnUnload_.push((function(){r.stop()}))}},shaka.Player.prototype.processTimedMetadataMediaSrc_=function(e,t,r){for(var n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())if((n=n.value).data&&n.cueTime&&n.frames){var a=n.cueTime+t,i=r;i&&a>i&&(i=a);for(var o=$jscomp.makeIterator(n.frames),s=o.next();!s.done;s=o.next())this.dispatchMetadataEvent_(a,i,"org.id3",s.value);this.adManager_&&this.adManager_.onHlsTimedMetadata(n,a)}},shaka.Player.prototype.dispatchMetadataEvent_=function(e,t,r,n){goog.asserts.assert(!t||e<=t,"Metadata start time should be less or equal to the end time!");var a=shaka.util.FakeEvent.EventName.Metadata;e=(new Map).set("startTime",e).set("endTime",t).set("metadataType",r).set("payload",n),this.dispatchEvent(shaka.Player.makeEvent_(a,e))},shaka.Player.prototype.activateChaptersTrack_=function(e){if(e&&"chapters"==e.kind){e.mode="hidden";var t=new shaka.util.Timer((function(){e.mode="hidden"})).tickNow().tickAfter(.5);this.cleanupOnUnload_.push((function(){t.stop()}))}},shaka.Player.prototype.releaseAllMutexes=function(){this.mutex_.releaseAll()},shaka.Player.prototype.createDrmEngine=function(e){return new shaka.media.DrmEngine(e)},shaka.Player.prototype.createNetworkingEngine=function(e){var t=this;e||(e=function(){return null});var r=function(t){e()?e().addQueuedOperation(!0,t):t()},n=function(r){e()?e().dispatchEvent(r):t.dispatchEvent(r)};return new shaka.net.NetworkingEngine((function(r,n,a,i){var o=e()?e().getAbrManager():t.abrManager_;o&&o.segmentDownloaded(r,n,a,i)}),(function(e,a,i){var o=shaka.util.FakeEvent.EventName.DownloadHeadersReceived;a=(new Map).set("headers",e).set("request",a).set("requestType",i),n(shaka.Player.makeEvent_(o,a)),r((function(){t.cmsdManager_&&t.cmsdManager_.processHeaders(e)}))}),(function(e,t,r,a){var i=shaka.util.FakeEvent.EventName.DownloadFailed;e=(new Map).set("request",e).set("error",t).set("httpResponseCode",r).set("aborted",a),n(shaka.Player.makeEvent_(i,e))}),(function(e,n,a){r((function(){t.cmcdManager_.applyData(e,n,a)}))}),(function(r,n,a,i){(r=e()?e().getParser():t.parser_)&&r.banLocation&&r.banLocation(i)}),(function(r,n,a){n.data&&(r=n.data.byteLength,(n=e()?e().getStats():t.stats_)&&n.addBytesDownloaded(r))}))},shaka.Player.prototype.createPlayhead=function(e){var t=this;return goog.asserts.assert(this.manifest_,"Must have manifest"),goog.asserts.assert(this.video_,"Must have video"),new shaka.media.MediaSourcePlayhead(this.video_,this.manifest_,this.config_.streaming,e,(function(){return t.onSeek_()}),(function(e){return t.dispatchEvent(e)}))},shaka.Player.prototype.createPlayheadObserversForMSE_=function(e){var t=this;goog.asserts.assert(this.manifest_,"Must have manifest"),goog.asserts.assert(this.regionTimeline_,"Must have region timeline"),goog.asserts.assert(this.video_,"Must have video element"),e=this.isLive()||0<e,(e=new shaka.media.RegionObserver(this.regionTimeline_,e)).addEventListener("enter",(function(e){t.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionEnter,e.region)})),e.addEventListener("exit",(function(e){t.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionExit,e.region)})),e.addEventListener("skip",(function(e){var r=e.region;e.seeking||(t.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionEnter,r),t.onRegionEvent_(shaka.util.FakeEvent.EventName.TimelineRegionExit,r))}));var r=new shaka.media.PlayheadObserverManager(this.video_);return r.manage(e),this.qualityObserver_&&r.manage(this.qualityObserver_),r},shaka.Player.prototype.startBufferManagement_=function(e,t){var r=this;goog.asserts.assert(!this.bufferObserver_,"No buffering observer should exist before initialization."),goog.asserts.assert(!this.bufferPoller_,"No buffer timer should exist before initialization."),this.bufferObserver_=new shaka.media.BufferingObserver(1,2),this.bufferObserver_.setState(shaka.media.BufferingObserver.State.STARVING),this.updateBufferingSettings_(t),this.updateBufferState_(),this.bufferPoller_=new shaka.util.Timer((function(){r.pollBufferState_()})).tickEvery(.25),this.loadEventManager_.listen(e,"waiting",(function(e){return r.pollBufferState_()})),this.loadEventManager_.listen(e,"stalled",(function(e){return r.pollBufferState_()})),this.loadEventManager_.listen(e,"canplaythrough",(function(e){return r.pollBufferState_()})),this.loadEventManager_.listen(e,"progress",(function(e){return r.pollBufferState_()}))},shaka.Player.prototype.updateBufferingSettings_=function(e){this.bufferObserver_.setThresholds(e,Math.min(shaka.Player.TYPICAL_BUFFERING_THRESHOLD_,e/2))},shaka.Player.prototype.pollBufferState_=function(){switch(goog.asserts.assert(this.video_,"Need a media element to update the buffering observer"),goog.asserts.assert(this.bufferObserver_,"Need a buffering observer to update"),this.loadMode_){case shaka.Player.LoadMode.SRC_EQUALS:var e=this.isBufferedToEndSrc_();break;case shaka.Player.LoadMode.MEDIA_SOURCE:e=this.isBufferedToEndMS_();break;default:e=!1}var t=shaka.media.TimeRangesUtils.bufferedAheadOf(this.video_.buffered,this.video_.currentTime);this.bufferObserver_.update(t,e)&&this.updateBufferState_()},shaka.Player.prototype.createMediaSourceEngine=function(e,t,r,n){return new shaka.media.MediaSourceEngine(e,t,r,n)},shaka.Player.prototype.createCmcd_=function(){var e=this;return new shaka.util.CmcdManager({getBandwidthEstimate:function(){return e.abrManager_?e.abrManager_.getBandwidthEstimate():NaN},getBufferedInfo:function(){return e.getBufferedInfo()},getCurrentTime:function(){return e.video_?e.video_.currentTime:0},getPlaybackRate:function(){return e.getPlaybackRate()},getNetworkingEngine:function(){return e.getNetworkingEngine()},getVariantTracks:function(){return e.getVariantTracks()},isLive:function(){return e.isLive()}},this.config_.cmcd)},shaka.Player.prototype.createCmsd_=function(){return new shaka.util.CmsdManager(this.config_.cmsd)},shaka.Player.prototype.createStreamingEngine=function(){var e=this;return goog.asserts.assert(this.abrManager_&&this.mediaSourceEngine_&&this.manifest_,"Must not be destroyed"),new shaka.media.StreamingEngine(this.manifest_,{getPresentationTime:function(){return e.playhead_?e.playhead_.getTime():0},getBandwidthEstimate:function(){return e.abrManager_.getBandwidthEstimate()},getPlaybackRate:function(){return e.getPlaybackRate()},mediaSourceEngine:this.mediaSourceEngine_,netEngine:this.networkingEngine_,onError:function(t){return e.onError_(t)},onEvent:function(t){return e.dispatchEvent(t)},onManifestUpdate:function(){return e.onManifestUpdate_()},onSegmentAppended:function(t,r){e.onSegmentAppended_(t.startTime,t.endTime,r.type),e.abrManager_&&r.fastSwitching&&t.isPartial()&&t.isLastPartial()&&e.abrManager_.trySuggestStreams()},onInitSegmentAppended:function(t,r){(r=r.getMediaQuality())&&e.qualityObserver_&&e.qualityObserver_.addMediaQualityChange(r,t)},beforeAppendSegment:function(t,r){return e.drmEngine_.parseInbandPssh(t,r)},onMetadata:function(t,r,n){e.processTimedMetadataMediaSrc_(t,r,n)},disableStream:function(t,r){return e.disableStream(t,r)}})},shaka.Player.prototype.configure=function(e,t){if(goog.asserts.assert(this.config_,"Config must not be null!"),goog.asserts.assert("object"==typeof e||2==arguments.length,"String configs should have values!"),2==arguments.length&&"string"==typeof e&&(e=shaka.util.ConfigUtils.convertToConfigObject(e,t)),goog.asserts.assert("object"==typeof e,"Should be an object!"),e.streaming&&"forceTransmuxTS"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&"forceTransmux"in e.streaming&&(shaka.Deprecate.deprecateFeature(5,"streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),e.mediaSource.mediaSource=e.streaming.forceTransmux,delete e.streaming.forceTransmux),e.streaming&&"useNativeHlsOnSafari"in e.streaming&&shaka.Deprecate.deprecateFeature(5,"streaming.useNativeHlsOnSafari configuration","Please Use streaming.useNativeHlsForFairPlay or streaming.preferNativeHls instead."),e.mediaSource&&"sourceBufferExtraFeatures"in e.mediaSource){shaka.Deprecate.deprecateFeature(5,"mediaSource.sourceBufferExtraFeatures configuration","Please Use mediaSource.addExtraFeaturesToSourceBuffer() instead.");var r=e.mediaSource.sourceBufferExtraFeatures;e.mediaSource.addExtraFeaturesToSourceBuffer=function(){return r},delete e.mediaSource.sourceBufferExtraFeatures}e.streaming&&e.streaming.lowLatencyMode&&(null==e.streaming.inaccurateManifestTolerance&&(e.streaming.inaccurateManifestTolerance=0),null==e.streaming.rebufferingGoal&&(e.streaming.rebufferingGoal=.01),null==e.streaming.segmentPrefetchLimit&&(e.streaming.segmentPrefetchLimit=2),null==e.streaming.updateIntervalSeconds&&(e.streaming.updateIntervalSeconds=.1),null==e.streaming.retryParameters&&(e.streaming.retryParameters={}),null==e.streaming.retryParameters.baseDelay&&(e.streaming.retryParameters.baseDelay=100),null==e.manifest&&(e.manifest={}),null==e.manifest.retryParameters&&(e.manifest.retryParameters={}),null==e.manifest.retryParameters.baseDelay&&(e.manifest.retryParameters.baseDelay=100),null==e.drm&&(e.drm={}),null==e.drm.retryParameters&&(e.drm.retryParameters={}),null==e.drm.retryParameters.baseDelay&&(e.drm.retryParameters.baseDelay=100));var n=shaka.util.PlayerConfiguration.mergeConfigObjects(this.config_,e,this.defaultConfig_());return this.applyConfig_(),n},shaka.Player.prototype.applyConfig_=function(){if(this.manifestFilterer_=new shaka.media.ManifestFilterer(this.config_,this.maxHwRes_,this.drmEngine_),this.parser_){var e=shaka.util.ObjectUtils.cloneObject(this.config_.manifest);this.video_&&"AUDIO"===this.video_.nodeName&&(e.disableVideo=!0),this.parser_.configure(e)}if(this.drmEngine_&&this.drmEngine_.configure(this.config_.drm),this.streamingEngine_){this.streamingEngine_.configure(this.config_.streaming);try{this.loadMode_!=shaka.Player.LoadMode.DESTROYED&&this.manifestFilterer_.filterManifestWithRestrictions(this.manifest_)&&this.onTracksChanged_()}catch(e){this.onError_(e)}this.abrManager_&&this.updateAbrManagerVariants_(),!(e=this.streamingEngine_.getCurrentVariant())||e.allowedByApplication&&e.allowedByKeySystem||(shaka.log.debug("Choosing new variant after changing configuration"),this.chooseVariantAndSwitch_())}if(this.networkingEngine_&&this.networkingEngine_.setForceHTTPS(this.config_.streaming.forceHTTPS),this.mediaSourceEngine_)if(this.mediaSourceEngine_.configure(this.config_.mediaSource),this.mediaSourceEngine_.setSegmentRelativeVttTiming(this.config_.manifest.segmentRelativeVttTiming),e=this.config_.textDisplayFactory,this.lastTextFactory_!=e){var t=e();t.configure?t.configure(this.config_.textDisplayer):shaka.Deprecate.deprecateFeature(5,"Text displayer w/ configure",'Text displayer should have a "configure" method!'),this.mediaSourceEngine_.setTextDisplayer(t),this.lastTextFactory_=e,this.streamingEngine_&&this.streamingEngine_.reloadTextStream()}else(e=this.mediaSourceEngine_.getTextDisplayer()).configure&&e.configure(this.config_.textDisplayer);this.abrManager_&&(this.abrManager_.configure(this.config_.abr),this.config_.abr.enabled?this.abrManager_.enable():this.abrManager_.disable(),this.onAbrStatusChanged_()),this.bufferObserver_&&(e=this.config_.streaming.rebufferingGoal,this.manifest_&&(e=Math.max(e,this.manifest_.minBufferTime)),this.updateBufferingSettings_(e)),this.manifest_&&shaka.Player.applyPlayRange_(this.manifest_.presentationTimeline,this.config_.playRangeStart,this.config_.playRangeEnd),this.adManager_&&this.adManager_.configure(this.config_.ads),this.cmcdManager_&&this.cmcdManager_.configure(this.config_.cmcd),this.cmsdManager_&&this.cmsdManager_.configure(this.config_.cmsd)},shaka.Player.prototype.getConfiguration=function(){goog.asserts.assert(this.config_,"Config must not be null!");var e=this.defaultConfig_();return shaka.util.PlayerConfiguration.mergeConfigObjects(e,this.config_,this.defaultConfig_()),e},shaka.Player.prototype.getSharedConfiguration=function(){return goog.asserts.assert(this.config_,"Cannot call getSharedConfiguration after call destroy!"),this.config_},shaka.Player.prototype.getBufferFullness=function(){if(this.video_){var e=this.video_.buffered.length;e=e?this.video_.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(e>=(t=Math.min(this.video_.currentTime+t,this.seekRange().end)))return 1;if(!(e<=this.video_.currentTime)&&e<t)return(e-this.video_.currentTime)/(t-this.video_.currentTime)}return 0},shaka.Player.prototype.resetConfiguration=function(){for(var e in goog.asserts.assert(this.config_,"Cannot be destroyed"),this.config_)delete this.config_[e];shaka.util.PlayerConfiguration.mergeConfigObjects(this.config_,this.defaultConfig_(),this.defaultConfig_()),this.applyConfig_()},shaka.Player.prototype.getLoadMode=function(){return this.loadMode_},shaka.Player.prototype.getManifestType=function(){return this.manifest_?this.manifest_.type:null},shaka.Player.prototype.getMediaElement=function(){return this.video_},shaka.Player.prototype.getNetworkingEngine=function(){return this.networkingEngine_},shaka.Player.prototype.getAssetUri=function(){return this.assetUri_},shaka.Player.prototype.getAdManager=function(){return this.adManager_?this.adManager_:null},shaka.Player.prototype.isLive=function(){return this.manifest_?this.manifest_.presentationTimeline.isLive():!(!this.video_||!this.video_.src)&&1/0==this.video_.duration},shaka.Player.prototype.isInProgress=function(){return!!this.manifest_&&this.manifest_.presentationTimeline.isInProgress()},shaka.Player.prototype.isAudioOnly=function(){if(this.manifest_){var e=this.manifest_.variants;return!!e.length&&!e[0].video}return!(!this.video_||!this.video_.src)&&(this.video_.videoTracks?0==this.video_.videoTracks.length:0==this.video_.videoHeight)},shaka.Player.prototype.seekRange=function(){if(this.manifest_){if(!this.fullyLoaded_&&this.manifest_.type==shaka.media.ManifestParser.HLS)return{start:0,end:0};var e=this.manifest_.presentationTimeline;return{start:e.getSeekRangeStart(),end:e.getSeekRangeEnd()}}return this.video_&&this.video_.src&&(e=this.video_.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},shaka.Player.prototype.goToLive=function(){this.isLive()?this.video_.currentTime=this.seekRange().end:shaka.log.warning("goToLive is for live streams!")},shaka.Player.prototype.keySystem=function(){return shaka.media.DrmEngine.keySystem(this.drmInfo())},shaka.Player.prototype.drmInfo=function(){return this.drmEngine_?this.drmEngine_.getDrmInfo():null},shaka.Player.prototype.getDrmEngine=function(){return this.drmEngine_},shaka.Player.prototype.getExpiration=function(){return this.drmEngine_?this.drmEngine_.getExpiration():1/0},shaka.Player.prototype.getActiveSessionsMetadata=function(){return this.drmEngine_?this.drmEngine_.getActiveSessionsMetadata():[]},shaka.Player.prototype.getKeyStatuses=function(){return this.drmEngine_?this.drmEngine_.getKeyStatuses():{}},shaka.Player.prototype.isBuffering=function(){var e=shaka.media.BufferingObserver.State;return!!this.bufferObserver_&&this.bufferObserver_.getState()==e.STARVING},shaka.Player.prototype.getPlaybackRate=function(){return this.video_?this.playRateController_?this.playRateController_.getRealRate():1:0},shaka.Player.prototype.trickPlay=function(e){var t=this;goog.asserts.assert(0!=e,"Should never set a trick play rate of 0!"),0==e?shaka.log.alwaysWarn("A trick play rate of 0 is unsupported!"):(this.trickPlayEventManager_.removeAll(),this.video_.paused&&this.video_.play(),this.playRateController_.set(e),this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE&&(this.abrManager_.playbackRateChanged(e),this.streamingEngine_.setTrickPlay(1<Math.abs(e))),this.isLive()&&this.trickPlayEventManager_.listen(this.video_,"timeupdate",(function(){var r=t.video_.currentTime,n=t.seekRange(),a=t.config_.streaming.safeSeekOffset;0<e?Math.floor(r)>=Math.floor(n.end)&&t.cancelTrickPlay():Math.floor(r)<=Math.floor(n.start+a)&&t.cancelTrickPlay()})))},shaka.Player.prototype.cancelTrickPlay=function(){var e=this.playRateController_.getDefaultRate();this.loadMode_==shaka.Player.LoadMode.SRC_EQUALS&&this.playRateController_.set(e),this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE&&(this.playRateController_.set(e),this.abrManager_.playbackRateChanged(e),this.streamingEngine_.setTrickPlay(!1)),this.trickPlayEventManager_.removeAll()},shaka.Player.prototype.getVariantTracks=function(){if(this.manifest_){for(var e=this.streamingEngine_?this.streamingEngine_.getCurrentVariant():null,t=[],r=0,n=$jscomp.makeIterator(this.manifest_.variants),a=n.next();!a.done;a=n.next())if(a=a.value,shaka.util.StreamUtils.isPlayable(a)){var i=shaka.util.StreamUtils.variantToTrack(a);i.active=a==e,i.active||1==r||null==e||a.video!=e.video||a.audio!=e.audio||(i.active=!0),i.active&&r++,t.push(i)}return goog.asserts.assert(1>=r,"It should only have one active track"),t}return this.video_&&this.video_.audioTracks?Array.from(this.video_.audioTracks).map((function(e){return shaka.util.StreamUtils.html5AudioTrackToTrack(e)})):[]},shaka.Player.prototype.getTextTracks=function(){if(this.manifest_){for(var e=this.streamingEngine_?this.streamingEngine_.getCurrentTextStream():null,t=[],r=$jscomp.makeIterator(this.manifest_.textStreams),n=r.next();!n.done;n=r.next()){n=n.value;var a=shaka.util.StreamUtils.textStreamToTrack(n);a.active=n==e,t.push(a)}return t}if(this.video_&&this.video_.src&&this.video_.textTracks){e=this.getFilteredTextTracks_();var i=shaka.util.StreamUtils;return e.map((function(e){return i.html5TextTrackToTrack(e)}))}return[]},shaka.Player.prototype.getImageTracks=function(){var e=shaka.util.StreamUtils,t=this.externalSrcEqualsThumbnailsStreams_;return this.manifest_&&(t=this.manifest_.imageStreams),t.map((function(t){return e.imageStreamToTrack(t)}))},shaka.Player.prototype.getAllThumbnails=function(e){var t,r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?i.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&i.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS?o.return(null):(t=i.externalSrcEqualsThumbnailsStreams_,i.manifest_&&(t=i.manifest_.imageStreams),(r=t.find((function(t){return t.id==e})))?r.segmentIndex?o.jumpTo(2):o.yield(r.createSegmentIndex(),2):o.return(null)):4!=o.nextAddress?(n=[],r.segmentIndex.forEachTopLevelReference((function(t){var a=i.parseTilesLayout_(t.getTilesLayout()||r.tilesLayout);if(a){a=a.rows*a.columns;for(var o=t.trueEndTime-t.startTime,s=0;s<a;s++)n.push(i.getThumbnails(e,t.startTime+o*s/a))}})),o.yield(Promise.all(n),4)):(a=o.yieldResult,o.return(a.filter((function(e){return e}))))}))},shaka.Player.prototype.parseTilesLayout_=function(e){if(!e)return null;var t=/(\d+)x(\d+)/.exec(e);return t?{columns:e=parseInt(t[1],10),rows:t=parseInt(t[2],10)}:(shaka.log.warning("Tiles layout does not contain a valid format  (columns x rows)"),null)},shaka.Player.prototype.getThumbnails=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(E){return 1==E.nextAddress?k.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&k.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS?E.return(null):(r=k.externalSrcEqualsThumbnailsStreams_,k.manifest_&&(r=k.manifest_.imageStreams),(n=r.find((function(t){return t.id==e})))?n.segmentIndex?E.jumpTo(2):E.yield(n.createSegmentIndex(),2):E.return(null)):null==(a=n.segmentIndex.find(t))?E.return(null):(i=n.segmentIndex.get(a),(o=k.parseTilesLayout_(i.getTilesLayout()||n.tilesLayout))?(s=n.width||0,l=n.height||0,u=s/o.columns,c=l/o.rows,d=o.columns*o.rows,p=i.trueEndTime-i.startTime,h=i.getTileDuration()||p/d,f=i.startTime,g=m=0,1<d&&(y=Math.floor((t-i.startTime)/h),f=i.startTime+y*h,m=y%o.columns*u,g=Math.floor(y/o.columns)*c),v=!1,(_=i.getThumbnailSprite())&&(v=!0,c=_.height,m=_.positionX,g=_.positionY,u=_.width),E.return({segment:i,imageHeight:l,imageWidth:s,height:c,positionX:m,positionY:g,startTime:f,duration:h,uris:i.getUris(),width:u,sprite:v})):E.return(null))}))},shaka.Player.prototype.selectTextTrack=function(e){if(this.manifest_&&this.streamingEngine_){var t=this.manifest_.textStreams.find((function(t){return t.id==e.id}));t?t==this.streamingEngine_.getCurrentTextStream()?shaka.log.debug("Text track already selected."):(this.addTextStreamToSwitchHistory_(t,!1),this.streamingEngine_.switchTextStream(t),this.onTextChanged_(),this.currentTextLanguage_=t.language):shaka.log.error("No stream with id",e.id)}else if(this.video_&&this.video_.src&&this.video_.textTracks){t=this.getFilteredTextTracks_();for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())r=r.value,shaka.util.StreamUtils.html5TrackId(r)==e.id?r.mode=this.isTextVisible_?"showing":"hidden":r.mode="disabled";this.onTextChanged_()}},shaka.Player.prototype.selectVariantTrack=function(e,t,r){if(t=void 0!==t&&t,r=void 0===r?0:r,this.manifest_&&this.streamingEngine_){this.config_.abr.enabled&&shaka.log.alwaysWarn("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var n=this.manifest_.variants.find((function(t){return t.id==e.id}));n?shaka.util.StreamUtils.isPlayable(n)?(this.switchVariant_(n,!1,t,r),this.currentAdaptationSetCriteria_=new shaka.media.ExampleBasedCriteria(n,this.config_.mediaSource.codecSwitchingStrategy,this.config_.manifest.dash.enableAudioGroups),this.updateAbrManagerVariants_()):shaka.log.error("Unable to switch to restricted track",e.id):shaka.log.error("No variant with id",e.id)}else if(this.video_&&this.video_.audioTracks)for(t=Array.from(this.video_.audioTracks),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())if(r=r.value,shaka.util.StreamUtils.html5TrackId(r)==e.id){this.switchHtml5Track_(r);break}},shaka.Player.prototype.getAudioLanguagesAndRoles=function(){return shaka.Player.getLanguageAndRolesFrom_(this.getVariantTracks())},shaka.Player.prototype.getTextLanguagesAndRoles=function(){return shaka.Player.getLanguageAndRolesFrom_(this.getTextTracks())},shaka.Player.prototype.getAudioLanguages=function(){return Array.from(shaka.Player.getLanguagesFrom_(this.getVariantTracks()))},shaka.Player.prototype.getTextLanguages=function(){return Array.from(shaka.Player.getLanguagesFrom_(this.getTextTracks()))},shaka.Player.prototype.selectAudioLanguage=function(e,t,r,n){if(r=void 0===r?0:r,n=void 0===n?0:n,this.manifest_&&this.playhead_){this.currentAdaptationSetCriteria_=new shaka.media.PreferenceBasedCriteria(e,t||"",r,"",!1,"","","",this.config_.mediaSource.codecSwitchingStrategy,this.config_.manifest.dash.enableAudioGroups),e=function(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0},t=this.streamingEngine_.getCurrentVariant();var a=this.currentAdaptationSetCriteria_.create(this.manifest_.variants);r=null;for(var i=(a=$jscomp.makeIterator(a.values())).next();!i.done;i=a.next())i=i.value,(!r||e(r,t)>e(i,t))&&(r=i);r?(e=shaka.util.StreamUtils.variantToTrack(r),this.selectVariantTrack(e,!0,n)):this.chooseVariantAndSwitch_()}else this.video_&&this.video_.audioTracks&&(n=shaka.util.StreamUtils.filterStreamsByLanguageAndRole(this.getVariantTracks(),e,t||"",!1)[0])&&this.selectVariantTrack(n)},shaka.Player.prototype.selectTextLanguage=function(e,t,r){r=void 0!==r&&r,this.manifest_&&this.playhead_?(this.currentTextLanguage_=e,this.currentTextRole_=t||"",this.currentTextForced_=r,(e=this.chooseTextStream_())&&(e==this.streamingEngine_.getCurrentTextStream()?shaka.log.debug("Text track already selected."):(this.addTextStreamToSwitchHistory_(e,!1),this.shouldStreamText_()&&(this.streamingEngine_.switchTextStream(e),this.onTextChanged_())))):(e=shaka.util.StreamUtils.filterStreamsByLanguageAndRole(this.getTextTracks(),e,t||"",r)[0])&&this.selectTextTrack(e)},shaka.Player.prototype.selectVariantsByLabel=function(e,t,r){if(t=void 0===t||t,r=void 0===r?0:r,this.manifest_&&this.playhead_){for(var n=null,a=$jscomp.makeIterator(this.manifest_.variants),i=a.next();!i.done;i=a.next())if((i=i.value).audio.label==e){n=i;break}null==n?shaka.log.warning("No variants were found with label: "+e+". Ignoring the request to switch."):(this.currentAdaptationSetCriteria_=new shaka.media.PreferenceBasedCriteria(n.language,"",0,"",!1,"",e,"",this.config_.mediaSource.codecSwitchingStrategy,this.config_.manifest.dash.enableAudioGroups),this.chooseVariantAndSwitch_(t,r))}else if(this.video_&&this.video_.audioTracks){for(r=Array.from(this.video_.audioTracks),t=null,n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next())(n=n.value).label==e&&(t=n);t&&this.switchHtml5Track_(t)}},shaka.Player.prototype.isTextTrackVisible=function(){var e=this.isTextVisible_;if(this.mediaSourceEngine_&&this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE){var t=this.mediaSourceEngine_.getTextDisplayer().isTextVisible();return goog.asserts.assert(t==e,"text visibility has fallen out of sync"),t}return this.video_&&this.video_.src&&this.video_.textTracks?this.getFilteredTextTracks_().some((function(e){return"showing"==e.mode})):e},shaka.Player.prototype.getChaptersTracks=function(){if(this.video_&&this.video_.src&&this.video_.textTracks){var e=this.getChaptersTracks_(),t=shaka.util.StreamUtils;return e.map((function(e){return t.html5TextTrackToTrack(e)}))}return[]},shaka.Player.prototype.getChapters=function(e){if(!this.video_||!this.video_.src||!this.video_.textTracks)return[];var t=shaka.util.LanguageUtils,r=t.normalize(e),n=this.getChaptersTracks_().filter((function(e){return t.normalize(e.language)==r}));if(!n||!n.length)return[];e=[];for(var a=new Set,i=(n=$jscomp.makeIterator(n)).next();!i.done;i=n.next())if((i=i.value)&&i.cues)for(var o=(i=$jscomp.makeIterator(i.cues)).next();!o.done;o=i.next()){var s=o.value;(o=s.id)&&""!=o||(o=s.startTime+"-"+s.endTime+"-"+s.text),s={id:o,title:s.text,startTime:s.startTime,endTime:s.endTime},a.has(o)||(e.push(s),a.add(o))}return e},shaka.Player.prototype.getFilteredTextTracks_=function(){return goog.asserts.assert(this.video_.textTracks,"TextTracks should be valid."),Array.from(this.video_.textTracks).filter((function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&e.label!=shaka.Player.TextTrackLabel}))},shaka.Player.prototype.getMetadataTracks_=function(){return goog.asserts.assert(this.video_.textTracks,"TextTracks should be valid."),Array.from(this.video_.textTracks).filter((function(e){return"metadata"==e.kind}))},shaka.Player.prototype.getChaptersTracks_=function(){return goog.asserts.assert(this.video_.textTracks,"TextTracks should be valid."),Array.from(this.video_.textTracks).filter((function(e){return"chapters"==e.kind}))},shaka.Player.prototype.setTextTrackVisibility=function(e){if(e=!!e,this.isTextVisible_!=e){if(this.isTextVisible_=e,this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE)this.mediaSourceEngine_.getTextDisplayer().setTextVisibility(e),this.config_.streaming.alwaysStreamText||(e?this.streamingEngine_.getCurrentTextStream()||0<(e=shaka.util.StreamUtils.filterStreamsByLanguageAndRole(this.manifest_.textStreams,this.currentTextLanguage_,this.currentTextRole_,this.currentTextForced_)).length&&(this.streamingEngine_.switchTextStream(e[0]),this.onTextChanged_()):this.streamingEngine_.unloadTextStream());else if(this.video_&&this.video_.src&&this.video_.textTracks)for(var t=this.getFilteredTextTracks_(),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())"disabled"!=(r=r.value).mode&&(r.mode=e?"showing":"hidden");this.onTextTrackVisibility_()}},shaka.Player.prototype.getPlayheadTimeAsDate=function(){if(this.playhead_)var e=this.playhead_.getTime();else{if(null==this.startTime_)return new Date;e=this.startTime_}if(this.manifest_){var t=this.manifest_.presentationTimeline;return t=t.getInitialProgramDateTime()||t.getPresentationStartTime(),new Date(1e3*(t+e))}return this.video_&&this.video_.getStartDate?(t=this.video_.getStartDate(),isNaN(t.getTime())?(shaka.log.warning("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(t.getTime()+1e3*e)):(shaka.log.warning("No way to get playhead time as Date!"),null)},shaka.Player.prototype.getPresentationStartTimeAsDate=function(){if(this.manifest_){var e=this.manifest_.presentationTimeline;return e=e.getInitialProgramDateTime()||e.getPresentationStartTime(),goog.asserts.assert(null!=e,"Presentation start time should not be null!"),new Date(1e3*e)}return this.video_&&this.video_.getStartDate?(e=this.video_.getStartDate(),isNaN(e.getTime())?(shaka.log.warning("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):e):(shaka.log.warning("No way to get presentation start time as Date!"),null)},shaka.Player.prototype.getSegmentAvailabilityDuration=function(){return this.isLive()?this.manifest_?this.manifest_.presentationTimeline.getSegmentAvailabilityDuration():(shaka.log.warning("No way to get segment segment availability duration!"),null):(shaka.log.warning("getSegmentAvailabilityDuration is for live streams!"),null)},shaka.Player.prototype.getBufferedInfo=function(){if(this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE)return this.mediaSourceEngine_.getBufferedInfo();var e={total:[],audio:[],video:[],text:[]};return this.loadMode_==shaka.Player.LoadMode.SRC_EQUALS&&(e.total=shaka.media.TimeRangesUtils.getBufferedInfo(this.video_.buffered)),e},shaka.Player.prototype.getStats=function(){if(this.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&this.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS)return shaka.util.Stats.getEmptyBlob();this.updateStateHistory_(),goog.asserts.assert(this.video_,"If we have stats, we should have video_");var e=this.video_,t=e.currentTime/e.duration;if(isNaN(t)||this.stats_.setCompletionPercent(Math.round(100*t)),this.playhead_&&(this.stats_.setGapsJumped(this.playhead_.getGapsJumped()),this.stats_.setStallsDetected(this.playhead_.getStallsDetected())),e.getVideoPlaybackQuality&&(t=e.getVideoPlaybackQuality(),this.stats_.setDroppedFrames(Number(t.droppedVideoFrames),Number(t.totalVideoFrames)),this.stats_.setCorruptedFrames(Number(t.corruptedVideoFrames))),t=this.drmEngine_?this.drmEngine_.getLicenseTime():NaN,this.stats_.setLicenseTime(t),this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE){t=this.streamingEngine_.getCurrentVariant();var r=this.streamingEngine_.getCurrentTextStream();if(t){var n=this.playRateController_?this.playRateController_.getRealRate():1,a=n*t.bandwidth;r&&r.bandwidth&&(a+=n*r.bandwidth),this.stats_.setCurrentStreamBandwidth(a)}t&&t.video&&this.stats_.setResolution(t.video.width||NaN,t.video.height||NaN),this.isLive()&&(t=this.getPresentationStartTimeAsDate().valueOf()+1e3*e.currentTime,t=(Date.now()-t)/1e3,this.stats_.setLiveLatency(t)),this.manifest_&&this.manifest_.presentationTimeline&&(t=this.manifest_.presentationTimeline.getMaxSegmentDuration(),this.stats_.setMaxSegmentDuration(t)),t=this.abrManager_.getBandwidthEstimate(),this.stats_.setBandwidthEstimate(t)}return this.loadMode_==shaka.Player.LoadMode.SRC_EQUALS&&this.stats_.setResolution(e.videoWidth||NaN,e.videoHeight||NaN),this.stats_.getBlob()},shaka.Player.prototype.addTextTrackAsync=function(e,t,r,n,a,i,o){o=void 0!==o&&o;var s,l,u,c,d,p,h,f,m,g,y,v,_=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(k){switch(k.nextAddress){case 1:if(_.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&_.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS)throw shaka.log.error("Must call load() and wait for it to resolve before adding text tracks."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.CONTENT_NOT_LOADED);if("subtitles"!=r&&"captions"!=r&&shaka.log.alwaysWarn("Using a kind value different of `subtitles` or `captions` can cause unwanted issues."),n){k.jumpTo(2);break}return k.yield(_.getTextMimetype_(e),3);case 3:n=k.yieldResult;case 2:if(s=[],_.adManager_&&(s=_.adManager_.getCuePoints()),_.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS){k.jumpTo(4);break}return o&&(r="forced"),k.yield(_.addSrcTrackElement_(e,t,r,n,i||"",s),5);case 5:if(l=shaka.util.LanguageUtils,u=l.normalize(t),c=_.getTextTracks(),d=c.find((function(e){return l.normalize(e.language)==u&&e.label==(i||"")&&e.kind==r})))return _.onTracksChanged_(),k.return(d);throw shaka.log.error("Cannot add this text when loaded with src="),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS);case 4:if(p=shaka.util.ManifestParserUtils.ContentType,h=_.video_.duration,_.manifest_&&(h=_.manifest_.presentationTimeline.getDuration()),1/0==h)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM);if(!s.length){k.jumpTo(6);break}return goog.asserts.assert(_.networkingEngine_,"Need networking engine."),k.yield(_.getTextData_(e,_.networkingEngine_,_.config_.streaming.retryParameters),7);case 7:f=k.yieldResult,m=_.convertToWebVTT_(f,n,s),g=new Blob([m],{type:"text/vtt"}),e=shaka.media.MediaSourceEngine.createObjectURL(g),n="text/vtt";case 6:if(y={id:_.nextExternalStreamId_++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:shaka.media.SegmentIndex.forSingleSegment(0,h,[e]),mimeType:n||"",codecs:a||"",kind:r,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,originalLanguage:t,label:i||null,type:p.TEXT,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!o,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([shaka.util.MimeUtils.getFullType(n||"",a||"")])},v=shaka.util.MimeUtils.getFullType(y.mimeType,y.codecs),!shaka.text.TextEngine.isTypeSupported(v))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.MISSING_TEXT_PLUGIN,n);return _.manifest_.textStreams.push(y),_.onTracksChanged_(),k.return(shaka.util.StreamUtils.textStreamToTrack(y))}}))},shaka.Player.prototype.addThumbnailsTrack=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){switch(_.nextAddress){case 1:if(v.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&v.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS)throw shaka.log.error("Must call load() and wait for it to resolve before adding image tracks."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.CONTENT_NOT_LOADED);if(t){_.jumpTo(2);break}return _.yield(v.getTextMimetype_(e),3);case 3:t=_.yieldResult;case 2:if("text/vtt"!=t)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.UNSUPPORTED_EXTERNAL_THUMBNAILS_URI,e);if(r=shaka.util.ManifestParserUtils.ContentType,n=v.video_.duration,v.manifest_&&(n=v.manifest_.presentationTimeline.getDuration()),1/0==n)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM);return goog.asserts.assert(v.networkingEngine_,"Need networking engine."),_.yield(v.getTextData_(e,v.networkingEngine_,v.config_.streaming.retryParameters),4);case 4:if(a=_.yieldResult,!(i=shaka.text.TextEngine.findParser(t)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.MISSING_TEXT_PLUGIN,t);for(o=i(),s={periodStart:0,segmentStart:0,segmentEnd:n,vttOffset:0},l=shaka.util.BufferUtils.toUint8(a),u=o.parseMedia(l,s,e),c=[],d={},p=$jscomp.makeIterator(u),h=p.next();!h.done;d={$jscomp$loop$prop$uris$887:d.$jscomp$loop$prop$uris$887,$jscomp$loop$prop$cue$888:d.$jscomp$loop$prop$cue$888},h=p.next())d.$jscomp$loop$prop$cue$888=h.value,d.$jscomp$loop$prop$uris$887=null,f=function(t){return function(){return null==t.$jscomp$loop$prop$uris$887&&(t.$jscomp$loop$prop$uris$887=shaka.util.ManifestParserUtils.resolveUris([e],[t.$jscomp$loop$prop$cue$888.payload])),t.$jscomp$loop$prop$uris$887||[]}}(d),m=new shaka.media.SegmentReference(d.$jscomp$loop$prop$cue$888.startTime,d.$jscomp$loop$prop$cue$888.endTime,f,0,null,null,0,0,1/0),d.$jscomp$loop$prop$cue$888.payload.includes("#xywh")&&(4===(g=d.$jscomp$loop$prop$cue$888.payload.split("#xywh=")[1].split(",")).length&&m.setThumbnailSprite({height:parseInt(g[3],10),positionX:parseInt(g[0],10),positionY:parseInt(g[1],10),width:parseInt(g[2],10)})),c.push(m);return y={id:v.nextExternalStreamId_++,originalId:null,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new shaka.media.SegmentIndex(c),mimeType:t||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:r.IMAGE,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0,fastSwitching:!1,fullMimeTypes:new Set([shaka.util.MimeUtils.getFullType(t||"","")])},v.loadMode_==shaka.Player.LoadMode.SRC_EQUALS?v.externalSrcEqualsThumbnailsStreams_.push(y):v.manifest_.imageStreams.push(y),v.onTracksChanged_(),_.return(shaka.util.StreamUtils.imageStreamToTrack(y))}}))},shaka.Player.prototype.addChaptersTrack=function(e,t,r){var n,a,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:if(s.loadMode_!=shaka.Player.LoadMode.MEDIA_SOURCE&&s.loadMode_!=shaka.Player.LoadMode.SRC_EQUALS)throw shaka.log.error("Must call load() and wait for it to resolve before adding chapters tracks."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.CONTENT_NOT_LOADED);if(r){l.jumpTo(2);break}return l.yield(s.getTextMimetype_(e),3);case 3:r=l.yieldResult;case 2:return n=[],s.adManager_&&(n=s.adManager_.getCuePoints()),l.yield(s.addSrcTrackElement_(e,t,"chapters",r,"",n),4);case 4:if(a=l.yieldResult,i=s.getChaptersTracks(),!(o=i.find((function(e){return e.language==t})))){l.jumpTo(5);break}return l.yield(new Promise((function(e,t){s.loadEventManager_.listenOnce(a,"load",e),s.loadEventManager_.listenOnce(a,"error",(function(e){t(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.CHAPTERS_TRACK_FAILED))}))})),6);case 6:return s.onTracksChanged_(),l.return(o);case 5:throw shaka.log.error("Cannot add this text when loaded with src="),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS)}}))},shaka.Player.prototype.getTextMimetype_=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){switch(n.nextAddress){case 1:return n.setCatchFinallyBlocks(2),goog.asserts.assert(r.networkingEngine_,"Need networking engine."),n.yield(shaka.net.NetworkingUtils.getMimeType(e,r.networkingEngine_,r.config_.streaming.retryParameters),4);case 4:t=n.yieldResult,n.leaveTryBlock(3);break;case 2:n.enterCatchBlock();case 3:if(t)return n.return(t);throw shaka.log.error("The mimeType has not been provided and it could not be deduced from its uri."),new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.TEXT_COULD_NOT_GUESS_MIME_TYPE,e)}}))},shaka.Player.prototype.addSrcTrackElement_=function(e,t,r,n,a,i){var o,s,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){return 1==d.nextAddress?"text/vtt"!=n||i.length?(goog.asserts.assert(c.networkingEngine_,"Need networking engine."),d.yield(c.getTextData_(e,c.networkingEngine_,c.config_.streaming.retryParameters),3)):d.jumpTo(2):(2!=d.nextAddress&&(o=d.yieldResult,s=c.convertToWebVTT_(o,n,i),l=new Blob([s],{type:"text/vtt"}),e=shaka.media.MediaSourceEngine.createObjectURL(l),n="text/vtt"),(u=document.createElement("track")).src=c.cmcdManager_.appendTextTrackData(e),u.label=a,u.kind=r,u.srclang=t,c.video_.getAttribute("crossorigin")||c.video_.setAttribute("crossorigin","anonymous"),c.video_.appendChild(u),d.return(u))}))},shaka.Player.prototype.getTextData_=function(e,t,r){var n,a,i,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return 1==s.nextAddress?(n=shaka.net.NetworkingEngine.RequestType.SEGMENT,(a=shaka.net.NetworkingEngine.makeRequest([e],r)).method="GET",o.cmcdManager_.applyTextData(a),s.yield(t.request(n,a).promise,2)):(i=s.yieldResult,s.return(i.data))}))},shaka.Player.prototype.convertToWebVTT_=function(e,t,r){var n=shaka.text.TextEngine.findParser(t);if(n)return t=n(),n={periodStart:0,segmentStart:0,segmentEnd:this.video_.duration,vttOffset:0},e=shaka.util.BufferUtils.toUint8(e),e=t.parseMedia(e,n,null),shaka.text.WebVttGenerator.convert(e,r);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.MISSING_TEXT_PLUGIN,t)},shaka.Player.prototype.setMaxHardwareResolution=function(e,t){this.maxHwRes_.width=e,this.maxHwRes_.height=t},shaka.Player.prototype.retryStreaming=function(e){return this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE&&this.streamingEngine_.retry(void 0===e?.1:e)},shaka.Player.prototype.getManifest=function(){return shaka.log.alwaysWarn("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.manifest_},shaka.Player.prototype.getManifestParserFactory=function(){return this.parserFactory_},shaka.Player.prototype.addVariantToSwitchHistory_=function(e,t){this.stats_.getSwitchHistory().updateCurrentVariant(e,t)},shaka.Player.prototype.addTextStreamToSwitchHistory_=function(e,t){this.stats_.getSwitchHistory().updateCurrentText(e,t)},shaka.Player.prototype.defaultConfig_=function(){var e=this,t=shaka.util.PlayerConfiguration.createDefault();return t.streaming.failureCallback=function(t){e.defaultStreamingFailureCallback_(t)},t.textDisplayFactory=function(){if(e.videoContainer_){var t=e.getConfiguration();return new shaka.text.UITextDisplayer(e.video_,e.videoContainer_,t.textDisplayer)}return HTMLMediaElement.prototype.addTextTrack?new shaka.text.SimpleTextDisplayer(e.video_,shaka.Player.TextTrackLabel):(shaka.log.warning("Text tracks are not supported by the browser, disabling."),new shaka.text.StubTextDisplayer)},t},shaka.Player.prototype.setVideoContainer=function(e){this.videoContainer_=e},shaka.Player.prototype.defaultStreamingFailureCallback_=function(e){if(this.isLive()){var t=null;e.code==shaka.util.Error.Code.BAD_HTTP_STATUS||e.code==shaka.util.Error.Code.HTTP_ERROR?t=1:e.code==shaka.util.Error.Code.TIMEOUT&&(t=.1),null!=t&&(e.severity=shaka.util.Error.Severity.RECOVERABLE,shaka.log.warning("Live streaming error.  Retrying automatically..."),this.retryStreaming(t))}},shaka.Player.prototype.makeTextStreamsForClosedCaptions_=function(e){for(var t=shaka.util.ManifestParserUtils.ContentType,r=shaka.util.ManifestParserUtils.TextStreamKind,n=shaka.util.MimeUtils.CEA608_CLOSED_CAPTION_MIMETYPE,a=shaka.util.MimeUtils.CEA708_CLOSED_CAPTION_MIMETYPE,i=new Set,o=$jscomp.makeIterator(e.textStreams),s=o.next();!s.done;s=o.next())(s=s.value).mimeType!=n&&s.mimeType!=a||i.add(s.originalId);for(s=(o=$jscomp.makeIterator(e.variants)).next();!s.done;s=o.next())if((s=s.value.video)&&s.closedCaptions)for(var l=$jscomp.makeIterator(s.closedCaptions.keys()),u=l.next();!u.done;u=l.next())if(u=u.value,!i.has(u)){var c=u.startsWith("CC")?n:a,d=new shaka.media.MetaSegmentIndex,p=s.closedCaptions.get(u);c={id:this.nextExternalStreamId_++,originalId:u,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:d,mimeType:c,codecs:"",kind:r.CLOSED_CAPTION,encrypted:!1,drmInfos:[],keyIds:new Set,language:p,originalLanguage:p,label:null,type:t.TEXT,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:s.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set([shaka.util.MimeUtils.getFullType(c,"")])},e.textStreams.push(c),i.add(u)}},shaka.Player.prototype.adjustStartTime_=function(e,t){var r,n,a,i,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){return 1==s.nextAddress?(r=e.audio,n=e.video,a=function(e,t){var r,n,a;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?e?i.yield(e.createSegmentIndex(),2):i.return(null):(n=(r=e.segmentIndex.getIteratorForTime(t))?r.next().value:null)?(a=n.startTime,goog.asserts.assert(a<=t,"Segment should start before target time!"),i.return(a)):i.return(null)}))},s.yield(a(r,t),2)):3!=s.nextAddress?(i=s.yieldResult,s.yield(a(n,t),3)):null!=(o=s.yieldResult)&&null!=i?s.return(Math.max(o,i)):null!=o?s.return(o):null!=i?s.return(i):s.return(t)}))},shaka.Player.prototype.updateBufferState_=function(){var e=this.isBuffering();shaka.log.v2("Player changing buffering state to",e),this.stats_&&this.bufferObserver_&&this.playhead_&&(this.playRateController_.setBuffering(e),this.cmcdManager_&&this.cmcdManager_.setBuffering(e),this.updateStateHistory_());var t=shaka.util.FakeEvent.EventName.Buffering;e=(new Map).set("buffering",e),this.dispatchEvent(shaka.Player.makeEvent_(t,e))},shaka.Player.prototype.onRateChange_=function(){var e=this.video_.playbackRate;0!=e&&(this.playRateController_&&this.playRateController_.set(e),e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.RateChange),this.dispatchEvent(e))},shaka.Player.prototype.updateStateHistory_=function(){if(this.stats_&&this.bufferObserver_){var e=shaka.media.BufferingObserver.State,t=this.stats_.getStateHistory(),r="playing";this.bufferObserver_.getState()==e.STARVING?r="buffering":this.video_.paused?r="paused":this.video_.ended&&(r="ended"),t.update(r)&&(e=shaka.util.FakeEvent.EventName.StateChanged,r=(new Map).set("newstate",r),this.dispatchEvent(shaka.Player.makeEvent_(e,r)))}},shaka.Player.prototype.onTimeUpdate_=function(){var e=this.video_.playbackRate,t=this.isLive();if(this.config_.streaming.vodDynamicPlaybackRate&&!t){var r=this.config_.streaming.vodDynamicPlaybackRateLowBufferRate,n=this.getBufferFullness(),a=this.config_.streaming.vodDynamicPlaybackRateBufferRatio;n<=a?e!=r&&(shaka.log.debug("Buffer fullness ratio ("+n+") is less than the vodDynamicPlaybackRateBufferRatio ("+a+"). Updating playbackRate to "+r),this.trickPlay(r)):1==n&&e!==this.playRateController_.getDefaultRate()&&(shaka.log.debug("Buffer is full. Cancel trick play."),this.cancelTrickPlay())}if(t&&(n=this.seekRange(),Number.isFinite(n.end)&&!(this.video_.currentTime<n.start))){if(this.config_.streaming.liveSync)var i=this.config_.streaming.liveSyncMaxLatency,o=this.config_.streaming.liveSyncPlaybackRate;else this.manifest_&&this.manifest_.serviceDescription&&(i=this.manifest_.serviceDescription.maxLatency||this.config_.streaming.liveSyncMaxLatency,o=this.manifest_.serviceDescription.maxPlaybackRate||this.config_.streaming.liveSyncPlaybackRate);if(this.config_.streaming.liveSync)var s=this.config_.streaming.liveSyncMinLatency,l=this.config_.streaming.liveSyncMinPlaybackRate;else this.manifest_&&this.manifest_.serviceDescription&&(s=this.manifest_.serviceDescription.minLatency||this.config_.streaming.liveSyncMinLatency,l=this.manifest_.serviceDescription.minPlaybackRate||this.config_.streaming.liveSyncMinPlaybackRate);t=n.end-this.video_.currentTime,r=0,this.loadMode_==shaka.Player.LoadMode.SRC_EQUALS&&(0<(a=this.video_.buffered).length&&(r=a.end(a.length-1),r=Math.max(o,r-n.end))),n=this.config_.streaming.liveSyncPanicMode,a=1e3*this.config_.streaming.liveSyncPanicThreshold;var u=Date.now()-this.bufferObserver_.getLastRebufferTime();n&&!l&&(l=this.config_.streaming.liveSyncMinPlaybackRate),n&&l&&u<=a?e!=l&&(shaka.log.debug("Time since last rebuffer ("+u+"s) is less than the liveSyncPanicThreshold ("+a+"s). Updating playbackRate to "+l),this.trickPlay(l)):i&&o&&t-r>i?e!=o&&(shaka.log.debug("Latency ("+t+"s) is greater than liveSyncMaxLatency ("+i+"s). Updating playbackRate to "+o),this.trickPlay(o)):s&&l&&t-r<s?e!=l&&(shaka.log.debug("Latency ("+t+"s) is smaller than liveSyncMinLatency ("+s+"s). Updating playbackRate to "+l),this.trickPlay(l)):e!==this.playRateController_.getDefaultRate()&&this.cancelTrickPlay()}},shaka.Player.prototype.onVideoProgress_=function(){if(this.video_){var e,t=!1,r=this.video_.currentTime/this.video_.duration;if(isNaN(r)||(r=Math.round(100*r),isNaN(this.completionPercent_)?(this.completionPercent_=r,t=!0):(r=Math.max(this.completionPercent_,r),this.completionPercent_!=r&&(this.completionPercent_=r,t=!0))),t)0==this.completionPercent_?e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Started):25==this.completionPercent_?e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.FirstQuartile):50==this.completionPercent_?e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Midpoint):75==this.completionPercent_?e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.ThirdQuartile):100==this.completionPercent_&&(e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Complete)),e&&this.dispatchEvent(e)}},shaka.Player.prototype.onSeek_=function(){this.playheadObservers_&&this.playheadObservers_.notifyOfSeek(),this.streamingEngine_&&this.streamingEngine_.seeked(),this.bufferObserver_&&this.pollBufferState_()},shaka.Player.prototype.updateAbrManagerVariants_=function(){try{goog.asserts.assert(this.manifest_,"Manifest should exist by now!"),this.manifestFilterer_.checkRestrictedVariants(this.manifest_)}catch(e){return this.onError_(e),!1}var e=shaka.util.StreamUtils.getPlayableVariants(this.manifest_.variants);return e=this.currentAdaptationSetCriteria_.create(e),this.abrManager_.setVariants(Array.from(e.values())),!0},shaka.Player.prototype.chooseVariant_=function(e){return e=void 0!==e&&e,this.updateAbrManagerVariants_()?this.abrManager_.chooseVariant(e):null},shaka.Player.prototype.checkVariants_=function(){goog.asserts.assert(this.manifest_,"Should have manifest!");for(var e=Date.now()/1e3,t=!1,r=$jscomp.makeIterator(this.manifest_.variants),n=r.next();!n.done;n=r.next())0<(n=n.value).disabledUntilTime&&n.disabledUntilTime<=e&&(n.disabledUntilTime=0,t=!0,shaka.log.v2("Re-enabled variant with "+(i=void 0,i="",(a=n).video&&(i+="video:"+a.video.id),a.audio&&(i=i+(i?"&":"")+"audio:"+a.audio.id),i)));var a,i;this.manifest_.variants.every((function(e){return goog.asserts.assert(0<=e.disabledUntilTime,"|variant.disableTimeUntilTime| must always be >= 0"),0===e.disabledUntilTime}))&&this.checkVariantsTimer_.stop(),t&&this.chooseVariantAndSwitch_(!0,void 0,!1,!1)},shaka.Player.prototype.chooseTextStream_=function(){return shaka.util.StreamUtils.filterStreamsByLanguageAndRole(this.manifest_.textStreams,this.currentTextLanguage_,this.currentTextRole_,this.currentTextForced_)[0]||null},shaka.Player.prototype.chooseVariantAndSwitch_=function(e,t,r,n){e=void 0===e||e,t=void 0===t?0:t,r=void 0!==r&&r,n=void 0===n||n,goog.asserts.assert(this.config_,"Must not be destroyed");var a=this.chooseVariant_();a&&this.switchVariant_(a,n,e,t,r)},shaka.Player.prototype.switchVariant_=function(e,t,r,n,a){a=void 0!==a&&a;var i=this.streamingEngine_.getCurrentVariant();e==i?(shaka.log.debug("Variant already selected."),r&&this.streamingEngine_.switchVariant(e,r,n,!0)):(this.addVariantToSwitchHistory_(e,t),this.streamingEngine_.switchVariant(e,r,n,a,t),r=null,i&&(r=shaka.util.StreamUtils.variantToTrack(i)),e=shaka.util.StreamUtils.variantToTrack(e),t?this.onAdaptation_(r,e):this.onVariantChanged_(r,e))},shaka.Player.prototype.switchHtml5Track_=function(e){goog.asserts.assert(this.video_&&this.video_.audioTracks,"Video and video.audioTracks should not be null!");var t=Array.from(this.video_.audioTracks).find((function(e){return e.enabled}));e.enabled=!0,e.id!==t.id&&(t.enabled=!1),t=shaka.util.StreamUtils.html5AudioTrackToTrack(t),e=shaka.util.StreamUtils.html5AudioTrackToTrack(e),this.onVariantChanged_(t,e)},shaka.Player.prototype.setInitialTextState_=function(e,t){t?(e.audio&&this.shouldInitiallyShowText_(e.audio,t)&&(this.isTextVisible_=!0),this.isTextVisible_&&(this.mediaSourceEngine_.getTextDisplayer().setTextVisibility(!0),goog.asserts.assert(this.shouldStreamText_(),"Should be streaming text")),this.onTextTrackVisibility_()):this.isTextVisible_=!1},shaka.Player.prototype.shouldInitiallyShowText_=function(e,t){var r=shaka.config.AutoShowText;if(this.config_.autoShowText==r.NEVER)return!1;if(this.config_.autoShowText==r.ALWAYS)return!0;var n=shaka.util.LanguageUtils,a=n.normalize(this.config_.preferredTextLanguage);return t=n.normalize(t.language),this.config_.autoShowText==r.IF_PREFERRED_TEXT_LANGUAGE?n.areLanguageCompatible(t,a):this.config_.autoShowText==r.IF_SUBTITLES_MAY_BE_NEEDED?(e=n.normalize(e.language),n.areLanguageCompatible(t,a)&&!n.areLanguageCompatible(e,t)):(shaka.log.alwaysWarn("Invalid autoShowText setting!"),!1)},shaka.Player.prototype.onManifestUpdate_=function(){this.parser_&&this.parser_.update&&this.parser_.update()},shaka.Player.prototype.onSegmentAppended_=function(e,t,r){if(this.playhead_){this.playhead_.notifyOfBufferingChange();var n=this.mediaSourceEngine_.bufferStart(r);!this.isLive()&&this.video_.paused&&null!=n&&0<n&&this.playhead_.getTime()<n&&this.playhead_.setStartTime(n)}this.pollBufferState_(),e=(new Map).set("start",e).set("end",t).set("contentType",r),this.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.SegmentAppended,e))},shaka.Player.prototype.switch_=function(e,t,r){t=void 0!==t&&t,r=void 0===r?0:r,shaka.log.debug("switch_"),goog.asserts.assert(this.config_.abr.enabled,"AbrManager should not call switch while disabled!"),this.manifest_&&this.streamingEngine_&&e!=this.streamingEngine_.getCurrentVariant()&&this.switchVariant_(e,!0,t,r)},shaka.Player.prototype.onAdaptation_=function(e,t){e=(new Map).set("oldTrack",e).set("newTrack",t),this.lcevcDec_&&this.lcevcDec_.updateVariant(t,this.getManifestType()),t=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.Adaptation,e),this.delayDispatchEvent_(t)},shaka.Player.prototype.onTracksChanged_=function(){var e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.TracksChanged);this.delayDispatchEvent_(e)},shaka.Player.prototype.onVariantChanged_=function(e,t){e=(new Map).set("oldTrack",e).set("newTrack",t),this.lcevcDec_&&this.lcevcDec_.updateVariant(t,this.getManifestType()),t=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.VariantChanged,e),this.delayDispatchEvent_(t)},shaka.Player.prototype.onTextChanged_=function(){var e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.TextChanged);this.delayDispatchEvent_(e)},shaka.Player.prototype.onTextTrackVisibility_=function(){var e=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.TextTrackVisibility);this.delayDispatchEvent_(e)},shaka.Player.prototype.onAbrStatusChanged_=function(){this.config_.abr.enabled||this.restoreDisabledVariants_();var e=(new Map).set("newStatus",this.config_.abr.enabled);this.delayDispatchEvent_(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.AbrStatusChanged,e))},shaka.Player.prototype.restoreDisabledVariants_=function(e){if(e=void 0===e||e,this.loadMode_==shaka.Player.LoadMode.MEDIA_SOURCE){goog.asserts.assert(this.manifest_,"Should have manifest!"),shaka.log.v2("Restoring all disabled streams..."),this.checkVariantsTimer_.stop();for(var t=$jscomp.makeIterator(this.manifest_.variants),r=t.next();!r.done;r=t.next())r.value.disabledUntilTime=0;e&&this.updateAbrManagerVariants_()}},shaka.Player.prototype.disableStream=function(e,t){if(!this.config_.abr.enabled||this.loadMode_===shaka.Player.LoadMode.DESTROYED||!navigator.onLine)return!1;if(this.manifest_.variants.some((function(t){return!(!(t=t[e.type])||t.id===e.id)&&(!shaka.util.StreamUtils.isAudio(e)||e.language===t.language)}))){for(var r=!1,n=$jscomp.makeIterator(this.manifest_.variants),a=n.next();!a.done;a=n.next()){var i=(a=a.value)[e.type];i&&i.id===e.id&&(a.disabledUntilTime=Date.now()/1e3+t,r=!0,shaka.log.v2("Disabled stream "+e.type+":"+e.id+" for "+t+" seconds..."))}return goog.asserts.assert(r,"Must have disabled stream"),this.checkVariantsTimer_.tickEvery(1),t=this.getBufferedInfo().video.reduce((function(e,t){return e+t.end-t.start}),0),this.chooseVariantAndSwitch_(!0,t,!0,!1),!0}return shaka.log.warning("No alternate stream found for active "+e.type+" stream. Will ignore request to disable stream..."),!1},shaka.Player.prototype.onError_=function(e){var t,r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:if(goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),i.loadMode_==shaka.Player.LoadMode.DESTROYED)return o.return();if(t=!0,!(i.fullyLoaded_&&i.manifest_&&i.streamingEngine_)||e.code!=shaka.util.Error.Code.VIDEO_ERROR&&e.code!=shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_FAILED&&e.code!=shaka.util.Error.Code.MEDIA_SOURCE_OPERATION_THREW&&e.code!=shaka.util.Error.Code.TRANSMUXING_FAILED){o.jumpTo(2);break}return o.setCatchFinallyBlocks(3),o.yield(i.streamingEngine_.resetMediaSource(),5);case 5:r=o.yieldResult,t=!r,o.leaveTryBlock(2);break;case 3:o.enterCatchBlock(),t=!0;case 2:if(!t)return o.return();e.severity===shaka.util.Error.Severity.CRITICAL&&i.restoreDisabledVariants_(!1),n=shaka.util.FakeEvent.EventName.Error,a=shaka.Player.makeEvent_(n,(new Map).set("detail",e)),i.dispatchEvent(a),a.defaultPrevented&&(e.handled=!0),o.jumpToEnd()}}))},shaka.Player.prototype.onRegionEvent_=function(e,t,r){r=void 0===r?this:r,t={schemeIdUri:t.schemeIdUri,value:t.value,startTime:t.startTime,endTime:t.endTime,id:t.id,eventElement:t.eventElement,eventNode:t.eventNode},t=(new Map).set("detail",t),r.dispatchEvent(shaka.Player.makeEvent_(e,t))},shaka.Player.prototype.onMediaQualityChange_=function(e,t){e={bandwidth:e.bandwidth,audioSamplingRate:e.audioSamplingRate,codecs:e.codecs,contentType:e.contentType,frameRate:e.frameRate,height:e.height,mimeType:e.mimeType,channelsCount:e.channelsCount,pixelAspectRatio:e.pixelAspectRatio,width:e.width},t=(new Map).set("mediaQuality",e).set("position",t),this.dispatchEvent(shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.MediaQualityChanged,t))},shaka.Player.prototype.videoErrorToShakaError_=function(){if(goog.asserts.assert(this.video_.error,"Video error expected, but missing!"),!this.video_.error)return null;var e=this.video_.error.code;if(1==e)return null;var t=this.video_.error.msExtendedCode;return t&&(0>t&&(t+=Math.pow(2,32)),t=t.toString(16)),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.VIDEO_ERROR,e,t,this.video_.error.message)},shaka.Player.prototype.onVideoError_=function(e){(e=this.videoErrorToShakaError_())&&this.onError_(e)},shaka.Player.prototype.onKeyStatus_=function(e){goog.asserts.assert(this.streamingEngine_,"Cannot be called in src= mode");var t=shaka.Player.makeEvent_(shaka.util.FakeEvent.EventName.KeyStatusChanged);this.dispatchEvent(t);var r=Object.keys(e);0==r.length&&shaka.log.warning("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),1==r.length&&""==r[0]&&(r=["00"],e={"00":e[""]}),(t=1==r.length&&"00"==r[0])&&shaka.log.warning("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var n=shaka.media.ManifestFilterer.restrictedStatuses,a=!1;if(goog.asserts.assert(this.drmEngine_,"drmEngine should be non-null here."),r.length)for(var i=(r=$jscomp.makeIterator(this.manifest_.variants)).next();!i.done;i=r.next()){i=i.value;for(var o=shaka.util.StreamUtils.getVariantStreams(i),s=(o=$jscomp.makeIterator(o)).next();!s.done;s=o.next()){var l=s.value;if(s=i.allowedByKeySystem,l.keyIds.size){i.allowedByKeySystem=!0;for(var u=(l=$jscomp.makeIterator(l.keyIds)).next();!u.done;u=l.next())u=u.value,((u=e[t?"00":u])||this.drmEngine_.hasManifestInitData())&&(i.allowedByKeySystem=i.allowedByKeySystem&&!!u&&!n.includes(u))}s!=i.allowedByKeySystem&&(a=!0)}}a&&(this.onTracksChanged_(),!this.updateAbrManagerVariants_())||(e=this.streamingEngine_.getCurrentVariant())&&!e.allowedByKeySystem&&(shaka.log.debug("Choosing new streams after key status changed"),this.chooseVariantAndSwitch_())},shaka.Player.prototype.shouldStreamText_=function(){return this.config_.streaming.alwaysStreamText||this.isTextTrackVisible()},shaka.Player.applyPlayRange_=function(e,t,r){0<t&&(e.isLive()?shaka.log.warning("|playRangeStart| has been configured for live content. Ignoring the setting."):e.setUserSeekStart(t)),r<(t=e.getDuration())&&(e.isLive()?shaka.log.warning("|playRangeEnd| has been configured for live content. Ignoring the setting."):e.setDuration(r))},shaka.Player.prototype.delayDispatchEvent_=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return r.yield(Promise.resolve(),2);t.loadMode_!=shaka.Player.LoadMode.DESTROYED&&t.dispatchEvent(e),r.jumpToEnd()}))},shaka.Player.getLanguagesFrom_=function(e){for(var t=new Set,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=r.value).language?t.add(shaka.util.LanguageUtils.normalize(r.language)):t.add("und");return t},shaka.Player.getLanguageAndRolesFrom_=function(e){for(var t=new Map,r=new Map,n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){var a="und",i=[];(n=n.value).language&&(a=shaka.util.LanguageUtils.normalize(n.language)),(i="variant"==n.type?n.audioRoles:n.roles)&&i.length||(i=[""]),t.has(a)||t.set(a,new Set);for(var o=(i=$jscomp.makeIterator(i)).next();!o.done;o=i.next())o=o.value,t.get(a).add(o),n.label&&(r.has(a)||r.set(a,new Map),r.get(a).set(o,n.label))}var s=[];return t.forEach((function(e,t){for(var n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){n=n.value;var a=null;r.has(t)&&r.get(t).has(n)&&(a=r.get(t).get(n)),s.push({language:t,role:n,label:a})}})),s},shaka.Player.prototype.isBufferedToEndMS_=function(){if(goog.asserts.assert(this.video_,"We need a video element to get buffering information"),goog.asserts.assert(this.mediaSourceEngine_,"We need a media source engine to get buffering information"),goog.asserts.assert(this.manifest_,"We need a manifest to get buffering information"),this.video_.ended||this.mediaSourceEngine_.ended())return!0;if(this.manifest_.presentationTimeline.isLive()){var e=this.manifest_.presentationTimeline.getSegmentAvailabilityEnd(),t=shaka.media.TimeRangesUtils.bufferEnd(this.video_.buffered);if(null!=t&&t>=e)return!0}return!1},shaka.Player.prototype.isBufferedToEndSrc_=function(){if(goog.asserts.assert(this.video_,"We need a video element to get buffering information"),this.video_.ended)return!0;var e=shaka.media.TimeRangesUtils.bufferEnd(this.video_.buffered);return null!=e&&e>=this.video_.duration-1},shaka.Player.prototype.createAbortLoadError_=function(){return new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.LOAD_INTERRUPTED)},goog.exportSymbol("shaka.Player",shaka.Player),goog.exportProperty(shaka.Player.prototype,"setVideoContainer",shaka.Player.prototype.setVideoContainer),goog.exportProperty(shaka.Player.prototype,"getManifestParserFactory",shaka.Player.prototype.getManifestParserFactory),goog.exportProperty(shaka.Player.prototype,"getManifest",shaka.Player.prototype.getManifest),goog.exportProperty(shaka.Player.prototype,"retryStreaming",shaka.Player.prototype.retryStreaming),goog.exportProperty(shaka.Player.prototype,"setMaxHardwareResolution",shaka.Player.prototype.setMaxHardwareResolution),goog.exportProperty(shaka.Player.prototype,"addChaptersTrack",shaka.Player.prototype.addChaptersTrack),goog.exportProperty(shaka.Player.prototype,"addThumbnailsTrack",shaka.Player.prototype.addThumbnailsTrack),goog.exportProperty(shaka.Player.prototype,"addTextTrackAsync",shaka.Player.prototype.addTextTrackAsync),goog.exportProperty(shaka.Player.prototype,"getStats",shaka.Player.prototype.getStats),goog.exportProperty(shaka.Player.prototype,"getBufferedInfo",shaka.Player.prototype.getBufferedInfo),goog.exportProperty(shaka.Player.prototype,"getSegmentAvailabilityDuration",shaka.Player.prototype.getSegmentAvailabilityDuration),goog.exportProperty(shaka.Player.prototype,"getPresentationStartTimeAsDate",shaka.Player.prototype.getPresentationStartTimeAsDate),goog.exportProperty(shaka.Player.prototype,"getPlayheadTimeAsDate",shaka.Player.prototype.getPlayheadTimeAsDate),goog.exportProperty(shaka.Player.prototype,"setTextTrackVisibility",shaka.Player.prototype.setTextTrackVisibility),goog.exportProperty(shaka.Player.prototype,"getChapters",shaka.Player.prototype.getChapters),goog.exportProperty(shaka.Player.prototype,"getChaptersTracks",shaka.Player.prototype.getChaptersTracks),goog.exportProperty(shaka.Player.prototype,"isTextTrackVisible",shaka.Player.prototype.isTextTrackVisible),goog.exportProperty(shaka.Player.prototype,"selectVariantsByLabel",shaka.Player.prototype.selectVariantsByLabel),goog.exportProperty(shaka.Player.prototype,"selectTextLanguage",shaka.Player.prototype.selectTextLanguage),goog.exportProperty(shaka.Player.prototype,"selectAudioLanguage",shaka.Player.prototype.selectAudioLanguage),goog.exportProperty(shaka.Player.prototype,"getTextLanguages",shaka.Player.prototype.getTextLanguages),goog.exportProperty(shaka.Player.prototype,"getAudioLanguages",shaka.Player.prototype.getAudioLanguages),goog.exportProperty(shaka.Player.prototype,"getTextLanguagesAndRoles",shaka.Player.prototype.getTextLanguagesAndRoles),goog.exportProperty(shaka.Player.prototype,"getAudioLanguagesAndRoles",shaka.Player.prototype.getAudioLanguagesAndRoles),goog.exportProperty(shaka.Player.prototype,"selectVariantTrack",shaka.Player.prototype.selectVariantTrack),goog.exportProperty(shaka.Player.prototype,"selectTextTrack",shaka.Player.prototype.selectTextTrack),goog.exportProperty(shaka.Player.prototype,"getThumbnails",shaka.Player.prototype.getThumbnails),goog.exportProperty(shaka.Player.prototype,"getAllThumbnails",shaka.Player.prototype.getAllThumbnails),goog.exportProperty(shaka.Player.prototype,"getImageTracks",shaka.Player.prototype.getImageTracks),goog.exportProperty(shaka.Player.prototype,"getTextTracks",shaka.Player.prototype.getTextTracks),goog.exportProperty(shaka.Player.prototype,"getVariantTracks",shaka.Player.prototype.getVariantTracks),goog.exportProperty(shaka.Player.prototype,"cancelTrickPlay",shaka.Player.prototype.cancelTrickPlay),goog.exportProperty(shaka.Player.prototype,"trickPlay",shaka.Player.prototype.trickPlay),goog.exportProperty(shaka.Player.prototype,"getPlaybackRate",shaka.Player.prototype.getPlaybackRate),goog.exportProperty(shaka.Player.prototype,"isBuffering",shaka.Player.prototype.isBuffering),goog.exportProperty(shaka.Player.prototype,"getKeyStatuses",shaka.Player.prototype.getKeyStatuses),goog.exportProperty(shaka.Player.prototype,"getActiveSessionsMetadata",shaka.Player.prototype.getActiveSessionsMetadata),goog.exportProperty(shaka.Player.prototype,"getExpiration",shaka.Player.prototype.getExpiration),goog.exportProperty(shaka.Player.prototype,"drmInfo",shaka.Player.prototype.drmInfo),goog.exportProperty(shaka.Player.prototype,"keySystem",shaka.Player.prototype.keySystem),goog.exportProperty(shaka.Player.prototype,"goToLive",shaka.Player.prototype.goToLive),goog.exportProperty(shaka.Player.prototype,"seekRange",shaka.Player.prototype.seekRange),goog.exportProperty(shaka.Player.prototype,"isAudioOnly",shaka.Player.prototype.isAudioOnly),goog.exportProperty(shaka.Player.prototype,"isInProgress",shaka.Player.prototype.isInProgress),goog.exportProperty(shaka.Player.prototype,"isLive",shaka.Player.prototype.isLive),goog.exportProperty(shaka.Player.prototype,"getAdManager",shaka.Player.prototype.getAdManager),goog.exportProperty(shaka.Player.prototype,"getAssetUri",shaka.Player.prototype.getAssetUri),goog.exportProperty(shaka.Player.prototype,"getNetworkingEngine",shaka.Player.prototype.getNetworkingEngine),goog.exportProperty(shaka.Player.prototype,"getMediaElement",shaka.Player.prototype.getMediaElement),goog.exportProperty(shaka.Player.prototype,"getManifestType",shaka.Player.prototype.getManifestType),goog.exportProperty(shaka.Player.prototype,"getLoadMode",shaka.Player.prototype.getLoadMode),goog.exportProperty(shaka.Player.prototype,"resetConfiguration",shaka.Player.prototype.resetConfiguration),goog.exportProperty(shaka.Player.prototype,"getBufferFullness",shaka.Player.prototype.getBufferFullness),goog.exportProperty(shaka.Player.prototype,"getConfiguration",shaka.Player.prototype.getConfiguration),goog.exportProperty(shaka.Player.prototype,"configure",shaka.Player.prototype.configure),goog.exportProperty(shaka.Player.prototype,"releaseAllMutexes",shaka.Player.prototype.releaseAllMutexes),goog.exportProperty(shaka.Player.prototype,"preload",shaka.Player.prototype.preload),goog.exportProperty(shaka.Player.prototype,"unloadAndSavePreload",shaka.Player.prototype.unloadAndSavePreload),goog.exportProperty(shaka.Player.prototype,"load",shaka.Player.prototype.load),goog.exportProperty(shaka.Player.prototype,"updateStartTime",shaka.Player.prototype.updateStartTime),goog.exportProperty(shaka.Player.prototype,"unload",shaka.Player.prototype.unload),goog.exportProperty(shaka.Player.prototype,"detach",shaka.Player.prototype.detach),goog.exportProperty(shaka.Player.prototype,"attachCanvas",shaka.Player.prototype.attachCanvas),goog.exportProperty(shaka.Player.prototype,"attach",shaka.Player.prototype.attach),goog.exportProperty(shaka.Player,"probeSupport",shaka.Player.probeSupport),goog.exportProperty(shaka.Player,"isBrowserSupported",shaka.Player.isBrowserSupported),goog.exportProperty(shaka.Player,"setAdManagerFactory",shaka.Player.setAdManagerFactory),goog.exportProperty(shaka.Player,"registerSupportPlugin",shaka.Player.registerSupportPlugin),goog.exportProperty(shaka.Player.prototype,"destroy",shaka.Player.prototype.destroy),shaka.Player.LoadMode={DESTROYED:0,NOT_LOADED:1,MEDIA_SOURCE:2,SRC_EQUALS:3},goog.exportProperty(shaka.Player,"LoadMode",shaka.Player.LoadMode),shaka.Player.TYPICAL_BUFFERING_THRESHOLD_=.5,shaka.Player.version="v4.8.11-debug",goog.exportProperty(shaka.Player,"version",shaka.Player.version),shaka.Deprecate.init(shaka.Player.version),shaka.Player.supportPlugins_={},shaka.Player.adManagerFactory_=null,shaka.Player.TextTrackLabel="Shaka Player TextTrack",shaka.ads={},shaka.ads.AdsStats=function(){this.loadTimes_=[],this.skipped_=this.playedCompletely_=this.started_=0},shaka.ads.AdsStats.prototype.addLoadTime=function(e){this.loadTimes_.push(e)},shaka.ads.AdsStats.prototype.incrementStarted=function(){this.started_++},shaka.ads.AdsStats.prototype.incrementPlayedCompletely=function(){this.playedCompletely_++},shaka.ads.AdsStats.prototype.incrementSkipped=function(){this.skipped_++},shaka.ads.AdsStats.prototype.getBlob=function(){return{loadTimes:this.loadTimes_,started:this.started_,playedCompletely:this.playedCompletely_,skipped:this.skipped_}},shaka.ads.ClientSideAd=function(e,t,r){var n=this;this.ad_=e,this.manager_=t,this.video_=r,this.isPaused_=!1,this.volume_=this.manager_.getVolume(),this.eventManager_=new shaka.util.EventManager,this.eventManager_.listen(this.manager_,google.ima.AdEvent.Type.PAUSED,(function(){n.isPaused_=!0})),this.eventManager_.listen(this.manager_,google.ima.AdEvent.Type.RESUMED,(function(){n.isPaused_=!1}))},shaka.ads.ClientSideAd.prototype.getDuration=function(){return this.ad_.getDuration()},shaka.ads.ClientSideAd.prototype.getMinSuggestedDuration=function(){return this.ad_.getMinSuggestedDuration()},shaka.ads.ClientSideAd.prototype.getRemainingTime=function(){return this.manager_.getRemainingTime()},shaka.ads.ClientSideAd.prototype.isPaused=function(){return this.isPaused_},shaka.ads.ClientSideAd.prototype.isSkippable=function(){return 0<=this.ad_.getSkipTimeOffset()},shaka.ads.ClientSideAd.prototype.getTimeUntilSkippable=function(){var e=this.ad_.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},shaka.ads.ClientSideAd.prototype.canSkipNow=function(){return this.manager_.getAdSkippableState()},shaka.ads.ClientSideAd.prototype.skip=function(){return this.manager_.skip()},shaka.ads.ClientSideAd.prototype.setPaused=function(e){this.isPaused_=e},shaka.ads.ClientSideAd.prototype.pause=function(){return this.manager_.pause()},shaka.ads.ClientSideAd.prototype.play=function(){return this.manager_.resume()},shaka.ads.ClientSideAd.prototype.getVolume=function(){return this.manager_.getVolume()},shaka.ads.ClientSideAd.prototype.setVolume=function(e){return this.video_.volume=e,this.manager_.setVolume(e)},shaka.ads.ClientSideAd.prototype.isMuted=function(){return 0==this.manager_.getVolume()},shaka.ads.ClientSideAd.prototype.isLinear=function(){return this.ad_.isLinear()},shaka.ads.ClientSideAd.prototype.resize=function(e,t){var r=!1,n=this.video_;document.fullscreenEnabled?r=!!document.fullscreenElement:n.webkitSupportsFullscreen&&(r=n.webkitDisplayingFullscreen),this.manager_.resize(e,t,r?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},shaka.ads.ClientSideAd.prototype.setMuted=function(e){(this.video_.muted=e)?(this.volume_=this.getVolume(),this.manager_.setVolume(0)):this.manager_.setVolume(this.volume_)},shaka.ads.ClientSideAd.prototype.setInitialMuted=function(e){this.volume_=e,this.manager_.setVolume(0)},shaka.ads.ClientSideAd.prototype.getSequenceLength=function(){var e=this.ad_.getAdPodInfo();return null==e?1:e.getTotalAds()},shaka.ads.ClientSideAd.prototype.getPositionInSequence=function(){var e=this.ad_.getAdPodInfo();return null==e?1:e.getAdPosition()},shaka.ads.ClientSideAd.prototype.getTitle=function(){return this.ad_.getTitle()},shaka.ads.ClientSideAd.prototype.getDescription=function(){return this.ad_.getDescription()},shaka.ads.ClientSideAd.prototype.getVastMediaBitrate=function(){return this.ad_.getVastMediaBitrate()},shaka.ads.ClientSideAd.prototype.getVastMediaHeight=function(){return this.ad_.getVastMediaHeight()},shaka.ads.ClientSideAd.prototype.getVastMediaWidth=function(){return this.ad_.getVastMediaWidth()},shaka.ads.ClientSideAd.prototype.getAdId=function(){return this.ad_.getAdId()},shaka.ads.ClientSideAd.prototype.getCreativeAdId=function(){return this.ad_.getCreativeAdId()},shaka.ads.ClientSideAd.prototype.getAdvertiserName=function(){return this.ad_.getAdvertiserName()},shaka.ads.ClientSideAd.prototype.getMediaUrl=function(){return this.ad_.getMediaUrl()},shaka.ads.ClientSideAd.prototype.getTimeOffset=function(){var e=this.ad_.getAdPodInfo();return null==e?0:e.getTimeOffset()},shaka.ads.ClientSideAd.prototype.getPodIndex=function(){var e=this.ad_.getAdPodInfo();return null==e?0:e.getPodIndex()},shaka.ads.ClientSideAd.prototype.release=function(){this.manager_=this.ad_=null},goog.exportSymbol("shaka.ads.ClientSideAd",shaka.ads.ClientSideAd),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"release",shaka.ads.ClientSideAd.prototype.release),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getPodIndex",shaka.ads.ClientSideAd.prototype.getPodIndex),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getTimeOffset",shaka.ads.ClientSideAd.prototype.getTimeOffset),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getMediaUrl",shaka.ads.ClientSideAd.prototype.getMediaUrl),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getAdvertiserName",shaka.ads.ClientSideAd.prototype.getAdvertiserName),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getCreativeAdId",shaka.ads.ClientSideAd.prototype.getCreativeAdId),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getAdId",shaka.ads.ClientSideAd.prototype.getAdId),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getVastMediaWidth",shaka.ads.ClientSideAd.prototype.getVastMediaWidth),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getVastMediaHeight",shaka.ads.ClientSideAd.prototype.getVastMediaHeight),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getVastMediaBitrate",shaka.ads.ClientSideAd.prototype.getVastMediaBitrate),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getDescription",shaka.ads.ClientSideAd.prototype.getDescription),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getTitle",shaka.ads.ClientSideAd.prototype.getTitle),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getPositionInSequence",shaka.ads.ClientSideAd.prototype.getPositionInSequence),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getSequenceLength",shaka.ads.ClientSideAd.prototype.getSequenceLength),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"setMuted",shaka.ads.ClientSideAd.prototype.setMuted),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"resize",shaka.ads.ClientSideAd.prototype.resize),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isLinear",shaka.ads.ClientSideAd.prototype.isLinear),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isMuted",shaka.ads.ClientSideAd.prototype.isMuted),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"setVolume",shaka.ads.ClientSideAd.prototype.setVolume),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getVolume",shaka.ads.ClientSideAd.prototype.getVolume),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"play",shaka.ads.ClientSideAd.prototype.play),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"pause",shaka.ads.ClientSideAd.prototype.pause),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"skip",shaka.ads.ClientSideAd.prototype.skip),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"canSkipNow",shaka.ads.ClientSideAd.prototype.canSkipNow),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getTimeUntilSkippable",shaka.ads.ClientSideAd.prototype.getTimeUntilSkippable),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isSkippable",shaka.ads.ClientSideAd.prototype.isSkippable),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"isPaused",shaka.ads.ClientSideAd.prototype.isPaused),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getRemainingTime",shaka.ads.ClientSideAd.prototype.getRemainingTime),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getMinSuggestedDuration",shaka.ads.ClientSideAd.prototype.getMinSuggestedDuration),goog.exportProperty(shaka.ads.ClientSideAd.prototype,"getDuration",shaka.ads.ClientSideAd.prototype.getDuration),shaka.ads.ClientSideAdManager=function(e,t,r,n,a){var i=this;this.adContainer_=e,this.video_=t,this.videoPlayed_=!1,this.resizeObserver_=this.config_=null,this.requestAdsStartTime_=NaN,this.onEvent_=a,this.ad_=null,this.eventManager_=new shaka.util.EventManager,google.ima.settings.setLocale(r),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this.adDisplayContainer_=new google.ima.AdDisplayContainer(this.adContainer_,this.video_),this.adDisplayContainer_.initialize(),this.adsLoader_=new google.ima.AdsLoader(this.adDisplayContainer_),this.adsLoader_.getSettings().setPlayerType("shaka-player"),this.adsLoader_.getSettings().setPlayerVersion(shaka.Player.version),this.imaAdsManager_=null,this.adsRenderingSettings_=n||new google.ima.AdsRenderingSettings,this.eventManager_.listen(this.adsLoader_,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(function(e){i.onAdsManagerLoaded_(e)})),this.eventManager_.listen(this.adsLoader_,google.ima.AdErrorEvent.Type.AD_ERROR,(function(e){i.onAdError_(e)})),this.eventManager_.listen(this.video_,"ended",(function(){i.adsLoader_.contentComplete()})),this.eventManager_.listenOnce(this.video_,"play",(function(){i.videoPlayed_=!0}))},shaka.ads.ClientSideAdManager.prototype.configure=function(e){this.config_=e},shaka.ads.ClientSideAdManager.prototype.requestAds=function(e){goog.asserts.assert(e.adTagUrl||e.adsResponse,"The ad tag needs to be set up before requesting ads, or adsResponse must be filled."),this.imaAdsManager_&&this.imaAdsManager_.destroy(),this.adsLoader_&&this.adsLoader_.contentComplete(),this.requestAdsStartTime_=Date.now()/1e3,this.adsLoader_.requestAds(e)},shaka.ads.ClientSideAdManager.prototype.updateAdsRenderingSettings=function(e){this.adsRenderingSettings_=e,this.imaAdsManager_&&this.imaAdsManager_.updateAdsRenderingSettings(this.adsRenderingSettings_)},shaka.ads.ClientSideAdManager.prototype.stop=function(){this.imaAdsManager_&&this.imaAdsManager_.stop(),this.adContainer_&&shaka.util.Dom.removeAllChildren(this.adContainer_)},shaka.ads.ClientSideAdManager.prototype.release=function(){this.stop(),this.resizeObserver_&&this.resizeObserver_.disconnect(),this.eventManager_&&this.eventManager_.release(),this.imaAdsManager_&&this.imaAdsManager_.destroy(),this.adsLoader_.destroy(),this.adDisplayContainer_.destroy()},shaka.ads.ClientSideAdManager.prototype.onAdError_=function(e){shaka.log.warning("There was an ad error from the IMA SDK: "+e.getError()),shaka.log.warning("Resuming playback."),e=(new Map).set("originalEvent",e),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_ERROR,e)),this.onAdComplete_(null),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.CUEPOINTS_CHANGED,(new Map).set("cuepoints",[])))},shaka.ads.ClientSideAdManager.prototype.onAdsManagerLoaded_=function(e){var t=this;goog.asserts.assert(null!=this.video_,"Video should not be null!");var r=Date.now()/1e3-this.requestAdsStartTime_;if(this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.ADS_LOADED,(new Map).set("loadTime",r))),this.config_.customPlayheadTracker){var n={currentTime:this.video_.currentTime};this.imaAdsManager_=e.getAdsManager(n,this.adsRenderingSettings_),this.video_.muted?this.imaAdsManager_.setVolume(0):this.imaAdsManager_.setVolume(this.video_.volume),this.eventManager_.listen(this.video_,"timeupdate",(function(){t.video_.duration&&(n.currentTime=t.video_.currentTime)})),this.eventManager_.listen(this.video_,"volumechange",(function(){t.ad_&&(t.ad_.setVolume(t.video_.volume),t.video_.muted&&t.ad_.setMuted(!0))}))}else this.imaAdsManager_=e.getAdsManager(this.video_,this.adsRenderingSettings_);if(this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.IMA_AD_MANAGER_LOADED,(new Map).set("imaAdManager",this.imaAdsManager_))),(r=this.imaAdsManager_.getCuePoints()).length){e=[];for(var a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next())e.push({start:a.value,end:null});this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.CUEPOINTS_CHANGED,(new Map).set("cuepoints",e)))}this.addImaEventListeners_();try{var i=this.isFullScreenEnabled_()?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;this.imaAdsManager_.init(this.video_.offsetWidth,this.video_.offsetHeight,i),this.eventManager_.listen(this.video_,"loadeddata",(function(){var e=t.isFullScreenEnabled_()?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;t.imaAdsManager_.resize(t.video_.offsetWidth,t.video_.offsetHeight,e)})),"ResizeObserver"in window?(this.resizeObserver_=new ResizeObserver((function(){var e=t.isFullScreenEnabled_()?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;t.imaAdsManager_.resize(t.video_.offsetWidth,t.video_.offsetHeight,e)})),this.resizeObserver_.observe(this.video_)):this.eventManager_.listen(document,"fullscreenchange",(function(){var e=t.isFullScreenEnabled_()?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;t.imaAdsManager_.resize(t.video_.offsetWidth,t.video_.offsetHeight,e)})),this.videoPlayed_||this.config_.skipPlayDetection?this.imaAdsManager_.start():this.eventManager_.listenOnce(this.video_,"play",(function(){t.videoPlayed_=!0,t.imaAdsManager_.start()}))}catch(e){this.onAdComplete_(null)}},shaka.ads.ClientSideAdManager.prototype.isFullScreenEnabled_=function(){if(document.fullscreenEnabled)return!!document.fullscreenElement;var e=this.video_;return!!e.webkitSupportsFullscreen&&e.webkitDisplayingFullscreen},shaka.ads.ClientSideAdManager.prototype.addImaEventListeners_=function(){var e=this,t=function(t,r){t=(new Map).set("originalEvent",t),e.onEvent_(new shaka.util.FakeEvent(r,t))};this.eventManager_.listen(this.imaAdsManager_,google.ima.AdErrorEvent.Type.AD_ERROR,(function(t){e.onAdError_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,(function(t){e.onAdStart_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.STARTED,(function(t){e.onAdStart_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.FIRST_QUARTILE,(function(e){t(e,shaka.ads.AdManager.AD_FIRST_QUARTILE)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.MIDPOINT,(function(e){t(e,shaka.ads.AdManager.AD_MIDPOINT)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.THIRD_QUARTILE,(function(e){t(e,shaka.ads.AdManager.AD_THIRD_QUARTILE)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.COMPLETE,(function(e){t(e,shaka.ads.AdManager.AD_COMPLETE)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,(function(t){e.onAdComplete_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(t){e.onAdComplete_(t)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.SKIPPED,(function(e){t(e,shaka.ads.AdManager.AD_SKIPPED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.VOLUME_CHANGED,(function(e){t(e,shaka.ads.AdManager.AD_VOLUME_CHANGED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.VOLUME_MUTED,(function(e){t(e,shaka.ads.AdManager.AD_MUTED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.PAUSED,(function(r){e.ad_&&(e.ad_.setPaused(!0),t(r,shaka.ads.AdManager.AD_PAUSED))})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.RESUMED,(function(r){e.ad_&&(e.ad_.setPaused(!1),t(r,shaka.ads.AdManager.AD_RESUMED))})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,(function(r){e.ad_&&t(r,shaka.ads.AdManager.AD_SKIP_STATE_CHANGED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.CLICK,(function(e){t(e,shaka.ads.AdManager.AD_CLICKED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.AD_PROGRESS,(function(e){t(e,shaka.ads.AdManager.AD_PROGRESS)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.AD_BUFFERING,(function(e){t(e,shaka.ads.AdManager.AD_BUFFERING)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.IMPRESSION,(function(e){t(e,shaka.ads.AdManager.AD_IMPRESSION)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.DURATION_CHANGE,(function(e){t(e,shaka.ads.AdManager.AD_DURATION_CHANGED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.USER_CLOSE,(function(e){t(e,shaka.ads.AdManager.AD_CLOSED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.LOADED,(function(e){t(e,shaka.ads.AdManager.AD_LOADED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(e){t(e,shaka.ads.AdManager.ALL_ADS_COMPLETED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.LINEAR_CHANGED,(function(e){t(e,shaka.ads.AdManager.AD_LINEAR_CHANGED)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.AD_METADATA,(function(e){t(e,shaka.ads.AdManager.AD_METADATA)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.LOG,(function(e){t(e,shaka.ads.AdManager.AD_RECOVERABLE_ERROR)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.AD_BREAK_READY,(function(e){t(e,shaka.ads.AdManager.AD_BREAK_READY)})),this.eventManager_.listen(this.imaAdsManager_,google.ima.AdEvent.Type.INTERACTION,(function(e){t(e,shaka.ads.AdManager.AD_INTERACTION)}))},shaka.ads.ClientSideAdManager.prototype.onAdStart_=function(e){goog.asserts.assert(this.imaAdsManager_,"Should have an ads manager at this point!");var t=e.getAd();t?(this.ad_=new shaka.ads.ClientSideAd(t,this.imaAdsManager_,this.video_),e=(new Map).set("ad",this.ad_).set("sdkAdObject",t).set("originalEvent",e),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STARTED,e)),this.ad_.isLinear()&&(this.adContainer_.setAttribute("ad-active","true"),this.config_.customPlayheadTracker||this.video_.pause(),this.video_.muted?this.ad_.setInitialMuted(this.video_.volume):this.ad_.setVolume(this.video_.volume))):shaka.log.alwaysWarn("The IMA SDK fired a "+e.type+" event with no associated ad. Unable to play ad!")},shaka.ads.ClientSideAdManager.prototype.onAdComplete_=function(e){this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STOPPED,(new Map).set("originalEvent",e))),this.ad_&&this.ad_.isLinear()&&(this.adContainer_.removeAttribute("ad-active"),this.config_.customPlayheadTracker||this.video_.ended||this.video_.play())},shaka.ads.MediaTailorAd=function(e,t,r,n,a){this.ad_=e,this.video_=a,this.adPosition_=t,this.totalAds_=r,this.isLinear_=n},shaka.ads.MediaTailorAd.prototype.getDuration=function(){return this.ad_.durationInSeconds},shaka.ads.MediaTailorAd.prototype.getMinSuggestedDuration=function(){return this.getDuration()},shaka.ads.MediaTailorAd.prototype.getRemainingTime=function(){return this.ad_.startTimeInSeconds+this.ad_.durationInSeconds-this.video_.currentTime},shaka.ads.MediaTailorAd.prototype.isPaused=function(){return this.video_.paused},shaka.ads.MediaTailorAd.prototype.isSkippable=function(){return!!this.ad_.skipOffset},shaka.ads.MediaTailorAd.prototype.getTimeUntilSkippable=function(){if(!this.ad_.skipOffset)return this.getRemainingTime();var e=this.getRemainingTime()-this.ad_.skipOffset;return Math.max(e,0)},shaka.ads.MediaTailorAd.prototype.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},shaka.ads.MediaTailorAd.prototype.skip=function(){this.video_.currentTime+=this.getRemainingTime()},shaka.ads.MediaTailorAd.prototype.pause=function(){return this.video_.pause()},shaka.ads.MediaTailorAd.prototype.play=function(){return this.video_.play()},shaka.ads.MediaTailorAd.prototype.getVolume=function(){return this.video_.volume},shaka.ads.MediaTailorAd.prototype.setVolume=function(e){this.video_.volume=e},shaka.ads.MediaTailorAd.prototype.isMuted=function(){return this.video_.muted},shaka.ads.MediaTailorAd.prototype.isLinear=function(){return this.isLinear_},shaka.ads.MediaTailorAd.prototype.resize=function(e,t){},shaka.ads.MediaTailorAd.prototype.setMuted=function(e){this.video_.muted=e},shaka.ads.MediaTailorAd.prototype.getSequenceLength=function(){return this.totalAds_?this.totalAds_:1},shaka.ads.MediaTailorAd.prototype.getPositionInSequence=function(){return this.adPosition_?this.adPosition_:1},shaka.ads.MediaTailorAd.prototype.getTitle=function(){return this.ad_.adTitle},shaka.ads.MediaTailorAd.prototype.getDescription=function(){return""},shaka.ads.MediaTailorAd.prototype.getVastMediaBitrate=function(){return 0},shaka.ads.MediaTailorAd.prototype.getVastMediaHeight=function(){return 0},shaka.ads.MediaTailorAd.prototype.getVastMediaWidth=function(){return 0},shaka.ads.MediaTailorAd.prototype.getAdId=function(){return this.ad_.adId},shaka.ads.MediaTailorAd.prototype.getCreativeAdId=function(){return this.ad_.creativeId},shaka.ads.MediaTailorAd.prototype.getAdvertiserName=function(){return""},shaka.ads.MediaTailorAd.prototype.getMediaUrl=function(){return null},shaka.ads.MediaTailorAd.prototype.getTimeOffset=function(){return 0},shaka.ads.MediaTailorAd.prototype.getPodIndex=function(){return 0},shaka.ads.MediaTailorAd.prototype.release=function(){this.totalAds_=this.adPosition_=this.video_=this.ad_=null},goog.exportSymbol("shaka.ads.MediaTailorAd",shaka.ads.MediaTailorAd),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"release",shaka.ads.MediaTailorAd.prototype.release),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getPodIndex",shaka.ads.MediaTailorAd.prototype.getPodIndex),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getTimeOffset",shaka.ads.MediaTailorAd.prototype.getTimeOffset),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getMediaUrl",shaka.ads.MediaTailorAd.prototype.getMediaUrl),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getAdvertiserName",shaka.ads.MediaTailorAd.prototype.getAdvertiserName),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getCreativeAdId",shaka.ads.MediaTailorAd.prototype.getCreativeAdId),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getAdId",shaka.ads.MediaTailorAd.prototype.getAdId),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getVastMediaWidth",shaka.ads.MediaTailorAd.prototype.getVastMediaWidth),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getVastMediaHeight",shaka.ads.MediaTailorAd.prototype.getVastMediaHeight),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getVastMediaBitrate",shaka.ads.MediaTailorAd.prototype.getVastMediaBitrate),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getDescription",shaka.ads.MediaTailorAd.prototype.getDescription),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getTitle",shaka.ads.MediaTailorAd.prototype.getTitle),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getPositionInSequence",shaka.ads.MediaTailorAd.prototype.getPositionInSequence),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getSequenceLength",shaka.ads.MediaTailorAd.prototype.getSequenceLength),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"setMuted",shaka.ads.MediaTailorAd.prototype.setMuted),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"resize",shaka.ads.MediaTailorAd.prototype.resize),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"isLinear",shaka.ads.MediaTailorAd.prototype.isLinear),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"isMuted",shaka.ads.MediaTailorAd.prototype.isMuted),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"setVolume",shaka.ads.MediaTailorAd.prototype.setVolume),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getVolume",shaka.ads.MediaTailorAd.prototype.getVolume),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"play",shaka.ads.MediaTailorAd.prototype.play),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"pause",shaka.ads.MediaTailorAd.prototype.pause),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"skip",shaka.ads.MediaTailorAd.prototype.skip),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"canSkipNow",shaka.ads.MediaTailorAd.prototype.canSkipNow),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getTimeUntilSkippable",shaka.ads.MediaTailorAd.prototype.getTimeUntilSkippable),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"isSkippable",shaka.ads.MediaTailorAd.prototype.isSkippable),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"isPaused",shaka.ads.MediaTailorAd.prototype.isPaused),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getRemainingTime",shaka.ads.MediaTailorAd.prototype.getRemainingTime),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getMinSuggestedDuration",shaka.ads.MediaTailorAd.prototype.getMinSuggestedDuration),goog.exportProperty(shaka.ads.MediaTailorAd.prototype,"getDuration",shaka.ads.MediaTailorAd.prototype.getDuration),shaka.ads.MediaTailorAdManager=function(e,t,r,n){this.adContainer_=e,this.networkingEngine_=t,this.video_=r,this.streamPromise_=null,this.streamRequestStartTime_=NaN,this.onEvent_=n,this.isLive_=!1,this.snapForwardTime_=null,this.adBreaks_=[],this.playedAds_=[],this.mediaTailorAdBreak_=this.mediaTailorAd_=this.ad_=null,this.staticResources_=new Map,this.adListeners_=[],this.eventsSent=[],this.trackingUrl_="",this.firstTrackingRequest_=!0,this.backupUrl_="",this.currentCuePoints_=[],this.eventManager_=new shaka.util.EventManager},shaka.ads.MediaTailorAdManager.prototype.streamRequest=function(e,t,r){return this.streamPromise_?Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CURRENT_DAI_REQUEST_NOT_FINISHED)):(this.streamPromise_=new shaka.util.PublicPromise,this.requestSessionInfo_(e,t),this.backupUrl_=r||"",this.streamRequestStartTime_=Date.now()/1e3,this.streamPromise_)},shaka.ads.MediaTailorAdManager.prototype.addTrackingUrl=function(e){this.trackingUrl_=e,this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.ADS_LOADED,(new Map).set("loadTime",0)))},shaka.ads.MediaTailorAdManager.prototype.stop=function(){for(var e=$jscomp.makeIterator(this.adListeners_),t=e.next();!t.done;t=e.next())t=t.value,this.eventManager_.unlisten(t.target,t.type,t.listener);this.onEnded_(),this.adListeners_=[],this.eventsSent=[],this.trackingUrl_="",this.firstTrackingRequest_=!0,this.backupUrl_="",this.snapForwardTime_=null,this.adBreaks_=[],this.playedAds_=[],this.staticResources_.clear()},shaka.ads.MediaTailorAdManager.prototype.release=function(){this.stop(),this.eventManager_&&this.eventManager_.release()},shaka.ads.MediaTailorAdManager.prototype.onManifestUpdated=function(e){this.isLive_=e,""!=this.trackingUrl_&&(this.requestTrackingInfo_(this.trackingUrl_,this.firstTrackingRequest_),this.firstTrackingRequest_=!1)},shaka.ads.MediaTailorAdManager.prototype.getCuePoints=function(){for(var e=[],t=$jscomp.makeIterator(this.adBreaks_),r=t.next();!r.done;r=t.next())for(var n=(r=$jscomp.makeIterator(r.value.ads)).next();!n.done;n=r.next())n=n.value,e.push({start:n.startTimeInSeconds,end:n.startTimeInSeconds+n.durationInSeconds});return e},shaka.ads.MediaTailorAdManager.prototype.requestSessionInfo_=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h,f=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(m){if(1==m.nextAddress)return r=shaka.net.NetworkingEngine.RequestType.ADS,(n=shaka.net.NetworkingEngine.makeRequest([e],shaka.net.NetworkingEngine.defaultRetryParameters())).method="POST",t&&(a=JSON.stringify(t),n.body=shaka.util.StringUtils.toUTF8(a)),i=f.networkingEngine_.request(r,n),m.setCatchFinallyBlocks(2),m.yield(i.promise,4);if(2!=m.nextAddress){if(o=m.yieldResult,s=shaka.util.StringUtils.fromUTF8(o.data),!(l=JSON.parse(s)).manifestUrl||!l.trackingUrl)throw Error("Insufficient data from MediaTailor.");return u=new goog.Uri(e),c=new goog.Uri(l.trackingUrl),f.trackingUrl_=u.resolve(c).toString(),d=Date.now()/1e3,p=d-f.streamRequestStartTime_,f.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.ADS_LOADED,(new Map).set("loadTime",p))),h=new goog.Uri(l.manifestUrl),f.streamPromise_.resolve(u.resolve(h).toString()),f.streamPromise_=null,m.leaveTryBlock(0)}if(m.enterCatchBlock(),!f.backupUrl_.length)return f.streamPromise_.reject("MediaTailor request returned an error and there was no backup asset uri provided."),f.streamPromise_=null,m.return();shaka.log.warning("MediaTailor request returned an error. Falling back to the backup asset uri."),f.streamPromise_.resolve(f.backupUrl_),f.streamPromise_=null,m.jumpToEnd()}))},shaka.ads.MediaTailorAdManager.prototype.requestTrackingInfo_=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){if(1==_.nextAddress)return r=shaka.net.NetworkingEngine.RequestType.ADS,n=shaka.net.NetworkingEngine.makeRequest([e],shaka.net.NetworkingEngine.defaultRetryParameters()),a=v.networkingEngine_.request(r,n),_.setCatchFinallyBlocks(2),_.yield(a.promise,4);if(2!=_.nextAddress){if(i=_.yieldResult,o=[],s=shaka.util.StringUtils.fromUTF8(i.data),0<(l=JSON.parse(s)).avails.length){if(JSON.stringify(v.adBreaks_)!=JSON.stringify(l.avails)){for(v.adBreaks_=l.avails,u=$jscomp.makeIterator(v.adBreaks_),c=u.next();!c.done;c=u.next())for(d=c.value,p=$jscomp.makeIterator(d.nonLinearAdsList),h=p.next();!h.done;h=p.next())for(f=h.value,m=$jscomp.makeIterator(f.nonLinearAdList),g=m.next();!g.done;g=m.next())y=g.value,v.requestStaticResource_(y);o=v.getCuePoints(),v.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.CUEPOINTS_CHANGED,(new Map).set("cuepoints",o)))}}else v.adBreaks_.length&&v.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.CUEPOINTS_CHANGED,(new Map).set("cuepoints",o))),v.onEnded_(),v.adBreaks_=[];return t&&(v.isLive_||0<o.length)&&v.setupAdBreakListeners_(),_.leaveTryBlock(0)}_.enterCatchBlock(),_.jumpToEnd()}))},shaka.ads.MediaTailorAdManager.prototype.requestStaticResource_=function(e){var t,r,n,a,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){return 1==c.nextAddress?e.staticResource?(t=u.getCacheKeyForNonLinear_(e),u.staticResources_.get(t)?c.return():(r=shaka.net.NetworkingEngine.RequestType.ADS,n=shaka.net.NetworkingEngine.makeRequest([e.staticResource],shaka.net.NetworkingEngine.defaultRetryParameters()),a=u.networkingEngine_.request(r,n),c.setCatchFinallyBlocks(2),u.staticResources_.set(t,[]),c.yield(a.promise,4))):c.return():2!=c.nextAddress?(i=c.yieldResult,o=shaka.util.StringUtils.fromUTF8(i.data),s=JSON.parse(o),l=s.apps,u.staticResources_.set(t,l),c.leaveTryBlock(0)):(c.enterCatchBlock(),u.staticResources_.delete(t),void c.jumpToEnd())}))},shaka.ads.MediaTailorAdManager.prototype.getCacheKeyForNonLinear_=function(e){return[e.adId,e.adParameters,e.adSystem,e.adTitle,e.creativeAdId,e.creativeId,e.creativeSequence,e.height,e.width,e.staticResource].join("")},shaka.ads.MediaTailorAdManager.prototype.setupAdBreakListeners_=function(){var e=this;this.onTimeupdate_(),this.isLive_||(this.checkForSnapback_(),this.eventManager_.listen(this.video_,"seeked",(function(){e.checkForSnapback_()})),this.eventManager_.listen(this.video_,"ended",(function(){e.onEnded_()}))),this.eventManager_.listen(this.video_,"timeupdate",(function(){e.onTimeupdate_()}))},shaka.ads.MediaTailorAdManager.prototype.checkForSnapback_=function(){var e=this.video_.currentTime;if(0!=e&&null==this.snapForwardTime_){for(var t,r,n=$jscomp.makeIterator(this.adBreaks_),a=n.next();!a.done;a=n.next()){a=a.value;for(var i=$jscomp.makeIterator(a.ads),o=i.next();!o.done;o=i.next())if(o=o.value,r){if(o.startTimeInSeconds<e&&o.startTimeInSeconds>r.startTimeInSeconds+r.durationInSeconds){r=o,t=a;break}}else o.startTimeInSeconds<e&&(r=o,t=a)}t&&r&&!this.playedAds_.includes(r.adId)&&(shaka.log.info("Seeking back to the start of the ad break at "+t.startTimeInSeconds+" and will return to "+e),this.snapForwardTime_=e,this.video_.currentTime=t.startTimeInSeconds)}},shaka.ads.MediaTailorAdManager.prototype.onAdBreakEnded_=function(){var e=this.video_.currentTime;this.snapForwardTime_&&this.snapForwardTime_>e&&(this.video_.currentTime=this.snapForwardTime_),this.snapForwardTime_=null},shaka.ads.MediaTailorAdManager.prototype.onTimeupdate_=function(){if(this.video_.duration&&(this.ad_||this.adBreaks_.length)){var e=this.video_.currentTime,t=!1;if(this.ad_){t=!0,goog.asserts.assert(this.mediaTailorAd_,"Ad should be defined"),this.sendInProgressEvents_(e,this.mediaTailorAd_);var r=this.ad_.getRemainingTime(),n=this.ad_.getDuration();0<n&&(0>=r||r>n)&&this.onEnded_()}this.ad_&&this.ad_.isLinear()||(this.checkLinearAds_(e),this.ad_||this.checkNonLinearAds_(e),t&&!this.ad_&&this.onAdBreakEnded_())}},shaka.ads.MediaTailorAdManager.prototype.sendInProgressEvents_=function(e,t){var r=shaka.ads.MediaTailorAdManager,n=t.startTimeInSeconds+.5*t.durationInSeconds,a=t.startTimeInSeconds+.75*t.durationInSeconds;e>=t.startTimeInSeconds+.25*t.durationInSeconds&&!this.eventsSent.includes(r.FIRSTQUARTILE_)?(this.eventsSent.push(r.FIRSTQUARTILE_),this.sendTrackingEvent_(r.FIRSTQUARTILE_)):e>=n&&!this.eventsSent.includes(r.MIDPOINT_)?(this.eventsSent.push(r.MIDPOINT_),this.sendTrackingEvent_(r.MIDPOINT_)):e>=a&&!this.eventsSent.includes(r.THIRDQUARTILE_)&&(this.eventsSent.push(r.THIRDQUARTILE_),this.sendTrackingEvent_(r.THIRDQUARTILE_))},shaka.ads.MediaTailorAdManager.prototype.checkLinearAds_=function(e){for(var t=shaka.ads.MediaTailorAdManager,r=$jscomp.makeIterator(this.adBreaks_),n=r.next();!n.done&&(n=n.value,!this.ad_||!this.ad_.isLinear());n=r.next())for(var a=0;a<n.ads.length;a++){var i=n.ads[a],o=i.startTimeInSeconds+i.durationInSeconds;if(i.startTimeInSeconds<=e&&o>e){if(this.playedAds_.includes(i.adId)){if(this.video_.ended)continue;return void(this.video_.currentTime=o)}this.onEnded_(),this.mediaTailorAdBreak_=n,this.ad_=new shaka.ads.MediaTailorAd(i,a+1,n.ads.length,!0,this.video_),this.mediaTailorAd_=i,0===a&&this.sendTrackingEvent_(t.BREAKSTART_),this.setupCurrentAdListeners_();break}}},shaka.ads.MediaTailorAdManager.prototype.checkNonLinearAds_=function(e){for(var t=shaka.ads.MediaTailorAdManager,r=$jscomp.makeIterator(this.adBreaks_),n=r.next();!n.done&&(n=n.value,!this.ad_);n=r.next())for(var a=0;a<n.nonLinearAdsList.length;a++){var i=n.nonLinearAdsList[a];if(i.nonLinearAdList.length){var o=n.startTimeInSeconds,s=this.getCacheKeyForNonLinear_(i.nonLinearAdList[0]);if(s=this.staticResources_.get(s),o<=e&&s&&s.length){this.onEnded_(),this.displayNonLinearAd_(s),this.mediaTailorAdBreak_=n,this.ad_=new shaka.ads.MediaTailorAd(i,a+1,n.ads.length,!1,this.video_),this.mediaTailorAd_=i,0===a&&this.sendTrackingEvent_(t.BREAKSTART_),this.setupCurrentAdListeners_();break}}}},shaka.ads.MediaTailorAdManager.prototype.displayNonLinearAd_=function(e){for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())if((t=t.value).data.source.length){var r=document.createElement("img");r.src=t.data.source[0].url,r.style.top=(t.placeholder.top||0)+"%",r.style.height=100-(t.placeholder.top||0)+"%",r.style.left=(t.placeholder.left||0)+"%",r.style.maxWidth=100-(t.placeholder.left||0)+"%",r.style.objectFit="contain",r.style.position="absolute",this.adContainer_.appendChild(r)}},shaka.ads.MediaTailorAdManager.prototype.onEnded_=function(){if(this.ad_){for(;this.adContainer_.lastChild;)this.adContainer_.removeChild(this.adContainer_.firstChild);this.isLive_||this.playedAds_.push(this.mediaTailorAd_.adId),this.removeCurrentAdListeners_(),this.ad_.getPositionInSequence()===this.ad_.getSequenceLength()&&this.sendTrackingEvent_(shaka.ads.MediaTailorAdManager.BREAKEND_),this.mediaTailorAdBreak_=this.mediaTailorAd_=this.ad_=null}},shaka.ads.MediaTailorAdManager.prototype.setupCurrentAdListeners_=function(){var e=this,t=shaka.ads.MediaTailorAdManager,r=!1;this.video_.paused?r=!0:(this.sendTrackingEvent_(t.IMPRESSION_),this.sendTrackingEvent_(t.START_)),this.adListeners_.push({target:this.video_,type:"volumechange",listener:function(){e.video_.muted&&e.sendTrackingEvent_(t.MUTE_)}}),this.adListeners_.push({target:this.video_,type:"volumechange",listener:function(){e.video_.muted||e.sendTrackingEvent_(t.UNMUTE_)}}),this.adListeners_.push({target:this.video_,type:"play",listener:function(){r?(e.sendTrackingEvent_(t.IMPRESSION_),e.sendTrackingEvent_(t.START_),r=!1):e.sendTrackingEvent_(t.RESUME_)}}),this.adListeners_.push({target:this.video_,type:"pause",listener:function(){e.sendTrackingEvent_(t.PAUSE_)}});for(var n=$jscomp.makeIterator(this.adListeners_),a=n.next();!a.done;a=n.next())a=a.value,this.eventManager_.listen(a.target,a.type,a.listener)},shaka.ads.MediaTailorAdManager.prototype.removeCurrentAdListeners_=function(){this.sendTrackingEvent_(shaka.ads.MediaTailorAdManager.COMPLETE_);for(var e=$jscomp.makeIterator(this.adListeners_),t=e.next();!t.done;t=e.next())t=t.value,this.eventManager_.unlisten(t.target,t.type,t.listener);this.adListeners_=[],this.eventsSent=[]},shaka.ads.MediaTailorAdManager.prototype.sendTrackingEvent_=function(e){var t=this.mediaTailorAd_.trackingEvents.find((function(t){return t.eventType==e}));if(t||(t=this.mediaTailorAdBreak_.adBreakTrackingEvents.find((function(t){return t.eventType==e}))),t)for(var r=shaka.net.NetworkingEngine.RequestType.ADS,n=(t=$jscomp.makeIterator(t.beaconUrls)).next();!n.done;n=t.next())(n=n.value)&&""!=n&&((n=shaka.net.NetworkingEngine.makeRequest([n],shaka.net.NetworkingEngine.defaultRetryParameters())).method="POST",this.networkingEngine_.request(r,n));switch(e){case shaka.ads.MediaTailorAdManager.IMPRESSION_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_IMPRESSION));break;case shaka.ads.MediaTailorAdManager.START_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STARTED,(new Map).set("ad",this.ad_)));break;case shaka.ads.MediaTailorAdManager.MUTE_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_MUTED));break;case shaka.ads.MediaTailorAdManager.UNMUTE_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_VOLUME_CHANGED));break;case shaka.ads.MediaTailorAdManager.RESUME_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_RESUMED));break;case shaka.ads.MediaTailorAdManager.PAUSE_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_PAUSED));break;case shaka.ads.MediaTailorAdManager.FIRSTQUARTILE_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_FIRST_QUARTILE));break;case shaka.ads.MediaTailorAdManager.MIDPOINT_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_MIDPOINT));break;case shaka.ads.MediaTailorAdManager.THIRDQUARTILE_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_THIRD_QUARTILE));break;case shaka.ads.MediaTailorAdManager.COMPLETE_:this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_COMPLETE)),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STOPPED));break;case shaka.ads.MediaTailorAdManager.BREAKSTART_:this.adContainer_.setAttribute("ad-active","true");break;case shaka.ads.MediaTailorAdManager.BREAKEND_:this.adContainer_.removeAttribute("ad-active")}},shaka.ads.MediaTailorAdManager.IMPRESSION_="impression",shaka.ads.MediaTailorAdManager.START_="start",shaka.ads.MediaTailorAdManager.MUTE_="mute",shaka.ads.MediaTailorAdManager.UNMUTE_="unmute",shaka.ads.MediaTailorAdManager.RESUME_="resume",shaka.ads.MediaTailorAdManager.PAUSE_="pause",shaka.ads.MediaTailorAdManager.FIRSTQUARTILE_="firstQuartile",shaka.ads.MediaTailorAdManager.MIDPOINT_="midpoint",shaka.ads.MediaTailorAdManager.THIRDQUARTILE_="thirdQuartile",shaka.ads.MediaTailorAdManager.COMPLETE_="complete",shaka.ads.MediaTailorAdManager.BREAKSTART_="breakStart",shaka.ads.MediaTailorAdManager.BREAKEND_="breakEnd",shaka.ads.ServerSideAd=function(e,t){this.ad_=e,this.adProgressData_=null,this.video_=t},shaka.ads.ServerSideAd.prototype.setProgressData=function(e){this.adProgressData_=e},shaka.ads.ServerSideAd.prototype.getDuration=function(){return this.adProgressData_?this.adProgressData_.duration:-1},shaka.ads.ServerSideAd.prototype.getMinSuggestedDuration=function(){return this.getDuration()},shaka.ads.ServerSideAd.prototype.getRemainingTime=function(){return this.adProgressData_?this.adProgressData_.duration-this.adProgressData_.currentTime:-1},shaka.ads.ServerSideAd.prototype.isPaused=function(){return this.video_.paused},shaka.ads.ServerSideAd.prototype.isSkippable=function(){return this.ad_.isSkippable()},shaka.ads.ServerSideAd.prototype.getTimeUntilSkippable=function(){var e=this.ad_.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},shaka.ads.ServerSideAd.prototype.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},shaka.ads.ServerSideAd.prototype.skip=function(){this.video_.currentTime+=this.getRemainingTime()},shaka.ads.ServerSideAd.prototype.pause=function(){return this.video_.pause()},shaka.ads.ServerSideAd.prototype.play=function(){return this.video_.play()},shaka.ads.ServerSideAd.prototype.getVolume=function(){return this.video_.volume},shaka.ads.ServerSideAd.prototype.setVolume=function(e){this.video_.volume=e},shaka.ads.ServerSideAd.prototype.isMuted=function(){return this.video_.muted},shaka.ads.ServerSideAd.prototype.isLinear=function(){return!0},shaka.ads.ServerSideAd.prototype.resize=function(e,t){},shaka.ads.ServerSideAd.prototype.setMuted=function(e){this.video_.muted=e},shaka.ads.ServerSideAd.prototype.getSequenceLength=function(){var e=this.ad_.getAdPodInfo();return null==e?1:e.getTotalAds()},shaka.ads.ServerSideAd.prototype.getPositionInSequence=function(){var e=this.ad_.getAdPodInfo();return null==e?1:e.getAdPosition()},shaka.ads.ServerSideAd.prototype.getTitle=function(){return this.ad_.getTitle()},shaka.ads.ServerSideAd.prototype.getDescription=function(){return this.ad_.getDescription()},shaka.ads.ServerSideAd.prototype.getVastMediaBitrate=function(){return 0},shaka.ads.ServerSideAd.prototype.getVastMediaHeight=function(){return this.ad_.getVastMediaHeight()},shaka.ads.ServerSideAd.prototype.getVastMediaWidth=function(){return this.ad_.getVastMediaWidth()},shaka.ads.ServerSideAd.prototype.getAdId=function(){return this.ad_.getAdId()},shaka.ads.ServerSideAd.prototype.getCreativeAdId=function(){return this.ad_.getCreativeAdId()},shaka.ads.ServerSideAd.prototype.getAdvertiserName=function(){return this.ad_.getAdvertiserName()},shaka.ads.ServerSideAd.prototype.getMediaUrl=function(){return null},shaka.ads.ServerSideAd.prototype.getTimeOffset=function(){var e=this.ad_.getAdPodInfo();return null==e?0:e.getTimeOffset()},shaka.ads.ServerSideAd.prototype.getPodIndex=function(){var e=this.ad_.getAdPodInfo();return null==e?0:e.getPodIndex()},shaka.ads.ServerSideAd.prototype.release=function(){this.video_=this.adProgressData_=this.ad_=null},goog.exportSymbol("shaka.ads.ServerSideAd",shaka.ads.ServerSideAd),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"release",shaka.ads.ServerSideAd.prototype.release),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getPodIndex",shaka.ads.ServerSideAd.prototype.getPodIndex),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getTimeOffset",shaka.ads.ServerSideAd.prototype.getTimeOffset),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getMediaUrl",shaka.ads.ServerSideAd.prototype.getMediaUrl),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getAdvertiserName",shaka.ads.ServerSideAd.prototype.getAdvertiserName),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getCreativeAdId",shaka.ads.ServerSideAd.prototype.getCreativeAdId),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getAdId",shaka.ads.ServerSideAd.prototype.getAdId),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getVastMediaWidth",shaka.ads.ServerSideAd.prototype.getVastMediaWidth),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getVastMediaHeight",shaka.ads.ServerSideAd.prototype.getVastMediaHeight),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getVastMediaBitrate",shaka.ads.ServerSideAd.prototype.getVastMediaBitrate),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getDescription",shaka.ads.ServerSideAd.prototype.getDescription),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getTitle",shaka.ads.ServerSideAd.prototype.getTitle),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getPositionInSequence",shaka.ads.ServerSideAd.prototype.getPositionInSequence),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getSequenceLength",shaka.ads.ServerSideAd.prototype.getSequenceLength),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"setMuted",shaka.ads.ServerSideAd.prototype.setMuted),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"resize",shaka.ads.ServerSideAd.prototype.resize),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isLinear",shaka.ads.ServerSideAd.prototype.isLinear),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isMuted",shaka.ads.ServerSideAd.prototype.isMuted),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"setVolume",shaka.ads.ServerSideAd.prototype.setVolume),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getVolume",shaka.ads.ServerSideAd.prototype.getVolume),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"play",shaka.ads.ServerSideAd.prototype.play),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"pause",shaka.ads.ServerSideAd.prototype.pause),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"skip",shaka.ads.ServerSideAd.prototype.skip),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"canSkipNow",shaka.ads.ServerSideAd.prototype.canSkipNow),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getTimeUntilSkippable",shaka.ads.ServerSideAd.prototype.getTimeUntilSkippable),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isSkippable",shaka.ads.ServerSideAd.prototype.isSkippable),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"isPaused",shaka.ads.ServerSideAd.prototype.isPaused),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getRemainingTime",shaka.ads.ServerSideAd.prototype.getRemainingTime),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getMinSuggestedDuration",shaka.ads.ServerSideAd.prototype.getMinSuggestedDuration),goog.exportProperty(shaka.ads.ServerSideAd.prototype,"getDuration",shaka.ads.ServerSideAd.prototype.getDuration),shaka.ads.ServerSideAdManager=function(e,t,r,n){var a=this;this.adContainer_=e,this.video_=t,this.streamPromise_=this.config_=null,this.streamRequestStartTime_=NaN,this.onEvent_=n,this.isLiveContent_=!1,this.adProgressData_=this.ad_=this.snapForwardTime_=null,this.backupUrl_="",this.currentCuePoints_=[],this.eventManager_=new shaka.util.EventManager,(e=new google.ima.dai.api.UiSettings).setLocale(r),this.streamManager_=new google.ima.dai.api.StreamManager(this.video_,this.adContainer_,e),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.IMA_STREAM_MANAGER_LOADED,(new Map).set("imaStreamManager",this.streamManager_))),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.LOADED,(function(e){shaka.log.info("Ad SS Loaded"),a.onLoaded_(e)})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.ERROR,(function(){shaka.log.info("Ad SS Error"),a.onError_()})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,(function(){shaka.log.info("Ad Break Started")})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.STARTED,(function(e){shaka.log.info("Ad Started"),a.onAdStart_(e)})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,(function(){shaka.log.info("Ad Break Ended"),a.onAdBreakEnded_()})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,(function(e){a.onAdProgress_(e)})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,(function(){shaka.log.info("Ad event: First Quartile"),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_FIRST_QUARTILE))})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.MIDPOINT,(function(){shaka.log.info("Ad event: Midpoint"),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_MIDPOINT))})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,(function(){shaka.log.info("Ad event: Third Quartile"),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_THIRD_QUARTILE))})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.COMPLETE,(function(){shaka.log.info("Ad event: Complete"),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_COMPLETE)),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STOPPED)),a.adContainer_.removeAttribute("ad-active"),a.ad_=null})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.SKIPPED,(function(){shaka.log.info("Ad event: Skipped"),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_SKIPPED)),a.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STOPPED))})),this.eventManager_.listen(this.streamManager_,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,(function(e){shaka.log.info("Ad event: Cue points changed"),a.onCuePointsChanged_(e)}))},shaka.ads.ServerSideAdManager.prototype.configure=function(e){this.config_=e},shaka.ads.ServerSideAdManager.prototype.streamRequest=function(e,t){return this.streamPromise_?Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CURRENT_DAI_REQUEST_NOT_FINISHED)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(this.isLiveContent_=!0),this.streamPromise_=new shaka.util.PublicPromise,this.streamManager_.requestStream(e),this.backupUrl_=t||"",this.streamRequestStartTime_=Date.now()/1e3,this.streamPromise_)},shaka.ads.ServerSideAdManager.prototype.replaceAdTagParameters=function(e){this.streamManager_.replaceAdTagParameters(e)},shaka.ads.ServerSideAdManager.prototype.stop=function(){this.backupUrl_="",this.snapForwardTime_=null,this.currentCuePoints_=[]},shaka.ads.ServerSideAdManager.prototype.release=function(){this.stop(),this.eventManager_&&this.eventManager_.release()},shaka.ads.ServerSideAdManager.prototype.onTimedMetadata=function(e,t,r){this.streamManager_.processMetadata(e,t,r)},shaka.ads.ServerSideAdManager.prototype.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.streamManager_.onTimedMetadata(t)}},shaka.ads.ServerSideAdManager.prototype.getCuePoints=function(){return this.currentCuePoints_},shaka.ads.ServerSideAdManager.prototype.checkForSnapback_=function(){var e=this.video_.currentTime;if(0!=e){this.streamManager_.streamTimeForContentTime(e);var t=this.streamManager_.previousCuePointForStreamTime(e);t&&!t.played&&(shaka.log.info("Seeking back to the start of the ad break at "+t.start+" and will return to "+e),this.snapForwardTime_=e,this.video_.currentTime=t.start)}},shaka.ads.ServerSideAdManager.prototype.onAdStart_=function(e){goog.asserts.assert(this.streamManager_,"Should have a stream manager at this point!"),e=e.getAd(),this.ad_=new shaka.ads.ServerSideAd(e,this.video_),this.adProgressData_&&this.ad_.setProgressData(this.adProgressData_),this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STARTED,(new Map).set("ad",this.ad_))),this.adContainer_.setAttribute("ad-active","true")},shaka.ads.ServerSideAdManager.prototype.onAdBreakEnded_=function(){this.adContainer_.removeAttribute("ad-active");var e=this.video_.currentTime;this.snapForwardTime_&&this.snapForwardTime_>e&&(this.video_.currentTime=this.snapForwardTime_,this.snapForwardTime_=null)},shaka.ads.ServerSideAdManager.prototype.onLoaded_=function(e){var t=this,r=Date.now()/1e3-this.streamRequestStartTime_;this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.ADS_LOADED,(new Map).set("loadTime",r))),e=e.getStreamData().url,this.streamPromise_.resolve(e),this.streamPromise_=null,this.isLiveContent_||this.eventManager_.listen(this.video_,"seeked",(function(){t.checkForSnapback_()}))},shaka.ads.ServerSideAdManager.prototype.onError_=function(){this.backupUrl_.length?(shaka.log.warning("IMA stream request returned an error. Falling back to the backup asset uri."),this.streamPromise_.resolve(this.backupUrl_)):this.streamPromise_.reject("IMA Stream request returned an error and there was no backup asset uri provided."),this.streamPromise_=null},shaka.ads.ServerSideAdManager.prototype.onAdProgress_=function(e){this.adProgressData_=e.getStreamData().adProgressData,this.ad_&&this.ad_.setProgressData(this.adProgressData_)},shaka.ads.ServerSideAdManager.prototype.onCuePointsChanged_=function(e){var t=e.getStreamData();e=[];for(var r=(t=$jscomp.makeIterator(t.cuepoints)).next();!r.done;r=t.next())r=r.value,e.push({start:r.start,end:r.end});this.currentCuePoints_=e,this.onEvent_(new shaka.util.FakeEvent(shaka.ads.AdManager.CUEPOINTS_CHANGED,(new Map).set("cuepoints",e)))},shaka.ads.AdManager=function(){shaka.util.FakeEventTarget.call(this),this.ssAdManager_=this.mtAdManager_=this.csAdManager_=null,this.stats_=new shaka.ads.AdsStats,this.locale_=navigator.language,this.config_=null},$jscomp.inherits(shaka.ads.AdManager,shaka.util.FakeEventTarget),shaka.ads.AdManager.prototype.setLocale=function(e){this.locale_=e},shaka.ads.AdManager.prototype.configure=function(e){this.config_=e,this.csAdManager_&&this.csAdManager_.configure(this.config_),this.ssAdManager_&&this.ssAdManager_.configure(this.config_)},shaka.ads.AdManager.prototype.initClientSide=function(e,t,r){var n=this;if(!window.google||!google.ima||!google.ima.AdsLoader)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CS_IMA_SDK_MISSING);this.csAdManager_&&this.csAdManager_.release(),this.csAdManager_=new shaka.ads.ClientSideAdManager(e,t,this.locale_,r,(function(e){return n.processAndDispatchEvent_(e)})),goog.asserts.assert(this.config_,"Config must not be null!"),this.csAdManager_.configure(this.config_)},shaka.ads.AdManager.prototype.release=function(){this.csAdManager_&&(this.csAdManager_.release(),this.csAdManager_=null),this.mtAdManager_&&(this.mtAdManager_.release(),this.mtAdManager_=null),this.ssAdManager_&&(this.ssAdManager_.release(),this.ssAdManager_=null),shaka.util.FakeEventTarget.prototype.release.call(this)},shaka.ads.AdManager.prototype.onAssetUnload=function(){this.csAdManager_&&this.csAdManager_.stop(),this.mtAdManager_&&this.mtAdManager_.stop(),this.ssAdManager_&&this.ssAdManager_.stop(),this.dispatchEvent(new shaka.util.FakeEvent(shaka.ads.AdManager.AD_STOPPED)),this.stats_=new shaka.ads.AdsStats},shaka.ads.AdManager.prototype.requestClientSideAds=function(e){if(!this.csAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CS_AD_MANAGER_NOT_INITIALIZED);this.csAdManager_.requestAds(e)},shaka.ads.AdManager.prototype.updateClientSideAdsRenderingSettings=function(e){if(!this.csAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.CS_AD_MANAGER_NOT_INITIALIZED);this.csAdManager_.updateAdsRenderingSettings(e)},shaka.ads.AdManager.prototype.initMediaTailor=function(e,t,r){var n=this;this.mtAdManager_&&this.mtAdManager_.release(),this.mtAdManager_=new shaka.ads.MediaTailorAdManager(e,t,r,(function(e){return n.processAndDispatchEvent_(e)}))},shaka.ads.AdManager.prototype.requestMediaTailorStream=function(e,t,r){if(r=void 0===r?"":r,!this.mtAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.MT_AD_MANAGER_NOT_INITIALIZED);return this.mtAdManager_.streamRequest(e,t,r)},shaka.ads.AdManager.prototype.addMediaTailorTrackingUrl=function(e){if(!this.mtAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.MT_AD_MANAGER_NOT_INITIALIZED);this.mtAdManager_.addTrackingUrl(e)},shaka.ads.AdManager.prototype.initServerSide=function(e,t){var r=this;if(!window.google||!google.ima||!google.ima.dai)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.ADS,shaka.util.Error.Code.SS_IMA_SDK_MISSING);this.ssAdManager_&&this.ssAdManager_.release(),this.ssAdManager_=new shaka.ads.ServerSideAdManager(e,t,this.locale_,(function(e){return r.processAndDispatchEvent_(e)})),goog.asserts.assert(this.config_,"Config must not be null!"),this.ssAdManager_.configure(this.config_)},shaka.ads.AdManager.prototype.requestServerSideStream=function(e,t){if(t=void 0===t?"":t,!this.ssAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.SS_AD_MANAGER_NOT_INITIALIZED);e.adTagParameters||(e.adTagParameters={});var r=e.adTagParameters;return(r.mpt||r.mpv)&&shaka.log.alwaysWarn('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv=shaka.Player.version,this.ssAdManager_.streamRequest(e,t)},shaka.ads.AdManager.prototype.replaceServerSideAdTagParameters=function(e){if(!this.ssAdManager_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.ADS,shaka.util.Error.Code.SS_AD_MANAGER_NOT_INITIALIZED);(e.mpt||e.mpv)&&shaka.log.alwaysWarn('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.mpt="Shaka Player",e.mpv=shaka.Player.version,this.ssAdManager_.replaceAdTagParameters(e)},shaka.ads.AdManager.prototype.getServerSideCuePoints=function(){return shaka.Deprecate.deprecateFeature(5,"AdManager.getServerSideCuePoints","Please use getCuePoints function."),this.getCuePoints()},shaka.ads.AdManager.prototype.getCuePoints=function(){var e=[];return this.ssAdManager_&&(e=e.concat(this.ssAdManager_.getCuePoints())),this.mtAdManager_&&(e=e.concat(this.mtAdManager_.getCuePoints())),e},shaka.ads.AdManager.prototype.getStats=function(){return this.stats_.getBlob()},shaka.ads.AdManager.prototype.onManifestUpdated=function(e){this.mtAdManager_&&this.mtAdManager_.onManifestUpdated(e)},shaka.ads.AdManager.prototype.onDashTimedMetadata=function(e){this.ssAdManager_&&"urn:google:dai:2018"==e.schemeIdUri&&this.ssAdManager_.onTimedMetadata(e.schemeIdUri,e.eventNode?e.eventNode.attributes.messageData:null,e.startTime)},shaka.ads.AdManager.prototype.onHlsTimedMetadata=function(e,t){this.ssAdManager_&&this.ssAdManager_.onTimedMetadata("ID3",e.data,t)},shaka.ads.AdManager.prototype.onCueMetadataChange=function(e){this.ssAdManager_&&this.ssAdManager_.onCueMetadataChange(e)},shaka.ads.AdManager.prototype.processAndDispatchEvent_=function(e){if(e&&e.type)switch(e.type){case shaka.ads.AdManager.ADS_LOADED:this.stats_.addLoadTime(e.loadTime);break;case shaka.ads.AdManager.AD_STARTED:this.stats_.incrementStarted();break;case shaka.ads.AdManager.AD_COMPLETE:this.stats_.incrementPlayedCompletely();break;case shaka.ads.AdManager.AD_SKIPPED:this.stats_.incrementSkipped()}this.dispatchEvent(e)},goog.exportSymbol("shaka.ads.AdManager",shaka.ads.AdManager),goog.exportProperty(shaka.ads.AdManager.prototype,"onCueMetadataChange",shaka.ads.AdManager.prototype.onCueMetadataChange),goog.exportProperty(shaka.ads.AdManager.prototype,"onHlsTimedMetadata",shaka.ads.AdManager.prototype.onHlsTimedMetadata),goog.exportProperty(shaka.ads.AdManager.prototype,"onDashTimedMetadata",shaka.ads.AdManager.prototype.onDashTimedMetadata),goog.exportProperty(shaka.ads.AdManager.prototype,"onManifestUpdated",shaka.ads.AdManager.prototype.onManifestUpdated),goog.exportProperty(shaka.ads.AdManager.prototype,"getStats",shaka.ads.AdManager.prototype.getStats),goog.exportProperty(shaka.ads.AdManager.prototype,"getCuePoints",shaka.ads.AdManager.prototype.getCuePoints),goog.exportProperty(shaka.ads.AdManager.prototype,"getServerSideCuePoints",shaka.ads.AdManager.prototype.getServerSideCuePoints),goog.exportProperty(shaka.ads.AdManager.prototype,"replaceServerSideAdTagParameters",shaka.ads.AdManager.prototype.replaceServerSideAdTagParameters),goog.exportProperty(shaka.ads.AdManager.prototype,"requestServerSideStream",shaka.ads.AdManager.prototype.requestServerSideStream),goog.exportProperty(shaka.ads.AdManager.prototype,"initServerSide",shaka.ads.AdManager.prototype.initServerSide),goog.exportProperty(shaka.ads.AdManager.prototype,"addMediaTailorTrackingUrl",shaka.ads.AdManager.prototype.addMediaTailorTrackingUrl),goog.exportProperty(shaka.ads.AdManager.prototype,"requestMediaTailorStream",shaka.ads.AdManager.prototype.requestMediaTailorStream),goog.exportProperty(shaka.ads.AdManager.prototype,"initMediaTailor",shaka.ads.AdManager.prototype.initMediaTailor),goog.exportProperty(shaka.ads.AdManager.prototype,"updateClientSideAdsRenderingSettings",shaka.ads.AdManager.prototype.updateClientSideAdsRenderingSettings),goog.exportProperty(shaka.ads.AdManager.prototype,"requestClientSideAds",shaka.ads.AdManager.prototype.requestClientSideAds),goog.exportProperty(shaka.ads.AdManager.prototype,"onAssetUnload",shaka.ads.AdManager.prototype.onAssetUnload),goog.exportProperty(shaka.ads.AdManager.prototype,"release",shaka.ads.AdManager.prototype.release),goog.exportProperty(shaka.ads.AdManager.prototype,"initClientSide",shaka.ads.AdManager.prototype.initClientSide),goog.exportProperty(shaka.ads.AdManager.prototype,"configure",shaka.ads.AdManager.prototype.configure),goog.exportProperty(shaka.ads.AdManager.prototype,"setLocale",shaka.ads.AdManager.prototype.setLocale),shaka.ads.AdManager.ADS_LOADED="ads-loaded",goog.exportProperty(shaka.ads.AdManager,"ADS_LOADED",shaka.ads.AdManager.ADS_LOADED),shaka.ads.AdManager.AD_STARTED="ad-started",goog.exportProperty(shaka.ads.AdManager,"AD_STARTED",shaka.ads.AdManager.AD_STARTED),shaka.ads.AdManager.AD_FIRST_QUARTILE="ad-first-quartile",goog.exportProperty(shaka.ads.AdManager,"AD_FIRST_QUARTILE",shaka.ads.AdManager.AD_FIRST_QUARTILE),shaka.ads.AdManager.AD_MIDPOINT="ad-midpoint",goog.exportProperty(shaka.ads.AdManager,"AD_MIDPOINT",shaka.ads.AdManager.AD_MIDPOINT),shaka.ads.AdManager.AD_THIRD_QUARTILE="ad-third-quartile",goog.exportProperty(shaka.ads.AdManager,"AD_THIRD_QUARTILE",shaka.ads.AdManager.AD_THIRD_QUARTILE),shaka.ads.AdManager.AD_COMPLETE="ad-complete",goog.exportProperty(shaka.ads.AdManager,"AD_COMPLETE",shaka.ads.AdManager.AD_COMPLETE),shaka.ads.AdManager.AD_STOPPED="ad-stopped",goog.exportProperty(shaka.ads.AdManager,"AD_STOPPED",shaka.ads.AdManager.AD_STOPPED),shaka.ads.AdManager.AD_SKIPPED="ad-skipped",goog.exportProperty(shaka.ads.AdManager,"AD_SKIPPED",shaka.ads.AdManager.AD_SKIPPED),shaka.ads.AdManager.AD_VOLUME_CHANGED="ad-volume-changed",goog.exportProperty(shaka.ads.AdManager,"AD_VOLUME_CHANGED",shaka.ads.AdManager.AD_VOLUME_CHANGED),shaka.ads.AdManager.AD_MUTED="ad-muted",goog.exportProperty(shaka.ads.AdManager,"AD_MUTED",shaka.ads.AdManager.AD_MUTED),shaka.ads.AdManager.AD_PAUSED="ad-paused",goog.exportProperty(shaka.ads.AdManager,"AD_PAUSED",shaka.ads.AdManager.AD_PAUSED),shaka.ads.AdManager.AD_RESUMED="ad-resumed",goog.exportProperty(shaka.ads.AdManager,"AD_RESUMED",shaka.ads.AdManager.AD_RESUMED),shaka.ads.AdManager.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",goog.exportProperty(shaka.ads.AdManager,"AD_SKIP_STATE_CHANGED",shaka.ads.AdManager.AD_SKIP_STATE_CHANGED),shaka.ads.AdManager.CUEPOINTS_CHANGED="ad-cue-points-changed",goog.exportProperty(shaka.ads.AdManager,"CUEPOINTS_CHANGED",shaka.ads.AdManager.CUEPOINTS_CHANGED),shaka.ads.AdManager.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",goog.exportProperty(shaka.ads.AdManager,"IMA_AD_MANAGER_LOADED",shaka.ads.AdManager.IMA_AD_MANAGER_LOADED),shaka.ads.AdManager.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",goog.exportProperty(shaka.ads.AdManager,"IMA_STREAM_MANAGER_LOADED",shaka.ads.AdManager.IMA_STREAM_MANAGER_LOADED),shaka.ads.AdManager.AD_CLICKED="ad-clicked",goog.exportProperty(shaka.ads.AdManager,"AD_CLICKED",shaka.ads.AdManager.AD_CLICKED),shaka.ads.AdManager.AD_PROGRESS="ad-progress",goog.exportProperty(shaka.ads.AdManager,"AD_PROGRESS",shaka.ads.AdManager.AD_PROGRESS),shaka.ads.AdManager.AD_BUFFERING="ad-buffering",goog.exportProperty(shaka.ads.AdManager,"AD_BUFFERING",shaka.ads.AdManager.AD_BUFFERING),shaka.ads.AdManager.AD_IMPRESSION="ad-impression",goog.exportProperty(shaka.ads.AdManager,"AD_IMPRESSION",shaka.ads.AdManager.AD_IMPRESSION),shaka.ads.AdManager.AD_DURATION_CHANGED="ad-duration-changed",goog.exportProperty(shaka.ads.AdManager,"AD_DURATION_CHANGED",shaka.ads.AdManager.AD_DURATION_CHANGED),shaka.ads.AdManager.AD_CLOSED="ad-closed",goog.exportProperty(shaka.ads.AdManager,"AD_CLOSED",shaka.ads.AdManager.AD_CLOSED),shaka.ads.AdManager.AD_LOADED="ad-loaded",goog.exportProperty(shaka.ads.AdManager,"AD_LOADED",shaka.ads.AdManager.AD_LOADED),shaka.ads.AdManager.ALL_ADS_COMPLETED="all-ads-completed",goog.exportProperty(shaka.ads.AdManager,"ALL_ADS_COMPLETED",shaka.ads.AdManager.ALL_ADS_COMPLETED),shaka.ads.AdManager.AD_LINEAR_CHANGED="ad-linear-changed",goog.exportProperty(shaka.ads.AdManager,"AD_LINEAR_CHANGED",shaka.ads.AdManager.AD_LINEAR_CHANGED),shaka.ads.AdManager.AD_METADATA="ad-metadata",goog.exportProperty(shaka.ads.AdManager,"AD_METADATA",shaka.ads.AdManager.AD_METADATA),shaka.ads.AdManager.AD_RECOVERABLE_ERROR="ad-recoverable-error",goog.exportProperty(shaka.ads.AdManager,"AD_RECOVERABLE_ERROR",shaka.ads.AdManager.AD_RECOVERABLE_ERROR),shaka.ads.AdManager.AD_ERROR="ad-error",goog.exportProperty(shaka.ads.AdManager,"AD_ERROR",shaka.ads.AdManager.AD_ERROR),shaka.ads.AdManager.AD_BREAK_READY="ad-break-ready",goog.exportProperty(shaka.ads.AdManager,"AD_BREAK_READY",shaka.ads.AdManager.AD_BREAK_READY),shaka.ads.AdManager.AD_INTERACTION="ad-interaction",goog.exportProperty(shaka.ads.AdManager,"AD_INTERACTION",shaka.ads.AdManager.AD_INTERACTION),shaka.Player.setAdManagerFactory((function(){return new shaka.ads.AdManager})),shaka.cast={},shaka.cast.CastUtils=function(){},shaka.cast.CastUtils.serialize=function(e){return JSON.stringify(e,(function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof shaka.util.FakeEvent){for(var r in e={},t){var n=t[r];n&&"object"==typeof n?"detail"==r&&(e[r]=n):r in Event||(e[r]=n)}return e}return t instanceof Error?shaka.cast.CastUtils.unpackError_(t):t instanceof TimeRanges?shaka.cast.CastUtils.unpackTimeRanges_(t):t instanceof Uint8Array?shaka.cast.CastUtils.unpackUint8Array_(t):"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t}}))},shaka.cast.CastUtils.deserialize=function(e){return JSON.parse(e,(function(e,t){return"NaN"==t?NaN:"-Infinity"==t?-1/0:"Infinity"==t?1/0:t&&"object"==typeof t&&"TimeRanges"==t.__type__?shaka.cast.CastUtils.simulateTimeRanges_(t):t&&"object"==typeof t&&"Uint8Array"==t.__type__?shaka.cast.CastUtils.makeUint8Array_(t):t&&"object"==typeof t&&"Error"==t.__type__?shaka.cast.CastUtils.makeError_(t):t}))},shaka.cast.CastUtils.unpackTimeRanges_=function(e){for(var t={__type__:"TimeRanges",length:e.length,start:[],end:[]},r=(e=$jscomp.makeIterator(shaka.media.TimeRangesUtils.getBufferedInfo(e))).next();!r.done;r=e.next()){var n=(r=r.value).end;t.start.push(r.start),t.end.push(n)}return t},shaka.cast.CastUtils.simulateTimeRanges_=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}},shaka.cast.CastUtils.unpackUint8Array_=function(e){return{__type__:"Uint8Array",entries:Array.from(e)}},shaka.cast.CastUtils.makeUint8Array_=function(e){return new Uint8Array(e.entries)},shaka.cast.CastUtils.unpackError_=function(e){var t,r=new Set(["name","message","stack"]);for(t in e)r.add(t);var n=$jscomp.makeIterator(Object.getOwnPropertyNames(e));for(t=n.next();!t.done;t=n.next())r.add(t.value);for(n={},t=(r=$jscomp.makeIterator(r)).next();!t.done;t=r.next())n[t=t.value]=e[t];return{__type__:"Error",contents:n}},shaka.cast.CastUtils.makeError_=function(e){e=e.contents;var t,r=Error(e.message);for(t in e)r[t]=e[t];return r},shaka.cast.CastUtils.VideoEvents="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),shaka.cast.CastUtils.VideoAttributes="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),shaka.cast.CastUtils.VideoInitStateAttributes=["loop","playbackRate"],shaka.cast.CastUtils.VideoVoidMethods=["pause","play"],shaka.cast.CastUtils.PlayerGetterMethods={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferFullness:1,getBufferedInfo:2,getExpiration:2,getKeyStatuses:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getImageTracks:2,getThumbnails:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,getLoadMode:10,getManifestType:10},shaka.cast.CastUtils.LargePlayerGetterMethods={getConfiguration:4,getStats:5,getTextTracks:2,getVariantTracks:2},shaka.cast.CastUtils.PlayerGetterMethodsThatRequireLive={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20,getSegmentAvailabilityDuration:20},shaka.cast.CastUtils.PlayerInitState=[["getConfiguration","configure"]],shaka.cast.CastUtils.PlayerInitAfterLoadState=[["isTextTrackVisible","setTextTrackVisibility"]],shaka.cast.CastUtils.PlayerVoidMethods="addChaptersTrack addTextTrackAsync addThumbnailsTrack cancelTrickPlay configure getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),shaka.cast.CastUtils.PlayerPromiseMethods=["attach","attachCanvas","detach","load","unload"],shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE="urn:x-cast:com.google.shaka.v2",shaka.cast.CastUtils.GENERIC_MESSAGE_NAMESPACE="urn:x-cast:com.google.cast.media",shaka.cast.CastSender=function(e,t,r,n,a,i,o){var s=this;this.receiverAppId_=e,this.androidReceiverCompatible_=o,this.statusChangeTimer_=new shaka.util.Timer(t),this.onFirstCastStateUpdate_=r,this.hasJoinedExistingSession_=!1,this.onRemoteEvent_=n,this.onResumeLocal_=a,this.onInitStateRequired_=i,this.isCasting_=this.apiReady_=!1,this.receiverName_="",this.appData_=null,this.onConnectionStatusChangedBound_=function(){return s.onConnectionStatusChanged_()},this.onMessageReceivedBound_=function(e,t){return s.onMessageReceived_(e,t)},this.cachedProperties_={video:{},player:{}},this.nextAsyncCallId_=0,this.asyncCallPromises_={},this.castPromise_=null,shaka.cast.CastSender.instances_.add(this)},shaka.cast.CastSender.prototype.destroy=function(){return shaka.cast.CastSender.instances_.delete(this),this.rejectAllPromises_(),shaka.cast.CastSender.session_&&this.removeListeners_(),this.statusChangeTimer_&&(this.statusChangeTimer_.stop(),this.statusChangeTimer_=null),this.onResumeLocal_=this.onRemoteEvent_=null,this.isCasting_=this.apiReady_=!1,this.onMessageReceivedBound_=this.onConnectionStatusChangedBound_=this.castPromise_=this.asyncCallPromises_=this.cachedProperties_=this.appData_=null,Promise.resolve()},shaka.cast.CastSender.prototype.apiReady=function(){return this.apiReady_},shaka.cast.CastSender.prototype.hasReceivers=function(){return shaka.cast.CastSender.hasReceivers_},shaka.cast.CastSender.prototype.isCasting=function(){return this.isCasting_},shaka.cast.CastSender.prototype.receiverName=function(){return this.receiverName_},shaka.cast.CastSender.prototype.hasRemoteProperties=function(){return 0!=Object.keys(this.cachedProperties_.video).length},shaka.cast.CastSender.prototype.init=function(){var e=shaka.cast.CastSender;if(this.receiverAppId_.length)if(window.chrome&&chrome.cast&&chrome.cast.isAvailable){this.apiReady_=!0,this.statusChangeTimer_.tickNow();var t=new chrome.cast.SessionRequest(this.receiverAppId_,[],null,this.androidReceiverCompatible_,null);t=new chrome.cast.ApiConfig(t,(function(t){return e.onExistingSessionJoined_(t)}),(function(t){return e.onReceiverStatusChanged_(t)}),"origin_scoped"),chrome.cast.initialize(t,(function(){shaka.log.debug("CastSender: init")}),(function(e){shaka.log.error("CastSender: init error",e)})),shaka.cast.CastSender.hasReceivers_&&this.statusChangeTimer_.tickAfter(shaka.cast.CastSender.STATUS_DELAY),(t=shaka.cast.CastSender.session_)&&t.status!=chrome.cast.SessionStatus.STOPPED?(shaka.log.debug("CastSender: re-using existing connection"),this.onExistingSessionJoined_(t)):shaka.cast.CastSender.session_=null}else window.__onGCastApiAvailable!==e.onGCastApiAvailable_&&(e.__onGCastApiAvailable_=window.__onGCastApiAvailable||null,window.__onGCastApiAvailable=e.onGCastApiAvailable_)},shaka.cast.CastSender.prototype.setAppData=function(e){this.appData_=e,this.isCasting_&&this.sendMessage_({type:"appData",appData:this.appData_})},shaka.cast.CastSender.prototype.cast=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(!e.apiReady_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.CAST,shaka.util.Error.Code.CAST_API_UNAVAILABLE);if(!shaka.cast.CastSender.hasReceivers_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.CAST,shaka.util.Error.Code.NO_CAST_RECEIVERS);if(e.isCasting_)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.CAST,shaka.util.Error.Code.ALREADY_CASTING);return e.castPromise_=new shaka.util.PublicPromise,chrome.cast.requestSession((function(t){return e.onSessionInitiated_(t)}),(function(t){return e.onConnectionError_(t)})),t.yield(e.castPromise_,0)}))},shaka.cast.CastSender.prototype.showDisconnectDialog=function(){var e=this;this.isCasting_&&chrome.cast.requestSession((function(t){return e.onSessionInitiated_(t)}),(function(t){return e.onConnectionError_(t)}))},shaka.cast.CastSender.prototype.forceDisconnect=function(){if(this.isCasting_){if(this.rejectAllPromises_(),shaka.cast.CastSender.session_){this.removeListeners_();try{shaka.cast.CastSender.session_.stop((function(){}),(function(){}))}catch(e){}shaka.cast.CastSender.session_=null}this.onConnectionStatusChanged_()}},shaka.cast.CastSender.prototype.get=function(e,t){var r=this;goog.asserts.assert("video"==e||"player"==e,"Unexpected target name");var n=shaka.cast.CastUtils;if("video"==e){if(n.VideoVoidMethods.includes(t))return function(){var n=$jscomp.getRestArguments.apply(0,arguments);return r.remoteCall_.apply(r,[e,t].concat($jscomp.arrayFromIterable(n)))}}else if("player"==e){if(n.PlayerGetterMethodsThatRequireLive[t]){var a=this.get("player","isLive")();if(goog.asserts.assert(a,t+" should be called on a live stream!"),!a)return function(){}}if(n.PlayerVoidMethods.includes(t))return function(){var n=$jscomp.getRestArguments.apply(0,arguments);return r.remoteCall_.apply(r,[e,t].concat($jscomp.arrayFromIterable(n)))};if(n.PlayerPromiseMethods.includes(t))return function(){var n=$jscomp.getRestArguments.apply(0,arguments);return r.remoteAsyncCall_.apply(r,[e,t].concat($jscomp.arrayFromIterable(n)))};if(n.PlayerGetterMethods[t]||n.LargePlayerGetterMethods[t])return function(){return r.propertyGetter_(e,t)}}return this.propertyGetter_(e,t)},shaka.cast.CastSender.prototype.set=function(e,t,r){goog.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.cachedProperties_[e][t]=r,this.sendMessage_({type:"set",targetName:e,property:t,value:r})},shaka.cast.CastSender.prototype.onSessionInitiated_=function(e){shaka.log.debug("CastSender: onSessionInitiated");var t=this.onInitStateRequired_();this.onSessionCreated_(e),this.sendMessage_({type:"init",initState:t,appData:this.appData_}),this.castPromise_.resolve()},shaka.cast.CastSender.prototype.onConnectionError_=function(e){var t=shaka.util.Error.Code.UNEXPECTED_CAST_ERROR;switch(e.code){case"cancel":t=shaka.util.Error.Code.CAST_CANCELED_BY_USER;break;case"timeout":t=shaka.util.Error.Code.CAST_CONNECTION_TIMED_OUT;break;case"receiver_unavailable":t=shaka.util.Error.Code.CAST_RECEIVER_APP_UNAVAILABLE}this.castPromise_.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.CAST,t,e))},shaka.cast.CastSender.prototype.propertyGetter_=function(e,t){return goog.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.cachedProperties_[e][t]},shaka.cast.CastSender.prototype.remoteCall_=function(e,t){var r=$jscomp.getRestArguments.apply(2,arguments);goog.asserts.assert("video"==e||"player"==e,"Unexpected target name"),this.sendMessage_({type:"call",targetName:e,methodName:t,args:r})},shaka.cast.CastSender.prototype.remoteAsyncCall_=function(e,t){var r=$jscomp.getRestArguments.apply(2,arguments);goog.asserts.assert("video"==e||"player"==e,"Unexpected target name");var n=new shaka.util.PublicPromise,a=this.nextAsyncCallId_.toString();this.nextAsyncCallId_++,this.asyncCallPromises_[a]=n;try{this.sendMessage_({type:"asyncCall",targetName:e,methodName:t,args:r,id:a})}catch(e){n.reject(e)}return n},shaka.cast.CastSender.onExistingSessionJoined_=function(e){for(var t=$jscomp.makeIterator(shaka.cast.CastSender.instances_),r=t.next();!r.done;r=t.next())r.value.onExistingSessionJoined_(e)},shaka.cast.CastSender.prototype.onExistingSessionJoined_=function(e){shaka.log.debug("CastSender: onExistingSessionJoined"),this.castPromise_=new shaka.util.PublicPromise,this.hasJoinedExistingSession_=!0,this.onSessionInitiated_(e)},shaka.cast.CastSender.onReceiverStatusChanged_=function(e){for(var t=$jscomp.makeIterator(shaka.cast.CastSender.instances_),r=t.next();!r.done;r=t.next())r.value.onReceiverStatusChanged_(e)},shaka.cast.CastSender.prototype.onReceiverStatusChanged_=function(e){shaka.log.debug("CastSender: receiver status",e),shaka.cast.CastSender.hasReceivers_="available"==e,this.statusChangeTimer_.tickNow()},shaka.cast.CastSender.prototype.onSessionCreated_=function(e){shaka.cast.CastSender.session_=e,e.addUpdateListener(this.onConnectionStatusChangedBound_),e.addMessageListener(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE,this.onMessageReceivedBound_),this.onConnectionStatusChanged_()},shaka.cast.CastSender.prototype.removeListeners_=function(){var e=shaka.cast.CastSender.session_;e.removeUpdateListener(this.onConnectionStatusChangedBound_),e.removeMessageListener(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE,this.onMessageReceivedBound_)},shaka.cast.CastSender.prototype.onConnectionStatusChanged_=function(){var e=!!shaka.cast.CastSender.session_&&"connected"==shaka.cast.CastSender.session_.status;if(shaka.log.debug("CastSender: connection status",e),this.isCasting_&&!e){for(var t in this.onResumeLocal_(),this.cachedProperties_)this.cachedProperties_[t]={};this.rejectAllPromises_()}this.receiverName_=(this.isCasting_=e)?shaka.cast.CastSender.session_.receiver.friendlyName:"",this.statusChangeTimer_.tickNow()},shaka.cast.CastSender.prototype.rejectAllPromises_=function(){for(var e in this.asyncCallPromises_){var t=this.asyncCallPromises_[e];delete this.asyncCallPromises_[e],t.reject(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.LOAD_INTERRUPTED))}},shaka.cast.CastSender.prototype.onMessageReceived_=function(e,t){switch(e=shaka.cast.CastUtils.deserialize(t),shaka.log.v2("CastSender: message",e),e.type){case"event":var r=e.targetName,n=shaka.util.FakeEvent.fromRealEvent(e.event);this.onRemoteEvent_(r,n);break;case"update":for(n in r=e.update)for(var a in e=this.cachedProperties_[n]||{},r[n])e[a]=r[n][a];this.hasJoinedExistingSession_&&(this.onFirstCastStateUpdate_(),this.hasJoinedExistingSession_=!1);break;case"asyncComplete":if(n=e.id,a=e.error,e=this.asyncCallPromises_[n],delete this.asyncCallPromises_[n],goog.asserts.assert(e,"Unexpected async id"),e)if(a){for(r in n=new shaka.util.Error(a.severity,a.category,a.code),a)n[r]=a[r];e.reject(n)}else e.resolve()}},shaka.cast.CastSender.prototype.sendMessage_=function(e){e=shaka.cast.CastUtils.serialize(e);var t=shaka.cast.CastSender.session_;try{t.sendMessage(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE,e,(function(){}),shaka.log.error)}catch(r){throw shaka.log.error("Cast session sendMessage threw",r),e=new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.CAST,shaka.util.Error.Code.CAST_CONNECTION_TIMED_OUT,r),t=new shaka.util.FakeEvent("error",(new Map).set("detail",e)),this.onRemoteEvent_("player",t),this.forceDisconnect(),e}},shaka.cast.CastSender.STATUS_DELAY=.02,shaka.cast.CastSender.hasReceivers_=!1,shaka.cast.CastSender.session_=null,shaka.cast.CastSender.__onGCastApiAvailable_=null,shaka.cast.CastSender.instances_=new Set,shaka.cast.CastSender.onSdkLoaded_=function(e){if(e)for(var t=(e=$jscomp.makeIterator(shaka.cast.CastSender.instances_)).next();!t.done;t=e.next())t.value.init()},shaka.cast.CastSender.onGCastApiAvailable_=function(e){shaka.cast.CastSender.__onGCastApiAvailable_?window.__onGCastApiAvailable=shaka.cast.CastSender.__onGCastApiAvailable_:delete window.__onGCastApiAvailable,shaka.cast.CastSender.__onGCastApiAvailable_=null,shaka.cast.CastSender.onSdkLoaded_(e),"function"==typeof window.__onGCastApiAvailable&&window.__onGCastApiAvailable(e)},shaka.cast.CastProxy=function(e,t,r,n){n=void 0!==n&&n,shaka.util.FakeEventTarget.call(this);var a=this;this.localVideo_=e,this.localPlayer_=t,this.eventManager_=this.playerEventTarget_=this.videoEventTarget_=this.playerProxy_=this.videoProxy_=null,this.receiverAppId_=r,this.androidReceiverCompatible_=n,this.compiledToExternNames_=new Map,this.sender_=new shaka.cast.CastSender(r,(function(){return a.onCastStatusChanged_()}),(function(){return a.onFirstCastStateUpdate_()}),(function(e,t){return a.onRemoteEvent_(e,t)}),(function(){return a.onResumeLocal_()}),(function(){return a.getInitState_()}),n),this.init_()},$jscomp.inherits(shaka.cast.CastProxy,shaka.util.FakeEventTarget),shaka.cast.CastProxy.prototype.destroy=function(e){return e&&this.sender_.forceDisconnect(),this.eventManager_&&(this.eventManager_.release(),this.eventManager_=null),e=[],this.localPlayer_&&(e.push(this.localPlayer_.destroy()),this.localPlayer_=null),this.sender_&&(e.push(this.sender_.destroy()),this.sender_=null),this.playerProxy_=this.videoProxy_=this.localVideo_=null,shaka.util.FakeEventTarget.prototype.release.call(this),Promise.all(e)},shaka.cast.CastProxy.prototype.getVideo=function(){return this.videoProxy_},shaka.cast.CastProxy.prototype.getPlayer=function(){return this.playerProxy_},shaka.cast.CastProxy.prototype.canCast=function(){return this.sender_.apiReady()&&this.sender_.hasReceivers()},shaka.cast.CastProxy.prototype.isCasting=function(){return this.sender_.isCasting()},shaka.cast.CastProxy.prototype.receiverName=function(){return this.sender_.receiverName()},shaka.cast.CastProxy.prototype.cast=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?t.yield(e.sender_.cast(),2):e.localPlayer_?t.yield(e.localPlayer_.unload(),0):t.return()}))},shaka.cast.CastProxy.prototype.setAppData=function(e){this.sender_.setAppData(e)},shaka.cast.CastProxy.prototype.suggestDisconnect=function(){this.sender_.showDisconnectDialog()},shaka.cast.CastProxy.prototype.forceDisconnect=function(){this.sender_.forceDisconnect()},shaka.cast.CastProxy.prototype.changeReceiverId=function(e,t){t=void 0!==t&&t;var r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return e==r.receiverAppId_&&t==r.androidReceiverCompatible_?n.return():(r.receiverAppId_=e,r.androidReceiverCompatible_=t,r.sender_.forceDisconnect(),n.yield(r.sender_.destroy(),2));r.sender_=null,r.sender_=new shaka.cast.CastSender(e,(function(){return r.onCastStatusChanged_()}),(function(){return r.onFirstCastStateUpdate_()}),(function(e,t){return r.onRemoteEvent_(e,t)}),(function(){return r.onResumeLocal_()}),(function(){return r.getInitState_()}),t),r.sender_.init(),n.jumpToEnd()}))},shaka.cast.CastProxy.prototype.init_=function(){var e=this;this.sender_.init(),this.eventManager_=new shaka.util.EventManager;for(var t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoEvents),r=t.next();!r.done;r=t.next())this.eventManager_.listen(this.localVideo_,r.value,(function(t){return e.videoProxyLocalEvent_(t)}));for(var n in shaka.util.FakeEvent.EventName)this.eventManager_.listen(this.localPlayer_,shaka.util.FakeEvent.EventName[n],(function(t){return e.playerProxyLocalEvent_(t)}));for(var a in this.videoProxy_={},t={},this.localVideo_)t.$jscomp$loop$prop$k$891=a,Object.defineProperty(this.videoProxy_,t.$jscomp$loop$prop$k$891,{configurable:!1,enumerable:!0,get:function(t){return function(){return e.videoProxyGet_(t.$jscomp$loop$prop$k$891)}}(t),set:function(t){return function(r){e.videoProxySet_(t.$jscomp$loop$prop$k$891,r)}}(t)}),t={$jscomp$loop$prop$k$891:t.$jscomp$loop$prop$k$891};this.playerProxy_={},this.iterateOverPlayerMethods_((function(t,r){goog.asserts.assert(e.playerProxy_,"Must have player proxy!"),Object.defineProperty(e.playerProxy_,t,{configurable:!1,enumerable:!0,get:function(){return e.playerProxyGet_(t)}})})),COMPILED&&this.mapCompiledToUncompiledPlayerMethodNames_(),this.videoEventTarget_=new shaka.util.FakeEventTarget,this.videoEventTarget_.dispatchTarget=this.videoProxy_,this.playerEventTarget_=new shaka.util.FakeEventTarget,this.playerEventTarget_.dispatchTarget=this.playerProxy_},shaka.cast.CastProxy.prototype.mapCompiledToUncompiledPlayerMethodNames_=function(){var e=this,t=new Map;this.iterateOverPlayerMethods_((function(r,n){t.has(n)?(n=t.get(n),r.length<n.length?e.compiledToExternNames_.set(r,n):e.compiledToExternNames_.set(n,r)):t.set(n,r)}))},shaka.cast.CastProxy.prototype.iterateOverPlayerMethods_=function(e){function t(e){return"constructor"!=e&&"function"==typeof r[e]&&!n.has(e)}goog.asserts.assert(this.localPlayer_,"Must have player!");var r=this.localPlayer_,n=new Set;for(a in r)t(a)&&(n.add(a),e(a,r[a]));for(var a=Object.getPrototypeOf(r),i=Object.getPrototypeOf({});a&&a!=i;){for(var o=$jscomp.makeIterator(Object.getOwnPropertyNames(a)),s=o.next();!s.done;s=o.next())t(s=s.value)&&(n.add(s),e(s,r[s]));a=Object.getPrototypeOf(a)}},shaka.cast.CastProxy.prototype.getInitState_=function(){var e={video:{},player:{},playerAfterLoad:{},manifest:this.localPlayer_.getAssetUri(),startTime:null};this.localVideo_.pause();for(var t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoInitStateAttributes),r=t.next();!r.done;r=t.next())r=r.value,e.video[r]=this.localVideo_[r];for(this.localVideo_.ended||(e.startTime=this.localVideo_.currentTime),r=(t=$jscomp.makeIterator(shaka.cast.CastUtils.PlayerInitState)).next();!r.done;r=t.next()){var n=r.value;r=n[1],n=this.localPlayer_[n[0]](),e.player[r]=n}for(r=(t=$jscomp.makeIterator(shaka.cast.CastUtils.PlayerInitAfterLoadState)).next();!r.done;r=t.next())r=(n=r.value)[1],n=this.localPlayer_[n[0]](),e.playerAfterLoad[r]=n;return e},shaka.cast.CastProxy.prototype.onCastStatusChanged_=function(){var e=new shaka.util.FakeEvent("caststatuschanged");this.dispatchEvent(e)},shaka.cast.CastProxy.prototype.onFirstCastStateUpdate_=function(){var e=new shaka.util.FakeEvent(this.videoProxy_.paused?"pause":"play");this.videoEventTarget_.dispatchEvent(e)},shaka.cast.CastProxy.prototype.onResumeLocal_=function(){for(var e=this,t=$jscomp.makeIterator(shaka.cast.CastUtils.PlayerInitState),r=t.next();!r.done;r=t.next()){var n=r.value;r=n[1],n=this.sender_.get("player",n[0])(),this.localPlayer_[r](n)}var a=this.sender_.get("player","getAssetUri")();n=this.sender_.get("video","ended"),t=Promise.resolve();var i,o=this.localVideo_.autoplay;r=null,n||(r=this.sender_.get("video","currentTime")),(n=this.sender_.get("player","getTextTracks")())&&n.length&&(i=n.find((function(e){return e.active})));var s=this.sender_.get("player","isTextTrackVisible")();a&&(this.localVideo_.autoplay=!1,t=this.localPlayer_.load(a,r));var l={};for(n=(r=$jscomp.makeIterator(shaka.cast.CastUtils.VideoInitStateAttributes)).next();!n.done;n=r.next())n=n.value,l[n]=this.sender_.get("video",n);t.then((function(){if(e.localVideo_){for(var t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoInitStateAttributes),r=t.next();!r.done;r=t.next())r=r.value,e.localVideo_[r]=l[r];for(r=(t=$jscomp.makeIterator(shaka.cast.CastUtils.PlayerInitAfterLoadState)).next();!r.done;r=t.next()){var n=r.value;r=n[1],n=e.sender_.get("player",n[0])(),e.localPlayer_[r](n)}e.localPlayer_.setTextTrackVisibility(s),i&&e.localPlayer_.selectTextLanguage(i.language,i.roles,i.forced),e.localVideo_.autoplay=o,a&&e.localVideo_.play()}}),(function(t){goog.asserts.assert(t instanceof shaka.util.Error,"Wrong error type!");var r=shaka.util.FakeEvent.EventName.Error;t=(new Map).set("detail",t),r=new shaka.util.FakeEvent(r,t),e.localPlayer_.dispatchEvent(r)}))},shaka.cast.CastProxy.prototype.videoProxyGet_=function(e){var t=this;if("addEventListener"==e)return function(e,r,n){return t.videoEventTarget_.addEventListener(e,r,n)};if("removeEventListener"==e)return function(e,r,n){return t.videoEventTarget_.removeEventListener(e,r,n)};if(this.sender_.isCasting()&&!this.sender_.hasRemoteProperties()){var r=this.localVideo_[e];if("function"!=typeof r)return r}return this.sender_.isCasting()?this.sender_.get("video",e):("function"==typeof(e=this.localVideo_[e])&&(e=e.bind(this.localVideo_)),e)},shaka.cast.CastProxy.prototype.videoProxySet_=function(e,t){this.sender_.isCasting()?this.sender_.set("video",e,t):this.localVideo_[e]=t},shaka.cast.CastProxy.prototype.videoProxyLocalEvent_=function(e){this.sender_.isCasting()||(e=shaka.util.FakeEvent.fromRealEvent(e),this.videoEventTarget_.dispatchEvent(e))},shaka.cast.CastProxy.prototype.playerProxyGet_=function(e){var t=this;if(this.compiledToExternNames_.has(e)&&(e=this.compiledToExternNames_.get(e)),"addEventListener"==e)return function(e,r,n){return t.playerEventTarget_.addEventListener(e,r,n)};if("removeEventListener"==e)return function(e,r,n){return t.playerEventTarget_.removeEventListener(e,r,n)};if("getMediaElement"==e)return function(){return t.videoProxy_};if("getSharedConfiguration"==e)return shaka.log.warning("Can't share configuration across a network. Returning copy."),this.sender_.get("player","getConfiguration");if("getNetworkingEngine"==e)return this.sender_.isCasting()&&shaka.log.warning("NOTE: getNetworkingEngine() is always local!"),function(){return t.localPlayer_.getNetworkingEngine()};if("getDrmEngine"==e)return this.sender_.isCasting()&&shaka.log.warning("NOTE: getDrmEngine() is always local!"),function(){return t.localPlayer_.getDrmEngine()};if("getAdManager"==e)return this.sender_.isCasting()&&shaka.log.warning("NOTE: getAdManager() is always local!"),function(){return t.localPlayer_.getAdManager()};if("setVideoContainer"==e)return this.sender_.isCasting()&&shaka.log.warning("NOTE: setVideoContainer() is always local!"),function(e){return t.localPlayer_.setVideoContainer(e)};if(this.sender_.isCasting()){if("getManifest"==e||"drmInfo"==e)return function(){return shaka.log.alwaysWarn(e+"() does not work while casting!"),null};if("attach"==e||"detach"==e)return function(){return shaka.log.alwaysWarn(e+"() does not work while casting!"),Promise.resolve()}}if(this.sender_.isCasting()&&!this.sender_.hasRemoteProperties()&&(shaka.cast.CastUtils.PlayerGetterMethods[e]||shaka.cast.CastUtils.LargePlayerGetterMethods[e])){var r=this.localPlayer_[e];return goog.asserts.assert("function"==typeof r,"only methods on Player"),r.bind(this.localPlayer_)}return this.sender_.isCasting()?this.sender_.get("player",e):(r=this.localPlayer_[e],goog.asserts.assert("function"==typeof r,"only methods on Player"),r.bind(this.localPlayer_))},shaka.cast.CastProxy.prototype.playerProxyLocalEvent_=function(e){this.sender_.isCasting()||this.playerEventTarget_.dispatchEvent(e)},shaka.cast.CastProxy.prototype.onRemoteEvent_=function(e,t){goog.asserts.assert(this.sender_.isCasting(),"Should only receive remote events while casting"),this.sender_.isCasting()&&("video"==e?this.videoEventTarget_.dispatchEvent(t):"player"==e&&this.playerEventTarget_.dispatchEvent(t))},goog.exportSymbol("shaka.cast.CastProxy",shaka.cast.CastProxy),goog.exportProperty(shaka.cast.CastProxy.prototype,"changeReceiverId",shaka.cast.CastProxy.prototype.changeReceiverId),goog.exportProperty(shaka.cast.CastProxy.prototype,"forceDisconnect",shaka.cast.CastProxy.prototype.forceDisconnect),goog.exportProperty(shaka.cast.CastProxy.prototype,"suggestDisconnect",shaka.cast.CastProxy.prototype.suggestDisconnect),goog.exportProperty(shaka.cast.CastProxy.prototype,"setAppData",shaka.cast.CastProxy.prototype.setAppData),goog.exportProperty(shaka.cast.CastProxy.prototype,"cast",shaka.cast.CastProxy.prototype.cast),goog.exportProperty(shaka.cast.CastProxy.prototype,"receiverName",shaka.cast.CastProxy.prototype.receiverName),goog.exportProperty(shaka.cast.CastProxy.prototype,"isCasting",shaka.cast.CastProxy.prototype.isCasting),goog.exportProperty(shaka.cast.CastProxy.prototype,"canCast",shaka.cast.CastProxy.prototype.canCast),goog.exportProperty(shaka.cast.CastProxy.prototype,"getPlayer",shaka.cast.CastProxy.prototype.getPlayer),goog.exportProperty(shaka.cast.CastProxy.prototype,"getVideo",shaka.cast.CastProxy.prototype.getVideo),goog.exportProperty(shaka.cast.CastProxy.prototype,"destroy",shaka.cast.CastProxy.prototype.destroy),shaka.cast.CastReceiver=function(e,t,r,n){shaka.util.FakeEventTarget.call(this);var a=this;this.video_=e,this.player_=t,this.eventManager_=new shaka.util.EventManager,this.targets_={video:e,player:t},this.appDataCallback_=r||function(){},this.contentIdCallback_=n||function(e){return e},this.metadata_=null,this.isConnected_=!1,this.isIdle_=!0,this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1,this.initialStatusUpdatePending_=!0,this.genericBus_=this.shakaBus_=null,this.pollTimer_=new shaka.util.Timer((function(){a.pollAttributes_()})),this.init_()},$jscomp.inherits(shaka.cast.CastReceiver,shaka.util.FakeEventTarget),shaka.cast.CastReceiver.prototype.isConnected=function(){return this.isConnected_},shaka.cast.CastReceiver.prototype.isIdle=function(){return this.isIdle_},shaka.cast.CastReceiver.prototype.setContentMetadata=function(e){this.metadata_=e},shaka.cast.CastReceiver.prototype.clearContentMetadata=function(){this.metadata_=null},shaka.cast.CastReceiver.prototype.setContentTitle=function(e){this.metadata_||(this.metadata_={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.metadata_.title=e},shaka.cast.CastReceiver.prototype.setContentImage=function(e){this.metadata_||(this.metadata_={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.metadata_.images=[{url:e}]},shaka.cast.CastReceiver.prototype.setContentArtist=function(e){this.metadata_||(this.metadata_={}),this.metadata_.artist=e,this.metadata_.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},shaka.cast.CastReceiver.prototype.destroy=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return t.eventManager_&&(t.eventManager_.release(),t.eventManager_=null),e=[],t.player_&&(e.push(t.player_.destroy()),t.player_=null),t.pollTimer_&&(t.pollTimer_.stop(),t.pollTimer_=null),t.video_=null,t.targets_=null,t.appDataCallback_=null,t.isConnected_=!1,t.isIdle_=!0,t.shakaBus_=null,t.genericBus_=null,shaka.util.FakeEventTarget.prototype.release.call(t),r.yield(Promise.all(e),2);cast.receiver.CastReceiverManager.getInstance().stop(),r.jumpToEnd()}))},shaka.cast.CastReceiver.prototype.init_=function(){var e=this,t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return e.onSendersChanged_()},t.onSenderDisconnected=function(){return e.onSendersChanged_()},t.onSystemVolumeChanged=function(){return e.fakeVolumeChangeEvent_()},this.genericBus_=t.getCastMessageBus(shaka.cast.CastUtils.GENERIC_MESSAGE_NAMESPACE),this.genericBus_.onMessage=function(t){return e.onGenericMessage_(t)},this.shakaBus_=t.getCastMessageBus(shaka.cast.CastUtils.SHAKA_MESSAGE_NAMESPACE),this.shakaBus_.onMessage=function(t){return e.onShakaMessage_(t)},goog.DEBUG?shaka.util.Platform.isChromecast()&&t.start():t.start();for(var r=(t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoEvents)).next();!r.done;r=t.next())this.eventManager_.listen(this.video_,r.value,(function(t){return e.proxyEvent_("video",t)}));for(var n in shaka.util.FakeEvent.EventName)this.eventManager_.listen(this.player_,shaka.util.FakeEvent.EventName[n],(function(t){return e.proxyEvent_("player",t)}));this.eventManager_.listen(this.video_,"loadeddata",(function(){e.startUpdatingUpdateNumber_=!0})),this.eventManager_.listen(this.player_,"loading",(function(){e.isIdle_=!1,e.onCastStatusChanged_()})),this.eventManager_.listen(this.video_,"playing",(function(){e.isIdle_=!1,e.onCastStatusChanged_()})),this.eventManager_.listen(this.video_,"pause",(function(){e.onCastStatusChanged_()})),this.eventManager_.listen(this.player_,"unloading",(function(){e.isIdle_=!0,e.onCastStatusChanged_()})),this.eventManager_.listen(this.video_,"ended",(function(){new shaka.util.Timer((function(){e.video_&&e.video_.ended&&(e.isIdle_=!0,e.onCastStatusChanged_())})).tickAfter(shaka.cast.CastReceiver.IDLE_INTERVAL)}))},shaka.cast.CastReceiver.prototype.onSendersChanged_=function(){this.updateNumber_=0,this.initialStatusUpdatePending_=!0,this.isConnected_=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,this.onCastStatusChanged_()},shaka.cast.CastReceiver.prototype.onCastStatusChanged_=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?r.yield(Promise.resolve(),2):t.player_?(e=new shaka.util.FakeEvent("caststatuschanged"),t.dispatchEvent(e),t.maybeSendMediaInfoMessage_()||t.sendMediaStatus_(),void r.jumpToEnd()):r.return()}))},shaka.cast.CastReceiver.prototype.initState_=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(f){switch(f.nextAddress){case 1:for(r in e.player)n=e.player[r],h.player_[r](n);return h.appDataCallback_(t),a=h.video_.autoplay,e.manifest?(h.video_.autoplay=!1,f.setCatchFinallyBlocks(5),f.yield(h.player_.load(e.manifest,e.startTime),7)):f.yield(Promise.resolve(),3);case 7:f.leaveTryBlock(3);break;case 5:return i=f.enterCatchBlock(),goog.asserts.assert(i instanceof shaka.util.Error,"Wrong error type! Error: "+i),o=shaka.util.FakeEvent.EventName.Error,s=(new Map).set("detail",i),l=new shaka.util.FakeEvent(o,s),h.player_&&h.player_.dispatchEvent(l),f.return();case 3:if(!h.player_)return f.return();for(u in e.video)c=e.video[u],h.video_[u]=c;for(d in e.playerAfterLoad)p=e.playerAfterLoad[d],h.player_[d](p);h.video_.autoplay=a,e.manifest&&(h.video_.play(),h.sendMediaStatus_()),f.jumpToEnd()}}))},shaka.cast.CastReceiver.prototype.proxyEvent_=function(e,t){this.player_&&(this.pollAttributes_(),this.sendMessage_({type:"event",targetName:e,event:t},this.shakaBus_))},shaka.cast.CastReceiver.prototype.pollAttributes_=function(){this.pollTimer_.tickAfter(shaka.cast.CastReceiver.POLL_INTERVAL);for(var e={video:{},player:{}},t=$jscomp.makeIterator(shaka.cast.CastUtils.VideoAttributes),r=t.next();!r.done;r=t.next())r=r.value,e.video[r]=this.video_[r];if(this.player_.isLive())for(var n in t=shaka.cast.CastUtils.PlayerGetterMethodsThatRequireLive)0==this.updateNumber_%t[n]&&(e.player[n]=this.player_[n]());for(var a in shaka.cast.CastUtils.PlayerGetterMethods)0==this.updateNumber_%shaka.cast.CastUtils.PlayerGetterMethods[a]&&(e.player[a]=this.player_[a]());for(var i in(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(e.video.volume=n.level,e.video.muted=n.muted),this.sendMessage_({type:"update",update:e},this.shakaBus_),shaka.cast.CastUtils.LargePlayerGetterMethods)0==this.updateNumber_%shaka.cast.CastUtils.LargePlayerGetterMethods[i]&&((e={player:{}}).player[i]=this.player_[i](),this.sendMessage_({type:"update",update:e},this.shakaBus_));this.startUpdatingUpdateNumber_&&(this.updateNumber_+=1),this.maybeSendMediaInfoMessage_()};shaka.cast.CastReceiver.prototype.maybeSendMediaInfoMessage_=function(){return!(!this.initialStatusUpdatePending_||!this.video_.duration&&!this.player_.isLive())&&(this.sendMediaInfoMessage_(),this.initialStatusUpdatePending_=!1,!0)},shaka.cast.CastReceiver.prototype.sendMediaInfoMessage_=function(e){e=void 0===e?0:e;var t={contentId:this.player_.getAssetUri(),streamType:this.player_.isLive()?"LIVE":"BUFFERED",contentType:""};this.player_.isLive()||(t.duration=this.video_.duration),this.metadata_&&(t.metadata=this.metadata_),this.sendMediaStatus_(e,t)},shaka.cast.CastReceiver.prototype.fakeVolumeChangeEvent_=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();goog.asserts.assert(e,"System volume should not be null!"),e&&this.sendMessage_({type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.shakaBus_),this.sendMessage_({type:"event",targetName:"video",event:{type:"volumechange"}},this.shakaBus_)},shaka.cast.CastReceiver.prototype.onShakaMessage_=function(e){var t=this,r=shaka.cast.CastUtils.deserialize(e.data);switch(shaka.log.debug("CastReceiver: message",r),r.type){case"init":this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1,this.initialStatusUpdatePending_=!0,this.initState_(r.initState,r.appData),this.pollAttributes_();break;case"appData":this.appDataCallback_(r.appData);break;case"set":var n=r.targetName,a=r.property;if(r=r.value,"video"==n){if(e=cast.receiver.CastReceiverManager.getInstance(),"volume"==a){e.setSystemVolumeLevel(r);break}if("muted"==a){e.setSystemVolumeMuted(r);break}}this.targets_[n][a]=r;break;case"call":(n=this.targets_[r.targetName])[r.methodName].apply(n,r.args);break;case"asyncCall":n=r.targetName,a=r.methodName,"player"==n&&"load"==a&&(this.updateNumber_=0,this.startUpdatingUpdateNumber_=!1);var i=r.id,o=e.senderId;r=(e=this.targets_[n])[a].apply(e,r.args),"player"==n&&"load"==a&&(r=r.then((function(){t.initialStatusUpdatePending_=!0}))),r.then((function(){return t.sendAsyncComplete_(o,i,null)}),(function(e){return t.sendAsyncComplete_(o,i,e)}))}},shaka.cast.CastReceiver.prototype.onGenericMessage_=function(e){var t=this,r=shaka.cast.CastUtils.deserialize(e.data);switch(shaka.log.debug("CastReceiver: message",r),r.type){case"PLAY":this.video_.play(),this.sendMediaStatus_();break;case"PAUSE":this.video_.pause(),this.sendMediaStatus_();break;case"SEEK":e=r.currentTime;var n=r.resumeState;null!=e&&(this.video_.currentTime=Number(e)),n&&"PLAYBACK_START"==n?(this.video_.play(),this.sendMediaStatus_()):n&&"PLAYBACK_PAUSE"==n&&(this.video_.pause(),this.sendMediaStatus_());break;case"STOP":this.player_.unload().then((function(){t.player_&&t.sendMediaStatus_()}));break;case"GET_STATUS":this.sendMediaInfoMessage_(Number(r.requestId));break;case"VOLUME":e=(n=r.volume).level,n=n.muted;var a=this.video_.volume,i=this.video_.muted;null!=e&&(this.video_.volume=Number(e)),null!=n&&(this.video_.muted=n),a==this.video_.volume&&i==this.video_.muted||this.sendMediaStatus_();break;case"LOAD":this.updateNumber_=0,this.initialStatusUpdatePending_=this.startUpdatingUpdateNumber_=!1,e=r.media,n=r.currentTime,a=this.contentIdCallback_(e.contentId),i=r.autoplay||!0,this.appDataCallback_(e.customData),i&&(this.video_.autoplay=!0),this.player_.load(a,n).then((function(){t.player_&&t.sendMediaInfoMessage_()})).catch((function(e){goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!");var n="LOAD_FAILED";e.category==shaka.util.Error.Category.PLAYER&&e.code==shaka.util.Error.Code.LOAD_INTERRUPTED&&(n="LOAD_CANCELLED"),t.sendMessage_({requestId:Number(r.requestId),type:n},t.genericBus_)}));break;default:shaka.log.warning("Unrecognized message type from the generic Chromecast controller!",r.type),this.sendMessage_({requestId:Number(r.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.genericBus_)}},shaka.cast.CastReceiver.prototype.sendAsyncComplete_=function(e,t,r){this.player_&&this.sendMessage_({type:"asyncComplete",id:t,error:r},this.shakaBus_,e)},shaka.cast.CastReceiver.prototype.sendMessage_=function(e,t,r){this.isConnected_&&(e=shaka.cast.CastUtils.serialize(e),r?t.getCastChannel(r).send(e):t.broadcast(e))},shaka.cast.CastReceiver.prototype.getPlayState_=function(){var e=shaka.cast.CastReceiver.PLAY_STATE;return this.isIdle_?e.IDLE:this.player_.isBuffering()?e.BUFFERING:this.video_.paused?e.PAUSED:e.PLAYING},shaka.cast.CastReceiver.prototype.sendMediaStatus_=function(e,t){e=void 0===e?0:e,t=void 0===t?null:t;var r={mediaSessionId:0,playbackRate:this.video_.playbackRate,playerState:this.getPlayState_(),currentTime:this.video_.currentTime,supportedMediaCommands:63,volume:{level:this.video_.volume,muted:this.video_.muted}};t&&(r.media=t),this.sendMessage_({requestId:e,type:"MEDIA_STATUS",status:[r]},this.genericBus_)},goog.exportSymbol("shaka.cast.CastReceiver",shaka.cast.CastReceiver),goog.exportProperty(shaka.cast.CastReceiver.prototype,"destroy",shaka.cast.CastReceiver.prototype.destroy),goog.exportProperty(shaka.cast.CastReceiver.prototype,"setContentArtist",shaka.cast.CastReceiver.prototype.setContentArtist),goog.exportProperty(shaka.cast.CastReceiver.prototype,"setContentImage",shaka.cast.CastReceiver.prototype.setContentImage),goog.exportProperty(shaka.cast.CastReceiver.prototype,"setContentTitle",shaka.cast.CastReceiver.prototype.setContentTitle),goog.exportProperty(shaka.cast.CastReceiver.prototype,"clearContentMetadata",shaka.cast.CastReceiver.prototype.clearContentMetadata),goog.exportProperty(shaka.cast.CastReceiver.prototype,"setContentMetadata",shaka.cast.CastReceiver.prototype.setContentMetadata),goog.exportProperty(shaka.cast.CastReceiver.prototype,"isIdle",shaka.cast.CastReceiver.prototype.isIdle),goog.exportProperty(shaka.cast.CastReceiver.prototype,"isConnected",shaka.cast.CastReceiver.prototype.isConnected),shaka.cast.CastReceiver.POLL_INTERVAL=.5,shaka.cast.CastReceiver.IDLE_INTERVAL=5,shaka.cast.CastReceiver.PLAY_STATE={IDLE:"IDLE",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED"},shaka.cea.CeaUtils=function(){},shaka.cea.CeaUtils.getParsedCaption=function(e,t,r,n,a){if(n>=a)return null;for(var i=-1,o=-1,s=0;s<r.length;s++)if(r[s].some((function(e){return null!=e&&""!=e.getChar().trim()}))){i=s;break}for(s=r.length-1;0<=s;s--)if(r[s].some((function(e){return null!=e&&""!=e.getChar().trim()}))){o=s;break}if(-1===i||-1===o)return null;for(var l=s=!1,u=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,c=shaka.cea.CeaUtils.DEFAULT_BG_COLOR,d=shaka.cea.CeaUtils.createStyledCue(n,a,s,l,u,c);i<=o;i++){for(var p=r[i],h=-1,f=-1,m=0;m<p.length;m++)if(null!=p[m]&&""!==p[m].getChar().trim()){h=m;break}for(m=p.length-1;0<=m;m--)if(null!=p[m]&&""!==p[m].getChar().trim()){f=m;break}if(-1===h||-1===f)p=shaka.cea.CeaUtils.createLineBreakCue(n,a),e.nestedCues.push(p);else{for(;h<=f;h++)if(m=p[h]){var g=m.isUnderlined(),y=m.isItalicized(),v=m.getTextColor(),_=m.getBackgroundColor();g==s&&y==l&&v==u&&_==c||(d.payload&&e.nestedCues.push(d),d=shaka.cea.CeaUtils.createStyledCue(n,a,g,y,v,_),s=g,l=y,u=v,c=_),d.payload+=m.getChar()}else d.payload+=" ";d.payload&&e.nestedCues.push(d),i!==o&&(d=shaka.cea.CeaUtils.createLineBreakCue(n,a),e.nestedCues.push(d)),d=shaka.cea.CeaUtils.createStyledCue(n,a,s,l,u,c)}}return e.nestedCues.length?{cue:e,stream:t}:null},shaka.cea.CeaUtils.createStyledCue=function(e,t,r,n,a,i){return e=new shaka.text.Cue(e,t,""),r&&e.textDecoration.push(shaka.text.Cue.textDecoration.UNDERLINE),n&&(e.fontStyle=shaka.text.Cue.fontStyle.ITALIC),e.color=a,e.backgroundColor=i,e},shaka.cea.CeaUtils.createLineBreakCue=function(e,t){return(e=new shaka.text.Cue(e,t,"")).lineBreak=!0,e},shaka.cea.CeaUtils.StyledChar=function(e,t,r,n,a){this.character_=e,this.underline_=t,this.italics_=r,this.backgroundColor_=n,this.textColor_=a},shaka.cea.CeaUtils.StyledChar.prototype.getChar=function(){return this.character_},shaka.cea.CeaUtils.StyledChar.prototype.isUnderlined=function(){return this.underline_},shaka.cea.CeaUtils.StyledChar.prototype.isItalicized=function(){return this.italics_},shaka.cea.CeaUtils.StyledChar.prototype.getBackgroundColor=function(){return this.backgroundColor_},shaka.cea.CeaUtils.StyledChar.prototype.getTextColor=function(){return this.textColor_},shaka.cea.CeaUtils.DEFAULT_BG_COLOR="black",shaka.cea.CeaUtils.DEFAULT_TXT_COLOR="white",shaka.cea.CeaUtils.H264_NALU_TYPE_SEI=6,shaka.cea.CeaUtils.H265_PREFIX_NALU_TYPE_SEI=39,shaka.cea.CeaUtils.H265_SUFFIX_NALU_TYPE_SEI=40,shaka.cea.CeaUtils.DEFAULT_TIMESCALE_VALUE=9e4,shaka.cea.Cea608Memory=function(e,t){this.rows_=[],this.row_=1,this.scrollRows_=0,this.fieldNum_=e,this.channelNum_=t,this.italics_=this.underline_=!1,this.textColor_=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,this.backgroundColor_=shaka.cea.CeaUtils.DEFAULT_BG_COLOR,this.reset()},shaka.cea.Cea608Memory.prototype.forceEmit=function(e,t){var r="CC"+(1+(this.fieldNum_<<1|this.channelNum_)),n=new shaka.text.Cue(e,t,"");n.lineInterpretation=shaka.text.Cue.lineInterpretation.PERCENTAGE;var a=shaka.cea.Cea608Memory.ROW_TO_LINE_CONVERSION_.get(this.row_);return a&&(n.line=a),shaka.cea.CeaUtils.getParsedCaption(n,r,this.rows_,e,t)},shaka.cea.Cea608Memory.prototype.reset=function(){this.resetAllRows(),this.row_=1},shaka.cea.Cea608Memory.prototype.getRow=function(){return this.row_},shaka.cea.Cea608Memory.prototype.setRow=function(e){this.row_=e},shaka.cea.Cea608Memory.prototype.getScrollSize=function(){return this.scrollRows_},shaka.cea.Cea608Memory.prototype.setScrollSize=function(e){this.scrollRows_=e},shaka.cea.Cea608Memory.prototype.addChar=function(e,t){if(!(32>t||127<t)){var r="";switch(e){case shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN:r=shaka.cea.Cea608Memory.CharSet.BasicNorthAmericanChars.has(t)?shaka.cea.Cea608Memory.CharSet.BasicNorthAmericanChars.get(t):String.fromCharCode(t);break;case shaka.cea.Cea608Memory.CharSet.SPECIAL_NORTH_AMERICAN:r=shaka.cea.Cea608Memory.CharSet.SpecialNorthAmericanChars.get(t);break;case shaka.cea.Cea608Memory.CharSet.SPANISH_FRENCH:this.eraseChar(),r=shaka.cea.Cea608Memory.CharSet.ExtendedSpanishFrench.get(t);break;case shaka.cea.Cea608Memory.CharSet.PORTUGUESE_GERMAN:this.eraseChar(),r=shaka.cea.Cea608Memory.CharSet.ExtendedPortugueseGerman.get(t)}r&&(e=new shaka.cea.CeaUtils.StyledChar(r,this.underline_,this.italics_,this.backgroundColor_,this.textColor_),this.rows_[this.row_].push(e))}},shaka.cea.Cea608Memory.prototype.eraseChar=function(){this.rows_[this.row_].pop()},shaka.cea.Cea608Memory.prototype.moveRows=function(e,t,r){if(!(0>t||0>e))if(e>=t)for(--r;0<=r;r--)this.rows_[e+r]=this.rows_[t+r].map((function(e){return e}));else for(var n=0;n<r;n++)this.rows_[e+n]=this.rows_[t+n].map((function(e){return e}))},shaka.cea.Cea608Memory.prototype.resetRows=function(e,t){for(var r=0;r<=t;r++)this.rows_[e+r]=[]},shaka.cea.Cea608Memory.prototype.resetAllRows=function(){this.resetRows(0,shaka.cea.Cea608Memory.CC_ROWS)},shaka.cea.Cea608Memory.prototype.eraseBuffer=function(){this.row_=0<this.scrollRows_?this.scrollRows_:0,this.resetAllRows()},shaka.cea.Cea608Memory.prototype.setUnderline=function(e){this.underline_=e},shaka.cea.Cea608Memory.prototype.setItalics=function(e){this.italics_=e},shaka.cea.Cea608Memory.prototype.setTextColor=function(e){this.textColor_=e},shaka.cea.Cea608Memory.prototype.setBackgroundColor=function(e){this.backgroundColor_=e},shaka.cea.Cea608Memory.CC_ROWS=15,shaka.cea.Cea608Memory.CharSet={BASIC_NORTH_AMERICAN:0,SPECIAL_NORTH_AMERICAN:1,SPANISH_FRENCH:2,PORTUGUESE_GERMAN:3},shaka.cea.Cea608Memory.CharSet.BasicNorthAmericanChars=new Map([[39,"’"],[42,"á"],[92,"é"],[92,"é"],[94,"í"],[95,"ó"],[96,"ú"],[123,"ç"],[124,"÷"],[125,"Ñ"],[126,"ñ"],[127,"█"]]),shaka.cea.Cea608Memory.CharSet.SpecialNorthAmericanChars=new Map([[48,"®"],[49,"°"],[50,"½"],[51,"¿"],[52,"™"],[53,"¢"],[54,"£"],[55,"♪"],[56,"à"],[57," "],[58,"è"],[59,"â"],[60,"ê"],[61,"î"],[62,"ô"],[63,"û"]]),shaka.cea.Cea608Memory.CharSet.ExtendedSpanishFrench=new Map([[32,"Á"],[33,"É"],[34,"Ó"],[35,"Ú"],[36,"Ü"],[37,"ü"],[38,"‘"],[39,"¡"],[40,"*"],[41,"'"],[42,"─"],[43,"©"],[44,"℠"],[45,"·"],[46,"“"],[47,"”"],[48,"À"],[49,"Â"],[50,"Ç"],[51,"È"],[52,"Ê"],[53,"Ë"],[54,"ë"],[55,"Î"],[56,"Ï"],[57,"ï"],[58,"Ô"],[59,"Ù"],[60,"ù"],[61,"Û"],[62,"«"],[63,"»"]]),shaka.cea.Cea608Memory.CharSet.ExtendedPortugueseGerman=new Map([[32,"Ã"],[33,"ã"],[34,"Í"],[35,"Ì"],[36,"ì"],[37,"Ò"],[38,"ò"],[39,"Õ"],[40,"õ"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"Ä"],[49,"ä"],[50,"Ö"],[51,"ö"],[52,"ß"],[53,"¥"],[54,"¤"],[55,"│"],[56,"Å"],[57,"å"],[58,"Ø"],[59,"ø"],[60,"┌"],[61,"┐"],[62,"└"],[63,"┘"]]),shaka.cea.Cea608Memory.ROW_TO_LINE_CONVERSION_=new Map([[1,10],[2,15.33],[3,20.66],[4,26],[5,31.33],[6,36.66],[7,42],[8,47.33],[9,52.66],[10,58],[11,63.33],[12,68.66],[13,74],[14,79.33],[15,84.66]]),shaka.cea.Cea608DataChannel=function(e,t){this.type_=shaka.cea.Cea608DataChannel.CaptionType.NONE,this.text_=new shaka.cea.Cea608Memory(e,t),this.displayedMemory_=new shaka.cea.Cea608Memory(e,t),this.curbuf_=this.nonDisplayedMemory_=new shaka.cea.Cea608Memory(e,t),this.prevEndTime_=0,this.lastcp_=null},shaka.cea.Cea608DataChannel.prototype.reset=function(){this.type_=shaka.cea.Cea608DataChannel.CaptionType.NONE,this.curbuf_=this.nonDisplayedMemory_,this.lastcp_=null,this.displayedMemory_.reset(),this.nonDisplayedMemory_.reset(),this.text_.reset()},shaka.cea.Cea608DataChannel.prototype.firstPts=function(e){this.prevEndTime_=e},shaka.cea.Cea608DataChannel.prototype.pacToRow_=function(e,t){return[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&e)<<1|t>>5&1]},shaka.cea.Cea608DataChannel.prototype.controlPac_=function(e,t){e=this.pacToRow_(e,t);var r=(30&t)>>1,n=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,a=!1;if(7>r?n=shaka.cea.Cea608DataChannel.TEXT_COLORS[r]:7===r&&(a=!0),t=1==(1&t),this.type_!==shaka.cea.Cea608DataChannel.CaptionType.TEXT){if(r=this.curbuf_,this.type_===shaka.cea.Cea608DataChannel.CaptionType.ROLLUP&&e!==r.getRow()){var i=1+r.getRow()-r.getScrollSize(),o=1+e-r.getScrollSize();r.moveRows(o,i,r.getScrollSize()),r.resetRows(0,o-1),r.resetRows(e+1,shaka.cea.Cea608Memory.CC_ROWS-e)}r.setRow(e),r.setUnderline(t),r.setItalics(a),r.setTextColor(n),r.setBackgroundColor(shaka.cea.CeaUtils.DEFAULT_BG_COLOR)}},shaka.cea.Cea608DataChannel.prototype.controlMidrow_=function(e){this.curbuf_.setUnderline(!1),this.curbuf_.setItalics(!1),this.curbuf_.setTextColor(shaka.cea.CeaUtils.DEFAULT_TXT_COLOR),this.curbuf_.addChar(shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN,32);var t=!1,r=shaka.cea.Cea608DataChannel.TEXT_COLORS[(14&e)>>1];"white_italics"===r&&(r="white",t=!0),this.curbuf_.setUnderline(1==(1&e)),this.curbuf_.setItalics(t),this.curbuf_.setTextColor(r)},shaka.cea.Cea608DataChannel.prototype.controlBackgroundAttribute_=function(e,t){var r=shaka.cea.CeaUtils.DEFAULT_BG_COLOR;0==(7&e)&&(r=shaka.cea.Cea608DataChannel.BG_COLORS[(14&t)>>1]),this.curbuf_.setBackgroundColor(r)},shaka.cea.Cea608DataChannel.prototype.controlMiscellaneous_=function(e){var t=shaka.cea.Cea608DataChannel.MiscCmd_,r=e.pts,n=null;switch(e.ccData2){case t.RCL:this.controlRcl_();break;case t.BS:this.controlBs_();break;case t.RU2:n=this.controlRu_(2,r);break;case t.RU3:n=this.controlRu_(3,r);break;case t.RU4:n=this.controlRu_(4,r);break;case t.FON:this.controlFon_();break;case t.RDC:this.controlRdc_(r);break;case t.TR:this.controlTr_();break;case t.RTD:this.controlRtd_();break;case t.EDM:n=this.controlEdm_(r);break;case t.CR:n=this.controlCr_(r);break;case t.ENM:this.controlEnm_();break;case t.EOC:n=this.controlEoc_(r)}return n},shaka.cea.Cea608DataChannel.prototype.controlCr_=function(e){var t=this.curbuf_;if(this.type_!==shaka.cea.Cea608DataChannel.CaptionType.ROLLUP)return null;var r=t.forceEmit(this.prevEndTime_,e),n=t.getRow()-t.getScrollSize()+1;return t.moveRows(n-1,n,t.getScrollSize()),t.resetRows(0,n-1),t.resetRows(t.getRow(),shaka.cea.Cea608Memory.CC_ROWS-t.getRow()),this.prevEndTime_=e,r},shaka.cea.Cea608DataChannel.prototype.controlRu_=function(e,t){var r=this.curbuf_=this.displayedMemory_,n=null;return this.type_!==shaka.cea.Cea608DataChannel.CaptionType.ROLLUP&&this.type_!==shaka.cea.Cea608DataChannel.CaptionType.TEXT&&(n=r.forceEmit(this.prevEndTime_,t),this.displayedMemory_.eraseBuffer(),this.nonDisplayedMemory_.eraseBuffer(),r.setRow(shaka.cea.Cea608Memory.CC_ROWS)),this.type_=shaka.cea.Cea608DataChannel.CaptionType.ROLLUP,r.setScrollSize(e),n},shaka.cea.Cea608DataChannel.prototype.controlFon_=function(){this.curbuf_.addChar(shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN,32)},shaka.cea.Cea608DataChannel.prototype.controlEdm_=function(e){var t=this.displayedMemory_,r=null;return this.type_!==shaka.cea.Cea608DataChannel.CaptionType.TEXT&&(r=t.forceEmit(this.prevEndTime_,e)),t.resetAllRows(),r},shaka.cea.Cea608DataChannel.prototype.controlRdc_=function(e){this.type_=shaka.cea.Cea608DataChannel.CaptionType.PAINTON,this.curbuf_=this.displayedMemory_,this.curbuf_.setScrollSize(0),this.prevEndTime_=e},shaka.cea.Cea608DataChannel.prototype.controlEnm_=function(){this.nonDisplayedMemory_.resetAllRows()},shaka.cea.Cea608DataChannel.prototype.controlEoc_=function(e){var t=null;this.type_!==shaka.cea.Cea608DataChannel.CaptionType.TEXT&&(t=this.displayedMemory_.forceEmit(this.prevEndTime_,e));var r=this.nonDisplayedMemory_;return this.nonDisplayedMemory_=this.displayedMemory_,this.displayedMemory_=r,this.controlRcl_(),this.prevEndTime_=e,t},shaka.cea.Cea608DataChannel.prototype.controlRcl_=function(){this.type_=shaka.cea.Cea608DataChannel.CaptionType.POPON,this.curbuf_=this.nonDisplayedMemory_,this.curbuf_.setScrollSize(0)},shaka.cea.Cea608DataChannel.prototype.controlBs_=function(){this.curbuf_.eraseChar()},shaka.cea.Cea608DataChannel.prototype.controlTr_=function(){this.text_.reset(),this.controlRtd_()},shaka.cea.Cea608DataChannel.prototype.controlRtd_=function(){shaka.log.warnOnce("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),this.curbuf_=this.text_,this.type_=shaka.cea.Cea608DataChannel.CaptionType.TEXT},shaka.cea.Cea608DataChannel.prototype.handleBasicNorthAmericanChar=function(e,t){this.curbuf_.addChar(shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN,e),this.curbuf_.addChar(shaka.cea.Cea608Memory.CharSet.BASIC_NORTH_AMERICAN,t)},shaka.cea.Cea608DataChannel.prototype.handleExtendedWesternEuropeanChar_=function(e,t){this.curbuf_.addChar(1&e?shaka.cea.Cea608Memory.CharSet.PORTUGUESE_GERMAN:shaka.cea.Cea608Memory.CharSet.SPANISH_FRENCH,t)},shaka.cea.Cea608DataChannel.prototype.handleControlCode=function(e){var t=e.ccData1,r=e.ccData2;if(this.lastcp_===(t<<8|r))return this.lastcp_=null;if(this.lastcp_=t<<8|r,this.isPAC_(t,r))this.controlPac_(t,r);else if(this.isMidrowStyleChange_(t,r))this.controlMidrow_(r);else if(this.isBackgroundAttribute_(t,r))this.controlBackgroundAttribute_(t,r);else if(this.isSpecialNorthAmericanChar_(t,r))this.curbuf_.addChar(shaka.cea.Cea608Memory.CharSet.SPECIAL_NORTH_AMERICAN,r);else if(this.isExtendedWesternEuropeanChar_(t,r))this.handleExtendedWesternEuropeanChar_(t,r);else if(this.isMiscellaneous_(t,r))return this.controlMiscellaneous_(e);return null},shaka.cea.Cea608DataChannel.prototype.isMiscellaneous_=function(e,t){return 20==(246&e)&&32==(240&t)},shaka.cea.Cea608DataChannel.prototype.isPAC_=function(e,t){return 16==(240&e)&&64==(192&t)},shaka.cea.Cea608DataChannel.prototype.isMidrowStyleChange_=function(e,t){return 17==(247&e)&&32==(240&t)},shaka.cea.Cea608DataChannel.prototype.isBackgroundAttribute_=function(e,t){return 16==(247&e)&&32==(240&t)||23==(247&e)&&45==(255&t)},shaka.cea.Cea608DataChannel.prototype.isSpecialNorthAmericanChar_=function(e,t){return 17==(247&e)&&48==(240&t)},shaka.cea.Cea608DataChannel.prototype.isExtendedWesternEuropeanChar_=function(e,t){return 18==(246&e)&&32==(224&t)},shaka.cea.Cea608DataChannel.isControlCode=function(e){return 16==(112&e)},shaka.cea.Cea608DataChannel.isXdsControlCode=function(e){return 1<=e&&15>=e},shaka.cea.Cea608DataChannel.MiscCmd_={RCL:32,BS:33,AOD:34,AON:35,DER:36,RU2:37,RU3:38,RU4:39,FON:40,RDC:41,TR:42,RTD:43,EDM:44,CR:45,ENM:46,EOC:47},shaka.cea.Cea608DataChannel.CaptionType={NONE:0,POPON:1,PAINTON:2,ROLLUP:3,TEXT:4},shaka.cea.Cea608DataChannel.BG_COLORS="black green blue cyan red yellow magenta black".split(" "),shaka.cea.Cea608DataChannel.TEXT_COLORS="white green blue cyan red yellow magenta white_italics".split(" "),shaka.cea.Cea708Window=function(e,t){this.parentService_=t,this.windowNum_=e,this.relativeToggle_=this.visible_=!1,this.colCount_=this.rowCount_=this.anchorId_=this.verticalAnchor_=this.horizontalAnchor_=0,this.justification_=shaka.cea.Cea708Window.TextJustification.CENTER,this.memory_=[],this.col_=this.row_=this.startTime_=0,this.underline_=this.italics_=!1,this.textColor_=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,this.backgroundColor_=shaka.cea.CeaUtils.DEFAULT_BG_COLOR,this.resetMemory()},shaka.cea.Cea708Window.prototype.defineWindow=function(e,t,r,n,a,i,o){this.visible_=e,this.verticalAnchor_=t,this.horizontalAnchor_=r,this.anchorId_=n,this.relativeToggle_=a,this.rowCount_=i,this.colCount_=o},shaka.cea.Cea708Window.prototype.resetMemory=function(){this.memory_=[];for(var e=0;e<shaka.cea.Cea708Window.MAX_ROWS;e++)this.memory_.push(this.createNewRow_())},shaka.cea.Cea708Window.prototype.createNewRow_=function(){for(var e=[],t=0;t<shaka.cea.Cea708Window.MAX_COLS;t++)e.push(null);return e},shaka.cea.Cea708Window.prototype.setCharacter=function(e){this.isPenInBounds_()&&(e=new shaka.cea.CeaUtils.StyledChar(e,this.underline_,this.italics_,this.backgroundColor_,this.textColor_),this.memory_[this.row_][this.col_]=e,this.col_++)},shaka.cea.Cea708Window.prototype.backspace=function(){!this.isPenInBounds_()||0>=this.col_&&0>=this.row_||(0>=this.col_?(this.col_=this.colCount_-1,this.row_--):this.col_--,this.memory_[this.row_][this.col_]=null)},shaka.cea.Cea708Window.prototype.isPenInBounds_=function(){var e=this.col_<this.colCount_&&0<=this.col_;return this.row_<this.rowCount_&&0<=this.row_&&e},shaka.cea.Cea708Window.prototype.isVisible=function(){return this.visible_},shaka.cea.Cea708Window.prototype.moveUpRows_=function(e){for(var t=0,r=e;r<shaka.cea.Cea708Window.MAX_ROWS;r++,t++)this.memory_[t]=this.memory_[r];for(r=0;r<e;r++,t++)this.memory_[t]=this.createNewRow_()},shaka.cea.Cea708Window.prototype.carriageReturn=function(){this.row_+1>=this.rowCount_?this.moveUpRows_(1):this.row_++,this.col_=0},shaka.cea.Cea708Window.prototype.horizontalCarriageReturn=function(){this.memory_[this.row_]=this.createNewRow_(),this.col_=0},shaka.cea.Cea708Window.prototype.forceEmit=function(e,t){t="svc"+t;var r=shaka.cea.Cea708Window.TextJustification,n=new shaka.text.Cue(this.startTime_,e,"");return n.textAlign=this.justification_===r.LEFT?shaka.text.Cue.textAlign.LEFT:this.justification_===r.RIGHT?shaka.text.Cue.textAlign.RIGHT:shaka.text.Cue.textAlign.CENTER,this.adjustRegion_(n.region),(t=shaka.cea.CeaUtils.getParsedCaption(n,t,this.memory_,this.startTime_,e))&&this.setStartTime(e),t},shaka.cea.Cea708Window.prototype.setPenLocation=function(e,t){this.row_=e,this.col_=t},shaka.cea.Cea708Window.prototype.setPenBackgroundColor=function(e){this.backgroundColor_=e},shaka.cea.Cea708Window.prototype.setPenTextColor=function(e){this.textColor_=e},shaka.cea.Cea708Window.prototype.setPenUnderline=function(e){this.underline_=e},shaka.cea.Cea708Window.prototype.setPenItalics=function(e){this.italics_=e},shaka.cea.Cea708Window.prototype.resetPen=function(){this.col_=this.row_=0,this.italics_=this.underline_=!1,this.textColor_=shaka.cea.CeaUtils.DEFAULT_TXT_COLOR,this.backgroundColor_=shaka.cea.CeaUtils.DEFAULT_BG_COLOR},shaka.cea.Cea708Window.prototype.setJustification=function(e){this.justification_=e},shaka.cea.Cea708Window.prototype.display=function(){this.visible_=!0},shaka.cea.Cea708Window.prototype.hide=function(){this.visible_=!1},shaka.cea.Cea708Window.prototype.toggle=function(){this.visible_=!this.visible_},shaka.cea.Cea708Window.prototype.setStartTime=function(e){this.startTime_=e},shaka.cea.Cea708Window.prototype.adjustRegion_=function(e){this.parentService_&&(e.id+="svc"+this.parentService_),e.id+="win"+this.windowNum_,e.height=this.rowCount_,e.width=this.colCount_,e.heightUnits=shaka.text.CueRegion.units.LINES,e.widthUnits=shaka.text.CueRegion.units.LINES,e.viewportAnchorX=this.horizontalAnchor_,e.viewportAnchorY=this.verticalAnchor_,e.viewportAnchorUnits=this.relativeToggle_?shaka.text.CueRegion.units.PERCENTAGE:shaka.text.CueRegion.units.LINES;var t=shaka.cea.Cea708Window.AnchorId;switch(this.anchorId_){case t.UPPER_LEFT:e.regionAnchorX=0,e.regionAnchorY=0;break;case t.UPPER_CENTER:e.regionAnchorX=50,e.regionAnchorY=0;break;case t.UPPER_RIGHT:e.regionAnchorX=100,e.regionAnchorY=0;break;case t.MIDDLE_LEFT:e.regionAnchorX=0,e.regionAnchorY=50;break;case t.MIDDLE_CENTER:e.regionAnchorX=50,e.regionAnchorY=50;break;case t.MIDDLE_RIGHT:e.regionAnchorX=100,e.regionAnchorY=50;break;case t.LOWER_LEFT:e.regionAnchorX=0,e.regionAnchorY=100;break;case t.LOWER_CENTER:e.regionAnchorX=50,e.regionAnchorY=100;break;case t.LOWER_RIGHT:e.regionAnchorX=100,e.regionAnchorY=100}},shaka.cea.Cea708Window.TextJustification={LEFT:0,RIGHT:1,CENTER:2,FULL:3},shaka.cea.Cea708Window.AnchorId={UPPER_LEFT:0,UPPER_CENTER:1,UPPER_RIGHT:2,MIDDLE_LEFT:3,MIDDLE_CENTER:4,MIDDLE_RIGHT:5,LOWER_LEFT:6,LOWER_CENTER:7,LOWER_RIGHT:8},shaka.cea.Cea708Window.MAX_COLS=42,shaka.cea.Cea708Window.MAX_ROWS=16,shaka.cea.DtvccPacketBuilder=function(){this.builtPackets_=[],this.currentPacketBeingBuilt_=null,this.bytesLeftToAddInCurrentPacket_=0},shaka.cea.DtvccPacketBuilder.prototype.addByte=function(e){e.type===shaka.cea.DtvccPacketBuilder.DTVCC_PACKET_START?(this.bytesLeftToAddInCurrentPacket_=2*(63&e.value)-1,this.currentPacketBeingBuilt_=[]):this.currentPacketBeingBuilt_&&(0<this.bytesLeftToAddInCurrentPacket_&&(this.currentPacketBeingBuilt_.push(e),this.bytesLeftToAddInCurrentPacket_--),0===this.bytesLeftToAddInCurrentPacket_&&(e=new shaka.cea.DtvccPacket(this.currentPacketBeingBuilt_),this.builtPackets_.push(e),this.currentPacketBeingBuilt_=null,this.bytesLeftToAddInCurrentPacket_=0))},shaka.cea.DtvccPacketBuilder.prototype.getBuiltPackets=function(){return this.builtPackets_},shaka.cea.DtvccPacketBuilder.prototype.clearBuiltPackets=function(){this.builtPackets_=[]},shaka.cea.DtvccPacketBuilder.prototype.clear=function(){this.builtPackets_=[],this.currentPacketBeingBuilt_=[],this.bytesLeftToAddInCurrentPacket_=0},shaka.cea.DtvccPacket=function(e){this.pos_=0,this.packetData_=e},shaka.cea.DtvccPacket.prototype.hasMoreData=function(){return this.pos_<this.packetData_.length},shaka.cea.DtvccPacket.prototype.getPosition=function(){return this.pos_},shaka.cea.DtvccPacket.prototype.readByte=function(){if(!this.hasMoreData())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS);return this.packetData_[this.pos_++]},shaka.cea.DtvccPacket.prototype.skip=function(e){if(this.pos_+e>this.packetData_.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS);this.pos_+=e},shaka.cea.DtvccPacketBuilder.DTVCC_PACKET_DATA=2,shaka.cea.DtvccPacketBuilder.DTVCC_PACKET_START=3,shaka.cea.Cea708Service=function(e){this.serviceNumber_=e,this.windows_=[null,null,null,null,null,null,null,null],this.currentWindow_=null},shaka.cea.Cea708Service.prototype.handleCea708ControlCode=function(e){var t=e.readByte(),r=t.value;(t=t.pts,r===shaka.cea.Cea708Service.EXT_CEA708_CTRL_CODE_BYTE1)&&(r=r<<16|e.readByte().value);return 0<=r&&31>=r?this.handleC0_(r,t):128<=r&&159>=r?this.handleC1_(e,r,t):(4096<=r&&4127>=r?this.handleC2_(e,255&r):4224<=r&&4255>=r?this.handleC3_(e,255&r):32<=r&&127>=r?this.handleG0_(r):160<=r&&255>=r?this.handleG1_(r):4128<=r&&4223>=r?this.handleG2_(255&r):4256<=r&&4351>=r&&this.handleG3_(255&r),null)},shaka.cea.Cea708Service.prototype.handleG0_=function(e){this.currentWindow_&&(127===e?this.currentWindow_.setCharacter("♪"):this.currentWindow_.setCharacter(String.fromCharCode(e)))},shaka.cea.Cea708Service.prototype.handleG1_=function(e){this.currentWindow_&&this.currentWindow_.setCharacter(String.fromCharCode(e))},shaka.cea.Cea708Service.prototype.handleG2_=function(e){this.currentWindow_&&(shaka.cea.Cea708Service.G2Charset.has(e)?(e=shaka.cea.Cea708Service.G2Charset.get(e),this.currentWindow_.setCharacter(e)):this.currentWindow_.setCharacter("_"))},shaka.cea.Cea708Service.prototype.handleG3_=function(e){this.currentWindow_&&(160!=e?this.currentWindow_.setCharacter("_"):this.currentWindow_.setCharacter("[CC]"))},shaka.cea.Cea708Service.prototype.handleC0_=function(e,t){if(!this.currentWindow_)return null;var r=this.currentWindow_,n=null;switch(e){case shaka.cea.Cea708Service.ASCII_BACKSPACE:r.backspace();break;case shaka.cea.Cea708Service.ASCII_CARRIAGE_RETURN:r.isVisible()&&(n=r.forceEmit(t,this.serviceNumber_)),r.carriageReturn();break;case shaka.cea.Cea708Service.ASCII_HOR_CARRIAGE_RETURN:r.isVisible()&&(n=r.forceEmit(t,this.serviceNumber_)),r.horizontalCarriageReturn();break;case shaka.cea.Cea708Service.ASCII_FORM_FEED:r.isVisible()&&(n=r.forceEmit(t,this.serviceNumber_)),r.resetMemory(),r.setPenLocation(0,0)}return n},shaka.cea.Cea708Service.prototype.handleC1_=function(e,t,r){if(128<=t&&135>=t)this.setCurrentWindow_(7&t);else{if(136===t)return e=e.readByte().value,this.clearWindows_(e,r);if(137===t)e=e.readByte().value,this.displayWindows_(e,r);else{if(138===t)return e=e.readByte().value,this.hideWindows_(e,r);if(139===t)return e=e.readByte().value,this.toggleWindows_(e,r);if(140===t)return e=e.readByte().value,this.deleteWindows_(e,r);if(143===t)return this.reset_(r);144===t?this.setPenAttributes_(e):145===t?this.setPenColor_(e):146===t?this.setPenLocation_(e):151===t?this.setWindowAttributes_(e):152<=t&&159>=t&&this.defineWindow_(e,(15&t)-8,r)}}return null},shaka.cea.Cea708Service.prototype.handleC2_=function(e,t){8<=t&&15>=t?e.skip(1):16<=t&&23>=t?e.skip(2):24<=t&&31>=t&&e.skip(3)},shaka.cea.Cea708Service.prototype.handleC3_=function(e,t){128<=t&&135>=t?e.skip(4):136<=t&&143>=t&&e.skip(5)},shaka.cea.Cea708Service.prototype.setCurrentWindow_=function(e){this.windows_[e]&&(this.currentWindow_=this.windows_[e])},shaka.cea.Cea708Service.prototype.getSpecifiedWindowIds_=function(e){for(var t=[],r=0;8>r;r++)1==(1&e)&&this.windows_[r]&&t.push(r),e>>=1;return t},shaka.cea.Cea708Service.prototype.clearWindows_=function(e,t){for(var r=null,n=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!n.done;n=e.next())(n=this.windows_[n.value]).isVisible()&&(r=n.forceEmit(t,this.serviceNumber_)),n.resetMemory();return r},shaka.cea.Cea708Service.prototype.displayWindows_=function(e,t){for(var r=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!r.done;r=e.next())(r=this.windows_[r.value]).isVisible()||r.setStartTime(t),r.display()},shaka.cea.Cea708Service.prototype.hideWindows_=function(e,t){for(var r=null,n=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!n.done;n=e.next())(n=this.windows_[n.value]).isVisible()&&(r=n.forceEmit(t,this.serviceNumber_)),n.hide();return r},shaka.cea.Cea708Service.prototype.toggleWindows_=function(e,t){for(var r=null,n=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!n.done;n=e.next())(n=this.windows_[n.value]).isVisible()?r=n.forceEmit(t,this.serviceNumber_):n.setStartTime(t),n.toggle();return r},shaka.cea.Cea708Service.prototype.deleteWindows_=function(e,t){for(var r=null,n=(e=$jscomp.makeIterator(this.getSpecifiedWindowIds_(e))).next();!n.done;n=e.next()){n=n.value;var a=this.windows_[n];a.isVisible()&&(r=a.forceEmit(t,this.serviceNumber_)),this.windows_[n]=null}return r},shaka.cea.Cea708Service.prototype.reset_=function(e){return e=this.deleteWindows_(255,e),this.clear(),e},shaka.cea.Cea708Service.prototype.clear=function(){this.currentWindow_=null,this.windows_=[null,null,null,null,null,null,null,null]},shaka.cea.Cea708Service.prototype.setPenAttributes_=function(e){if(e.skip(1),e=e.readByte().value,this.currentWindow_){var t=0<(64&e);this.currentWindow_.setPenItalics(0<(128&e)),this.currentWindow_.setPenUnderline(t)}},shaka.cea.Cea708Service.prototype.setPenColor_=function(e){var t=e.readByte().value,r=e.readByte().value;if(e.skip(1),this.currentWindow_){e=3&r;var n=(12&r)>>2;r=(48&r)>>4,t=this.rgbColorToHex_((48&t)>>4,(12&t)>>2,3&t),e=this.rgbColorToHex_(r,n,e),this.currentWindow_.setPenTextColor(t),this.currentWindow_.setPenBackgroundColor(e)}},shaka.cea.Cea708Service.prototype.setPenLocation_=function(e){var t=e.readByte().value;e=e.readByte().value,this.currentWindow_&&this.currentWindow_.setPenLocation(15&t,63&e)},shaka.cea.Cea708Service.prototype.setWindowAttributes_=function(e){e.skip(1),e.skip(1);var t=e.readByte().value;e.skip(1),this.currentWindow_&&this.currentWindow_.setJustification(3&t)},shaka.cea.Cea708Service.prototype.defineWindow_=function(e,t,r){var n=null!==this.windows_[t];if(!n){var a=new shaka.cea.Cea708Window(t,this.serviceNumber_);a.setStartTime(r),this.windows_[t]=a}var i=e.readByte().value,o=e.readByte().value;r=e.readByte().value;var s=e.readByte().value;a=e.readByte().value,e=e.readByte().value,i=0<(32&i);var l=127&o;o=0<(128&o);var u=1+(15&s);s=(240&s)>>4,a=1+(63&a),n&&0==(7&e)||this.windows_[t].resetPen(),this.windows_[t].defineWindow(i,l,r,s,o,u,a),this.currentWindow_=this.windows_[t]},shaka.cea.Cea708Service.prototype.rgbColorToHex_=function(e,t,r){var n={0:0,1:0,2:1,3:1};return e=n[e],t=n[t],r=n[r],shaka.cea.Cea708Service.Colors[e<<2|t<<1|r]},shaka.cea.Cea708Service.ASCII_BACKSPACE=8,shaka.cea.Cea708Service.ASCII_FORM_FEED=12,shaka.cea.Cea708Service.ASCII_CARRIAGE_RETURN=13,shaka.cea.Cea708Service.ASCII_HOR_CARRIAGE_RETURN=14,shaka.cea.Cea708Service.EXT_CEA708_CTRL_CODE_BYTE1=16,shaka.cea.Cea708Service.G2Charset=new Map([[32," "],[33," "],[37,"…"],[42,"Š"],[44,"Œ"],[48,"█"],[49,"‘"],[50,"’"],[51,"“"],[52,"”"],[53,"•"],[57,"™"],[58,"š"],[60,"œ"],[61,"℠"],[63,"Ÿ"],[118,"⅛"],[119,"⅜"],[120,"⅝"],[121,"⅞"],[122,"│"],[123,"┐"],[124,"└"],[125,"─"],[126,"┘"],[127,"┌"]]),shaka.cea.Cea708Service.Colors="black blue green cyan red magenta yellow white".split(" "),shaka.cea.CeaDecoder=function(){this.cea608DataArray_=[],this.cea708DataArray_=[],this.dtvccPacketBuilder_=new shaka.cea.DtvccPacketBuilder,this.badFrames_=0,this.cea608ModeToStream_=new Map([["CC1",new shaka.cea.Cea608DataChannel(0,0)],["CC2",new shaka.cea.Cea608DataChannel(0,1)],["CC3",new shaka.cea.Cea608DataChannel(1,0)],["CC4",new shaka.cea.Cea608DataChannel(1,1)]]),this.currentField2Channel_=this.currentField1Channel_=0,this.serviceNumberToService_=new Map,this.waitingForFirstPacket_=!0,this.streams_=new Set,this.reset()},shaka.cea.CeaDecoder.prototype.clear=function(){shaka.log.debug("Clearing CEA decoder"),this.badFrames_=0,this.cea608DataArray_=[],this.cea708DataArray_=[],this.dtvccPacketBuilder_.clear(),this.reset();for(var e=$jscomp.makeIterator(this.serviceNumberToService_.values()),t=e.next();!t.done;t=e.next())t.value.clear()},shaka.cea.CeaDecoder.prototype.reset=function(){shaka.log.debug("Resetting CEA decoder"),this.currentField2Channel_=this.currentField1Channel_=0;for(var e=$jscomp.makeIterator(this.cea608ModeToStream_.values()),t=e.next();!t.done;t=e.next())t.value.reset();this.waitingForFirstPacket_=!0},shaka.cea.CeaDecoder.prototype.extract=function(e,t){if(this.waitingForFirstPacket_){shaka.log.debug("Setting first pts value to",t);for(var r=$jscomp.makeIterator(this.cea608ModeToStream_.values()),n=r.next();!n.done;n=r.next())n.value.firstPts(t);this.waitingForFirstPacket_=!1}if(!((e=new shaka.util.DataViewReader(e,shaka.util.DataViewReader.Endianness.BIG_ENDIAN)).getLength()<shaka.cea.CeaDecoder.MIN_LENGTH)&&e.readUint8()===shaka.cea.CeaDecoder.USA_COUNTRY_CODE&&e.readUint16()===shaka.cea.CeaDecoder.ATSC_PROVIDER_CODE&&e.readUint32()===shaka.cea.CeaDecoder.ATSC1_USER_IDENTIFIER&&3===e.readUint8()&&0!=(64&(r=e.readUint8())))for(r&=31,e.skip(1),n=0;n<r;n++){var a=e.readUint8(),i=(4&a)>>2,o=e.readUint8(),s=e.readUint8();i&&((a&=3)===shaka.cea.CeaDecoder.NTSC_CC_FIELD_1||a===shaka.cea.CeaDecoder.NTSC_CC_FIELD_2?this.cea608DataArray_.push({pts:t,type:a,ccData1:o,ccData2:s,order:this.cea608DataArray_.length}):(this.cea708DataArray_.push({pts:t,type:a,value:o,order:this.cea708DataArray_.length}),this.cea708DataArray_.push({pts:t,type:shaka.cea.DtvccPacketBuilder.DTVCC_PACKET_DATA,value:s,order:this.cea708DataArray_.length})))}},shaka.cea.CeaDecoder.prototype.decode=function(){var e=[],t=function(e,t){return e.pts-t.pts||e.order-t.order};this.cea608DataArray_.sort(t),this.cea708DataArray_.sort(t);for(var r=(t=$jscomp.makeIterator(this.cea608DataArray_)).next();!r.done;r=t.next())(r=this.decodeCea608_(r.value))&&e.push(r);for(r=(t=$jscomp.makeIterator(this.cea708DataArray_)).next();!r.done;r=t.next())this.dtvccPacketBuilder_.addByte(r.value);for(t=this.dtvccPacketBuilder_.getBuiltPackets(),r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())r=this.decodeCea708_(r.value),e.push.apply(e,$jscomp.arrayFromIterable(r));return this.dtvccPacketBuilder_.clearBuiltPackets(),this.cea608DataArray_=[],this.cea708DataArray_=[],e},shaka.cea.CeaDecoder.prototype.decodeCea608_=function(e){var t=e.type;if(shaka.cea.Cea608DataChannel.isControlCode(e.ccData1)){var r=e.ccData1>>3&1;0===t?this.currentField1Channel_=r:this.currentField2Channel_=r}if(t="CC"+(1+(t<<1|(t?this.currentField2Channel_:this.currentField1Channel_))),r=this.cea608ModeToStream_.get(t),255===e.ccData1&&255===e.ccData2||!e.ccData1&&!e.ccData2||!this.isOddParity_(e.ccData1)||!this.isOddParity_(e.ccData2))return 45<=++this.badFrames_&&this.reset(),null;if(this.badFrames_=0,e.ccData1&=127,e.ccData2&=127,shaka.cea.Cea608DataChannel.isXdsControlCode(e.ccData1)||!e.ccData1&&!e.ccData2)return null;var n=null;return shaka.cea.Cea608DataChannel.isControlCode(e.ccData1)?(this.streams_.add(t),n=r.handleControlCode(e)):r.handleBasicNorthAmericanChar(e.ccData1,e.ccData2),n},shaka.cea.CeaDecoder.prototype.decodeCea708_=function(e){var t=[];try{for(;e.hasMoreData();){var r=e.readByte().value,n=(224&r)>>5,a=31&r;if(7===n&&0!=a&&(n=63&e.readByte().value),0!=n){if(this.streams_.add("svc"+n),!this.serviceNumberToService_.has(n)){var i=new shaka.cea.Cea708Service(n);this.serviceNumberToService_.set(n,i)}for(var o=this.serviceNumberToService_.get(n),s=e.getPosition();e.getPosition()-s<a;){var l=o.handleCea708ControlCode(e);l&&t.push(l)}}}}catch(e){if(!(e instanceof shaka.util.Error&&e.code===shaka.util.Error.Code.BUFFER_READ_OUT_OF_BOUNDS))throw e;shaka.log.warnOnce("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return t},shaka.cea.CeaDecoder.prototype.isOddParity_=function(e){for(var t=0;e;)t^=1&e,e>>=1;return 1===t},shaka.cea.CeaDecoder.prototype.getStreams=function(){return Array.from(this.streams_)},goog.exportSymbol("shaka.cea.CeaDecoder",shaka.cea.CeaDecoder),shaka.cea.CeaDecoder.ATSC_PROVIDER_CODE=49,shaka.cea.CeaDecoder.ATSC1_USER_IDENTIFIER=1195456820,shaka.cea.CeaDecoder.NTSC_CC_FIELD_1=0,shaka.cea.CeaDecoder.NTSC_CC_FIELD_2=1,shaka.cea.CeaDecoder.USA_COUNTRY_CODE=181,shaka.cea.CeaDecoder.MIN_LENGTH=8,shaka.media.ClosedCaptionParser.registerDecoder((function(){return new shaka.cea.CeaDecoder})),shaka.cea.SeiProcessor=function(){},shaka.cea.SeiProcessor.prototype.process=function(e){var t=[];e=this.removeEmu(e);for(var r=0;r<e.length;){for(var n=0;255==e[r];)n+=255,r++;n+=e[r++];for(var a=0;255==e[r];)a+=255,r++;a+=e[r++],4==n&&t.push(e.subarray(r,r+a)),r+=a}return t},shaka.cea.SeiProcessor.prototype.removeEmu=function(e){for(var t=e,r=e=0;r<t.length;)2==e&&3==t[r]?(e=0,(t=[].concat($jscomp.arrayFromIterable(t))).splice(r,1),t=new Uint8Array(t)):0==t[r]?e++:e=0,r++;return t},shaka.cea.Mp4CeaParser=function(){this.seiProcessor_=new shaka.cea.SeiProcessor,this.trackIdToTimescale_=new Map,this.defaultSampleSize_=this.defaultSampleDuration_=0,this.bitstreamFormat_=shaka.cea.Mp4CeaParser.BitstreamFormat.UNKNOWN},shaka.cea.Mp4CeaParser.prototype.init=function(e){var t=this,r=shaka.util.Mp4Parser,n=shaka.cea.Mp4CeaParser.BitstreamFormat,a=[],i=[],o=function(e){return t.setBitstreamFormat_(e.name)};if((new r).box("moov",r.children).box("mvex",r.children).fullBox("trex",(function(e){e=shaka.util.Mp4BoxParsers.parseTREX(e.reader),t.defaultSampleDuration_=e.defaultSampleDuration,t.defaultSampleSize_=e.defaultSampleSize})).box("trak",r.children).fullBox("tkhd",(function(e){goog.asserts.assert(null!=e.version,"TKHD is a full box and should have a valid version."),e=shaka.util.Mp4BoxParsers.parseTKHD(e.reader,e.version),a.push(e.trackId)})).box("mdia",r.children).fullBox("mdhd",(function(e){goog.asserts.assert(null!=e.version,"MDHD is a full box and should have a valid version."),e=shaka.util.Mp4BoxParsers.parseMDHD(e.reader,e.version),i.push(e.timescale)})).box("minf",r.children).box("stbl",r.children).fullBox("stsd",r.sampleDescription).box("avc1",o).box("avc3",o).box("hev1",o).box("hvc1",o).box("dvav",o).box("dva1",o).box("dvh1",o).box("dvhe",o).box("encv",r.visualSampleEntry).box("sinf",r.children).box("frma",(function(e){e=shaka.util.Mp4BoxParsers.parseFRMA(e.reader).codec,t.setBitstreamFormat_(e)})).parse(e,!0),!a.length||!i.length||a.length!=i.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_CEA);this.bitstreamFormat_==n.UNKNOWN&&shaka.log.alwaysWarn("Unable to determine bitstream format for CEA parsing!"),a.forEach((function(e,r){t.trackIdToTimescale_.set(e,i[r])}))},shaka.cea.Mp4CeaParser.prototype.parse=function(e){var t=this,r=shaka.util.Mp4Parser;if(this.bitstreamFormat_==shaka.cea.Mp4CeaParser.BitstreamFormat.UNKNOWN)return[];var n=[],a=this.defaultSampleDuration_,i=this.defaultSampleSize_,o=0,s=[],l=null,u=shaka.cea.CeaUtils.DEFAULT_TIMESCALE_VALUE;return(new r).box("moof",(function(e){o=e.start,s=[],r.children(e)})).box("traf",r.children).fullBox("trun",(function(e){goog.asserts.assert(null!=e.version&&null!=e.flags,"TRUN is a full box and should have a valid version & flags."),e=shaka.util.Mp4BoxParsers.parseTRUN(e.reader,e.version,e.flags),s.push(e)})).fullBox("tfhd",(function(e){goog.asserts.assert(null!=e.flags,"TFHD is a full box and should have valid flags."),e=shaka.util.Mp4BoxParsers.parseTFHD(e.reader,e.flags),a=e.defaultSampleDuration||t.defaultSampleDuration_,i=e.defaultSampleSize||t.defaultSampleSize_,e=e.trackId,t.trackIdToTimescale_.has(e)&&(u=t.trackIdToTimescale_.get(e))})).fullBox("tfdt",(function(e){goog.asserts.assert(null!=e.version,"TFDT is a full box and should have a valid version."),l=shaka.util.Mp4BoxParsers.parseTFDTInaccurate(e.reader,e.version).baseMediaDecodeTime})).box("mdat",(function(e){if(null===l)throw shaka.log.alwaysWarn("Unable to find base media decode time for CEA captions!"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_CEA);t.parseMdat_(e.reader,l,u,a,i,o-e.start-8,s,n)})).parse(e,!1),n},shaka.cea.Mp4CeaParser.prototype.parseMdat_=function(e,t,r,n,a,i,o,s){var l=shaka.cea.Mp4CeaParser.BitstreamFormat,u=shaka.cea.CeaUtils,c=0,d=a,p=o.map((function(e){return e.sampleData}));for((p=[].concat.apply([],$jscomp.arrayFromIterable(p))).length&&(d=p[0].sampleSize||a),e.skip(i+o[0].dataOffset);e.hasMoreData();){i=e.readUint32();var h=e.readUint8(),f=null;switch(f=!1,o=1,goog.asserts.assert(this.bitstreamFormat_!=l.UNKNOWN,"Bitstream format should have been checked before now!"),this.bitstreamFormat_){case l.H264:f=(f=31&h)==u.H264_NALU_TYPE_SEI;break;case l.H265:o=2,e.skip(1),f=(f=h>>1&63)==u.H265_PREFIX_NALU_TYPE_SEI||f==u.H265_SUFFIX_NALU_TYPE_SEI;break;default:return}if(f)for(h=0,c<p.length&&(h=p[c].sampleCompositionTimeOffset||0),h=(t+h)/r,f=(o=$jscomp.makeIterator(this.seiProcessor_.process(e.readBytes(i-o)))).next();!f.done;f=o.next())s.push({packet:f.value,pts:h});else try{e.skip(i-o)}catch(e){break}0==(d-=i+4)&&(t=c<p.length?t+(p[c].sampleDuration||n):t+n,d=++c<p.length&&p[c].sampleSize||a)}},shaka.cea.Mp4CeaParser.prototype.setBitstreamFormat_=function(e){e in shaka.cea.Mp4CeaParser.CodecBitstreamMap_&&(this.bitstreamFormat_=shaka.cea.Mp4CeaParser.CodecBitstreamMap_[e])},goog.exportSymbol("shaka.cea.Mp4CeaParser",shaka.cea.Mp4CeaParser),shaka.cea.Mp4CeaParser.BitstreamFormat={UNKNOWN:0,H264:1,H265:2},shaka.cea.Mp4CeaParser.CodecBitstreamMap_={avc1:shaka.cea.Mp4CeaParser.BitstreamFormat.H264,avc3:shaka.cea.Mp4CeaParser.BitstreamFormat.H264,hev1:shaka.cea.Mp4CeaParser.BitstreamFormat.H265,hvc1:shaka.cea.Mp4CeaParser.BitstreamFormat.H265,dvav:shaka.cea.Mp4CeaParser.BitstreamFormat.H264,dva1:shaka.cea.Mp4CeaParser.BitstreamFormat.H264,dvh1:shaka.cea.Mp4CeaParser.BitstreamFormat.H265,dvhe:shaka.cea.Mp4CeaParser.BitstreamFormat.H265},shaka.media.ClosedCaptionParser.registerParser("video/mp4",(function(){return new shaka.cea.Mp4CeaParser})),shaka.cea.TsCeaParser=function(){this.seiProcessor_=new shaka.cea.SeiProcessor,this.tsParser_=null},shaka.cea.TsCeaParser.prototype.init=function(e){},shaka.cea.TsCeaParser.prototype.parse=function(e){var t=shaka.cea.CeaUtils;this.tsParser_?this.tsParser_.clearData():this.tsParser_=new shaka.util.TsParser;var r=[];if(e=shaka.util.BufferUtils.toUint8(e),!shaka.util.TsParser.probe(e))return r;var n=(e=this.tsParser_.parse(e)).getCodecs(),a=e.getVideoNalus();switch(e=[],n.video){case"avc":e.push(t.H264_NALU_TYPE_SEI);break;case"hvc":e.push(t.H265_PREFIX_NALU_TYPE_SEI),e.push(t.H265_SUFFIX_NALU_TYPE_SEI)}if(!e.length)return r;for(n=(t=$jscomp.makeIterator(a)).next();!n.done;n=t.next())if(n=n.value,e.includes(n.type)&&null!=n.time)for(var i=(a=$jscomp.makeIterator(this.seiProcessor_.process(n.data))).next();!i.done;i=a.next())r.push({packet:i.value,pts:n.time});return r},goog.exportSymbol("shaka.cea.TsCeaParser",shaka.cea.TsCeaParser),shaka.media.ClosedCaptionParser.registerParser("video/mp2t",(function(){return new shaka.cea.TsCeaParser})),shaka.dash={},shaka.dash.ContentProtection=function(){},shaka.dash.ContentProtection.parseFromAdaptationSet=function(e,t,r){var n=shaka.dash.ContentProtection,a=shaka.util.ManifestParserUtils,i=n.parseElements_(e),o=null;e=[];var s=[],l=null,u=new Set(i.map((function(e){return e.keyId})));u.delete(null);var c="cenc";if(1<u.size)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_CONFLICTING_KEY_IDS);if(!t){if(1<(s=i.filter((function(e){return e.schemeUri==n.Aes128Protection_}))).length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_CONFLICTING_AES_128);s.length&&(l=n.parseAes128_(s[0])),(s=i.find((function(e){return e.schemeUri==n.MP4Protection_})))&&s.encryptionScheme&&(c=s.encryptionScheme),(s=i.filter((function(e){return e.schemeUri==n.MP4Protection_?(goog.asserts.assert(!e.init||e.init.length,"Init data must be null or non-empty."),o=e.init||o,!1):e.schemeUri!=n.Aes128Protection_}))).length&&(0==(e=n.convertElements_(o,c,s,r,u)).length&&(e=[a.createDrmInfo("",c,o)]))}if(i.length&&!l&&(t||!s.length))for(e=[],r=(t=$jscomp.makeIterator(Object.values(r))).next();!r.done;r=t.next())"org.w3.clearkey"!=(r=r.value)&&(r=a.createDrmInfo(r,c,o),e.push(r));if(a=Array.from(u)[0]||null)for(c=(u=$jscomp.makeIterator(e)).next();!c.done;c=u.next())for(t=(c=$jscomp.makeIterator(c.value.initData)).next();!t.done;t=c.next())t.value.keyId=a;return{defaultKeyId:a,defaultInit:o,drmInfos:e,aes128Info:l,firstRepresentation:!0}},shaka.dash.ContentProtection.parseFromRepresentation=function(e,t,r,n){var a=shaka.dash.ContentProtection.parseFromAdaptationSet(e,r,n);if(t.firstRepresentation)e=1==t.drmInfos.length&&!t.drmInfos[0].keySystem,r=0==a.drmInfos.length,(0==t.drmInfos.length||e&&!r)&&(t.drmInfos=a.drmInfos),t.firstRepresentation=!1;else if(0<a.drmInfos.length&&(t.drmInfos=t.drmInfos.filter((function(e){return a.drmInfos.some((function(t){return t.keySystem==e.keySystem}))})),0==t.drmInfos.length))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_COMMON_KEY_SYSTEM);return a.defaultKeyId||t.defaultKeyId},shaka.dash.ContentProtection.getWidevineLicenseUrl=function(e){var t=shaka.util.StringUtils,r=shaka.util.TXml.findChildNS(e.node,shaka.dash.ContentProtection.DashIfNamespaceUri_,"Laurl");return r&&(r=shaka.util.TXml.getTextContents(r))?r:(e=shaka.util.TXml.findChildNS(e.node,"urn:microsoft","laurl"))&&t.htmlUnescape(e.attributes.licenseUrl)||""},shaka.dash.ContentProtection.getClearKeyLicenseUrl=function(e){var t=shaka.util.TXml.findChildNS(e.node,shaka.dash.ContentProtection.DashIfNamespaceUri_,"Laurl");return t&&(t=shaka.util.TXml.getTextContents(t))?t:(e=shaka.util.TXml.findChildNS(e.node,shaka.dash.ContentProtection.ClearKeyNamespaceUri_,"Laurl"))&&"EME-1.0"===e.attributes.Lic_type&&e&&(e=shaka.util.TXml.getTextContents(e))?e:""},shaka.dash.ContentProtection.parseMsProRecords_=function(e,t){for(var r=[];t<e.byteLength-1;){var n=e.getUint16(t,!0);t+=2;var a=e.getUint16(t,!0);if(t+=2,0!=(1&a)||a+t>e.byteLength)return shaka.log.warning("Malformed MS PRO object"),[];var i=shaka.util.BufferUtils.toUint8(e,t,a);r.push({type:n,value:i}),t+=a}return r},shaka.dash.ContentProtection.parseMsPro_=function(e){var t=0,r=shaka.util.BufferUtils.toDataView(e),n=r.getUint32(t,!0);return t+=4,n!=e.byteLength?(shaka.log.warning("PlayReady Object with invalid length encountered."),[]):shaka.dash.ContentProtection.parseMsProRecords_(r,t+2)},shaka.dash.ContentProtection.getLaurl_=function(e){for(var t=(e=$jscomp.makeIterator(shaka.util.TXml.getElementsByTagName(e,"DATA"))).next();!t.done;t=e.next())if((t=t.value).children)for(var r=(t=$jscomp.makeIterator(t.children)).next();!r.done;r=t.next())if("LA_URL"==(r=r.value).tagName)return shaka.util.TXml.getTextContents(r);return""},shaka.dash.ContentProtection.getPlayReadyLicenseUrl=function(e){var t=shaka.util.TXml.findChildNS(e.node,shaka.dash.ContentProtection.DashIfNamespaceUri_,"Laurl");if(t&&(t=shaka.util.TXml.getTextContents(t)))return t;if(!(t=shaka.util.TXml.findChildNS(e.node,"urn:microsoft:playready","pro"))||!shaka.util.TXml.getTextContents(t))return"";var r=(e=shaka.dash.ContentProtection).PLAYREADY_RECORD_TYPES;return t=shaka.util.TXml.getTextContents(t),t=shaka.util.Uint8ArrayUtils.fromBase64(t),(t=e.parseMsPro_(t).filter((function(e){return e.type===r.RIGHTS_MANAGEMENT}))[0])?(t=shaka.util.StringUtils.fromUTF16(t.value,!0),(t=shaka.util.TXml.parseXmlString(t,"WRMHEADER"))?e.getLaurl_(t):""):""},shaka.dash.ContentProtection.getInitDataFromPro_=function(e){var t=shaka.util.TXml.findChildNS(e.node,"urn:microsoft:playready","pro");if(!t||!shaka.util.TXml.getTextContents(t))return null;var r=shaka.util.Uint8ArrayUtils;t=shaka.util.TXml.getTextContents(t),r=r.fromBase64(t),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);var n=new Set;return[{initData:shaka.util.Pssh.createPssh(r,t,n,0),initDataType:"cenc",keyId:e.keyId}]},shaka.dash.ContentProtection.getInitDataClearKey_=function(e,t){if(0==t.size)return null;var r=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]),n=new Uint8Array([]);return[{initData:shaka.util.Pssh.createPssh(n,r,t,1),initDataType:"cenc",keyId:e.keyId}]},shaka.dash.ContentProtection.convertElements_=function(e,t,r,n,a){for(var i=shaka.dash.ContentProtection,o=shaka.util.ManifestParserUtils,s=i.licenseUrlParsers_,l=[],u=(r=$jscomp.makeIterator(r)).next();!u.done;u=r.next()){var c=n[(u=u.value).schemeUri];if(c){goog.asserts.assert(!u.init||u.init.length,"Init data must be null or non-empty.");var d=i.getInitDataFromPro_(u),p=null;u.schemeUri===shaka.dash.ContentProtection.ClearKeySchemeUri_&&(p=i.getInitDataClearKey_(u,a)),d=o.createDrmInfo(c,t,u.init||e||d||p),(c=s.get(c))&&(d.licenseServerUri=c(u)),l.push(d)}}return l},shaka.dash.ContentProtection.parseElements_=function(e){for(var t=[],r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=shaka.dash.ContentProtection.parseElement_(r.value))&&t.push(r);return t},shaka.dash.ContentProtection.parseElement_=function(e){var t=shaka.dash.ContentProtection.CencNamespaceUri_,r=shaka.util.TXml,n=e.attributes.schemeIdUri,a=r.getAttributeNS(e,t,"default_KID");if(t=r.findChildrenNS(e,t,"pssh").map(r.getContents),r=e.attributes.value,!n)return shaka.log.error("Missing required schemeIdUri attribute on","ContentProtection element",e),null;if(n=n.toLowerCase(),a&&(a=a.replace(/-/g,"").toLowerCase()).includes(" "))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED);var i=[];try{i=t.map((function(e){return{initDataType:"cenc",initData:shaka.util.Uint8ArrayUtils.fromBase64(e),keyId:null}}))}catch(e){throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_PSSH_BAD_ENCODING)}return{node:e,schemeUri:n,keyId:a,init:0<i.length?i:null,encryptionScheme:r}},shaka.dash.ContentProtection.parseAes128_=function(e){if(!window.crypto||!window.crypto.subtle)throw shaka.log.alwaysWarn("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.NO_WEB_CRYPTO_API);var t=shaka.util.TXml.findChildNS(e.node,"urn:mpeg:dash:schema:sea:2012","SegmentEncryption");if(!t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_UNSUPPORTED_AES_128);if("urn:mpeg:dash:sea:aes128-cbc:2013"!=t.attributes.schemeIdUri)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_UNSUPPORTED_AES_128);if(!(t=shaka.util.TXml.findChildNS(e.node,"urn:mpeg:dash:schema:sea:2012","CryptoPeriod")))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_UNSUPPORTED_AES_128);if(e=t.attributes.IV,t=shaka.util.StringUtils.htmlUnescape(t.attributes.keyUriTemplate),!e||!t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_UNSUPPORTED_AES_128);if(16!=(e=shaka.util.Uint8ArrayUtils.fromHex(e.substr(2))).byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.AES_128_INVALID_IV_LENGTH);return{keyUri:t,iv:e}},shaka.dash.ContentProtection.PLAYREADY_RECORD_TYPES={RIGHTS_MANAGEMENT:1,RESERVED:2,EMBEDDED_LICENSE:3},shaka.dash.ContentProtection.licenseUrlParsers_=(new Map).set("com.widevine.alpha",shaka.dash.ContentProtection.getWidevineLicenseUrl).set("com.microsoft.playready",shaka.dash.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.recommendation",shaka.dash.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.software",shaka.dash.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.hardware",shaka.dash.ContentProtection.getPlayReadyLicenseUrl).set("org.w3.clearkey",shaka.dash.ContentProtection.getClearKeyLicenseUrl),shaka.dash.ContentProtection.MP4Protection_="urn:mpeg:dash:mp4protection:2011",shaka.dash.ContentProtection.Aes128Protection_="urn:mpeg:dash:sea:2012",shaka.dash.ContentProtection.CencNamespaceUri_="urn:mpeg:cenc:2013",shaka.dash.ContentProtection.ClearKeyNamespaceUri_="http://dashif.org/guidelines/clearKey",shaka.dash.ContentProtection.ClearKeySchemeUri_="urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e",shaka.dash.ContentProtection.DashIfNamespaceUri_="https://dashif.org/CPS",shaka.dash.MpdUtils=function(){},shaka.dash.MpdUtils.fillUriTemplate=function(e,t,r,n,a,i){var o={RepresentationID:t,Number:r,SubNumber:n,Bandwidth:a,Time:i};return e.replace(/\$(RepresentationID|Number|SubNumber|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(t,r,n,a){if("$$"==t)return"$";var i=o[r];if(goog.asserts.assert(void 0!==i,"Unrecognized identifier"),null==i)return shaka.log.warning("URL template does not have an available substitution for ",'identifier "'+r+'":',e),t;switch("RepresentationID"==r&&n&&(shaka.log.warning("URL template should not contain a width specifier for identifier",'"RepresentationID":',e),n=void 0),"Time"==r&&"bigint"!=typeof i&&(goog.asserts.assert("number"==typeof i,"Time value should be a number or bigint!"),.2<=Math.abs(i-Math.round(i))&&shaka.log.alwaysWarn("Calculated $Time$ values must be close to integers"),i=Math.round(i)),a){case void 0:case"d":case"i":case"u":t=i.toString();break;case"o":t=i.toString(8);break;case"x":t=i.toString(16);break;case"X":t=i.toString(16).toUpperCase();break;default:goog.asserts.assert(!1,"Unhandled format specifier"),t=i.toString()}return n=window.parseInt(n,10)||1,Array(Math.max(0,n-t.length)+1).join("0")+t}))},shaka.dash.MpdUtils.createTimeline=function(e,t,r,n,a){goog.asserts.assert(0<t&&1/0>t,"timescale must be a positive, finite integer"),goog.asserts.assert(0<n,"period duration must be a positive integer");var i=shaka.util.TXml;e=i.findChildren(e,"S");for(var o=[],s=-r,l=0;l<e.length;++l){var u=e[l],c=e[l+1],d=i.parseAttr(u,"t",i.parseNonNegativeInt),p=i.parseAttr(u,"d",i.parseNonNegativeInt),h=i.parseAttr(u,"r",i.parseInt),f=i.parseAttr(u,"k",i.parseInt)||0;if(null!=d&&(d-=r),!p){shaka.log.warning('"S" element must have a duration:','ignoring the remaining "S" elements.',u);break}if(d=null!=d?d:s,0>(h=h||0))if(c){if(null==(c=i.parseAttr(c,"t",i.parseNonNegativeInt))){shaka.log.warning('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',u);break}if(d>=c){shaka.log.warning('An "S" element cannot have a negative repeatif its start ','time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',u);break}h=Math.ceil((c-d)/p)-1}else{if(1/0==n){shaka.log.warning('The last "S" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "S" element.',u);break}if(d/t>=n){shaka.log.warning('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',u);break}h=Math.ceil((n*t-d)/p)-1}for(0<o.length&&d!=s&&(Math.abs((d-s)/t)>=shaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS&&shaka.log.warning("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",u),o[o.length-1].end=d/t),u=0;u<=h;++u)s=d+p,o.push({start:d/t,end:s/t,unscaledStart:d,partialSegments:f,segmentPosition:o.length+a}),d=s}return o},shaka.dash.MpdUtils.parseSegmentInfo=function(e,t){goog.asserts.assert(t(e.representation),"There must be at least one element of the given type.");var r=shaka.dash.MpdUtils,n=shaka.util.TXml,a=r.inheritAttribute(e,t,"timescale"),i=1;a&&(i=n.parsePositiveInt(a)||1),a=r.inheritAttribute(e,t,"duration"),(a=n.parsePositiveInt(a||""))&&(a/=i);var o=r.inheritAttribute(e,t,"startNumber"),s=Number(r.inheritAttribute(e,t,"presentationTimeOffset"))||0;return n=n.parseNonNegativeInt(o||""),null!=o&&null!=n||(n=1),o=null,(t=r.inheritChild(e,t,"SegmentTimeline"))&&(o=r.createTimeline(t,i,s,e.periodInfo.duration||1/0,n)),{timescale:i,segmentDuration:a,startNumber:n,scaledPresentationTimeOffset:s/i||0,unscaledPresentationTimeOffset:s,timeline:o}},shaka.dash.MpdUtils.getNodes=function(e,t){var r=shaka.util.Functional;return goog.asserts.assert(t(e.representation),"There must be at least one element of the given type"),[t(e.representation),t(e.adaptationSet),t(e.period)].filter(r.isNotNull)},shaka.dash.MpdUtils.inheritAttribute=function(e,t,r){t=shaka.dash.MpdUtils.getNodes(e,t),e=null;for(var n=(t=$jscomp.makeIterator(t)).next();!n.done&&!(e=n.value.attributes[r]);n=t.next());return e},shaka.dash.MpdUtils.inheritChild=function(e,t,r){var n=shaka.dash.MpdUtils.getNodes(e,t);e=shaka.util.TXml,t=null;for(var a=(n=$jscomp.makeIterator(n)).next();!a.done&&!(t=e.findChild(a.value,r));a=n.next());return t},shaka.dash.MpdUtils.handleXlinkInElement_=function(e,t,r,n,a,i){for(var o=shaka.util.TXml,s=shaka.util.Error,l=shaka.util.ManifestParserUtils,u=shaka.dash.MpdUtils.XlinkNamespaceUri_,c=o.getAttributeNS(e,u,"href"),d=o.getAttributeNS(e,u,"actuate")||"onRequest",p=$jscomp.makeIterator(Object.keys(e.attributes)),h=p.next();!h.done;h=p.next()){var f=(h=h.value).split(":"),m=shaka.util.TXml.getKnownNameSpace(u);f[0]==m&&delete e.attributes[h]}if(5<=i)return shaka.util.AbortableOperation.failed(new s(s.Severity.CRITICAL,s.Category.MANIFEST,s.Code.DASH_XLINK_DEPTH_LIMIT));if("onLoad"!=d)return shaka.util.AbortableOperation.failed(new s(s.Severity.CRITICAL,s.Category.MANIFEST,s.Code.DASH_UNSUPPORTED_XLINK_ACTUATE));var g=l.resolveUris([n],[c]);return n=shaka.net.NetworkingEngine.RequestType.MANIFEST,l=shaka.net.NetworkingEngine.makeRequest(g,t),n=a.request(n,l),goog.asserts.assert(n instanceof shaka.util.AbortableOperation,"Unexpected implementation of IAbortableOperation!"),n.chain((function(n){if(!(n=o.parseXml(n.data,e.tagName)))return shaka.util.AbortableOperation.failed(new s(s.Severity.CRITICAL,s.Category.MANIFEST,s.Code.DASH_INVALID_XML,c));for(e.children=[];n.children.length;){var l=n.children.shift();o.isNode(l)&&(l.parent=e),e.children.push(l)}for(var u=(l=$jscomp.makeIterator(Object.keys(n.attributes))).next();!u.done;u=l.next())u=u.value,e.attributes[u]=n.attributes[u];return shaka.dash.MpdUtils.processXlinks(e,t,r,g[0],a,i+1)}))},shaka.dash.MpdUtils.processXlinks=function(e,t,r,n,a,i){i=void 0===i?0:i;var o=shaka.dash.MpdUtils,s=shaka.util.TXml,l=o.XlinkNamespaceUri_;if(s.getAttributeNS(e,l,"href"))return s=o.handleXlinkInElement_(e,t,r,n,a,i),r&&(s=s.chain(void 0,(function(s){return o.processXlinks(e,t,r,n,a,i)}))),s;for(var u=[],c={},d=$jscomp.makeIterator(shaka.util.TXml.getChildNodes(e)),p=d.next();!p.done;c={$jscomp$loop$prop$child$893:c.$jscomp$loop$prop$child$893},p=d.next())c.$jscomp$loop$prop$child$893=p.value,"urn:mpeg:dash:resolve-to-zero:2013"==s.getAttributeNS(c.$jscomp$loop$prop$child$893,l,"href")?e.children=e.children.filter(function(e){return function(t){return t!==e.$jscomp$loop$prop$child$893}}(c)):"SegmentTimeline"!=c.$jscomp$loop$prop$child$893.tagName&&u.push(shaka.dash.MpdUtils.processXlinks(c.$jscomp$loop$prop$child$893,t,r,n,a,i));return shaka.util.AbortableOperation.all(u).chain((function(){return e}))},shaka.dash.MpdUtils.XlinkNamespaceUri_="http://www.w3.org/1999/xlink",shaka.media.Mp4SegmentIndexParser=function(){},shaka.media.Mp4SegmentIndexParser.parse=function(e,t,r,n,a,i,o){var s,l=shaka.media.Mp4SegmentIndexParser,u=(new shaka.util.Mp4Parser).fullBox("sidx",(function(e){s=l.parseSIDX_(t,n,a,i,o,r,e)}));if(e&&u.parse(e),s)return s;throw shaka.log.error('Invalid box type, expected "sidx".'),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MP4_SIDX_WRONG_BOX_TYPE)},shaka.media.Mp4SegmentIndexParser.parseSIDX_=function(e,t,r,n,a,i,o){goog.asserts.assert(null!=o.version,"SIDX is a full box and should have a valid version.");var s=[];o.reader.skip(4);var l=o.reader.readUint32();if(0==l)throw shaka.log.error("Invalid timescale."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MP4_SIDX_INVALID_TIMESCALE);if(0==o.version)var u=o.reader.readUint32(),c=o.reader.readUint32();else u=o.reader.readUint64(),c=o.reader.readUint64();o.reader.skip(2);var d=o.reader.readUint16();for(e=e+o.size+c,c=0;c<d;c++){var p=o.reader.readUint32(),h=(2147483648&p)>>>31;p&=2147483647;var f=o.reader.readUint32();if(o.reader.skip(4),1==h)throw shaka.log.error("Heirarchical SIDXs are not supported."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MP4_SIDX_TYPE_NOT_SUPPORTED);s.push(new shaka.media.SegmentReference(u/l+r,(u+f)/l+r,(function(){return i}),e,e+p-1,t,r,n,a)),u+=f,e+=p}return o.parser.stop(),s},shaka.util.EbmlParser=function(e){this.dataView_=shaka.util.BufferUtils.toDataView(e),this.reader_=new shaka.util.DataViewReader(this.dataView_,shaka.util.DataViewReader.Endianness.BIG_ENDIAN)},shaka.util.EbmlParser.prototype.hasMoreData=function(){return this.reader_.hasMoreData()},shaka.util.EbmlParser.prototype.parseElement=function(){var e=this.parseId_(),t=this.parseVint_();t=shaka.util.EbmlParser.isDynamicSizeValue_(t)?this.dataView_.byteLength-this.reader_.getPosition():shaka.util.EbmlParser.getVintValue_(t),t=this.reader_.getPosition()+t<=this.dataView_.byteLength?t:this.dataView_.byteLength-this.reader_.getPosition();var r=shaka.util.BufferUtils.toDataView(this.dataView_,this.reader_.getPosition(),t);return this.reader_.skip(t),new shaka.util.EbmlElement(e,r)},shaka.util.EbmlParser.prototype.parseId_=function(){var e=this.parseVint_();if(7<e.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.EBML_OVERFLOW);for(var t=0,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())t=256*t+r.value;return t},shaka.util.EbmlParser.prototype.parseVint_=function(){var e=this.reader_.getPosition(),t=this.reader_.readUint8();if(0==t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.EBML_OVERFLOW);return t=8-Math.floor(Math.log2(t)),goog.asserts.assert(8>=t&&1<=t,"Incorrect log2 value"),this.reader_.skip(t-1),shaka.util.BufferUtils.toUint8(this.dataView_,e,t)},shaka.util.EbmlParser.getVintValue_=function(e){if(8==e.length&&224&e[1])throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.JS_INTEGER_OVERFLOW);for(var t=0,r=0;r<e.length;r++){var n=e[r];t=0==r?n&(1<<8-e.length)-1:256*t+n}return t},shaka.util.EbmlParser.isDynamicSizeValue_=function(e){for(var t=shaka.util.BufferUtils,r=$jscomp.makeIterator(shaka.util.EbmlParser.DYNAMIC_SIZES),n=r.next();!n.done;n=r.next())if(t.equal(e,new Uint8Array(n.value)))return!0;return!1},shaka.util.EbmlParser.DYNAMIC_SIZES=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]],shaka.util.EbmlElement=function(e,t){this.id=e,this.dataView_=t},shaka.util.EbmlElement.prototype.getOffset=function(){return this.dataView_.byteOffset},shaka.util.EbmlElement.prototype.createParser=function(){return new shaka.util.EbmlParser(this.dataView_)},shaka.util.EbmlElement.prototype.getUint=function(){if(8<this.dataView_.byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.EBML_OVERFLOW);if(8==this.dataView_.byteLength&&224&this.dataView_.getUint8(0))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.JS_INTEGER_OVERFLOW);for(var e=0,t=0;t<this.dataView_.byteLength;t++){e=256*e+this.dataView_.getUint8(t)}return e},shaka.util.EbmlElement.prototype.getFloat=function(){if(4==this.dataView_.byteLength)return this.dataView_.getFloat32(0);if(8==this.dataView_.byteLength)return this.dataView_.getFloat64(0);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.EBML_BAD_FLOATING_POINT_SIZE)},shaka.media.WebmSegmentIndexParser=function(){},shaka.media.WebmSegmentIndexParser.parse=function(e,t,r,n,a,i,o){if(t=shaka.media.WebmSegmentIndexParser.parseWebmContainer_(t),(e=new shaka.util.EbmlParser(e).parseElement()).id!=shaka.media.WebmSegmentIndexParser.CUES_ID)throw shaka.log.error("Not a Cues element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_CUES_ELEMENT_MISSING);return shaka.media.WebmSegmentIndexParser.parseCues_(e,t.segmentOffset,t.timecodeScale,t.duration,r,n,a,i,o)},shaka.media.WebmSegmentIndexParser.parseWebmContainer_=function(e){if((e=new shaka.util.EbmlParser(e)).parseElement().id!=shaka.media.WebmSegmentIndexParser.EBML_ID)throw shaka.log.error("Not an EBML element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_EBML_HEADER_ELEMENT_MISSING);var t=e.parseElement();if(t.id!=shaka.media.WebmSegmentIndexParser.SEGMENT_ID)throw shaka.log.error("Not a Segment element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_SEGMENT_ELEMENT_MISSING);return{segmentOffset:e=t.getOffset(),timecodeScale:(t=shaka.media.WebmSegmentIndexParser.parseSegment_(t)).timecodeScale,duration:t.duration}},shaka.media.WebmSegmentIndexParser.parseSegment_=function(e){e=e.createParser();for(var t=null;e.hasMoreData();){var r=e.parseElement();if(r.id==shaka.media.WebmSegmentIndexParser.INFO_ID){t=r;break}}if(!t)throw shaka.log.error("Not an Info element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_INFO_ELEMENT_MISSING);return shaka.media.WebmSegmentIndexParser.parseInfo_(t)},shaka.media.WebmSegmentIndexParser.parseInfo_=function(e){var t=e.createParser(),r=1e6;for(e=null;t.hasMoreData();){var n=t.parseElement();n.id==shaka.media.WebmSegmentIndexParser.TIMECODE_SCALE_ID?r=n.getUint():n.id==shaka.media.WebmSegmentIndexParser.DURATION_ID&&(e=n.getFloat())}if(null==e)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_DURATION_ELEMENT_MISSING);return{timecodeScale:t=r/1e9,duration:e*t}},shaka.media.WebmSegmentIndexParser.parseCues_=function(e,t,r,n,a,i,o,s,l){var u=[],c=function(){return a};e=e.createParser();for(var d=null,p=null;e.hasMoreData();){var h=e.parseElement();if(h.id==shaka.media.WebmSegmentIndexParser.CUE_POINT_ID){var f=shaka.media.WebmSegmentIndexParser.parseCuePoint_(h);f&&(h=r*f.unscaledTime,f=t+f.relativeOffset,null!=d&&(goog.asserts.assert(null!=p,"last offset cannot be null"),u.push(new shaka.media.SegmentReference(d+o,h+o,c,p,f-1,i,o,s,l))),d=h,p=f)}}return null!=d&&(goog.asserts.assert(null!=p,"last offset cannot be null"),u.push(new shaka.media.SegmentReference(d+o,n+o,c,p,null,i,o,s,l))),u},shaka.media.WebmSegmentIndexParser.parseCuePoint_=function(e){var t=e.createParser();if((e=t.parseElement()).id!=shaka.media.WebmSegmentIndexParser.CUE_TIME_ID)throw shaka.log.warning("Not a CueTime element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_CUE_TIME_ELEMENT_MISSING);if(e=e.getUint(),(t=t.parseElement()).id!=shaka.media.WebmSegmentIndexParser.CUE_TRACK_POSITIONS_ID)throw shaka.log.warning("Not a CueTrackPositions element."),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING);t=t.createParser();for(var r=0;t.hasMoreData();){var n=t.parseElement();if(n.id==shaka.media.WebmSegmentIndexParser.CUE_CLUSTER_POSITION){r=n.getUint();break}}return{unscaledTime:e,relativeOffset:r}},shaka.media.WebmSegmentIndexParser.EBML_ID=440786851,shaka.media.WebmSegmentIndexParser.SEGMENT_ID=408125543,shaka.media.WebmSegmentIndexParser.INFO_ID=357149030,shaka.media.WebmSegmentIndexParser.TIMECODE_SCALE_ID=2807729,shaka.media.WebmSegmentIndexParser.DURATION_ID=17545,shaka.media.WebmSegmentIndexParser.CUES_ID=475249515,shaka.media.WebmSegmentIndexParser.CUE_POINT_ID=187,shaka.media.WebmSegmentIndexParser.CUE_TIME_ID=179,shaka.media.WebmSegmentIndexParser.CUE_TRACK_POSITIONS_ID=183,shaka.media.WebmSegmentIndexParser.CUE_CLUSTER_POSITION=241,shaka.dash.SegmentBase=function(){},shaka.dash.SegmentBase.createInitSegment=function(e,t,r){var n=shaka.util.TXml,a=shaka.util.ManifestParserUtils,i=shaka.util.StringUtils;if(!(t=shaka.dash.MpdUtils.inheritChild(e,t,"Initialization")))return null;var o=e.representation.getBaseUris(),s=t.attributes.sourceURL;return s&&(o=a.resolveUris(o,[i.htmlUnescape(s)])),a=0,i=null,(n=n.parseAttr(t,"range",n.parseRange))&&(a=n.start,i=n.end),n=shaka.dash.SegmentBase.createQualityInfo(e),(r=new shaka.media.InitSegmentReference((function(){return o}),a,i,n,null,null,r)).codecs=e.representation.codecs,r.mimeType=e.representation.mimeType,r},shaka.dash.SegmentBase.createStreamInfo=function(e,t,r){goog.asserts.assert(e.representation.segmentBase,"Should only be called with SegmentBase");var n=shaka.dash.MpdUtils,a=shaka.dash.SegmentBase,i=shaka.util.TXml,o=Number(n.inheritAttribute(e,a.fromInheritance_,"presentationTimeOffset"))||0,s=1;(n=n.inheritAttribute(e,a.fromInheritance_,"timescale"))&&(s=i.parsePositiveInt(n)||1);var l=o/s||0,u=a.createInitSegment(e,a.fromInheritance_,r);a.checkSegmentIndexRangeSupport_(e,u);var c=shaka.util.ObjectUtils.shallowCloneObject(e);return{generateSegmentIndex:function(){return a.generateSegmentIndex_(c,t,u,l)}}},shaka.dash.SegmentBase.generateSegmentIndexFromUris=function(e,t,r,n,a,i,o){var s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A;return $jscomp.asyncExecutePromiseGeneratorProgram((function(S){if(1==S.nextAddress)return s=e.presentationTimeline,l=!e.dynamic||!e.periodInfo.isLastPeriod,u=e.periodInfo.start,c=e.periodInfo.duration,d=e.representation.mimeType.split("/")[1],h=null,f=[(p=t)(n,a,i,!1),"webm"==d?p(r.getUris(),r.startByte,r.endByte,!0):null],p=null,S.yield(Promise.all(f),2);for(m=S.yieldResult,g=m[0],y=m[1]||null,v=null,_=u-o,k=u,E=c?u+c:1/0,"mp4"==d?v=shaka.media.Mp4SegmentIndexParser.parse(g,a,n,r,_,k,E):(goog.asserts.assert(y,"WebM requires init data"),v=shaka.media.WebmSegmentIndexParser.parse(g,y,n,r,_,k,E)),b=$jscomp.makeIterator(v),T=b.next();!T.done;T=b.next())(A=T.value).codecs=e.representation.codecs,A.mimeType=e.representation.mimeType;return s.notifySegments(v),goog.asserts.assert(!h,"Should not call generateSegmentIndex twice"),h=new shaka.media.SegmentIndex(v),l&&h.fit(k,E,!0),S.return(h)}))},shaka.dash.SegmentBase.fromInheritance_=function(e){return e.segmentBase},shaka.dash.SegmentBase.computeIndexRange_=function(e){var t=shaka.dash.MpdUtils,r=shaka.dash.SegmentBase,n=shaka.util.TXml,a=t.inheritChild(e,r.fromInheritance_,"RepresentationIndex");return e=t.inheritAttribute(e,r.fromInheritance_,"indexRange"),e=n.parseRange(e||""),a&&(e=n.parseAttr(a,"range",n.parseRange,e)),e},shaka.dash.SegmentBase.computeIndexUris_=function(e){var t=shaka.util.ManifestParserUtils,r=shaka.util.StringUtils,n=shaka.dash.MpdUtils.inheritChild(e,shaka.dash.SegmentBase.fromInheritance_,"RepresentationIndex");return e=e.representation.getBaseUris(),n&&(r=r.htmlUnescape(n.attributes.sourceURL))&&(e=t.resolveUris(e,[r])),e},shaka.dash.SegmentBase.checkSegmentIndexRangeSupport_=function(e,t){var r=shaka.dash.SegmentBase;if(r.checkSegmentIndexSupport(e,t),!r.computeIndexRange_(e))throw shaka.log.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)},shaka.dash.SegmentBase.checkSegmentIndexSupport=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType,n=e.representation.contentType,a=e.representation.mimeType.split("/")[1];if(n!=r.TEXT&&"mp4"!=a&&"webm"!=a)throw shaka.log.error("SegmentBase specifies an unsupported container type.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_UNSUPPORTED_CONTAINER);if("webm"==a&&!t)throw shaka.log.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_WEBM_MISSING_INIT)},shaka.dash.SegmentBase.generateSegmentIndex_=function(e,t,r,n){var a=shaka.dash.SegmentBase,i=a.computeIndexUris_(e);return a=a.computeIndexRange_(e),goog.asserts.assert(a,"Index range should not be null!"),shaka.dash.SegmentBase.generateSegmentIndexFromUris(e,t,r,i,a.start,a.end,n)},shaka.dash.SegmentBase.createQualityInfo=function(e){var t=e.representation;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.numChannels,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null}},shaka.dash.SegmentList=function(){},shaka.dash.SegmentList.createStreamInfo=function(e,t,r){goog.asserts.assert(e.representation.segmentList,"Should only be called with SegmentList");var n=shaka.dash.SegmentList,a=shaka.dash.SegmentBase.createInitSegment(e,n.fromInheritance_,r),i=n.parseSegmentListInfo_(e);n.checkSegmentListInfo_(e,i);var o=null,s=null;e.period.id&&e.representation.id&&(s=t[e.period.id+","+e.representation.id])&&(o=s.segmentIndex);var l=n.createSegmentReferences_(e.periodInfo.start,e.periodInfo.duration,i.startNumber,e.representation.getBaseUris,i,a,r,e.representation.mimeType,e.representation.codecs);return t=!o,o?(r=e.presentationTimeline.getSegmentAvailabilityStart(),o.mergeAndEvict(l,r)):o=new shaka.media.SegmentIndex(l),e.presentationTimeline.notifySegments(l),e.dynamic&&e.periodInfo.isLastPeriod||o.fit(e.periodInfo.start,e.periodInfo.duration?e.periodInfo.start+e.periodInfo.duration:1/0,t),s&&(s.segmentIndex=o),{generateSegmentIndex:function(){return o&&!o.isEmpty()||o.merge(l),Promise.resolve(o)}}},shaka.dash.SegmentList.fromInheritance_=function(e){return e.segmentList},shaka.dash.SegmentList.parseSegmentListInfo_=function(e){var t=shaka.dash.SegmentList,r=shaka.dash.MpdUtils,n=t.parseMediaSegments_(e);return 0==(t=(e=r.parseSegmentInfo(e,t.fromInheritance_)).startNumber)&&(shaka.log.warning("SegmentList@startNumber must be > 0"),t=1),r=0,e.segmentDuration?r=e.segmentDuration*(t-1):e.timeline&&0<e.timeline.length&&(r=e.timeline[0].start),{segmentDuration:e.segmentDuration,startTime:r,startNumber:t,scaledPresentationTimeOffset:e.scaledPresentationTimeOffset,timeline:e.timeline,mediaSegments:n}},shaka.dash.SegmentList.checkSegmentListInfo_=function(e,t){if(!t.segmentDuration&&!t.timeline&&1<t.mediaSegments.length)throw shaka.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);if(!t.segmentDuration&&!e.periodInfo.duration&&!t.timeline&&1==t.mediaSegments.length)throw shaka.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);if(t.timeline&&0==t.timeline.length)throw shaka.log.warning("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)},shaka.dash.SegmentList.createSegmentReferences_=function(e,t,r,n,a,i,o,s,l){var u=shaka.util.ManifestParserUtils;r=a.mediaSegments.length,a.timeline&&a.timeline.length!=a.mediaSegments.length&&(r=Math.min(a.timeline.length,a.mediaSegments.length),shaka.log.warning("The number of items in the segment timeline and the number of ","segment URLs do not match, truncating",a.mediaSegments.length,"to",r));for(var c=e-a.scaledPresentationTimeOffset,d=t?e+t:1/0,p=[],h=a.startTime,f={},m=0;m<r;f={$jscomp$loop$prop$uris$895:f.$jscomp$loop$prop$uris$895,$jscomp$loop$prop$segment$896:f.$jscomp$loop$prop$segment$896},m++){f.$jscomp$loop$prop$segment$896=a.mediaSegments[m];var g=h;h=void 0,null!=a.segmentDuration?h=g+a.segmentDuration:a.timeline?h=a.timeline[m].end:(goog.asserts.assert(1==a.mediaSegments.length&&t,"There should be exactly one segment with a Period duration."),h=g+t),f.$jscomp$loop$prop$uris$895=null;var y=function(e){return function(){return null==e.$jscomp$loop$prop$uris$895&&(e.$jscomp$loop$prop$uris$895=u.resolveUris(n(),[e.$jscomp$loop$prop$segment$896.mediaUri])),e.$jscomp$loop$prop$uris$895}}(f);(g=new shaka.media.SegmentReference(e+g,e+h,y,f.$jscomp$loop$prop$segment$896.start,f.$jscomp$loop$prop$segment$896.end,i,c,e,d,[],"",null,null,shaka.media.SegmentReference.Status.AVAILABLE,o)).codecs=l,g.mimeType=s,p.push(g)}return p},shaka.dash.SegmentList.parseMediaSegments_=function(e){var t=[e.representation.segmentList,e.adaptationSet.segmentList,e.period.segmentList].filter(shaka.util.Functional.isNotNull),r=shaka.util.TXml,n=shaka.util.StringUtils;return t.map((function(e){return r.findChildren(e,"SegmentURL")})).reduce((function(e,t){return 0<e.length?e:t})).map((function(t){return t.attributes.indexRange&&!e.indexRangeWarningGiven&&(e.indexRangeWarningGiven=!0,shaka.log.warning("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate.")),{mediaUri:n.htmlUnescape(t.attributes.media),start:(t=r.parseAttr(t,"mediaRange",r.parseRange,{start:0,end:null})).start,end:t.end}}))},shaka.dash.SegmentTemplate=function(){},shaka.dash.SegmentTemplate.createStreamInfo=function(e,t,r,n,a,i,o,s){goog.asserts.assert(e.representation.segmentTemplate,"Should only be called with SegmentTemplate");var l=shaka.dash.SegmentTemplate,u=shaka.dash.TimelineSegmentIndex,c=l.createInitSegment_(e,o),d=l.parseSegmentTemplateInfo_(e);l.checkSegmentTemplateInfo_(e,d);var p=shaka.util.ObjectUtils.shallowCloneObject(e);if(d.indexTemplate)return shaka.dash.SegmentBase.checkSegmentIndexSupport(e,c),{generateSegmentIndex:function(){return l.generateSegmentIndexFromIndexTemplate_(p,t,c,d)}};if(d.segmentDuration)return n||"image"===e.adaptationSet.contentType||(e.presentationTimeline.notifyMaxSegmentDuration(d.segmentDuration),e.presentationTimeline.notifyMinSegmentStartTime(e.periodInfo.start)),{generateSegmentIndex:function(){return l.generateSegmentIndexFromDuration_(p,d,a,c,i,o,s)}};var h=null;n=n=null,e.period.id&&e.representation.id&&(n=r[n=e.period.id+","+e.representation.id])&&(h=n.segmentIndex);var f=e.periodInfo.start,m=e.periodInfo.duration?f+e.periodInfo.duration:1/0;shaka.log.debug("New manifest "+f+" - "+m);var g=!(e.dynamic&&e.periodInfo.isLastPeriod);return h?((r=h).appendTemplateInfo(d,f,m,g,c),u=e.presentationTimeline.getSegmentAvailabilityStart(),r.evict(u)):(shaka.log.debug("Creating TSI with end "+m),h=new u(d,e.representation.id,e.bandwidth,e.representation.getBaseUris,f,m,c,g,o,e.representation.segmentSequenceCadence)),d.timeline&&"image"!==e.adaptationSet.contentType&&e.presentationTimeline.notifyTimeRange(d.timeline,f),n&&e.dynamic&&(n.segmentIndex=h),{generateSegmentIndex:function(){return h instanceof shaka.dash.TimelineSegmentIndex&&h.isEmpty()&&h.appendTemplateInfo(d,f,m,g,c),Promise.resolve(h)}}},shaka.dash.SegmentTemplate.fromInheritance_=function(e){return e.segmentTemplate},shaka.dash.SegmentTemplate.parseSegmentTemplateInfo_=function(e){var t=shaka.dash.SegmentTemplate,r=shaka.dash.MpdUtils,n=shaka.util.StringUtils,a=r.parseSegmentInfo(e,t.fromInheritance_),i=r.inheritAttribute(e,t.fromInheritance_,"media");return t=r.inheritAttribute(e,t.fromInheritance_,"index"),{segmentDuration:a.segmentDuration,timescale:a.timescale,startNumber:a.startNumber,scaledPresentationTimeOffset:a.scaledPresentationTimeOffset,unscaledPresentationTimeOffset:a.unscaledPresentationTimeOffset,timeline:a.timeline,mediaTemplate:i&&n.htmlUnescape(i),indexTemplate:t,mimeType:e.representation.mimeType,codecs:e.representation.codecs}},shaka.dash.SegmentTemplate.checkSegmentTemplateInfo_=function(e,t){var r=t.indexTemplate?1:0;if(r+=t.timeline?1:0,0==(r+=t.segmentDuration?1:0))throw shaka.log.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO);if(1!=r&&(shaka.log.warning("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",e.representation),t.indexTemplate?(shaka.log.info("Using the index URL template by default."),t.timeline=null):(goog.asserts.assert(t.timeline,"There should be a timeline"),shaka.log.info("Using the SegmentTimeline by default.")),t.segmentDuration=null),!t.indexTemplate&&!t.mediaTemplate)throw shaka.log.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",e.representation),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)},shaka.dash.SegmentTemplate.generateSegmentIndexFromIndexTemplate_=function(e,t,r,n){var a=shaka.dash.MpdUtils,i=shaka.util.ManifestParserUtils;return goog.asserts.assert(n.indexTemplate,"must be using index template"),a=a.fillUriTemplate(n.indexTemplate,e.representation.id,null,null,e.bandwidth||null,null),i=i.resolveUris(e.representation.getBaseUris(),[a]),shaka.dash.SegmentBase.generateSegmentIndexFromUris(e,t,r,i,0,null,n.scaledPresentationTimeOffset)},shaka.dash.SegmentTemplate.generateSegmentIndexFromDuration_=function(e,t,r,n,a,i,o){goog.asserts.assert(t.mediaTemplate,"There should be a media template with duration");var s=shaka.dash.MpdUtils,l=shaka.util.ManifestParserUtils,u=e.presentationTimeline,c=e.periodInfo.start,d=e.period.id,p=e.periodInfo.duration,h=function(){var e=null!=d&&a[d]||p;return e?c+e:1/0},f=t.segmentDuration;goog.asserts.assert(null!=f,"Segment duration must not be null!");var m=t.startNumber,g=t.timescale,y=t.mediaTemplate,v=e.bandwidth||null,_=e.representation.id,k=e.representation.getBaseUris,E=c-t.scaledPresentationTimeOffset,b=function(){var t=[Math.max(u.getSegmentAvailabilityStart(),c),Math.min(u.getSegmentAvailabilityEnd(),h())];return goog.asserts.assert(t.every(isFinite),"Available presentation times must be finite!"),goog.asserts.assert(t.every((function(e){return 0<=e})),"Available presentation times must be positive!"),goog.asserts.assert(null!=f,"Segment duration must not be null!"),t=t.map((function(e){return e-c})),t=[Math.ceil(t[0]/f),Math.ceil(t[1]/f)-1],e.representation.availabilityTimeOffset&&t[1]++,t.map((function(e){return e+m}))},T=b();r=e.dynamic?Math.max(T[0],T[1]-r+1):T[0],o=o||T[1],T=[];for(var A=function(r){goog.asserts.assert(null!=f,"Segment duration must not be null!");var a=(r-m)*f,o=a+t.scaledPresentationTimeOffset,u=a+c;a=u+f;var d=Math.min(a,h());return goog.asserts.assert(u<d,"Generated a segment outside of the period!"),(u=new shaka.media.SegmentReference(u,d,(function(){var e=o*g;return"BigInt"in window&&e>Number.MAX_SAFE_INTEGER&&(e=BigInt(o)*BigInt(g)),e=s.fillUriTemplate(y,_,r,null,v,e),l.resolveUris(k(),[e])}),0,null,n,E,c,h(),[],"",null,null,shaka.media.SegmentReference.Status.AVAILABLE,i)).codecs=e.representation.codecs,u.mimeType=e.representation.mimeType,u.trueEndTime=a,u},S=r;S<=o;++S){var C=A(S);T.push(C)}var P=new shaka.media.SegmentIndex(T);if(T=u.getSegmentAvailabilityEnd()<h(),S=u.isLive(),T||S){var x=Math.max(r,o+1);r=f,e.representation.availabilityTimeOffset&&(r=.1),P.updateEvery(r,(function(){var e=u.getSegmentAvailabilityStart();P.evict(e);var t=$jscomp.makeIterator(b());t.next(),t=t.next().value;for(var r=[];x<=t;){var n=A(x);r.push(n),x++}return e>h()&&!r.length?null:r}))}return Promise.resolve(P)},shaka.dash.SegmentTemplate.createInitSegment_=function(e,t){var r=shaka.dash.MpdUtils,n=shaka.util.ManifestParserUtils,a=r.inheritAttribute(e,shaka.dash.SegmentTemplate.fromInheritance_,"initialization");if(!a)return null;a=shaka.util.StringUtils.htmlUnescape(a);var i=e.representation.id,o=e.bandwidth||null,s=e.representation.getBaseUris,l=shaka.dash.SegmentBase.createQualityInfo(e);return(t=new shaka.media.InitSegmentReference((function(){goog.asserts.assert(a,"Should have returned earler");var e=r.fillUriTemplate(a,i,null,null,o,null);return n.resolveUris(s(),[e])}),0,null,l,null,null,t)).codecs=e.representation.codecs,t.mimeType=e.representation.mimeType,t},shaka.dash.TimelineSegmentIndex=function(e,t,r,n,a,i,o,s,l,u){shaka.media.SegmentIndex.call(this,[]),this.templateInfo_=e,this.representationId_=t,this.bandwidth_=r,this.getBaseUris_=n,this.periodStart_=a,this.periodEnd_=i,this.initSegmentReference_=o,this.aesKey_=l,this.segmentSequenceCadence_=u,s&&this.fitTimeline()},$jscomp.inherits(shaka.dash.TimelineSegmentIndex,shaka.media.SegmentIndex),shaka.dash.TimelineSegmentIndex.prototype.getNumReferences=function(){return this.templateInfo_?this.templateInfo_.timeline.length:0},shaka.dash.TimelineSegmentIndex.prototype.release=function(){shaka.media.SegmentIndex.prototype.release.call(this),this.templateInfo_=null},shaka.dash.TimelineSegmentIndex.prototype.evict=function(e){if(this.templateInfo_){shaka.log.debug(this.representationId_+" Evicting at "+e);for(var t=0,r=this.templateInfo_.timeline,n=0;n<r.length;n+=1){var a=r[n],i=a.end+this.periodStart_;if(a=a.start+this.periodStart_,!(i<=e))break;shaka.log.debug("Evicting "+a+" - "+i),t+=1}0<t&&(this.templateInfo_.timeline=r.slice(t),this.references.length>=t&&(this.references=this.references.slice(t)),this.numEvicted_+=t,0===this.getNumReferences()&&this.release())}},shaka.dash.TimelineSegmentIndex.prototype.appendTemplateInfo=function(e,t,r,n,a){if(this.updateInitSegmentReference(a),this.templateInfo_){t=this.templateInfo_.timeline,this.templateInfo_.mediaTemplate=e.mediaTemplate;var i=t[t.length-1];0<(e=e.timeline.filter((function(e){return e.start>=i.end}))).length&&(shaka.log.debug("Appending "+e.length+" entries"),this.templateInfo_.timeline.push.apply(this.templateInfo_.timeline,$jscomp.arrayFromIterable(e))),this.periodEnd_!==r&&(this.periodEnd_=r)}else this.templateInfo_=e,this.periodStart_=t,this.periodEnd_=r;n&&this.fitTimeline()},shaka.dash.TimelineSegmentIndex.prototype.updateInitSegmentReference=function(e){if(this.initSegmentReference_!==e){this.initSegmentReference_=e;for(var t=$jscomp.makeIterator(this.references),r=t.next();!r.done;r=t.next())(r=r.value)&&r.updateInitSegmentReference(e)}},shaka.dash.TimelineSegmentIndex.prototype.isBeforeFirstEntry=function(e){return!!(this.templateInfo_&&this.templateInfo_.timeline&&this.templateInfo_.timeline.length)&&e<this.templateInfo_.timeline[0].start+this.periodStart_},shaka.dash.TimelineSegmentIndex.prototype.fitTimeline=function(){if(!this.getIsImmutable()){for(var e=this.templateInfo_.timeline;e.length&&e[e.length-1].start>=this.periodEnd_;)e.pop();this.evict(this.periodStart_)}},shaka.dash.TimelineSegmentIndex.prototype.find=function(e){if(shaka.log.debug("Find "+e),this.isBeforeFirstEntry(e))return this.numEvicted_;if(!this.templateInfo_)return null;var t=this.templateInfo_.timeline;if(e<this.periodStart_||e>=this.periodEnd_)return null;for(var r=t.length-1,n=0;n<t.length;n++){var a=t[n],i=a.start+this.periodStart_;if(a=n<r?t[n+1].start+this.periodStart_:1/0===this.periodEnd_?a.end+this.periodStart_:this.periodEnd_,e>=i&&e<a)return n+this.numEvicted_}return null},shaka.dash.TimelineSegmentIndex.prototype.get=function(e){var t=this;if(0>(e-=this.numEvicted_)||e>=this.getNumReferences()||!this.templateInfo_)return null;var r=this.references[e];if(!r){var n=this.templateInfo_.mediaTemplate,a=this.templateInfo_.timeline[e],i=a.segmentPosition,o=this.templateInfo_.unscaledPresentationTimeOffset+a.unscaledStart;r=this.periodStart_-this.templateInfo_.scaledPresentationTimeOffset;var s=this.periodStart_+a.end,l=s;e===this.getNumReferences()-1&&1/0!==this.periodEnd_&&(l=this.periodEnd_);for(var u=this.templateInfo_.codecs,c=this.templateInfo_.mimeType,d=[],p=(a.end-a.start)/a.partialSegments,h={},f=0;f<a.partialSegments;h={$jscomp$loop$prop$uris$898:h.$jscomp$loop$prop$uris$898,$jscomp$loop$prop$subNumber$899:h.$jscomp$loop$prop$subNumber$899},f++){var m=a.start+p*f,g=m+p;h.$jscomp$loop$prop$subNumber$899=f+1,h.$jscomp$loop$prop$uris$898=null;var y=function(e){return function(){return t.templateInfo_?(null==e.$jscomp$loop$prop$uris$898&&(e.$jscomp$loop$prop$uris$898=shaka.dash.TimelineSegmentIndex.createUris_(t.templateInfo_.mediaTemplate,t.representationId_,i,t.bandwidth_,o,e.$jscomp$loop$prop$subNumber$899,t.getBaseUris_)),e.$jscomp$loop$prop$uris$898):[]}}(h);(m=new shaka.media.SegmentReference(this.periodStart_+m,this.periodStart_+g,y,0,null,this.initSegmentReference_,r,this.periodStart_,this.periodEnd_,[],"",null,null,shaka.media.SegmentReference.Status.AVAILABLE,this.aesKey_)).codecs=u,m.mimeType=c,0==this.segmentSequenceCadence_?0<f&&m.markAsNonIndependent():0!=f%this.segmentSequenceCadence_&&m.markAsNonIndependent(),d.push(m)}(r=new shaka.media.SegmentReference(this.periodStart_+a.start,l,(function(){return 0<a.partialSegments?[]:shaka.dash.TimelineSegmentIndex.createUris_(n,t.representationId_,i,t.bandwidth_,o,null,t.getBaseUris_)}),0,null,this.initSegmentReference_,r,this.periodStart_,this.periodEnd_,d,"",null,null,shaka.media.SegmentReference.Status.AVAILABLE,this.aesKey_,0<a.partialSegments)).codecs=u,r.mimeType=c,r.trueEndTime=s,this.references[e]=r}return r},shaka.dash.TimelineSegmentIndex.createUris_=function(e,t,r,n,a,i,o){return e=shaka.dash.MpdUtils.fillUriTemplate(e,t,r,i,n||null,a),shaka.util.ManifestParserUtils.resolveUris(o(),[e]).map((function(e){return e.toString()}))},shaka.util.ContentSteeringManager=function(e){this.config_=null,this.playerInterface_=e,this.operationManager_=new shaka.util.OperationManager,this.baseUris_=[],this.defaultPathwayId_=null,this.pathwayPriority_=[],this.lastPathwayUsed_=null,this.pathwayClones_=[],this.lastTTL_=300,this.locations_=new Map,this.bannedLocations_=new Map,this.updateTimer_=null,this.manifestType_=shaka.media.ManifestParser.UNKNOWN},shaka.util.ContentSteeringManager.prototype.configure=function(e){this.config_=e},shaka.util.ContentSteeringManager.prototype.destroy=function(){return this.playerInterface_=this.config_=null,this.baseUris_=[],this.defaultPathwayId_=null,this.pathwayPriority_=[],this.pathwayClones_=[],this.locations_.clear(),null!=this.updateTimer_&&(this.updateTimer_.stop(),this.updateTimer_=null),this.operationManager_.destroy()},shaka.util.ContentSteeringManager.prototype.setManifestType=function(e){this.manifestType_=e},shaka.util.ContentSteeringManager.prototype.setBaseUris=function(e){this.baseUris_=e},shaka.util.ContentSteeringManager.prototype.setDefaultPathwayId=function(e){this.defaultPathwayId_=e},shaka.util.ContentSteeringManager.prototype.requestInfo=function(e){var t,r,n,a,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){return 1==c.nextAddress?(t=shaka.util.ManifestParserUtils.resolveUris(u.baseUris_,[u.addQueryParams_(e)]),r=shaka.net.NetworkingEngine.RequestType.CONTENT_STEERING,n=shaka.net.NetworkingEngine.makeRequest(t,u.config_.retryParameters),a=u.playerInterface_.networkingEngine.request(r,n),u.operationManager_.manage(a),c.setCatchFinallyBlocks(2),c.yield(a.promise,4)):2!=c.nextAddress?(i=c.yieldResult,o=shaka.util.StringUtils.fromUTF8(i.data),1==(s=JSON.parse(o)).VERSION&&u.processManifest_(s,i.uri),c.leaveTryBlock(0)):(l=c.enterCatchBlock())&&l.code==shaka.util.Error.Code.OPERATION_ABORTED?c.return():(null!=u.updateTimer_&&(u.updateTimer_.stop(),u.updateTimer_=null),u.updateTimer_=new shaka.util.Timer((function(){u.requestInfo(e)})),u.updateTimer_.tickAfter(u.lastTTL_),void c.jumpToEnd())}))},shaka.util.ContentSteeringManager.prototype.addQueryParams_=function(e){if(!this.pathwayPriority_.length)return e;e=new goog.Uri(e);var t=this.lastPathwayUsed_||this.pathwayPriority_[0],r=Math.round(this.playerInterface_.getBandwidthEstimate()),n=e.getQueryData();return this.manifestType_==shaka.media.ManifestParser.DASH?(n.add("_DASH_pathway",t),n.add("_DASH_throughput",String(r))):this.manifestType_==shaka.media.ManifestParser.HLS&&(n.add("_HLS_pathway",t),n.add("_HLS_throughput",String(r))),n.getCount()&&e.setQueryData(n),e.toString()},shaka.util.ContentSteeringManager.prototype.processManifest_=function(e,t){var r=this;null!=this.updateTimer_&&(this.updateTimer_.stop(),this.updateTimer_=null);var n=e["RELOAD-URI"]||t;this.updateTimer_=new shaka.util.Timer((function(){r.requestInfo(n)})),(t=e.TTL)&&(this.lastTTL_=t),this.updateTimer_.tickAfter(this.lastTTL_),this.pathwayPriority_=e["PATHWAY-PRIORITY"]||[],this.pathwayClones_=e["PATHWAY-CLONES"]||[]},shaka.util.ContentSteeringManager.prototype.clearPreviousLocations=function(){this.locations_.clear()},shaka.util.ContentSteeringManager.prototype.addLocation=function(e,t,r){var n=this.locations_.get(e);n||(n=new Map),n.set(t,r),this.locations_.set(e,n)},shaka.util.ContentSteeringManager.prototype.banLocation=function(e){var t=Date.now()+6e4;this.bannedLocations_.set(e,t)},shaka.util.ContentSteeringManager.prototype.getLocations=function(e,t){var r=this;t=void 0!==t&&t,e=this.locations_.get(e)||new Map;for(var n=[],a={},i=$jscomp.makeIterator(this.pathwayPriority_),o=i.next();!o.done;a={$jscomp$loop$prop$pathwayId$901:a.$jscomp$loop$prop$pathwayId$901},o=i.next())if(a.$jscomp$loop$prop$pathwayId$901=o.value,o=e.get(a.$jscomp$loop$prop$pathwayId$901))n.push({pathwayId:a.$jscomp$loop$prop$pathwayId$901,location:o});else if(o=this.pathwayClones_.find(function(e){return function(t){return t.ID==e.$jscomp$loop$prop$pathwayId$901}}(a))){var s=e.get(o["BASE-ID"]);s&&(o["URI-REPLACEMENT"].HOST?((s=new goog.Uri(s)).setDomain(o["URI-REPLACEMENT"].HOST),n.push({pathwayId:a.$jscomp$loop$prop$pathwayId$901,location:s.toString()})):n.push({pathwayId:a.$jscomp$loop$prop$pathwayId$901,location:s}))}for(a=Date.now(),o=(i=$jscomp.makeIterator(this.bannedLocations_.keys())).next();!o.done;o=i.next())o=o.value,a>(s=this.bannedLocations_.get(o))&&this.bannedLocations_.delete(o);if(n=n.filter((function(e){for(var t=$jscomp.makeIterator(r.bannedLocations_.keys()),n=t.next();!n.done;n=t.next())if(n.value.includes(new goog.Uri(e.location).getDomain()))return!1;return!0})),n.length&&(this.lastPathwayUsed_=n[0].pathwayId),n=n.map((function(e){return e.location})),!n.length&&this.defaultPathwayId_)for(o=(a=$jscomp.makeIterator(this.defaultPathwayId_.split(","))).next();!o.done;o=a.next())(i=e.get(o.value))&&(this.lastPathwayUsed_=this.defaultPathwayId_,n.push(i));if(!n.length)for(a=(e=$jscomp.makeIterator(e.values())).next();!a.done;a=e.next())n.push(a.value);return t?n:shaka.util.ManifestParserUtils.resolveUris(this.baseUris_,n)},shaka.util.PeriodCombiner=function(){this.variants_=[],this.audioStreams_=[],this.videoStreams_=[],this.textStreams_=[],this.imageStreams_=[],this.useStreamOnce_=this.multiTypeVariantsAllowed_=!1,this.usedPeriodIds_=new Set},shaka.util.PeriodCombiner.prototype.release=function(){for(var e=this.audioStreams_.concat(this.videoStreams_,this.textStreams_,this.imageStreams_),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();this.audioStreams_=[],this.videoStreams_=[],this.textStreams_=[],this.imageStreams_=[],this.variants_=[]},shaka.util.PeriodCombiner.prototype.getVariants=function(){return this.variants_},shaka.util.PeriodCombiner.prototype.getTextStreams=function(){return this.textStreams_.slice()},shaka.util.PeriodCombiner.prototype.getImageStreams=function(){return this.imageStreams_},shaka.util.PeriodCombiner.prototype.getStreamsPerPeriod_=function(e,t){for(var r=shaka.util.ManifestParserUtils.ContentType,n=shaka.util.PeriodCombiner,a=[],i=[],o=[],s=[],l=(e=$jscomp.makeIterator(e)).next();!l.done;l=e.next()){var u=l.value;l=new Map(u.audioStreams.map((function(e){return[n.generateAudioKey_(e),e]})));var c=new Map(u.videoStreams.map((function(e){return[n.generateVideoKey_(e),e]}))),d=new Map(u.textStreams.map((function(e){return[n.generateTextKey_(e),e]})));if(u=new Map(u.imageStreams.map((function(e){return[n.generateImageKey_(e),e]}))),t){var p=n.dummyStream_(r.TEXT);d.set(n.generateTextKey_(p),p),p=n.dummyStream_(r.IMAGE),u.set(n.generateImageKey_(p),p)}a.push(l),i.push(c),o.push(d),s.push(u)}return{audioStreamsPerPeriod:a,videoStreamsPerPeriod:i,textStreamsPerPeriod:o,imageStreamsPerPeriod:s}},shaka.util.PeriodCombiner.prototype.combinePeriods=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,C,P,x,w,I,M=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(R){if(1==R.nextAddress){if(r=shaka.util.ManifestParserUtils.ContentType,!t&&1==e.length)return n=M.getStreamsPerPeriod_(e,!1),a=n.audioStreamsPerPeriod,i=n.videoStreamsPerPeriod,o=n.textStreamsPerPeriod,s=n.imageStreamsPerPeriod,M.audioStreams_=Array.from(a[0].values()),M.videoStreams_=Array.from(i[0].values()),M.textStreams_=Array.from(o[0].values()),M.imageStreams_=Array.from(s[0].values()),R.jumpTo(2);for(l=-1,u=0;u<e.length;u++)c=e[u],M.usedPeriodIds_.has(c.id)||(M.usedPeriodIds_.add(c.id),-1==l&&(l=u));return-1==l?R.return():(d=M.getStreamsPerPeriod_(e,!0),p=d.audioStreamsPerPeriod,h=d.videoStreamsPerPeriod,f=d.textStreamsPerPeriod,m=d.imageStreamsPerPeriod,R.yield(Promise.all([M.combine_(M.audioStreams_,p,l,shaka.util.PeriodCombiner.cloneStream_,shaka.util.PeriodCombiner.concatenateStreams_),M.combine_(M.videoStreams_,h,l,shaka.util.PeriodCombiner.cloneStream_,shaka.util.PeriodCombiner.concatenateStreams_),M.combine_(M.textStreams_,f,l,shaka.util.PeriodCombiner.cloneStream_,shaka.util.PeriodCombiner.concatenateStreams_),M.combine_(M.imageStreams_,m,l,shaka.util.PeriodCombiner.cloneStream_,shaka.util.PeriodCombiner.concatenateStreams_)]),2))}if(g=0,y=[],M.videoStreams_.length&&M.audioStreams_.length)for(T=$jscomp.makeIterator(M.audioStreams_),A=T.next();!A.done;A=T.next())for(S=A.value,C=$jscomp.makeIterator(M.videoStreams_),P=C.next();!P.done;P=C.next())x=P.value,w=shaka.media.DrmEngine.getCommonDrmInfos(S.drmInfos,x.drmInfos),S.drmInfos.length&&x.drmInfos.length&&!w.length?shaka.log.warning("Incompatible DRM in audio & video, skipping variant creation.",S,x):(I=g++,y.push({id:I,language:S.language,disabledUntilTime:0,primary:S.primary,audio:S,video:x,bandwidth:(S.bandwidth||0)+(x.bandwidth||0),drmInfos:w,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(v=M.videoStreams_.length?M.videoStreams_:M.audioStreams_,_=$jscomp.makeIterator(v),k=_.next();!k.done;k=_.next())E=k.value,b=g++,y.push({id:b,language:E.language,disabledUntilTime:0,primary:E.primary,audio:E.type==r.AUDIO?E:null,video:E.type==r.VIDEO?E:null,bandwidth:E.bandwidth||0,drmInfos:E.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});M.variants_=y,R.jumpToEnd()}))},shaka.util.PeriodCombiner.combineDbStreams=function(e){var t,r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,C,P,x,w,I;return $jscomp.asyncExecutePromiseGeneratorProgram((function(M){switch(M.nextAddress){case 1:if(t=shaka.util.ManifestParserUtils.ContentType,r=shaka.util.PeriodCombiner,1==e.length)return M.return(e[0]);for(n=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.AUDIO})).map((function(e){return[r.generateAudioKey_(e),e]})))})),a=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.VIDEO})).map((function(e){return[r.generateVideoKey_(e),e]})))})),i=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.TEXT})).map((function(e){return[r.generateTextKey_(e),e]})))})),o=e.map((function(e){return new Map(e.filter((function(e){return e.type===t.IMAGE})).map((function(e){return[r.generateImageKey_(e),e]})))})),s=$jscomp.makeIterator(i),l=s.next();!l.done;l=s.next())u=l.value,c=r.dummyStreamDB_(t.TEXT),u.set(r.generateTextKey_(c),c);for(d=$jscomp.makeIterator(o),p=d.next();!p.done;p=d.next())h=p.value,f=r.dummyStreamDB_(t.IMAGE),h.set(r.generateImageKey_(f),f);return m=new shaka.util.PeriodCombiner,M.yield(m.combine_([],n,0,shaka.util.PeriodCombiner.cloneStreamDB_,shaka.util.PeriodCombiner.concatenateStreamDBs_),2);case 2:return g=M.yieldResult,M.yield(m.combine_([],a,0,shaka.util.PeriodCombiner.cloneStreamDB_,shaka.util.PeriodCombiner.concatenateStreamDBs_),3);case 3:return y=M.yieldResult,M.yield(m.combine_([],i,0,shaka.util.PeriodCombiner.cloneStreamDB_,shaka.util.PeriodCombiner.concatenateStreamDBs_),4);case 4:return v=M.yieldResult,M.yield(m.combine_([],o,0,shaka.util.PeriodCombiner.cloneStreamDB_,shaka.util.PeriodCombiner.concatenateStreamDBs_),5);case 5:if(_=M.yieldResult,k=0,y.length&&g.length)for(A=$jscomp.makeIterator(g),S=A.next();!S.done;S=A.next())for(C=S.value,P=$jscomp.makeIterator(y),x=P.next();!x.done;x=P.next())w=x.value,I=k++,w.variantIds.push(I),C.variantIds.push(I);else for(E=y.concat(g),b=$jscomp.makeIterator(E),T=b.next();!T.done;T=b.next())T.value.variantIds=[k++];return M.return(y.concat(g).concat(v).concat(_))}}))},shaka.util.PeriodCombiner.prototype.combine_=function(e,t,r,n,a){var i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(T){switch(T.nextAddress){case 1:for(i=[],o=0;o<r;o++)i.push(new Set);for(s=r;s<t.length;s++)i.push(new Set(t[s].values()));l=$jscomp.makeIterator(e),u=l.next();case 2:if(u.done){T.jumpTo(4);break}return c=u.value,T.yield(b.extendExistingOutputStream_(c,t,r,a,i),5);case 5:if(!T.yieldResult)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.PERIOD_FLATTENING_FAILED);u=l.next(),T.jumpTo(2);break;case 4:for(d=$jscomp.makeIterator(i),p=d.next();!p.done;p=d.next())for(h=p.value,f=$jscomp.makeIterator(h),m=f.next();!m.done;m=f.next())g=m.value,(y=b.createNewOutputStream_(g,t,n,a,i))&&e.push(y);for(v=$jscomp.makeIterator(i),p=v.next();!p.done;p=v.next())for(_=p.value,k={},E=$jscomp.makeIterator(_),m=E.next();!m.done;k={$jscomp$loop$prop$stream$721$903:k.$jscomp$loop$prop$stream$721$903},m=E.next())if(k.$jscomp$loop$prop$stream$721$903=m.value,!shaka.util.PeriodCombiner.isDummy_(k.$jscomp$loop$prop$stream$721$903)&&e.some(function(e){return function(t){return b.areAVStreamsCompatible_(e.$jscomp$loop$prop$stream$721$903,t)}}(k)))throw shaka.log.error("Unused stream in period-flattening!",k.$jscomp$loop$prop$stream$721$903,e),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.PERIOD_FLATTENING_FAILED);return T.return(e)}}))},shaka.util.PeriodCombiner.prototype.extendExistingOutputStream_=function(e,t,r,n,a){var i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?(i.findMatchesInAllPeriods_(t,e),goog.asserts.assert(e.createSegmentIndex,"outputStream should be a Stream type!"),e.matchedStreams?e.segmentIndex?o.yield(shaka.util.PeriodCombiner.extendOutputSegmentIndex_(e,r),2):o.jumpTo(2):(shaka.log.error("No matches extending output stream!",e,t),o.return(!1))):(shaka.util.PeriodCombiner.extendOutputStream_(e,r,n,a),o.return(!0))}))},shaka.util.PeriodCombiner.extendOutputSegmentIndex_=function(e,t){var r,n,a,i,o,s,l;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){if(1==u.nextAddress){for(r=[],n=e.matchedStreams,goog.asserts.assert(n,"matched streams should be valid"),a=$jscomp.makeIterator(n),i=a.next();!i.done;i=a.next())o=i.value,r.push(o.createSegmentIndex()),o.trickModeVideo&&!o.trickModeVideo.segmentIndex&&r.push(o.trickModeVideo.createSegmentIndex());return u.yield(Promise.all(r),2)}if(e.segmentIndex instanceof shaka.media.MetaSegmentIndex)for(s=t;s<n.length;s++)l=n[s],goog.asserts.assert(l.segmentIndex,"stream should have a segmentIndex."),l.segmentIndex&&e.segmentIndex.appendSegmentIndex(l.segmentIndex);u.jumpToEnd()}))},shaka.util.PeriodCombiner.prototype.createNewOutputStream_=function(e,t,r,n,a){if(shaka.util.PeriodCombiner.isDummy_(e))return null;var i=r(e);return this.findMatchesInAllPeriods_(t,i),i.createSegmentIndex&&(i.createSegmentIndex=function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return i.segmentIndex?e.jumpTo(0):(i.segmentIndex=new shaka.media.MetaSegmentIndex,e.yield(shaka.util.PeriodCombiner.extendOutputSegmentIndex_(i,0),0))}))}),i.matchedStreams&&i.matchedStreams.length?(shaka.util.PeriodCombiner.extendOutputStream_(i,0,n,a),i):null},shaka.util.PeriodCombiner.extendOutputStream_=function(e,t,r,n){var a=shaka.util.ManifestParserUtils.ContentType,i=shaka.util.LanguageUtils,o=e.matchedStreams;for(goog.asserts.assert(e.matchedStreams,"matchedStreams should be non-null");t<o.length;t++){var s=o[t];r(e,s);var l=!0;if(e.type==a.AUDIO&&0==i.relatedness(e.language,s.language)&&(l=!1),l&&(n[t].delete(s),s.fullMimeTypes))for(l=(s=$jscomp.makeIterator(s.fullMimeTypes.values())).next();!l.done;l=s.next())e.fullMimeTypes.add(l.value)}},shaka.util.PeriodCombiner.cloneStream_=function(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){if(t.segmentIndex&&(t.segmentIndex.release(),t.segmentIndex=null),t.matchedStreams)for(var e=$jscomp.makeIterator(t.matchedStreams),r=e.next();!r.done;r=e.next())(r=r.value).segmentIndex&&(r.segmentIndex.release(),r.segmentIndex=null)},t.roles=t.roles.slice(),t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set,t.closedCaptions=null,t.trickModeVideo=null,t},shaka.util.PeriodCombiner.cloneStreamDB_=function(e){return(e=Object.assign({},e)).roles=e.roles.slice(),e.keyIds=new Set,e.segments=[],e.variantIds=[],e.closedCaptions=null,e},shaka.util.PeriodCombiner.concatenateStreams_=function(e,t){var r=function(e,t){e||(e=[]);for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())r=r.value,e.includes(r)||e.push(r);return e};e.roles=r(e.roles,t.roles),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=r(e.emsgSchemeIdUris,t.emsgSchemeIdUris));for(var n=(r=$jscomp.makeIterator(t.keyIds)).next();!n.done;n=r.next())e.keyIds.add(n.value);if(e.originalId=null==e.originalId?t.originalId:e.originalId+","+(t.originalId||""),r=shaka.media.DrmEngine.getCommonDrmInfos(e.drmInfos,t.drmInfos),t.drmInfos.length&&e.drmInfos.length&&!r.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.INCONSISTENT_DRM_ACROSS_PERIODS);if(e.drmInfos=r,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),n=(r=$jscomp.makeIterator(t.closedCaptions)).next();!n.done;n=r.next()){var a=$jscomp.makeIterator(n.value);n=a.next().value,a=a.next().value,e.closedCaptions.set(n,a)}t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=shaka.util.PeriodCombiner.cloneStream_(t.trickModeVideo),e.trickModeVideo.createSegmentIndex=function(){return goog.asserts.assert(e.segmentIndex instanceof shaka.media.MetaSegmentIndex,"The stream should have a MetaSegmentIndex."),e.trickModeVideo.segmentIndex=e.segmentIndex.clone(),Promise.resolve()}),shaka.util.PeriodCombiner.concatenateStreams_(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&shaka.util.PeriodCombiner.concatenateStreams_(e.trickModeVideo,t)},shaka.util.PeriodCombiner.concatenateStreamDBs_=function(e,t){var r=e.roles;r||(r=[]);for(var n=$jscomp.makeIterator(t.roles),a=n.next();!a.done;a=n.next())a=a.value,r.includes(a)||r.push(a);for(e.roles=r,n=(r=$jscomp.makeIterator(t.keyIds)).next();!n.done;n=r.next())e.keyIds.add(n.value);if(e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,$jscomp.arrayFromIterable(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),r=(t=$jscomp.makeIterator(t.closedCaptions)).next();!r.done;r=t.next())r=(n=$jscomp.makeIterator(r.value)).next().value,n=n.next().value,e.closedCaptions.set(r,n)},shaka.util.PeriodCombiner.prototype.findMatchesInAllPeriods_=function(e,t){for(var r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){if(!(n=this.findBestMatchInPeriod_(n.value,t)))return;r.push(n)}t.matchedStreams=r},shaka.util.PeriodCombiner.prototype.findBestMatchInPeriod_=function(e,t){var r=this,n={audio:shaka.util.PeriodCombiner.generateAudioKey_,video:shaka.util.PeriodCombiner.generateVideoKey_,text:shaka.util.PeriodCombiner.generateTextKey_,image:shaka.util.PeriodCombiner.generateImageKey_}[t.type],a=null,i=n(t);if(e.has(i))a=e.get(i);else{i={audio:function(e,t){return r.areAVStreamsCompatible_(e,t)},video:function(e,t){return r.areAVStreamsCompatible_(e,t)},text:shaka.util.PeriodCombiner.areTextStreamsCompatible_,image:shaka.util.PeriodCombiner.areImageStreamsCompatible_}[t.type];for(var o={audio:shaka.util.PeriodCombiner.isAudioStreamBetterMatch_,video:shaka.util.PeriodCombiner.isVideoStreamBetterMatch_,text:shaka.util.PeriodCombiner.isTextStreamBetterMatch_,image:shaka.util.PeriodCombiner.isImageStreamBetterMatch_}[t.type],s=$jscomp.makeIterator(e.values()),l=s.next();!l.done;l=s.next())!i(t,l=l.value)||t.fastSwitching!=l.fastSwitching||a&&!o(t,a,l)||(a=l)}return this.useStreamOnce_&&!shaka.util.PeriodCombiner.isDummy_(a)&&e.delete(n(a)),a},shaka.util.PeriodCombiner.areAVStreamsExactMatch_=function(e,t){if(e.mimeType!=t.mimeType)return!1;var r=function(e){if(!shaka.util.PeriodCombiner.memoizedCodecs.has(e)){var t=shaka.util.MimeUtils.getNormalizedCodec(e);shaka.util.PeriodCombiner.memoizedCodecs.set(e,t)}return shaka.util.PeriodCombiner.memoizedCodecs.get(e)};return r(e.codecs)==r(t.codecs)},shaka.util.PeriodCombiner.prototype.setAllowMultiTypeVariants=function(e){this.multiTypeVariantsAllowed_=e},shaka.util.PeriodCombiner.prototype.setUseStreamOnce=function(e){this.useStreamOnce_=e},shaka.util.PeriodCombiner.prototype.areAVStreamsCompatible_=function(e,t){return!(!shaka.util.PeriodCombiner.areAVStreamsExactMatch_(e,t)&&!this.multiTypeVariantsAllowed_||e.drmInfos&&!shaka.media.DrmEngine.areDrmCompatible(e.drmInfos,t.drmInfos))},shaka.util.PeriodCombiner.areTextStreamsCompatible_=function(e,t){return!t.language||e.forced===t.forced&&0!=shaka.util.LanguageUtils.relatedness(e.language,t.language)&&t.kind==e.kind},shaka.util.PeriodCombiner.areImageStreamsCompatible_=function(e,t){return!0},shaka.util.PeriodCombiner.isAudioStreamBetterMatch_=function(e,t,r){var n=shaka.util.LanguageUtils,a=shaka.util.PeriodCombiner.BetterOrWorse,i=a.BETTER;a=a.WORSE;var o=shaka.util.PeriodCombiner.areAVStreamsExactMatch_(e,t),s=shaka.util.PeriodCombiner.areAVStreamsExactMatch_(e,r);if(o&&!s)return!1;if(!o&&s)return!0;if(o=n.relatedness(e.language,t.language),(n=n.relatedness(e.language,r.language))>o)return!0;if(n<o)return!1;if(t.label!==r.label){if(e.label===t.label)return!1;if(e.label===r.label)return!0}return e.roles.length?(i=t.roles.filter((function(t){return e.roles.includes(t)})),a=r.roles.filter((function(t){return e.roles.includes(t)})),a.length>i.length||!(a.length<i.length)&&r.roles.length<t.roles.length):!(r.roles.length||!t.roles.length)||!(r.roles.length&&!t.roles.length)&&(!(t.primary||!r.primary)||!(t.primary&&!r.primary)&&((n=shaka.util.PeriodCombiner.compareClosestPreferLower(e.channelsCount,t.channelsCount,r.channelsCount))==i||n!=a&&((n=shaka.util.PeriodCombiner.compareClosestPreferLower(e.audioSamplingRate,t.audioSamplingRate,r.audioSamplingRate))==i||n!=a&&!(!e.bandwidth||shaka.util.PeriodCombiner.compareClosestPreferMinimalAbsDiff_(e.bandwidth,t.bandwidth,r.bandwidth)!=i))))},shaka.util.PeriodCombiner.isVideoStreamBetterMatch_=function(e,t,r){var n=shaka.util.PeriodCombiner.BetterOrWorse,a=n.BETTER;n=n.WORSE;var i=shaka.util.PeriodCombiner.areAVStreamsExactMatch_(e,t),o=shaka.util.PeriodCombiner.areAVStreamsExactMatch_(e,r);if(i&&!o)return!1;if(!i&&o)return!0;if((i=shaka.util.PeriodCombiner.compareClosestPreferLower(e.width*e.height,t.width*t.height,r.width*r.height))==a)return!0;if(i==n)return!1;if(e.frameRate){if((i=shaka.util.PeriodCombiner.compareClosestPreferLower(e.frameRate,t.frameRate,r.frameRate))==a)return!0;if(i==n)return!1}return!(!e.bandwidth||shaka.util.PeriodCombiner.compareClosestPreferMinimalAbsDiff_(e.bandwidth,t.bandwidth,r.bandwidth)!=a)},shaka.util.PeriodCombiner.isTextStreamBetterMatch_=function(e,t,r){var n=shaka.util.LanguageUtils,a=n.relatedness(e.language,t.language);if((n=n.relatedness(e.language,r.language))>a)return!0;if(n<a)return!1;if(!t.primary&&r.primary)return!0;if(t.primary&&!r.primary)return!1;if(t.label!==r.label){if(e.label===t.label)return!1;if(e.label===r.label)return!0}if(e.roles.length){if(a=t.roles.filter((function(t){return e.roles.includes(t)})),(n=r.roles.filter((function(t){return e.roles.includes(t)}))).length>a.length)return!0;if(n.length<a.length)return!1}else{if(!r.roles.length&&t.roles.length)return!0;if(r.roles.length&&!t.roles.length)return!1}return r.mimeType==e.mimeType&&r.codecs==e.codecs&&(t.mimeType!=e.mimeType||t.codecs!=e.codecs)},shaka.util.PeriodCombiner.isImageStreamBetterMatch_=function(e,t,r){var n=shaka.util.PeriodCombiner.BetterOrWorse.BETTER;return shaka.util.PeriodCombiner.compareClosestPreferLower(e.width*e.height,t.width*t.height,r.width*r.height)==n},shaka.util.PeriodCombiner.dummyStreamDB_=function(e){return{id:0,originalId:"",groupId:null,primary:!1,type:e,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1,fastSwitching:!1}},shaka.util.PeriodCombiner.dummyStream_=function(e){return{id:0,originalId:"",groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new shaka.media.SegmentIndex([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:e,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set}},shaka.util.PeriodCombiner.compareClosestPreferLower=function(e,t,r){var n=shaka.util.PeriodCombiner.BetterOrWorse,a=n.BETTER,i=n.WORSE;if(t==e&&e!=r)return i;if(r==e&&e!=t)return a;if(t>e){if(r<=e||r-e<t-e)return a;if(r-e>t-e)return i}else{if(r>e)return i;if(e-r<e-t)return a;if(e-r>e-t)return i}return n.EQUAL},shaka.util.PeriodCombiner.compareClosestPreferMinimalAbsDiff_=function(e,t,r){var n=shaka.util.PeriodCombiner.BetterOrWorse,a=n.BETTER,i=n.WORSE;return t=Math.abs(e-t),(e=Math.abs(e-r))<t?a:t<e?i:n.EQUAL},shaka.util.PeriodCombiner.isDummy_=function(e){var t=shaka.util.ManifestParserUtils.ContentType;switch(e.type){case t.TEXT:return!e.language;case t.IMAGE:return!e.tilesLayout;default:return!1}},shaka.util.PeriodCombiner.generateVideoKey_=function(e){return shaka.util.PeriodCombiner.generateKey_([e.fastSwitching,e.width,e.frameRate,e.codecs,e.mimeType,e.label,e.roles,e.closedCaptions?Array.from(e.closedCaptions.entries()):null,e.bandwidth])},shaka.util.PeriodCombiner.generateAudioKey_=function(e){return shaka.util.PeriodCombiner.generateKey_([e.fastSwitching,e.channelsCount,e.language,e.bandwidth,e.label,e.codecs,e.mimeType,e.roles,e.audioSamplingRate,e.primary])},shaka.util.PeriodCombiner.generateTextKey_=function(e){return shaka.util.PeriodCombiner.generateKey_([e.language,e.label,e.codecs,e.mimeType,e.bandwidth,e.roles])},shaka.util.PeriodCombiner.generateImageKey_=function(e){return shaka.util.PeriodCombiner.generateKey_([e.width,e.codecs,e.mimeType])},shaka.util.PeriodCombiner.generateKey_=function(e){return JSON.stringify(e)},goog.exportSymbol("shaka.util.PeriodCombiner",shaka.util.PeriodCombiner),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"setUseStreamOnce",shaka.util.PeriodCombiner.prototype.setUseStreamOnce),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"setAllowMultiTypeVariants",shaka.util.PeriodCombiner.prototype.setAllowMultiTypeVariants),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"combinePeriods",shaka.util.PeriodCombiner.prototype.combinePeriods),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"getImageStreams",shaka.util.PeriodCombiner.prototype.getImageStreams),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"getTextStreams",shaka.util.PeriodCombiner.prototype.getTextStreams),goog.exportProperty(shaka.util.PeriodCombiner.prototype,"getVariants",shaka.util.PeriodCombiner.prototype.getVariants),shaka.util.PeriodCombiner.BetterOrWorse={BETTER:1,EQUAL:0,WORSE:-1},shaka.util.PeriodCombiner.memoizedCodecs=new Map,shaka.util.XmlUtils=function(){},shaka.util.XmlUtils.parseXmlString=function(e,t){var r=new DOMParser,n=shaka.util.XmlUtils.trustedHTMLFromString_.value()(e);e=null;try{e=r.parseFromString(n,"text/xml")}catch(e){return shaka.log.error("XML parsing exception:",e),null}if(goog.asserts.assert(e,"Parsed XML document cannot be null!"),!(r=e.documentElement))return shaka.log.error("XML document was empty!"),null;if((n=r.getElementsByTagName("parsererror")).length)return shaka.log.error("XML parser error found:",n[0]),null;if(r.tagName!=t)return shaka.log.error('XML tag name does not match expected "'+t+'":',r.tagName),null;if(!("createNodeIterator"in document))return r;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return shaka.log.error("XML document embeds unsafe content!"),null;return r},shaka.util.XmlUtils.parseXml=function(e,t){try{var r=shaka.util.StringUtils.fromBytesAutoDetect(e);return shaka.util.XmlUtils.parseXmlString(r,t)}catch(e){return shaka.log.error("parseXmlString threw!",e),null}},shaka.util.XmlUtils.toArrayBuffer=function(e){return shaka.util.StringUtils.toUTF8(e.outerHTML)},shaka.util.XmlUtils.trustedHTMLFromString_=new shaka.util.Lazy((function(){if("undefined"!=typeof trustedTypes){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(e){return e}});return function(t){return e.createHTML(t)}}return function(e){return e}})),shaka.dash.DashParser=function(){var e=this;this.playerInterface_=this.config_=null,this.manifestUris_=[],this.manifest_=null,this.globalId_=1,this.streamMap_={},this.periodDurations_={},this.periodCombiner_=new shaka.util.PeriodCombiner,this.updatePeriod_=0,this.averageUpdateDuration_=new shaka.abr.Ewma(5),this.updateTimer_=new shaka.util.Timer((function(){e.onUpdate_()})),this.operationManager_=new shaka.util.OperationManager,this.largestPeriodStartTime_=null,this.lastManifestUpdatePeriodIds_=[],this.minTotalAvailabilityTimeOffset_=1/0,this.lowLatencyMode_=!1,this.contentSteeringManager_=null},shaka.dash.DashParser.prototype.configure=function(e){goog.asserts.assert(null!=e.dash,"DashManifestConfiguration should not be null!");var t=this.playerInterface_&&e.dash.updatePeriod!=this.config_.dash.updatePeriod&&0<=e.dash.updatePeriod;this.config_=e,t&&this.manifest_&&this.manifest_.presentationTimeline.isLive()&&this.updateNow_(),this.contentSteeringManager_&&this.contentSteeringManager_.configure(this.config_),this.periodCombiner_&&(this.periodCombiner_.setAllowMultiTypeVariants(this.config_.dash.multiTypeVariantsAllowed&&shaka.media.Capabilities.isChangeTypeSupported()),this.periodCombiner_.setUseStreamOnce(this.config_.dash.useStreamOnceInPeriodFlattening))},shaka.dash.DashParser.prototype.start=function(e,t){var r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){if(1==a.nextAddress)return goog.asserts.assert(n.config_,"Must call configure() before start()!"),n.lowLatencyMode_=t.isLowLatencyMode(),n.manifestUris_=[e],n.playerInterface_=t,a.yield(n.requestManifest_(),2);if(r=a.yieldResult,n.playerInterface_&&n.setUpdateTimer_(r),!n.playerInterface_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED);return goog.asserts.assert(n.manifest_,"Manifest should be non-null!"),a.return(n.manifest_)}))},shaka.dash.DashParser.prototype.stop=function(){for(var e=$jscomp.makeIterator(Object.values(this.streamMap_)),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();return this.periodCombiner_&&this.periodCombiner_.release(),this.config_=this.playerInterface_=null,this.manifestUris_=[],this.manifest_=null,this.streamMap_={},this.periodCombiner_=null,null!=this.updateTimer_&&(this.updateTimer_.stop(),this.updateTimer_=null),this.contentSteeringManager_&&this.contentSteeringManager_.destroy(),this.operationManager_.destroy()},shaka.dash.DashParser.prototype.update=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(r.setCatchFinallyBlocks(2),r.yield(t.requestManifest_(),4)):2!=r.nextAddress?r.leaveTryBlock(0):(e=r.enterCatchBlock(),t.playerInterface_&&e?(goog.asserts.assert(e instanceof shaka.util.Error,"Bad error type"),t.playerInterface_.onError(e),void r.jumpToEnd()):r.return())}))},shaka.dash.DashParser.prototype.onExpirationUpdated=function(e,t){},shaka.dash.DashParser.prototype.onInitialVariantChosen=function(e){if(this.manifest_&&this.manifest_.presentationTimeline.isLive()){var t=e.video||e.audio;if(t&&t.segmentIndex){e=this.manifest_.presentationTimeline.getSegmentAvailabilityEnd();var r=t.segmentIndex.find(e);null!=r&&(t=t.segmentIndex.get(r))&&(this.updatePeriod_=t.endTime-e,this.setUpdateTimer_(0))}}},shaka.dash.DashParser.prototype.banLocation=function(e){this.contentSteeringManager_&&this.contentSteeringManager_.banLocation(e)},shaka.dash.DashParser.prototype.requestManifest_=function(){var e,t,r,n,a,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){return 1==c.nextAddress?(e=shaka.net.NetworkingEngine.RequestType.MANIFEST,t=shaka.net.NetworkingEngine.AdvancedRequestType.MPD,r=u.manifestUris_,1<u.manifestUris_.length&&u.contentSteeringManager_&&((n=u.contentSteeringManager_.getLocations("Location",!0)).length&&(r=n)),a=shaka.net.NetworkingEngine.makeRequest(r,u.config_.retryParameters),i=Date.now(),c.yield(u.makeNetworkRequest_(a,e,{type:t}),2)):3!=c.nextAddress?(o=c.yieldResult,u.playerInterface_?(o.uri&&o.uri!=o.originalUri&&!u.manifestUris_.includes(o.uri)&&u.manifestUris_.unshift(o.uri),c.yield(u.parseManifest_(o.data,o.uri),3)):c.return(0)):(s=Date.now(),l=(s-i)/1e3,u.averageUpdateDuration_.sample(1,l),c.return(l))}))},shaka.dash.DashParser.prototype.parseManifest_=function(e,t){var r,n,a,i,o,s,l,u,c,d,p=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){if(1==h.nextAddress){if(r=e,n=p.config_.dash.manifestPreprocessor,a=shaka.util.PlayerConfiguration.defaultManifestPreprocessor,n!=a){if(shaka.Deprecate.deprecateFeature(5,"manifest.dash.manifestPreprocessor configuration","Please Use manifest.dash.manifestPreprocessorTXml instead."),!(i=shaka.util.XmlUtils.parseXml(r,"MPD")))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_INVALID_XML,t);n(i),r=shaka.util.XmlUtils.toArrayBuffer(i)}if(!(o=shaka.util.TXml.parseXml(r,"MPD")))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_INVALID_XML,t);return s=p.config_.dash.manifestPreprocessorTXml,l=shaka.util.PlayerConfiguration.defaultManifestPreprocessorTXml,s!=l&&s(o),p.config_.dash.disableXlinkProcessing?h.return(p.processManifest_(o,t)):(u=p.config_.dash.xlinkFailGracefully,c=shaka.dash.MpdUtils.processXlinks(o,p.config_.retryParameters,u,t,p.playerInterface_.networkingEngine),p.operationManager_.manage(c),h.yield(c.promise,2))}return d=h.yieldResult,h.return(p.processManifest_(d,t))}))},shaka.dash.DashParser.prototype.processManifest_=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,C,P,x,w,I,M,R,D,O,L,N,U,j,B,F,V,H,G,$,K,W,z,q,Y,X,Z,Q,J,ee,te,re,ne,ae=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(ie){switch(ie.nextAddress){case 1:for(r=shaka.util.TXml,goog.asserts.assert(ae.config_,"Must call configure() before processManifest_()!"),ae.contentSteeringManager_&&ae.contentSteeringManager_.clearPreviousLocations(),n=[t],a=[],i=new Map,o=r.findChildren(e,"Location"),s=$jscomp.makeIterator(o),l=s.next();!l.done;l=s.next())u=l.value,c=u.attributes.serviceLocation,(d=r.getContents(u))&&(p=shaka.util.ManifestParserUtils.resolveUris(n,[d])[0],c&&(ae.contentSteeringManager_?ae.contentSteeringManager_.addLocation("Location",c,p):i.set(c,p)),a.push(p));if(ae.contentSteeringManager_?0<(h=ae.contentSteeringManager_.getLocations("Location",!0)).length&&(n=ae.manifestUris_=h):a.length&&(n=ae.manifestUris_=a),f=Promise.resolve(),(m=r.findChild(e,"ContentSteering"))&&ae.playerInterface_)for(g=m.attributes.defaultServiceLocation,ae.contentSteeringManager_?(ae.contentSteeringManager_.setBaseUris(n),ae.contentSteeringManager_.setDefaultPathwayId(g)):(ae.contentSteeringManager_=new shaka.util.ContentSteeringManager(ae.playerInterface_),ae.contentSteeringManager_.configure(ae.config_),ae.contentSteeringManager_.setManifestType(shaka.media.ManifestParser.DASH),ae.contentSteeringManager_.setBaseUris(n),ae.contentSteeringManager_.setDefaultPathwayId(g),(y=r.getContents(m))&&(r.parseAttr(m,"queryBeforeStart",r.parseBoolean,!1)?f=ae.contentSteeringManager_.requestInfo(y):ae.contentSteeringManager_.requestInfo(y))),v=$jscomp.makeIterator(i.keys()),_=v.next();!_.done;_=v.next())k=_.value,E=i.get(k),ae.contentSteeringManager_.addLocation("Location",k,E);if(b=r.findChildren(e,"BaseURL"),A=!1,ae.contentSteeringManager_)for(S=$jscomp.makeIterator(b),C=S.next();!C.done;C=S.next())P=C.value,x=P.attributes.serviceLocation,w=r.getContents(P),x&&w&&(ae.contentSteeringManager_.addLocation("BaseURL",x,w),A=!0);if(A&&ae.contentSteeringManager_||(I=b.map(r.getContents),T=shaka.util.ManifestParserUtils.resolveUris(n,I)),M=function(){return ae.contentSteeringManager_&&A?ae.contentSteeringManager_.getLocations("BaseURL"):T||[]},R=0,b&&b.length&&(R=r.parseAttr(b[0],"availabilityTimeOffset",r.parseFloat)||0),D=ae.config_.dash.ignoreMinBufferTime,O=0,D||(O=r.parseAttr(e,"minBufferTime",r.parseDuration)||0),ae.updatePeriod_=r.parseAttr(e,"minimumUpdatePeriod",r.parseDuration,-1),L=r.parseAttr(e,"availabilityStartTime",r.parseDate),N=r.parseAttr(e,"timeShiftBufferDepth",r.parseDuration),U=ae.config_.dash.ignoreSuggestedPresentationDelay,j=null,U||(j=r.parseAttr(e,"suggestedPresentationDelay",r.parseDuration)),B=ae.config_.dash.ignoreMaxSegmentDuration,F=null,B||(F=r.parseAttr(e,"maxSegmentDuration",r.parseDuration)),V=e.attributes.type||"static",ae.manifest_)for(H=ae.manifest_.presentationTimeline,G=$jscomp.makeIterator(Object.values(ae.streamMap_)),$=G.next();!$.done;$=G.next())(K=$.value).segmentIndex&&K.segmentIndex.evict(H.getSegmentAvailabilityStart());else W=ae.config_.defaultPresentationDelay||1.5*O,z=null!=j?j:W,H=new shaka.media.PresentationTimeline(L,z,ae.config_.dash.autoCorrectDrift);return H.setStatic("static"==V),H.isLive()&&!isNaN(ae.config_.availabilityWindowOverride)&&(N=ae.config_.availabilityWindowOverride),null==N&&(N=1/0),H.setSegmentAvailabilityDuration(N),q=e.attributes.profiles||"",Y={dynamic:"static"!=V,presentationTimeline:H,period:null,periodInfo:null,adaptationSet:null,representation:null,bandwidth:0,indexRangeWarningGiven:!1,availabilityTimeOffset:R,profiles:q.split(",")},X=ae.parsePeriods_(Y,M,e),Z=X.duration,Q=X.periods,"static"!=V&&X.durationDerivedFromPeriods||H.setDuration(Z||1/0),ae.minTotalAvailabilityTimeOffset_&&!ae.lowLatencyMode_&&ae.playerInterface_.isAutoLowLatencyMode()&&(ae.playerInterface_.enableLowLatencyMode(),ae.lowLatencyMode_=ae.playerInterface_.isLowLatencyMode()),ae.lowLatencyMode_?H.setAvailabilityTimeOffset(ae.minTotalAvailabilityTimeOffset_):ae.minTotalAvailabilityTimeOffset_&&shaka.log.alwaysWarn("Low-latency DASH live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),H.notifyMaxSegmentDuration(F||1),goog.DEBUG&&H.assertIsValid(),ie.yield(ae.periodCombiner_.combinePeriods(Q,Y.dynamic),2);case 2:return ie.yield(f,3);case 3:if(ae.lowLatencyMode_&&(O=0,J=null!=j?j:ae.config_.defaultPresentationDelay,H.setDelay(J)),ae.manifest_){ae.manifest_.variants=ae.periodCombiner_.getVariants(),0<(ee=ae.periodCombiner_.getTextStreams()).length&&(ae.manifest_.textStreams=ee),ae.manifest_.imageStreams=ae.periodCombiner_.getImageStreams(),ae.playerInterface_.filter(ae.manifest_),ie.jumpTo(4);break}if(ae.manifest_={presentationTimeline:H,variants:ae.periodCombiner_.getVariants(),textStreams:ae.periodCombiner_.getTextStreams(),imageStreams:ae.periodCombiner_.getImageStreams(),offlineSessionIds:[],minBufferTime:O||0,sequenceMode:ae.config_.dash.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:shaka.media.ManifestParser.DASH,serviceDescription:ae.parseServiceDescription_(e)},!H.usingPresentationStartTime()){ie.jumpTo(5);break}return te=shaka.util.TXml,re=te.findChildren(e,"UTCTiming"),ie.yield(ae.parseUtcTiming_(M,re),6);case 6:if(ne=ie.yieldResult,!ae.playerInterface_)return ie.return();H.setClockOffset(ne);case 5:H.lockStartTime();case 4:ae.playerInterface_.makeTextStreamsForClosedCaptions(ae.manifest_),ie.jumpToEnd()}}))},shaka.dash.DashParser.prototype.parseServiceDescription_=function(e){var t=shaka.util.TXml,r=t.findChild(e,"ServiceDescription");if(!r)return null;e=t.findChild(r,"Latency");var n=t.findChild(r,"PlaybackRate");return e&&e.attributes.max||n?{maxLatency:t=e&&e.attributes.max?parseInt(e.attributes.max,10)/1e3:null,maxPlaybackRate:r=n?parseFloat(n.attributes.max):null,minLatency:e=e&&e.attributes.min?parseInt(e.attributes.min,10)/1e3:null,minPlaybackRate:n=n?parseFloat(n.attributes.min):null}:null},shaka.dash.DashParser.prototype.parsePeriods_=function(e,t,r){var n=shaka.util.TXml,a=n.parseAttr(r,"mediaPresentationDuration",n.parseDuration),i=[],o=0;r=n.findChildren(r,"Period");for(var s=0;s<r.length;s++){var l=r[s],u=r[s+1],c=n.parseAttr(l,"start",n.parseDuration,o),d=l.attributes.id,p=n.parseAttr(l,"duration",n.parseDuration),h=null;if(u){var f=n.parseAttr(u,"start",n.parseDuration);null!=f&&(h=f-c)}else null!=a&&(h=a-c);if(f=shaka.util.ManifestParserUtils.GAP_OVERLAP_TOLERANCE_SECONDS,h&&p&&Math.abs(h-p)>f&&shaka.log.warning("There is a gap/overlap between Periods",l),null==h&&(h=p),null!==this.largestPeriodStartTime_&&null!==d&&null!==c&&c<this.largestPeriodStartTime_&&!this.lastManifestUpdatePeriodIds_.includes(d)&&s+1!=r.length)shaka.log.debug("Skipping Period with ID "+d+" as its start time is smaller than the largest period start time that has been seen, and ID is unseen before");else{if(null!==c&&(null===this.largestPeriodStartTime_||c>this.largestPeriodStartTime_)&&(this.largestPeriodStartTime_=c),o=this.parsePeriod_(e,t,{start:c,duration:h,node:l,isLastPeriod:null==h||!u}),i.push(o),e.period.id&&h&&(this.periodDurations_[e.period.id]=h),null==h){u&&shaka.log.warning("Skipping Period",s+1,"and any subsequent Periods:","Period",s+1,"does not have a valid start time.",u),o=null;break}o=c+h}}return this.lastManifestUpdatePeriodIds_=i.map((function(e){return e.id})),null!=a?(o!=a&&shaka.log.warning("@mediaPresentationDuration does not match the total duration of ","all Periods."),{periods:i,duration:a,durationDerivedFromPeriods:!1}):{periods:i,duration:o,durationDerivedFromPeriods:!0}},shaka.dash.DashParser.prototype.parsePeriod_=function(e,t,r){var n=this,a=shaka.util.Functional,i=shaka.util.TXml,o=shaka.util.ManifestParserUtils.ContentType;e.period=this.createFrame_(r.node,null,t),e.periodInfo=r,e.period.availabilityTimeOffset=e.availabilityTimeOffset,e.period.id||(shaka.log.info("No Period ID given for Period with start time "+r.start+",  Assigning a default"),e.period.id="__shaka_period_"+r.start);var s=i.findChildren(r.node,"EventStream");t=e.presentationTimeline.getSegmentAvailabilityStart();for(var l=(s=$jscomp.makeIterator(s)).next();!l.done;l=s.next())this.parseEventStream_(r.start,r.duration,l.value,t);if(a=i.findChildren(r.node,"AdaptationSet").map((function(t){return n.parseAdaptationSet_(e,t)})).filter(a.isNotNull),e.dynamic){for(r=[],t=(i=$jscomp.makeIterator(a)).next();!t.done;t=i.next())for(s=(t=$jscomp.makeIterator(t.value.representationIds)).next();!s.done;s=t.next())r.push(s.value);if(i=new Set(r),r.length!=i.size)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_DUPLICATE_REPRESENTATION_ID)}for(r=a.filter((function(e){return!e.trickModeFor})),a=a.filter((function(e){return e.trickModeFor})),i=(a=$jscomp.makeIterator(a)).next();!i.done;i=a.next())for(t=(i=i.value).trickModeFor.split(" "),l=(s=$jscomp.makeIterator(r)).next();!l.done;l=s.next()){var u=l.value;if(t.includes(u.id)){l={};for(var c=(u=$jscomp.makeIterator(u.streams)).next();!c.done;l={$jscomp$loop$prop$stream$905:l.$jscomp$loop$prop$stream$905},c=u.next())l.$jscomp$loop$prop$stream$905=c.value,l.$jscomp$loop$prop$stream$905.trickModeVideo=i.streams.find(function(e){return function(t){return shaka.util.MimeUtils.getNormalizedCodec(e.$jscomp$loop$prop$stream$905.codecs)==shaka.util.MimeUtils.getNormalizedCodec(t.codecs)}}(l))}}if(a=this.getStreamsFromSets_(this.config_.disableAudio,r,o.AUDIO),i=this.getStreamsFromSets_(this.config_.disableVideo,r,o.VIDEO),t=this.getStreamsFromSets_(this.config_.disableText,r,o.TEXT),o=this.getStreamsFromSets_(this.config_.disableThumbnails,r,o.IMAGE),0===i.length&&0===a.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_EMPTY_PERIOD);return{id:e.period.id,audioStreams:a,videoStreams:i,textStreams:t,imageStreams:o}},shaka.dash.DashParser.prototype.getStreamsFromSets_=function(e,t,r){return e||!t.length?[]:t.reduce((function(e,t){return t.contentType!=r||e.push.apply(e,$jscomp.arrayFromIterable(t.streams)),e}),[])},shaka.dash.DashParser.prototype.parseAdaptationSet_=function(e,t){var r=this,n=shaka.util.TXml,a=shaka.util.Functional,i=shaka.util.ManifestParserUtils,o=i.ContentType,s=shaka.dash.ContentProtection;e.adaptationSet=this.createFrame_(t,e.period,null);var l,u=!1,c=n.findChildren(t,"Role"),d=c.map((function(e){return e.attributes.value})).filter(a.isNotNull),p=void 0;(a=e.adaptationSet.contentType==o.TEXT)&&(p=i.TextStreamKind.SUBTITLE);for(var h=(c=$jscomp.makeIterator(c)).next();!h.done;h=c.next()){var f=(h=h.value).attributes.schemeIdUri;if(null==f||"urn:mpeg:dash:role:2011"==f)switch(h=h.attributes.value,h){case"main":u=!0;break;case"caption":case"subtitle":p=h}}f=function(e){switch(e){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}};var m=n.findChildren(t,"EssentialProperty");c=null;var g=!1;h=!1;for(var y=(m=$jscomp.makeIterator(m)).next();!y.done;y=m.next()){var v=(y=y.value).attributes.schemeIdUri;"http://dashif.org/guidelines/trickmode"==v?c=y.attributes.value:"urn:mpeg:mpegB:cicp:TransferCharacteristics"==v?l=f(parseInt(y.attributes.value,10)):"urn:mpeg:mpegB:cicp:ColourPrimaries"!=v&&"urn:mpeg:mpegB:cicp:MatrixCoefficients"!=v&&("urn:mpeg:dash:ssr:2023"==v?g=!0:h=!0)}var _=null;for(m=n.findChildren(t,"SupplementalProperty"),y=(m=$jscomp.makeIterator(m)).next();!y.done;y=m.next())"http://dashif.org/guidelines/last-segment-number"==(v=(y=y.value).attributes.schemeIdUri)?_=parseInt(y.attributes.value,10)-1:"urn:mpeg:mpegB:cicp:TransferCharacteristics"==v&&(l=f(parseInt(y.attributes.value,10)));m=n.findChildren(t,"Accessibility"),f=shaka.util.LanguageUtils;var k=new Map;for(y=(m=$jscomp.makeIterator(m)).next();!y.done;y=m.next())if(y=(v=y.value).attributes.schemeIdUri,v=v.attributes.value,"urn:scte:dash:cc:cea-608:2015"==y)if(y=1,null!=v){v=v.split(";");for(var E=$jscomp.makeIterator(v),b=E.next();!b.done;b=E.next()){var T=b.value,A=b=void 0;T.includes("=")?(b=(T=T.split("="))[0].startsWith("CC")?T[0]:"CC"+T[0],A=T[1]||"und"):(b="CC"+y,2==v.length?y+=2:y++,A=T),k.set(b,f.normalize(A))}}else k.set("CC1","und");else if("urn:scte:dash:cc:cea-708:2015"==y)if(y=1,null!=v)for(b=(v=$jscomp.makeIterator(v.split(";"))).next();!b.done;b=v.next())T=E=void 0,(b=b.value).includes("=")?(E="svc"+(b=b.split("="))[0],T=b[1].split(",")[0].split(":").pop()):(E="svc"+y,y++,T=b),k.set(E,f.normalize(T));else k.set("svc1","und");else if("urn:mpeg:dash:role:2011"==y)null!=v&&(d.push(v),"captions"==v&&(p=i.TextStreamKind.CLOSED_CAPTION));else if("urn:tva:metadata:cs:AudioPurposeCS:2007"==y)if("1"==v)var S=shaka.media.ManifestParser.AccessibilityPurpose.VISUALLY_IMPAIRED;else"2"==v&&(S=shaka.media.ManifestParser.AccessibilityPurpose.HARD_OF_HEARING);if(h)return null;i=n.findChildren(t,"ContentProtection");var C=s.parseFromAdaptationSet(i,this.config_.dash.ignoreDrmInfo,this.config_.dash.keySystemsByURI),P=shaka.util.LanguageUtils.normalize(e.adaptationSet.language||"und"),x=t.attributes.label;if((s=n.findChildren(t,"Label"))&&s.length&&(s=shaka.util.TXml.getTextContents(s[0]))&&(x=s),0==(t=(n=n.findChildren(t,"Representation")).map((function(t){return(t=r.parseRepresentation_(e,C,p,P,x,u,d,k,t,S,_))&&(t.hdr=t.hdr||l,t.fastSwitching=g),t})).filter((function(e){return!!e}))).length){if(c=e.adaptationSet.contentType==o.IMAGE,this.config_.dash.ignoreEmptyAdaptationSet||a||c)return null;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.DASH_EMPTY_ADAPTATION_SET)}if(!e.adaptationSet.contentType||e.adaptationSet.contentType==o.APPLICATION)for(e.adaptationSet.contentType=shaka.dash.DashParser.guessContentType_(t[0].mimeType,t[0].codecs),s=(o=$jscomp.makeIterator(t)).next();!s.done;s=o.next())s.value.type=e.adaptationSet.contentType;for(o=e.adaptationSet.id||"__fake__"+this.globalId_++,s=(a=$jscomp.makeIterator(t)).next();!s.done;s=a.next()){for(s=s.value,h=(i=$jscomp.makeIterator(C.drmInfos)).next();!h.done;h=i.next())(h=h.value).keyIds=h.keyIds&&s.keyIds?new Set([].concat($jscomp.arrayFromIterable(h.keyIds),$jscomp.arrayFromIterable(s.keyIds))):h.keyIds||s.keyIds;this.config_.dash.enableAudioGroups&&(s.groupId=o)}return a=n.map((function(e){return e.attributes.id})).filter(shaka.util.Functional.isNotNull),{id:o,contentType:e.adaptationSet.contentType,language:P,main:u,streams:t,drmInfos:C.drmInfos,trickModeFor:c,representationIds:a}},shaka.dash.DashParser.prototype.parseRepresentation_=function(e,t,r,n,a,i,o,s,l,u,c){var d=this,p=shaka.util.TXml,h=shaka.util.ManifestParserUtils.ContentType;if(e.representation=this.createFrame_(l,e.adaptationSet,null),this.minTotalAvailabilityTimeOffset_=Math.min(this.minTotalAvailabilityTimeOffset_,e.representation.availabilityTimeOffset),!this.verifyRepresentation_(e.representation))return shaka.log.warning("Skipping Representation",e.representation),null;var f=e.periodInfo.start;e.bandwidth=p.parseAttr(l,"bandwidth",p.parsePositiveInt)||0;var m,g,y=e.representation.contentType,v=y==h.TEXT||y==h.APPLICATION;h=y==h.IMAGE;try{var _=void 0;if(t.aes128Info){var k=e.representation.getBaseUris,E=shaka.util.ManifestParserUtils.resolveUris(k(),[t.aes128Info.keyUri]),b=shaka.net.NetworkingEngine.RequestType.KEY,T=shaka.net.NetworkingEngine.makeRequest(E,this.config_.retryParameters);_={bitsKey:128,blockCipherMode:"CBC",iv:t.aes128Info.iv,firstMediaSequenceNumber:0,fetchKey:function(){var e,t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return n.yield(d.makeNetworkRequest_(T,b),2);if(3!=n.nextAddress){if(!(e=n.yieldResult).data||16!=e.data.byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.AES_128_INVALID_KEY_LENGTH);return t={name:"AES-CBC"},r=_,n.yield(window.crypto.subtle.importKey("raw",e.data,t,!0,["decrypt"]),3)}r.cryptoKey=n.yieldResult,_.fetchKey=void 0,n.jumpToEnd()}))}}}if(k=function(e,t,r,n){return d.requestSegment_(e,t,r,n)},e.representation.segmentBase)var A=shaka.dash.SegmentBase.createStreamInfo(e,k,_);else if(e.representation.segmentList)A=shaka.dash.SegmentList.createStreamInfo(e,this.streamMap_,_);else if(e.representation.segmentTemplate)A=shaka.dash.SegmentTemplate.createStreamInfo(e,k,this.streamMap_,!!this.manifest_,this.config_.dash.initialSegmentLimit,this.periodDurations_,_,c);else{goog.asserts.assert(v,"Must have Segment* with non-text streams.");var S=e.periodInfo.duration||0,C=e.representation.getBaseUris;A={generateSegmentIndex:function(){var t=shaka.media.SegmentIndex.forSingleSegment(f,S,C());return t.forEachTopLevelReference((function(t){t.mimeType=e.representation.mimeType,t.codecs=e.representation.codecs})),Promise.resolve(t)}}}}catch(e){if((v||h)&&e.code==shaka.util.Error.Code.DASH_NO_SEGMENT_INFO)return null;throw e}if(c=p.findChildren(l,"ContentProtection"),c=shaka.dash.ContentProtection.parseFromRepresentation(c,t,this.config_.dash.ignoreDrmInfo,this.config_.dash.keySystemsByURI),c=new Set(c?[c]:[]),k=!1,p.findChildren(l,"SupplementalProperty").some((function(e){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==e.attributes.schemeIdUri&&"JOC"==e.attributes.value}))&&(k=!0),E=!1,v&&(E=o.includes("forced_subtitle")||o.includes("forced-subtitle")),h&&((l=p.findChildren(l,"EssentialProperty").find((function(e){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(e.attributes.schemeIdUri)})))&&(m=l.attributes.value),!m))return null;l=e.representation.codecs,e.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(l.includes("hvc1.2.4.L153.B0")||l.includes("hev1.2.4.L153.B0"))&&(g="PQ");var P=(p=e.representation.id?e.period.id+","+e.representation.id:"")&&this.streamMap_[p]?this.streamMap_[p]:{id:this.globalId_++,originalId:e.representation.id,groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){P.segmentIndex&&(P.segmentIndex.release(),P.segmentIndex=null)},segmentIndex:null,mimeType:e.representation.mimeType,codecs:l,frameRate:e.representation.frameRate,pixelAspectRatio:e.representation.pixelAspectRatio,bandwidth:e.bandwidth,width:e.representation.width,height:e.representation.height,kind:r,encrypted:0<t.drmInfos.length,drmInfos:t.drmInfos,keyIds:c,language:n,originalLanguage:e.adaptationSet.language,label:a,type:e.adaptationSet.contentType,primary:i,trickModeVideo:null,emsgSchemeIdUris:e.representation.emsgSchemeIdUris,roles:o,forced:E,channelsCount:e.representation.numChannels,audioSamplingRate:e.representation.audioSamplingRate,spatialAudio:k,closedCaptions:s,hdr:g,videoLayout:void 0,tilesLayout:m,accessibilityPurpose:u,external:!1,fastSwitching:!1,fullMimeTypes:new Set([shaka.util.MimeUtils.getFullType(e.representation.mimeType,e.representation.codecs)])};return P.createSegmentIndex=function(){var e;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress)return P.segmentIndex?t.jumpTo(0):(e=P,t.yield(A.generateSegmentIndex(),3));e.segmentIndex=t.yieldResult,t.jumpToEnd()}))},p&&e.dynamic&&!this.streamMap_[p]&&(this.streamMap_[p]=P),P},shaka.dash.DashParser.prototype.onUpdate_=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){switch(n.nextAddress){case 1:return goog.asserts.assert(0<=r.updatePeriod_,"There should be an update period"),shaka.log.info("Updating manifest..."),e=0,n.setCatchFinallyBlocks(2),n.yield(r.requestManifest_(),4);case 4:e=n.yieldResult,n.leaveTryBlock(3);break;case 2:if(t=n.enterCatchBlock(),goog.asserts.assert(t instanceof shaka.util.Error,"Should only receive a Shaka error"),r.playerInterface_){if(r.config_.raiseFatalErrorOnManifestUpdateRequestFailure)return r.playerInterface_.onError(t),n.return();t.severity=shaka.util.Error.Severity.RECOVERABLE,r.playerInterface_.onError(t)}case 3:if(!r.playerInterface_)return n.return();r.playerInterface_.onManifestUpdated(),r.setUpdateTimer_(e),n.jumpToEnd()}}))},shaka.dash.DashParser.prototype.updateNow_=function(){this.updateTimer_.tickNow()},shaka.dash.DashParser.prototype.setUpdateTimer_=function(e){if(!(0>this.updatePeriod_)){var t=this.updatePeriod_;0<=this.config_.dash.updatePeriod&&(t=this.config_.dash.updatePeriod),e=Math.max(t-e,this.averageUpdateDuration_.getEstimate()),this.updateTimer_.tickAfter(e)}},shaka.dash.DashParser.prototype.createFrame_=function(e,t,r){var n=this;goog.asserts.assert(t||r,"Must provide either parent or getBaseUris");var a=shaka.util.ManifestParserUtils,i=shaka.util.TXml;t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,numChannels:null,audioSamplingRate:null,availabilityTimeOffset:0,segmentSequenceCadence:0},r=r||t.getBaseUris;var o,s=i.parseNonNegativeInt,l=i.evalDivision,u=e.attributes.id,c=i.findChildren(e,"BaseURL"),d=!1;if(this.contentSteeringManager_)for(var p=$jscomp.makeIterator(c),h=p.next();!h.done;h=p.next()){var f=h.value;h=f.attributes.serviceLocation,f=i.getContents(f),h&&f&&(this.contentSteeringManager_.addLocation(u,h,f),d=!0)}d&&this.contentSteeringManager_||(o=c.map(i.getContents)),p=e.attributes.contentType||t.contentType,h=e.attributes.mimeType||t.mimeType,f=e.attributes.codecs||t.codecs,l=i.parseAttr(e,"frameRate",l)||t.frameRate;var m=e.attributes.sar||t.pixelAspectRatio,g=this.emsgSchemeIdUris_(i.findChildren(e,"InbandEventStream"),t.emsgSchemeIdUris),y=i.findChildren(e,"AudioChannelConfiguration");y=this.parseAudioChannels_(y)||t.numChannels;var v=i.parseAttr(e,"audioSamplingRate",s)||t.audioSamplingRate;p||(p=shaka.dash.DashParser.guessContentType_(h,f));var _=i.findChild(e,"SegmentBase"),k=i.findChild(e,"SegmentTemplate"),E=_&&i.parseAttr(_,"availabilityTimeOffset",i.parseFloat)||0,b=k&&i.parseAttr(k,"availabilityTimeOffset",i.parseFloat)||0,T=c&&c.length&&i.parseAttr(c[0],"availabilityTimeOffset",i.parseFloat)||0;return E=t.availabilityTimeOffset+T+E+b,b=null,(T=i.findChild(e,"SegmentSequenceProperties"))&&(T=i.findChild(T,"SAP"))&&(b=i.parseAttr(T,"cadence",i.parseInt)),{getBaseUris:function(){return a.resolveUris(r(),c.length?n.contentSteeringManager_&&d?n.contentSteeringManager_.getLocations(u):o||[]:[])},segmentBase:_||t.segmentBase,segmentList:i.findChild(e,"SegmentList")||t.segmentList,segmentTemplate:k||t.segmentTemplate,width:i.parseAttr(e,"width",s)||t.width,height:i.parseAttr(e,"height",s)||t.height,contentType:p,mimeType:h,codecs:f,frameRate:l,pixelAspectRatio:m,emsgSchemeIdUris:g,id:u,language:e.attributes.lang,numChannels:y,audioSamplingRate:v,availabilityTimeOffset:E,segmentSequenceCadence:b||t.segmentSequenceCadence}},shaka.dash.DashParser.prototype.emsgSchemeIdUris_=function(e,t){t=t.slice();for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())r=r.value.attributes.schemeIdUri,t.includes(r)||t.push(r);return t},shaka.dash.DashParser.prototype.parseAudioChannels_=function(e){for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){var r=t.value;if((t=r.attributes.schemeIdUri)&&(r=r.attributes.value))switch(t){case"urn:mpeg:dash:outputChannelPositionList:2012":return r.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":var n=parseInt(r,10);if(!n){shaka.log.warning("Channel parsing failure! Ignoring scheme and value",t,r);continue}return n;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(n=parseInt(r,16))){shaka.log.warning("Channel parsing failure! Ignoring scheme and value",t,r);continue}for(e=0;n;)1&n&&++e,n>>=1;return e;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":n=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14];var a=parseInt(r,10);if(!a){shaka.log.warning("Channel parsing failure! Ignoring scheme and value",t,r);continue}if(0<a&&a<n.length)return n[a];continue;default:shaka.log.warning("Unrecognized audio channel scheme:",t,r)}}return null},shaka.dash.DashParser.prototype.verifyRepresentation_=function(e){var t=shaka.util.ManifestParserUtils.ContentType,r=e.segmentBase?1:0;return r+=e.segmentList?1:0,0==(r+=e.segmentTemplate?1:0)?e.contentType==t.TEXT||e.contentType==t.APPLICATION||(shaka.log.warning("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',e),!1):(1!=r&&(shaka.log.warning("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",e),e.segmentBase?(shaka.log.info("Using SegmentBase by default."),e.segmentList=null):(goog.asserts.assert(e.segmentList,"There should be a SegmentList"),shaka.log.info("Using SegmentList by default.")),e.segmentTemplate=null),!0)},shaka.dash.DashParser.prototype.requestForTiming_=function(e,t,r){var n,a,i,o,s,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){if(1==p.nextAddress)return n=[shaka.util.StringUtils.htmlUnescape(t)],a=shaka.util.ManifestParserUtils.resolveUris(e(),n),(i=shaka.net.NetworkingEngine.makeRequest(a,d.config_.retryParameters)).method=r,o=shaka.net.NetworkingEngine.RequestType.TIMING,s=d.playerInterface_.networkingEngine.request(o,i),d.operationManager_.manage(s),p.yield(s.promise,2);if(l=p.yieldResult,"HEAD"==r){if(!l.headers||!l.headers.date)return shaka.log.warning("UTC timing response is missing","expected date header"),p.return(0);u=l.headers.date}else u=shaka.util.StringUtils.fromUTF8(l.data);return c=Date.parse(u),isNaN(c)?(shaka.log.warning("Unable to parse date from UTC timing response"),p.return(0)):p.return(c-Date.now())}))},shaka.dash.DashParser.prototype.parseUtcTiming_=function(e,t){var r,n,a,i,o,s,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){switch(p.nextAddress){case 1:r=t.map((function(e){return{scheme:e.attributes.schemeIdUri,value:e.attributes.value}})),n=d.config_.dash.clockSyncUri,!r.length&&n&&r.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:n}),a=$jscomp.makeIterator(r),i=a.next();case 2:if(i.done){p.jumpTo(4);break}switch(o=i.value,p.setCatchFinallyBlocks(5),s=o.scheme,l=o.value,s){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return p.jumpTo(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return p.jumpTo(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return u=Date.parse(l),p.return(isNaN(u)?0:u-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":shaka.log.alwaysWarn("NTP UTCTiming scheme is not supported");break;default:shaka.log.alwaysWarn("Unrecognized scheme in UTCTiming element",s)}p.jumpTo(9);break;case 7:return p.yield(d.requestForTiming_(e,l,"HEAD"),10);case 10:return p.return(p.yieldResult);case 8:return p.yield(d.requestForTiming_(e,l,"GET"),11);case 11:return p.return(p.yieldResult);case 9:p.leaveTryBlock(3);break;case 5:c=p.enterCatchBlock(),shaka.log.warning("Error fetching time from UTCTiming elem",c.message);case 3:i=a.next(),p.jumpTo(2);break;case 4:return shaka.log.alwaysWarn("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),p.return(0)}}))},shaka.dash.DashParser.prototype.parseEventStream_=function(e,t,r,n){for(var a=shaka.util.TXml,i=shaka.util.TXml.parseNonNegativeInt,o=r.attributes.schemeIdUri||"",s=r.attributes.value||"",l=a.parseAttr(r,"timescale",i)||1,u=(r=$jscomp.makeIterator(a.findChildren(r,"Event"))).next();!u.done;u=r.next()){u=u.value;var c=a.parseAttr(u,"presentationTime",i)||0,d=a.parseAttr(u,"duration",i)||0;d=(c=c/l+e)+d/l,null!=t&&(c=Math.min(c,e+t),d=Math.min(d,e+t)),d<n||(u={schemeIdUri:o,value:s,startTime:c,endTime:d,id:u.attributes.id||"",eventElement:a.txmlNodeToDomElement(u),eventNode:u},this.playerInterface_.onTimelineRegionAdded(u))}},shaka.dash.DashParser.prototype.requestSegment_=function(e,t,r,n){var a,i,o,s,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){return 1==u.nextAddress?(a=shaka.net.NetworkingEngine.RequestType.SEGMENT,i=n?shaka.net.NetworkingEngine.AdvancedRequestType.INIT_SEGMENT:shaka.net.NetworkingEngine.AdvancedRequestType.MEDIA_SEGMENT,o=shaka.util.Networking.createSegmentRequest(e,t,r,l.config_.retryParameters),u.yield(l.makeNetworkRequest_(o,a,{type:i}),2)):(s=u.yieldResult,u.return(s.data))}))},shaka.dash.DashParser.guessContentType_=function(e,t){return t=shaka.util.MimeUtils.getFullType(e,t),shaka.text.TextEngine.isTypeSupported(t)?shaka.util.ManifestParserUtils.ContentType.TEXT:e.split("/")[0]},shaka.dash.DashParser.prototype.makeNetworkRequest_=function(e,t,r){return e=this.playerInterface_.networkingEngine.request(t,e,r),this.operationManager_.manage(e),e.promise},goog.exportSymbol("shaka.dash.DashParser",shaka.dash.DashParser),shaka.media.ManifestParser.registerParserByMime("application/dash+xml",(function(){return new shaka.dash.DashParser})),shaka.media.ManifestParser.registerParserByMime("video/vnd.mpeg.dash.mpd",(function(){return new shaka.dash.DashParser})),shaka.dependencies=function(){},shaka.dependencies.add=function(e,t){if(!shaka.dependencies.Allowed[e])throw Error(e+" is not supported");e==shaka.dependencies.Allowed.muxjs?shaka.Deprecate.deprecateFeature(5,"mux.js","mux.js is no longer used in Shaka Player."):shaka.dependencies.dependencies_.set(e,(function(){return t}))},shaka.dependencies.has=function(e){return shaka.dependencies.dependencies_.has(e)},shaka.dependencies.isoBoxer=function(){return shaka.dependencies.dependencies_.get(shaka.dependencies.Allowed.ISOBoxer)()},goog.exportSymbol("shaka.dependencies",shaka.dependencies),goog.exportProperty(shaka.dependencies,"has",shaka.dependencies.has),goog.exportProperty(shaka.dependencies,"add",shaka.dependencies.add),shaka.dependencies.Allowed={muxjs:"muxjs",ISOBoxer:"ISOBoxer"},goog.exportProperty(shaka.dependencies,"Allowed",shaka.dependencies.Allowed),shaka.dependencies.dependencies_=new Map([[shaka.dependencies.Allowed.ISOBoxer,function(){return window.ISOBoxer}]]),shaka.hls={},shaka.hls.Playlist=function(e,t,r){this.type=e,this.tags=t,this.segments=r||null},shaka.hls.PlaylistType={MASTER:0,MEDIA:1},shaka.hls.Tag=function(e,t,r,n){this.id=e,this.name=t,this.attributes=r,this.value=void 0===n?null:n},shaka.hls.Tag.prototype.toString=function(e){var t=function(e){var t=isNaN(Number(e.value))?'"'+e.value+'"':e.value;return e.name+"="+t},r="#"+this.name;return t=this.attributes?this.attributes.filter((function(t){return!e||!e.has(t.name)})).map(t):[],this.value&&t.unshift(this.value),0<t.length&&(r+=":"+t.join(",")),r},shaka.hls.Tag.prototype.getTagKey=function(){var e=(new Set).add("AUDIO").add("VIDEO").add("SUBTITLES").add("PATHWAY-ID").add("GROUP-ID").add("URI");return this.toString(e)},shaka.hls.Tag.prototype.addAttribute=function(e){this.attributes.push(e)},shaka.hls.Tag.prototype.getAttribute=function(e){var t=this.attributes.filter((function(t){return t.name==e}));return goog.asserts.assert(2>t.length,"A tag should not have multiple attributes with the same name!"),t.length?t[0]:null},shaka.hls.Tag.prototype.getAttributeValue=function(e,t){return(e=this.getAttribute(e))?e.value:t||null},shaka.hls.Tag.prototype.getRequiredAttrValue=function(e){var t=this.getAttribute(e);if(!t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_REQUIRED_ATTRIBUTE_MISSING,e);return t.value},shaka.hls.Tag.prototype.setName=function(e){this.name=e},shaka.hls.Segment=function(e,t,r){r=void 0===r?[]:r,this.tags=t,this.verbatimSegmentUri=e,this.partialSegments=r},shaka.hls.Attribute=function(e,t){this.name=e,this.value=t},shaka.hls.Utils=function(){},shaka.hls.Utils.filterTagsByName=function(e,t){return e.filter((function(e){return e.name==t}))},shaka.hls.Utils.filterTagsByType=function(e,t){return e.filter((function(e){return e.getRequiredAttrValue("TYPE")==t}))},shaka.hls.Utils.getFirstTagWithName=function(e,t){for(var r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())if((r=r.value).name===t)return r;return null},shaka.hls.Utils.getFirstTagWithNameAsNumber=function(e,t,r){return r=void 0===r?0:r,(e=shaka.hls.Utils.getFirstTagWithName(e,t))?Number(e.value):r},shaka.hls.Utils.constructSegmentUris=function(e,t,r){return t?shaka.hls.Utils.constructUris(e,[t],r):[]},shaka.hls.Utils.constructUris=function(e,t,r){if(!t.length)return[];t=shaka.util.ManifestParserUtils.resolveUris(e,t),e=[];for(var n=(t=$jscomp.makeIterator(t)).next();!n.done;n=t.next())e.push(shaka.hls.Utils.variableSubstitution(n.value,r));return e},shaka.hls.Utils.variableSubstitution=function(e,t){if(!t||!t.size)return e;var r=(e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}")).match(/{\$\w*}/g);if(r)for(var n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next()){var a=(n=n.value).slice(2,n.length-1),i=t.get(a);if(!i)throw shaka.log.error("A variable has been found that is not declared",a),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_VARIABLE_NOT_FOUND,a);e=e.replace(n,i)}return e},shaka.hls.Utils.isComment=function(e){return/^#(?!EXT)/m.test(e)},shaka.util.TextParser=function(e){this.data_=e||"",this.position_=0},shaka.util.TextParser.prototype.atEnd=function(){return this.position_==this.data_.length},shaka.util.TextParser.prototype.readLine=function(){return this.readRegexReturnCapture_(/(.*?)(\n|$)/gm,1)},shaka.util.TextParser.prototype.readWord=function(){return this.readRegexReturnCapture_(/[^ \t\n]*/gm,0)},shaka.util.TextParser.prototype.skipWhitespace=function(){this.readRegex(/[ \t]+/gm)},shaka.util.TextParser.prototype.readRegex=function(e){return e=this.indexOf_(e),this.atEnd()||null==e||e.position!=this.position_?null:(this.position_+=e.length,e.results)},shaka.util.TextParser.prototype.readRegexReturnCapture_=function(e,t){return this.atEnd()?null:(e=this.readRegex(e))?e[t]:null},shaka.util.TextParser.prototype.indexOf_=function(e){return goog.asserts.assert(e.global,"global flag should be set"),e.lastIndex=this.position_,null==(e=e.exec(this.data_))?null:{position:e.index,length:e[0].length,results:e}},shaka.hls.ManifestTextParser=function(){this.globalId_=0},shaka.hls.ManifestTextParser.prototype.parsePlaylist=function(e){var t=shaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS,r=shaka.hls.ManifestTextParser.SEGMENT_TAGS,n=(e=(e=shaka.util.StringUtils.fromUTF8(e)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(n[0]))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_PLAYLIST_HEADER_MISSING);e=shaka.hls.PlaylistType.MASTER;for(var a=!0,i=$jscomp.makeIterator(n),o=i.next();!o.done;o=i.next())if(o=o.value,shaka.hls.Utils.isComment(o)||a)a=!1;else{if(o=this.parseTag_(o),--this.globalId_,t.includes(o.name)){e=shaka.hls.PlaylistType.MEDIA;break}"EXT-X-STREAM-INF"==o.name&&(a=!0)}for(t=[],a=!0,i=0;i<n.length;i++){var s=n[i];if(o=n[i+1],shaka.hls.Utils.isComment(s)||a)a=!1;else{if(s=this.parseTag_(s),r.includes(s.name)){if(e!=shaka.hls.PlaylistType.MEDIA)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_INVALID_PLAYLIST_HIERARCHY);return r=n.splice(i,n.length-i),r=this.parseSegments_(r,t),new shaka.hls.Playlist(e,t,r)}t.push(s),"EXT-X-STREAM-INF"==s.name&&(a=new shaka.hls.Attribute("URI",o),s.addAttribute(a),a=!0)}}return new shaka.hls.Playlist(e,t)},shaka.hls.ManifestTextParser.prototype.parseSegments_=function(e,t){for(var r=[],n=[],a=[],i=null,o=(e=$jscomp.makeIterator(e)).next();!o.done;o=e.next())o=o.value,/^(#EXT)/.test(o)?(o=this.parseTag_(o),shaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS.includes(o.name)?t.push(o):"EXT-X-MAP"==o.name?i=o:"EXT-X-PART"==o.name?a.push(o):"EXT-X-PRELOAD-HINT"==o.name?"PART"==o.getAttributeValue("TYPE")?a.push(o):"MAP"==o.getAttributeValue("TYPE")&&(o.setName("EXT-X-MAP"),i=o):n.push(o)):shaka.hls.Utils.isComment(o)||(o=o.trim(),i&&n.push(i),n=new shaka.hls.Segment(o,n,a),r.push(n),n=[],a=[]);return a.length&&(i&&n.push(i),t=new shaka.hls.Segment("",n,a),r.push(t)),r},shaka.hls.ManifestTextParser.prototype.parseTag_=function(e){return shaka.hls.ManifestTextParser.parseTag(this.globalId_++,e)},shaka.hls.ManifestTextParser.parseTag=function(e,t){var r=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!r)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.INVALID_HLS_TAG,t);t=r[1];var n,a=r[2];if(r=[],a){var i,o=(a=new shaka.util.TextParser(a)).readRegex(/^([^,=]+)(?:,|$)/g);for(o&&(n=o[1]),o=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;i=a.readRegex(o);)i=new shaka.hls.Attribute(i[1],i[2]||i[3]),r.push(i),a.skipWhitespace()}return new shaka.hls.Tag(e,t,r,n)},shaka.hls.ManifestTextParser.MEDIA_PLAYLIST_TAGS="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF".split(" "),shaka.hls.ManifestTextParser.SEGMENT_TAGS="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP".split(" "),shaka.net.DataUriPlugin=function(){},shaka.net.DataUriPlugin.parse=function(e,t,r,n){try{var a=shaka.net.DataUriPlugin.parseRaw(e);return shaka.util.AbortableOperation.completed({uri:e,originalUri:e,data:a.data,headers:{"content-type":a.contentType}})}catch(e){return shaka.util.AbortableOperation.failed(e)}},shaka.net.DataUriPlugin.parseRaw=function(e){var t=e.split(":");if(2>t.length||"data"!=t[0])throw shaka.log.error("Bad data URI, failed to parse scheme"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.MALFORMED_DATA_URI,e);if(2>(t=t.slice(1).join(":").split(",")).length)throw shaka.log.error("Bad data URI, failed to extract encoding and MIME type"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.MALFORMED_DATA_URI,e);var r=t[0];e=window.decodeURIComponent(t.slice(1).join(",")),t=r.split(";"),r=t[0];var n=!1;return 1<t.length&&"base64"==t[t.length-1]&&(n=!0,t.pop()),{data:n?shaka.util.Uint8ArrayUtils.fromBase64(e):shaka.util.StringUtils.toUTF8(e),contentType:r}},goog.exportSymbol("shaka.net.DataUriPlugin",shaka.net.DataUriPlugin),goog.exportProperty(shaka.net.DataUriPlugin,"parse",shaka.net.DataUriPlugin.parse),shaka.net.NetworkingEngine.registerScheme("data",shaka.net.DataUriPlugin.parse),shaka.media.SegmentUtils=function(){},shaka.media.SegmentUtils.getBasicInfoFromMimeType=function(e){var t=shaka.util.MimeUtils.getBasicType(e);return{type:t.split("/")[0],mimeType:t,codecs:e=shaka.util.MimeUtils.getCodecs(e),language:null,height:null,width:null,channelCount:null,sampleRate:null,closedCaptions:new Map,videoRange:null}},shaka.media.SegmentUtils.getBasicInfoFromTs=function(e){var t=shaka.util.BufferUtils.toUint8(e),r=(t=(new shaka.util.TsParser).parse(t)).getCodecs();t=t.getVideoInfo();var n=[],a=!1,i=!1;switch(r.audio){case"aac":case"aac-loas":n.push("mp4a.40.2"),a=!0;break;case"mp3":n.push("mp4a.40.34"),a=!0;break;case"ac3":n.push("ac-3"),a=!0;break;case"ec3":n.push("ec-3"),a=!0;break;case"opus":n.push("opus"),a=!0}switch(r.video){case"avc":t.codec?n.push(t.codec):n.push("avc1.42E01E"),i=!0;break;case"hvc":t.codec?n.push(t.codec):n.push("hvc1.1.6.L93.90"),i=!0;break;case"av1":n.push("av01.0.01M.08"),i=!0}if(!n.length)return null;if(r=a&&!i,a=new Map,i){(i=new shaka.media.ClosedCaptionParser("video/mp2t")).parseFrom(e);for(var o=(e=$jscomp.makeIterator(i.getStreams())).next();!o.done;o=e.next())o=o.value,a.set(o,o);i.reset()}return{type:r?"audio":"video",mimeType:"video/mp2t",codecs:n.join(", "),language:null,height:t.height,width:t.width,channelCount:null,sampleRate:null,closedCaptions:a,videoRange:null}},shaka.media.SegmentUtils.getBasicInfoFromMp4=function(e,t){var r,n=shaka.util.Mp4Parser,a=shaka.media.SegmentUtils,i=[],o=[],s=!1,l=!1,u=function(e){switch(e=e.toLowerCase()){case"avc1":case"avc3":o.push(e+".42E01E"),l=!0;break;case"hev1":case"hvc1":o.push(e+".1.6.L93.90"),l=!0;break;case"dvh1":case"dvhe":o.push(e+".05.04"),l=!0;break;case"vp09":o.push(e+".00.10.08"),l=!0;break;case"av01":o.push(e+".0.01M.08"),l=!0;break;case"mp4a":i.push("mp4a.40.2"),s=!0;break;case"ac-3":case"ec-3":case"opus":case"flac":i.push(e),s=!0}},c=function(e){return u(e.name)},d=null,p=null,h=null,f=null,m=null,g=null;if((new n).box("moov",n.children).box("trak",n.children).fullBox("tkhd",(function(e){goog.asserts.assert(null!=e.version,"TKHD is a full box and should have a valid version."),e=shaka.util.Mp4BoxParsers.parseTKHD(e.reader,e.version),p=String(e.height),h=String(e.width)})).box("mdia",n.children).fullBox("mdhd",(function(e){goog.asserts.assert(null!=e.version,"MDHD is a full box and should have a valid version."),d=shaka.util.Mp4BoxParsers.parseMDHD(e.reader,e.version).language})).box("minf",n.children).box("stbl",n.children).fullBox("stsd",n.sampleDescription).box("mp4a",(function(e){var t=shaka.util.Mp4BoxParsers.parseMP4A(e.reader);f=t.channelCount,m=t.sampleRate,e.reader.hasMoreData()?n.children(e):c(e)})).box("esds",(function(e){e=shaka.util.Mp4BoxParsers.parseESDS(e.reader),i.push(e.codec),s=!0})).box("ac-3",c).box("ec-3",c).box("opus",c).box("Opus",c).box("fLaC",c).box("avc1",(function(e){r=e.name,n.visualSampleEntry(e)})).box("avc3",(function(e){r=e.name,n.visualSampleEntry(e)})).box("hev1",(function(e){r=e.name,n.visualSampleEntry(e)})).box("hvc1",(function(e){r=e.name,n.visualSampleEntry(e)})).box("dva1",(function(e){r=e.name,n.visualSampleEntry(e)})).box("dvav",(function(e){r=e.name,n.visualSampleEntry(e)})).box("dvh1",(function(e){r=e.name,n.visualSampleEntry(e)})).box("dvhe",(function(e){r=e.name,n.visualSampleEntry(e)})).box("vp09",(function(e){r=e.name,n.visualSampleEntry(e)})).box("av01",(function(e){r=e.name,n.visualSampleEntry(e)})).box("avcC",(function(e){var t=r||"";switch(r){case"dvav":t="avc3";break;case"dva1":t="avc1"}e=shaka.util.Mp4BoxParsers.parseAVCC(t,e.reader,e.name),o.push(e.codec),l=!0})).box("hvcC",(function(e){var t=r||"";switch(r){case"dvh1":t="hvc1";break;case"dvhe":t="hev1"}e=shaka.util.Mp4BoxParsers.parseHVCC(t,e.reader,e.name),o.push(e.codec),l=!0})).box("dvcC",(function(e){var t=r||"";switch(r){case"hvc1":t="dvh1";break;case"hev1":t="dvhe";break;case"avc1":t="dva1";break;case"avc3":t="dvav"}e=shaka.util.Mp4BoxParsers.parseDVCC(t,e.reader,e.name),o.push(e.codec),l=!0})).fullBox("vpcC",(function(e){e=shaka.util.Mp4BoxParsers.parseVPCC(r||"",e.reader,e.name),o.push(e.codec),l=!0})).box("av1C",(function(e){e=shaka.util.Mp4BoxParsers.parseAV1C(r||"",e.reader,e.name),o.push(e.codec),l=!0})).box("enca",n.audioSampleEntry).box("encv",n.visualSampleEntry).box("sinf",n.children).box("frma",(function(e){e=shaka.util.Mp4BoxParsers.parseFRMA(e.reader).codec,u(e)})).box("colr",(function(e){g=shaka.util.Mp4BoxParsers.parseCOLR(e.reader).videoRange})).parse(e||t,!0),!i.length&&!o.length)return null;var y=s&&!l,v=new Map;if(l){var _=new shaka.media.ClosedCaptionParser("video/mp4");for(e&&_.init(e),_.parseFrom(t),t=(e=$jscomp.makeIterator(_.getStreams())).next();!t.done;t=e.next())t=t.value,v.set(t,t);_.reset()}return _=i.concat(o),{type:y?"audio":"video",mimeType:y?"audio/mp4":"video/mp4",codecs:a.codecsFiltering(_).join(", "),language:d,height:p,width:h,channelCount:f,sampleRate:m,closedCaptions:v,videoRange:g}},shaka.media.SegmentUtils.codecsFiltering=function(e){var t=shaka.util.ManifestParserUtils.ContentType,r=shaka.util.ManifestParserUtils,n=shaka.media.SegmentUtils;e=n.filterDuplicateCodecs_(e);var a=r.guessAllCodecsSafe(t.AUDIO,e),i=r.guessAllCodecsSafe(t.VIDEO,e);return t=r.guessAllCodecsSafe(t.TEXT,e),n=n.chooseBetterCodecs_(i),n=a.concat(n).concat(t),e.length&&!n.length?e:n},shaka.media.SegmentUtils.filterDuplicateCodecs_=function(e){for(var t=new Set,r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){n=n.value;var a=shaka.util.MimeUtils.getCodecBase(n);t.has(a)?shaka.log.debug("Ignoring duplicate codec"):(r.push(n),t.add(a))}return r},shaka.media.SegmentUtils.chooseBetterCodecs_=function(e){if(1>=e.length)return e;var t=e.find((function(e){return e.startsWith("dvh1.")||e.startsWith("dvhe.")}));return t?shaka.media.Capabilities.isTypeSupported('video/mp4; codecs="'+t+'"')?[t]:e.filter((function(e){return e!=t})):e},shaka.media.SegmentUtils.getDefaultKID=function(e){var t=shaka.util.Mp4Parser,r=null;return(new t).box("moov",t.children).box("trak",t.children).box("mdia",t.children).box("minf",t.children).box("stbl",t.children).fullBox("stsd",t.sampleDescription).box("encv",t.visualSampleEntry).box("enca",t.audioSampleEntry).box("sinf",t.children).box("schi",t.children).fullBox("tenc",(function(e){r=shaka.util.Mp4BoxParsers.parseTENC(e.reader).defaultKID})).parse(e,!0),r},shaka.hls.HlsParser=function(){var e=this;this.config_=this.playerInterface_=null,this.globalId_=1,this.globalVariables_=new Map,this.groupIdToStreamInfosMap_=new Map,this.mediaSequenceToStartTimeByType_=new Map;var t=shaka.util.ManifestParserUtils.ContentType;this.mediaSequenceToStartTimeByType_.set(t.VIDEO,new Map),this.mediaSequenceToStartTimeByType_.set(t.AUDIO,new Map),this.mediaSequenceToStartTimeByType_.set(t.TEXT,new Map),this.mediaSequenceToStartTimeByType_.set(t.IMAGE,new Map),this.variantUriSet_=new Set,this.uriToStreamInfosMap_=new Map,this.presentationTimeline_=null,this.masterPlaylistUri_="",this.manifestTextParser_=new shaka.hls.ManifestTextParser,this.minSequenceNumber_=-1,this.lowestSyncTime_=1/0,this.codecInfoInManifest_=this.streamsFinalized_=!1,this.updatePlaylistTimer_=new shaka.util.Timer((function(){e.onUpdate_()})),this.presentationType_=shaka.hls.HlsParser.PresentationType_.VOD,this.manifest_=null,this.maxTargetDuration_=0,this.lastTargetDuration_=1/0,this.lowLatencyPresentationDelay_=this.presentationDelay_=this.partialTargetDuration_=0,this.operationManager_=new shaka.util.OperationManager,this.groupIdToClosedCaptionsMap_=new Map,this.groupIdToCodecsMap_=new Map,this.mapTagToInitSegmentRefMap_=new Map,this.aesKeyInfoMap_=new Map,this.aesKeyMap_=new Map,this.identityKeyMap_=new Map,this.identityKidMap_=new Map,this.lowLatencyByterangeOptimization_=this.lowLatencyMode_=!1,this.averageUpdateDuration_=new shaka.abr.Ewma(5),this.contentSteeringManager_=null},shaka.hls.HlsParser.prototype.configure=function(e){this.config_=e,this.contentSteeringManager_&&this.contentSteeringManager_.configure(this.config_)},shaka.hls.HlsParser.prototype.start=function(e,t){var r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(goog.asserts.assert(n.config_,"Must call configure() before start()!"),n.playerInterface_=t,n.lowLatencyMode_=t.isLowLatencyMode(),a.yield(n.requestManifest_([e]),2)):3!=a.nextAddress?(r=a.yieldResult,n.masterPlaylistUri_=r.uri,goog.asserts.assert(r.data,"Response data should be non-null!"),a.yield(n.parseManifest_(r.data,e),3)):(goog.asserts.assert(n.manifest_,"Manifest should be non-null"),a.return(n.manifest_))}))},shaka.hls.HlsParser.prototype.stop=function(){this.updatePlaylistTimer_&&(this.updatePlaylistTimer_.stop(),this.updatePlaylistTimer_=null);var e=[];return this.operationManager_&&(e.push(this.operationManager_.destroy()),this.operationManager_=null),this.config_=this.playerInterface_=null,this.variantUriSet_.clear(),this.manifest_=null,this.uriToStreamInfosMap_.clear(),this.groupIdToStreamInfosMap_.clear(),this.groupIdToCodecsMap_.clear(),this.globalVariables_.clear(),this.mapTagToInitSegmentRefMap_.clear(),this.aesKeyInfoMap_.clear(),this.aesKeyMap_.clear(),this.identityKeyMap_.clear(),this.identityKidMap_.clear(),this.contentSteeringManager_&&this.contentSteeringManager_.destroy(),Promise.all(e)},shaka.hls.HlsParser.prototype.update=function(){var e,t,r,n,a,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){if(!u.isLive_())return c.return();for(e=[],t=Array.from(u.uriToStreamInfosMap_.values()),u.lastTargetDuration_=1/0,r=t.filter((function(e){return e.stream.segmentIndex})),n=$jscomp.makeIterator(r),a=n.next();!a.done;a=n.next())i=a.value,e.push(u.updateStream_(i));return c.yield(Promise.all(e),2)}u.notifySegmentsForStreams_(r.map((function(e){return e.stream}))),o=r.some((function(e){return 0==e.hasEndList})),r.length&&!o&&(s=shaka.hls.HlsParser.PresentationType_,u.setPresentationType_(s.VOD),l=r.map((function(e){return e.maxTimestamp})),u.presentationTimeline_.setDuration(Math.min.apply(Math,$jscomp.arrayFromIterable(l))),u.playerInterface_.updateDuration()),o&&u.determineDuration_(),c.jumpToEnd()}))},shaka.hls.HlsParser.prototype.getMediaSequenceToStartTimeFor_=function(e){return this.isLive_()?this.mediaSequenceToStartTimeByType_.get(e.type):e.mediaSequenceToStartTime},shaka.hls.HlsParser.prototype.updateStream_=function(e){var t,r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,C,P,x,w=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(I){if(1==I.nextAddress){for(t=[],r=$jscomp.makeIterator(e.getUris()),n=r.next();!n.done;n=r.next())a=n.value,i=new goog.Uri(a),o=i.getQueryData(),e.canBlockReload&&(0<=e.nextMediaSequence&&o.add("_HLS_msn",String(e.nextMediaSequence)),0<=e.nextPart&&o.add("_HLS_part",String(e.nextPart))),e.canSkipSegments&&o.add("_HLS_skip","YES"),o.getCount()&&i.setQueryData(o),t.push(i.toString());return I.yield(w.requestManifest_(t,!0),2)}if(3!=I.nextAddress){if(s=I.yieldResult,!e.stream.segmentIndex)return I.return();if((l=w.manifestTextParser_.parsePlaylist(s.data)).type!=shaka.hls.PlaylistType.MEDIA)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_INVALID_PLAYLIST_HIERARCHY);return(u=s.uri)==s.originalUri||e.getUris().includes(u)||e.redirectUris.push(u),c=shaka.hls.Utils.filterTagsByName(l.tags,"EXT-X-DEFINE"),d=w.parseMediaVariables_(c,u),p=e.stream,h=w.getMediaSequenceToStartTimeFor_(e),I.yield(w.parseDrmInfo_(l,p.mimeType,e.getUris,d),3)}f=I.yieldResult,m=f.keyIds,g=f.drmInfos,function(e,t){return e.size===t.size&&[].concat($jscomp.arrayFromIterable(e)).every((function(e){return t.has(e)}))}(p.keyIds,m)||(p.keyIds=m,p.drmInfos=g,w.playerInterface_.newDrmInfo(p)),y=w.createSegments_(l,p,h,d,e.getUris,e.type),v=y.segments,(_=y.bandwidth)&&(p.bandwidth=_),p.segmentIndex.mergeAndEvict(v,w.presentationTimeline_.getSegmentAvailabilityStart()),v.length&&(k=shaka.hls.Utils.getFirstTagWithNameAsNumber(l.tags,"EXT-X-MEDIA-SEQUENCE",0),b=(E=shaka.hls.Utils.getFirstTagWithName(l.tags,"EXT-X-SKIP"))?Number(E.getAttributeValue("SKIPPED-SEGMENTS")):0,T=w.getNextMediaSequenceAndPart_(k,v),A=T.nextMediaSequence,S=T.nextPart,e.nextMediaSequence=A+b,e.nextPart=S,C=h.get(k),p.segmentIndex.evict(C)),P=v[0],goog.asserts.assert(P,"Should have segments!"),e.minTimestamp=P.startTime,x=v[v.length-1],goog.asserts.assert(x,"Should have segments!"),e.maxTimestamp=x.endTime,shaka.hls.Utils.getFirstTagWithName(l.tags,"EXT-X-ENDLIST")&&(e.hasEndList=!0),w.determineLastTargetDuration_(l),I.jumpToEnd()}))},shaka.hls.HlsParser.prototype.onExpirationUpdated=function(e,t){},shaka.hls.HlsParser.prototype.onInitialVariantChosen=function(e){},shaka.hls.HlsParser.prototype.banLocation=function(e){this.contentSteeringManager_&&this.contentSteeringManager_.banLocation(e)},shaka.hls.HlsParser.prototype.syncStreamsWithSequenceNumber_=function(e){for(var t=-1==this.minSequenceNumber_,r=$jscomp.makeIterator(e),n=r.next();!n.done;n=r.next()){var a=(n=n.value).stream.segmentIndex;goog.asserts.assert(a,"Only loaded streams should be synced");var i=this.getMediaSequenceToStartTimeFor_(n);if(a=a.earliestReference()){if(goog.DEBUG){var o=i.values().next().value;shaka.log.warning(o==a.startTime,"Sequence number map is not ordered as expected!")}for(o=(i=$jscomp.makeIterator(i)).next();!o.done;o=i.next()){var s=(o=$jscomp.makeIterator(o.value)).next().value;if(o.next().value==a.startTime){t&&(this.minSequenceNumber_=Math.max(this.minSequenceNumber_,s)),n.firstSequenceNumber=s;break}}}}if(!(0>this.minSequenceNumber_))for(shaka.log.debug("Syncing HLS streams against base sequence number:",this.minSequenceNumber_),n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())t=n.value,this.ignoreManifestProgramDateTimeFor_(t.type)&&(r=t.stream.segmentIndex)&&(0<(n=this.minSequenceNumber_-t.firstSequenceNumber)&&(r.dropFirstReferences(n),r=r.earliestReference())&&(r=-r.startTime,t.stream.segmentIndex.offset(r),this.offsetStreamInfo_(t,r)))},shaka.hls.HlsParser.prototype.syncStreamsWithProgramDateTime_=function(e){if(1/0==this.lowestSyncTime_)for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){var r=t.value.stream.segmentIndex;goog.asserts.assert(r,"Only loaded streams should be synced"),null!=(r=r.earliestReference())&&null!=r.syncTime&&(this.lowestSyncTime_=Math.min(this.lowestSyncTime_,r.syncTime))}if(1/0!=(e=this.lowestSyncTime_))for(shaka.log.debug("Syncing HLS streams against base time:",e),t=(r=$jscomp.makeIterator(this.uriToStreamInfosMap_.values())).next();!t.done;t=r.next())if(t=t.value,!this.ignoreManifestProgramDateTimeFor_(t.type)){var n=t.stream.segmentIndex;if(null!=n){var a=n.earliestReference();if(null==a.syncTime)shaka.log.alwaysError("Missing EXT-X-PROGRAM-DATE-TIME for stream",t.getUris(),"Expect AV sync issues!");else for(this.offsetStreamInfo_(t,a.syncTime-e-a.startTime),n=(t=$jscomp.makeIterator(n)).next();!n.done;n=t.next())n.value.syncAgainst(e)}}},shaka.hls.HlsParser.prototype.offsetStreamInfo_=function(e,t){e.minTimestamp+=t,e.maxTimestamp+=t,goog.asserts.assert(0<=e.maxTimestamp,"Negative maxTimestamp after adjustment!");for(var r=this.getMediaSequenceToStartTimeFor_(e),n=$jscomp.makeIterator(r),a=n.next();!a.done;a=n.next()){var i=$jscomp.makeIterator(a.value);a=i.next().value,i=i.next().value,r.set(a,i+t)}shaka.log.debug("Offset",t,"applied to",e.getUris())},shaka.hls.HlsParser.prototype.parseManifest_=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,C,P,x,w,I,M,R,D,O,L,N,U,j,B=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(F){switch(F.nextAddress){case 1:return r=shaka.hls.Utils,goog.asserts.assert(B.masterPlaylistUri_,"Master playlist URI must be set before calling parseManifest_!"),n=B.manifestTextParser_.parsePlaylist(e),a=r.filterTagsByName(n.tags,"EXT-X-DEFINE"),i=[],o=[],s=[],goog.asserts.assert(null==B.presentationTimeline_,"Presentation timeline created early!"),B.presentationTimeline_=new shaka.media.PresentationTimeline(null,0),B.presentationTimeline_.setStatic(!0),l=function(){return[t]},n.type==shaka.hls.PlaylistType.MEDIA?F.yield(B.getMediaPlaylistBasicInfo_(n,l),7):(B.parseMasterVariables_(a),u=r.filterTagsByName(n.tags,"EXT-X-MEDIA"),c=r.filterTagsByName(n.tags,"EXT-X-STREAM-INF"),d=r.filterTagsByName(n.tags,"EXT-X-IMAGE-STREAM-INF"),p=r.filterTagsByName(n.tags,"EXT-X-I-FRAME-STREAM-INF"),h=r.filterTagsByName(n.tags,"EXT-X-SESSION-KEY"),f=r.filterTagsByName(n.tags,"EXT-X-SESSION-DATA"),m=r.filterTagsByName(n.tags,"EXT-X-CONTENT-STEERING"),B.processSessionData_(f),F.yield(B.processContentSteering_(m),4));case 4:return B.parseCodecs_(c),B.parseClosedCaptions_(u),F.yield(B.createVariantsForTags_(c,h,u,l,B.globalVariables_),5);case 5:return i=F.yieldResult,o=B.parseTexts_(u),F.yield(B.parseImages_(d,p),6);case 6:s=F.yieldResult,F.jumpTo(3);break;case 7:return g=F.yieldResult,y=g.type,v=g.mimeType,_=g.codecs,k=g.language,E=g.height,b=g.width,T=g.channelCount,A=g.sampleRate,S=g.closedCaptions,C=g.videoRange,F.yield(B.convertParsedPlaylistIntoStreamInfo_(B.globalId_++,n,l,t,_,y,k,!0,"Media Playlist",T,S,null,!1,A,!1,v),8);case 8:P=F.yieldResult,B.uriToStreamInfosMap_.set(t,P),"video"==y&&B.addVideoAttributes_(P.stream,b,E,null,C,null),i.push({id:0,language:B.getLanguage_(k),disabledUntilTime:0,primary:!0,audio:"audio"==y?P.stream:null,video:"video"==y?P.stream:null,bandwidth:P.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!B.playerInterface_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED);if(n.type==shaka.hls.PlaylistType.MEDIA&&(B.isLive_()&&(B.changePresentationTimelineToLive_(n),x=B.getUpdatePlaylistDelay_(),B.updatePlaylistTimer_.tickAfter(x)),w=Array.from(B.uriToStreamInfosMap_.values()),B.finalizeStreams_(w),B.determineDuration_()),B.manifest_={presentationTimeline:B.presentationTimeline_,variants:i,textStreams:o,imageStreams:s,offlineSessionIds:[],minBufferTime:0,sequenceMode:B.config_.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:B.config_.hls.ignoreManifestTimestampsInSegmentsMode,type:shaka.media.ManifestParser.HLS,serviceDescription:null},B.codecInfoInManifest_||!B.config_.hls.disableCodecGuessing){F.jumpTo(9);break}for(I=[],M=$jscomp.makeIterator(B.manifest_.variants),R=M.next();!R.done;R=M.next())(D=R.value).audio&&""===D.audio.codecs&&I.push(D.audio.createSegmentIndex()),D.video&&""===D.video.codecs&&I.push(D.video.createSegmentIndex());return F.yield(Promise.all(I),9);case 9:if(B.playerInterface_.makeTextStreamsForClosedCaptions(B.manifest_),1==i.length){for(O=[],L=i[0],N=$jscomp.makeIterator([L.video,L.audio]),U=N.next();!U.done;U=N.next())(j=U.value)&&!j.segmentIndex&&O.push(j.createSegmentIndex());if(0<O.length)return F.yield(Promise.all(O),0)}F.jumpTo(0)}}))},shaka.hls.HlsParser.prototype.getMediaPlaylistBasicInfo_=function(e,t){var r,n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,C=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(P){switch(P.nextAddress){case 1:if(r=shaka.hls.HlsParser,n=shaka.media.SegmentUtils.getBasicInfoFromMimeType(C.config_.hls.mediaPlaylistFullMimeType),!e.segments.length)return P.return(n);if(a=e.segments[0],i=shaka.hls.Utils.constructSegmentUris(t(),a.verbatimSegmentUri),o=i[0],s=new goog.Uri(o),l=s.getPath().split(".").pop(),u=r.RAW_FORMATS_TO_MIME_TYPES_[l])return P.return(shaka.media.SegmentUtils.getBasicInfoFromMimeType(u));if(c=shaka.net.NetworkingEngine.RequestType.SEGMENT,d=null,p=C.getInitSegmentReference_(e,a.tags,t),C.mapTagToInitSegmentRefMap_.clear(),!p){P.jumpTo(2);break}return h=shaka.util.Networking.createSegmentRequest(p.getUris(),p.getStartByte(),p.getEndByte(),C.config_.retryParameters),f=shaka.net.NetworkingEngine.AdvancedRequestType.INIT_SEGMENT,P.yield(C.makeNetworkRequest_(h,c,{type:f}),3);case 3:m=P.yieldResult,d=m.data;case 2:return g=0,y=null,(v=shaka.hls.Utils.getFirstTagWithName(a.tags,"EXT-X-BYTERANGE"))&&(_=$jscomp.makeIterator(C.parseByteRange_(null,v.value)),g=_.next().value,y=_.next().value),k=shaka.util.Networking.createSegmentRequest(i,g,y,C.config_.retryParameters),E=shaka.net.NetworkingEngine.AdvancedRequestType.MEDIA_SEGMENT,P.yield(C.makeNetworkRequest_(k,c,{type:E}),4);case 4:if(b=P.yieldResult,(T=b.headers["content-type"])&&(T=T.split(";")[0].toLowerCase()),"ts"==l||"video/mp2t"==T){if(A=shaka.media.SegmentUtils.getBasicInfoFromTs(b.data))return P.return(A)}else if(("mp4"==l||"cmfv"==l||"m4s"==l||"fmp4"==l||"video/mp4"==T||"audio/mp4"==T||"video/iso.segment"==T)&&(S=shaka.media.SegmentUtils.getBasicInfoFromMp4(d,b.data)))return P.return(S);return P.return(n)}}))},shaka.hls.HlsParser.prototype.determineDuration_=function(){if(goog.asserts.assert(this.presentationTimeline_,"Presentation timeline not created!"),this.isLive_()){if(this.presentationType_==shaka.hls.HlsParser.PresentationType_.LIVE){var e=this.getLiveDuration_();this.config_.hls.useSafariBehaviorForLive&&(e=this.presentationTimeline_.getDelay()),isNaN(this.config_.availabilityWindowOverride)||(e=this.config_.availabilityWindowOverride),this.presentationTimeline_.setSegmentAvailabilityDuration(e)}}else this.presentationTimeline_.setDuration(this.getMinDuration_());if(!this.presentationTimeline_.isStartTimeLocked())for(var t=(e=$jscomp.makeIterator(this.uriToStreamInfosMap_.values())).next();!t.done;t=e.next())!(t=t.value).stream.segmentIndex||"audio"!=t.type&&"video"!=t.type||(t=t.stream.segmentIndex.get(0))&&t.syncTime&&this.presentationTimeline_.setInitialProgramDateTime(t.syncTime);this.presentationTimeline_.lockStartTime(),goog.asserts.assert(!this.presentationTimeline_.usingPresentationStartTime(),"We should not be using the presentation start time in HLS!")},shaka.hls.HlsParser.prototype.parseMasterVariables_=function(e){for(var t=new goog.Uri(this.masterPlaylistUri_).getQueryData(),r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){var n=r.value;r=n.getAttributeValue("NAME");var a=n.getAttributeValue("VALUE");n=n.getAttributeValue("QUERYPARAM"),r&&a&&(this.globalVariables_.has(r)||this.globalVariables_.set(r,a)),n&&(r=t.get(n)[0])&&!this.globalVariables_.has(r)&&this.globalVariables_.set(n,r)}},shaka.hls.HlsParser.prototype.parseMediaVariables_=function(e,t){t=new goog.Uri(t).getQueryData();for(var r=new Map,n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){var a=n.value,i=a.getAttributeValue("NAME"),o=a.getAttributeValue("VALUE");n=a.getAttributeValue("QUERYPARAM"),a=a.getAttributeValue("IMPORT"),i&&o&&(r.has(i)||r.set(i,o)),n&&(i=t.get(n)[0])&&!r.has(i)&&r.set(n,i),a&&(n=this.globalVariables_.get(a))&&r.set(a,n)}return r},shaka.hls.HlsParser.prototype.parseCodecs_=function(e){for(var t=shaka.util.ManifestParserUtils.ContentType,r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next()){var n=r.value,a=n.getAttributeValue("AUDIO");r=n.getAttributeValue("VIDEO");var i=n.getAttributeValue("SUBTITLES");if(n=this.getCodecsForVariantTag_(n),i){var o=shaka.util.ManifestParserUtils.guessCodecsSafe(t.TEXT,n);goog.asserts.assert(null!=o,"Text codecs should be valid."),this.groupIdToCodecsMap_.set(i,o),shaka.util.ArrayUtils.remove(n,o)}a&&((i=shaka.util.ManifestParserUtils.guessCodecsSafe(t.AUDIO,n))||(i=this.config_.hls.defaultAudioCodec),this.groupIdToCodecsMap_.set(a,i)),r&&((a=shaka.util.ManifestParserUtils.guessCodecsSafe(t.VIDEO,n))||(a=this.config_.hls.defaultVideoCodec),this.groupIdToCodecsMap_.set(r,a))}},shaka.hls.HlsParser.prototype.processSessionData_=function(e){for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){var r=t.value,n=r.getAttributeValue("DATA-ID");t=r.getAttributeValue("URI");var a=r.getAttributeValue("LANGUAGE");r=r.getAttributeValue("VALUE"),n=(new Map).set("id",n),t&&n.set("uri",shaka.hls.Utils.constructSegmentUris([this.masterPlaylistUri_],t,this.globalVariables_)[0]),a&&n.set("language",a),r&&n.set("value",r),t=new shaka.util.FakeEvent("sessiondata",n),this.playerInterface_&&this.playerInterface_.onEvent(t)}},shaka.hls.HlsParser.prototype.processContentSteering_=function(e){var t,r,n,a,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(!s.playerInterface_||!s.config_)return l.return();for(r=$jscomp.makeIterator(e),n=r.next();!n.done;n=r.next())if(a=n.value,i=a.getAttributeValue("PATHWAY-ID"),o=a.getAttributeValue("SERVER-URI"),i&&o){s.contentSteeringManager_=new shaka.util.ContentSteeringManager(s.playerInterface_),s.contentSteeringManager_.configure(s.config_),s.contentSteeringManager_.setBaseUris([s.masterPlaylistUri_]),s.contentSteeringManager_.setManifestType(shaka.media.ManifestParser.HLS),s.contentSteeringManager_.setDefaultPathwayId(i),t=s.contentSteeringManager_.requestInfo(o);break}return l.yield(t,0)}))},shaka.hls.HlsParser.prototype.parseTexts_=function(e){var t=this,r=shaka.hls.Utils.filterTagsByType(e,"SUBTITLES");e=r.map((function(e){if(t.config_.disableText)return null;try{return t.createStreamInfoFromMediaTags_([e],new Map).stream}catch(e){if(t.config_.hls.ignoreTextStreamFailures)return null;throw e}}));for(var n=shaka.util.ManifestParserUtils.ContentType.TEXT,a=(r=$jscomp.makeIterator(r)).next();!a.done;a=r.next()){var i=a.value.getRequiredAttrValue("GROUP-ID");if((a=this.groupIdToCodecsMap_.get(i))&&(i=this.groupIdToStreamInfosMap_.get(i)))for(var o=(i=$jscomp.makeIterator(i)).next();!o.done;o=i.next())(o=o.value).stream.codecs=a,o.stream.mimeType=this.guessMimeTypeBeforeLoading_(n,a)||this.guessMimeTypeFallback_(n),this.setFullTypeForStream_(o.stream)}return e.filter((function(e){return e}))},shaka.hls.HlsParser.prototype.setFullTypeForStream_=function(e){e.fullMimeTypes=new Set([shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs)])},shaka.hls.HlsParser.prototype.parseImages_=function(e,t){var r,n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(r=e.map((function(e){var t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return a.config_.disableThumbnails?n.return(null):(n.setCatchFinallyBlocks(2),n.yield(a.createStreamInfoFromImageTag_(e),4));if(2!=n.nextAddress)return t=n.yieldResult,n.return(t.stream);if(r=n.enterCatchBlock(),a.config_.hls.ignoreImageStreamFailures)return n.return(null);throw r}))})).concat(t.map((function(e){if(a.config_.disableThumbnails)return null;try{var t=a.createStreamInfoFromIframeTag_(e);return"mjpg"!==t.stream.codecs?null:t.stream}catch(e){if(a.config_.hls.ignoreImageStreamFailures)return null;throw e}}))),i.yield(Promise.all(r),2)):(n=i.yieldResult,i.return(n.filter((function(e){return e}))))}))},shaka.hls.HlsParser.prototype.createStreamInfosFromMediaTags_=function(e,t){e=e.filter((function(e){var t=e.getAttributeValue("URI")||"";return"SUBTITLES"!=e.getAttributeValue("TYPE")&&""!=t}));for(var r={},n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){var a=(n=n.value).getTagKey();r[a]?r[a].push(n):r[a]=[n]}for(var i in r)this.createStreamInfoFromMediaTags_(r[i],t)},shaka.hls.HlsParser.prototype.createVariantsForTags_=function(e,t,r,n,a){var i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,C,P,x,w,I,M,R,D,O,L,N=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(U){switch(U.nextAddress){case 1:if(i=[],o=new Set,!(0<t.length)){U.jumpTo(2);break}s=$jscomp.makeIterator(t),l=s.next();case 3:if(l.done){U.jumpTo(2);break}if(u=l.value,c=u.getRequiredAttrValue("METHOD"),d=u.getAttributeValue("KEYFORMAT")||"identity",p=null,"NONE"==c||N.isAesMethod_(c)){U.jumpTo(4);break}if("identity"!=d){p=(h=shaka.hls.HlsParser.KEYFORMATS_TO_DRM_PARSERS_[d])?h(u,""):null,U.jumpTo(6);break}return U.yield(N.identityDrmParser_(u,"",n,null,a),8);case 8:p=U.yieldResult;case 6:if(p){if(p.keyIds)for(f=$jscomp.makeIterator(p.keyIds),m=f.next();!m.done;m=f.next())g=m.value,o.add(g);i.push(p)}else shaka.log.warning("Unsupported HLS KEYFORMAT",d);case 4:l=s.next(),U.jumpTo(3);break;case 2:for(y={},v=$jscomp.makeIterator(e),_=v.next();!_.done;_=v.next())k=_.value,E=k.getTagKey(),y[E]?y[E].push(k):y[E]=[k];for(T in b=[],y)A=y[T],S=A[0],C=S.getAttributeValue("FRAME-RATE"),P=Number(S.getAttributeValue("AVERAGE-BANDWIDTH"))||Number(S.getRequiredAttrValue("BANDWIDTH")),x=S.getAttributeValue("RESOLUTION"),w=$jscomp.makeIterator(x?x.split("x"):[null,null]),I=w.next().value,M=w.next().value,R=S.getAttributeValue("VIDEO-RANGE"),(D=S.getAttributeValue("REQ-VIDEO-LAYOUT"))&&D.includes(",")&&(O=D.split(",").filter((function(e){return"CH-STEREO"==e||"CH-MONO"==e})),D=O[0]),D=D||"CH-MONO",L=N.createStreamInfosForVariantTags_(A,r,x,C,P),goog.asserts.assert(L.audio.length||L.video.length,"We should have created a stream!"),b.push.apply(b,$jscomp.arrayFromIterable(N.createVariants_(L.audio,L.video,P,I,M,C,R,D,i,o)));return U.return(b.filter((function(e){return null!=e})))}}))},shaka.hls.HlsParser.prototype.createStreamInfosForVariantTags_=function(e,t,r,n,a){n=shaka.util.ManifestParserUtils.ContentType,r={audio:[],video:[]};for(var i=new Map,o=[],s=!1,l=!1,u=$jscomp.makeIterator(e),c=u.next();!c.done;c=u.next()){var d=(c=c.value).getAttributeValue("AUDIO"),p=c.getAttributeValue("VIDEO");goog.asserts.assert(null==d||null==p,"Unexpected: both video and audio described by media tags!");var h=d||p;if(h){o.includes(h)||o.push(h);var f=c.getAttributeValue("PATHWAY-ID");f&&i.set(h,f),d?s=!0:p&&(l=!0),shaka.log.debug("Guessing stream type for",c.toString())}}o.length&&t.length&&(u=t.filter((function(e){return o.includes(e.getRequiredAttrValue("GROUP-ID"))})),this.createStreamInfosFromMediaTags_(u,i)),u=(i=o.sort().join(","))&&this.groupIdToStreamInfosMap_.has(i)?this.groupIdToStreamInfosMap_.get(i):[],s?r.audio.push.apply(r.audio,$jscomp.arrayFromIterable(u)):l&&r.video.push.apply(r.video,$jscomp.arrayFromIterable(u)),l=!1;var m=e.map((function(e){return e.getRequiredAttrValue("URI")}));return p=r.audio.find((function(e){return e&&e.getUris().find((function(e){return m.includes(e)}))})),s=this.getCodecsForVariantTag_(e[0]),c=shaka.util.ManifestParserUtils.guessCodecsSafe(n.VIDEO,s),(d=shaka.util.ManifestParserUtils.guessCodecsSafe(n.AUDIO,s))&&!c?(n=n.AUDIO,shaka.log.debug("Guessing audio-only."),l=0<r.audio.length):!r.audio.length&&!r.video.length&&d&&c?(shaka.log.debug("Guessing multiplexed audio+video."),n=n.VIDEO,s=[[c,d].join()]):r.audio.length&&p?(shaka.log.debug("Guessing audio-only."),n=n.AUDIO,l=!0):r.video.length&&!r.audio.length?(shaka.log.debug("Guessing audio-only."),n=n.AUDIO):(shaka.log.debug("Guessing video-only."),n=n.VIDEO),l||(d=c=l=null,p=!1,f=h=null,!u.length&&(t=t.find((function(e){var t=e.getAttributeValue("URI")||"",r=e.getAttributeValue("TYPE");return e=e.getRequiredAttrValue("GROUP-ID"),"SUBTITLES"!=r&&""==t&&o.includes(e)})))&&(l=t.getAttributeValue("LANGUAGE"),c=t.getAttributeValue("NAME"),d=this.getChannelsCount_(t),p=this.isSpatialAudio_(t),h=t.getAttributeValue("CHARACTERISTICS"),f=this.getSampleRate_(t)),e=this.createStreamInfoFromVariantTags_(e,s,n,l,c,d,h,f,p),i&&(e.stream.groupId=i),u.length||(e.stream.bandwidth=a),r[e.stream.type]=[e]),r},shaka.hls.HlsParser.prototype.getCodecsForVariantTag_=function(e){var t=e.getAttributeValue("CODECS")||"";return e=e.getAttributeValue("SUPPLEMENTAL-CODECS"),this.codecInfoInManifest_=0<t.length,this.codecInfoInManifest_||this.config_.hls.disableCodecGuessing||(t=[],this.config_.disableVideo||t.push(this.config_.hls.defaultVideoCodec),this.config_.disableAudio||t.push(this.config_.hls.defaultAudioCodec),t=t.join(",")),t=t.split(/\s*,\s*/),e&&(e=e.split(/\s*,\s*/).map((function(e){return e.split("/")[0]})),t.push.apply(t,$jscomp.arrayFromIterable(e))),shaka.media.SegmentUtils.codecsFiltering(t)},shaka.hls.HlsParser.prototype.getChannelsCount_=function(e){return(e=e.getAttributeValue("CHANNELS"))?(e=e.split("/")[0],parseInt(e,10)):null},shaka.hls.HlsParser.prototype.getSampleRate_=function(e){return(e=e.getAttributeValue("SAMPLE-RATE"))?parseInt(e,10):null},shaka.hls.HlsParser.prototype.isSpatialAudio_=function(e){return!!(e=e.getAttributeValue("CHANNELS"))&&e.includes("/JOC")},shaka.hls.HlsParser.prototype.getClosedCaptions_=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType;if(e=e.getAttributeValue("CLOSED-CAPTIONS"),t==r.VIDEO){if(e&&"NONE"!=e)return this.groupIdToClosedCaptionsMap_.get(e);if(!e&&this.groupIdToClosedCaptionsMap_.size)for(t=$jscomp.makeIterator(this.groupIdToClosedCaptionsMap_.keys()).next();!t.done;)return this.groupIdToClosedCaptionsMap_.get(t.value)}return null},shaka.hls.HlsParser.prototype.getLanguage_=function(e){return shaka.util.LanguageUtils.normalize(e||"und")},shaka.hls.HlsParser.prototype.getType_=function(e){return"subtitles"==(e=e.getRequiredAttrValue("TYPE").toLowerCase())&&(e=shaka.util.ManifestParserUtils.ContentType.TEXT),e},shaka.hls.HlsParser.prototype.createVariants_=function(e,t,r,n,a,i,o,s,l,u){for(var c=shaka.util.ManifestParserUtils.ContentType,d=shaka.media.DrmEngine,p=$jscomp.makeIterator(t),h=p.next();!h.done;h=p.next())this.addVideoAttributes_(h.value.stream,n,a,i,o,s);for(n=this.config_.disableAudio,e.length&&!n||(e=[null]),n=this.config_.disableVideo,t.length&&!n||(t=[null]),n=[],a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next())for(a=a.value,o=(i=$jscomp.makeIterator(t)).next();!o.done;o=i.next()){var f=o.value;(o=a?a.stream:null)&&(o.drmInfos=l,o.keyIds=u),(s=f?f.stream:null)&&(s.drmInfos=l,s.keyIds=u),p=a?a.stream.drmInfos:null,h=f?f.stream.drmInfos:null,f=(f=f?f.getUris().sort().join(","):"")+" - "+(a?a.getUris().sort().join(","):""),o&&s&&!d.areDrmCompatible(p,h)?shaka.log.warning("Incompatible DRM info in HLS variant.  Skipping."):this.variantUriSet_.has(f)?shaka.log.debug("Skipping variant which only differs in text streams."):(goog.asserts.assert(!o||o.type==c.AUDIO,"Audio parameter mismatch!"),goog.asserts.assert(!s||s.type==c.VIDEO,"Video parameter mismatch!"),o={id:this.globalId_++,language:o?o.language:"und",disabledUntilTime:0,primary:!!o&&o.primary||!!s&&s.primary,audio:o,video:s,bandwidth:r,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},n.push(o),this.variantUriSet_.add(f))}return n},shaka.hls.HlsParser.prototype.parseClosedCaptions_=function(e){e=shaka.hls.Utils.filterTagsByType(e,"CLOSED-CAPTIONS");for(var t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){var r=t.value;goog.asserts.assert("EXT-X-MEDIA"==r.name,"Should only be called on media tags!");var n=r.getAttributeValue("LANGUAGE");t=this.getLanguage_(n),n||(n=r.getAttributeValue("NAME"))&&(t=n),n=r.getRequiredAttrValue("GROUP-ID"),r=r.getRequiredAttrValue("INSTREAM-ID").replace("SERVICE","svc"),this.groupIdToClosedCaptionsMap_.get(n)||this.groupIdToClosedCaptionsMap_.set(n,new Map),this.groupIdToClosedCaptionsMap_.get(n).set(r,t)}},shaka.hls.HlsParser.prototype.createStreamInfoFromMediaTags_=function(e,t){for(var r=[],n=[],a=new Map,i=$jscomp.makeIterator(e),o=i.next();!o.done;o=i.next()){var s=o.value;goog.asserts.assert("EXT-X-MEDIA"==s.name,"Should only be called on media tags!"),o=s.getRequiredAttrValue("URI"),s=s.getRequiredAttrValue("GROUP-ID"),r.push(o),n.push(s),a.set(s,o)}if(i=n.sort().join(","),s=e[0],e="",(o=this.getType_(s))==shaka.util.ManifestParserUtils.ContentType.TEXT)e=s.getAttributeValue("CODECS")||"";else for(var l=(n=$jscomp.makeIterator(n)).next();!l.done;l=n.next())if(l=l.value,this.groupIdToCodecsMap_.has(l)){e=this.groupIdToCodecsMap_.get(l);break}if(n=r.sort().join(","),this.uriToStreamInfosMap_.has(n))return this.uriToStreamInfosMap_.get(n);if(l=this.globalId_++,this.contentSteeringManager_)for(var u=(a=$jscomp.makeIterator(a)).next();!u.done;u=a.next()){var c=$jscomp.makeIterator(u.value);u=c.next().value,c=c.next().value,(u=t.get(u))&&this.contentSteeringManager_.addLocation(l,u,c)}t=s.getAttributeValue("LANGUAGE"),a=s.getAttributeValue("NAME"),u="YES"==s.getAttributeValue("DEFAULT"),c="audio"==o?this.getChannelsCount_(s):null;var d="audio"==o&&this.isSpatialAudio_(s),p=s.getAttributeValue("CHARACTERISTICS"),h="YES"==s.getAttributeValue("FORCED");return s="audio"==o?this.getSampleRate_(s):null,(r=this.createStreamInfo_(l,r,e,o,t,u,a,c,null,p,h,s,d)).stream&&(r.stream.groupId=i),this.groupIdToStreamInfosMap_.has(i)?this.groupIdToStreamInfosMap_.get(i).push(r):this.groupIdToStreamInfosMap_.set(i,[r]),this.uriToStreamInfosMap_.set(n,r),r},shaka.hls.HlsParser.prototype.createStreamInfoFromImageTag_=function(e){var t,r,n,a,i,o,s,l,u,c,d,p=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){return 1==h.nextAddress?(goog.asserts.assert("EXT-X-IMAGE-STREAM-INF"==e.name,"Should only be called on image tags!"),t=shaka.util.ManifestParserUtils.ContentType.IMAGE,r=e.getRequiredAttrValue("URI"),n=e.getAttributeValue("CODECS","jpeg")||"",p.uriToStreamInfosMap_.has(r)?h.return(p.uriToStreamInfosMap_.get(r)):(a=e.getAttributeValue("LANGUAGE"),i=e.getAttributeValue("NAME"),o=e.getAttributeValue("CHARACTERISTICS"),s=p.createStreamInfo_(p.globalId_++,[r],n,t,a,!1,i,null,null,o,!1,null,!1),(l=e.getAttributeValue("RESOLUTION"))?h.yield(s.stream.createSegmentIndex(),3):h.jumpTo(2))):(2!=h.nextAddress&&(u=s.stream.segmentIndex.get(0),c=u.getTilesLayout())&&(s.stream.width=Number(l.split("x")[0])*Number(c.split("x")[0]),s.stream.height=Number(l.split("x")[1])*Number(c.split("x")[1])),(d=e.getAttributeValue("BANDWIDTH"))&&(s.stream.bandwidth=Number(d)),p.uriToStreamInfosMap_.set(r,s),h.return(s))}))},shaka.hls.HlsParser.prototype.createStreamInfoFromIframeTag_=function(e){goog.asserts.assert("EXT-X-I-FRAME-STREAM-INF"==e.name,"Should only be called on iframe tags!");var t=shaka.util.ManifestParserUtils.ContentType.IMAGE,r=e.getRequiredAttrValue("URI"),n=e.getAttributeValue("CODECS")||"";if(this.uriToStreamInfosMap_.has(r))return this.uriToStreamInfosMap_.get(r);var a=e.getAttributeValue("LANGUAGE"),i=e.getAttributeValue("NAME"),o=e.getAttributeValue("CHARACTERISTICS");return t=this.createStreamInfo_(this.globalId_++,[r],n,t,a,!1,i,null,null,o,!1,null,!1),n=e.getAttributeValue("RESOLUTION"),a=$jscomp.makeIterator(n?n.split("x"):[null,null]),n=a.next().value,a=a.next().value,t.stream.width=Number(n)||void 0,t.stream.height=Number(a)||void 0,(e=e.getAttributeValue("BANDWIDTH"))&&(t.stream.bandwidth=Number(e)),this.uriToStreamInfosMap_.set(r,t),t},shaka.hls.HlsParser.prototype.createStreamInfoFromVariantTags_=function(e,t,r,n,a,i,o,s,l){l=this.globalId_++;for(var u=[],c=$jscomp.makeIterator(e),d=c.next();!d.done;d=c.next()){var p=d.value;goog.asserts.assert("EXT-X-STREAM-INF"==p.name,"Should only be called on variant tags!"),d=p.getRequiredAttrValue("URI"),p=p.getAttributeValue("PATHWAY-ID"),this.contentSteeringManager_&&p&&this.contentSteeringManager_.addLocation(l,p,d),u.push(d)}return c=u.sort().join(","),this.uriToStreamInfosMap_.has(c)?this.uriToStreamInfosMap_.get(c):(e=this.getClosedCaptions_(e[0],r),t=shaka.util.ManifestParserUtils.guessCodecs(r,t),r=this.createStreamInfo_(l,u,t,r,n,!1,a,i,e,o,!1,s,!1),this.uriToStreamInfosMap_.set(c,r),r)},shaka.hls.HlsParser.prototype.createStreamInfo_=function(e,t,r,n,a,i,o,s,l,u,c,d,p){var h=this,f=this.makeStreamObject_(e,r,n,a,i,o,s,l,u,c,d,p),m=[],g=function(){return h.contentSteeringManager_&&1<t.length?h.contentSteeringManager_.getLocations(e):m.concat(shaka.hls.Utils.constructUris([h.masterPlaylistUri_],t,h.globalVariables_))},y={stream:f,type:n,redirectUris:m,getUris:g,minTimestamp:0,maxTimestamp:0,mediaSequenceToStartTime:new Map,canSkipSegments:!1,canBlockReload:!1,hasEndList:!1,firstSequenceNumber:-1,nextMediaSequence:-1,nextPart:-1,loadedOnce:!1},v=null,_=new AbortController;return f.createSegmentIndex=function(){return v||(_=new AbortController,v=new Promise((function(t){t(function(t){var v,_,k,E,b,T,A,S,C,P,x,w,I,M,R,D,O;return $jscomp.asyncExecutePromiseGeneratorProgram((function(L){switch(L.nextAddress){case 1:return v=y.getUris(),L.yield(h.requestManifest_(y.getUris(),!0),2);case 2:if(_=L.yieldResult,t.aborted)return L.return();if((k=_.uri)==_.originalUri||v.includes(k)||m.push(k),E=h.manifestTextParser_.parsePlaylist(_.data),b=void 0,h.codecInfoInManifest_||!h.config_.hls.disableCodecGuessing){L.jumpTo(3);break}return L.yield(h.getMediaPlaylistBasicInfo_(E,g),4);case 4:T=L.yieldResult,goog.asserts.assert(n===T.type,"Media types should match!"),b=T.mimeType,r=T.codecs;case 3:return A=h.isLive_(),L.yield(h.convertParsedPlaylistIntoStreamInfo_(e,E,g,k,r,n,a,i,o,s,l,u,c,d,p,b),5);case 5:if(S=L.yieldResult,t.aborted)return L.return();if(C=S.stream,h.isLive_()&&!A&&h.changePresentationTimelineToLive_(E),y.minTimestamp=S.minTimestamp,y.maxTimestamp=S.maxTimestamp,y.canSkipSegments=S.canSkipSegments,y.canBlockReload=S.canBlockReload,y.hasEndList=S.hasEndList,y.mediaSequenceToStartTime=S.mediaSequenceToStartTime,y.nextMediaSequence=S.nextMediaSequence,y.nextPart=S.nextPart,y.loadedOnce=!0,f.segmentIndex=C.segmentIndex,f.encrypted=C.encrypted,f.drmInfos=C.drmInfos,f.keyIds=C.keyIds,f.mimeType=C.mimeType,f.bandwidth=f.bandwidth||C.bandwidth,f.codecs=f.codecs||C.codecs,h.setFullTypeForStream_(f),f.drmInfos.length&&h.playerInterface_.newDrmInfo(f),P=shaka.util.ManifestParserUtils.ContentType,n==P.VIDEO||n==P.AUDIO)for(x=$jscomp.makeIterator(h.uriToStreamInfosMap_.values()),w=x.next();!w.done;w=x.next())(I=w.value).loadedOnce||I.type!=n||(I.stream.mimeType=C.mimeType,h.setFullTypeForStream_(I.stream));n==P.TEXT&&(M=C.segmentIndex.get(0))&&M.initSegmentReference&&(f.mimeType="application/mp4",h.setFullTypeForStream_(f)),h.hasEnoughInfoToFinalizeStreams_()&&(h.streamsFinalized_?h.finalizeStreams_([y]):(h.streamsFinalized_=!0,R=Array.from(h.uriToStreamInfosMap_.values()),D=R.filter((function(e){return e.stream.segmentIndex})),h.finalizeStreams_(D),h.determineDuration_(),0<(O=h.getUpdatePlaylistDelay_())&&h.updatePlaylistTimer_.tickAfter(O))),L.jumpToEnd()}}))}(_.signal))})))},f.closeSegmentIndex=function(){v&&!f.segmentIndex&&_.abort(),f.segmentIndex&&(f.segmentIndex.release(),f.segmentIndex=null),v=null},y},shaka.hls.HlsParser.prototype.getMinDuration_=function(){for(var e=1/0,t=$jscomp.makeIterator(this.uriToStreamInfosMap_.values()),r=t.next();!r.done;r=t.next())(r=r.value).stream.segmentIndex&&"text"!=r.stream.type&&(e=Math.min(e,r.maxTimestamp));return e},shaka.hls.HlsParser.prototype.getLiveDuration_=function(){for(var e=1/0,t=1/0,r=$jscomp.makeIterator(this.uriToStreamInfosMap_.values()),n=r.next();!n.done;n=r.next())(n=n.value).stream.segmentIndex&&"text"!=n.stream.type&&(e=Math.min(e,n.maxTimestamp),t=Math.min(t,n.minTimestamp));return e-t},shaka.hls.HlsParser.prototype.notifySegmentsForStreams_=function(e){for(var t=[],r=(e=$jscomp.makeIterator(e)).next();!r.done;r=e.next())(r=r.value).segmentIndex&&r.segmentIndex.forEachTopLevelReference((function(e){t.push(e)}));this.presentationTimeline_.notifySegments(t)},shaka.hls.HlsParser.prototype.finalizeStreams_=function(e){if(!this.isLive_())for(var t=this.getMinDuration_(),r=$jscomp.makeIterator(e),n=r.next();!n.done;n=r.next())n.value.stream.segmentIndex.fit(0,t);this.notifySegmentsForStreams_(e.map((function(e){return e.stream}))),this.config_.hls.ignoreManifestProgramDateTime?this.syncStreamsWithSequenceNumber_(e):(this.syncStreamsWithProgramDateTime_(e),0<this.config_.hls.ignoreManifestProgramDateTimeForTypes.length&&this.syncStreamsWithSequenceNumber_(e))},shaka.hls.HlsParser.prototype.ignoreManifestProgramDateTimeFor_=function(e){return!!this.config_.hls.ignoreManifestProgramDateTime||this.config_.hls.ignoreManifestProgramDateTimeForTypes.includes(e)},shaka.hls.HlsParser.prototype.hasEnoughInfoToFinalizeStreams_=function(){if(!this.manifest_)return!1;for(var e=[],t=[],r=$jscomp.makeIterator(this.manifest_.variants),n=r.next();!n.done;n=r.next())(n=n.value).video&&e.push(n.video),n.audio&&t.push(n.audio);return!(0<e.length&&!e.some((function(e){return e.segmentIndex}))||0<t.length&&!t.some((function(e){return e.segmentIndex})))},shaka.hls.HlsParser.prototype.convertParsedPlaylistIntoStreamInfo_=function(e,t,r,n,a,i,o,s,l,u,c,d,p,h,f,m){var g,y,v,_,k,E,b,T,A,S,C,P,x,w,I,M,R,D,O,L,N,U,j,B=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(F){switch(F.nextAddress){case 1:if(t.type!=shaka.hls.PlaylistType.MEDIA)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_INVALID_PLAYLIST_HIERARCHY);if(g=shaka.hls.Utils.filterTagsByName(t.tags,"EXT-X-DEFINE"),y=B.parseMediaVariables_(g,n),goog.asserts.assert(null!=t.segments,"Media playlist should have segments!"),B.determinePresentationType_(t),B.isLive_()&&B.determineLastTargetDuration_(t),m){F.jumpTo(2);break}return F.yield(B.guessMimeType_(i,a,t,y,r),3);case 3:m=F.yieldResult;case 2:return F.yield(B.parseDrmInfo_(t,m,r,y),4);case 4:if(v=F.yieldResult,_=v.drmInfos,k=v.keyIds,E=v.encrypted,b=v.aesEncrypted,E&&!_.length&&!b)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_KEYFORMATS_NOT_SUPPORTED);return(T=B.makeStreamObject_(e,a,i,o,s,l,u,c,d,p,h,f)).encrypted=E,T.drmInfos=_,T.keyIds=k,T.mimeType=m,B.setFullTypeForStream_(T),A=B.isLive_()?B.mediaSequenceToStartTimeByType_.get(i):new Map,S=B.createSegments_(t,T,A,y,r,i),C=S.segments,(P=S.bandwidth)&&(T.bandwidth=P),B.isLive_()&&B.determineLastTargetDuration_(t),x=C[0].startTime,w=C[C.length-1],I=w.endTime,M=new shaka.media.SegmentIndex(C),T.segmentIndex=M,D=!!(R=shaka.hls.Utils.getFirstTagWithName(t.tags,"EXT-X-SERVER-CONTROL"))&&null!=R.getAttribute("CAN-SKIP-UNTIL"),O=!!R&&null!=R.getAttribute("CAN-BLOCK-RELOAD"),L=shaka.hls.Utils.getFirstTagWithNameAsNumber(t.tags,"EXT-X-MEDIA-SEQUENCE",0),N=B.getNextMediaSequenceAndPart_(L,C),U=N.nextMediaSequence,j=N.nextPart,F.return({stream:T,type:i,redirectUris:[],getUris:r,minTimestamp:x,maxTimestamp:I,canSkipSegments:D,canBlockReload:O,hasEndList:!1,firstSequenceNumber:-1,nextMediaSequence:U,nextPart:j,mediaSequenceToStartTime:A,loadedOnce:!1})}}))},shaka.hls.HlsParser.prototype.getNextMediaSequenceAndPart_=function(e,t){e=e+t.length-1;var r=-1;if(!t.length)return{nextMediaSequence:++e,nextPart:r};var n=(t=t[t.length-1]).partialReferences;return t.partialReferences.length?(r=n.length-1,n[n.length-1].isPreload()||(e++,r=0),{nextMediaSequence:e,nextPart:r}):(e++,t.hasByterangeOptimization()&&(r=0),{nextMediaSequence:e,nextPart:r})},shaka.hls.HlsParser.prototype.makeStreamObject_=function(e,t,r,n,a,i,o,s,l,u,c,d){e=this.guessMimeTypeBeforeLoading_(r,t)||this.guessMimeTypeFallback_(r);var p=[];if(l)for(var h=(l=$jscomp.makeIterator(l.split(","))).next();!h.done;h=l.next())p.push(h.value);return l=void 0,h=null,r==shaka.util.ManifestParserUtils.ContentType.TEXT?l=p.includes("public.accessibility.transcribes-spoken-dialog")&&p.includes("public.accessibility.describes-music-and-sound")?shaka.util.ManifestParserUtils.TextStreamKind.CLOSED_CAPTION:shaka.util.ManifestParserUtils.TextStreamKind.SUBTITLE:p.includes("public.accessibility.describes-video")&&(h=shaka.media.ManifestParser.AccessibilityPurpose.VISUALLY_IMPAIRED),p.length||l!==shaka.util.ManifestParserUtils.TextStreamKind.SUBTITLE||p.push(shaka.util.ManifestParserUtils.TextStreamKind.SUBTITLE),t={id:this.globalId_++,originalId:i,groupId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:e,codecs:t,kind:r==shaka.util.ManifestParserUtils.ContentType.TEXT?shaka.util.ManifestParserUtils.TextStreamKind.SUBTITLE:void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:this.getLanguage_(n),originalLanguage:n,label:i,type:r,primary:a,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:p,forced:u,channelsCount:o,audioSamplingRate:c,spatialAudio:d,closedCaptions:s,hdr:void 0,videoLayout:void 0,tilesLayout:void 0,accessibilityPurpose:h,external:!1,fastSwitching:!1,fullMimeTypes:new Set},this.setFullTypeForStream_(t),t},shaka.hls.HlsParser.prototype.parseDrmInfo_=function(e,t,r,n){var a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,C,P,x,w,I,M,R=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(D){switch(D.nextAddress){case 1:if(a=new Map,e.segments)for(i=$jscomp.makeIterator(e.segments),o=i.next();!o.done;o=i.next())if(s=o.value,l=shaka.hls.Utils.filterTagsByName(s.tags,"EXT-X-KEY"),u=null,l.length)for(u=R.getInitSegmentReference_(e,s.tags,r,n),c=$jscomp.makeIterator(l),d=c.next();!d.done;d=c.next())p=d.value,a.set(p,u);f=h=!1,m=[],g=new Set,y=$jscomp.makeIterator(a),v=y.next();case 2:if(v.done){D.jumpTo(4);break}if(_=v.value,k=$jscomp.makeIterator(_),E=k.next().value,b=k.next().value,A=b,"NONE"==(S=(T=E).getRequiredAttrValue("METHOD"))){D.jumpTo(3);break}if(h=!0,C=T.getAttributeValue("KEYFORMAT")||"identity",P=null,R.isAesMethod_(S)){f=!0,D.jumpTo(3);break}if("identity"!=C){P=(x=shaka.hls.HlsParser.KEYFORMATS_TO_DRM_PARSERS_[C])?x(T,t):null,D.jumpTo(6);break}return D.yield(R.identityDrmParser_(T,t,r,A,n),8);case 8:P=D.yieldResult;case 6:if(P){if(P.keyIds)for(w=$jscomp.makeIterator(P.keyIds),I=w.next();!I.done;I=w.next())M=I.value,g.add(M);m.push(P)}else shaka.log.warning("Unsupported HLS KEYFORMAT",C);case 3:v=y.next(),D.jumpTo(2);break;case 4:return D.return({drmInfos:m,keyIds:g,encrypted:h,aesEncrypted:f})}}))},shaka.hls.HlsParser.prototype.parseAESDrmTag_=function(e,t,r,n){var a=this;if(!window.crypto||!window.crypto.subtle)throw shaka.log.alwaysWarn("Web Crypto API is not available to decrypt AES. (Web Crypto only exists in secure origins like https)"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.NO_WEB_CRYPTO_API);var i=0,o=e.getAttributeValue("IV","");if(o){var s=shaka.util.Uint8ArrayUtils.fromHex(o.substr(2));if(16!=s.byteLength)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.AES_128_INVALID_IV_LENGTH)}else i=shaka.hls.Utils.getFirstTagWithNameAsNumber(t.tags,"EXT-X-MEDIA-SEQUENCE",0);if(t=e.toString()+"-"+i,!this.aesKeyInfoMap_.has(t)){var l={bitsKey:128,blockCipherMode:"CBC",iv:s,firstMediaSequenceNumber:i};switch(e.getRequiredAttrValue("METHOD")){case"AES-256":l.bitsKey=256;break;case"AES-256-CTR":l.bitsKey=256,l.blockCipherMode="CTR"}l.fetchKey=function(){var t,i,o,s,u,c,d,p;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){if(1==h.nextAddress)return t=shaka.hls.Utils.constructSegmentUris(r(),e.getRequiredAttrValue("URI"),n),i=t.sort().join(""),a.aesKeyMap_.has(i)||(o=shaka.net.NetworkingEngine.RequestType.KEY,s=shaka.net.NetworkingEngine.makeRequest(t,a.config_.retryParameters),u=a.makeNetworkRequest_(s,o),a.aesKeyMap_.set(i,u)),h.yield(a.aesKeyMap_.get(i),2);if(3!=h.nextAddress){if(!(c=h.yieldResult).data||c.data.byteLength!=l.bitsKey/8)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.AES_128_INVALID_KEY_LENGTH);return d={name:"CTR"==l.blockCipherMode?"AES-CTR":"AES-CBC",length:l.bitsKey},p=l,h.yield(window.crypto.subtle.importKey("raw",c.data,d,!0,["decrypt"]),3)}p.cryptoKey=h.yieldResult,l.fetchKey=void 0,h.jumpToEnd()}))},this.aesKeyInfoMap_.set(t,l)}return this.aesKeyInfoMap_.get(t)},shaka.hls.HlsParser.prototype.determinePresentationType_=function(e){var t=shaka.hls.HlsParser.PresentationType_,r=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-PLAYLIST-TYPE");e=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-ENDLIST"),e=r&&"VOD"==r.value||e,r=r&&"EVENT"==r.value&&!e,r=!e&&!r,e?this.setPresentationType_(t.VOD):r?this.setPresentationType_(t.LIVE):this.setPresentationType_(t.EVENT)},shaka.hls.HlsParser.prototype.determineLastTargetDuration_=function(e){var t=1/0,r=e.segments;if(r.length)for(var n=r.length-1;0<=n;){var a=shaka.hls.Utils.getFirstTagWithName(r[n].tags,"EXTINF");if(a){t=a.value.split(","),t=Number(t[0]);break}n--}r=this.getRequiredTag_(e.tags,"EXT-X-TARGETDURATION"),r=Number(r.value),(n=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-PART-INF"))&&(this.partialTargetDuration_=Number(n.getRequiredAttrValue("PART-TARGET"))),e=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-SERVER-CONTROL"),this.lowLatencyMode_&&this.partialTargetDuration_?(this.lastTargetDuration_=this.lowLatencyByterangeOptimization_?5*this.partialTargetDuration_<=t?Math.min(this.partialTargetDuration_,this.lastTargetDuration_):Math.min(t,this.lastTargetDuration_):Math.min(this.partialTargetDuration_,this.lastTargetDuration_),this.lowLatencyPresentationDelay_=e?Number(e.getRequiredAttrValue("PART-HOLD-BACK")):0):(this.lastTargetDuration_=Math.min(t,this.lastTargetDuration_),this.presentationDelay_=(e=e?e.getAttribute("HOLD-BACK"):null)?Number(e.value):0),this.maxTargetDuration_=Math.max(r,this.maxTargetDuration_)},shaka.hls.HlsParser.prototype.changePresentationTimelineToLive_=function(e){if(this.config_.defaultPresentationDelay)e=this.config_.defaultPresentationDelay;else if(this.lowLatencyPresentationDelay_)e=this.lowLatencyPresentationDelay_;else if(this.presentationDelay_)e=this.presentationDelay_;else{e=e.segments.length;var t=this.config_.hls.liveSegmentsDelay;t>e-2&&(t=Math.max(1,e-2)),e=this.maxTargetDuration_*t}this.presentationTimeline_.setPresentationStartTime(0),this.presentationTimeline_.setDelay(e),this.presentationTimeline_.setStatic(!1)},shaka.hls.HlsParser.prototype.getInitSegmentReference_=function(e,t,r,n){var a=shaka.hls.Utils.getFirstTagWithName(t,"EXT-X-MAP");if(!a)return null;var i=a.getRequiredAttrValue("URI"),o=shaka.hls.Utils.constructSegmentUris(r(),i,n);if(i=[o.toString(),a.getAttributeValue("BYTERANGE","")].join("-"),!this.mapTagToInitSegmentRefMap_.has(i)){for(var s=void 0,l=null,u=(t=$jscomp.makeIterator(t)).next();!u.done;u=t.next())"EXT-X-KEY"==(u=u.value).name?this.isAesMethod_(u.getRequiredAttrValue("METHOD"))&&u.id<a.id&&(s=this.parseAESDrmTag_(u,e,r,n)):"EXT-X-BYTERANGE"==u.name&&u.id<a.id&&(l=u);e=this.createInitSegmentReference_(o,a,l,s),this.mapTagToInitSegmentRefMap_.set(i,e)}return this.mapTagToInitSegmentRefMap_.get(i)},shaka.hls.HlsParser.prototype.createInitSegmentReference_=function(e,t,r,n){var a=0,i=null;return!(t=t.getAttributeValue("BYTERANGE"))&&r&&(t=r.value),t&&(a=t.split("@"),i=Number(a[0]),i=(a=Number(a[1]))+i-1,n&&((r=i+1-a)%16&&(i+=16-r%16))),new shaka.media.InitSegmentReference((function(){return e}),a,i,null,null,null,n)},shaka.hls.HlsParser.prototype.createSegmentReference_=function(e,t,r,n,a,i,o,s,l){var u=r.tags,c=shaka.hls.Utils.getFirstTagWithName(u,"EXTINF"),d=0;i=0;var p=null;r.partialSegments.length&&!this.lowLatencyMode_&&shaka.log.alwaysWarn("Low-latency HLS live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.");var h=null;if(!this.config_.hls.ignoreManifestProgramDateTime){var f=shaka.hls.Utils.getFirstTagWithName(u,"EXT-X-PROGRAM-DATE-TIME");f&&f.value&&(h=shaka.util.TXml.parseDate(f.value),goog.asserts.assert(null!=h,"EXT-X-PROGRAM-DATE-TIME format not valid"))}var m=shaka.media.SegmentReference.Status.AVAILABLE;if(shaka.hls.Utils.getFirstTagWithName(u,"EXT-X-GAP")&&(m=shaka.media.SegmentReference.Status.MISSING),!c){if(0==r.partialSegments.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_REQUIRED_TAG_MISSING,"EXTINF");if(!this.lowLatencyMode_)return null}var g=[];f=!1;var y=null,v=!1,_=!1;if(this.lowLatencyMode_&&r.partialSegments.length){d=("video/mp4"==o.mimeType||"audio/mp4"==o.mimeType)&&window.ReadableStream&&this.config_.hls.allowLowLatencyByteRangeOptimization;for(var k=h,E={},b=0;b<r.partialSegments.length;E={$jscomp$loop$prop$uris$760$907:E.$jscomp$loop$prop$uris$760$907,$jscomp$loop$prop$pUri$908:E.$jscomp$loop$prop$pUri$908},b++){var T=r.partialSegments[b],A=0==b?t:g[g.length-1],S=0==b?n:A.endTime,C=Number(T.getAttributeValue("DURATION"))||this.partialTargetDuration_;if(C){var P=S+C,x=0,w=null;if("EXT-X-PRELOAD-HINT"==T.name?(x=(x=T.getAttributeValue("BYTERANGE-START"))?Number(x):0,(A=T.getAttributeValue("BYTERANGE-LENGTH"))?w=x+Number(A)-1:x&&(w=Number.MAX_SAFE_INTEGER)):(x=T.getAttributeValue("BYTERANGE"),x=(w=$jscomp.makeIterator(this.parseByteRange_(A,x))).next().value,w=w.next().value),E.$jscomp$loop$prop$pUri$908=T.getAttributeValue("URI"),E.$jscomp$loop$prop$pUri$908){A=shaka.media.SegmentReference.Status.AVAILABLE,"YES"==T.getAttributeValue("GAP")&&(A=shaka.media.SegmentReference.Status.MISSING,v=!0),E.$jscomp$loop$prop$uris$760$907=null;var I=function(e){return function(){return null==e.$jscomp$loop$prop$uris$760$907&&(goog.asserts.assert(e.$jscomp$loop$prop$pUri$908,"Partial uri should be defined!"),e.$jscomp$loop$prop$uris$760$907=shaka.hls.Utils.constructSegmentUris(s(),e.$jscomp$loop$prop$pUri$908,a)),e.$jscomp$loop$prop$uris$760$907}}(E);d&&0<=x&&null!=w&&(y=I,f=!0),S=new shaka.media.SegmentReference(S,P,I,x,w,e,0,0,1/0,[],"",null,k,A,l),"EXT-X-PRELOAD-HINT"==T.name&&(S.markAsPreload(),_=!0),"YES"!=T.getAttributeValue("INDEPENDENT")&&0<b&&S.markAsNonIndependent(),g.push(S),k&&(k+=C)}}}}if(c){if(c=c.value.split(","),0==(c=Number(c[0])))return null;d=n+c}else{if(!g.length)return null;d=g[g.length-1].endTime}f&&(v||0!=g[0].startByte?(f=!1,y=null):g=[]),(v=shaka.hls.Utils.getFirstTagWithName(u,"EXT-X-BYTERANGE"))?(i=(p=$jscomp.makeIterator(this.parseByteRange_(t,v.value))).next().value,p=p.next().value):g.length&&(i=g[0].startByte,p=g[g.length-1].endByte),t="",v=null,o.type==shaka.util.ManifestParserUtils.ContentType.IMAGE&&(t="1x1",o=shaka.hls.Utils.getFirstTagWithName(u,"EXT-X-TILES"))&&(t=o.getRequiredAttrValue("LAYOUT"),(o=o.getAttributeValue("DURATION"))&&(v=Number(o)));var M=null;return e=new shaka.media.SegmentReference(n,d,(function(){return y?y():(null==M&&(M=shaka.hls.Utils.constructSegmentUris(s(),r.verbatimSegmentUri,a)),M||[])}),i,p,e,0,0,1/0,g,t,v,h,m,l,0<g.length&&!!r.verbatimSegmentUri),f&&(this.lowLatencyByterangeOptimization_=!0,e.markAsByterangeOptimization(),_&&e.markAsPreload()),e},shaka.hls.HlsParser.prototype.parseByteRange_=function(e,t){var r=0,n=null;return t&&(r=t.split("@"),t=Number(r[0]),r[1]?r=Number(r[1]):(goog.asserts.assert(e,"Cannot refer back to previous HLS segment!"),r=e.endByte+1),n=r+t-1),[r,n]},shaka.hls.HlsParser.prototype.createSegments_=function(e,t,r,n,a,i){var o=e.segments;goog.asserts.assert(o.length,"Playlist should have segments!");var s=void 0,l=shaka.hls.Utils.getFirstTagWithNameAsNumber(e.tags,"EXT-X-DISCONTINUITY-SEQUENCE",0),u=shaka.hls.Utils.getFirstTagWithNameAsNumber(e.tags,"EXT-X-MEDIA-SEQUENCE",0),c=shaka.hls.Utils.getFirstTagWithName(e.tags,"EXT-X-SKIP"),d=c?Number(c.getAttributeValue("SKIPPED-SEGMENTS")):0,p=u+d,h=0;this.isLive_()&&r.has(p)&&(h=r.get(p)),0===h&&this.presentationType_==shaka.hls.HlsParser.PresentationType_.LIVE&&0<r.size&&!r.has(p)&&(h=this.presentationTimeline_.getSegmentAvailabilityStart());var f=[],m=null;c=[];for(var g=0;g<o.length;g++){var y=o[g],v=0==g?h:m.endTime;p=u+d+g,shaka.hls.Utils.getFirstTagWithName(y.tags,"EXT-X-DISCONTINUITY")&&l++;for(var _=$jscomp.makeIterator(y.tags),k=_.next();!k.done;k=_.next())"EXT-X-KEY"==(k=k.value).name&&(s=this.isAesMethod_(k.getRequiredAttrValue("METHOD"))?this.parseAESDrmTag_(k,e,a,n):void 0);r.set(p,v),_=this.getInitSegmentReference_(e,y.tags,a,n),!this.lowLatencyMode_&&this.playerInterface_.isAutoLowLatencyMode()&&(this.playerInterface_.enableLowLatencyMode(),this.lowLatencyMode_=this.playerInterface_.isLowLatencyMode()),(v=this.createSegmentReference_(_,m,y,v,n,e,t,a,s))&&((m=shaka.hls.Utils.getFirstTagWithNameAsNumber(y.tags,"EXT-X-BITRATE"))?c.push({bitrate:m,duration:v.endTime-v.startTime}):c.length&&((m=c.pop()).duration+=v.endTime-v.startTime,c.push(m)),m=v,v.discontinuitySequence=l,this.ignoreManifestProgramDateTimeFor_(i)&&null!=this.minSequenceNumber_&&p<this.minSequenceNumber_||f.push(v))}if(e=void 0,c.length&&(e=c.reduce((function(e,t){return e+t.duration}),0),e=Math.round(c.reduce((function(e,t){return e+t.bitrate*t.duration}),0)/e*1e3)),c=f.some((function(e){return null!=e.syncTime})))for(t={},r=0;r<f.length;t={$jscomp$loop$prop$forwardI$910:t.$jscomp$loop$prop$forwardI$910,$jscomp$loop$prop$forwardAdd$911:t.$jscomp$loop$prop$forwardAdd$911,$jscomp$loop$prop$backwardI$912:t.$jscomp$loop$prop$backwardI$912,$jscomp$loop$prop$reference$763$913:t.$jscomp$loop$prop$reference$763$913,$jscomp$loop$prop$backwardAdd$914:t.$jscomp$loop$prop$backwardAdd$914},r++)if(t.$jscomp$loop$prop$reference$763$913=f[r],null==t.$jscomp$loop$prop$reference$763$913.syncTime)for(t.$jscomp$loop$prop$forwardAdd$911=0,t.$jscomp$loop$prop$forwardI$910=r,n=function(e){return function(){var t=f[e.$jscomp$loop$prop$forwardI$910];if(t){if(null!=t.syncTime)return t.syncTime+e.$jscomp$loop$prop$forwardAdd$911;e.$jscomp$loop$prop$forwardAdd$911-=t.endTime-t.startTime,e.$jscomp$loop$prop$forwardI$910+=1}return null}}(t),t.$jscomp$loop$prop$backwardAdd$914=0,t.$jscomp$loop$prop$backwardI$912=r,a=function(e){return function(){var t=f[e.$jscomp$loop$prop$backwardI$912];if(t){if(t!=e.$jscomp$loop$prop$reference$763$913&&(e.$jscomp$loop$prop$backwardAdd$914+=t.endTime-t.startTime),null!=t.syncTime)return t.syncTime+e.$jscomp$loop$prop$backwardAdd$914;--e.$jscomp$loop$prop$backwardI$912}return null}}(t);null==t.$jscomp$loop$prop$reference$763$913.syncTime;)t.$jscomp$loop$prop$reference$763$913.syncTime=a(),null==t.$jscomp$loop$prop$reference$763$913.syncTime&&(t.$jscomp$loop$prop$reference$763$913.syncTime=n());if(c)for(r=(t=$jscomp.makeIterator(f)).next();!r.done;r=t.next())for(r=(n=r.value).syncTime,a=(n=$jscomp.makeIterator(n.partialReferences)).next();!a.done;a=n.next())(a=a.value).syncTime=r,r+=a.endTime-a.startTime;if(t=this.lowestSyncTime_,c&&1/0!=t&&!this.ignoreManifestProgramDateTimeFor_(i))for(r=(i=$jscomp.makeIterator(f)).next();!r.done;r=i.next())r.value.syncAgainst(t);return{segments:f,bandwidth:e}},shaka.hls.HlsParser.prototype.guessMimeTypeBeforeLoading_=function(e,t){if(e==shaka.util.ManifestParserUtils.ContentType.TEXT){if("vtt"==t||"wvtt"==t)return"text/vtt";if(t&&""!==t)return"application/mp4"}return e!=shaka.util.ManifestParserUtils.ContentType.IMAGE||t&&"jpeg"!=t?e==shaka.util.ManifestParserUtils.ContentType.AUDIO&&"mp4a.40.34"==t?"audio/mpeg":"mjpg"==t?"application/mp4":null:"image/jpeg"},shaka.hls.HlsParser.prototype.guessMimeTypeFallback_=function(e){return e==shaka.util.ManifestParserUtils.ContentType.TEXT?"text/vtt":shaka.hls.HlsParser.EXTENSION_MAP_BY_CONTENT_TYPE_[e].mp4},shaka.hls.HlsParser.prototype.guessMimeType_=function(e,t,r,n,a){var i,o,s,l,u,c,d,p,h,f,m,g,y,v,_=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(k){switch(k.nextAddress){case 1:return i=shaka.hls.HlsParser,o=shaka.net.NetworkingEngine.RequestType.SEGMENT,goog.asserts.assert(r.segments.length,"Playlist should have segments!"),s=Math.trunc((r.segments.length-1)/2),l=shaka.hls.Utils.constructSegmentUris(a(),r.segments[s].verbatimSegmentUri,n),u=new goog.Uri(l[0]),c=u.getPath().split(".").pop(),d=i.EXTENSION_MAP_BY_CONTENT_TYPE_[e],(p=d[c])||(p=i.RAW_FORMATS_TO_MIME_TYPES_[c])||(p=_.guessMimeTypeBeforeLoading_(e,t))?k.return(p):(f=shaka.net.NetworkingEngine.AdvancedRequestType.MEDIA_SEGMENT,m=shaka.net.NetworkingEngine.makeRequest(l,_.config_.retryParameters),k.setCatchFinallyBlocks(2),m.method="HEAD",k.yield(_.makeNetworkRequest_(m,o,{type:f}),4));case 4:g=k.yieldResult,h=g.headers["content-type"],k.leaveTryBlock(3);break;case 2:if(!(y=k.enterCatchBlock())||y.code!=shaka.util.Error.Code.HTTP_ERROR&&y.code!=shaka.util.Error.Code.BAD_HTTP_STATUS){k.jumpTo(3);break}return m.method="GET",k.yield(_.makeNetworkRequest_(m,o,{type:f}),6);case 6:v=k.yieldResult,h=v.headers["content-type"];case 3:return h?k.return(h.split(";")[0]):k.return(_.guessMimeTypeFallback_(e))}}))},shaka.hls.HlsParser.prototype.getRequiredTag_=function(e,t){if(!(e=shaka.hls.Utils.getFirstTagWithName(e,t)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_REQUIRED_TAG_MISSING,t);return e},shaka.hls.HlsParser.prototype.addVideoAttributes_=function(e,t,r,n,a,i){e&&(e.width=Number(t)||void 0,e.height=Number(r)||void 0,e.frameRate=Number(n)||void 0,e.hdr=a||void 0,e.videoLayout=i||void 0)},shaka.hls.HlsParser.prototype.requestManifest_=function(e,t){var r=shaka.net.NetworkingEngine.RequestType.MANIFEST;return e=shaka.net.NetworkingEngine.makeRequest(e,this.config_.retryParameters),this.makeNetworkRequest_(e,r,{type:t?shaka.net.NetworkingEngine.AdvancedRequestType.MEDIA_PLAYLIST:shaka.net.NetworkingEngine.AdvancedRequestType.MASTER_PLAYLIST})},shaka.hls.HlsParser.prototype.onUpdate_=function(){var e,t,r,n,a,i,o=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){switch(s.nextAddress){case 1:return shaka.log.info("Updating manifest..."),goog.asserts.assert(0<o.getUpdatePlaylistDelay_(),"We should only call |onUpdate_| when we are suppose to be updating."),o.playerInterface_?(s.setCatchFinallyBlocks(2),e=Date.now(),s.yield(o.update(),4)):s.return();case 4:t=Date.now(),o.isLive_()&&(r=(t-e)/1e3,o.averageUpdateDuration_.sample(1,r),n=o.getUpdatePlaylistDelay_(),a=Math.max(0,n-o.averageUpdateDuration_.getEstimate()),o.updatePlaylistTimer_.tickAfter(a)),s.leaveTryBlock(3);break;case 2:if(i=s.enterCatchBlock(),!o.playerInterface_)return s.return();if(goog.asserts.assert(i instanceof shaka.util.Error,"Should only receive a Shaka error"),o.config_.raiseFatalErrorOnManifestUpdateRequestFailure)return o.playerInterface_.onError(i),s.return();i.severity=shaka.util.Error.Severity.RECOVERABLE,o.playerInterface_.onError(i),o.updatePlaylistTimer_.tickAfter(.1);case 3:if(!o.playerInterface_)return s.return();o.playerInterface_.onManifestUpdated(),s.jumpToEnd()}}))},shaka.hls.HlsParser.prototype.isLive_=function(){return this.presentationType_!=shaka.hls.HlsParser.PresentationType_.VOD},shaka.hls.HlsParser.prototype.getUpdatePlaylistDelay_=function(){return this.lastTargetDuration_},shaka.hls.HlsParser.prototype.setPresentationType_=function(e){this.presentationType_=e,this.presentationTimeline_&&this.presentationTimeline_.setStatic(!this.isLive_()),this.isLive_()||this.updatePlaylistTimer_.stop()},shaka.hls.HlsParser.prototype.makeNetworkRequest_=function(e,t,r){if(!this.operationManager_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED);return e=this.playerInterface_.networkingEngine.request(t,e,r),this.operationManager_.manage(e),e.promise},shaka.hls.HlsParser.prototype.isAesMethod_=function(e){return"AES-128"==e||"AES-256"==e||"AES-256-CTR"==e},shaka.hls.HlsParser.fairplayDrmParser_=function(e,t){if("video/mp2t"==t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED);if(shaka.util.Platform.isMediaKeysPolyfilled())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED);return e=e.getRequiredAttrValue("METHOD"),(t=["SAMPLE-AES","SAMPLE-AES-CTR"]).includes(e)?(t="cenc","SAMPLE-AES"==e&&(t="cbcs"),shaka.util.ManifestParserUtils.createDrmInfo("com.apple.fps",t,[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}])):(shaka.log.error("FairPlay in HLS is only supported with [",t.join(", "),"], not",e),null)},shaka.hls.HlsParser.widevineDrmParser_=function(e){var t=e.getRequiredAttrValue("METHOD"),r=["SAMPLE-AES","SAMPLE-AES-CTR"];return r.includes(t)?(r="cenc","SAMPLE-AES"==t&&(r="cbcs"),t=e.getRequiredAttrValue("URI"),t=shaka.net.DataUriPlugin.parseRaw(t),t=shaka.util.BufferUtils.toUint8(t.data),r=shaka.util.ManifestParserUtils.createDrmInfo("com.widevine.alpha",r,[{initDataType:"cenc",initData:t}]),(e=e.getAttributeValue("KEYID"))&&(e=e.toLowerCase(),goog.asserts.assert(e.startsWith("0x"),"Incorrect KEYID format!"),r.keyIds=new Set([e.substr(2)])),r):(shaka.log.error("Widevine in HLS is only supported with [",r.join(", "),"], not",t),null)},shaka.hls.HlsParser.playreadyDrmParser_=function(e){var t=e.getRequiredAttrValue("METHOD"),r=["SAMPLE-AES","SAMPLE-AES-CTR"];if(!r.includes(t))return shaka.log.error("PlayReady in HLS is only supported with [",r.join(", "),"], not",t),null;r="cenc","SAMPLE-AES"==t&&(r="cbcs"),e=e.getRequiredAttrValue("URI"),e=shaka.net.DataUriPlugin.parseRaw(e),e=shaka.util.BufferUtils.toUint8(e.data),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);var n=new Set;return e=shaka.util.Pssh.createPssh(e,t,n,0),shaka.util.ManifestParserUtils.createDrmInfo("com.microsoft.playready",r,[{initDataType:"cenc",initData:e}])},shaka.hls.HlsParser.prototype.identityDrmParser_=function(e,t,r,n,a){var i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(T){switch(T.nextAddress){case 1:if("video/mp2t"==t)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED);if(shaka.util.Platform.isMediaKeysPolyfilled())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED);if(i=e.getRequiredAttrValue("METHOD"),!(o=["SAMPLE-AES","SAMPLE-AES-CTR"]).includes(i))return shaka.log.error("Identity (ClearKey) in HLS is only supported with [",o.join(", "),"], not",i),T.return(null);if((s=shaka.hls.Utils.constructSegmentUris(r(),e.getRequiredAttrValue("URI"),a))[0].startsWith("data:text/plain;base64,")){l=shaka.util.Uint8ArrayUtils.toHex(shaka.util.Uint8ArrayUtils.fromBase64(s[0].split("data:text/plain;base64,").pop())),T.jumpTo(2);break}return u=s.sort().join(""),b.identityKeyMap_.has(u)||(c=shaka.net.NetworkingEngine.RequestType.KEY,d=shaka.net.NetworkingEngine.makeRequest(s,b.config_.retryParameters),p=b.makeNetworkRequest_(d,c),b.identityKeyMap_.set(u,p)),T.yield(b.identityKeyMap_.get(u),3);case 3:h=T.yieldResult,l=shaka.util.Uint8ArrayUtils.toHex(h.data);case 2:if(f="00000000000000000000000000000000",!n){T.jumpTo(4);break}if(b.identityKidMap_.has(n)){m=b.identityKidMap_.get(n),T.jumpTo(5);break}return g=shaka.util.Networking.createSegmentRequest(n.getUris(),n.getStartByte(),n.getEndByte(),b.config_.retryParameters),y=shaka.net.NetworkingEngine.RequestType.SEGMENT,v=shaka.net.NetworkingEngine.AdvancedRequestType.INIT_SEGMENT,T.yield(b.makeNetworkRequest_(g,y,{type:v}),6);case 6:_=T.yieldResult,m=shaka.media.SegmentUtils.getDefaultKID(_.data),b.identityKidMap_.set(n,m);case 5:m&&(f=m);case 4:return(k=new Map).set(f,l),E="cenc","SAMPLE-AES"==i&&(E="cbcs"),T.return(shaka.util.ManifestParserUtils.createDrmInfoFromClearKeys(k,E))}}))},goog.exportSymbol("shaka.hls.HlsParser",shaka.hls.HlsParser),shaka.hls.HlsParser.RAW_FORMATS_TO_MIME_TYPES_={aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},shaka.hls.HlsParser.AUDIO_EXTENSIONS_TO_MIME_TYPES_={mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",tsa:"video/mp2t"},shaka.hls.HlsParser.VIDEO_EXTENSIONS_TO_MIME_TYPES_={mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t",tsv:"video/mp2t"},shaka.hls.HlsParser.TEXT_EXTENSIONS_TO_MIME_TYPES_={mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml"},shaka.hls.HlsParser.IMAGE_EXTENSIONS_TO_MIME_TYPES_={jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif"},shaka.hls.HlsParser.EXTENSION_MAP_BY_CONTENT_TYPE_={audio:shaka.hls.HlsParser.AUDIO_EXTENSIONS_TO_MIME_TYPES_,video:shaka.hls.HlsParser.VIDEO_EXTENSIONS_TO_MIME_TYPES_,text:shaka.hls.HlsParser.TEXT_EXTENSIONS_TO_MIME_TYPES_,image:shaka.hls.HlsParser.IMAGE_EXTENSIONS_TO_MIME_TYPES_},shaka.hls.HlsParser.KEYFORMATS_TO_DRM_PARSERS_={"com.apple.streamingkeydelivery":shaka.hls.HlsParser.fairplayDrmParser_,"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":shaka.hls.HlsParser.widevineDrmParser_,"com.microsoft.playready":shaka.hls.HlsParser.playreadyDrmParser_},shaka.hls.HlsParser.PresentationType_={VOD:"VOD",EVENT:"EVENT",LIVE:"LIVE"},shaka.media.ManifestParser.registerParserByMime("application/x-mpegurl",(function(){return new shaka.hls.HlsParser})),shaka.media.ManifestParser.registerParserByMime("application/vnd.apple.mpegurl",(function(){return new shaka.hls.HlsParser})),shaka.mss={},shaka.mss.ContentProtection=function(){},shaka.mss.ContentProtection.parseFromProtection=function(e,t){for(var r=shaka.mss.ContentProtection,n=shaka.util.TXml,a=[],i=(e=$jscomp.makeIterator(e)).next();!i.done;i=e.next())a=a.concat(n.findChildren(i.value,"ProtectionHeader"));return a.length?r.convertElements_(a,t):[]},shaka.mss.ContentProtection.parseMsProRecords_=function(e,t){for(var r=[];t<e.byteLength-1;){var n=e.getUint16(t,!0);t+=2;var a=e.getUint16(t,!0);if(t+=2,0!=(1&a)||a+t>e.byteLength)return shaka.log.warning("Malformed MS PRO object"),[];var i=shaka.util.BufferUtils.toUint8(e,t,a);r.push({type:n,value:i}),t+=a}return r},shaka.mss.ContentProtection.parseMsPro_=function(e){var t=0,r=shaka.util.BufferUtils.toDataView(e),n=r.getUint32(t,!0);return t+=4,n!=e.byteLength?(shaka.log.warning("PlayReady Object with invalid length encountered."),[]):shaka.mss.ContentProtection.parseMsProRecords_(r,t+2)},shaka.mss.ContentProtection.getLaurl_=function(e){for(var t=shaka.util.TXml,r=(e=$jscomp.makeIterator(t.getElementsByTagName(e,"DATA"))).next();!r.done;r=e.next())if(r=t.findChild(r.value,"LA_URL"))return shaka.util.TXml.getTextContents(r);return""},shaka.mss.ContentProtection.getPlayReadyLicenseUrl=function(e){var t=shaka.mss.ContentProtection;return(e=t.getPlayReadyHeaderObject_(e))?t.getLaurl_(e):""},shaka.mss.ContentProtection.getKID_=function(e){for(var t=shaka.util.TXml,r=(e=$jscomp.makeIterator(t.getElementsByTagName(e,"DATA"))).next();!r.done;r=e.next())if(r=t.findChild(r.value,"KID"))return t=shaka.util.Uint8ArrayUtils.fromBase64(shaka.util.TXml.getTextContents(r)),t=new Uint8Array([t[3],t[2],t[1],t[0],t[5],t[4],t[7],t[6]].concat($jscomp.arrayFromIterable(t.slice(8)))),shaka.util.Uint8ArrayUtils.toHex(t);return null},shaka.mss.ContentProtection.getPlayReadyKID_=function(e){var t=shaka.mss.ContentProtection;return(e=t.getPlayReadyHeaderObject_(e))?t.getKID_(e):null},shaka.mss.ContentProtection.getPlayReadyHeaderObject_=function(e){var t=shaka.mss.ContentProtection,r=t.PLAYREADY_RECORD_TYPES;return e=shaka.util.Uint8ArrayUtils.fromBase64(shaka.util.TXml.getTextContents(e)),(t=t.parseMsPro_(e).filter((function(e){return e.type===r.RIGHTS_MANAGEMENT}))[0])?(t=shaka.util.StringUtils.fromUTF16(t.value,!0),(t=shaka.util.TXml.parseXmlString(t,"WRMHEADER"))?t:null):null},shaka.mss.ContentProtection.getInitDataFromPro_=function(e,t,r){var n=shaka.util.Uint8ArrayUtils;return e=n.fromBase64(shaka.util.TXml.getTextContents(e)),t=n.fromHex(t.replace(/-/g,"")),n=new Set,[{initData:shaka.util.Pssh.createPssh(e,t,n,0),initDataType:"cenc",keyId:r}]},shaka.mss.ContentProtection.convertElements_=function(e,t){for(var r=shaka.mss.ContentProtection,n=shaka.util.ManifestParserUtils,a=r.licenseUrlParsers_,i=[],o=0;o<e.length;o++){var s=e[o],l=s.attributes.SystemID.toLowerCase(),u=t[l];if(u){var c=r.getPlayReadyKID_(s);l=r.getInitDataFromPro_(s,l,c),l=n.createDrmInfo(u,"cenc",l),c&&l.keyIds.add(c),(u=a.get(u))&&(l.licenseServerUri=u(s)),i.push(l)}}return i},shaka.mss.ContentProtection.PLAYREADY_RECORD_TYPES={RIGHTS_MANAGEMENT:1,RESERVED:2,EMBEDDED_LICENSE:3},shaka.mss.ContentProtection.licenseUrlParsers_=(new Map).set("com.microsoft.playready",shaka.mss.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.recommendation",shaka.mss.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.software",shaka.mss.ContentProtection.getPlayReadyLicenseUrl).set("com.microsoft.playready.hardware",shaka.mss.ContentProtection.getPlayReadyLicenseUrl),shaka.util.Mp4Generator=function(e){shaka.util.Mp4Generator.initStaticProperties_(),this.streamInfos_=e},shaka.util.Mp4Generator.prototype.initSegment=function(){var e=shaka.util.Mp4Generator,t=this.moov_(),r=new Uint8Array(e.FTYP_.byteLength+t.byteLength);return r.set(e.FTYP_),r.set(t,e.FTYP_.byteLength),r},shaka.util.Mp4Generator.prototype.moov_=function(){goog.asserts.assert(0<this.streamInfos_.length,"StreamInfos must have elements");for(var e=shaka.util.Mp4Generator,t=[],r=$jscomp.makeIterator(this.streamInfos_),n=r.next();!n.done;n=r.next())t.push(this.trak_(n.value));return t=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(t)),r=this.streamInfos_[0],e.box("moov",this.mvhd_(r),t,this.mvex_(),this.pssh_(r))},shaka.util.Mp4Generator.prototype.mvhd_=function(e){var t=shaka.util.Mp4Generator,r=e.duration*e.timescale,n=Math.floor(r/(t.UINT32_MAX_+1));return r=Math.floor(r%(t.UINT32_MAX_+1)),e=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.timescale,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(n,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255])),t.box("mvhd",e)},shaka.util.Mp4Generator.prototype.trak_=function(e){return shaka.util.Mp4Generator.box("trak",this.tkhd_(e),this.mdia_(e))},shaka.util.Mp4Generator.prototype.tkhd_=function(e){var t=shaka.util.Mp4Generator,r=e.id+1,n=e.stream.width||0,a=e.stream.height||0;e.type==shaka.util.ManifestParserUtils.ContentType.AUDIO&&(a=n=0);var i=e.duration*e.timescale;return e=Math.floor(i/(t.UINT32_MAX_+1)),i=Math.floor(i%(t.UINT32_MAX_+1)),r=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,4)),[0,0,0,0],$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(i,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(n,2)),[0,0],$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(a,2)),[0,0])),t.box("tkhd",r)},shaka.util.Mp4Generator.prototype.mdia_=function(e){return shaka.util.Mp4Generator.box("mdia",this.mdhd_(e),this.hdlr_(e),this.minf_(e))},shaka.util.Mp4Generator.prototype.mdhd_=function(e){var t=shaka.util.Mp4Generator,r=e.duration*e.timescale,n=Math.floor(r/(t.UINT32_MAX_+1));r=Math.floor(r%(t.UINT32_MAX_+1));var a=e.stream.language;return a=a.charCodeAt(0)-96<<10|a.charCodeAt(1)-96<<5|a.charCodeAt(2)-96,e=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.timescale,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(n,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(a,2)),[0,0])),t.box("mdhd",e)},shaka.util.Mp4Generator.prototype.hdlr_=function(e){var t=shaka.util.Mp4Generator,r=shaka.util.ManifestParserUtils.ContentType,n=new Uint8Array([]);switch(e.type){case r.VIDEO:n=t.HDLR_TYPES_.video;break;case r.AUDIO:n=t.HDLR_TYPES_.audio}return t.box("hdlr",n)},shaka.util.Mp4Generator.prototype.minf_=function(e){var t=shaka.util.Mp4Generator,r=shaka.util.ManifestParserUtils.ContentType;switch(e.type){case r.VIDEO:return t.box("minf",t.box("vmhd",t.VMHD_),t.DINF_,this.stbl_(e));case r.AUDIO:return t.box("minf",t.box("smhd",t.SMHD_),t.DINF_,this.stbl_(e))}return new Uint8Array([])},shaka.util.Mp4Generator.prototype.stbl_=function(e){var t=shaka.util.Mp4Generator;return t.box("stbl",this.stsd_(e),t.box("stts",t.STTS_),t.box("stsc",t.STSC_),t.box("stsz",t.STSZ_),t.box("stco",t.STCO_))},shaka.util.Mp4Generator.prototype.stsd_=function(e){var t=shaka.util.Mp4Generator,r=shaka.util.ManifestParserUtils.ContentType,n=new Uint8Array([]);switch(e.type){case r.VIDEO:e.codecs.includes("avc1")?n=this.avc1_(e):e.codecs.includes("hvc1")&&(n=this.hvc1_(e));break;case r.AUDIO:n=e.codecs.includes("mp3")?this.mp3_(e):e.codecs.includes("ac-3")?this.ac3_(e):e.codecs.includes("ec-3")?this.ec3_(e):e.codecs.includes("opus")?this.opus_(e):this.mp4a_(e)}return t.box("stsd",t.STSD_,n)},shaka.util.Mp4Generator.prototype.avc1_=function(e){var t=shaka.util.Mp4Generator,r=e.stream.width||0,n=e.stream.height||0,a=0<e.videoConfig.byteLength?t.box("avcC",e.videoConfig):t.box("avcC",this.avcC_(e));r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,2)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(n,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),n="avc1";var i=this.pasp_(e),o=new Uint8Array([]);return e.encrypted&&(o=this.sinf_(e),n="encv"),t.box(n,r,a,i,o)},shaka.util.Mp4Generator.prototype.avcC_=function(e){for(var t=7,r=[],n=[],a=0,i=0,o=0,s=0;s<e.videoNalus.length;s++){var l=this.hexStringToBuffer_(e.videoNalus[s]);switch(31&l[0]){case 7:r.push(l),t+=l.length+2;break;case 8:n.push(l),t+=l.length+2}}for(0<r.length&&(a=r[0][1],o=r[0][2],i=r[0][3]),e=new Uint8Array(t),t=0,e[t++]=1,e[t++]=a,e[t++]=o,e[t++]=i,e[t++]=255,e[t++]=224|r.length,a=0;a<r.length;a++)e[t++]=(65280&r[a].length)>>8,e[t++]=255&r[a].length,e.set(r[a],t),t+=r[a].length;for(e[t++]=n.length,r=0;r<n.length;r++)e[t++]=(65280&n[r].length)>>8,e[t++]=255&n[r].length,e.set(n[r],t),t+=n[r].length;return e},shaka.util.Mp4Generator.prototype.hvc1_=function(e){var t=shaka.util.Mp4Generator,r=e.stream.width||0,n=e.stream.height||0,a=new Uint8Array([]);0<e.videoConfig.byteLength&&(a=t.box("hvcC",e.videoConfig)),r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,2)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(n,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),n="hvc1";var i=this.pasp_(e),o=new Uint8Array([]);return e.encrypted&&(o=this.sinf_(e),n="encv"),t.box(n,r,a,i,o)},shaka.util.Mp4Generator.prototype.pasp_=function(e){if(!e.hSpacing&&!e.vSpacing)return new Uint8Array([]);var t=shaka.util.Mp4Generator,r=e.vSpacing;return e=new Uint8Array([].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.hSpacing,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,4)))),t.box("pasp",e)},shaka.util.Mp4Generator.prototype.audioStsd_=function(e){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.stream.channelsCount||2,0,16,0,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.stream.audioSamplingRate||44100,2)),[0,0]))},shaka.util.Mp4Generator.prototype.mp3_=function(e){return shaka.util.Mp4Generator.box(".mp3",this.audioStsd_(e))},shaka.util.Mp4Generator.prototype.ac3_=function(e){var t=shaka.util.Mp4Generator,r=t.box("dac3",e.audioConfig),n="ac-3",a=new Uint8Array([]);return e.encrypted&&(a=this.sinf_(e),n="enca"),t.box(n,this.audioStsd_(e),r,a)},shaka.util.Mp4Generator.prototype.ec3_=function(e){var t=shaka.util.Mp4Generator,r=t.box("dec3",e.audioConfig),n="ec-3",a=new Uint8Array([]);return e.encrypted&&(a=this.sinf_(e),n="enca"),t.box(n,this.audioStsd_(e),r,a)},shaka.util.Mp4Generator.prototype.opus_=function(e){var t=shaka.util.Mp4Generator,r=t.box("dOps",e.audioConfig),n="Opus",a=new Uint8Array([]);return e.encrypted&&(a=this.sinf_(e),n="enca"),t.box(n,this.audioStsd_(e),r,a)},shaka.util.Mp4Generator.prototype.mp4a_=function(e){var t=shaka.util.Mp4Generator,r=0<e.audioConfig.byteLength?t.box("esds",e.audioConfig):t.box("esds",this.esds_(e)),n="mp4a",a=new Uint8Array([]);return e.encrypted&&(a=this.sinf_(e),n="enca"),t.box(n,this.audioStsd_(e),r,a)},shaka.util.Mp4Generator.prototype.esds_=function(e){var t=e.id+1,r=e.stream.channelsCount||2,n=e.stream.audioSamplingRate||44100,a=shaka.util.ManifestParserUtils.guessCodecs(shaka.util.ManifestParserUtils.ContentType.AUDIO,e.codecs.split(",")),i={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return e=i[n],"mp4a.40.5"!==a&&"mp4a.40.29"!==a||(e=i[2*n]),n=parseInt(a.split(".").pop(),10),new Uint8Array([0,0,0,0,3,25].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(t,2)),[0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,n<<3|e>>>1,e<<7|r<<3,6,1,2]))},shaka.util.Mp4Generator.prototype.mvex_=function(){for(var e=shaka.util.Mp4Generator,t=[],r=$jscomp.makeIterator(this.streamInfos_),n=r.next();!n.done;n=r.next())t.push(this.trex_(n.value));return t=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(t)),e.box("mvex",t)},shaka.util.Mp4Generator.prototype.trex_=function(e){var t=shaka.util.Mp4Generator;return e=new Uint8Array([0,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1])),t.box("trex",e)},shaka.util.Mp4Generator.prototype.pssh_=function(e){var t=[];if(!e.encrypted)return new Uint8Array([]);for(var r=(e=$jscomp.makeIterator(e.stream.drmInfos)).next();!r.done;r=e.next())if((r=r.value).initData)for(var n=(r=$jscomp.makeIterator(r.initData)).next();!n.done;n=r.next())t.push(n.value.initData);return shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(t))},shaka.util.Mp4Generator.prototype.sinf_=function(e){return shaka.util.Mp4Generator.box("sinf",this.frma_(e),this.schm_(),this.schi_(e))},shaka.util.Mp4Generator.prototype.frma_=function(e){var t=e.codecs.substring(0,e.codecs.indexOf("."));return e=shaka.util.Mp4Generator,t=this.stringToCharCode_(t),t=new Uint8Array([].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(t,4)))),e.box("frma",t)},shaka.util.Mp4Generator.prototype.schm_=function(){var e=shaka.util.Mp4Generator,t=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]);return e.box("schm",t)},shaka.util.Mp4Generator.prototype.schi_=function(e){return shaka.util.Mp4Generator.box("schi",this.tenc_(e))},shaka.util.Mp4Generator.prototype.tenc_=function(e){for(var t=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),r=(e=$jscomp.makeIterator(e.stream.drmInfos)).next();!r.done;r=e.next())if((r=r.value)&&r.keyIds&&r.keyIds.size)for(var n=(r=$jscomp.makeIterator(r.keyIds)).next();!n.done;n=r.next())t=this.hexStringToBuffer_(n.value);return e=shaka.util.Mp4Generator,r=new Uint8Array([0,0,0,0,0,0,1,8]),goog.asserts.assert(t,"Default KID should be non-null"),e.box("tenc",r,t)},shaka.util.Mp4Generator.prototype.segmentData=function(){for(var e=[],t=$jscomp.makeIterator(this.streamInfos_),r=t.next();!r.done;r=t.next())r=r.value,e.push.apply(e,[this.moof_(r),this.mdat_(r)]);return shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(e))},shaka.util.Mp4Generator.prototype.moof_=function(e){return shaka.util.Mp4Generator.box("moof",this.mfhd_(e),this.traf_(e))},shaka.util.Mp4Generator.prototype.mfhd_=function(e){var t=shaka.util.Mp4Generator;return e=new Uint8Array([0,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.data?e.data.sequenceNumber:0,4)))),t.box("mfhd",e)},shaka.util.Mp4Generator.prototype.traf_=function(e){var t=shaka.util.Mp4Generator,r=this.sdtp_(e),n=r.length+32+20+8+16+8+8;return t.box("traf",this.tfhd_(e),this.tfdt_(e),this.trun_(e,n),r)},shaka.util.Mp4Generator.prototype.sdtp_=function(e){var t=shaka.util.Mp4Generator;e=e.data?e.data.samples:[];for(var r=new Uint8Array(4+e.length),n=0;n<e.length;n++){var a=e[n].flags;r[n+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy}return t.box("sdtp",r)},shaka.util.Mp4Generator.prototype.tfhd_=function(e){var t=shaka.util.Mp4Generator;return e=new Uint8Array([0,0,0,58].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(e.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),t.box("tfhd",e)},shaka.util.Mp4Generator.prototype.tfdt_=function(e){var t=shaka.util.Mp4Generator;e=e.data?e.data.baseMediaDecodeTime:0;var r=Math.floor(e%(t.UINT32_MAX_+1));return e=new Uint8Array([1,0,0,0].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(Math.floor(e/(t.UINT32_MAX_+1)),4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(r,4)))),t.box("tfdt",e)},shaka.util.Mp4Generator.prototype.trun_=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType,n=shaka.util.Mp4Generator,a=e.data?e.data.samples:[],i=a.length,o=12+16*i,s=new Uint8Array(o);for(t+=8+o,s.set([e.type===r.VIDEO?1:0,0,15,1].concat($jscomp.arrayFromIterable(this.breakNumberIntoBytes_(i,4)),$jscomp.arrayFromIterable(this.breakNumberIntoBytes_(t,4))),0),e=0;e<i;e++){var l=a[e];t=this.breakNumberIntoBytes_(l.duration,4),r=this.breakNumberIntoBytes_(l.size,4),o=l.flags,l=this.breakNumberIntoBytes_(l.cts,4),s.set([].concat($jscomp.arrayFromIterable(t),$jscomp.arrayFromIterable(r),[o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.isNonSync,61440&o.degradPrio,15&o.degradPrio],$jscomp.arrayFromIterable(l)),12+16*e)}return n.box("trun",s)},shaka.util.Mp4Generator.prototype.mdat_=function(e){var t=shaka.util.Mp4Generator;return e=(e.data?e.data.samples:[]).map((function(e){return e.data})),e=shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(e)),t.box("mdat",e)},shaka.util.Mp4Generator.prototype.breakNumberIntoBytes_=function(e,t){var r=[];for(--t;0<=t;t--)r.push(e>>8*t&255);return r},shaka.util.Mp4Generator.prototype.hexStringToBuffer_=function(e){for(var t=new Uint8Array(e.length/2),r=0;r<e.length/2;r+=1)t[r]=parseInt(String(e[2*r]+e[2*r+1]),16);return t},shaka.util.Mp4Generator.prototype.stringToCharCode_=function(e){for(var t=0,r=0;r<e.length;r+=1)t|=e.charCodeAt(r)<<8*(e.length-r-1);return t},shaka.util.Mp4Generator.initStaticProperties_=function(){var e=shaka.util.Mp4Generator;if(!e.initializated_){e.initializated_=!0;var t=new Uint8Array([105,115,111,109]),r=new Uint8Array([97,118,99,49]),n=new Uint8Array([0,0,0,1]);e.FTYP_=e.box("ftyp",t,n,t,r),t=e.box("dref",e.DREF_),e.DINF_=e.box("dinf",t)}},shaka.util.Mp4Generator.box=function(e){var t=$jscomp.getRestArguments.apply(1,arguments),r=shaka.util.Mp4Generator.BOX_TYPES_[e];r||(r=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)],shaka.util.Mp4Generator.BOX_TYPES_[e]=r);for(var n=8,a=t.length-1;0<=a;a--)n+=t[a].byteLength;for((a=new Uint8Array(n))[0]=n>>24&255,a[1]=n>>16&255,a[2]=n>>8&255,a[3]=255&n,a.set(r,4),r=0,n=8;r<t.length;r++)a.set(t[r],n),n+=t[r].byteLength;return a},shaka.util.Mp4Generator.initializated_=!1,shaka.util.Mp4Generator.UINT32_MAX_=Math.pow(2,32)-1,shaka.util.Mp4Generator.BOX_TYPES_={},shaka.util.Mp4Generator.HDLR_TYPES_={video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])},shaka.util.Mp4Generator.STTS_=new Uint8Array([0,0,0,0,0,0,0,0]),shaka.util.Mp4Generator.STSC_=new Uint8Array([0,0,0,0,0,0,0,0]),shaka.util.Mp4Generator.STCO_=new Uint8Array([0,0,0,0,0,0,0,0]),shaka.util.Mp4Generator.STSZ_=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),shaka.util.Mp4Generator.VMHD_=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),shaka.util.Mp4Generator.SMHD_=new Uint8Array([0,0,0,0,0,0,0,0]),shaka.util.Mp4Generator.STSD_=new Uint8Array([0,0,0,0,0,0,0,1]),shaka.util.Mp4Generator.FTYP_=new Uint8Array([]),shaka.util.Mp4Generator.DREF_=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),shaka.util.Mp4Generator.DINF_=new Uint8Array([]),shaka.mss.MssParser=function(){var e=this;this.playerInterface_=this.config_=null,this.manifestUris_=[],this.manifest_=null,this.globalId_=1,this.updatePeriod_=0,this.presentationTimeline_=null,this.averageUpdateDuration_=new shaka.abr.Ewma(5),this.updateTimer_=new shaka.util.Timer((function(){e.onUpdate_()})),this.operationManager_=new shaka.util.OperationManager,this.initSegmentDataByStreamId_=new Map},shaka.mss.MssParser.prototype.configure=function(e){goog.asserts.assert(null!=e.mss,"MssManifestConfiguration should not be null!"),this.config_=e},shaka.mss.MssParser.prototype.start=function(e,t){var r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){if(1==n.nextAddress)return goog.asserts.assert(r.config_,"Must call configure() before start()!"),r.manifestUris_=[e],r.playerInterface_=t,n.yield(r.requestManifest_(),2);if(!r.playerInterface_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.PLAYER,shaka.util.Error.Code.OPERATION_ABORTED);return r.setUpdateTimer_(),goog.asserts.assert(r.manifest_,"Manifest should be non-null!"),n.return(r.manifest_)}))},shaka.mss.MssParser.prototype.onUpdate_=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){switch(r.nextAddress){case 1:return goog.asserts.assert(0<=t.updatePeriod_,"There should be an update period"),shaka.log.info("Updating manifest..."),r.setCatchFinallyBlocks(2),r.yield(t.requestManifest_(),4);case 4:r.leaveTryBlock(3);break;case 2:e=r.enterCatchBlock(),goog.asserts.assert(e instanceof shaka.util.Error,"Should only receive a Shaka error"),t.playerInterface_&&(e.severity=shaka.util.Error.Severity.RECOVERABLE,t.playerInterface_.onError(e));case 3:if(!t.playerInterface_)return r.return();t.setUpdateTimer_(),r.jumpToEnd()}}))},shaka.mss.MssParser.prototype.setUpdateTimer_=function(){if(!(0>=this.updatePeriod_)){var e=Math.max(shaka.mss.MssParser.MIN_UPDATE_PERIOD_,this.updatePeriod_,this.averageUpdateDuration_.getEstimate());this.updateTimer_.tickAfter(e)}},shaka.mss.MssParser.prototype.stop=function(){return this.config_=this.playerInterface_=null,this.manifestUris_=[],this.manifest_=null,null!=this.updateTimer_&&(this.updateTimer_.stop(),this.updateTimer_=null),this.initSegmentDataByStreamId_.clear(),this.operationManager_.destroy()},shaka.mss.MssParser.prototype.update=function(){var e,t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(r.setCatchFinallyBlocks(2),r.yield(t.requestManifest_(),4)):2!=r.nextAddress?r.leaveTryBlock(0):(e=r.enterCatchBlock(),t.playerInterface_&&e?(goog.asserts.assert(e instanceof shaka.util.Error,"Bad error type"),t.playerInterface_.onError(e),void r.jumpToEnd()):r.return())}))},shaka.mss.MssParser.prototype.onExpirationUpdated=function(e,t){},shaka.mss.MssParser.prototype.onInitialVariantChosen=function(e){},shaka.mss.MssParser.prototype.banLocation=function(e){},shaka.mss.MssParser.prototype.requestManifest_=function(){var e,t,r,n,a,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){return 1==c.nextAddress?(e=shaka.net.NetworkingEngine.RequestType.MANIFEST,t=shaka.net.NetworkingEngine.AdvancedRequestType.MSS,r=shaka.net.NetworkingEngine.makeRequest(u.manifestUris_,u.config_.retryParameters),n=u.playerInterface_.networkingEngine,a=Date.now(),i=n.request(e,r,{type:t}),u.operationManager_.manage(i),c.yield(i.promise,2)):(o=c.yieldResult,u.playerInterface_?(o.uri&&!u.manifestUris_.includes(o.uri)&&u.manifestUris_.unshift(o.uri),u.parseManifest_(o.data,o.uri),s=Date.now(),l=(s-a)/1e3,u.averageUpdateDuration_.sample(1,l),void c.jumpToEnd()):c.return())}))},shaka.mss.MssParser.prototype.parseManifest_=function(e,t){var r=e;if((e=this.config_.mss.manifestPreprocessor)!=shaka.util.PlayerConfiguration.defaultManifestPreprocessor){if(shaka.Deprecate.deprecateFeature(5,"manifest.mss.manifestPreprocessor configuration","Please Use manifest.mss.manifestPreprocessorTXml instead."),!(r=shaka.util.XmlUtils.parseXml(r,"SmoothStreamingMedia")))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.MSS_INVALID_XML,t);e(r),r=shaka.util.XmlUtils.toArrayBuffer(r)}if(!(e=shaka.util.TXml.parseXml(r,"SmoothStreamingMedia")))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.MSS_INVALID_XML,t);return(r=this.config_.mss.manifestPreprocessorTXml)!=shaka.util.PlayerConfiguration.defaultManifestPreprocessorTXml&&r(e),this.processManifest_(e,t),Promise.resolve()},shaka.mss.MssParser.prototype.processManifest_=function(e,t){var r=shaka.util.TXml;if(this.presentationTimeline_||(this.presentationTimeline_=new shaka.media.PresentationTimeline(null,0)),t=r.parseAttr(e,"IsLive",r.parseBoolean,!1))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MANIFEST,shaka.util.Error.Code.MSS_LIVE_CONTENT_NOT_SUPPORTED);this.presentationTimeline_.setStatic(!t);var n=r.parseAttr(e,"TimeScale",r.parseNonNegativeInt,shaka.mss.MssParser.DEFAULT_TIME_SCALE_);goog.asserts.assert(n&&0<=n,"Timescale must be defined!");var a=r.parseAttr(e,"DVRWindowLength",r.parseNonNegativeInt);t&&(0===a||isNaN(a))&&(a=1/0);var i=r.parseAttr(e,"CanSeek",r.parseBoolean,!1);0===a&&i&&(a=1/0),i=null,a&&0<a&&(i=a/n),t&&!isNaN(this.config_.availabilityWindowOverride)&&(i=this.config_.availabilityWindowOverride),null==i&&(i=1/0),this.presentationTimeline_.setSegmentAvailabilityDuration(i),r=r.parseAttr(e,"Duration",r.parseNonNegativeInt,1/0),goog.asserts.assert(r&&0<=r,"Duration must be defined!"),t||this.presentationTimeline_.setDuration(r/n),t={variants:[],textStreams:[],timescale:n,duration:r/n},this.parseStreamIndexes_(e,t),this.manifest_?(this.manifest_.variants=t.variants,this.manifest_.textStreams=t.textStreams,this.playerInterface_.filter(this.manifest_)):(this.manifest_={presentationTimeline:this.presentationTimeline_,variants:t.variants,textStreams:t.textStreams,imageStreams:[],offlineSessionIds:[],minBufferTime:0,sequenceMode:this.config_.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:shaka.media.ManifestParser.MSS,serviceDescription:null},this.presentationTimeline_.lockStartTime())},shaka.mss.MssParser.prototype.parseStreamIndexes_=function(e,t){var r=shaka.mss.ContentProtection,n=shaka.util.TXml,a=shaka.util.ManifestParserUtils.ContentType,i=n.findChildren(e,"Protection"),o=r.parseFromProtection(i,this.config_.mss.keySystemsBySystemId),s=[];r=[],i=[],e=n.findChildren(e,"StreamIndex");for(var l=(e=$jscomp.makeIterator(e)).next();!l.done;l=e.next()){l=l.value;for(var u=n.findChildren(l,"QualityLevel"),c=this.createTimeline_(l,t.timescale,t.duration),d=(u=$jscomp.makeIterator(u)).next();!d.done;d=u.next())(d=this.createStream_(l,d.value,c,o,t))&&(d.type!=a.AUDIO||this.config_.disableAudio?d.type!=a.VIDEO||this.config_.disableVideo?d.type!=a.TEXT||this.config_.disableText||i.push(d):r.push(d):s.push(d))}for(n=[],s=(a=$jscomp.makeIterator(0<s.length?s:[null])).next();!s.done;s=a.next())for(s=s.value,e=(o=$jscomp.makeIterator(0<r.length?r:[null])).next();!e.done;e=o.next())n.push(this.createVariant_(s,e.value));t.variants=n,t.textStreams=i},shaka.mss.MssParser.prototype.createStream_=function(e,t,r,n,a){var i=this,o=shaka.util.TXml,s=shaka.util.ManifestParserUtils.ContentType,l=shaka.mss.MssParser,u=e.attributes.Type;if("audio"!==u&&"video"!==u&&"text"!==u)return shaka.log.alwaysWarn("Ignoring unrecognized type:",u),null;var c=e.attributes.Language,d=this.globalId_++,p=o.parseAttr(t,"Bitrate",o.parsePositiveInt),h=o.parseAttr(t,"MaxWidth",o.parsePositiveInt),f=o.parseAttr(t,"MaxHeight",o.parsePositiveInt),m=o.parseAttr(t,"Channels",o.parsePositiveInt);o=o.parseAttr(t,"SamplingRate",o.parsePositiveInt);var g=a.duration;r.length&&(g=r[r.length-1].end-r[0].start);var y=this.presentationTimeline_.getDuration();this.presentationTimeline_.setDuration(Math.min(g,y));var v={id:d,originalId:e.attributes.Name||String(d),groupId:null,createSegmentIndex:function(){return Promise.resolve()},closeSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:p||0,width:h||void 0,height:f||void 0,kind:"",encrypted:0<n.length,drmInfos:n,keyIds:new Set,language:shaka.util.LanguageUtils.normalize(c||"und"),originalLanguage:c,label:"",type:"",primary:!1,trickModeVideo:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:m,audioSamplingRate:o,spatialAudio:!1,closedCaptions:null,hdr:void 0,videoLayout:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:g,timescale:a.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1,fastSwitching:!1,fullMimeTypes:new Set};if((n=e.attributes.Subtype)&&((n=l.ROLE_MAPPING_[n])&&v.roles.push(n),"main"===n&&(v.primary=!0)),null!==(n=t.attributes.FourCC)&&""!==n||(n=e.attributes.FourCC),!n)if("audio"===u)n="AAC";else if("video"===u)return shaka.log.alwaysWarn('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;if(!l.SUPPORTED_CODECS_.includes(n.toUpperCase()))return shaka.log.alwaysWarn("Codec not supported:",n),null;switch(l=this.getCodecPrivateData_(t,u,n,v),v.mssPrivateData.codecPrivateData=l,u){case"audio":if(!l)return shaka.log.alwaysWarn("Quality unsupported without CodecPrivateData",u),null;v.type=s.AUDIO,v.mimeType="mss/audio/mp4",v.codecs=this.getAACCodec_(t,n,l);break;case"video":if(!l)return shaka.log.alwaysWarn("Quality unsupported without CodecPrivateData",u),null;v.type=s.VIDEO,v.mimeType="mss/video/mp4",v.codecs=this.getH264Codec_(t,l);break;case"text":v.type=s.TEXT,v.mimeType="application/mp4",("TTML"===n||"DFXP"===n)&&(v.codecs="stpp")}return v.fullMimeTypes.add(shaka.util.MimeUtils.getFullType(v.mimeType,v.codecs)),v.createSegmentIndex=function(){if(v.segmentIndex)return Promise.resolve();if(i.initSegmentDataByStreamId_.has(v.id))var t=i.initSegmentDataByStreamId_.get(v.id);else t=[],v.type==s.VIDEO&&(t=v.mssPrivateData.codecPrivateData.split("00000001").slice(1)),t={id:v.id,type:v.type,codecs:v.codecs,encrypted:v.encrypted,timescale:v.mssPrivateData.timescale,duration:v.mssPrivateData.duration,videoNalus:t,audioConfig:new Uint8Array([]),videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:null,stream:v},t=new shaka.util.Mp4Generator([t]).initSegment(),i.initSegmentDataByStreamId_.set(v.id,t);return t=new shaka.media.InitSegmentReference((function(){return[]}),0,null,null,void 0,t),t=i.createSegments_(t,v,e,r),v.segmentIndex=new shaka.media.SegmentIndex(t),Promise.resolve()},v.closeSegmentIndex=function(){v.segmentIndex&&(v.segmentIndex.release(),v.segmentIndex=null)},v},shaka.mss.MssParser.prototype.getCodecPrivateData_=function(e,t,r,n){if(e=e.attributes.CodecPrivateData)return e;if("audio"!==t)return null;t=n.channelsCount||2;var a={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return n=a[e=n.audioSamplingRate||44100],"AACH"===r?(r=new Uint8Array(4),e=a[2*e],r[0]=40|n>>1,r[1]=n<<7|t<<3|e>>1,r[2]=e<<7|8,r[3]=0,(t=new Uint16Array(2))[0]=(r[0]<<8)+r[1],t[1]=(r[2]<<8)+r[3],t[0].toString(16)+t[1].toString(16)):((r=new Uint8Array(2))[0]=16|n>>1,r[1]=n<<7|t<<3,(t=new Uint16Array(1))[0]=(r[0]<<8)+r[1],t[0].toString(16))},shaka.mss.MssParser.prototype.getAACCodec_=function(e,t,r){return e=0,"AACH"===t&&(e=5),r?0===e&&(e=(248&parseInt(r.substr(0,2),16))>>3):(e=2,"AACH"===t&&(e=5)),"mp4a.40."+e},shaka.mss.MssParser.prototype.getH264Codec_=function(e,t){return(e=/00000001[0-9]7/.exec(t)).length&&t?"avc1."+t.substr(t.indexOf(e[0])+10,6):""},shaka.mss.MssParser.prototype.createSegments_=function(e,t,r,n){var a=this,i=shaka.util.ManifestParserUtils;r=r.attributes.Url,goog.asserts.assert(r,"Missing URL for segments");var o=r.replace("{bitrate}",String(t.bandwidth));r=[];for(var s={},l=(n=$jscomp.makeIterator(n)).next();!l.done;s={$jscomp$loop$prop$time$916:s.$jscomp$loop$prop$time$916},l=n.next())s.$jscomp$loop$prop$time$916=l.value,l=function(e){return function(){return i.resolveUris(a.manifestUris_,[o.replace("{start time}",String(e.$jscomp$loop$prop$time$916.unscaledStart))])}}(s),r.push(new shaka.media.SegmentReference(s.$jscomp$loop$prop$time$916.start,s.$jscomp$loop$prop$time$916.end,l,0,null,e,0,0,t.mssPrivateData.duration));return r},shaka.mss.MssParser.prototype.createTimeline_=function(e,t,r){goog.asserts.assert(0<t&&1/0>t,"timescale must be a positive, finite integer"),goog.asserts.assert(0<r,"duration must be a positive integer");var n=shaka.util.TXml;e=n.findChildren(e,"c");for(var a=[],i=0,o=0;o<e.length;++o){var s=e[o],l=e[o+1],u=n.parseAttr(s,"t",n.parseNonNegativeInt),c=n.parseAttr(s,"d",n.parseNonNegativeInt),d=n.parseAttr(s,"r",n.parseInt);if(!c){shaka.log.warning('"c" element must have a duration:','ignoring the remaining "c" elements.',s);break}if(u=null!=u?u:i,0>(d=d||0))if(l){if(null==(l=n.parseAttr(l,"t",n.parseNonNegativeInt))){shaka.log.warning('An "c" element cannot have a negative repeat','if the next "c" element does not have a valid start time:','ignoring the remaining "c" elements.',s);break}if(u>=l){shaka.log.warning('An "c" element cannot have a negative repeatif its start ','time exceeds the next "c" element\'s start time:','ignoring the remaining "c" elements.',s);break}d=Math.ceil((l-u)/c)-1}else{if(1/0==r){shaka.log.warning('The last "c" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "c" element.',s);break}if(u/t>=r){shaka.log.warning('The last "c" element cannot have a negative repeat',"if its start time exceeds the duration:",'igoring the last "c" element.',s);break}d=Math.ceil((r*t-u)/c)-1}for(s=0;s<=d;++s)i=u+c,a.push({start:u/t,end:i/t,unscaledStart:u}),u=i}return a},shaka.mss.MssParser.prototype.createVariant_=function(e,t){var r=shaka.util.ManifestParserUtils.ContentType;return goog.asserts.assert(!e||e.type==r.AUDIO,"Audio parameter mismatch!"),goog.asserts.assert(!t||t.type==r.VIDEO,"Video parameter mismatch!"),r=0,e&&e.bandwidth&&0<e.bandwidth&&(r+=e.bandwidth),t&&t.bandwidth&&0<t.bandwidth&&(r+=t.bandwidth),{id:this.globalId_++,language:e?e.language:"und",disabledUntilTime:0,primary:!!e&&e.primary||!!t&&t.primary,audio:e,video:t,bandwidth:r,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}},goog.exportSymbol("shaka.mss.MssParser",shaka.mss.MssParser),shaka.mss.MssParser.MIN_UPDATE_PERIOD_=3,shaka.mss.MssParser.DEFAULT_TIME_SCALE_=1e7,shaka.mss.MssParser.SUPPORTED_CODECS_="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),shaka.mss.MssParser.ROLE_MAPPING_={CAPT:"main",SUBT:"alternate",DESC:"main"},shaka.media.ManifestParser.registerParserByMime("application/vnd.ms-sstr+xml",(function(){return new shaka.mss.MssParser})),shaka.net.HttpPluginUtils=function(){},shaka.net.HttpPluginUtils.makeResponse=function(e,t,r,n,a,i){if(200<=r&&299>=r&&202!=r)return{uri:a||n,originalUri:n,data:t,status:r,headers:e,fromCache:!!e["x-shaka-from-cache"]};a=null;try{a=shaka.util.StringUtils.fromBytesAutoDetect(t)}catch(e){}throw shaka.log.debug("HTTP error text:",a),new shaka.util.Error(401==r||403==r?shaka.util.Error.Severity.CRITICAL:shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.BAD_HTTP_STATUS,n,r,a,e,i)},shaka.net.HttpFetchPlugin=function(){},shaka.net.HttpFetchPlugin.parse=function(e,t,r,n,a){var i=new shaka.net.HttpFetchPlugin.Headers_;shaka.util.MapUtils.asMap(t.headers).forEach((function(e,t){i.append(t,e)}));var o=new shaka.net.HttpFetchPlugin.AbortController_,s={canceled:!1,timedOut:!1};if(e=shaka.net.HttpFetchPlugin.request_(e,r,{body:t.body||void 0,headers:i,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},s,n,a,t.streamDataCallback),e=new shaka.util.AbortableOperation(e,(function(){return s.canceled=!0,o.abort(),Promise.resolve()})),t=t.retryParameters.timeout){var l=new shaka.util.Timer((function(){s.timedOut=!0,o.abort()}));l.tickAfter(t/1e3),e.finally((function(){l.stop()}))}return e},shaka.net.HttpFetchPlugin.request_=function(e,t,r,n,a,i,o){var s,l,u,c,d,p,h,f,m,g,y,v;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){switch(_.nextAddress){case 1:return s=shaka.net.HttpFetchPlugin.fetch_,l=shaka.net.HttpFetchPlugin.ReadableStream_,p=d=0,h=Date.now(),_.setCatchFinallyBlocks(2),_.yield(s(e,r),4);case 4:if(u=_.yieldResult,i(shaka.net.HttpFetchPlugin.headersToGenericObject_(u.headers)),"HEAD"==r.method){_.jumpTo(5);break}return goog.asserts.assert(u.body,"non-HEAD responses should have a body"),f=u.clone().body.getReader(),g=(m=u.headers.get("Content-Length"))?parseInt(m,10):0,new l({start:function(e){var t=function(){var r,n,i,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:return l.setCatchFinallyBlocks(2),l.yield(f.read(),4);case 4:r=l.yieldResult,l.leaveTryBlock(3);break;case 2:return n=l.enterCatchBlock(),shaka.log.v1("error reading from stream",n.message),l.return();case 3:if(r.done){l.jumpTo(5);break}if(d+=r.value.byteLength,!o){l.jumpTo(5);break}return l.yield(o(r.value),5);case 5:(100<(i=Date.now())-h||r.done)&&(s=r.done?0:g-d,a(i-h,d-p,s),p=d,h=i),r.done?(goog.asserts.assert(!r.value,'readObj should be unset when "done" is true.'),e.close()):(e.enqueue(r.value),t()),l.jumpToEnd()}}))};t()}}),_.yield(u.arrayBuffer(),6);case 6:c=_.yieldResult;case 5:_.leaveTryBlock(3);break;case 2:if(y=_.enterCatchBlock(),n.canceled)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.OPERATION_ABORTED,e,t);if(n.timedOut)throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.TIMEOUT,e,t);throw new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.HTTP_ERROR,e,y,t);case 3:return v=shaka.net.HttpFetchPlugin.headersToGenericObject_(u.headers),_.return(shaka.net.HttpPluginUtils.makeResponse(v,c,u.status,e,u.url,t))}}))},shaka.net.HttpFetchPlugin.headersToGenericObject_=function(e){var t={};return e.forEach((function(e,r){t[r.trim()]=e})),t},shaka.net.HttpFetchPlugin.isSupported=function(){if(!window.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!!window.Response&&(!!new Response("").body&&!(!window.fetch||!window.AbortController))},goog.exportSymbol("shaka.net.HttpFetchPlugin",shaka.net.HttpFetchPlugin),goog.exportProperty(shaka.net.HttpFetchPlugin,"isSupported",shaka.net.HttpFetchPlugin.isSupported),goog.exportProperty(shaka.net.HttpFetchPlugin,"parse",shaka.net.HttpFetchPlugin.parse),shaka.net.HttpFetchPlugin.fetch_=window.fetch,shaka.net.HttpFetchPlugin.AbortController_=window.AbortController,shaka.net.HttpFetchPlugin.ReadableStream_=window.ReadableStream,shaka.net.HttpFetchPlugin.Headers_=window.Headers,shaka.net.HttpFetchPlugin.isSupported()&&(shaka.net.NetworkingEngine.registerScheme("http",shaka.net.HttpFetchPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.PREFERRED,!0),shaka.net.NetworkingEngine.registerScheme("https",shaka.net.HttpFetchPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.PREFERRED,!0),shaka.net.NetworkingEngine.registerScheme("blob",shaka.net.HttpFetchPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.PREFERRED,!0)),shaka.net.HttpXHRPlugin=function(){},shaka.net.HttpXHRPlugin.parse=function(e,t,r,n,a){var i=new shaka.net.HttpXHRPlugin.Xhr_,o=Date.now(),s=0,l=new Promise((function(l,u){i.open(t.method,e,!0),i.responseType="arraybuffer",i.timeout=t.retryParameters.timeout,i.withCredentials=t.allowCrossSiteCredentials,i.onabort=function(){u(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.OPERATION_ABORTED,e,r))};var c=!1;for(var d in i.onreadystatechange=function(e){2!=i.readyState||c||(e=shaka.net.HttpXHRPlugin.headersToGenericObject_(i),a(e),c=!0)},i.onload=function(t){var a=shaka.net.HttpXHRPlugin.headersToGenericObject_(i);goog.asserts.assert(i.response instanceof ArrayBuffer,"XHR should have a response by now!");var c=i.response;try{var d=Date.now();n(d-o,t.loaded-s,0);var p=shaka.net.HttpPluginUtils.makeResponse(a,c,i.status,e,i.responseURL,r);l(p)}catch(e){goog.asserts.assert(e instanceof shaka.util.Error,"Wrong error type!"),u(e)}},i.onerror=function(t){u(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.HTTP_ERROR,e,t,r))},i.ontimeout=function(t){u(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.TIMEOUT,e,r))},i.onprogress=function(e){var t=Date.now();(100<t-o||e.lengthComputable&&e.loaded==e.total)&&(n(t-o,e.loaded-s,4==i.readyState?0:e.total-e.loaded),s=e.loaded,o=t)},t.headers){var p=d.toLowerCase();i.setRequestHeader(p,t.headers[d])}i.send(t.body)}));return new shaka.util.AbortableOperation(l,(function(){return i.abort(),Promise.resolve()}))},shaka.net.HttpXHRPlugin.headersToGenericObject_=function(e){var t=e.getAllResponseHeaders().trim().split("\r\n");e={};for(var r=(t=$jscomp.makeIterator(t)).next();!r.done;r=t.next())e[(r=r.value.split(": "))[0].toLowerCase()]=r.slice(1).join(": ");return e},goog.exportSymbol("shaka.net.HttpXHRPlugin",shaka.net.HttpXHRPlugin),goog.exportProperty(shaka.net.HttpXHRPlugin,"parse",shaka.net.HttpXHRPlugin.parse),shaka.net.HttpXHRPlugin.Xhr_=window.XMLHttpRequest,shaka.net.NetworkingEngine.registerScheme("http",shaka.net.HttpXHRPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.FALLBACK,!0),shaka.net.NetworkingEngine.registerScheme("https",shaka.net.HttpXHRPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.FALLBACK,!0),shaka.net.NetworkingEngine.registerScheme("blob",shaka.net.HttpXHRPlugin.parse,shaka.net.NetworkingEngine.PluginPriority.FALLBACK,!0),shaka.offline={},shaka.offline.DownloadInfo=function(e,t,r,n){this.ref=e,this.estimateId=t,this.groupId=r,this.isInitSegment=n},shaka.offline.DownloadInfo.idForSegmentRef=function(e){return e.getUris().map((function(e){return"{"+encodeURI(e)+"}"})).join("")+":"+e.startByte+":"+e.endByte},shaka.offline.DownloadInfo.prototype.getRefId=function(){return shaka.offline.DownloadInfo.idForSegmentRef(this.ref)},shaka.offline.DownloadInfo.prototype.makeSegmentRequest=function(e){return shaka.util.Networking.createSegmentRequest(this.ref.getUris(),this.ref.startByte,this.ref.endByte,e.streaming.retryParameters)},shaka.offline.DownloadProgressEstimator=function(){this.actualDownloaded_=this.estimatedDownloaded_=this.estimatedTotal_=0,this.pending_=new Map,this.nextId_=0},shaka.offline.DownloadProgressEstimator.prototype.open=function(e){this.estimatedTotal_+=e;var t=this.nextId_;return this.nextId_++,this.pending_.set(t,e),t},shaka.offline.DownloadProgressEstimator.prototype.close=function(e,t){if(this.pending_.has(e)){var r=this.pending_.get(e);this.pending_.delete(e),this.estimatedDownloaded_+=r,this.actualDownloaded_+=t}},shaka.offline.DownloadProgressEstimator.prototype.getEstimatedProgress=function(){return 0==this.estimatedTotal_?0:this.estimatedDownloaded_/this.estimatedTotal_},shaka.offline.DownloadProgressEstimator.prototype.getTotalDownloaded=function(){return this.actualDownloaded_},shaka.offline.DownloadManager=function(e){var t=this;this.networkingEngine_=e,this.groups_=new Map,this.destroyer_=new shaka.util.Destroyer((function(){return t.abortAll().catch((function(){}))})),this.abortCallbacks_=[],this.onProgress_=function(e,t){},this.onInitData_=function(e,t){},this.estimator_=new shaka.offline.DownloadProgressEstimator},shaka.offline.DownloadManager.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.offline.DownloadManager.prototype.setCallbacks=function(e,t){this.onProgress_=e,this.onInitData_=t},shaka.offline.DownloadManager.prototype.abortAll=function(){var e=this.abortCallbacks_.map((function(e){return e()}));return this.abortCallbacks_=[],Promise.all(e)},shaka.offline.DownloadManager.prototype.addDownloadEstimate=function(e){return this.estimator_.open(e)},shaka.offline.DownloadManager.prototype.queue=function(e,t,r,n,a){var i=this;this.destroyer_.ensureNotDestroyed();var o=(this.groups_.get(e)||Promise.resolve()).then((function(){var e,o,s,l,u,c,d;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){if(1==p.nextAddress)return p.yield(i.fetchSegment_(t),2);if(e=p.yieldResult,i.destroyer_.destroyed())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.OPERATION_ABORTED);if(n)for(l in o=shaka.util.BufferUtils.toUint8(e),(s=new shaka.util.Pssh(o)).data)u=Number(l),c=s.data[u],d=s.systemIds[u],i.onInitData_(c,d);return i.estimator_.close(r,e.byteLength),i.onProgress_(i.estimator_.getEstimatedProgress(),i.estimator_.getTotalDownloaded()),p.return(a(e))}))}));return this.groups_.set(e,o),o},shaka.offline.DownloadManager.prototype.queueWork=function(e,t){this.destroyer_.ensureNotDestroyed();var r=(this.groups_.get(e)||Promise.resolve()).then((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return e.yield(t(),0)}))}));return this.groups_.set(e,r),r},shaka.offline.DownloadManager.prototype.waitToFinish=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?t.yield(Promise.all(e.groups_.values()),2):t.return(e.estimator_.getTotalDownloaded())}))},shaka.offline.DownloadManager.prototype.fetchSegment_=function(e){var t,r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return 1==o.nextAddress?(t=shaka.net.NetworkingEngine.RequestType.SEGMENT,r=i.networkingEngine_.request(t,e),n=function(){return r.abort()},i.abortCallbacks_.push(n),o.yield(r.promise,2)):(a=o.yieldResult,shaka.util.ArrayUtils.remove(i.abortCallbacks_,n),o.return(a.data))}))},shaka.offline.indexeddb={},shaka.offline.indexeddb.DBOperation=function(e,t){var r=this;this.transaction_=e,this.store_=e.objectStore(t),this.promise_=new shaka.util.PublicPromise,e.onabort=function(e){e.preventDefault(),r.promise_.reject()},e.onerror=function(e){e.preventDefault(),r.promise_.reject()},e.oncomplete=function(e){r.promise_.resolve()}},shaka.offline.indexeddb.DBOperation.prototype.abort=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress){try{e.transaction_.abort()}catch(e){}return t.setCatchFinallyBlocks(2),t.yield(e.promise_,4)}if(2!=t.nextAddress)return t.leaveTryBlock(0);t.enterCatchBlock(),t.jumpToEnd()}))},shaka.offline.indexeddb.DBOperation.prototype.forEachEntry=function(e){var t=this;return new Promise((function(r,n){var a=t.store_.openCursor();a.onerror=n,a.onsuccess=function(t){var n;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){if(1==t.nextAddress)return null==a.result?(r(),t.return()):(n=a.result,t.yield(e(n.key,n.value,n),2));n.continue(),t.jumpToEnd()}))}}))},shaka.offline.indexeddb.DBOperation.prototype.store=function(){return this.store_},shaka.offline.indexeddb.DBOperation.prototype.promise=function(){return this.promise_},shaka.offline.indexeddb.DBConnection=function(e){this.connection_=e,this.pending_=[]},shaka.offline.indexeddb.DBConnection.prototype.destroy=function(){return Promise.all(this.pending_.map((function(e){return e.abort()})))},shaka.offline.indexeddb.DBConnection.prototype.startReadOnlyOperation=function(e){return this.startOperation_(e,"readonly")},shaka.offline.indexeddb.DBConnection.prototype.startReadWriteOperation=function(e){return this.startOperation_(e,"readwrite")},shaka.offline.indexeddb.DBConnection.prototype.startOperation_=function(e,t){var r=this;t=this.connection_.transaction([e],t);var n=new shaka.offline.indexeddb.DBOperation(t,e);return this.pending_.push(n),n.promise().then((function(){return r.stopTracking_(n)}),(function(){return r.stopTracking_(n)})),n},shaka.offline.indexeddb.DBConnection.prototype.stopTracking_=function(e){shaka.util.ArrayUtils.remove(this.pending_,e)},shaka.offline.indexeddb.BaseStorageCell=function(e,t,r){this.connection_=new shaka.offline.indexeddb.DBConnection(e),this.segmentStore_=t,this.manifestStore_=r},shaka.offline.indexeddb.BaseStorageCell.prototype.destroy=function(){return this.connection_.destroy()},shaka.offline.indexeddb.BaseStorageCell.prototype.hasFixedKeySpace=function(){return!0},shaka.offline.indexeddb.BaseStorageCell.prototype.addSegments=function(e){return this.rejectAdd(this.segmentStore_)},shaka.offline.indexeddb.BaseStorageCell.prototype.removeSegments=function(e,t){return this.remove_(this.segmentStore_,e,t)},shaka.offline.indexeddb.BaseStorageCell.prototype.getSegments=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?n.yield(r.get_(r.segmentStore_,e),2):(t=n.yieldResult,n.return(t.map((function(e){return r.convertSegmentData(e)}))))}))},shaka.offline.indexeddb.BaseStorageCell.prototype.addManifests=function(e){return this.rejectAdd(this.manifestStore_)},shaka.offline.indexeddb.BaseStorageCell.prototype.updateManifest=function(e,t){return this.rejectUpdate(this.manifestStore_)},shaka.offline.indexeddb.BaseStorageCell.prototype.updateManifestImplementation=function(e,t){var r=this.connection_.startReadWriteOperation(this.manifestStore_),n=r.store();return n.get(e).onsuccess=function(r){n.put(t,e)},r.promise()},shaka.offline.indexeddb.BaseStorageCell.prototype.updateManifestExpiration=function(e,t){var r=this.connection_.startReadWriteOperation(this.manifestStore_),n=r.store();return n.get(e).onsuccess=function(r){(r=r.target.result)&&(r.expiration=t,n.put(r,e))},r.promise()},shaka.offline.indexeddb.BaseStorageCell.prototype.removeManifests=function(e,t){return this.remove_(this.manifestStore_,e,t)},shaka.offline.indexeddb.BaseStorageCell.prototype.getManifests=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?n.yield(r.get_(r.manifestStore_,e),2):(t=n.yieldResult,n.return(Promise.all(t.map((function(e){return r.convertManifest(e)})))))}))},shaka.offline.indexeddb.BaseStorageCell.prototype.getAllManifests=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(e=r.connection_.startReadOnlyOperation(r.manifestStore_),t=new Map,n.yield(e.forEachEntry((function(e,n){var a;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){if(1==i.nextAddress)return i.yield(r.convertManifest(n),2);a=i.yieldResult,t.set(e,a),i.jumpToEnd()}))})),2)):3!=n.nextAddress?n.yield(e.promise(),3):n.return(t)}))},shaka.offline.indexeddb.BaseStorageCell.prototype.convertSegmentData=function(e){return e},shaka.offline.indexeddb.BaseStorageCell.prototype.convertManifest=function(e){return Promise.resolve(e)},shaka.offline.indexeddb.BaseStorageCell.prototype.rejectAdd=function(e){return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.NEW_KEY_OPERATION_NOT_SUPPORTED,"Cannot add new value to "+e))},shaka.offline.indexeddb.BaseStorageCell.prototype.rejectUpdate=function(e){return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MODIFY_OPERATION_NOT_SUPPORTED,"Cannot modify values in "+e))},shaka.offline.indexeddb.BaseStorageCell.prototype.add=function(e,t){var r,n,a,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){for(r=u.connection_.startReadWriteOperation(e),n=r.store(),a=[],i={},o=$jscomp.makeIterator(t),s=o.next();!s.done;i={$jscomp$loop$prop$request$918:i.$jscomp$loop$prop$request$918},s=o.next())l=s.value,i.$jscomp$loop$prop$request$918=n.add(l),i.$jscomp$loop$prop$request$918.onsuccess=function(e){return function(t){a.push(e.$jscomp$loop$prop$request$918.result)}}(i);return c.yield(r.promise(),2)}return c.return(a)}))},shaka.offline.indexeddb.BaseStorageCell.prototype.remove_=function(e,t,r){for(var n=(e=this.connection_.startReadWriteOperation(e)).store(),a={},i=(t=$jscomp.makeIterator(t)).next();!i.done;a={$jscomp$loop$prop$key$920:a.$jscomp$loop$prop$key$920},i=t.next())a.$jscomp$loop$prop$key$920=i.value,n.delete(a.$jscomp$loop$prop$key$920).onsuccess=function(e){return function(){return r(e.$jscomp$loop$prop$key$920)}}(a);return e.promise()},shaka.offline.indexeddb.BaseStorageCell.prototype.get_=function(e,t){var r,n,a,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){if(1==c.nextAddress){for(r=u.connection_.startReadOnlyOperation(e),n=r.store(),a={},i=[],o={},s=$jscomp.makeIterator(t),l=s.next();!l.done;o={$jscomp$loop$prop$request$922:o.$jscomp$loop$prop$request$922,$jscomp$loop$prop$key$923:o.$jscomp$loop$prop$key$923},l=s.next())o.$jscomp$loop$prop$key$923=l.value,o.$jscomp$loop$prop$request$922=n.get(o.$jscomp$loop$prop$key$923),o.$jscomp$loop$prop$request$922.onsuccess=function(e){return function(){null==e.$jscomp$loop$prop$request$922.result&&i.push(e.$jscomp$loop$prop$key$923),a[e.$jscomp$loop$prop$key$923]=e.$jscomp$loop$prop$request$922.result}}(o);return c.yield(r.promise(),2)}if(i.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.KEY_NOT_FOUND,"Could not find values for "+i);return c.return(t.map((function(e){return a[e]})))}))},shaka.offline.indexeddb.EmeSessionStorageCell=function(e,t){this.connection_=new shaka.offline.indexeddb.DBConnection(e),this.store_=t},shaka.offline.indexeddb.EmeSessionStorageCell.prototype.destroy=function(){return this.connection_.destroy()},shaka.offline.indexeddb.EmeSessionStorageCell.prototype.getAll=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(e=r.connection_.startReadOnlyOperation(r.store_),t=[],n.yield(e.forEachEntry((function(e,r){t.push(r)})),2)):3!=n.nextAddress?n.yield(e.promise(),3):n.return(t)}))},shaka.offline.indexeddb.EmeSessionStorageCell.prototype.add=function(e){for(var t=this.connection_.startReadWriteOperation(this.store_),r=t.store(),n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())r.add(n.value);return t.promise()},shaka.offline.indexeddb.EmeSessionStorageCell.prototype.remove=function(e){var t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(t=r.connection_.startReadWriteOperation(r.store_),n.yield(t.forEachEntry((function(t,r,n){e.includes(r.sessionId)&&n.delete()})),2)):n.yield(t.promise(),0)}))},shaka.offline.StorageCellHandle={},shaka.offline.StorageCellPath={},shaka.offline.StorageMuxer=function(){this.mechanisms_=new Map},shaka.offline.StorageMuxer.prototype.destroy=function(){for(var e=[],t=$jscomp.makeIterator(this.mechanisms_.values()),r=t.next();!r.done;r=t.next())e.push(r.value.destroy());return this.mechanisms_.clear(),Promise.all(e)},shaka.offline.StorageMuxer.prototype.init=function(){var e=this;shaka.offline.StorageMuxer.getRegistry_().forEach((function(t,r){(t=t())?e.mechanisms_.set(r,t):shaka.log.info("Skipping "+r+" as it is not supported on this platform")}));for(var t=[],r=$jscomp.makeIterator(this.mechanisms_.values()),n=r.next();!n.done;n=r.next())t.push(n.value.init());return Promise.all(t)},shaka.offline.StorageMuxer.prototype.getActive=function(){var e=null;if(this.mechanisms_.forEach((function(t,r){t.getCells().forEach((function(t,n){t.hasFixedKeySpace()||e||(e={path:{mechanism:r,cell:n},cell:t})}))})),e)return e;throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MISSING_STORAGE_CELL,"Could not find a cell that supports add-operations")},shaka.offline.StorageMuxer.prototype.forEachCell=function(e){this.mechanisms_.forEach((function(t,r){t.getCells().forEach((function(t,n){e({mechanism:r,cell:n},t)}))}))},shaka.offline.StorageMuxer.prototype.getCell=function(e,t){var r=this.mechanisms_.get(e);if(!r)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MISSING_STORAGE_CELL,"Could not find mechanism with name "+e);if(!(e=r.getCells().get(t)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MISSING_STORAGE_CELL,"Could not find cell with name "+t);return e},shaka.offline.StorageMuxer.prototype.forEachEmeSessionCell=function(e){this.mechanisms_.forEach((function(t,r){e(t.getEmeSessionCell())}))},shaka.offline.StorageMuxer.prototype.getEmeSessionCell=function(){var e=Array.from(this.mechanisms_.keys());if(!e.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.STORAGE_NOT_SUPPORTED,"No supported storage mechanisms found");return this.mechanisms_.get(e[0]).getEmeSessionCell()},shaka.offline.StorageMuxer.prototype.resolvePath=function(e){var t=this.mechanisms_.get(e.mechanism);return t?t.getCells().get(e.cell):null},shaka.offline.StorageMuxer.prototype.erase=function(){var e,t,r=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(e=Array.from(r.mechanisms_.values()),(t=0<e.length)||shaka.offline.StorageMuxer.getRegistry_().forEach((function(t,r){(t=t())&&e.push(t)})),n.yield(Promise.all(e.map((function(e){return e.erase()}))),2)):t?n.jumpTo(0):n.yield(Promise.all(e.map((function(e){return e.destroy()}))),0)}))},shaka.offline.StorageMuxer.register=function(e,t){shaka.offline.StorageMuxer.registry_.set(e,t)},shaka.offline.StorageMuxer.unregister=function(e){shaka.offline.StorageMuxer.registry_.delete(e)},shaka.offline.StorageMuxer.support=function(){for(var e=shaka.offline.StorageMuxer.getRegistry_(),t=(e=$jscomp.makeIterator(e.values())).next();!t.done;t=e.next())if(t=(t=t.value)())return t.destroy(),!0;return!1},shaka.offline.StorageMuxer.overrideSupport=function(e){shaka.offline.StorageMuxer.override_=e},shaka.offline.StorageMuxer.clearOverride=function(){shaka.offline.StorageMuxer.override_=null},shaka.offline.StorageMuxer.getRegistry_=function(){var e=shaka.offline.StorageMuxer.override_,t=shaka.offline.StorageMuxer.registry_;return COMPILED?t:e||t},goog.exportSymbol("shaka.offline.StorageMuxer",shaka.offline.StorageMuxer),goog.exportProperty(shaka.offline.StorageMuxer,"unregister",shaka.offline.StorageMuxer.unregister),goog.exportProperty(shaka.offline.StorageMuxer,"register",shaka.offline.StorageMuxer.register),goog.exportProperty(shaka.offline.StorageMuxer.prototype,"destroy",shaka.offline.StorageMuxer.prototype.destroy),shaka.offline.StorageMuxer.override_=null,shaka.offline.StorageMuxer.registry_=new Map,shaka.offline.indexeddb.V1StorageCell=function(){shaka.offline.indexeddb.BaseStorageCell.apply(this,arguments)},$jscomp.inherits(shaka.offline.indexeddb.V1StorageCell,shaka.offline.indexeddb.BaseStorageCell),shaka.offline.indexeddb.V1StorageCell.prototype.updateManifestExpiration=function(e,t){var r,n,a,i=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){return r=i.connection_.startReadWriteOperation(i.manifestStore_),n=r.store(),a=new shaka.util.PublicPromise,n.get(e).onsuccess=function(r){(r=r.target.result)?(goog.asserts.assert(r.key==e,"With in-line keys, the keys should match"),r.expiration=t,n.put(r),a.resolve()):a.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.KEY_NOT_FOUND,"Could not find values for "+e))},o.yield(Promise.all([r.promise(),a]),0)}))},shaka.offline.indexeddb.V1StorageCell.prototype.convertManifest=function(e){var t,r,n,a,i,o,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress){for(t=shaka.offline.indexeddb.V1StorageCell,r=[],n=0;n<e.periods.length;++n)a=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,i=a-e.periods[n].startTime,o=t.convertPeriod_(e.periods[n],i),r.push(o);return l.yield(shaka.util.PeriodCombiner.combineDbStreams(r),2)}return s=l.yieldResult,l.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,streams:s,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})}))},shaka.offline.indexeddb.V1StorageCell.convertPeriod_=function(e,t){var r=shaka.offline.indexeddb.V1StorageCell;r.fillMissingVariants_(e);for(var n=$jscomp.makeIterator(e.streams),a=n.next();!a.done;a=n.next())goog.asserts.assert(a.value.variantIds,"After filling in missing variants, each stream should have variant ids");return e.streams.map((function(n){return r.convertStream_(n,e.startTime,t)}))},shaka.offline.indexeddb.V1StorageCell.convertStream_=function(e,t,r){var n=shaka.offline.indexeddb.V1StorageCell,a=e.initSegmentUri?n.getKeyFromSegmentUri_(e.initSegmentUri):null,i=t+e.presentationTimeOffset,o=t+r;return{id:e.id,originalId:null,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,initSegmentKey:a,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(e){return n.convertSegment_(e,a,t,o,i)})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1}},shaka.offline.indexeddb.V1StorageCell.convertSegment_=function(e,t,r,n,a){var i=shaka.offline.indexeddb.V1StorageCell.getKeyFromSegmentUri_(e.uri);return{startTime:r+e.startTime,endTime:r+e.endTime,dataKey:i,initSegmentKey:t,appendWindowStart:r,appendWindowEnd:n,timestampOffset:a,tilesLayout:"",mimeType:null,codecs:null}},shaka.offline.indexeddb.V1StorageCell.prototype.convertSegmentData=function(e){return{data:e.data}},shaka.offline.indexeddb.V1StorageCell.getKeyFromSegmentUri_=function(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MALFORMED_OFFLINE_URI,"Could not parse uri "+e)},shaka.offline.indexeddb.V1StorageCell.fillMissingVariants_=function(e){var t=shaka.util.ManifestParserUtils.ContentType.AUDIO,r=shaka.util.ManifestParserUtils.ContentType.VIDEO,n=e.streams.filter((function(e){return e.contentType==t}));if(e=e.streams.filter((function(e){return e.contentType==r})),!n.every((function(e){return e.variantIds}))||!e.every((function(e){return e.variantIds}))){goog.asserts.assert(n.every((function(e){return!e.variantIds})),"Some audio streams have variant ids and some do not."),goog.asserts.assert(e.every((function(e){return!e.variantIds})),"Some video streams have variant ids and some do not.");for(var a=$jscomp.makeIterator(n),i=a.next();!i.done;i=a.next())i.value.variantIds=[];for(i=(a=$jscomp.makeIterator(e)).next();!i.done;i=a.next())i.value.variantIds=[];if(a=0,e.length&&!n.length){shaka.log.debug("Found video-only content. Creating variants for video.");var o=a++,s=$jscomp.makeIterator(e);for(i=s.next();!i.done;i=s.next())i.value.variantIds.push(o)}if(!e.length&&n.length)for(shaka.log.debug("Found audio-only content. Creating variants for audio."),o=a++,i=(s=$jscomp.makeIterator(n)).next();!i.done;i=s.next())i.value.variantIds.push(o);if(e.length&&n.length)for(shaka.log.debug("Found audio-video content. Creating variants."),i=(n=$jscomp.makeIterator(n)).next();!i.done;i=n.next())for(i=i.value,s=(o=$jscomp.makeIterator(e)).next();!s.done;s=o.next()){s=s.value;var l=a++;i.variantIds.push(l),s.variantIds.push(l)}}},shaka.offline.indexeddb.V2StorageCell=function(){shaka.offline.indexeddb.BaseStorageCell.apply(this,arguments)},$jscomp.inherits(shaka.offline.indexeddb.V2StorageCell,shaka.offline.indexeddb.BaseStorageCell),shaka.offline.indexeddb.V2StorageCell.prototype.convertManifest=function(e){var t,r,n,a,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){if(1==l.nextAddress){for(t=[],r=0;r<e.periods.length;++r)n=r==e.periods.length-1?e.duration:e.periods[r+1].startTime,a=n-e.periods[r].startTime,i=s.convertPeriod_(e.periods[r],a),t.push(i);return l.yield(shaka.util.PeriodCombiner.combineDbStreams(t),2)}return o=l.yieldResult,l.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:null==e.expiration?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:o,sequenceMode:!1})}))},shaka.offline.indexeddb.V2StorageCell.prototype.convertPeriod_=function(e,t){for(var r=[],n=$jscomp.makeIterator(e.streams),a=n.next();!a.done;a=n.next())0!=(a=a.value).variantIds.length&&r.push(this.convertStream_(a,e.startTime,e.startTime+t));return r},shaka.offline.indexeddb.V2StorageCell.prototype.convertStream_=function(e,t,r){var n=this;return{id:e.id,originalId:e.originalId,groupId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,videoLayout:void 0,kind:e.kind,language:e.language,originalLanguage:e.language||null,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map((function(a){return n.convertSegment_(a,e.initSegmentKey,t,r,e.presentationTimeOffset)})),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1,fastSwitching:!1}},shaka.offline.indexeddb.V2StorageCell.prototype.convertSegment_=function(e,t,r,n,a){return{startTime:r+e.startTime,endTime:r+e.endTime,initSegmentKey:t,appendWindowStart:r,appendWindowEnd:n,timestampOffset:r-a,dataKey:e.dataKey,tilesLayout:"",mimeType:null,codecs:null}},shaka.offline.indexeddb.V5StorageCell=function(){shaka.offline.indexeddb.BaseStorageCell.apply(this,arguments)},$jscomp.inherits(shaka.offline.indexeddb.V5StorageCell,shaka.offline.indexeddb.BaseStorageCell),shaka.offline.indexeddb.V5StorageCell.prototype.hasFixedKeySpace=function(){return!1},shaka.offline.indexeddb.V5StorageCell.prototype.addSegments=function(e){return this.add(this.segmentStore_,e)},shaka.offline.indexeddb.V5StorageCell.prototype.addManifests=function(e){return this.add(this.manifestStore_,e)},shaka.offline.indexeddb.V5StorageCell.prototype.updateManifest=function(e,t){return this.updateManifestImplementation(e,t)},shaka.offline.indexeddb.V5StorageCell.prototype.convertManifest=function(e){return null==e.expiration&&(e.expiration=1/0),Promise.resolve(e)},shaka.offline.indexeddb.StorageMechanism=function(){this.sessions_=this.v5_=this.v3_=this.v2_=this.v1_=this.db_=null},shaka.offline.indexeddb.StorageMechanism.prototype.init=function(){var e=this,t=shaka.offline.indexeddb.StorageMechanism.DB_NAME,r=shaka.offline.indexeddb.StorageMechanism.VERSION,n=new shaka.util.PublicPromise,a=!1,i=new shaka.util.Timer((function(){a=!0,n.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.INDEXED_DB_INIT_TIMED_OUT))}));i.tickAfter(5);var o=window.indexedDB.open(t,r);return o.onsuccess=function(t){a||(t=o.result,e.db_=t,e.v1_=shaka.offline.indexeddb.StorageMechanism.createV1_(t),e.v2_=shaka.offline.indexeddb.StorageMechanism.createV2_(t),e.v3_=shaka.offline.indexeddb.StorageMechanism.createV3_(t),e.v5_=shaka.offline.indexeddb.StorageMechanism.createV5_(t),e.sessions_=shaka.offline.indexeddb.StorageMechanism.createEmeSessionCell_(t),i.stop(),n.resolve())},o.onupgradeneeded=function(t){e.createStores_(o.result)},o.onerror=function(e){a||(n.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.INDEXED_DB_ERROR,o.error)),i.stop(),e.preventDefault())},n},shaka.offline.indexeddb.StorageMechanism.prototype.destroy=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){switch(t.nextAddress){case 1:if(!e.v1_){t.jumpTo(2);break}return t.yield(e.v1_.destroy(),2);case 2:if(!e.v2_){t.jumpTo(4);break}return t.yield(e.v2_.destroy(),4);case 4:if(!e.v3_){t.jumpTo(6);break}return t.yield(e.v3_.destroy(),6);case 6:if(!e.v5_){t.jumpTo(8);break}return t.yield(e.v5_.destroy(),8);case 8:if(!e.sessions_){t.jumpTo(10);break}return t.yield(e.sessions_.destroy(),10);case 10:e.db_&&e.db_.close(),t.jumpToEnd()}}))},shaka.offline.indexeddb.StorageMechanism.prototype.getCells=function(){var e=new Map;return this.v1_&&e.set("v1",this.v1_),this.v2_&&e.set("v2",this.v2_),this.v3_&&e.set("v3",this.v3_),this.v5_&&e.set("v5",this.v5_),e},shaka.offline.indexeddb.StorageMechanism.prototype.getEmeSessionCell=function(){return goog.asserts.assert(this.sessions_,"Cannot be destroyed."),this.sessions_},shaka.offline.indexeddb.StorageMechanism.prototype.erase=function(){var e=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){switch(t.nextAddress){case 1:if(!e.v1_){t.jumpTo(2);break}return t.yield(e.v1_.destroy(),2);case 2:if(!e.v2_){t.jumpTo(4);break}return t.yield(e.v2_.destroy(),4);case 4:if(!e.v3_){t.jumpTo(6);break}return t.yield(e.v3_.destroy(),6);case 6:if(!e.v5_){t.jumpTo(8);break}return t.yield(e.v5_.destroy(),8);case 8:return e.db_&&e.db_.close(),t.yield(shaka.offline.indexeddb.StorageMechanism.deleteAll_(),10);case 10:return e.db_=null,e.v1_=null,e.v2_=null,e.v3_=null,e.v5_=null,t.yield(e.init(),0)}}))},shaka.offline.indexeddb.StorageMechanism.createV1_=function(e){var t=shaka.offline.indexeddb.StorageMechanism,r=t.V1_SEGMENT_STORE;t=t.V1_MANIFEST_STORE;var n=e.objectStoreNames;return n.contains(t)&&n.contains(r)?(shaka.log.debug("Mounting v1 idb storage cell"),new shaka.offline.indexeddb.V1StorageCell(e,r,t)):null},shaka.offline.indexeddb.StorageMechanism.createV2_=function(e){var t=shaka.offline.indexeddb.StorageMechanism,r=t.V2_SEGMENT_STORE;t=t.V2_MANIFEST_STORE;var n=e.objectStoreNames;return n.contains(t)&&n.contains(r)?(shaka.log.debug("Mounting v2 idb storage cell"),new shaka.offline.indexeddb.V2StorageCell(e,r,t)):null},shaka.offline.indexeddb.StorageMechanism.createV3_=function(e){var t=shaka.offline.indexeddb.StorageMechanism,r=t.V3_SEGMENT_STORE;t=t.V3_MANIFEST_STORE;var n=e.objectStoreNames;return n.contains(t)&&n.contains(r)?(shaka.log.debug("Mounting v3 idb storage cell"),new shaka.offline.indexeddb.V2StorageCell(e,r,t)):null},shaka.offline.indexeddb.StorageMechanism.createV5_=function(e){var t=shaka.offline.indexeddb.StorageMechanism,r=t.V5_SEGMENT_STORE;t=t.V5_MANIFEST_STORE;var n=e.objectStoreNames;return n.contains(t)&&n.contains(r)?(shaka.log.debug("Mounting v5 idb storage cell"),new shaka.offline.indexeddb.V5StorageCell(e,r,t)):null},shaka.offline.indexeddb.StorageMechanism.createEmeSessionCell_=function(e){var t=shaka.offline.indexeddb.StorageMechanism.SESSION_ID_STORE;return e.objectStoreNames.contains(t)?(shaka.log.debug("Mounting session ID idb storage cell"),new shaka.offline.indexeddb.EmeSessionStorageCell(e,t)):null},shaka.offline.indexeddb.StorageMechanism.prototype.createStores_=function(e){for(var t=$jscomp.makeIterator([shaka.offline.indexeddb.StorageMechanism.V5_SEGMENT_STORE,shaka.offline.indexeddb.StorageMechanism.V5_MANIFEST_STORE,shaka.offline.indexeddb.StorageMechanism.SESSION_ID_STORE]),r=t.next();!r.done;r=t.next())r=r.value,e.objectStoreNames.contains(r)||e.createObjectStore(r,{autoIncrement:!0})},shaka.offline.indexeddb.StorageMechanism.deleteAll_=function(){var e=shaka.offline.indexeddb.StorageMechanism.DB_NAME,t=new shaka.util.PublicPromise,r=window.indexedDB.deleteDatabase(e);return r.onblocked=function(t){shaka.log.warning("Deleting",e,"is being blocked",t)},r.onsuccess=function(e){t.resolve()},r.onerror=function(e){t.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.INDEXED_DB_ERROR,r.error)),e.preventDefault()},t},shaka.offline.indexeddb.StorageMechanism.DB_NAME="shaka_offline_db",shaka.offline.indexeddb.StorageMechanism.VERSION=5,shaka.offline.indexeddb.StorageMechanism.V1_SEGMENT_STORE="segment",shaka.offline.indexeddb.StorageMechanism.V2_SEGMENT_STORE="segment-v2",shaka.offline.indexeddb.StorageMechanism.V3_SEGMENT_STORE="segment-v3",shaka.offline.indexeddb.StorageMechanism.V5_SEGMENT_STORE="segment-v5",shaka.offline.indexeddb.StorageMechanism.V1_MANIFEST_STORE="manifest";shaka.offline.indexeddb.StorageMechanism.V2_MANIFEST_STORE="manifest-v2",shaka.offline.indexeddb.StorageMechanism.V3_MANIFEST_STORE="manifest-v3",shaka.offline.indexeddb.StorageMechanism.V5_MANIFEST_STORE="manifest-v5",shaka.offline.indexeddb.StorageMechanism.SESSION_ID_STORE="session-ids",shaka.offline.StorageMuxer.register("idb",(function(){return shaka.util.Platform.isChromecast()||shaka.util.Platform.isXboxOne()||!window.indexedDB?null:new shaka.offline.indexeddb.StorageMechanism})),shaka.offline.OfflineUri=function(e,t,r,n){this.type_=e,this.mechanism_=t,this.cell_=r,this.key_=n,this.asString_=["offline:",e,"/",t,"/",r,"/",n].join("")},shaka.offline.OfflineUri.prototype.isManifest=function(){return"manifest"==this.type_},shaka.offline.OfflineUri.prototype.isSegment=function(){return"segment"==this.type_},shaka.offline.OfflineUri.prototype.mechanism=function(){return this.mechanism_},shaka.offline.OfflineUri.prototype.cell=function(){return this.cell_},shaka.offline.OfflineUri.prototype.key=function(){return this.key_},shaka.offline.OfflineUri.prototype.toString=function(){return this.asString_},shaka.offline.OfflineUri.parse=function(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var r=e[2];if(!r)return null;var n=e[3];return n&&null!=t?new shaka.offline.OfflineUri(t,r,n,Number(e[4])):null},shaka.offline.OfflineUri.manifest=function(e,t,r){return new shaka.offline.OfflineUri("manifest",e,t,r)},shaka.offline.OfflineUri.segment=function(e,t,r){return new shaka.offline.OfflineUri("segment",e,t,r)},shaka.offline.ManifestConverter=function(e,t){this.mechanism_=e,this.cell_=t},shaka.offline.ManifestConverter.prototype.fromManifestDB=function(e){var t=this,r=new shaka.media.PresentationTimeline(null,0);r.setDuration(e.duration);var n=e.streams.filter((function(e){return t.isAudio_(e)})),a=e.streams.filter((function(e){return t.isVideo_(e)}));n=this.createVariants(n,a,r),a=e.streams.filter((function(e){return t.isText_(e)})).map((function(e){return t.fromStreamDB_(e,r)}));var i=e.streams.filter((function(e){return t.isImage_(e)})).map((function(e){return t.fromStreamDB_(e,r)})),o=e.drmInfo?[e.drmInfo]:[];if(e.drmInfo)for(var s=$jscomp.makeIterator(n.values()),l=s.next();!l.done;l=s.next())(l=l.value).audio&&l.audio.encrypted&&(l.audio.drmInfos=o),l.video&&l.video.encrypted&&(l.video.drmInfos=o);return{presentationTimeline:r,minBufferTime:2,offlineSessionIds:e.sessionIds,variants:Array.from(n.values()),textStreams:a,imageStreams:i,sequenceMode:e.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:e.type||shaka.media.ManifestParser.UNKNOWN,serviceDescription:null}},shaka.offline.ManifestConverter.prototype.createVariants=function(e,t,r){for(var n=new Set,a=$jscomp.makeIterator(e),i=a.next();!i.done;i=a.next()){var o=$jscomp.makeIterator(i.value.variantIds);for(i=o.next();!i.done;i=o.next())n.add(i.value)}for(i=(a=$jscomp.makeIterator(t)).next();!i.done;i=a.next())for(i=(o=$jscomp.makeIterator(i.value.variantIds)).next();!i.done;i=o.next())n.add(i.value);for(a=new Map,i=(n=$jscomp.makeIterator(n)).next();!i.done;i=n.next())i=i.value,a.set(i,this.createEmptyVariant_(i));for(n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())for(n=n.value,i=this.fromStreamDB_(n,r),n=(o=$jscomp.makeIterator(n.variantIds)).next();!n.done;n=o.next())n=a.get(n.value),goog.asserts.assert(!n.audio,"A variant should only have one audio stream"),n.language=i.language,n.primary=n.primary||i.primary,n.audio=i;for(e=(t=$jscomp.makeIterator(t)).next();!e.done;e=t.next())for(n=e.value,e=this.fromStreamDB_(n,r),n=(i=$jscomp.makeIterator(n.variantIds)).next();!n.done;n=i.next())n=a.get(n.value),goog.asserts.assert(!n.video,"A variant should only have one video stream"),n.primary=n.primary||e.primary,n.video=e;return a},shaka.offline.ManifestConverter.prototype.fromStreamDB_=function(e,t){var r=this,n=e.segments.map((function(t,n){return r.fromSegmentDB_(n,t,e)}));return t.notifySegments(n),t=new shaka.media.SegmentIndex(n),{id:e.id,originalId:e.originalId,groupId:e.groupId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:t,mimeType:e.mimeType,codecs:e.codecs,width:e.width||void 0,height:e.height||void 0,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:e.hdr,videoLayout:e.videoLayout,kind:e.kind,encrypted:e.encrypted,drmInfos:[],keyIds:e.keyIds,language:e.language,originalLanguage:e.originalLanguage||null,label:e.label,type:e.type,primary:e.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:e.roles,forced:e.forced,channelsCount:e.channelsCount,audioSamplingRate:e.audioSamplingRate,spatialAudio:e.spatialAudio,closedCaptions:e.closedCaptions,tilesLayout:e.tilesLayout,accessibilityPurpose:null,external:e.external,fastSwitching:e.fastSwitching,fullMimeTypes:new Set([shaka.util.MimeUtils.getFullType(e.mimeType,e.codecs)])}},shaka.offline.ManifestConverter.prototype.fromSegmentDB_=function(e,t,r){var n=shaka.offline.OfflineUri.segment(this.mechanism_,this.cell_,t.dataKey);return e=null!=t.initSegmentKey?this.fromInitSegmentDB_(t.initSegmentKey):null,(e=new shaka.media.SegmentReference(t.startTime,t.endTime,(function(){return[n.toString()]}),0,null,e,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||"")).mimeType=t.mimeType||r.mimeType||"",e.codecs=t.codecs||r.codecs||"",e},shaka.offline.ManifestConverter.prototype.fromInitSegmentDB_=function(e){var t=shaka.offline.OfflineUri.segment(this.mechanism_,this.cell_,e);return new shaka.media.InitSegmentReference((function(){return[t.toString()]}),0,null)},shaka.offline.ManifestConverter.prototype.isAudio_=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.AUDIO},shaka.offline.ManifestConverter.prototype.isVideo_=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.VIDEO},shaka.offline.ManifestConverter.prototype.isText_=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.TEXT},shaka.offline.ManifestConverter.prototype.isImage_=function(e){return e.type==shaka.util.ManifestParserUtils.ContentType.IMAGE},shaka.offline.ManifestConverter.prototype.createEmptyVariant_=function(e){return{id:e,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}},shaka.offline.OfflineManifestParser=function(){this.uri_=null},shaka.offline.OfflineManifestParser.prototype.configure=function(e){},shaka.offline.OfflineManifestParser.prototype.start=function(e,t){var r,n,a,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:if(r=shaka.offline.OfflineUri.parse(e),u.uri_=r,null==r||!r.isManifest())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.MALFORMED_OFFLINE_URI,e);return n=new shaka.offline.StorageMuxer,c.setFinallyBlock(2),c.yield(n.init(),4);case 4:return c.yield(n.getCell(r.mechanism(),r.cell()),5);case 5:return a=c.yieldResult,c.yield(a.getManifests([r.key()]),6);case 6:return i=c.yieldResult,o=i[0],s=new shaka.offline.ManifestConverter(r.mechanism(),r.cell()),l=s.fromManifestDB(o),t.makeTextStreamsForClosedCaptions(l),c.return(l);case 2:return c.enterFinallyBlock(),c.yield(n.destroy(),7);case 7:c.leaveFinallyBlock(0)}}))},shaka.offline.OfflineManifestParser.prototype.stop=function(){return Promise.resolve()},shaka.offline.OfflineManifestParser.prototype.update=function(){},shaka.offline.OfflineManifestParser.prototype.onExpirationUpdated=function(e,t){var r,n,a,i,o,s,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){switch(d.nextAddress){case 1:return goog.asserts.assert(c.uri_,"Should not get update event before start has been called"),r=c.uri_,n=new shaka.offline.StorageMuxer,d.setCatchFinallyBlocks(2,3),d.yield(n.init(),5);case 5:return d.yield(n.getCell(r.mechanism(),r.cell()),6);case 6:return a=d.yieldResult,d.yield(a.getManifests([r.key()]),7);case 7:if(i=d.yieldResult,o=i[0],s=o.sessionIds.includes(e),l=null==o.expiration||o.expiration>t,!s||!l){d.jumpTo(3);break}return shaka.log.debug("Updating expiration for stored content"),d.yield(a.updateManifestExpiration(r.key(),t),3);case 3:return d.enterFinallyBlock(),d.yield(n.destroy(),10);case 10:d.leaveFinallyBlock(0);break;case 2:u=d.enterCatchBlock(),shaka.log.error("There was an error updating",r,u),d.jumpTo(3)}}))},shaka.offline.OfflineManifestParser.prototype.onInitialVariantChosen=function(e){},shaka.offline.OfflineManifestParser.prototype.banLocation=function(e){},shaka.media.ManifestParser.registerParserByMime("application/x-offline-manifest",(function(){return new shaka.offline.OfflineManifestParser})),shaka.offline.OfflineScheme=function(){},shaka.offline.OfflineScheme.plugin=function(e,t,r,n){return(t=shaka.offline.OfflineUri.parse(e))&&t.isManifest()?shaka.offline.OfflineScheme.getManifest_(e):t&&t.isSegment()?shaka.offline.OfflineScheme.getSegment_(t.key(),t):shaka.util.AbortableOperation.failed(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.MALFORMED_OFFLINE_URI,e))},shaka.offline.OfflineScheme.getManifest_=function(e){return e={uri:e,originalUri:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}},shaka.util.AbortableOperation.completed(e)},shaka.offline.OfflineScheme.getSegment_=function(e,t){goog.asserts.assert(t.isSegment(),"Only segment uri's should be given to getSegment");var r=new shaka.offline.StorageMuxer;return shaka.util.AbortableOperation.completed(void 0).chain((function(){return r.init()})).chain((function(){return r.getCell(t.mechanism(),t.cell())})).chain((function(e){return e.getSegments([t.key()])})).chain((function(e){return{uri:t,data:e[0].data,headers:{}}})).finally((function(){return r.destroy()}))},goog.exportSymbol("shaka.offline.OfflineScheme",shaka.offline.OfflineScheme),goog.exportProperty(shaka.offline.OfflineScheme,"plugin",shaka.offline.OfflineScheme.plugin),shaka.net.NetworkingEngine.registerScheme("offline",shaka.offline.OfflineScheme.plugin),shaka.offline.SessionDeleter=function(){},shaka.offline.SessionDeleter.prototype.delete=function(e,t,r){var n,a,i,o,s,l,u,c=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(d){switch(d.nextAddress){case 1:n=shaka.offline.SessionDeleter,a=[],i=$jscomp.makeIterator(n.createBuckets_(r)),o=i.next();case 2:if(o.done){d.jumpTo(4);break}return s=o.value,l=c.doDelete_(e,t,s),d.yield(l,5);case 5:u=d.yieldResult,a=a.concat(u),o=i.next(),d.jumpTo(2);break;case 4:return d.return(a)}}))},shaka.offline.SessionDeleter.prototype.doDelete_=function(e,t,r){var n,a,i;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){switch(o.nextAddress){case 1:return n=new shaka.media.DrmEngine({netEngine:t,onError:function(){},onKeyStatus:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),o.setCatchFinallyBlocks(2),n.configure(e),o.yield(n.initForRemoval(r.info.keySystem,r.info.licenseUri,r.info.serverCertificate,r.info.audioCapabilities,r.info.videoCapabilities),4);case 4:o.leaveTryBlock(3);break;case 2:return a=o.enterCatchBlock(),shaka.log.warning("Error initializing EME",a),o.yield(n.destroy(),5);case 5:return o.return([]);case 3:return i=[],o.yield(Promise.all(r.sessionIds.map((function(e){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(r.setCatchFinallyBlocks(2),r.yield(n.removeSession(e),4)):2!=r.nextAddress?(i.push(e),r.leaveTryBlock(0)):(t=r.enterCatchBlock(),shaka.log.warning("Error deleting offline session",t),void r.jumpToEnd())}))}))),6);case 6:return o.yield(n.destroy(),7);case 7:return o.return(i)}}))},shaka.offline.SessionDeleter.createBuckets_=function(e){for(var t=shaka.offline.SessionDeleter,r=[],n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next()){n=n.value;for(var a=!1,i=$jscomp.makeIterator(r),o=i.next();!o.done;o=i.next())if(o=o.value,t.isCompatible_(o.info,n)){o.sessionIds.push(n.sessionId),a=!0;break}a||r.push({info:n,sessionIds:[n.sessionId]})}return r},shaka.offline.SessionDeleter.isCompatible_=function(e,t){var r=shaka.util.ArrayUtils,n=function(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType};return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&r.hasSameElements(e.audioCapabilities,t.audioCapabilities,n)&&r.hasSameElements(e.videoCapabilities,t.videoCapabilities,n)},shaka.offline.StoredContentUtils=function(){},shaka.offline.StoredContentUtils.fromManifest=function(e,t,r,n){return goog.asserts.assert(t.variants.length,"Cannot create stored content from manifest with no variants."),{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.getDuration(),size:r,expiration:1/0,tracks:t=shaka.offline.StoredContentUtils.getTracks_(t),appMetadata:n,isIncomplete:!1}},shaka.offline.StoredContentUtils.fromManifestDB=function(e,t){goog.asserts.assert(t.streams.length,"Cannot create stored content from manifestDB with no streams.");var r=new shaka.offline.ManifestConverter(e.mechanism(),e.cell()).fromManifestDB(t),n=t.appMetadata||{};return r=shaka.offline.StoredContentUtils.getTracks_(r),goog.asserts.assert(null!=t.expiration,"Manifest expiration must be set by now!"),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:r,appMetadata:n,isIncomplete:t.isIncomplete||!1}},shaka.offline.StoredContentUtils.getTracks_=function(e){for(var t=shaka.util.StreamUtils,r=[],n=t.getPlayableVariants(e.variants),a=(n=$jscomp.makeIterator(n)).next();!a.done;a=n.next())r.push(t.variantToTrack(a.value));for(n=(e=$jscomp.makeIterator(e.textStreams)).next();!n.done;n=e.next())r.push(t.textStreamToTrack(n.value));return r},shaka.offline.StreamBandwidthEstimator=function(){this.estimateByStreamId_={}},shaka.offline.StreamBandwidthEstimator.prototype.addVariant=function(e){var t=e.audio,r=e.video;if(t&&!r&&this.setBitrate_(t.id,t.bandwidth||e.bandwidth),!t&&r&&this.setBitrate_(r.id,r.bandwidth||e.bandwidth),t&&r){var n=t.bandwidth||shaka.offline.StreamBandwidthEstimator.DEFAULT_AUDIO_BITRATE_,a=r.bandwidth||e.bandwidth-n;0>=a&&(shaka.log.warning("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),a=e.bandwidth),this.setBitrate_(t.id,n),this.setBitrate_(r.id,a)}},shaka.offline.StreamBandwidthEstimator.prototype.setBitrate_=function(e,t){this.estimateByStreamId_[e]=t},shaka.offline.StreamBandwidthEstimator.prototype.addText=function(e){this.estimateByStreamId_[e.id]=shaka.offline.StreamBandwidthEstimator.DEFAULT_TEXT_BITRATE_},shaka.offline.StreamBandwidthEstimator.prototype.addImage=function(e){this.estimateByStreamId_[e.id]=e.bandwidth||shaka.offline.StreamBandwidthEstimator.DEFAULT_IMAGE_BITRATE_},shaka.offline.StreamBandwidthEstimator.prototype.getSegmentEstimate=function(e,t){return t=t.endTime-t.startTime,this.getEstimate_(e)*t},shaka.offline.StreamBandwidthEstimator.prototype.getInitSegmentEstimate=function(e){return.5*this.getEstimate_(e)},shaka.offline.StreamBandwidthEstimator.prototype.getEstimate_=function(e){return null==(e=this.estimateByStreamId_[e])&&(e=0,shaka.log.error("Asking for bitrate of stream not given to the estimator")),0==e&&shaka.log.warning("Using bitrate of 0, this stream won't affect progress"),e},shaka.offline.StreamBandwidthEstimator.DEFAULT_AUDIO_BITRATE_=393216,shaka.offline.StreamBandwidthEstimator.DEFAULT_TEXT_BITRATE_=52,shaka.offline.StreamBandwidthEstimator.DEFAULT_IMAGE_BITRATE_=2048,shaka.offline.Storage=function(e){var t=this;if(e&&e.constructor!=shaka.Player)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.LOCAL_PLAYER_INSTANCE_REQUIRED);this.networkingEngine_=this.config_=null,e?(this.config_=e.getSharedConfiguration(),this.networkingEngine_=e.getNetworkingEngine(),goog.asserts.assert(this.networkingEngine_,"Storage should not be initialized with a player that had |destroy| called on it.")):(this.config_=shaka.util.PlayerConfiguration.createDefault(),this.networkingEngine_=new shaka.net.NetworkingEngine),this.openOperations_=[],this.openDownloadManagers_=[];var r=!e;this.destroyer_=new shaka.util.Destroyer((function(){var e,n,a,i,o;return $jscomp.asyncExecutePromiseGeneratorProgram((function(s){switch(s.nextAddress){case 1:return s.yield(Promise.all(t.openDownloadManagers_.map((function(e){return e.abortAll()}))),2);case 2:for(e=function(){},n=[],a=$jscomp.makeIterator(t.openOperations_),i=a.next();!i.done;i=a.next())o=i.value,n.push(o.then(e,e));return s.yield(Promise.all(n),3);case 3:if(!r){s.jumpTo(4);break}return s.yield(t.networkingEngine_.destroy(),4);case 4:t.config_=null,t.networkingEngine_=null,s.jumpToEnd()}}))}))},shaka.offline.Storage.support=function(){return!!shaka.util.Platform.supportsMediaSource()&&shaka.offline.StorageMuxer.support()},shaka.offline.Storage.prototype.destroy=function(){return this.destroyer_.destroy()},shaka.offline.Storage.prototype.configure=function(e,t){return goog.asserts.assert("object"==typeof e||2==arguments.length,"String configs should have values!"),2==arguments.length&&"string"==typeof e&&(e=shaka.util.ConfigUtils.convertToConfigObject(e,t)),goog.asserts.assert("object"==typeof e,"Should be an object!"),goog.asserts.assert(this.config_,"Cannot reconfigure storage after calling destroy."),shaka.util.PlayerConfiguration.mergeConfigObjects(this.config_,e)},shaka.offline.Storage.prototype.getConfiguration=function(){goog.asserts.assert(this.config_,"Config must not be null!");var e=shaka.util.PlayerConfiguration.createDefault();return shaka.util.PlayerConfiguration.mergeConfigObjects(e,this.config_,shaka.util.PlayerConfiguration.createDefault()),e},shaka.offline.Storage.prototype.getNetworkingEngine=function(){return this.networkingEngine_},shaka.offline.Storage.prototype.store=function(e,t,r){var n=this;goog.asserts.assert(this.networkingEngine_,"Cannot call |store| after calling |destroy|.");var a=this.getConfiguration(),i=new shaka.offline.DownloadManager(this.networkingEngine_);return this.openDownloadManagers_.push(i),t=this.store_(e,t||{},(function(){var t;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(goog.asserts.assert(n.networkingEngine_,"Should not call |store| after |destroy|"),r?i.jumpTo(2):i.yield(shaka.net.NetworkingUtils.getMimeType(e,n.networkingEngine_,a.manifest.retryParameters),3)):(2!=i.nextAddress&&(r=i.yieldResult),t=shaka.media.ManifestParser.getFactory(e,r||null),i.return(t()))}))}),a,i),(t=new shaka.util.AbortableOperation(t,(function(){return i.abortAll()}))).finally((function(){shaka.util.ArrayUtils.remove(n.openDownloadManagers_,i)})),this.startAbortableOperation_(t)},shaka.offline.Storage.prototype.store_=function(e,t,r,n,a){var i,o,s,l,u,c,d,p,h,f,m,g,y,v=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){switch(_.nextAddress){case 1:return v.requireSupport_(),o=i=null,s=new shaka.offline.StorageMuxer,c=u=l=null,_.setCatchFinallyBlocks(2,3),_.yield(r(),5);case 5:return i=_.yieldResult,_.yield(v.parseManifest(e,i,n),6);case 6:if(d=_.yieldResult,v.ensureNotDestroyed_(),!(!d.presentationTimeline.isLive()&&!d.presentationTimeline.isInProgress()))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.CANNOT_STORE_LIVE_OFFLINE,e);return _.yield(v.createDrmEngine(d,(function(e){c=c||e}),n),7);case 7:if(o=_.yieldResult,v.ensureNotDestroyed_(),c)throw c;return _.yield(v.filterManifest_(d,o,n),8);case 8:return _.yield(s.init(),9);case 9:return v.ensureNotDestroyed_(),_.yield(s.getActive(),10);case 10:return l=_.yieldResult,v.ensureNotDestroyed_(),goog.asserts.assert(o,"drmEngine should be non-null here."),p=v.makeManifestDB_(o,d,e,t,n,a),h=p.manifestDB,f=p.toDownload,_.yield(l.cell.addManifests([h]),11);case 11:if(m=_.yieldResult,v.ensureNotDestroyed_(),u=m[0],goog.asserts.assert(o,"drmEngine should be non-null here."),v.ensureNotDestroyed_(),c)throw c;return _.yield(v.downloadSegments_(f,u,h,a,n,l.cell,d,o),12);case 12:return v.ensureNotDestroyed_(),v.setManifestDrmFields_(d,h,o,n),_.yield(l.cell.updateManifest(u,h),13);case 13:return v.ensureNotDestroyed_(),g=shaka.offline.OfflineUri.manifest(l.path.mechanism,l.path.cell,u),_.return(shaka.offline.StoredContentUtils.fromManifestDB(g,h));case 3:return _.enterFinallyBlock(),_.yield(s.destroy(),14);case 14:if(!i){_.jumpTo(15);break}return _.yield(i.stop(),15);case 15:if(!o){_.jumpTo(17);break}return _.yield(o.destroy(),17);case 17:_.leaveFinallyBlock(0);break;case 2:if(y=_.enterCatchBlock(),null==u){_.jumpTo(19);break}return _.yield(shaka.offline.Storage.cleanStoredManifest(u),19);case 19:throw c||y}}))},shaka.offline.Storage.prototype.downloadSegments_=function(e,t,r,n,a,i,o,s){var l,u,c,d,p,h,f,m,g,y,v=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){switch(_.nextAddress){case 1:if(l={},u=0,c=function(e,c){var d,p,h,f,m,g,y;return $jscomp.asyncExecutePromiseGeneratorProgram((function(_){if(1==_.nextAddress){for(d={},p=$jscomp.makeIterator(e),h=p.next();!h.done;d={$jscomp$loop$prop$download$793$925:d.$jscomp$loop$prop$download$793$925},h=p.next())d.$jscomp$loop$prop$download$793$925=h.value,f=d.$jscomp$loop$prop$download$793$925.makeSegmentRequest(a),m=d.$jscomp$loop$prop$download$793$925.estimateId,g=d.$jscomp$loop$prop$download$793$925.isInitSegment,y=function(e){return function(t){var r,n,a;return $jscomp.asyncExecutePromiseGeneratorProgram((function(o){if(1==o.nextAddress)return o.yield(i.addSegments([{data:t}]),2);r=o.yieldResult,v.ensureNotDestroyed_(),n=e.$jscomp$loop$prop$download$793$925.ref,a=shaka.offline.DownloadInfo.idForSegmentRef(n),l[a]=r[0],u+=t.byteLength,o.jumpToEnd()}))}}(d),n.queue(d.$jscomp$loop$prop$download$793$925.groupId,f,m,g,y);return _.yield(n.waitToFinish(),2)}return c?(v.ensureNotDestroyed_(),v.setManifestDrmFields_(o,r,s,a),_.yield(i.updateManifest(t,r),0)):_.jumpTo(0)}))},d=!1,_.setCatchFinallyBlocks(2),!v.getManifestIsEncrypted_(o)||!d||v.getManifestIncludesInitData_(o)){_.jumpTo(4);break}return _.yield(c(e.filter((function(e){return e.isInitSegment})),!0),5);case 5:return v.ensureNotDestroyed_(),e=e.filter((function(e){return!e.isInitSegment})),p=l,h=u,l={},u=0,_.yield(shaka.offline.Storage.assignSegmentsToManifest(i,t,r,p,h,(function(){return v.ensureNotDestroyed_()})),6);case 6:v.ensureNotDestroyed_();case 4:if(d){_.jumpTo(7);break}return _.yield(c(e,!1),8);case 8:return v.ensureNotDestroyed_(),f=l,m=u,l={},u=0,_.yield(shaka.offline.Storage.assignSegmentsToManifest(i,t,r,f,m,(function(){return v.ensureNotDestroyed_()})),9);case 9:v.ensureNotDestroyed_(),goog.asserts.assert(!r.isIncomplete,"The manifest should be complete by now");case 7:_.leaveTryBlock(0);break;case 2:return g=_.enterCatchBlock(),y=Object.values(l),_.yield(i.removeSegments(y,(function(e){})),10);case 10:throw g}}))},shaka.offline.Storage.cleanStoredManifest=function(e){var t,r,n,a;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){switch(i.nextAddress){case 1:return t=new shaka.offline.StorageMuxer,i.yield(t.init(),2);case 2:return i.yield(t.getActive(),3);case 3:return r=i.yieldResult,n=shaka.offline.OfflineUri.manifest(r.path.mechanism,r.path.cell,e),i.yield(t.destroy(),4);case 4:return a=new shaka.offline.Storage,i.yield(a.remove(n.toString()),0)}}))},shaka.offline.Storage.assignSegmentsToManifest=function(e,t,r,n,a,i){var o,s,l,u,c,d,p,h,f,m,g;return $jscomp.asyncExecutePromiseGeneratorProgram((function(y){switch(y.nextAddress){case 1:for(o=!1,y.setCatchFinallyBlocks(2),s=!0,l=$jscomp.makeIterator(r.streams),u=l.next();!u.done;u=l.next())for(c=u.value,d=$jscomp.makeIterator(c.segments),p=d.next();!p.done;p=d.next())h=p.value,null!=(f=h.pendingSegmentRefId?n[h.pendingSegmentRefId]:null)&&(h.dataKey=f,h.pendingSegmentRefId=void 0),null!=(f=h.pendingInitSegmentRefId?n[h.pendingInitSegmentRefId]:null)&&(h.initSegmentKey=f,h.pendingInitSegmentRefId=void 0),h.pendingSegmentRefId&&(s=!1),h.pendingInitSegmentRefId&&(s=!1);return r.size+=a,s&&(r.isIncomplete=!1),y.yield(e.updateManifest(t,r),4);case 4:o=!0,i(),y.leaveTryBlock(0);break;case 2:return m=y.enterCatchBlock(),y.yield(shaka.offline.Storage.cleanStoredManifest(t),5);case 5:if(o){y.jumpTo(6);break}return g=Object.values(n),y.yield(e.removeSegments(g,(function(e){})),6);case 6:throw m}}))},shaka.offline.Storage.prototype.filterManifest_=function(e,t,r){var n,a,i,o,s,l,u,c,d,p,h,f,m,g,y,v,_,k,E,b,T,A,S,C,P,x,w;return $jscomp.asyncExecutePromiseGeneratorProgram((function(I){switch(I.nextAddress){case 1:return n={width:1/0,height:1/0},shaka.util.StreamUtils.filterByRestrictions(e,r.restrictions,n),I.yield(shaka.util.StreamUtils.filterManifestByMediaCapabilities(t,e,r.offline.usePersistentLicense,r.drm.preferredKeySystems),2);case 2:for(a=[],i=r.preferredDecodingAttributes,o=r.preferredVideoCodecs,s=r.preferredAudioCodecs,shaka.util.StreamUtils.chooseCodecsAndFilterManifest(e,o,s,i),l=$jscomp.makeIterator(e.variants),u=l.next();!u.done;u=l.next())c=u.value,goog.asserts.assert(shaka.util.StreamUtils.isPlayable(c),'We should have already filtered by "is playable"'),a.push(shaka.util.StreamUtils.variantToTrack(c));for(d=$jscomp.makeIterator(e.textStreams),p=d.next();!p.done;p=d.next())h=p.value,a.push(shaka.util.StreamUtils.textStreamToTrack(h));for(f=$jscomp.makeIterator(e.imageStreams),m=f.next();!m.done;m=f.next())g=m.value,a.push(shaka.util.StreamUtils.imageStreamToTrack(g));return I.yield(r.offline.trackSelectionCallback(a),3);case 3:for(y=I.yieldResult,v=e.presentationTimeline.getDuration(),_=0,k=$jscomp.makeIterator(y),E=k.next();!E.done;E=k.next())b=E.value,T=b.bandwidth*v/8,_+=T;return I.setCatchFinallyBlocks(4),I.yield(r.offline.downloadSizeCallback(_),6);case 6:if(!I.yieldResult)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.STORAGE_LIMIT_REACHED);I.leaveTryBlock(5);break;case 4:if((A=I.enterCatchBlock())instanceof shaka.util.Error)throw A;throw shaka.log.warning("downloadSizeCallback has produced an unexpected error",A),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.DOWNLOAD_SIZE_CALLBACK_ERROR);case 5:for(S=new Set,C=new Set,P=new Set,x=$jscomp.makeIterator(y),E=x.next();!E.done;E=x.next())"variant"==(w=E.value).type&&S.add(w.id),"text"==w.type&&C.add(w.id),"image"==w.type&&P.add(w.id);e.variants=e.variants.filter((function(e){return S.has(e.id)})),e.textStreams=e.textStreams.filter((function(e){return C.has(e.id)})),e.imageStreams=e.imageStreams.filter((function(e){return P.has(e.id)})),shaka.offline.Storage.validateManifest_(e),I.jumpToEnd()}}))},shaka.offline.Storage.prototype.makeManifestDB_=function(e,t,r,n,a,i){var o=shaka.offline.StoredContentUtils.fromManifest(r,t,0,n),s=a.offline.progressCallback;i.setCallbacks((function(e,t){o.size=t,s(o,e)}),(function(t,r){l&&a.offline.usePersistentLicense&&u==r&&e.newInitData("cenc",t)}));var l=this.getManifestIsEncrypted_(t)&&!this.getManifestIncludesInitData_(t),u=null;if(l){var c=e.getDrmInfo();u=shaka.offline.Storage.defaultSystemIds_.get(c.keySystem)}c=new shaka.offline.StreamBandwidthEstimator;for(var d=$jscomp.makeIterator(t.textStreams),p=d.next();!p.done;p=d.next())c.addText(p.value);for(p=(d=$jscomp.makeIterator(t.imageStreams)).next();!p.done;p=d.next())c.addImage(p.value);for(d=(p=$jscomp.makeIterator(t.variants)).next();!d.done;d=p.next())c.addVariant(d.value);return i=(c=this.createStreams_(i,c,e,t,a)).streams,c=c.toDownload,p=e.getDrmInfo(),d=a.offline.usePersistentLicense,p&&d&&(p.initData=[]),{manifestDB:{creationTime:Date.now(),originalManifestUri:r,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.getExpiration(),streams:i,sessionIds:d?e.getSessionIds():[],drmInfo:p,appMetadata:n,isIncomplete:!0,sequenceMode:t.sequenceMode,type:t.type},toDownload:c}},shaka.offline.Storage.prototype.getManifestIsEncrypted_=function(e){return e.variants.some((function(e){var t=e.audio&&e.audio.encrypted;return e.video&&e.video.encrypted||t}))},shaka.offline.Storage.prototype.getManifestIncludesInitData_=function(e){return e.variants.some((function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]).some((function(e){return e.initData&&e.initData.length}))}))},shaka.offline.Storage.prototype.setManifestDrmFields_=function(e,t,r,n){if(t.expiration=r.getExpiration(),r=r.getSessionIds(),t.sessionIds=n.offline.usePersistentLicense?r:[],this.getManifestIsEncrypted_(e)&&n.offline.usePersistentLicense&&!r.length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.NO_INIT_DATA_FOR_OFFLINE)},shaka.offline.Storage.prototype.remove=function(e){return this.startOperation_(this.remove_(e))},shaka.offline.Storage.prototype.remove_=function(e){var t,r,n,a,i,o,s=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:if(s.requireSupport_(),null==(t=shaka.offline.OfflineUri.parse(e))||!t.isManifest())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.MALFORMED_OFFLINE_URI,e);return r=t,n=new shaka.offline.StorageMuxer,l.setFinallyBlock(2),l.yield(n.init(),4);case 4:return l.yield(n.getCell(r.mechanism(),r.cell()),5);case 5:return a=l.yieldResult,l.yield(a.getManifests([r.key()]),6);case 6:return i=l.yieldResult,o=i[0],l.yield(Promise.all([s.removeFromDRM_(r,o,n),s.removeFromStorage_(a,r,o)]),2);case 2:return l.enterFinallyBlock(),l.yield(n.destroy(),8);case 8:l.leaveFinallyBlock(0)}}))},shaka.offline.Storage.getCapabilities_=function(e,t){for(var r=shaka.util.MimeUtils,n=[],a=$jscomp.makeIterator(e.streams),i=a.next();!i.done;i=a.next())i=i.value,t&&"video"==i.type?n.push({contentType:r.getFullType(i.mimeType,i.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=i.type||n.push({contentType:r.getFullType(i.mimeType,i.codecs),robustness:e.drmInfo.audioRobustness});return n},shaka.offline.Storage.prototype.removeFromDRM_=function(e,t,r){var n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(e){return goog.asserts.assert(n.networkingEngine_,"Cannot be destroyed"),e.yield(shaka.offline.Storage.deleteLicenseFor_(n.networkingEngine_,n.config_.drm,r,t),0)}))},shaka.offline.Storage.prototype.removeFromStorage_=function(e,t,r){var n=this,a=shaka.offline.Storage.getAllSegmentIds_(r),i=a.length+1,o=0,s=shaka.offline.StoredContentUtils.fromManifestDB(t,r);return r=function(e){o+=1,n.config_.offline.progressCallback(s,o/i)},Promise.all([e.removeSegments(a,r),e.removeManifests([t.key()],r)])},shaka.offline.Storage.prototype.removeEmeSessions=function(){return this.startOperation_(this.removeEmeSessions_())},shaka.offline.Storage.prototype.removeEmeSessions_=function(){var e,t,r,n,a,i,o,s,l,u,c,d=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(p){switch(p.nextAddress){case 1:return d.requireSupport_(),goog.asserts.assert(d.networkingEngine_,"Cannot be destroyed"),e=d.networkingEngine_,t=d.config_.drm,r=new shaka.offline.StorageMuxer,n=new shaka.offline.SessionDeleter,a=!1,p.setFinallyBlock(2),p.yield(r.init(),4);case 4:i=[],r.forEachEmeSessionCell((function(e){return i.push(e)})),o=$jscomp.makeIterator(i),s=o.next();case 5:if(s.done){p.jumpTo(2);break}return l=s.value,p.yield(l.getAll(),8);case 8:return u=p.yieldResult,p.yield(n.delete(t,e,u),9);case 9:return c=p.yieldResult,p.yield(l.remove(c),10);case 10:c.length!=u.length&&(a=!0),s=o.next(),p.jumpTo(5);break;case 2:return p.enterFinallyBlock(),p.yield(r.destroy(),11);case 11:p.leaveFinallyBlock(3);break;case 3:return p.return(!a)}}))},shaka.offline.Storage.prototype.list=function(){return this.startOperation_(this.list_())},shaka.offline.Storage.prototype.list_=function(){var e,t,r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){switch(a.nextAddress){case 1:return n.requireSupport_(),e=[],t=new shaka.offline.StorageMuxer,a.setFinallyBlock(2),a.yield(t.init(),4);case 4:return r=Promise.resolve(),t.forEachCell((function(t,n){r=r.then((function(){return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){if(1==r.nextAddress)return r.yield(n.getAllManifests(),2);r.yieldResult.forEach((function(r,n){n=shaka.offline.OfflineUri.manifest(t.mechanism,t.cell,n),r=shaka.offline.StoredContentUtils.fromManifestDB(n,r),e.push(r)})),r.jumpToEnd()}))}))})),a.yield(r,2);case 2:return a.enterFinallyBlock(),a.yield(t.destroy(),6);case 6:a.leaveFinallyBlock(3);break;case 3:return a.return(e)}}))},shaka.offline.Storage.prototype.parseManifest=function(e,t,r){var n,a,i,o,s,l=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(u){if(1==u.nextAddress)return n=null,a=l.networkingEngine_,goog.asserts.assert(a,"Should be initialized!"),i={networkingEngine:a,filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(e){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){n=e},isLowLatencyMode:function(){return!1},isAutoLowLatencyMode:function(){return!1},enableLowLatencyMode:function(){},updateDuration:function(){},newDrmInfo:function(e){},onManifestUpdated:function(){},getBandwidthEstimate:function(){return r.abr.defaultBandwidthEstimate}},t.configure(r.manifest),l.ensureNotDestroyed_(),u.yield(t.start(e,i),2);if(3!=u.nextAddress)return o=u.yieldResult,l.ensureNotDestroyed_(),s=shaka.offline.Storage.getAllStreamsFromManifest_(o),u.yield(Promise.all(shaka.util.Iterables.map(s,(function(e){return e.createSegmentIndex()}))),3);if(l.ensureNotDestroyed_(),n)throw n;return u.return(o)}))},shaka.offline.Storage.prototype.createDrmEngine=function(e,t,r){var n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){return 1==i.nextAddress?(goog.asserts.assert(a.networkingEngine_,"Cannot call |createDrmEngine| after |destroy|"),(n=new shaka.media.DrmEngine({netEngine:a.networkingEngine_,onError:t,onKeyStatus:function(){},onExpirationUpdated:function(){},onEvent:function(){}})).configure(r.drm),i.yield(n.initForStorage(e.variants,r.offline.usePersistentLicense),2)):3!=i.nextAddress?i.yield(n.createOrLoad(),3):i.return(n)}))},shaka.offline.Storage.prototype.createStreams_=function(e,t,r,n,a){r=new Map;for(var i=shaka.offline.Storage.getAllStreamsFromManifest_(n),o=new Map,s=(i=$jscomp.makeIterator(i)).next();!s.done;s=i.next()){s=s.value;var l=this.createStream_(e,t,n,s,a,r);o.set(s.id,l)}for(t=(e=$jscomp.makeIterator(n.variants)).next();!t.done;t=e.next())(t=t.value).audio&&o.get(t.audio.id).variantIds.push(t.id),t.video&&o.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(o.values()),toDownload:Array.from(r.values())}},shaka.offline.Storage.prototype.createStream_=function(e,t,r,n,a,i){var o={id:n.id,originalId:n.originalId,groupId:n.groupId,primary:n.primary,type:n.type,mimeType:n.mimeType,codecs:n.codecs,frameRate:n.frameRate,pixelAspectRatio:n.pixelAspectRatio,hdr:n.hdr,videoLayout:n.videoLayout,kind:n.kind,language:n.language,originalLanguage:n.originalLanguage,label:n.label,width:n.width||null,height:n.height||null,encrypted:n.encrypted,keyIds:n.keyIds,segments:[],variantIds:[],roles:n.roles,forced:n.forced,channelsCount:n.channelsCount,audioSamplingRate:n.audioSamplingRate,spatialAudio:n.spatialAudio,closedCaptions:n.closedCaptions,tilesLayout:n.tilesLayout,external:n.external,fastSwitching:n.fastSwitching};r=r.presentationTimeline.getSegmentAvailabilityStart();var s=a.offline.numberOfParallelDownloads,l=0;return shaka.offline.Storage.forEachSegment_(n,r,(function(r){var a=shaka.offline.DownloadInfo.idForSegmentRef(r),u=void 0;if(!i.has(a)){var c=e.addDownloadEstimate(t.getSegmentEstimate(n.id,r));c=new shaka.offline.DownloadInfo(r,c,l,!1),i.set(a,c)}r.initSegmentReference&&(u=shaka.offline.DownloadInfo.idForSegmentRef(r.initSegmentReference),i.has(u)||(c=e.addDownloadEstimate(t.getInitSegmentEstimate(n.id)),c=new shaka.offline.DownloadInfo(r.initSegmentReference,c,l,!0),i.set(u,c))),o.segments.push({pendingInitSegmentRefId:u,initSegmentKey:u?0:null,startTime:r.startTime,endTime:r.endTime,appendWindowStart:r.appendWindowStart,appendWindowEnd:r.appendWindowEnd,timestampOffset:r.timestampOffset,tilesLayout:r.tilesLayout,pendingSegmentRefId:a,dataKey:0,mimeType:r.mimeType,codecs:r.codecs}),l=(l+1)%s})),o},shaka.offline.Storage.forEachSegment_=function(e,t,r){if(null!=(t=e.segmentIndex.find(t)))for(var n=e.segmentIndex.get(t);n;)r(n),n=e.segmentIndex.get(++t)},shaka.offline.Storage.prototype.ensureNotDestroyed_=function(){if(this.destroyer_.destroyed())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.OPERATION_ABORTED)},shaka.offline.Storage.prototype.requireSupport_=function(){if(!shaka.offline.Storage.support())throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.STORAGE,shaka.util.Error.Code.STORAGE_NOT_SUPPORTED)},shaka.offline.Storage.prototype.startOperation_=function(e){var t=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(r){return 1==r.nextAddress?(t.openOperations_.push(e),r.setFinallyBlock(2),r.yield(e,4)):2!=r.nextAddress?r.return(r.yieldResult):(r.enterFinallyBlock(),shaka.util.ArrayUtils.remove(t.openOperations_,e),r.leaveFinallyBlock(0))}))},shaka.offline.Storage.prototype.startAbortableOperation_=function(e){var t=this,r=e.promise;return this.openOperations_.push(r),e.finally((function(){shaka.util.ArrayUtils.remove(t.openOperations_,r)}))},shaka.offline.Storage.getAllSegmentIds_=function(e){for(var t=new Set,r=(e=$jscomp.makeIterator(e.streams)).next();!r.done;r=e.next())for(var n=(r=$jscomp.makeIterator(r.value.segments)).next();!n.done;n=r.next())null!=(n=n.value).initSegmentKey&&t.add(n.initSegmentKey),t.add(n.dataKey);return Array.from(t)},shaka.offline.Storage.deleteAll=function(){var e;return $jscomp.asyncExecutePromiseGeneratorProgram((function(t){return 1==t.nextAddress?(e=new shaka.offline.StorageMuxer,t.setFinallyBlock(2),t.yield(e.erase(),2)):5!=t.nextAddress?(t.enterFinallyBlock(),t.yield(e.destroy(),5)):t.leaveFinallyBlock(0)}))},shaka.offline.Storage.deleteLicenseFor_=function(e,t,r,n){var a,i,o,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){return 1==l.nextAddress?n.drmInfo?(a=r.getEmeSessionCell(),i=n.sessionIds.map((function(e){return{sessionId:e,keySystem:n.drmInfo.keySystem,licenseUri:n.drmInfo.licenseServerUri,serverCertificate:n.drmInfo.serverCertificate,audioCapabilities:shaka.offline.Storage.getCapabilities_(n,!1),videoCapabilities:shaka.offline.Storage.getCapabilities_(n,!0)}})),o=new shaka.offline.SessionDeleter,l.yield(o.delete(t,e,i),2)):l.return():3!=l.nextAddress?(s=l.yieldResult,l.yield(a.remove(s),3)):l.yield(a.add(i.filter((function(e){return!s.includes(e.sessionId)}))),0)}))},shaka.offline.Storage.getAllStreamsFromManifest_=function(e){for(var t=new Set,r=$jscomp.makeIterator(e.textStreams),n=r.next();!n.done;n=r.next())t.add(n.value);for(n=(r=$jscomp.makeIterator(e.imageStreams)).next();!n.done;n=r.next())t.add(n.value);for(r=(e=$jscomp.makeIterator(e.variants)).next();!r.done;r=e.next())(r=r.value).audio&&t.add(r.audio),r.video&&t.add(r.video);return t},shaka.offline.Storage.validateManifest_=function(e){var t=new Set(e.variants.map((function(e){return e.video}))),r=new Set(e.variants.map((function(e){return e.audio})));e=e.textStreams,1<t.size&&shaka.log.warning("Multiple video tracks selected to be stored");for(var n=(t=$jscomp.makeIterator(r)).next();!n.done;n=t.next()){n=n.value;for(var a=$jscomp.makeIterator(r),i=a.next();!i.done;i=a.next())n!=(i=i.value)&&n.language==i.language&&shaka.log.warning("Similar audio tracks were selected to be stored",n.id,i.id)}for(t=(r=$jscomp.makeIterator(e)).next();!t.done;t=r.next())for(t=t.value,a=(n=$jscomp.makeIterator(e)).next();!a.done;a=n.next())t!=(a=a.value)&&t.language==a.language&&shaka.log.warning("Similar text tracks were selected to be stored",t.id,a.id)},goog.exportSymbol("shaka.offline.Storage",shaka.offline.Storage),goog.exportProperty(shaka.offline.Storage,"deleteAll",shaka.offline.Storage.deleteAll),goog.exportProperty(shaka.offline.Storage.prototype,"list",shaka.offline.Storage.prototype.list),goog.exportProperty(shaka.offline.Storage.prototype,"removeEmeSessions",shaka.offline.Storage.prototype.removeEmeSessions),goog.exportProperty(shaka.offline.Storage.prototype,"remove",shaka.offline.Storage.prototype.remove),goog.exportProperty(shaka.offline.Storage.prototype,"store",shaka.offline.Storage.prototype.store),goog.exportProperty(shaka.offline.Storage.prototype,"getNetworkingEngine",shaka.offline.Storage.prototype.getNetworkingEngine),goog.exportProperty(shaka.offline.Storage.prototype,"getConfiguration",shaka.offline.Storage.prototype.getConfiguration),goog.exportProperty(shaka.offline.Storage.prototype,"configure",shaka.offline.Storage.prototype.configure),goog.exportProperty(shaka.offline.Storage.prototype,"destroy",shaka.offline.Storage.prototype.destroy),goog.exportProperty(shaka.offline.Storage,"support",shaka.offline.Storage.support),shaka.offline.Storage.defaultSystemIds_=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95"),shaka.Player.registerSupportPlugin("offline",shaka.offline.Storage.support),shaka.polyfill=function(){},shaka.polyfill.installAll=function(){for(var e=$jscomp.makeIterator(shaka.polyfill.polyfills_),t=e.next();!t.done;t=e.next()){t=t.value;try{t.callback()}catch(e){shaka.log.alwaysWarn("Error installing polyfill!",e)}}},shaka.polyfill.register=function(e,t){for(e={priority:t||0,callback:e},t=0;t<shaka.polyfill.polyfills_.length;t++)if(shaka.polyfill.polyfills_[t].priority<e.priority)return void shaka.polyfill.polyfills_.splice(t,0,e);shaka.polyfill.polyfills_.push(e)},goog.exportSymbol("shaka.polyfill",shaka.polyfill),goog.exportProperty(shaka.polyfill,"register",shaka.polyfill.register),goog.exportProperty(shaka.polyfill,"installAll",shaka.polyfill.installAll),shaka.polyfill.polyfills_=[],shaka.polyfill.AbortController=function(){this.signal_=new shaka.polyfill.AbortController.AbortSignal},shaka.polyfill.AbortController.install=function(){window.AbortController||(window.AbortController=shaka.polyfill.AbortController,window.AbortSignal=shaka.polyfill.AbortController.AbortSignal)},shaka.polyfill.AbortController.prototype.abort=function(e){this.signal_.doAbort_(e)},$jscomp.global.Object.defineProperties(shaka.polyfill.AbortController.prototype,{signal:{configurable:!0,enumerable:!0,get:function(){return this.signal_}}}),goog.exportProperty(shaka.polyfill,"AbortController",shaka.polyfill.AbortController),goog.exportProperty(shaka.polyfill.AbortController,"install",shaka.polyfill.AbortController.install),shaka.polyfill.AbortController.AbortSignal=function(){shaka.util.FakeEventTarget.call(this),this.aborted_=!1,this.reason_=void 0,this.onabort=null},$jscomp.inherits(shaka.polyfill.AbortController.AbortSignal,shaka.util.FakeEventTarget),shaka.polyfill.AbortController.AbortSignal.prototype.throwIfAborted=function(){if(this.aborted_)throw this.reason_},shaka.polyfill.AbortController.AbortSignal.prototype.doAbort_=function(e){this.aborted_||(this.aborted_=!0,this.reason_=e,void 0===this.reason_&&(this.reason_=new DOMException("signal is aborted without reason","AbortError")),e=new shaka.util.FakeEvent("abort"),this.onabort&&this.onabort(e),this.dispatchEvent(e))},shaka.polyfill.AbortController.AbortSignal.abort=function(e){var t=new shaka.polyfill.AbortController.AbortSignal;return t.doAbort_(e),t},shaka.polyfill.AbortController.AbortSignal.timeout=function(e){var t=new shaka.polyfill.AbortController.AbortSignal;return window.setTimeout((function(){t.doAbort_(new DOMException("signal timed out","TimeoutError"))}),e),t},$jscomp.global.Object.defineProperties(shaka.polyfill.AbortController.AbortSignal.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return this.aborted_}},reason:{configurable:!0,enumerable:!0,get:function(){return this.reason_}}}),shaka.polyfill.register(shaka.polyfill.AbortController.install),shaka.polyfill.Aria=function(){},shaka.polyfill.Aria.install=function(){if(Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))shaka.log.info("Using native ARIAMixin interface.");else{shaka.log.info("ARIAMixin interface not detected. Installing polyfill.");for(var e=$jscomp.makeIterator(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),t=e.next();!t.done;t=e.next())shaka.polyfill.Aria.addARIAMixinAttribute_(t.value)}},shaka.polyfill.Aria.addARIAMixinAttribute_=function(e){var t="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(t)},set:function(e){null==e||null==e?this.removeAttribute(t):this.setAttribute(t,e)}})},goog.exportProperty(shaka.polyfill,"Aria",shaka.polyfill.Aria),goog.exportProperty(shaka.polyfill.Aria,"install",shaka.polyfill.Aria.install),shaka.polyfill.register(shaka.polyfill.Aria.install),shaka.polyfill.EncryptionScheme=function(){},shaka.polyfill.EncryptionScheme.install=function(){EncryptionSchemePolyfills.install()},goog.exportProperty(shaka.polyfill,"EncryptionScheme",shaka.polyfill.EncryptionScheme),goog.exportProperty(shaka.polyfill.EncryptionScheme,"install",shaka.polyfill.EncryptionScheme.install),shaka.polyfill.register(shaka.polyfill.EncryptionScheme.install,-2),shaka.polyfill.Fullscreen=function(){},shaka.polyfill.Fullscreen.install=function(){if(window.Document){var e=Element.prototype;e.requestFullscreen=e.requestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitRequestFullscreen,(e=Document.prototype).exitFullscreen=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),e=shaka.polyfill.Fullscreen.proxyEvent_,document.addEventListener("webkitfullscreenchange",e),document.addEventListener("webkitfullscreenerror",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("mozfullscreenerror",e),document.addEventListener("MSFullscreenChange",e),document.addEventListener("MSFullscreenError",e)}},shaka.polyfill.Fullscreen.proxyEvent_=function(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),r=document.createEvent("Event");r.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(r)},goog.exportProperty(shaka.polyfill,"Fullscreen",shaka.polyfill.Fullscreen),goog.exportProperty(shaka.polyfill.Fullscreen,"install",shaka.polyfill.Fullscreen.install),shaka.polyfill.register(shaka.polyfill.Fullscreen.install),shaka.polyfill.MediaCapabilities=function(){},shaka.polyfill.MediaCapabilities.install=function(){var e=!0;!shaka.util.Platform.isChromecast()||shaka.util.Platform.isAndroidCastDevice()||shaka.util.Platform.isFuchsiaCastDevice()||(e=!1),(shaka.util.Platform.isApple()||shaka.util.Platform.isPS5()||shaka.util.Platform.isPS4()||shaka.util.Platform.isWebOS()||shaka.util.Platform.isTizen()||shaka.util.Platform.isEOS()||shaka.util.Platform.isHisense())&&(e=!1),e&&navigator.mediaCapabilities?shaka.log.info("MediaCapabilities: Native mediaCapabilities support found."):(shaka.log.info("MediaCapabilities: install"),navigator.mediaCapabilities||(navigator.mediaCapabilities={}),shaka.polyfill.MediaCapabilities.originalMcap=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=shaka.polyfill.MediaCapabilities.decodingInfo_)},shaka.polyfill.MediaCapabilities.decodingInfo_=function(e){var t,r,n,a,i,o,s;return $jscomp.asyncExecutePromiseGeneratorProgram((function(l){switch(l.nextAddress){case 1:if(t={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:e},r=e.video,n=e.audio,"media-source"!=e.type){if("file"!=e.type)return l.return(t);if(r&&(a=r.contentType,!shaka.util.Platform.supportsMediaType(a))||n&&(i=n.contentType,!shaka.util.Platform.supportsMediaType(i)))return l.return(t);l.jumpTo(2);break}if(!shaka.util.Platform.supportsMediaSource())return l.return(t);if(!r){l.jumpTo(3);break}return l.yield(shaka.polyfill.MediaCapabilities.checkVideoSupport_(r),4);case 4:if(!l.yieldResult)return l.return(t);case 3:if(n&&!shaka.polyfill.MediaCapabilities.checkAudioSupport_(n))return l.return(t);case 2:return e.keySystemConfiguration?(o=e.keySystemConfiguration,l.yield(shaka.polyfill.MediaCapabilities.checkDrmSupport_(r,n,o),6)):(t.supported=!0,l.return(t));case 6:(s=l.yieldResult)&&(t.supported=!0,t.keySystemAccess=s);case 5:return l.return(t)}}))},shaka.polyfill.MediaCapabilities.checkVideoSupport_=function(e){var t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?shaka.util.Platform.isChromecast()?n.yield(shaka.polyfill.MediaCapabilities.canCastDisplayType_(e),3):shaka.util.Platform.isTizen()?(t=e.contentType,e.width&&e.height&&(t+="; width="+e.width,t+="; height="+e.height),e.framerate&&(t+="; framerate="+e.framerate),e.bitrate&&(t+="; bitrate="+e.bitrate),n.return(shaka.media.Capabilities.isTypeSupported(t))):n.jumpTo(2):2!=n.nextAddress?(r=n.yieldResult,n.return(r)):n.return(shaka.media.Capabilities.isTypeSupported(e.contentType))}))},shaka.polyfill.MediaCapabilities.checkAudioSupport_=function(e){var t=e.contentType;return shaka.util.Platform.isChromecast()&&e.spatialRendering&&(t+="; spatialRendering=true"),shaka.media.Capabilities.isTypeSupported(t)},shaka.polyfill.MediaCapabilities.checkDrmSupport_=function(e,t,r){var n,a,i,o,s,l,u;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:if(n=[],a=[],r.audio&&(i={robustness:r.audio.robustness||"",contentType:t.contentType},shaka.util.Platform.isTizen()&&t.contentType.includes('codecs="ac-3"')&&(i.contentType='audio/mp4; codecs="ec-3"'),r.audio.encryptionScheme&&(i.encryptionScheme=r.audio.encryptionScheme),n.push(i)),r.video&&(o={robustness:r.video.robustness||"",contentType:e.contentType},r.video.encryptionScheme&&(o.encryptionScheme=r.video.encryptionScheme),a.push(o)),s={initDataTypes:[r.initDataType],distinctiveIdentifier:r.distinctiveIdentifier,persistentState:r.persistentState,sessionTypes:r.sessionTypes},n.length&&(s.audioCapabilities=n),a.length&&(s.videoCapabilities=a),l=shaka.polyfill.MediaCapabilities.generateKeySystemCacheKey_(e?e.contentType:"",t?t.contentType:"",r.keySystem),u=null,c.setCatchFinallyBlocks(2),l in shaka.polyfill.MediaCapabilities.memoizedMediaKeySystemAccessRequests_){u=shaka.polyfill.MediaCapabilities.memoizedMediaKeySystemAccessRequests_[l],c.jumpTo(4);break}return c.yield(navigator.requestMediaKeySystemAccess(r.keySystem,[s]),5);case 5:u=c.yieldResult,shaka.polyfill.MediaCapabilities.memoizedMediaKeySystemAccessRequests_[l]=u;case 4:c.leaveTryBlock(3);break;case 2:c.enterCatchBlock(),shaka.log.info("navigator.requestMediaKeySystemAccess failed.");case 3:return c.return(u)}}))},shaka.polyfill.MediaCapabilities.canCastDisplayType_=function(e){var t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?window.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(t=e.contentType,e.width&&e.height&&(t+="; width="+e.width+"; height="+e.height),e.framerate&&(t+="; framerate="+e.framerate),"pq"===e.transferFunction&&(t+="; eotf=smpte2084"),r=!1,t in shaka.polyfill.MediaCapabilities.memoizedCanDisplayTypeRequests_?(r=shaka.polyfill.MediaCapabilities.memoizedCanDisplayTypeRequests_[t],n.jumpTo(2)):n.yield(cast.__platform__.canDisplayType(t),3)):(shaka.log.warning("Expected cast APIs to be available! Falling back to shaka.media.Capabilities.isTypeSupported() for type support."),n.return(shaka.media.Capabilities.isTypeSupported(e.contentType))):(2!=n.nextAddress&&(r=n.yieldResult,shaka.polyfill.MediaCapabilities.memoizedCanDisplayTypeRequests_[t]=r),n.return(r))}))},shaka.polyfill.MediaCapabilities.generateKeySystemCacheKey_=function(e,t,r){return e+"#"+t+"#"+r},goog.exportProperty(shaka.polyfill,"MediaCapabilities",shaka.polyfill.MediaCapabilities),goog.exportProperty(shaka.polyfill.MediaCapabilities,"install",shaka.polyfill.MediaCapabilities.install),shaka.polyfill.MediaCapabilities.originalMcap=null,goog.exportProperty(shaka.polyfill.MediaCapabilities,"originalMcap",shaka.polyfill.MediaCapabilities.originalMcap),shaka.polyfill.MediaCapabilities.memoizedMediaKeySystemAccessRequests_={},goog.exportProperty(shaka.polyfill.MediaCapabilities,"memoizedMediaKeySystemAccessRequests_",shaka.polyfill.MediaCapabilities.memoizedMediaKeySystemAccessRequests_),shaka.polyfill.MediaCapabilities.memoizedCanDisplayTypeRequests_={},goog.exportProperty(shaka.polyfill.MediaCapabilities,"memoizedCanDisplayTypeRequests_",shaka.polyfill.MediaCapabilities.memoizedCanDisplayTypeRequests_),shaka.polyfill.register(shaka.polyfill.MediaCapabilities.install,-1),shaka.polyfill.MediaSource=function(){},shaka.polyfill.MediaSource.install=function(){shaka.log.debug("MediaSource.install");var e=shaka.util.Platform.safariVersion();window.MediaSource||window.ManagedMediaSource?e?10>=e?(shaka.log.info("Blacklisting MSE on Safari <= 10."),shaka.polyfill.MediaSource.blacklist_()):12>=e?(shaka.log.info("Patching Safari 11 & 12 MSE bugs."),shaka.polyfill.MediaSource.stubAbort_(),shaka.polyfill.MediaSource.patchRemovalRange_()):15>=e&&(shaka.log.info("Patching Safari 13 & 14 & 15 MSE bugs."),shaka.polyfill.MediaSource.stubAbort_()):shaka.util.Platform.isZenterio()?(shaka.polyfill.MediaSource.stubAbort_(),shaka.polyfill.MediaSource.patchRemovalRange_()):shaka.util.Platform.isTizen2()||shaka.util.Platform.isTizen3()||shaka.util.Platform.isTizen4()?(shaka.log.info("Rejecting Opus."),shaka.polyfill.MediaSource.rejectCodec_("opus")):shaka.log.info("Using native MSE as-is."):shaka.log.info("No MSE implementation available."),(window.MediaSource||window.ManagedMediaSource)&&shaka.polyfill.MediaSource.rejectContainer_("mp2t"),window.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&(shaka.log.info("Patching vp09 support queries."),shaka.polyfill.MediaSource.patchVp09_())},shaka.polyfill.MediaSource.blacklist_=function(){window.MediaSource=null},shaka.polyfill.MediaSource.stubAbort_=function(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=$jscomp.getRestArguments.apply(0,arguments);return(t=e.apply(this,t)).abort=function(){},t}},shaka.polyfill.MediaSource.patchRemovalRange_=function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,r){return e.call(this,t,r-.001)}},shaka.polyfill.MediaSource.rejectContainer_=function(e){var t=MediaSource.isTypeSupported.bind(MediaSource);if(MediaSource.isTypeSupported=function(r){return shaka.util.MimeUtils.getContainerType(r)!=e&&t(r)},window.ManagedMediaSource){var r=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);window.ManagedMediaSource.isTypeSupported=function(t){return shaka.util.MimeUtils.getContainerType(t)!=e&&r(t)}}},shaka.polyfill.MediaSource.rejectCodec_=function(e){var t=MediaSource.isTypeSupported.bind(MediaSource);if(MediaSource.isTypeSupported=function(r){return shaka.util.MimeUtils.getCodecBase(r)!=e&&t(r)},window.ManagedMediaSource){var r=ManagedMediaSource.isTypeSupported.bind(ManagedMediaSource);window.ManagedMediaSource.isTypeSupported=function(t){return shaka.util.MimeUtils.getCodecBase(t)!=e&&r(t)}}},shaka.polyfill.MediaSource.patchVp09_=function(){var e=MediaSource.isTypeSupported;shaka.util.Platform.isWebOS()||(MediaSource.isTypeSupported=function(t){var r=t.split(/ *; */),n=r.findIndex((function(e){return e.startsWith("codecs=")}));if(0>n)return e(t);var a=r[n].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),i=a.findIndex((function(e){return e.startsWith("vp09")}));return 0<=i&&(a[i]="vp9",r[n]='codecs="'+a.join(",")+'"',t=r.join("; ")),e(t)})},goog.exportProperty(shaka.polyfill,"MediaSource",shaka.polyfill.MediaSource),goog.exportProperty(shaka.polyfill.MediaSource,"install",shaka.polyfill.MediaSource.install),shaka.polyfill.register(shaka.polyfill.MediaSource.install),shaka.polyfill.Orientation=function(){},shaka.polyfill.Orientation.install=function(){screen.orientation&&screen.orientation.unlock?shaka.log.info("Using native screen.orientation"):null!=screen.orientation?shaka.polyfill.Orientation.installBasedOnScreenMethods_():null!=window.orientation&&shaka.polyfill.Orientation.installBasedOnWindowMethods_()},shaka.polyfill.Orientation.installBasedOnScreenMethods_=function(){void 0===screen.orientation.lock&&(screen.orientation.lock=function(e){return shaka.log.info("screen.orientation.lock is a no-op"),Promise.resolve()}),void 0===screen.orientation.unlock&&(screen.orientation.unlock=function(){shaka.log.info("screen.orientation.unlock is a no-op")})},shaka.polyfill.Orientation.installBasedOnWindowMethods_=function(){var e=new shaka.polyfill.Orientation.FakeOrientation;screen.orientation=e;var t=function(){switch(window.orientation){case-90:e.type="landscape-secondary",e.angle=270;break;case 0:e.type="portrait-primary",e.angle=0;break;case 90:e.type="landscape-primary",e.angle=90;break;case 180:e.type="portrait-secondary",e.angle=180}};t(),window.addEventListener("orientationchange",(function(){t(),e.dispatchChangeEvent()}))},goog.exportProperty(shaka.polyfill,"Orientation",shaka.polyfill.Orientation),goog.exportProperty(shaka.polyfill.Orientation,"install",shaka.polyfill.Orientation.install),shaka.polyfill.Orientation.FakeOrientation=function(){shaka.util.FakeEventTarget.call(this),this.type="",this.angle=0},$jscomp.inherits(shaka.polyfill.Orientation.FakeOrientation,shaka.util.FakeEventTarget),shaka.polyfill.Orientation.FakeOrientation.prototype.dispatchChangeEvent=function(){var e=new shaka.util.FakeEvent("change");this.dispatchEvent(e)},shaka.polyfill.Orientation.FakeOrientation.prototype.lock=function(e){var t=function(e){return screen.lockOrientation?screen.lockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):!!screen.msLockOrientation&&screen.msLockOrientation(e)},r=!1;switch(e){case"natural":r=t("default");break;case"any":r=!0,this.unlock();break;default:r=t(e)}return r?Promise.resolve():((e=Error("screen.orientation.lock() is not available on this device")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},shaka.polyfill.Orientation.FakeOrientation.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},shaka.polyfill.register(shaka.polyfill.Orientation.install),shaka.polyfill.PatchedMediaKeysApple=function(){},shaka.polyfill.PatchedMediaKeysApple.install=function(e){var t=shaka.polyfill.PatchedMediaKeysApple;window.HTMLVideoElement&&window.WebKitMediaKeys&&(void 0!==e&&e&&(t.enableUninstall=!0,t.originalHTMLMediaElementPrototypeMediaKeys=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),t.originalHTMLMediaElementPrototypeSetMediaKeys=HTMLMediaElement.prototype.setMediaKeys,t.originalWindowMediaKeys=window.MediaKeys,t.originalWindowMediaKeySystemAccess=window.MediaKeySystemAccess,t.originalNavigatorRequestMediaKeySystemAccess=navigator.requestMediaKeySystemAccess),shaka.log.info("Using Apple-prefixed EME"),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=t.setMediaKeys,window.MediaKeys=t.MediaKeys,window.MediaKeySystemAccess=t.MediaKeySystemAccess,navigator.requestMediaKeySystemAccess=t.requestMediaKeySystemAccess,window.shakaMediaKeysPolyfill=!0)},shaka.polyfill.PatchedMediaKeysApple.uninstall=function(){var e=shaka.polyfill.PatchedMediaKeysApple;e.enableUninstall&&(shaka.log.info("Un-installing Apple-prefixed EME"),e.enableUninstall=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",e.originalHTMLMediaElementPrototypeMediaKeys),HTMLMediaElement.prototype.setMediaKeys=e.originalHTMLMediaElementPrototypeSetMediaKeys,window.MediaKeys=e.originalWindowMediaKeys,window.MediaKeySystemAccess=e.originalWindowMediaKeySystemAccess,navigator.requestMediaKeySystemAccess=e.originalNavigatorRequestMediaKeySystemAccess,e.originalWindowMediaKeys=null,e.originalWindowMediaKeySystemAccess=null,e.originalHTMLMediaElementPrototypeSetMediaKeys=null,e.originalNavigatorRequestMediaKeySystemAccess=null,e.originalHTMLMediaElementPrototypeMediaKeys=null,window.shakaMediaKeysPolyfill=!1)},shaka.polyfill.PatchedMediaKeysApple.requestMediaKeySystemAccess=function(e,t){shaka.log.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess"),goog.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess');var r=shaka.polyfill.PatchedMediaKeysApple;try{var n=new r.MediaKeySystemAccess(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}},shaka.polyfill.PatchedMediaKeysApple.setMediaKeys=function(e){shaka.log.debug("PatchedMediaKeysApple.setMediaKeys"),goog.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys');var t=shaka.polyfill.PatchedMediaKeysApple,r=this.mediaKeys;return r&&r!=e&&(goog.asserts.assert(r instanceof t.MediaKeys,"non-polyfill instance of oldMediaKeys"),r.setMedia(null)),delete this.mediaKeys,(this.mediaKeys=e)?(goog.asserts.assert(e instanceof t.MediaKeys,"non-polyfill instance of newMediaKeys"),e.setMedia(this)):Promise.resolve()},shaka.polyfill.PatchedMediaKeysApple.onWebkitNeedKey_=function(e){if(shaka.log.debug("PatchedMediaKeysApple.onWebkitNeedKey_",e),goog.asserts.assert(this.mediaKeys instanceof shaka.polyfill.PatchedMediaKeysApple.MediaKeys,"non-polyfill instance of newMediaKeys"),goog.asserts.assert(null!=e.initData,"missing init data!"),e=shaka.util.BufferUtils.toUint8(e.initData),shaka.util.BufferUtils.toDataView(e).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=shaka.util.StringUtils.fromUTF16(e.subarray(4),!0),e=shaka.util.StringUtils.toUTF8(e);var t=new Event("encrypted");t.initDataType="skd",t.initData=shaka.util.BufferUtils.toArrayBuffer(e),this.dispatchEvent(t)},goog.exportProperty(shaka.polyfill,"PatchedMediaKeysApple",shaka.polyfill.PatchedMediaKeysApple),goog.exportProperty(shaka.polyfill.PatchedMediaKeysApple,"uninstall",shaka.polyfill.PatchedMediaKeysApple.uninstall),goog.exportProperty(shaka.polyfill.PatchedMediaKeysApple,"install",shaka.polyfill.PatchedMediaKeysApple.install),shaka.polyfill.PatchedMediaKeysApple.MediaKeySystemAccess=function(e,t){if(shaka.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess"),this.keySystem=e,e.startsWith("com.apple.fps"))for(t=(e=$jscomp.makeIterator(t)).next();!t.done;t=e.next())if(t=this.checkConfig_(t.value))return void(this.configuration_=t);throw(e=Error("Unsupported keySystem")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e},shaka.polyfill.PatchedMediaKeysApple.MediaKeySystemAccess.prototype.checkConfig_=function(e){if("required"==e.persistentState)return null;var t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"],label:e.label},r=!1,n=!1;if(e.audioCapabilities)for(var a=$jscomp.makeIterator(e.audioCapabilities),i=a.next();!i.done;i=a.next())if((i=i.value).contentType){r=!0;var o=i.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,o)&&(t.audioCapabilities.push(i),n=!0)}if(e.videoCapabilities)for(i=(e=$jscomp.makeIterator(e.videoCapabilities)).next();!i.done;i=e.next())(a=i.value).contentType&&(r=!0,i=a.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,i)&&(t.videoCapabilities.push(a),n=!0));return r||(n=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),n?t:null},shaka.polyfill.PatchedMediaKeysApple.MediaKeySystemAccess.prototype.createMediaKeys=function(){shaka.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var e=new shaka.polyfill.PatchedMediaKeysApple.MediaKeys(this.keySystem);return Promise.resolve(e)},shaka.polyfill.PatchedMediaKeysApple.MediaKeySystemAccess.prototype.getConfiguration=function(){return shaka.log.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration"),this.configuration_},shaka.polyfill.PatchedMediaKeysApple.MediaKeys=function(e){shaka.log.debug("PatchedMediaKeysApple.MediaKeys"),this.nativeMediaKeys_=new WebKitMediaKeys(e),this.eventManager_=new shaka.util.EventManager},shaka.polyfill.PatchedMediaKeysApple.MediaKeys.prototype.createSession=function(e){if(shaka.log.debug("PatchedMediaKeysApple.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new shaka.polyfill.PatchedMediaKeysApple.MediaKeySession(this.nativeMediaKeys_,e)},shaka.polyfill.PatchedMediaKeysApple.MediaKeys.prototype.setServerCertificate=function(e){return shaka.log.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate"),Promise.resolve(!1)},shaka.polyfill.PatchedMediaKeysApple.MediaKeys.prototype.setMedia=function(e){var t=this,r=shaka.polyfill.PatchedMediaKeysApple;if(this.eventManager_.removeAll(),!e)return Promise.resolve();this.eventManager_.listen(e,"webkitneedkey",r.onWebkitNeedKey_);try{return shaka.util.MediaReadyState.waitForReadyState(e,HTMLMediaElement.HAVE_METADATA,this.eventManager_,(function(){e.webkitSetMediaKeys(t.nativeMediaKeys_)})),Promise.resolve()}catch(e){return Promise.reject(e)}},shaka.polyfill.PatchedMediaKeysApple.MediaKeys.prototype.getStatusForPolicy=function(e){return Promise.resolve("usable")},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession=function(e,t){shaka.log.debug("PatchedMediaKeysApple.MediaKeySession"),shaka.util.FakeEventTarget.call(this),this.nativeMediaKeySession_=null,this.nativeMediaKeys_=e,this.updatePromise_=this.generateRequestPromise_=null,this.eventManager_=new shaka.util.EventManager,this.sessionId="",this.expiration=NaN,this.closed=new shaka.util.PublicPromise,this.keyStatuses=new shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap},$jscomp.inherits(shaka.polyfill.PatchedMediaKeysApple.MediaKeySession,shaka.util.FakeEventTarget),shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.generateRequest=function(e,t){var r=this;shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest"),this.generateRequestPromise_=new shaka.util.PublicPromise;try{var n=this.nativeMediaKeys_.createSession("video/mp4",shaka.util.BufferUtils.toUint8(t));this.nativeMediaKeySession_=n,this.sessionId=n.sessionId||"",this.eventManager_.listen(this.nativeMediaKeySession_,"webkitkeymessage",(function(e){return r.onWebkitKeyMessage_(e)})),this.eventManager_.listen(n,"webkitkeyadded",(function(e){return r.onWebkitKeyAdded_(e)})),this.eventManager_.listen(n,"webkitkeyerror",(function(e){return r.onWebkitKeyError_(e)})),this.updateKeyStatus_("status-pending")}catch(e){this.generateRequestPromise_.reject(e)}return this.generateRequestPromise_},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.load=function(){return shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.update=function(e){shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.update"),this.updatePromise_=new shaka.util.PublicPromise;try{this.nativeMediaKeySession_.update(shaka.util.BufferUtils.toUint8(e))}catch(e){this.updatePromise_.reject(e)}return this.updatePromise_},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.close=function(){shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.nativeMediaKeySession_.close(),this.closed.resolve(),this.eventManager_.removeAll()}catch(e){this.closed.reject(e)}return this.closed},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.remove=function(){return shaka.log.debug("PatchedMediaKeysApple.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.onWebkitKeyMessage_=function(e){shaka.log.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",e),goog.asserts.assert(this.generateRequestPromise_,"generateRequestPromise_ should be set before now!"),this.generateRequestPromise_&&(this.generateRequestPromise_.resolve(),this.generateRequestPromise_=null);var t=null==this.keyStatuses.getStatus();e=(new Map).set("messageType",t?"license-request":"license-renewal").set("message",shaka.util.BufferUtils.toArrayBuffer(e.message)),e=new shaka.util.FakeEvent("message",e),this.dispatchEvent(e)},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.onWebkitKeyAdded_=function(e){shaka.log.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",e),goog.asserts.assert(!this.generateRequestPromise_,"Key added during generate!"),goog.asserts.assert(this.updatePromise_,"updatePromise_ should be set before now!"),this.updatePromise_&&(this.updateKeyStatus_("usable"),this.updatePromise_.resolve(),this.updatePromise_=null)},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.onWebkitKeyError_=function(e){if(shaka.log.debug("PatchedMediaKeysApple.onWebkitKeyError_",e),(e=Error("EME PatchedMediaKeysApple key error")).errorCode=this.nativeMediaKeySession_.error,null!=this.generateRequestPromise_)this.generateRequestPromise_.reject(e),this.generateRequestPromise_=null;else if(null!=this.updatePromise_)this.updatePromise_.reject(e),this.updatePromise_=null;else switch(this.nativeMediaKeySession_.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:this.updateKeyStatus_("output-not-allowed");break;default:this.updateKeyStatus_("internal-error")}},shaka.polyfill.PatchedMediaKeysApple.MediaKeySession.prototype.updateKeyStatus_=function(e){this.keyStatuses.setStatus(e),e=new shaka.util.FakeEvent("keystatuseschange"),this.dispatchEvent(e)},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap=function(){this.size=0,this.status_=void 0},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.setStatus=function(e){this.size=null==e?0:1,this.status_=e},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.getStatus=function(){return this.status_},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.forEach=function(e){this.status_&&e(this.status_,shaka.media.DrmEngine.DUMMY_KEY_ID.value())},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.get=function(e){if(this.has(e))return this.status_},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.has=function(e){var t=shaka.media.DrmEngine.DUMMY_KEY_ID.value();return!(!this.status_||!shaka.util.BufferUtils.equal(e,t))},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.entries=function(){goog.asserts.assert(!1,"Not used!  Provided only for the compiler.")},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.keys=function(){goog.asserts.assert(!1,"Not used!  Provided only for the compiler.")},shaka.polyfill.PatchedMediaKeysApple.MediaKeyStatusMap.prototype.values=function(){goog.asserts.assert(!1,"Not used!  Provided only for the compiler.")},shaka.polyfill.PatchedMediaKeysCert=function(){},shaka.polyfill.PatchedMediaKeysCert.install=function(){!window.MediaKeys||MediaKeys.prototype.setServerCertificate&&!shaka.polyfill.PatchedMediaKeysCert.hasInvalidImplementation_()||(shaka.log.info("Patching MediaKeys.setServerCertificate"),MediaKeys.prototype.setServerCertificate=shaka.polyfill.PatchedMediaKeysCert.setServerCertificate_)},shaka.polyfill.PatchedMediaKeysCert.setServerCertificate_=function(e){return shaka.log.debug("PatchedMediaKeysCert.setServerCertificate"),Promise.resolve(!1)},shaka.polyfill.PatchedMediaKeysCert.hasInvalidImplementation_=function(){return shaka.util.Platform.isTizen3()||shaka.util.Platform.isTizen4()||shaka.util.Platform.isTizen5_0()||shaka.util.Platform.isWebOS3()},goog.exportProperty(shaka.polyfill,"PatchedMediaKeysCert",shaka.polyfill.PatchedMediaKeysCert),goog.exportProperty(shaka.polyfill.PatchedMediaKeysCert,"install",shaka.polyfill.PatchedMediaKeysCert.install),shaka.polyfill.register(shaka.polyfill.PatchedMediaKeysCert.install),shaka.polyfill.PatchedMediaKeysNop=function(){},shaka.polyfill.PatchedMediaKeysNop.install=function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){shaka.log.info("EME not available.");var e=shaka.polyfill.PatchedMediaKeysNop;navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=e.setMediaKeys,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess,window.shakaMediaKeysPolyfill=!0}},shaka.polyfill.PatchedMediaKeysNop.requestMediaKeySystemAccess=function(e,t){return shaka.log.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess"),goog.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess'),Promise.reject(Error("The key system specified is not supported."))},shaka.polyfill.PatchedMediaKeysNop.setMediaKeys=function(e){return shaka.log.debug("PatchedMediaKeysNop.setMediaKeys"),goog.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys'),null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))},goog.exportProperty(shaka.polyfill,"PatchedMediaKeysNop",shaka.polyfill.PatchedMediaKeysNop),goog.exportProperty(shaka.polyfill.PatchedMediaKeysNop,"install",shaka.polyfill.PatchedMediaKeysNop.install),shaka.polyfill.PatchedMediaKeysNop.MediaKeys=function(){throw new TypeError("Illegal constructor.")},shaka.polyfill.PatchedMediaKeysNop.MediaKeys.prototype.createSession=function(){},shaka.polyfill.PatchedMediaKeysNop.MediaKeys.prototype.setServerCertificate=function(){},shaka.polyfill.PatchedMediaKeysNop.MediaKeys.prototype.getStatusForPolicy=function(e){return Promise.resolve("usable")},shaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess=function(){throw this.keySystem="",new TypeError("Illegal constructor.")},shaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess.prototype.getConfiguration=function(){},shaka.polyfill.PatchedMediaKeysNop.MediaKeySystemAccess.prototype.createMediaKeys=function(){},shaka.polyfill.register(shaka.polyfill.PatchedMediaKeysNop.install,-10),shaka.polyfill.PatchedMediaKeysWebkit=function(){},shaka.polyfill.PatchedMediaKeysWebkit.install=function(){var e=shaka.polyfill.PatchedMediaKeysWebkit;if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)shaka.log.info("Using webkit-prefixed EME v0.1b"),e.prefix_="webkit";else{if(!HTMLMediaElement.prototype.generateKeyRequest)return;shaka.log.info("Using nonprefixed EME v0.1b")}goog.asserts.assert(HTMLMediaElement.prototype[e.prefixApi_("generateKeyRequest")],"PatchedMediaKeysWebkit APIs not available!"),navigator.requestMediaKeySystemAccess=e.requestMediaKeySystemAccess,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=e.setMediaKeys,window.MediaKeys=e.MediaKeys,window.MediaKeySystemAccess=e.MediaKeySystemAccess,window.shakaMediaKeysPolyfill=!0}},shaka.polyfill.PatchedMediaKeysWebkit.prefixApi_=function(e){var t=shaka.polyfill.PatchedMediaKeysWebkit.prefix_;return t?t+e.charAt(0).toUpperCase()+e.slice(1):e},shaka.polyfill.PatchedMediaKeysWebkit.requestMediaKeySystemAccess=function(e,t){shaka.log.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess"),goog.asserts.assert(this==navigator,'bad "this" for requestMediaKeySystemAccess');var r=shaka.polyfill.PatchedMediaKeysWebkit;try{var n=new r.MediaKeySystemAccess(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}},shaka.polyfill.PatchedMediaKeysWebkit.setMediaKeys=function(e){shaka.log.debug("PatchedMediaKeysWebkit.setMediaKeys"),goog.asserts.assert(this instanceof HTMLMediaElement,'bad "this" for setMediaKeys');var t=shaka.polyfill.PatchedMediaKeysWebkit,r=this.mediaKeys;return r&&r!=e&&(goog.asserts.assert(r instanceof t.MediaKeys,"non-polyfill instance of oldMediaKeys"),r.setMedia(null)),delete this.mediaKeys,(this.mediaKeys=e)&&(goog.asserts.assert(e instanceof t.MediaKeys,"non-polyfill instance of newMediaKeys"),e.setMedia(this)),Promise.resolve()},shaka.polyfill.PatchedMediaKeysWebkit.getVideoElement_=function(){var e=document.getElementsByTagName("video");return e.length?e[0]:document.createElement("video")},goog.exportProperty(shaka.polyfill,"PatchedMediaKeysWebkit",shaka.polyfill.PatchedMediaKeysWebkit),goog.exportProperty(shaka.polyfill.PatchedMediaKeysWebkit,"install",shaka.polyfill.PatchedMediaKeysWebkit.install),shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess=function(e,t){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess"),this.internalKeySystem_=this.keySystem=e;var r=!1;"org.w3.clearkey"==e&&(this.internalKeySystem_="webkit-org.w3.clearkey",r=!1);for(var n=!1,a=shaka.polyfill.PatchedMediaKeysWebkit.getVideoElement_(),i=(t=$jscomp.makeIterator(t)).next();!i.done;i=t.next()){var o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:(i=i.value).initDataTypes,sessionTypes:["temporary"],label:i.label},s=!1;if(i.audioCapabilities)for(var l=$jscomp.makeIterator(i.audioCapabilities),u=l.next();!u.done;u=l.next())if((u=u.value).contentType){s=!0;var c=u.contentType.split(";")[0];a.canPlayType(c,this.internalKeySystem_)&&(o.audioCapabilities.push(u),n=!0)}if(i.videoCapabilities)for(u=(l=$jscomp.makeIterator(i.videoCapabilities)).next();!u.done;u=l.next())(u=u.value).contentType&&(s=!0,a.canPlayType(u.contentType,this.internalKeySystem_)&&(o.videoCapabilities.push(u),n=!0));if(s||(n=a.canPlayType("video/mp4",this.internalKeySystem_)||a.canPlayType("video/webm",this.internalKeySystem_)),"required"==i.persistentState&&(r?(o.persistentState="required",o.sessionTypes=["persistent-license"]):n=!1),n)return void(this.configuration_=o)}throw r="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(r="None of the requested configurations were supported."),(e=Error(r)).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess.prototype.createMediaKeys=function(){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var e=new shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys(this.internalKeySystem_);return Promise.resolve(e)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySystemAccess.prototype.getConfiguration=function(){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration"),this.configuration_},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys=function(e){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys"),this.keySystem_=e,this.media_=null,this.eventManager_=new shaka.util.EventManager,this.newSessions_=[],this.sessionMap_=new Map},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.setMedia=function(e){var t=this;this.media_=e,this.eventManager_.removeAll();var r=shaka.polyfill.PatchedMediaKeysWebkit.prefix_;e&&(this.eventManager_.listen(e,r+"needkey",(function(e){return t.onWebkitNeedKey_(e)})),this.eventManager_.listen(e,r+"keymessage",(function(e){return t.onWebkitKeyMessage_(e)})),this.eventManager_.listen(e,r+"keyadded",(function(e){return t.onWebkitKeyAdded_(e)})),this.eventManager_.listen(e,r+"keyerror",(function(e){return t.onWebkitKeyError_(e)})))},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.createSession=function(e){if(shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys.createSession"),"temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=shaka.polyfill.PatchedMediaKeysWebkit,r=this.media_||document.createElement("video");return r.src||(r.src="about:blank"),e=new t.MediaKeySession(r,this.keySystem_,e),this.newSessions_.push(e),e},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.setServerCertificate=function(e){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate"),Promise.resolve(!1)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.getStatusForPolicy=function(e){return Promise.resolve("usable")},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitNeedKey_=function(e){shaka.log.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",e),goog.asserts.assert(this.media_,"media_ not set in onWebkitNeedKey_");var t=new CustomEvent("encrypted");t.initDataType="cenc",t.initData=shaka.util.BufferUtils.toArrayBuffer(e.initData),this.media_.dispatchEvent(t)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyMessage_=function(e){shaka.log.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",e);var t=this.findSession_(e.sessionId);if(t){var r=null==t.keyStatuses.getStatus();e=(new Map).set("messageType",r?"licenserequest":"licenserenewal").set("message",e.message),e=new shaka.util.FakeEvent("message",e),t.generated(),t.dispatchEvent(e)}else shaka.log.error("Session not found",e.sessionId)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyAdded_=function(e){shaka.log.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",e),e=this.findSession_(e.sessionId),goog.asserts.assert(e,"unable to find session in onWebkitKeyAdded_"),e&&e.ready()},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.onWebkitKeyError_=function(e){shaka.log.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",e);var t=this.findSession_(e.sessionId);goog.asserts.assert(t,"unable to find session in onWebkitKeyError_"),t&&t.handleError(e)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeys.prototype.findSession_=function(e){var t=this.sessionMap_.get(e);return t?(shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",t),t):(t=this.newSessions_.shift())?(t.sessionId=e,this.sessionMap_.set(e,t),shaka.log.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",t),t):null},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession=function(e,t,r){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession"),shaka.util.FakeEventTarget.call(this),this.media_=e,this.initialized_=!1,this.updatePromise_=this.generatePromise_=null,this.keySystem_=t,this.type_=r,this.sessionId="",this.expiration=NaN,this.closed=new shaka.util.PublicPromise,this.keyStatuses=new shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap},$jscomp.inherits(shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession,shaka.util.FakeEventTarget),shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generated=function(){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),this.generatePromise_&&(this.generatePromise_.resolve(),this.generatePromise_=null)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.ready=function(){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),this.updateKeyStatus_("usable"),this.updatePromise_&&this.updatePromise_.resolve(),this.updatePromise_=null},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.handleError=function(e){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",e);var t=Error("EME v0.1b key error"),r=e.errorCode;r.systemCode=e.systemCode,t.errorCode=r,!e.sessionId&&this.generatePromise_?(45==e.systemCode&&(t.message="Unsupported session type."),this.generatePromise_.reject(t),this.generatePromise_=null):e.sessionId&&this.updatePromise_?(this.updatePromise_.reject(t),this.updatePromise_=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?this.updateKeyStatus_("output-restricted"):1==t?this.updateKeyStatus_("expired"):this.updateKeyStatus_("internal-error"))},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generate_=function(e,t){var r=this,n=shaka.polyfill.PatchedMediaKeysWebkit;if(this.initialized_)return Promise.reject(Error("The session is already initialized."));this.initialized_=!0;try{if("persistent-license"==this.type_){var a=shaka.util.StringUtils;if(t)var i=shaka.util.BufferUtils.toUint8(a.toUTF8("LOAD_SESSION|"+t));else{goog.asserts.assert(e,"expecting init data");var o=a.toUTF8("PERSISTENT|");i=shaka.util.Uint8ArrayUtils.concat(o,e)}}else goog.asserts.assert("temporary"==this.type_,"expected temporary session"),goog.asserts.assert(!t,"unexpected offline session ID"),goog.asserts.assert(e,"expecting init data"),i=shaka.util.BufferUtils.toUint8(e);goog.asserts.assert(i,"init data not set!")}catch(e){return Promise.reject(e)}goog.asserts.assert(null==this.generatePromise_,"generatePromise_ should be null"),this.generatePromise_=new shaka.util.PublicPromise;var s=n.prefixApi_("generateKeyRequest");try{this.media_[s](this.keySystem_,i)}catch(e){if("InvalidStateError"!=e.name)return this.generatePromise_=null,Promise.reject(e);new shaka.util.Timer((function(){try{r.media_[s](r.keySystem_,i)}catch(e){r.generatePromise_.reject(e),r.generatePromise_=null}})).tickAfter(.01)}return this.generatePromise_},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.update_=function(e,t){var r=this,n=shaka.polyfill.PatchedMediaKeysWebkit;if(this.updatePromise_)this.updatePromise_.then((function(){return r.update_(e,t)})).catch((function(){return r.update_(e,t)}));else{if(this.updatePromise_=e,"webkit-org.w3.clearkey"==this.keySystem_){var a=shaka.util.Uint8ArrayUtils,i=shaka.util.StringUtils.fromUTF8(t),o=JSON.parse(i);"oct"!=o.keys[0].kty&&(this.updatePromise_.reject(Error("Response is not a valid JSON Web Key Set.")),this.updatePromise_=null),i=a.fromBase64(o.keys[0].k),a=a.fromBase64(o.keys[0].kid)}else i=shaka.util.BufferUtils.toUint8(t),a=null;n=n.prefixApi_("addKey");try{this.media_[n](this.keySystem_,i,a,this.sessionId)}catch(e){this.updatePromise_.reject(e),this.updatePromise_=null}}},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.updateKeyStatus_=function(e){this.keyStatuses.setStatus(e),e=new shaka.util.FakeEvent("keystatuseschange"),this.dispatchEvent(e)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.generateRequest=function(e,t){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest"),this.generate_(t,null)},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.load=function(e){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.load"),"persistent-license"==this.type_?this.generate_(null,e):Promise.reject(Error("Not a persistent session."))},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.update=function(e){shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.update",e),goog.asserts.assert(this.sessionId,"update without session ID");var t=new shaka.util.PublicPromise;return this.update_(t,e),t},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.close=function(){var e=shaka.polyfill.PatchedMediaKeysWebkit;if(shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.close"),"persistent-license"!=this.type_){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;e=e.prefixApi_("cancelKeyRequest");try{this.media_[e](this.keySystem_,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeySession.prototype.remove=function(){return shaka.log.debug("PatchedMediaKeysWebkit.MediaKeySession.remove"),"persistent-license"!=this.type_?Promise.reject(Error("Not a persistent session.")):this.close()},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap=function(){this.size=0,this.status_=void 0},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.setStatus=function(e){this.size=null==e?0:1,this.status_=e},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.getStatus=function(){return this.status_},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.forEach=function(e){this.status_&&e(this.status_,shaka.media.DrmEngine.DUMMY_KEY_ID.value())},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.get=function(e){if(this.has(e))return this.status_},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.has=function(e){var t=shaka.media.DrmEngine.DUMMY_KEY_ID.value();return!(!this.status_||!shaka.util.BufferUtils.equal(e,t))},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.entries=function(){goog.asserts.assert(!1,"Not used!  Provided only for compiler.")},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.keys=function(){goog.asserts.assert(!1,"Not used!  Provided only for compiler.")},shaka.polyfill.PatchedMediaKeysWebkit.MediaKeyStatusMap.prototype.values=function(){goog.asserts.assert(!1,"Not used!  Provided only for compiler.")},shaka.polyfill.PatchedMediaKeysWebkit.prefix_="",shaka.polyfill.register(shaka.polyfill.PatchedMediaKeysWebkit.install),shaka.polyfill.PiPWebkit=function(){},shaka.polyfill.PiPWebkit.install=function(){if(window.HTMLVideoElement){var e=HTMLVideoElement.prototype;if((!e.requestPictureInPicture||!document.exitPictureInPicture)&&e.webkitSupportsPresentationMode){var t=shaka.polyfill.PiPWebkit;shaka.log.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,e.requestPictureInPicture=t.requestPictureInPicture_,Object.defineProperty(e,"disablePictureInPicture",{get:t.getDisablePictureInPicture_,set:t.setDisablePictureInPicture_,enumerable:!0,configurable:!0}),document.exitPictureInPicture=t.exitPictureInPicture_,document.addEventListener("webkitpresentationmodechanged",t.proxyEvent_,!0)}}},shaka.polyfill.PiPWebkit.proxyEvent_=function(e){if((e=e.target).webkitPresentationMode==shaka.polyfill.PiPWebkit.PIP_MODE_){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)},shaka.polyfill.PiPWebkit.requestPictureInPicture_=function(){var e=shaka.polyfill.PiPWebkit;return this.webkitSupportsPresentationMode(e.PIP_MODE_)?(this.webkitSetPresentationMode(e.PIP_MODE_),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))},shaka.polyfill.PiPWebkit.exitPictureInPicture_=function(){var e=shaka.polyfill.PiPWebkit,t=document.pictureInPictureElement;return t?(t.webkitSetPresentationMode(e.INLINE_MODE_),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))},shaka.polyfill.PiPWebkit.getDisablePictureInPicture_=function(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode(shaka.polyfill.PiPWebkit.PIP_MODE_)},shaka.polyfill.PiPWebkit.setDisablePictureInPicture_=function(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")},goog.exportProperty(shaka.polyfill,"PiPWebkit",shaka.polyfill.PiPWebkit),goog.exportProperty(shaka.polyfill.PiPWebkit,"install",shaka.polyfill.PiPWebkit.install),shaka.polyfill.PiPWebkit.PIP_MODE_="picture-in-picture",shaka.polyfill.PiPWebkit.INLINE_MODE_="inline",shaka.polyfill.register(shaka.polyfill.PiPWebkit.install),shaka.polyfill.RandomUUID=function(){},shaka.polyfill.RandomUUID.install=function(){shaka.log.debug("randomUUID.install"),window.crypto?"randomUUID"in window.crypto?shaka.log.debug("RandomUUID: Native window.crypto.randomUUID() support found."):window.crypto.randomUUID=shaka.polyfill.RandomUUID.randomUUID_:shaka.log.debug("window.crypto must be available to install randomUUID polyfill.")},shaka.polyfill.RandomUUID.randomUUID_=function(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)},goog.exportProperty(shaka.polyfill,"RandomUUID",shaka.polyfill.RandomUUID),goog.exportProperty(shaka.polyfill.RandomUUID,"install",shaka.polyfill.RandomUUID.install),shaka.polyfill.register(shaka.polyfill.RandomUUID.install),shaka.polyfill.Symbol=function(){},shaka.polyfill.Symbol.install=function(){shaka.log.debug("Symbol.install");var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:shaka.polyfill.Symbol.getSymbolDescription_})},shaka.polyfill.Symbol.getSymbolDescription_=function(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0},goog.exportProperty(shaka.polyfill,"Symbol",shaka.polyfill.Symbol),goog.exportProperty(shaka.polyfill.Symbol,"install",shaka.polyfill.Symbol.install),shaka.polyfill.register(shaka.polyfill.Symbol.install),shaka.polyfill.VideoPlayPromise=function(){},shaka.polyfill.VideoPlayPromise.install=function(){if(shaka.log.debug("VideoPlayPromise.install"),window.HTMLMediaElement){var e=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var t=e.apply(this);return t&&t.catch((function(){})),t}}},goog.exportProperty(shaka.polyfill,"VideoPlayPromise",shaka.polyfill.VideoPlayPromise),goog.exportProperty(shaka.polyfill.VideoPlayPromise,"install",shaka.polyfill.VideoPlayPromise.install),shaka.polyfill.register(shaka.polyfill.VideoPlayPromise.install),shaka.polyfill.VideoPlaybackQuality=function(){},shaka.polyfill.VideoPlaybackQuality.install=function(){if(window.HTMLVideoElement){var e=HTMLVideoElement.prototype;!e.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in e||shaka.util.Platform.isWebOS3())&&(e.getVideoPlaybackQuality=shaka.polyfill.VideoPlaybackQuality.webkit_)}},shaka.polyfill.VideoPlaybackQuality.webkit_=function(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}},goog.exportProperty(shaka.polyfill,"VideoPlaybackQuality",shaka.polyfill.VideoPlaybackQuality),goog.exportProperty(shaka.polyfill.VideoPlaybackQuality,"install",shaka.polyfill.VideoPlaybackQuality.install),shaka.polyfill.register(shaka.polyfill.VideoPlaybackQuality.install),shaka.polyfill.VTTCue=function(){},shaka.polyfill.VTTCue.install=function(){if(window.VTTCue)shaka.log.info("Using native VTTCue.");else if(window.TextTrackCue){var e=null,t=TextTrackCue.length;3==t?(shaka.log.info("Using VTTCue polyfill from 3 argument TextTrackCue."),e=shaka.polyfill.VTTCue.from3ArgsTextTrackCue_):6==t?(shaka.log.info("Using VTTCue polyfill from 6 argument TextTrackCue."),e=shaka.polyfill.VTTCue.from6ArgsTextTrackCue_):shaka.polyfill.VTTCue.canUse3ArgsTextTrackCue_()&&(shaka.log.info("Using VTTCue polyfill from 3 argument TextTrackCue."),e=shaka.polyfill.VTTCue.from3ArgsTextTrackCue_),e?window.VTTCue=function(t,r,n){return e(t,r,n)}:shaka.log.error("No recognized signature for TextTrackCue found!")}else shaka.log.error("VTTCue not available.")},shaka.polyfill.VTTCue.from3ArgsTextTrackCue_=function(e,t,r){return new window.TextTrackCue(e,t,r)},shaka.polyfill.VTTCue.from6ArgsTextTrackCue_=function(e,t,r){return new window.TextTrackCue(e+"-"+t+"-"+r,e,t,r)},shaka.polyfill.VTTCue.canUse3ArgsTextTrackCue_=function(){try{return!!shaka.polyfill.VTTCue.from3ArgsTextTrackCue_(1,2,"")}catch(e){return!1}},goog.exportProperty(shaka.polyfill,"VTTCue",shaka.polyfill.VTTCue),goog.exportProperty(shaka.polyfill.VTTCue,"install",shaka.polyfill.VTTCue.install),shaka.polyfill.register(shaka.polyfill.VTTCue.install),shaka.text.LrcTextParser=function(){},shaka.text.LrcTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"LRC does not have init segments")},shaka.text.LrcTextParser.prototype.setSequenceMode=function(e){},shaka.text.LrcTextParser.prototype.setManifestType=function(e){},shaka.text.LrcTextParser.prototype.parseMedia=function(e,t){var r=shaka.text.LrcTextParser,n=null,a=[];e=shaka.util.StringUtils.fromUTF8(e).split(/\r?\n/);for(var i=(e=$jscomp.makeIterator(e)).next();!i.done;i=e.next()){var o=i.value;o&&!/^\s+$/.test(o)&&((i=r.lyricLine_.exec(o))?(o=r.parseTime_(i[1]),i=new shaka.text.Cue(o,t.segmentEnd?t.segmentEnd:o+2,i[2]),n&&(n.endTime=o,a.push(n)),n=i):shaka.log.warning("LrcTextParser encountered an unknown line.",o))}return n&&a.push(n),a},shaka.text.LrcTextParser.parseTime_=function(e){var t=shaka.text.LrcTextParser.timeFormat_.exec(e);return 60*(e=parseInt(t[1],10))+(t=parseFloat(t[2].replace(",",".")))},goog.exportSymbol("shaka.text.LrcTextParser",shaka.text.LrcTextParser),goog.exportProperty(shaka.text.LrcTextParser.prototype,"parseMedia",shaka.text.LrcTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.LrcTextParser.prototype,"setManifestType",shaka.text.LrcTextParser.prototype.setManifestType),goog.exportProperty(shaka.text.LrcTextParser.prototype,"setSequenceMode",shaka.text.LrcTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.LrcTextParser.prototype,"parseInit",shaka.text.LrcTextParser.prototype.parseInit),shaka.text.LrcTextParser.lyricLine_=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,shaka.text.LrcTextParser.timeFormat_=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/,shaka.text.TextEngine.registerParser("application/x-subtitle-lrc",(function(){return new shaka.text.LrcTextParser})),shaka.text.TtmlTextParser=function(){},shaka.text.TtmlTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"TTML does not have init segments")},shaka.text.TtmlTextParser.prototype.setSequenceMode=function(e){},shaka.text.TtmlTextParser.prototype.setManifestType=function(e){},shaka.text.TtmlTextParser.prototype.parseMedia=function(e,t,r){var n=shaka.text.TtmlTextParser,a=shaka.util.TXml,i=n.parameterNs_,o=n.styleNs_,s=shaka.util.StringUtils.fromUTF8(e);if(e=[],""==s)return e;var l=a.parseXmlString(s,"tt");if(!l)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_XML,"Failed to parse TTML.");if(!(s=a.getElementsByTagName(l,"body")[0]))return[];var u=a.getAttributeNSList(l,i,"frameRate"),c=a.getAttributeNSList(l,i,"subFrameRate"),d=a.getAttributeNSList(l,i,"frameRateMultiplier"),p=a.getAttributeNSList(l,i,"tickRate"),h=a.getAttributeNSList(l,i,"cellResolution"),f=l.attributes["xml:space"]||"default";if(i=a.getAttributeNSList(l,o,"extent"),"default"!=f&&"preserve"!=f)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_XML,"Invalid xml:space value: "+f);o="default"==f,u=new n.RateInfo_(u,c,d,p),c=n.getCellResolution_(h),d=(d=a.getElementsByTagName(l,"metadata")[0])?d.children:[],p=a.getElementsByTagName(l,"style"),l=a.getElementsByTagName(l,"region"),h=[];for(var m=(f=$jscomp.makeIterator(l)).next();!m.done;m=f.next())(m=n.parseCueRegion_(m.value,p,i))&&h.push(m);if(a.findChildren(s,"p").length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"<p> can only be inside <div> in TTML");for(f=(i=$jscomp.makeIterator(a.findChildren(s,"div"))).next();!f.done;f=i.next())if(a.findChildren(f.value,"span").length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"<span> can only be inside <p> in TTML");return(t=n.parseCue_(s,t,u,d,p,l,h,o,c,null,!1,r))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e},shaka.text.TtmlTextParser.parseCue_=function(e,t,r,n,a,i,o,s,l,u,c,d){var p=shaka.util.TXml,h=shaka.util.StringUtils,f=u;if(p.isText(e)){if(!c)return null;var m={tagName:"span",children:[p.getTextContents(e)],attributes:{},parent:null}}else m=e;goog.asserts.assert(m,"cueElement should be non-null!");for(var g=null,y=$jscomp.makeIterator(shaka.text.TtmlTextParser.smpteNsList_),v=y.next();!v.done&&!(g=shaka.text.TtmlTextParser.getElementsFromCollection_(m,"backgroundImage",n,"#",v.value)[0]);v=y.next());y=null;var _=p.getAttributeNSList(m,shaka.text.TtmlTextParser.smpteNsList_,"backgroundImage");if(d&&_&&!_.startsWith("#")&&(v=new goog.Uri(d),_=new goog.Uri(_),(v=v.resolve(_).toString())&&(y=v)),("p"==e.tagName||g||y)&&(c=!0),e=c,v="default"==(m.attributes["xml:space"]||(s?"default":"preserve")),s=[],!(_=m.children.every(p.isText)))for(var k=$jscomp.makeIterator(m.children),E=k.next();!E.done;E=k.next())(E=shaka.text.TtmlTextParser.parseCue_(E.value,t,r,n,a,i,o,v,l,m,c,d))&&s.push(E);if(n=null!=u,d=p.getTextContents(m),d=m.children.length&&d&&/\S/.test(d),!((E=m.attributes.begin||m.attributes.end||m.attributes.dur)||d||"br"==m.tagName||0!=s.length||n&&!v))return null;for(d=(k=shaka.text.TtmlTextParser.parseTime_(m,r)).start,k=k.end;f&&p.isNode(f)&&"tt"!=f.tagName;)d=(k=shaka.text.TtmlTextParser.resolveTime_(f,r,d,k)).start,k=k.end,f=f.parent;if(null==d&&(d=0),d+=t.periodStart,k=null==k?1/0:k+t.periodStart,d=Math.max(d,t.segmentStart),k=Math.min(k,t.segmentEnd),!E&&0<s.length)for(d=1/0,k=0,r=(t=$jscomp.makeIterator(s)).next();!r.done;r=t.next())r=r.value,d=Math.min(d,r.startTime),k=Math.max(k,r.endTime);if("br"==m.tagName)return(a=new shaka.text.Cue(d,k,"")).lineBreak=!0,a;if(t="",_&&(t=h.htmlUnescape(shaka.util.TXml.getTextContents(m)||""),v&&(t=t.replace(/\s+/g," "))),(h=new shaka.text.Cue(d,k,t)).nestedCues=s,c||(h.isContainer=!0),l&&(h.cellResolution=l),l=shaka.text.TtmlTextParser.getElementsFromCollection_(m,"region",i,"")[0],m.attributes.region&&l&&l.attributes["xml:id"]){var b=l.attributes["xml:id"];h.region=o.filter((function(e){return e.id==b}))[0]}return o=l,u&&n&&!m.attributes.region&&!m.attributes.style&&(o=shaka.text.TtmlTextParser.getElementsFromCollection_(u,"region",i,"")[0]),shaka.text.TtmlTextParser.addStyle_(h,m,o,g,y,a,e,0==s.length),h},shaka.text.TtmlTextParser.parseCueRegion_=function(e,t,r){var n=shaka.text.TtmlTextParser,a=new shaka.text.CueRegion,i=e.attributes["xml:id"];if(!i)return shaka.log.warning("TtmlTextParser parser encountered a region with no id. Region will be ignored."),null;a.id=i,i=null,r&&(i=n.percentValues_.exec(r)||n.pixelValues_.exec(r)),r=i?Number(i[1]):null,i=i?Number(i[2]):null;var o,s=n.getStyleAttributeFromRegion_(e,t,"extent");if(s){var l=(o=n.percentValues_.exec(s))||n.pixelValues_.exec(s);null!=l&&(a.width=Number(l[1]),a.height=Number(l[2]),o||(null!=r&&(a.width=100*a.width/r),null!=i&&(a.height=100*a.height/i)),a.widthUnits=o||null!=r?shaka.text.CueRegion.units.PERCENTAGE:shaka.text.CueRegion.units.PX,a.heightUnits=o||null!=i?shaka.text.CueRegion.units.PERCENTAGE:shaka.text.CueRegion.units.PX)}return(e=n.getStyleAttributeFromRegion_(e,t,"origin"))&&(null!=(l=(o=n.percentValues_.exec(e))||n.pixelValues_.exec(e))&&(a.viewportAnchorX=Number(l[1]),a.viewportAnchorY=Number(l[2]),o?s||(a.width=100-a.viewportAnchorX,a.widthUnits=shaka.text.CueRegion.units.PERCENTAGE,a.height=100-a.viewportAnchorY,a.heightUnits=shaka.text.CueRegion.units.PERCENTAGE):(null!=i&&(a.viewportAnchorY=100*a.viewportAnchorY/i),null!=r&&(a.viewportAnchorX=100*a.viewportAnchorX/r)),a.viewportAnchorUnits=o||null!=r?shaka.text.CueRegion.units.PERCENTAGE:shaka.text.CueRegion.units.PX)),a},shaka.text.TtmlTextParser.addStyle_=function(e,t,r,n,a,i,o,s){var l=shaka.text.TtmlTextParser,u=shaka.util.TXml,c=shaka.text.Cue;if(o=o||s,"rtl"==l.getStyleAttribute_(t,r,i,"direction",o)&&(e.direction=c.direction.HORIZONTAL_RIGHT_TO_LEFT),"tb"==(s=l.getStyleAttribute_(t,r,i,"writingMode",o))||"tblr"==s?e.writingMode=c.writingMode.VERTICAL_LEFT_TO_RIGHT:"tbrl"==s?e.writingMode=c.writingMode.VERTICAL_RIGHT_TO_LEFT:"rltb"==s||"rl"==s?e.direction=c.direction.HORIZONTAL_RIGHT_TO_LEFT:s&&(e.direction=c.direction.HORIZONTAL_LEFT_TO_RIGHT),(s=l.getStyleAttribute_(t,r,i,"textAlign",!0))?(e.positionAlign=l.textAlignToPositionAlign_[s],e.lineAlign=l.textAlignToLineAlign_[s],goog.asserts.assert(s.toUpperCase()in c.textAlign,s.toUpperCase()+" Should be in Cue.textAlign values!"),e.textAlign=c.textAlign[s.toUpperCase()]):e.textAlign=c.textAlign.CENTER,(s=l.getStyleAttribute_(t,r,i,"displayAlign",!0))&&(goog.asserts.assert(s.toUpperCase()in c.displayAlign,s.toUpperCase()+" Should be in Cue.displayAlign values!"),e.displayAlign=c.displayAlign[s.toUpperCase()]),(s=l.getStyleAttribute_(t,r,i,"color",o))&&(e.color=s),(s=l.getStyleAttribute_(t,r,i,"backgroundColor",o))&&(e.backgroundColor=s),(s=l.getStyleAttribute_(t,r,i,"border",o))&&(e.border=s),s=l.getStyleAttribute_(t,r,i,"fontFamily",o))switch(s){case"monospaceSerif":e.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":e.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":e.fontFamily="sans-serif";break;case"monospaceSansSerif":e.fontFamily="Consolas,monospace";break;case"proportionalSerif":e.fontFamily="serif";break;default:e.fontFamily=s}switch((s=l.getStyleAttribute_(t,r,i,"fontWeight",o))&&"bold"==s&&(e.fontWeight=c.fontWeight.BOLD),s=l.getStyleAttribute_(t,r,i,"wrapOption",o),e.wrapLine=!s||"noWrap"!=s,(s=l.getStyleAttribute_(t,r,i,"lineHeight",o))&&s.match(l.unitValues_)&&(e.lineHeight=s),(s=l.getStyleAttribute_(t,r,i,"fontSize",o))&&(s.match(l.unitValues_)||s.match(l.percentValue_))&&(e.fontSize=s),(s=l.getStyleAttribute_(t,r,i,"fontStyle",o))&&(goog.asserts.assert(s.toUpperCase()in c.fontStyle,s.toUpperCase()+" Should be in Cue.fontStyle values!"),e.fontStyle=c.fontStyle[s.toUpperCase()]),n?(a=n.attributes.imageType||n.attributes.imagetype,c=n.attributes.encoding,n=u.getTextContents(n).trim(),"PNG"==a&&"Base64"==c&&n&&(e.backgroundImage="data:image/png;base64,"+n)):a&&(e.backgroundImage=a),(n=l.getStyleAttribute_(t,r,i,"textOutline",o))&&((n=n.split(" "))[0].match(l.unitValues_)?e.textStrokeColor=e.color:(e.textStrokeColor=n[0],n.shift()),n[0]&&n[0].match(l.unitValues_)?e.textStrokeWidth=n[0]:e.textStrokeColor=""),(n=l.getStyleAttribute_(t,r,i,"letterSpacing",o))&&n.match(l.unitValues_)&&(e.letterSpacing=n),(n=l.getStyleAttribute_(t,r,i,"linePadding",o))&&n.match(l.unitValues_)&&(e.linePadding=n),(n=l.getStyleAttribute_(t,r,i,"opacity",o))&&(e.opacity=parseFloat(n)),(n=l.getStyleAttributeFromRegion_(r,i,"textDecoration"))&&l.addTextDecoration_(e,n),(n=l.getStyleAttributeFromElement_(t,i,"textDecoration"))&&l.addTextDecoration_(e,n),(n=l.getStyleAttribute_(t,r,i,"textCombine",o))&&(e.textCombineUpright=n),l.getStyleAttribute_(t,r,i,"ruby",o)){case"container":e.rubyTag="ruby";break;case"text":e.rubyTag="rt"}},shaka.text.TtmlTextParser.addTextDecoration_=function(e,t){for(var r=shaka.text.Cue,n=(t=$jscomp.makeIterator(t.split(" "))).next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes(r.textDecoration.UNDERLINE)||e.textDecoration.push(r.textDecoration.UNDERLINE);break;case"noUnderline":e.textDecoration.includes(r.textDecoration.UNDERLINE)&&shaka.util.ArrayUtils.remove(e.textDecoration,r.textDecoration.UNDERLINE);break;case"lineThrough":e.textDecoration.includes(r.textDecoration.LINE_THROUGH)||e.textDecoration.push(r.textDecoration.LINE_THROUGH);break;case"noLineThrough":e.textDecoration.includes(r.textDecoration.LINE_THROUGH)&&shaka.util.ArrayUtils.remove(e.textDecoration,r.textDecoration.LINE_THROUGH);break;case"overline":e.textDecoration.includes(r.textDecoration.OVERLINE)||e.textDecoration.push(r.textDecoration.OVERLINE);break;case"noOverline":e.textDecoration.includes(r.textDecoration.OVERLINE)&&shaka.util.ArrayUtils.remove(e.textDecoration,r.textDecoration.OVERLINE)}},shaka.text.TtmlTextParser.getStyleAttribute_=function(e,t,r,n,a){a=void 0===a||a;var i=shaka.text.TtmlTextParser;return(e=i.getStyleAttributeFromElement_(e,r,n))?e:a?i.getStyleAttributeFromRegion_(t,r,n):null},shaka.text.TtmlTextParser.getStyleAttributeFromRegion_=function(e,t,r){if(!e)return null;var n=shaka.util.TXml.getAttributeNSList(e,shaka.text.TtmlTextParser.styleNs_,r);return n||shaka.text.TtmlTextParser.getInheritedStyleAttribute_(e,t,r)},shaka.text.TtmlTextParser.getStyleAttributeFromElement_=function(e,t,r){var n=shaka.util.TXml.getAttributeNSList(e,shaka.text.TtmlTextParser.styleNs_,r);return n||shaka.text.TtmlTextParser.getInheritedStyleAttribute_(e,t,r)},shaka.text.TtmlTextParser.getInheritedStyleAttribute_=function(e,t,r){var n=shaka.util.TXml,a=shaka.text.TtmlTextParser.styleNs_,i=shaka.text.TtmlTextParser.styleEbuttsNs_;e=shaka.text.TtmlTextParser.getElementsFromCollection_(e,"style",t,"");for(var o=null,s=0;s<e.length;s++){var l=n.getAttributeNS(e[s],i,r);l||(l=n.getAttributeNSList(e[s],a,r)),l||(l=shaka.text.TtmlTextParser.getStyleAttributeFromElement_(e[s],t,r)),l&&(o=l)}return o},shaka.text.TtmlTextParser.getElementsFromCollection_=function(e,t,r,n,a){var i=[];if(!e||1>r.length)return i;if(e=shaka.text.TtmlTextParser.getInheritedAttribute_(e,t,a))for(e=e.split(" "),t=(e=$jscomp.makeIterator(e)).next();!t.done;t=e.next()){t=t.value;for(var o=(a=$jscomp.makeIterator(r)).next();!o.done;o=a.next())if(n+(o=o.value).attributes["xml:id"]==t){i.push(o);break}}return i},shaka.text.TtmlTextParser.getInheritedAttribute_=function(e,t,r){for(var n=null,a=shaka.util.TXml;!n&&!(n=r?a.getAttributeNS(e,r,t):e.attributes[t])&&(e=e.parent););return n},shaka.text.TtmlTextParser.resolveTime_=function(e,t,r,n){return e=shaka.text.TtmlTextParser.parseTime_(e,t),null==r?r=e.start:null!=e.start&&(r+=e.start),null==n?n=e.end:null!=e.start&&(n+=e.start),{start:r,end:n}},shaka.text.TtmlTextParser.parseTime_=function(e,t){var r=shaka.text.TtmlTextParser.parseTimeAttribute_(e.attributes.begin,t),n=shaka.text.TtmlTextParser.parseTimeAttribute_(e.attributes.end,t);return e=shaka.text.TtmlTextParser.parseTimeAttribute_(e.attributes.dur,t),null==n&&null!=e&&(n=r+e),{start:r,end:n}},shaka.text.TtmlTextParser.parseTimeAttribute_=function(e,t){var r=null,n=shaka.text.TtmlTextParser;if(n.timeColonFormatFrames_.test(e))r=n.parseColonTimeWithFrames_(t,e);else if(n.timeColonFormat_.test(e))r=n.parseTimeFromRegex_(n.timeColonFormat_,e);else if(n.timeColonFormatMilliseconds_.test(e))r=n.parseTimeFromRegex_(n.timeColonFormatMilliseconds_,e);else if(n.timeFramesFormat_.test(e))r=n.parseFramesTime_(t,e);else if(n.timeTickFormat_.test(e))r=n.parseTickTime_(t,e);else if(n.timeHMSFormat_.test(e))r=n.parseTimeFromRegex_(n.timeHMSFormat_,e);else if(e)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"Could not parse cue time range in TTML");return r},shaka.text.TtmlTextParser.parseFramesTime_=function(e,t){return t=shaka.text.TtmlTextParser.timeFramesFormat_.exec(t),Number(t[1])/e.frameRate},shaka.text.TtmlTextParser.parseTickTime_=function(e,t){return t=shaka.text.TtmlTextParser.timeTickFormat_.exec(t),Number(t[1])/e.tickRate},shaka.text.TtmlTextParser.parseColonTimeWithFrames_=function(e,t){t=shaka.text.TtmlTextParser.timeColonFormatFrames_.exec(t);var r=Number(t[1]),n=Number(t[2]),a=Number(t[3]),i=Number(t[4]);return(a+=(i+=(Number(t[5])||0)/e.subFrameRate)/e.frameRate)+60*n+3600*r},shaka.text.TtmlTextParser.parseTimeFromRegex_=function(e,t){return null==(e=e.exec(t))||""==e[0]?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)},shaka.text.TtmlTextParser.getCellResolution_=function(e){if(!e)return null;var t=/^(\d+) (\d+)$/.exec(e);return t?{columns:e=parseInt(t[1],10),rows:t=parseInt(t[2],10)}:null},goog.exportSymbol("shaka.text.TtmlTextParser",shaka.text.TtmlTextParser),goog.exportProperty(shaka.text.TtmlTextParser.prototype,"parseMedia",shaka.text.TtmlTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.TtmlTextParser.prototype,"setManifestType",shaka.text.TtmlTextParser.prototype.setManifestType),goog.exportProperty(shaka.text.TtmlTextParser.prototype,"setSequenceMode",shaka.text.TtmlTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.TtmlTextParser.prototype,"parseInit",shaka.text.TtmlTextParser.prototype.parseInit),shaka.text.TtmlTextParser.RateInfo_=function(e,t,r,n){this.frameRate=Number(e)||30,this.subFrameRate=Number(t)||1,this.tickRate=Number(n),0==this.tickRate&&(this.tickRate=e?this.frameRate*this.subFrameRate:1),r&&(e=/^(\d+) (\d+)$/g.exec(r))&&(this.frameRate*=Number(e[1])/Number(e[2]))},shaka.text.TtmlTextParser.percentValues_=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,shaka.text.TtmlTextParser.percentValue_=/^(\d{1,2}(?:\.\d+)?|100)%$/,shaka.text.TtmlTextParser.unitValues_=/^(\d+px|\d+em|\d*\.?\d+c)$/,shaka.text.TtmlTextParser.pixelValues_=/^(\d+)px (\d+)px$/,shaka.text.TtmlTextParser.timeColonFormatFrames_=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,shaka.text.TtmlTextParser.timeColonFormat_=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,shaka.text.TtmlTextParser.timeColonFormatMilliseconds_=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,shaka.text.TtmlTextParser.timeFramesFormat_=/^(\d*(?:\.\d*)?)f$/,shaka.text.TtmlTextParser.timeTickFormat_=/^(\d*(?:\.\d*)?)t$/,shaka.text.TtmlTextParser.timeHMSFormat_=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),shaka.text.TtmlTextParser.textAlignToLineAlign_={left:shaka.text.Cue.lineAlign.START,center:shaka.text.Cue.lineAlign.CENTER,right:shaka.text.Cue.lineAlign.END,start:shaka.text.Cue.lineAlign.START,end:shaka.text.Cue.lineAlign.END},shaka.text.TtmlTextParser.textAlignToPositionAlign_={left:shaka.text.Cue.positionAlign.LEFT,center:shaka.text.Cue.positionAlign.CENTER,right:shaka.text.Cue.positionAlign.RIGHT},shaka.text.TtmlTextParser.parameterNs_=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],shaka.text.TtmlTextParser.styleNs_=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],shaka.text.TtmlTextParser.styleEbuttsNs_="urn:ebu:tt:style",shaka.text.TtmlTextParser.smpteNsList_=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"],shaka.text.TextEngine.registerParser("application/ttml+xml",(function(){return new shaka.text.TtmlTextParser})),shaka.text.Mp4TtmlParser=function(){this.parser_=new shaka.text.TtmlTextParser},shaka.text.Mp4TtmlParser.prototype.parseInit=function(e){var t=shaka.util.Mp4Parser,r=!1;if((new t).box("moov",t.children).box("trak",t.children).box("mdia",t.children).box("minf",t.children).box("stbl",t.children).fullBox("stsd",t.sampleDescription).box("stpp",(function(e){r=!0,e.parser.stop()})).parse(e),!r)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_TTML)},shaka.text.Mp4TtmlParser.prototype.setSequenceMode=function(e){},shaka.text.Mp4TtmlParser.prototype.setManifestType=function(e){},shaka.text.Mp4TtmlParser.prototype.parseMedia=function(e,t,r){var n=this,a=shaka.util.Mp4Parser,i=!1,o=[];if((new a).box("mdat",a.allData((function(e){i=!0,o=o.concat(n.parser_.parseMedia(e,t,r))}))).parse(e,!1),!i)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_TTML);return o},goog.exportSymbol("shaka.text.Mp4TtmlParser",shaka.text.Mp4TtmlParser),goog.exportProperty(shaka.text.Mp4TtmlParser.prototype,"parseMedia",shaka.text.Mp4TtmlParser.prototype.parseMedia),goog.exportProperty(shaka.text.Mp4TtmlParser.prototype,"setManifestType",shaka.text.Mp4TtmlParser.prototype.setManifestType),goog.exportProperty(shaka.text.Mp4TtmlParser.prototype,"setSequenceMode",shaka.text.Mp4TtmlParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.Mp4TtmlParser.prototype,"parseInit",shaka.text.Mp4TtmlParser.prototype.parseInit),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.ttml"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.ttml.im1t"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.TextEngine.registerParser('application/mp4; codecs="stpp.TTML.im1t"',(function(){return new shaka.text.Mp4TtmlParser})),shaka.text.VttTextParser=function(){this.sequenceMode_=!1,this.manifestType_=shaka.media.ManifestParser.UNKNOWN},shaka.text.VttTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"VTT does not have init segments")},shaka.text.VttTextParser.prototype.setSequenceMode=function(e){this.sequenceMode_=e},shaka.text.VttTextParser.prototype.setManifestType=function(e){this.manifestType_=e},shaka.text.VttTextParser.prototype.parseMedia=function(e,t){var r=shaka.text.VttTextParser,n=(e=(e=shaka.util.StringUtils.fromUTF8(e)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_HEADER);e=t.vttOffset,n[0].includes("X-TIMESTAMP-MAP")&&this.manifestType_==shaka.media.ManifestParser.HLS&&(e=this.sequenceMode_?this.computeHlsSequenceModeOffset_(n[0],t):t.segmentStart),t=[];for(var a=$jscomp.makeIterator(n[0].split("\n")),i=a.next();!i.done;i=a.next())i=i.value,/^Region:/.test(i)&&(i=r.parseRegion_(i),t.push(i));a=new Map,r.addDefaultTextColor_(a),i=[];for(var o=(n=$jscomp.makeIterator(n.slice(1))).next();!o.done;o=n.next())o=o.value.split("\n"),r.parseStyle_(o,a),(o=r.parseCue_(o,e,t,a))&&i.push(o);return i},shaka.text.VttTextParser.prototype.computeHlsSequenceModeOffset_=function(e,t){var r=e.match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m);if(e=e.match(/MPEGTS:(\d+)/m),!r||!e)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_HEADER);if(r=new shaka.util.TextParser(r[1]),null==(r=shaka.text.VttTextParser.parseTime_(r)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_HEADER);return t.periodStart+Number(e[1])/shaka.text.VttTextParser.MPEG_TIMESCALE_-r},shaka.text.VttTextParser.addDefaultTextColor_=function(e){for(var t=$jscomp.makeIterator(Object.entries(shaka.text.Cue.defaultTextColor)),r=t.next();!r.done;r=t.next()){var n=$jscomp.makeIterator(r.value);r=n.next().value,n=n.next().value;var a=new shaka.text.Cue(0,0,"");a.color=n,e.set("."+r,a)}for(r=(t=$jscomp.makeIterator(Object.entries(shaka.text.Cue.defaultTextBackgroundColor))).next();!r.done;r=t.next())r=(n=$jscomp.makeIterator(r.value)).next().value,n=n.next().value,(a=new shaka.text.Cue(0,0,"")).backgroundColor=n,e.set("."+r,a)},shaka.text.VttTextParser.parseRegion_=function(e){var t=shaka.text.VttTextParser;e=new shaka.util.TextParser(e);var r=new shaka.text.CueRegion;e.readWord(),e.skipWhitespace();for(var n=e.readWord();n;)t.parseRegionSetting_(r,n)||shaka.log.warning("VTT parser encountered an invalid VTTRegion setting: ",n," The setting will be ignored."),e.skipWhitespace(),n=e.readWord();return r},shaka.text.VttTextParser.parseStyle_=function(e,t){if((1!=e.length||e[0])&&!/^NOTE($|[ \t])/.test(e[0])&&"STYLE"==e[0]){for(var r=[],n=-1,a=1;a<e.length;a++)e[a].includes("::cue")&&(r.push([]),n=r.length-1),-1!=n&&(r[n].push(e[a]),e[a].includes("}")&&(n=-1));for(r=(e=$jscomp.makeIterator(r)).next();!r.done;r=e.next()){a=r.value,r="global",(n=a[0].match(/\((.*)\)/))&&(r=n.pop()),n=a.slice(1,-1),a[0].includes("}")&&(a=/\{(.*?)\}/.exec(a[0]))&&(n=a[1].split(";")),(a=t.get(r))||(a=new shaka.text.Cue(0,0,""));for(var i=!1,o=0;o<n.length;o++){var s=/^\s*([^:]+):\s*(.*)/.exec(n[o]);if(s){var l=s[1].trim(),u=s[2].trim().replace(";","");switch(l){case"background-color":case"background":i=!0,a.backgroundColor=u;break;case"color":i=!0,a.color=u;break;case"font-family":i=!0,a.fontFamily=u;break;case"font-size":i=!0,a.fontSize=u;break;case"font-weight":(700<=parseInt(u,10)||"bold"==u)&&(i=!0,a.fontWeight=shaka.text.Cue.fontWeight.BOLD);break;case"font-style":switch(u){case"normal":i=!0,a.fontStyle=shaka.text.Cue.fontStyle.NORMAL;break;case"italic":i=!0,a.fontStyle=shaka.text.Cue.fontStyle.ITALIC;break;case"oblique":i=!0,a.fontStyle=shaka.text.Cue.fontStyle.OBLIQUE}break;case"opacity":i=!0,a.opacity=parseFloat(u);break;case"text-combine-upright":i=!0,a.textCombineUpright=u;break;case"text-shadow":i=!0,a.textShadow=u;break;case"white-space":i=!0,a.wrapLine="noWrap"!=u;break;default:shaka.log.warning("VTT parser encountered an unsupported style: ",s)}}}i&&t.set(r,a)}}},shaka.text.VttTextParser.parseCue_=function(e,t,r,n){var a=shaka.text.VttTextParser;if(1==e.length&&!e[0]||/^NOTE($|[ \t])/.test(e[0])||"STYLE"==e[0]||"REGION"==e[0])return null;var i=null;e[0].includes("--\x3e")||(i=e[0],e.splice(0,1));var o=new shaka.util.TextParser(e[0]),s=a.parseTime_(o),l=o.readRegex(/[ \t]+--\x3e[ \t]+/g),u=a.parseTime_(o);if(null==s||null==l||null==u)return shaka.log.alwaysWarn("Failed to parse VTT time code. Cue skipped:",i,e),null;for(s+=t,u+=t,e=e.slice(1).join("\n").trim(),n.has("global")?((t=n.get("global").clone()).startTime=s,t.endTime=u,t.payload=""):t=new shaka.text.Cue(s,u,""),o.skipWhitespace(),s=o.readWord();s;)a.parseCueSetting(t,s,r)||shaka.log.warning("VTT parser encountered an invalid VTT setting: ",s," The setting will be ignored."),o.skipWhitespace(),s=o.readWord();return a.parseCueStyles(e,t,n),null!=i&&(t.id=i),t},shaka.text.VttTextParser.parseCueStyles=function(e,t,r){var n=shaka.text.VttTextParser,a=shaka.util.StringUtils,i=shaka.util.TXml;if(e.includes("<")){0===r.size&&n.addDefaultTextColor_(r),e=n.replaceKaraokeStylePayload_(e),e=n.replaceVoiceStylePayload_(e),e=n.escapeInvalidChevrons_(e);try{var o=i.parseXmlString("<span>"+e+"</span>","span")}catch(e){shaka.log.warning("cue parse fail: ",e)}if(o)if(1!=(o=o.children).length||i.isNode(o[0]))for(a=(e=$jscomp.makeIterator(o)).next();!a.done;a=e.next())n.generateCueFromElement_(a.value,t,r);else t.payload=a.htmlUnescape(e);else shaka.log.warning("The cue's markup could not be parsed: ",e),t.payload=a.htmlUnescape(e)}else t.payload=a.htmlUnescape(e)},shaka.text.VttTextParser.escapeInvalidChevrons_=function(e){var t={"< ":""," >":" &gt;"},r=/(< +>|<\s|\s>)/g,n=RegExp(r.source);return e&&n.test(e)?e.replace(r,(function(e){return t[e]||""})):e||""},shaka.text.VttTextParser.replaceVoiceStylePayload_=function(e){for(var t=[],r=-1,n="",a=!1,i=0;i<e.length;i++)if("/"===e[i]){var o=e.indexOf(">",i);if(-1===o)return e;if((o=e.substring(i+1,o))&&"v"==o){a=!0;var s=null;if(t.length&&(s=t[t.length-1]),s){if(s===o)n+="/"+o+">";else{if(!s.startsWith("v")){n+=e[i];continue}n+="/"+s+">"}i+=o.length+1}else n+=e[i]}else n+=e[i]}else"<"===e[i]?"v"!=e[r=i+1]&&(r=-1):">"===e[i]&&0<r&&(t.push(e.substr(r,i-r)),r=-1),n+=e[i];for(t=(e=$jscomp.makeIterator(t)).next();!t.done;t=e.next())r=(t=t.value).replace(" ",".voice-"),n=(n=n.replace("<"+t+">","<"+r+">")).replace("</"+t+">","</"+r+">"),a||(n+="</"+r+">");return n},shaka.text.VttTextParser.replaceKaraokeStylePayload_=function(e){for(var t=[],r=-1,n=0;n<e.length;n++)"<"===e[n]?r=n+1:">"===e[n]&&0<r&&((r=e.substr(r,n-r)).match(shaka.text.VttTextParser.timeFormat_)&&t.push(r),r=-1);for(n=(t=$jscomp.makeIterator(t)).next();!n.done;n=t.next())n=n.value,e=e.replace("<"+n+">",'<div time="'+n+'">'),e+="</div>";return e},shaka.text.VttTextParser.getOrDefault_=function(e,t){return e&&0<e.length?e:t},shaka.text.VttTextParser.mergeStyle_=function(e,t){if(t){var r=shaka.text.VttTextParser;e.backgroundColor=r.getOrDefault_(t.backgroundColor,e.backgroundColor),e.color=r.getOrDefault_(t.color,e.color),e.fontFamily=r.getOrDefault_(t.fontFamily,e.fontFamily),e.fontSize=r.getOrDefault_(t.fontSize,e.fontSize),e.textShadow=r.getOrDefault_(t.textShadow,e.textShadow),e.fontWeight=t.fontWeight,e.fontStyle=t.fontStyle,e.opacity=t.opacity,e.rubyTag=t.rubyTag,e.textCombineUpright=t.textCombineUpright,e.wrapLine=t.wrapLine}},shaka.text.VttTextParser.generateCueFromElement_=function(e,t,r){var n=shaka.text.VttTextParser,a=shaka.util.TXml,i=t.clone();if(i.nestedCues=[],i.payload="",i.rubyTag="",i.line=null,i.region=new shaka.text.CueRegion,i.position=null,i.size=0,shaka.util.TXml.isNode(e))for(var o=shaka.text.Cue.fontWeight.BOLD,s=shaka.text.Cue.fontStyle.ITALIC,l=shaka.text.Cue.textDecoration.UNDERLINE,u=e.tagName.split(/(?=[ .])+/g),c=(u=$jscomp.makeIterator(u)).next();!c.done;c=u.next()){var d=c=c.value;if(d.startsWith(".voice-")){var p=d.split("-").pop();d='v[voice="'+p+'"]',r.has(d)||(d="v[voice="+p+"]")}switch(r.has(d)&&n.mergeStyle_(i,r.get(d)),c){case"br":return i=shaka.text.Cue.lineBreak(i.startTime,i.endTime),void t.nestedCues.push(i);case"b":i.fontWeight=o;break;case"i":i.fontStyle=s;break;case"u":i.textDecoration.push(l);break;case"font":(c=e.attributes.color)&&(i.color=c);break;case"div":if(!(c=e.attributes.time))break;c=new shaka.util.TextParser(c),(c=shaka.text.VttTextParser.parseTime_(c))&&(i.startTime=c);break;case"ruby":case"rp":case"rt":i.rubyTag=c}}if(o=e.children,shaka.util.TXml.isText(e)||1==o.length&&shaka.util.TXml.isText(o[0]))for(r=a.getTextContents(e).split("\n"),n=!0,e=(r=$jscomp.makeIterator(r)).next();!e.done;e=r.next())e=e.value,n||(n=shaka.text.Cue.lineBreak(i.startTime,i.endTime),t.nestedCues.push(n)),0<e.length&&((n=i.clone()).payload=shaka.util.StringUtils.htmlUnescape(e),t.nestedCues.push(n)),n=!1;else for(t.nestedCues.push(i),e=(t=$jscomp.makeIterator(o)).next();!e.done;e=t.next())n.generateCueFromElement_(e.value,i,r)},shaka.text.VttTextParser.parseCueSetting=function(e,t,r){var n,a=shaka.text.VttTextParser;if(n=/^align:(start|middle|center|end|left|right)$/.exec(t))a.setTextAlign_(e,n[1]);else if(n=/^vertical:(lr|rl)$/.exec(t))a.setVerticalWritingMode_(e,n[1]);else if(n=/^size:([\d.]+)%$/.exec(t))e.size=Number(n[1]);else if(n=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(t))e.position=Number(n[1]),n[2]&&a.setPositionAlign_(e,n[2]);else{if(!(n=/^region:(.*)$/.exec(t)))return a.parsedLineValueAndInterpretation_(e,t);(t=a.getRegionById_(r,n[1]))&&(e.region=t)}return!0},shaka.text.VttTextParser.getRegionById_=function(e,t){return(e=e.filter((function(e){return e.id==t}))).length?(goog.asserts.assert(1==e.length,"VTTRegion ids should be unique!"),e[0]):(shaka.log.warning("VTT parser could not find a region with id: ",t," The region will be ignored."),null)},shaka.text.VttTextParser.parseRegionSetting_=function(e,t){var r;if(r=/^id=(.*)$/.exec(t))e.id=r[1];else if(r=/^width=(\d{1,2}|100)%$/.exec(t))e.width=Number(r[1]);else if(r=/^lines=(\d+)$/.exec(t))e.height=Number(r[1]),e.heightUnits=shaka.text.CueRegion.units.LINES;else if(r=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.regionAnchorX=Number(r[1]),e.regionAnchorY=Number(r[2]);else if(r=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(t))e.viewportAnchorX=Number(r[1]),e.viewportAnchorY=Number(r[2]);else{if(!/^scroll=up$/.exec(t))return!1;e.scroll=shaka.text.CueRegion.scrollMode.UP}return!0},shaka.text.VttTextParser.setTextAlign_=function(e,t){var r=shaka.text.Cue;"middle"==t?e.textAlign=r.textAlign.CENTER:(goog.asserts.assert(t.toUpperCase()in r.textAlign,t.toUpperCase()+" Should be in Cue.textAlign values!"),e.textAlign=r.textAlign[t.toUpperCase()])},shaka.text.VttTextParser.setPositionAlign_=function(e,t){var r=shaka.text.Cue;e.positionAlign="line-left"==t||"start"==t?r.positionAlign.LEFT:"line-right"==t||"end"==t?r.positionAlign.RIGHT:"center"==t||"middle"==t?r.positionAlign.CENTER:r.positionAlign.AUTO},shaka.text.VttTextParser.setVerticalWritingMode_=function(e,t){var r=shaka.text.Cue;e.writingMode="lr"==t?r.writingMode.VERTICAL_LEFT_TO_RIGHT:r.writingMode.VERTICAL_RIGHT_TO_LEFT},shaka.text.VttTextParser.parsedLineValueAndInterpretation_=function(e,t){var r,n=shaka.text.Cue;if(r=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=n.lineInterpretation.PERCENTAGE,e.line=Number(r[1]),r[2]&&(goog.asserts.assert(r[2].toUpperCase()in n.lineAlign,r[2].toUpperCase()+" Should be in Cue.lineAlign values!"),e.lineAlign=n.lineAlign[r[2].toUpperCase()]);else{if(!(r=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t)))return!1;e.lineInterpretation=n.lineInterpretation.LINE_NUMBER,e.line=Number(r[1]),r[2]&&(goog.asserts.assert(r[2].toUpperCase()in n.lineAlign,r[2].toUpperCase()+" Should be in Cue.lineAlign values!"),e.lineAlign=n.lineAlign[r[2].toUpperCase()])}return!0},shaka.text.VttTextParser.parseTime_=function(e){if(null==(e=e.readRegex(shaka.text.VttTextParser.timeFormat_)))return null;var t=Number(e[2]),r=Number(e[3]);return 59<t||59<r?null:Number(e[4])/1e3+r+60*t+3600*(Number(e[1])||0)},goog.exportSymbol("shaka.text.VttTextParser",shaka.text.VttTextParser),goog.exportProperty(shaka.text.VttTextParser.prototype,"parseMedia",shaka.text.VttTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.VttTextParser.prototype,"setManifestType",shaka.text.VttTextParser.prototype.setManifestType),goog.exportProperty(shaka.text.VttTextParser.prototype,"setSequenceMode",shaka.text.VttTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.VttTextParser.prototype,"parseInit",shaka.text.VttTextParser.prototype.parseInit),shaka.text.VttTextParser.MPEG_TIMESCALE_=9e4,shaka.text.VttTextParser.timeFormat_=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g,shaka.text.TextEngine.registerParser("text/vtt",(function(){return new shaka.text.VttTextParser})),shaka.text.TextEngine.registerParser('text/vtt; codecs="vtt"',(function(){return new shaka.text.VttTextParser})),shaka.text.TextEngine.registerParser('text/vtt; codecs="wvtt"',(function(){return new shaka.text.VttTextParser})),shaka.text.Mp4VttParser=function(){this.timescale_=null},shaka.text.Mp4VttParser.prototype.parseInit=function(e){var t=this,r=shaka.util.Mp4Parser,n=!1;if((new r).box("moov",r.children).box("trak",r.children).box("mdia",r.children).fullBox("mdhd",(function(e){goog.asserts.assert(0==e.version||1==e.version,"MDHD version can only be 0 or 1"),e=shaka.util.Mp4BoxParsers.parseMDHD(e.reader,e.version),t.timescale_=e.timescale})).box("minf",r.children).box("stbl",r.children).fullBox("stsd",r.sampleDescription).box("wvtt",(function(e){n=!0})).parse(e),!this.timescale_)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_VTT);if(!n)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_VTT)},shaka.text.Mp4VttParser.prototype.setSequenceMode=function(e){},shaka.text.Mp4VttParser.prototype.setManifestType=function(e){},shaka.text.Mp4VttParser.prototype.parseMedia=function(e,t){if(!e.length)return[];if(!this.timescale_)throw shaka.log.error("No init segment for MP4+VTT!"),new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_VTT);var r,n=shaka.util.Mp4Parser,a=0,i=[],o=[],s=!1,l=!1,u=!1,c=null;if((new n).box("moof",n.children).box("traf",n.children).fullBox("tfdt",(function(e){s=!0,goog.asserts.assert(0==e.version||1==e.version,"TFDT version can only be 0 or 1"),a=shaka.util.Mp4BoxParsers.parseTFDTInaccurate(e.reader,e.version).baseMediaDecodeTime})).fullBox("tfhd",(function(e){goog.asserts.assert(null!=e.flags,"A TFHD box should have a valid flags value"),c=shaka.util.Mp4BoxParsers.parseTFHD(e.reader,e.flags).defaultSampleDuration})).fullBox("trun",(function(e){l=!0,goog.asserts.assert(null!=e.version,"A TRUN box should have a valid version value"),goog.asserts.assert(null!=e.flags,"A TRUN box should have a valid flags value"),i=shaka.util.Mp4BoxParsers.parseTRUN(e.reader,e.version,e.flags).sampleData})).box("mdat",n.allData((function(e){goog.asserts.assert(!u,"VTT cues in mp4 with multiple MDAT are not currently supported"),u=!0,r=e}))).parse(e,!1),!u&&!s&&!l)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_MP4_VTT);e=a,n=new shaka.util.DataViewReader(r,shaka.util.DataViewReader.Endianness.BIG_ENDIAN);for(var d=$jscomp.makeIterator(i),p=d.next();!p.done;p=d.next()){var h=(p=p.value).sampleDuration||c,f=p.sampleCompositionTimeOffset?a+p.sampleCompositionTimeOffset:e;e=f+(h||0);var m=0;do{var g=n.readUint32();m+=g;var y=n.readUint32(),v=null;"vttc"==(y=shaka.util.Mp4Parser.typeToString(y))?8<g&&(v=n.readBytes(g-8)):("vtte"!=y&&shaka.log.error("Unknown box "+y+"! Skipping!"),n.skip(g-8)),h?v&&(goog.asserts.assert(null!=this.timescale_,"Timescale should not be null!"),g=shaka.text.Mp4VttParser.parseVTTC_(v,t.periodStart+f/this.timescale_,t.periodStart+e/this.timescale_),o.push(g)):shaka.log.error("WVTT sample duration unknown, and no default found!"),goog.asserts.assert(!p.sampleSize||m<=p.sampleSize,"The samples do not fit evenly into the sample sizes given in the TRUN box!")}while(p.sampleSize&&m<p.sampleSize)}return goog.asserts.assert(!n.hasMoreData(),"MDAT which contain VTT cues and non-VTT data are not currently supported!"),o.filter(shaka.util.Functional.isNotNull)},shaka.text.Mp4VttParser.parseVTTC_=function(e,t,r){var n,a,i;return(new shaka.util.Mp4Parser).box("payl",shaka.util.Mp4Parser.allData((function(e){n=shaka.util.StringUtils.fromUTF8(e)}))).box("iden",shaka.util.Mp4Parser.allData((function(e){a=shaka.util.StringUtils.fromUTF8(e)}))).box("sttg",shaka.util.Mp4Parser.allData((function(e){i=shaka.util.StringUtils.fromUTF8(e)}))).parse(e),n?shaka.text.Mp4VttParser.assembleCue_(n,a,i,t,r):null},shaka.text.Mp4VttParser.assembleCue_=function(e,t,r,n,a){if(n=new shaka.text.Cue(n,a,""),a=new Map,shaka.text.VttTextParser.parseCueStyles(e,n,a),t&&(n.id=t),r)for(t=(e=new shaka.util.TextParser(r)).readWord();t;)shaka.text.VttTextParser.parseCueSetting(n,t,[])||shaka.log.warning("VTT parser encountered an invalid VTT setting: ",t," The setting will be ignored."),e.skipWhitespace(),t=e.readWord();return n},goog.exportSymbol("shaka.text.Mp4VttParser",shaka.text.Mp4VttParser),goog.exportProperty(shaka.text.Mp4VttParser.prototype,"parseMedia",shaka.text.Mp4VttParser.prototype.parseMedia),goog.exportProperty(shaka.text.Mp4VttParser.prototype,"setManifestType",shaka.text.Mp4VttParser.prototype.setManifestType),goog.exportProperty(shaka.text.Mp4VttParser.prototype,"setSequenceMode",shaka.text.Mp4VttParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.Mp4VttParser.prototype,"parseInit",shaka.text.Mp4VttParser.prototype.parseInit),shaka.text.TextEngine.registerParser('application/mp4; codecs="wvtt"',(function(){return new shaka.text.Mp4VttParser})),shaka.text.SbvTextParser=function(){},shaka.text.SbvTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"SubViewer does not have init segments")},shaka.text.SbvTextParser.prototype.setSequenceMode=function(e){},shaka.text.SbvTextParser.prototype.setManifestType=function(e){},shaka.text.SbvTextParser.prototype.parseMedia=function(e,t){t=shaka.text.SbvTextParser;var r=shaka.util.StringUtils.fromUTF8(e).replace(/\r+/g,"");if(e=[],""==(r=r.trim()))return e;r=r.split("\n\n");for(var n=(r=$jscomp.makeIterator(r)).next();!n.done;n=r.next()){var a=n.value.split("\n"),i=new shaka.util.TextParser(a[0]);n=t.parseTime_(i);var o=i.readRegex(/,/g);if(i=t.parseTime_(i),null==n||null==o||null==i)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.TEXT,shaka.util.Error.Code.INVALID_TEXT_CUE,"Could not parse cue time range in SubViewer");a=a.slice(1).join("\n").trim(),n=new shaka.text.Cue(n,i,a),e.push(n)}return e},shaka.text.SbvTextParser.parseTime_=function(e){if(null==(e=e.readRegex(/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g)))return null;var t=Number(e[2]),r=Number(e[3]);return 59<t||59<r?null:Number(e[4])/1e3+r+60*t+3600*(Number(e[1])||0)},goog.exportSymbol("shaka.text.SbvTextParser",shaka.text.SbvTextParser),goog.exportProperty(shaka.text.SbvTextParser.prototype,"parseMedia",shaka.text.SbvTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.SbvTextParser.prototype,"setManifestType",shaka.text.SbvTextParser.prototype.setManifestType),goog.exportProperty(shaka.text.SbvTextParser.prototype,"setSequenceMode",shaka.text.SbvTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.SbvTextParser.prototype,"parseInit",shaka.text.SbvTextParser.prototype.parseInit),shaka.text.TextEngine.registerParser("text/x-subviewer",(function(){return new shaka.text.SbvTextParser})),shaka.text.SrtTextParser=function(){this.parser_=new shaka.text.VttTextParser},shaka.text.SrtTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"SRT does not have init segments")},shaka.text.SrtTextParser.prototype.setSequenceMode=function(e){},shaka.text.SrtTextParser.prototype.setManifestType=function(e){},shaka.text.SrtTextParser.prototype.parseMedia=function(e,t,r){var n=shaka.text.SrtTextParser,a=shaka.util.BufferUtils,i=shaka.util.StringUtils;return e=i.fromUTF8(e),n=n.srt2webvtt(e),a=a.toUint8(i.toUTF8(n)),this.parser_.parseMedia(a,t,r)},shaka.text.SrtTextParser.srt2webvtt=function(e){var t=shaka.text.SrtTextParser,r="WEBVTT\n\n";if(""==e)return r;e=(e=(e=e.replace(/\r+/g,"")).trim()).split("\n\n");for(var n=(e=$jscomp.makeIterator(e)).next();!n.done;n=e.next())r+=t.convertSrtCue_(n.value);return r},shaka.text.SrtTextParser.convertSrtCue_=function(e){return(e=e.split(/\n/))[0].match(/\d+/)&&e.shift(),e[0]=e[0].replace(/,/g,"."),e.join("\n").replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+"\n\n"},goog.exportSymbol("shaka.text.SrtTextParser",shaka.text.SrtTextParser),goog.exportProperty(shaka.text.SrtTextParser,"srt2webvtt",shaka.text.SrtTextParser.srt2webvtt),goog.exportProperty(shaka.text.SrtTextParser.prototype,"parseMedia",shaka.text.SrtTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.SrtTextParser.prototype,"setManifestType",shaka.text.SrtTextParser.prototype.setManifestType),goog.exportProperty(shaka.text.SrtTextParser.prototype,"setSequenceMode",shaka.text.SrtTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.SrtTextParser.prototype,"parseInit",shaka.text.SrtTextParser.prototype.parseInit),shaka.text.TextEngine.registerParser("text/srt",(function(){return new shaka.text.SrtTextParser})),shaka.text.SsaTextParser=function(){},shaka.text.SsaTextParser.prototype.parseInit=function(e){goog.asserts.assert(!1,"SSA does not have init segments")},shaka.text.SsaTextParser.prototype.setSequenceMode=function(e){},shaka.text.SsaTextParser.prototype.setManifestType=function(e){},shaka.text.SsaTextParser.prototype.parseMedia=function(e,t){t=shaka.text.SsaTextParser;var r="",n="";e=shaka.util.StringUtils.fromUTF8(e).split(/\r?\n\s*\r?\n/);for(var a=(e=$jscomp.makeIterator(e)).next();!a.done;a=e.next()){a=a.value;var i=t.ssaContent_.exec(a);if(i){var o=i[1];if(i=i[2],"V4 Styles"==o||"V4+ Styles"==o){r=i;continue}if("Events"==o){n=i;continue}}shaka.log.warning("SsaTextParser parser encountered an unknown part.",a)}for(e=[],a=null,r=r.split(/\r?\n/),i=(r=$jscomp.makeIterator(r)).next();!i.done;i=r.next())if(o=i.value,!/^\s*;/.test(o)&&(i=t.lineParts_.exec(o)))if(o=i[1].trim(),i=i[2].trim(),"Format"==o)a=i.split(t.valuesFormat_);else if("Style"==o){o=i.split(t.valuesFormat_),i={};for(var s=0;s<a.length&&s<o.length;s++)i[a[s]]=o[s];e.push(i)}for(a=[],r=null,o=n.split(/\r?\n/),n={},i=(o=$jscomp.makeIterator(o)).next();!i.done;n={$jscomp$loop$prop$styleName$927:n.$jscomp$loop$prop$styleName$927},i=o.next())if(i=i.value,!/^\s*;/.test(i)&&(s=t.lineParts_.exec(i)))if(i=s[1].trim(),s=s[2].trim(),"Format"==i)r=s.split(t.valuesFormat_);else if("Dialogue"==i){s=s.split(t.valuesFormat_),i={};for(var l=0;l<r.length&&l<s.length;l++)i[r[l]]=s[l];l=t.parseTime_(i.Start);var u=t.parseTime_(i.End);s=s.slice(r.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,""),s=new shaka.text.Cue(l,u,s),n.$jscomp$loop$prop$styleName$927=i.Style,(i=e.find(function(e){return function(t){return t.Name==e.$jscomp$loop$prop$styleName$927}}(n)))&&t.addStyle_(s,i),a.push(s)}return a},shaka.text.SsaTextParser.addStyle_=function(e,t){var r=shaka.text.Cue,n=shaka.text.SsaTextParser,a=t.Fontname;if(a&&(e.fontFamily=a),(a=t.Fontsize)&&(e.fontSize=a+"px"),(a=t.PrimaryColour)&&(a=n.parseSsaColor_(a))&&(e.color=a),(a=t.BackColour)&&(n=n.parseSsaColor_(a))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=r.fontWeight.BOLD),t.Italic&&(e.fontStyle=r.fontStyle.ITALIC),t.Underline&&e.textDecoration.push(r.textDecoration.UNDERLINE),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=r.displayAlign.AFTER,e.textAlign=r.textAlign.START;break;case 2:e.displayAlign=r.displayAlign.AFTER,e.textAlign=r.textAlign.CENTER;break;case 3:e.displayAlign=r.displayAlign.AFTER,e.textAlign=r.textAlign.END;break;case 5:e.displayAlign=r.displayAlign.BEFORE,e.textAlign=r.textAlign.START;break;case 6:e.displayAlign=r.displayAlign.BEFORE,e.textAlign=r.textAlign.CENTER;break;case 7:e.displayAlign=r.displayAlign.BEFORE,e.textAlign=r.textAlign.END;break;case 9:e.displayAlign=r.displayAlign.CENTER,e.textAlign=r.textAlign.START;break;case 10:e.displayAlign=r.displayAlign.CENTER,e.textAlign=r.textAlign.CENTER;break;case 11:e.displayAlign=r.displayAlign.CENTER,e.textAlign=r.textAlign.END}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))},shaka.text.SsaTextParser.parseSsaColor_=function(e){return 0<=(e=parseInt(e.replace("&H",""),16))?"rgba("+(255&e)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null},shaka.text.SsaTextParser.parseTime_=function(e){var t=shaka.text.SsaTextParser.timeFormat_.exec(e);return 3600*(e=t[1]?parseInt(t[1].replace(":",""),10):0)+60*parseInt(t[2],10)+(t=parseFloat(t[3]))},goog.exportSymbol("shaka.text.SsaTextParser",shaka.text.SsaTextParser),goog.exportProperty(shaka.text.SsaTextParser.prototype,"parseMedia",shaka.text.SsaTextParser.prototype.parseMedia),goog.exportProperty(shaka.text.SsaTextParser.prototype,"setManifestType",shaka.text.SsaTextParser.prototype.setManifestType),goog.exportProperty(shaka.text.SsaTextParser.prototype,"setSequenceMode",shaka.text.SsaTextParser.prototype.setSequenceMode),goog.exportProperty(shaka.text.SsaTextParser.prototype,"parseInit",shaka.text.SsaTextParser.prototype.parseInit),shaka.text.SsaTextParser.ssaContent_=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,shaka.text.SsaTextParser.lineParts_=/^\s*([^:]+):\s*(.*)/,shaka.text.SsaTextParser.valuesFormat_=/\s*,\s*/,shaka.text.SsaTextParser.timeFormat_=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/,shaka.text.TextEngine.registerParser("text/x-ssa",(function(){return new shaka.text.SsaTextParser})),shaka.transmuxer.ADTS=function(){},shaka.transmuxer.ADTS.parseHeader=function(e,t){var r=shaka.transmuxer.ADTS,n=r.getHeaderLength(e,t);return t+n<=e.length&&0<(e=r.getFullFrameLength(e,t)-n)?{headerLength:n,frameLength:e}:null},shaka.transmuxer.ADTS.parseInfo=function(e,t){var r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],n=(60&e[t+2])>>>2;if(n>r.length-1)return null;var a=1+((192&e[t+2])>>>6),i=(1&e[t+2])<<2;return i|=(192&e[t+3])>>>6,{sampleRate:r[n],channelCount:i,codec:"mp4a.40."+a}},shaka.transmuxer.ADTS.isHeaderPattern=function(e,t){return 255===e[t]&&240==(246&e[t+1])},shaka.transmuxer.ADTS.getHeaderLength=function(e,t){return 1&e[t+1]?7:9},shaka.transmuxer.ADTS.getFullFrameLength=function(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5},shaka.transmuxer.ADTS.isHeader=function(e,t){var r=shaka.transmuxer.ADTS;return t+1<e.length&&r.isHeaderPattern(e,t)},shaka.transmuxer.ADTS.probe=function(e,t){var r=shaka.transmuxer.ADTS;if(r.isHeader(e,t)){var n=r.getHeaderLength(e,t);if(t+n>=e.length)return!1;var a=r.getFullFrameLength(e,t);return!(a<=n)&&((t+=a)===e.length||r.isHeader(e,t))}return!1},shaka.transmuxer.ADTS.getFrameDuration=function(e){return 9e4*shaka.transmuxer.ADTS.AAC_SAMPLES_PER_FRAME/e},shaka.transmuxer.ADTS.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t||3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},shaka.transmuxer.ADTS.AAC_SAMPLES_PER_FRAME=1024,shaka.transmuxer.AacTransmuxer=function(e){this.originalMimeType_=e,this.frameIndex_=0,this.initSegments=new Map},shaka.transmuxer.AacTransmuxer.prototype.destroy=function(){this.initSegments.clear()},shaka.transmuxer.AacTransmuxer.prototype.isSupported=function(e,t){return t=shaka.media.Capabilities,!!this.isAacContainer_(e)&&t.isTypeSupported(this.convertCodecs(shaka.util.ManifestParserUtils.ContentType.AUDIO,e))},shaka.transmuxer.AacTransmuxer.prototype.isAacContainer_=function(e){return"audio/aac"==e.toLowerCase().split(";")[0]},shaka.transmuxer.AacTransmuxer.prototype.convertCodecs=function(e,t){return this.isAacContainer_(t)?'audio/mp4; codecs="'+(shaka.util.MimeUtils.getCodecs(t)||"mp4a.40.2")+'"':t},shaka.transmuxer.AacTransmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.AacTransmuxer.prototype.transmux=function(e,t,r,n){for(var a=shaka.transmuxer.ADTS,i=shaka.util.Uint8ArrayUtils,o=shaka.util.BufferUtils.toUint8(e),s=shaka.util.Id3Utils.getID3Data(o),l=s.length;l<o.length&&!a.probe(o,l);l++);if(e=1e3*r.endTime,(s=shaka.util.Id3Utils.getID3Frames(s)).length&&r&&(r=s.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(e=r.data),!(r=a.parseInfo(o,l)))return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED));for(t.audioSamplingRate=r.sampleRate,t.channelsCount=r.channelCount,s=[];l<o.length;){var u=a.parseHeader(o,l);if(!u)return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED));var c=u.headerLength+u.frameLength;if(l+c<=o.length){var d=o.subarray(l+u.headerLength,l+c);s.push({data:d,size:u.frameLength,duration:a.AAC_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}})}l+=c}return a=r.sampleRate,e=Math.floor(e*a/1e3),n={id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:r.codec,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:a,duration:n,videoNalus:[],audioConfig:new Uint8Array([]),videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:e,samples:s},stream:t},a=new shaka.util.Mp4Generator([n]),this.initSegments.has(t.id)?n=this.initSegments.get(t.id):(n=a.initSegment(),this.initSegments.set(t.id,n)),t=a.segmentData(),this.frameIndex_++,i=i.concat(n,t),Promise.resolve(i)},goog.exportSymbol("shaka.transmuxer.AacTransmuxer",shaka.transmuxer.AacTransmuxer),goog.exportProperty(shaka.transmuxer.AacTransmuxer.prototype,"transmux",shaka.transmuxer.AacTransmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.AacTransmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.AacTransmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.AacTransmuxer.prototype,"convertCodecs",shaka.transmuxer.AacTransmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.AacTransmuxer.prototype,"isSupported",shaka.transmuxer.AacTransmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.AacTransmuxer.prototype,"destroy",shaka.transmuxer.AacTransmuxer.prototype.destroy),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("audio/aac",(function(){return new shaka.transmuxer.AacTransmuxer("audio/aac")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.FALLBACK),shaka.transmuxer.Ac3=function(){},shaka.transmuxer.Ac3.parseFrame=function(e,t){if(t+8>e.length||11!==e[t]||119!==e[t+1])return null;var r=e[t+4]>>6;if(3<=r)return null;var n=63&e[t+4],a=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*n+r];if(t+a>e.length)return null;var i=e[t+6]>>5,o=0;2===i?o+=2:(1&i&&1!==i&&(o+=2),4&i&&(o+=2)),o=(e[t+6]<<8|e[t+7])>>12-o&1;var s=7&e[t+5];return e=new Uint8Array([r<<6|e[t+5]>>3<<1|s>>2,(3&s)<<6|i<<3|o<<2|n>>4,n<<4&224]),{sampleRate:[48e3,44100,32e3][r],channelCount:[2,1,2,3,3,4,4,5][i]+o,audioConfig:e,frameLength:a}},shaka.transmuxer.Ac3.probe=function(e,t){if(11===e[t]&&119===e[t+1]){var r,n,a=0,i=5;for(t+=i;0<i;){n=e[t];var o=Math.min(i,8),s=8-o;r=(n&(r=4278190080>>>24+s<<s))>>s,a=a?a<<o|r:r,t+=1,i-=o}if(16>a)return!0}return!1},shaka.transmuxer.Ac3.AC3_SAMPLES_PER_FRAME=1536,shaka.transmuxer.Ac3Transmuxer=function(e){this.originalMimeType_=e,this.frameIndex_=0,this.initSegments=new Map},shaka.transmuxer.Ac3Transmuxer.prototype.destroy=function(){this.initSegments.clear()},shaka.transmuxer.Ac3Transmuxer.prototype.isSupported=function(e,t){return t=shaka.media.Capabilities,!!this.isAc3Container_(e)&&t.isTypeSupported(this.convertCodecs(shaka.util.ManifestParserUtils.ContentType.AUDIO,e))},shaka.transmuxer.Ac3Transmuxer.prototype.isAc3Container_=function(e){return"audio/ac3"==e.toLowerCase().split(";")[0]},shaka.transmuxer.Ac3Transmuxer.prototype.convertCodecs=function(e,t){return this.isAc3Container_(t)?'audio/mp4; codecs="ac-3"':t},shaka.transmuxer.Ac3Transmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.Ac3Transmuxer.prototype.transmux=function(e,t,r,n){var a=shaka.transmuxer.Ac3,i=shaka.util.Uint8ArrayUtils;e=shaka.util.BufferUtils.toUint8(e);for(var o=shaka.util.Id3Utils.getID3Data(e),s=o.length;s<e.length&&!a.probe(e,s);s++);var l=1e3*r.endTime;(o=shaka.util.Id3Utils.getID3Frames(o)).length&&r&&(r=o.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(l=r.data),r=0,o=new Uint8Array([]);for(var u=[];s<e.length;){var c=a.parseFrame(e,s);if(!c)return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED));t.audioSamplingRate=c.sampleRate,t.channelsCount=c.channelCount,r=c.sampleRate,o=c.audioConfig;var d=e.subarray(s,s+c.frameLength);u.push({data:d,size:c.frameLength,duration:a.AC3_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),s+=c.frameLength}return a=Math.floor(l*r/1e3),n={id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:n,videoNalus:[],audioConfig:o,videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:a,samples:u},stream:t},a=new shaka.util.Mp4Generator([n]),this.initSegments.has(t.id)?n=this.initSegments.get(t.id):(n=a.initSegment(),this.initSegments.set(t.id,n)),t=a.segmentData(),this.frameIndex_++,i=i.concat(n,t),Promise.resolve(i)},goog.exportSymbol("shaka.transmuxer.Ac3Transmuxer",shaka.transmuxer.Ac3Transmuxer),goog.exportProperty(shaka.transmuxer.Ac3Transmuxer.prototype,"transmux",shaka.transmuxer.Ac3Transmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.Ac3Transmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.Ac3Transmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.Ac3Transmuxer.prototype,"convertCodecs",shaka.transmuxer.Ac3Transmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.Ac3Transmuxer.prototype,"isSupported",shaka.transmuxer.Ac3Transmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.Ac3Transmuxer.prototype,"destroy",shaka.transmuxer.Ac3Transmuxer.prototype.destroy),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("audio/ac3",(function(){return new shaka.transmuxer.Ac3Transmuxer("audio/ac3")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.FALLBACK),shaka.transmuxer.Ec3=function(){},shaka.transmuxer.Ec3.parseFrame=function(e,t){if(t+8>e.length||!shaka.transmuxer.Ec3.probe(e,t))return null;var r=new shaka.util.ExpGolomb(e.subarray(t+2));r.skipBits(2),r.skipBits(3);var n=r.readBits(11)+1<<1,a=r.readBits(2);if(3==a){a=[24e3,22060,16e3][a=r.readBits(2)];var i=3}else a=[48e3,44100,32e3][a],i=r.readBits(2);var o=r.readBits(3),s=r.readBits(1);return r=r.readBits(5),t+n>e.byteLength?null:(e=Math.floor(n*a/(16*[1,2,3,6][i])),e=new Uint8Array([(8160&e)>>5,(31&e)<<3,a<<6|r<<1|0,0|o<<1|s<<0,0]),{sampleRate:a,channelCount:[2,1,2,3,3,4,4,5][o]+s,audioConfig:e,frameLength:n})},shaka.transmuxer.Ec3.probe=function(e,t){return 2935==(e[t]<<8|e[t+1]<<0)},shaka.transmuxer.Ec3.EC3_SAMPLES_PER_FRAME=1536,shaka.transmuxer.Ec3Transmuxer=function(e){this.originalMimeType_=e,this.frameIndex_=0,this.initSegments=new Map},shaka.transmuxer.Ec3Transmuxer.prototype.destroy=function(){this.initSegments.clear()},shaka.transmuxer.Ec3Transmuxer.prototype.isSupported=function(e,t){return t=shaka.media.Capabilities,!!this.isEc3Container_(e)&&t.isTypeSupported(this.convertCodecs(shaka.util.ManifestParserUtils.ContentType.AUDIO,e))},shaka.transmuxer.Ec3Transmuxer.prototype.isEc3Container_=function(e){return"audio/ec3"==e.toLowerCase().split(";")[0]},shaka.transmuxer.Ec3Transmuxer.prototype.convertCodecs=function(e,t){return this.isEc3Container_(t)?'audio/mp4; codecs="ec-3"':t},shaka.transmuxer.Ec3Transmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.Ec3Transmuxer.prototype.transmux=function(e,t,r,n){var a=shaka.transmuxer.Ec3,i=shaka.util.Uint8ArrayUtils;e=shaka.util.BufferUtils.toUint8(e);for(var o=shaka.util.Id3Utils.getID3Data(e),s=o.length;s<e.length&&!a.probe(e,s);s++);var l=1e3*r.endTime;(o=shaka.util.Id3Utils.getID3Frames(o)).length&&r&&(r=o.find((function(e){return"com.apple.streaming.transportStreamTimestamp"===e.description})))&&(l=r.data),r=0,o=new Uint8Array([]);for(var u=[];s<e.length;){var c=a.parseFrame(e,s);if(!c)return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED));t.audioSamplingRate=c.sampleRate,t.channelsCount=c.channelCount,r=c.sampleRate,o=c.audioConfig;var d=e.subarray(s,s+c.frameLength);u.push({data:d,size:c.frameLength,duration:a.EC3_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),s+=c.frameLength}return a=Math.floor(l*r/1e3),n={id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:r,duration:n,videoNalus:[],audioConfig:o,videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:a,samples:u},stream:t},a=new shaka.util.Mp4Generator([n]),this.initSegments.has(t.id)?n=this.initSegments.get(t.id):(n=a.initSegment(),this.initSegments.set(t.id,n)),t=a.segmentData(),this.frameIndex_++,i=i.concat(n,t),Promise.resolve(i)},goog.exportSymbol("shaka.transmuxer.Ec3Transmuxer",shaka.transmuxer.Ec3Transmuxer),goog.exportProperty(shaka.transmuxer.Ec3Transmuxer.prototype,"transmux",shaka.transmuxer.Ec3Transmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.Ec3Transmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.Ec3Transmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.Ec3Transmuxer.prototype,"convertCodecs",shaka.transmuxer.Ec3Transmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.Ec3Transmuxer.prototype,"isSupported",shaka.transmuxer.Ec3Transmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.Ec3Transmuxer.prototype,"destroy",shaka.transmuxer.Ec3Transmuxer.prototype.destroy),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("audio/ec3",(function(){return new shaka.transmuxer.Ec3Transmuxer("audio/ec3")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.FALLBACK),shaka.transmuxer.H264=function(){},shaka.transmuxer.H264.parseInfo=function(e){var t=shaka.transmuxer.H264;if(!e.length)return null;var r=e.find((function(e){return e.type==t.NALU_TYPE_SPS_}));if(e=e.find((function(e){return e.type==t.NALU_TYPE_PPS_})),!r||!e)return null;var n=new shaka.util.ExpGolomb(r.data),a=n.readUnsignedByte();if(n.readUnsignedByte(),n.readUnsignedByte(),n.skipExpGolomb(),t.PROFILES_WITH_OPTIONAL_SPS_DATA_.includes(a)&&(3===(a=n.readUnsignedExpGolomb())&&n.skipBits(1),n.skipExpGolomb(),n.skipExpGolomb(),n.skipBits(1),n.readBoolean())){a=3!==a?8:12;for(var i=0;i<a;i++)n.readBoolean()&&(6>i?n.skipScalingList(16):n.skipScalingList(64))}if(n.skipExpGolomb(),0===(a=n.readUnsignedExpGolomb()))n.readUnsignedExpGolomb();else if(1===a)for(n.skipBits(1),n.skipExpGolomb(),n.skipExpGolomb(),a=n.readUnsignedExpGolomb(),i=0;i<a;i++)n.skipExpGolomb();n.skipExpGolomb(),n.skipBits(1);var o=n.readUnsignedExpGolomb(),s=n.readUnsignedExpGolomb(),l=n.readBits(1);0===l&&n.skipBits(1),n.skipBits(1);var u=0,c=0,d=0,p=0;if(n.readBoolean()&&(u=n.readUnsignedExpGolomb(),c=n.readUnsignedExpGolomb(),d=n.readUnsignedExpGolomb(),p=n.readUnsignedExpGolomb()),i=a=1,n.readBoolean()&&n.readBoolean()){var h=n.readUnsignedByte();0<h&&16>=h?(a=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][h-1],i=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][h-1]):255===h&&(a=n.readBits(16),i=n.readBits(16))}return n=(2-l)*(s+1)*16-2*d-2*p,o=16*(o+1)-2*u-2*c,u=[],r=r.fullData,u.push(r.byteLength>>>8&255),u.push(255&r.byteLength),u=u.concat.apply(u,$jscomp.arrayFromIterable(r)),r=[],e=e.fullData,r.push(e.byteLength>>>8&255),r.push(255&e.byteLength),r=r.concat.apply(r,$jscomp.arrayFromIterable(e)),{height:n,width:o,videoConfig:e=new Uint8Array([1,u[3],u[4],u[5],255,225].concat(u).concat([1]).concat(r)),hSpacing:a,vSpacing:i}},shaka.transmuxer.H264.parseFrame=function(e){for(var t=shaka.transmuxer.H264,r=!1,n=[],a=e.find((function(e){return e.type==t.NALU_TYPE_SPS_})),i=!1,o=(e=$jscomp.makeIterator(e)).next();!o.done;o=e.next()){var s=!1;switch((o=o.value).type){case t.NALU_TYPE_NDR_:s=i=!0;var l=o.data;a&&4<l.length&&(2===(l=new shaka.util.ExpGolomb(l).readSliceType())||4===l||7===l||9===l)&&(r=!0);break;case t.NALU_TYPE_IDR_:r=s=i=!0;break;case t.NALU_TYPE_SEI_:case t.NALU_TYPE_SPS_:case t.NALU_TYPE_PPS_:s=!0;break;case t.NALU_TYPE_AUD_:i=s=!0;break;case t.NALU_TYPE_FILLER_DATA_:s=!0;break;default:s=!1}i&&s&&(s=o.fullData.byteLength,(l=new Uint8Array(4))[0]=s>>24&255,l[1]=s>>16&255,l[2]=s>>8&255,l[3]=255&s,n.push(l),n.push(o.fullData))}return n.length?{data:shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(n)),isKeyframe:r}:null},shaka.transmuxer.H264.NALU_TYPE_NDR_=1,shaka.transmuxer.H264.NALU_TYPE_IDR_=5,shaka.transmuxer.H264.NALU_TYPE_SEI_=6,shaka.transmuxer.H264.NALU_TYPE_SPS_=7,shaka.transmuxer.H264.NALU_TYPE_PPS_=8,shaka.transmuxer.H264.NALU_TYPE_AUD_=9,shaka.transmuxer.H264.NALU_TYPE_FILLER_DATA_=12,shaka.transmuxer.H264.PROFILES_WITH_OPTIONAL_SPS_DATA_=[100,110,122,244,44,83,86,118,128,138,139,134],shaka.transmuxer.H265=function(){},shaka.transmuxer.H265.parseInfo=function(e){var t=shaka.transmuxer.H265;if(!e.length)return null;var r=e.find((function(e){return e.type==t.NALU_TYPE_VPS_})),n=e.find((function(e){return e.type==t.NALU_TYPE_SPS_})),a=e.find((function(e){return e.type==t.NALU_TYPE_PPS_}));if(!r||!n||!a)return null;var i=t.parseVPS_(r.fullData);e=t.parseSPS_(n.fullData);var o=t.parsePPS_(a.fullData);return r=t.getVideoConfiguration_(r.fullData,n.fullData,a.fullData,{numTemporalLayers:i.numTemporalLayers,temporalIdNested:i.temporalIdNested,generalProfileSpace:e.generalProfileSpace,generalTierFlag:e.generalTierFlag,generalLevelIdc:e.generalLevelIdc,generalProfileIdc:e.generalProfileIdc,generalProfileCompatibilityFlags1:e.generalProfileCompatibilityFlags1,generalProfileCompatibilityFlags2:e.generalProfileCompatibilityFlags2,generalProfileCompatibilityFlags3:e.generalProfileCompatibilityFlags3,generalProfileCompatibilityFlags4:e.generalProfileCompatibilityFlags4,generalConstraintIndicatorFlags1:e.generalConstraintIndicatorFlags1,generalConstraintIndicatorFlags2:e.generalConstraintIndicatorFlags2,generalConstraintIndicatorFlags3:e.generalConstraintIndicatorFlags3,generalConstraintIndicatorFlags4:e.generalConstraintIndicatorFlags4,generalConstraintIndicatorFlags5:e.generalConstraintIndicatorFlags5,generalConstraintIndicatorFlags6:e.generalConstraintIndicatorFlags6,constantFrameRate:e.constantFrameRate,minSpatialSegmentationIdc:e.minSpatialSegmentationIdc,chromaFormatIdc:e.chromaFormatIdc,bitDepthLumaMinus8:e.bitDepthLumaMinus8,bitDepthChromaMinus8:e.bitDepthChromaMinus8,parallelismType:o.parallelismType}),{height:e.height,width:e.width,videoConfig:r,hSpacing:e.sarWidth,vSpacing:e.sarHeight}},shaka.transmuxer.H265.parseVPS_=function(e){var t=new shaka.util.ExpGolomb(e,!0);return t.readUnsignedByte(),t.readUnsignedByte(),t.readBits(4),t.readBits(2),t.readBits(6),{numTemporalLayers:(e=t.readBits(3))+1,temporalIdNested:t=t.readBoolean()}},shaka.transmuxer.H265.parseSPS_=function(e){(e=new shaka.util.ExpGolomb(e,!0)).readUnsignedByte(),e.readUnsignedByte();var t=0,r=0,n=0,a=0;e.readBits(4);var i=e.readBits(3);e.readBoolean();for(var o=e.readBits(2),s=e.readBits(1),l=e.readBits(5),u=e.readUnsignedByte(),c=e.readUnsignedByte(),d=e.readUnsignedByte(),p=e.readUnsignedByte(),h=e.readUnsignedByte(),f=e.readUnsignedByte(),m=e.readUnsignedByte(),g=e.readUnsignedByte(),y=e.readUnsignedByte(),v=e.readUnsignedByte(),_=e.readUnsignedByte(),k=[],E=[],b=0;b<i;b++)k.push(e.readBoolean()),E.push(e.readBoolean());if(0<i)for(b=i;8>b;b++)e.readBits(2);for(b=0;b<i;b++)k[b]&&e.readBits(88),E[b]&&e.readUnsignedByte();e.readUnsignedExpGolomb(),3==(k=e.readUnsignedExpGolomb())&&e.readBits(1),E=e.readUnsignedExpGolomb(),b=e.readUnsignedExpGolomb(),e.readBoolean()&&(t+=e.readUnsignedExpGolomb(),r+=e.readUnsignedExpGolomb(),n+=e.readUnsignedExpGolomb(),a+=e.readUnsignedExpGolomb());var T=e.readUnsignedExpGolomb(),A=e.readUnsignedExpGolomb(),S=e.readUnsignedExpGolomb();if(e.readBoolean())for(var C=0;C<=i;C++)e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb();else e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb();if(e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readBoolean()&&e.readBoolean())for(C=0;4>C;C++)for(var P=0;P<(3===C?2:6);P++)if(e.readBoolean()){var x=Math.min(64,1<<4+(C<<1));1<C&&e.readExpGolomb();for(var w=0;w<x;w++)e.readExpGolomb()}else e.readUnsignedExpGolomb();for(e.readBoolean(),e.readBoolean(),e.readBoolean()&&(e.readUnsignedByte(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readBoolean()),C=e.readUnsignedExpGolomb(),x=P=0;x<C;x++)if(w=!1,0!==x&&(w=e.readBoolean()),w){x===C&&e.readUnsignedExpGolomb(),e.readBoolean(),e.readUnsignedExpGolomb();for(var I=w=0;I<=P;I++){var M=e.readBoolean(),R=!1;M||(R=e.readBoolean()),(M||R)&&w++}P=w}else{for(P=(I=e.readUnsignedExpGolomb())+(w=e.readUnsignedExpGolomb()),M=0;M<I;M++)e.readUnsignedExpGolomb(),e.readBoolean();for(I=0;I<w;I++)e.readUnsignedExpGolomb(),e.readBoolean()}if(e.readBoolean())for(C=e.readUnsignedExpGolomb(),P=0;P<C;P++){for(x=0;x<S+4;x++)e.readBits(1);e.readBits(1)}if(C=S=1,P=0,e.readBoolean(),e.readBoolean(),e.readBoolean()){if(e.readBoolean()&&(w=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],I=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1],0<(x=e.readUnsignedByte())&&16>=x?(S=w[x-1],C=I[x-1]):255===x&&(S=e.readBits(16),C=e.readBits(16))),e.readBoolean()&&e.readBoolean(),e.readBoolean()&&(e.readBits(3),e.readBoolean(),e.readBoolean()&&(e.readUnsignedByte(),e.readUnsignedByte(),e.readUnsignedByte())),e.readBoolean()&&(e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb()),e.readBoolean(),e.readBoolean(),e.readBoolean(),(x=e.readBoolean())&&(e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb()),e.readBoolean()&&(e.readBits(32),e.readBits(32),e.readBoolean()&&e.readUnsignedExpGolomb(),e.readBoolean()))for(I=!1,x=e.readBoolean(),w=e.readBoolean(),(x||w)&&((I=e.readBoolean())&&(e.readUnsignedByte(),e.readBits(5),e.readBoolean(),e.readBits(5)),e.readBits(4),e.readBits(4),I&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5)),M=0;M<=i;M++){var D=!0;R=1,e.readBoolean()||(D=e.readBoolean());var O=!1;if(D?e.readUnsignedExpGolomb():O=e.readBoolean(),O||(R=e.readUnsignedExpGolomb()+1),x){for(D=0;D<R;D++)e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),I&&(e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb());e.readBoolean()}if(w){for(D=0;D<R;D++)e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),I&&(e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb());e.readBoolean()}}e.readBoolean()&&(e.readBoolean(),e.readBoolean(),e.readBoolean(),P=e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb(),e.readUnsignedExpGolomb())}return{generalLevelIdc:_,generalProfileSpace:o,generalTierFlag:s,generalProfileIdc:l,generalProfileCompatibilityFlags1:u,generalProfileCompatibilityFlags2:c,generalProfileCompatibilityFlags3:d,generalProfileCompatibilityFlags4:p,generalConstraintIndicatorFlags1:h,generalConstraintIndicatorFlags2:f,generalConstraintIndicatorFlags3:m,generalConstraintIndicatorFlags4:g,generalConstraintIndicatorFlags5:y,generalConstraintIndicatorFlags6:v,minSpatialSegmentationIdc:P,constantFrameRate:0,chromaFormatIdc:k,bitDepthLumaMinus8:T,bitDepthChromaMinus8:A,width:E-(t+r)*(1===k||2===k?2:1),height:b-(n+a)*(1===k?2:1),sarWidth:S,sarHeight:C}},shaka.transmuxer.H265.parsePPS_=function(e){var t=new shaka.util.ExpGolomb(e,!0);t.readUnsignedByte(),t.readUnsignedByte(),t.readUnsignedExpGolomb(),t.readUnsignedExpGolomb(),t.readBoolean(),t.readBoolean(),t.readBits(3),t.readBoolean(),t.readBoolean(),t.readUnsignedExpGolomb(),t.readUnsignedExpGolomb(),t.readExpGolomb(),t.readBoolean(),t.readBoolean(),t.readBoolean()&&t.readUnsignedExpGolomb(),t.readExpGolomb(),t.readExpGolomb(),t.readBoolean(),t.readBoolean(),t.readBoolean(),t.readBoolean(),e=t.readBoolean();var r=1;return(t=t.readBoolean())&&e?r=0:t?r=3:e&&(r=2),{parallelismType:r}},shaka.transmuxer.H265.getVideoConfiguration_=function(e,t,r,n){var a=shaka.transmuxer.H265,i=new Uint8Array(23+(5+e.byteLength)+(5+t.byteLength)+(5+r.byteLength));return i[0]=1,i[1]=(3&n.generalProfileSpace)<<6|(n.generalTierFlag?1:0)<<5|31&n.generalProfileIdc,i[2]=n.generalProfileCompatibilityFlags1,i[3]=n.generalProfileCompatibilityFlags2,i[4]=n.generalProfileCompatibilityFlags3,i[5]=n.generalProfileCompatibilityFlags4,i[6]=n.generalConstraintIndicatorFlags1,i[7]=n.generalConstraintIndicatorFlags2,i[8]=n.generalConstraintIndicatorFlags3,i[9]=n.generalConstraintIndicatorFlags4,i[10]=n.generalConstraintIndicatorFlags5,i[11]=n.generalConstraintIndicatorFlags6,i[12]=n.generalLevelIdc,i[13]=240|(3840&n.minSpatialSegmentationIdc)>>8,i[14]=255&n.minSpatialSegmentationIdc,i[15]=252|3&n.parallelismType,i[16]=252|3&n.chromaFormatIdc,i[17]=248|7&n.bitDepthLumaMinus8,i[18]=248|7&n.bitDepthChromaMinus8,i[19]=0,i[20]=0,i[21]=(3&n.constantFrameRate)<<6|(7&n.numTemporalLayers)<<3|(n.temporalIdNested?1:0)<<2|3,i[22]=3,i[23]=128|a.NALU_TYPE_VPS_,i[24]=0,i[25]=1,i[26]=(65280&e.byteLength)>>8,i[27]=(255&e.byteLength)>>0,i.set(e,28),i[23+(5+e.byteLength)+0]=128|a.NALU_TYPE_SPS_,i[23+(5+e.byteLength)+1]=0,i[23+(5+e.byteLength)+2]=1,i[23+(5+e.byteLength)+3]=(65280&t.byteLength)>>8,i[23+(5+e.byteLength)+4]=(255&t.byteLength)>>0,i.set(t,23+(5+e.byteLength)+5),i[23+(5+e.byteLength+5+t.byteLength)+0]=128|a.NALU_TYPE_PPS_,i[23+(5+e.byteLength+5+t.byteLength)+1]=0,i[23+(5+e.byteLength+5+t.byteLength)+2]=1,i[23+(5+e.byteLength+5+t.byteLength)+3]=(65280&r.byteLength)>>8,i[23+(5+e.byteLength+5+t.byteLength)+4]=(255&r.byteLength)>>0,i.set(r,23+(5+e.byteLength+5+t.byteLength)+5),i},shaka.transmuxer.H265.parseFrame=function(e){for(var t=shaka.transmuxer.H265,r=!1,n=[],a=!1,i=(e=$jscomp.makeIterator(e)).next();!i.done;i=e.next()){switch((i=i.value).type){case t.NALU_TYPE_TRAIL_N_:case t.NALU_TYPE_TRAIL_R_:var o=a=!0;break;case t.NALU_TYPE_IDR_W_RADL_:case t.NALU_TYPE_IDR_N_LP_:case t.NALU_TYPE_CRA_NUT_:r=o=a=!0;break;case t.NALU_TYPE_VPS_:case t.NALU_TYPE_SPS_:case t.NALU_TYPE_PPS_:o=!0;break;case t.NALU_TYPE_AUD_:a=o=!0;break;case t.NALU_TYPE_SEI_PREFIX_:case t.NALU_TYPE_SEI_SUFFIX_:o=!0;break;default:o=!1}if(a&&o){o=i.fullData.byteLength;var s=new Uint8Array(4);s[0]=o>>24&255,s[1]=o>>16&255,s[2]=o>>8&255,s[3]=255&o,n.push(s),n.push(i.fullData)}}return n.length?{data:shaka.util.Uint8ArrayUtils.concat.apply(shaka.util.Uint8ArrayUtils,$jscomp.arrayFromIterable(n)),isKeyframe:r}:null},shaka.transmuxer.H265.NALU_TYPE_TRAIL_N_=1,shaka.transmuxer.H265.NALU_TYPE_TRAIL_R_=0,shaka.transmuxer.H265.NALU_TYPE_IDR_W_RADL_=19,shaka.transmuxer.H265.NALU_TYPE_IDR_N_LP_=20,shaka.transmuxer.H265.NALU_TYPE_CRA_NUT_=21,shaka.transmuxer.H265.NALU_TYPE_VPS_=32,shaka.transmuxer.H265.NALU_TYPE_SPS_=33,shaka.transmuxer.H265.NALU_TYPE_PPS_=34,shaka.transmuxer.H265.NALU_TYPE_AUD_=35,shaka.transmuxer.H265.NALU_TYPE_SEI_PREFIX_=39,shaka.transmuxer.H265.NALU_TYPE_SEI_SUFFIX_=40,shaka.transmuxer.MpegAudio=function(){},shaka.transmuxer.MpegAudio.parseHeader=function(e,t){var r=shaka.transmuxer.MpegAudio,n=e[t+1]>>3&3,a=e[t+1]>>1&3,i=e[t+2]>>4&15,o=e[t+2]>>2&3;if(1!==n&&0!==i&&15!==i&&3!==o){var s=e[t+3]>>6;i=1e3*r.BITRATES_MAP_[14*(3===n?3-a:3===a?3:4)+i-1],o=r.SAMPLINGRATE_MAP_[3*(3===n?0:2===n?1:2)+o];var l=3===s?1:2;n=r.SAMPLES_COEFFICIENTS_[n][a];var u=r.BYTES_IN_SLOT_[a];return r=8*n*u,n=Math.floor(n*i/o+(e[t+2]>>1&1))*u,(u=(u=(navigator.userAgent||"").match(/Chrome\/(\d+)/i))?parseInt(u[1],10):0)&&87>=u&&2===a&&224e3<=i&&0===s&&(e[t+3]|=128),{sampleRate:o,channelCount:l,frameLength:n,samplesPerFrame:r}}return null},shaka.transmuxer.MpegAudio.isHeaderPattern=function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},shaka.transmuxer.MpegAudio.isHeader=function(e,t){return t+1<e.length&&shaka.transmuxer.MpegAudio.isHeaderPattern(e,t)},shaka.transmuxer.MpegAudio.probe=function(e,t){var r=shaka.transmuxer.MpegAudio;if(t+1<e.length&&r.isHeaderPattern(e,t)){var n=r.parseHeader(e,t),a=4;return n&&n.frameLength&&(a=n.frameLength),(t+=a)===e.length||r.isHeader(e,t)}return!1},shaka.transmuxer.MpegAudio.BITRATES_MAP_=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],shaka.transmuxer.MpegAudio.SAMPLINGRATE_MAP_=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],shaka.transmuxer.MpegAudio.SAMPLES_COEFFICIENTS_=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],shaka.transmuxer.MpegAudio.BYTES_IN_SLOT_=[0,1,1,4],shaka.transmuxer.MpegAudio.MPEG_AUDIO_SAMPLE_PER_FRAME=1152,shaka.transmuxer.Mp3Transmuxer=function(e){this.originalMimeType_=e,this.frameIndex_=0,this.initSegments=new Map},shaka.transmuxer.Mp3Transmuxer.prototype.destroy=function(){this.initSegments.clear()},shaka.transmuxer.Mp3Transmuxer.prototype.isSupported=function(e,t){return t=shaka.media.Capabilities,!!this.isMpegContainer_(e)&&t.isTypeSupported(this.convertCodecs(shaka.util.ManifestParserUtils.ContentType.AUDIO,e))},shaka.transmuxer.Mp3Transmuxer.prototype.isMpegContainer_=function(e){return"audio/mpeg"==e.toLowerCase().split(";")[0]},shaka.transmuxer.Mp3Transmuxer.prototype.convertCodecs=function(e,t){return this.isMpegContainer_(t)?'audio/mp4; codecs="mp3"':t},shaka.transmuxer.Mp3Transmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.Mp3Transmuxer.prototype.transmux=function(e,t,r,n){var a,i=shaka.transmuxer.MpegAudio;r=shaka.util.Uint8ArrayUtils;for(var o=shaka.util.BufferUtils.toUint8(e),s=shaka.util.Id3Utils.getID3Data(o).length;s<o.length&&!i.probe(o,s);s++);for(e=[];s<o.length;){var l=i.parseHeader(o,s);if(!l)return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED));a||(a=l),s+l.frameLength<=o.length&&e.push({data:o.subarray(s,s+l.frameLength),size:l.frameLength,duration:i.MPEG_AUDIO_SAMPLE_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),s+=l.frameLength}return a?(i=9e4*a.samplesPerFrame/a.sampleRate*this.frameIndex_,n={id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:a.sampleRate,duration:n,videoNalus:[],audioConfig:new Uint8Array([]),videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:i,samples:e},stream:t},a=new shaka.util.Mp4Generator([n]),this.initSegments.has(t.id)?n=this.initSegments.get(t.id):(n=a.initSegment(),this.initSegments.set(t.id,n)),t=a.segmentData(),this.frameIndex_++,t=r.concat(n,t),Promise.resolve(t)):Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED))},goog.exportSymbol("shaka.transmuxer.Mp3Transmuxer",shaka.transmuxer.Mp3Transmuxer),goog.exportProperty(shaka.transmuxer.Mp3Transmuxer.prototype,"transmux",shaka.transmuxer.Mp3Transmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.Mp3Transmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.Mp3Transmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.Mp3Transmuxer.prototype,"convertCodecs",shaka.transmuxer.Mp3Transmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.Mp3Transmuxer.prototype,"isSupported",shaka.transmuxer.Mp3Transmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.Mp3Transmuxer.prototype,"destroy",shaka.transmuxer.Mp3Transmuxer.prototype.destroy),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("audio/mpeg",(function(){return new shaka.transmuxer.Mp3Transmuxer("audio/mpeg")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.FALLBACK),shaka.transmuxer.MpegTsTransmuxer=function(e){this.originalMimeType_=e,this.tsParser_=null},shaka.transmuxer.MpegTsTransmuxer.prototype.destroy=function(){},shaka.transmuxer.MpegTsTransmuxer.prototype.isSupported=function(e,t){if(t=shaka.media.Capabilities,!this.isTsContainer_(e))return!1;var r=shaka.util.ManifestParserUtils.ContentType,n=shaka.util.MimeUtils,a=n.getCodecs(e),i=n.splitCodecs(a);return a=shaka.util.ManifestParserUtils.guessCodecsSafe(r.AUDIO,i),i=shaka.util.ManifestParserUtils.guessCodecsSafe(r.VIDEO,i),!(!a||i||"mp3"!=n.getNormalizedCodec(a))&&t.isTypeSupported(this.convertCodecs(r.AUDIO,e))},shaka.transmuxer.MpegTsTransmuxer.prototype.isTsContainer_=function(e){return"video/mp2t"==e.toLowerCase().split(";")[0]},shaka.transmuxer.MpegTsTransmuxer.prototype.convertCodecs=function(e,t){return this.isTsContainer_(t)?"audio/mpeg":t},shaka.transmuxer.MpegTsTransmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.MpegTsTransmuxer.prototype.transmux=function(e,t,r,n,a){if(t=shaka.transmuxer.MpegAudio,n=shaka.util.ManifestParserUtils.ContentType,r=shaka.util.Uint8ArrayUtils,this.tsParser_?this.tsParser_.clearData():this.tsParser_=new shaka.util.TsParser,e=shaka.util.BufferUtils.toUint8(e),"mp3"!=(e=this.tsParser_.parse(e)).getCodecs().audio||a!=n.AUDIO)return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED));for(a=new Uint8Array([]),n=(e=$jscomp.makeIterator(e.getAudioData())).next();!n.done;n=e.next())if(n=n.value.data)for(var i=0;i<n.length;){var o=t.parseHeader(n,i);o?(i+o.frameLength<=n.length&&(a=r.concat(a,n.subarray(i,i+o.frameLength))),i+=o.frameLength):i++}return Promise.resolve(a)},goog.exportSymbol("shaka.transmuxer.MpegTsTransmuxer",shaka.transmuxer.MpegTsTransmuxer),goog.exportProperty(shaka.transmuxer.MpegTsTransmuxer.prototype,"transmux",shaka.transmuxer.MpegTsTransmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.MpegTsTransmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.MpegTsTransmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.MpegTsTransmuxer.prototype,"convertCodecs",shaka.transmuxer.MpegTsTransmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.MpegTsTransmuxer.prototype,"isSupported",shaka.transmuxer.MpegTsTransmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.MpegTsTransmuxer.prototype,"destroy",shaka.transmuxer.MpegTsTransmuxer.prototype.destroy),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("video/mp2t",(function(){return new shaka.transmuxer.MpegTsTransmuxer("video/mp2t")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.PREFERRED_SECONDARY),shaka.transmuxer.MssTransmuxer=function(e){this.originalMimeType_=e,(this.isoBoxer_=shaka.dependencies.isoBoxer())&&this.addSpecificBoxProcessor_()},shaka.transmuxer.MssTransmuxer.prototype.addSpecificBoxProcessor_=function(){this.isoBoxer_.addBoxProcessor("saio",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)})),this.isoBoxer_.addBoxProcessor("saiz",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)}));var e=function(){this._procFullBox(),1&this.flags&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,(function(e){this._procEntryField(e,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(e,"NumberOfEntries","uint",16),this._procSubEntries(e,"clearAndCryptedData",e.NumberOfEntries,(function(e){this._procEntryField(e,"BytesOfClearData","uint",16),this._procEntryField(e,"BytesOfEncryptedData","uint",32)})))}))};this.isoBoxer_.addBoxProcessor("senc",e),this.isoBoxer_.addBoxProcessor("uuid",(function(){for(var t=shaka.transmuxer.MssTransmuxer,r=!0,n=0;16>n;n++)this.usertype[n]!==t.UUID_SENC_[n]&&(r=!1);r&&(this._parsing&&(this.type="sepiff"),e.call(this))}))},shaka.transmuxer.MssTransmuxer.prototype.destroy=function(){},shaka.transmuxer.MssTransmuxer.prototype.isSupported=function(e,t){var r=shaka.media.Capabilities,n=e.startsWith("mss/");return!(!this.isoBoxer_||!n)&&(t?r.isTypeSupported(this.convertCodecs(t,e)):(n=shaka.util.ManifestParserUtils.ContentType,t=this.convertCodecs(n.AUDIO,e),e=this.convertCodecs(n.VIDEO,e),r.isTypeSupported(t)||r.isTypeSupported(e)))},shaka.transmuxer.MssTransmuxer.prototype.convertCodecs=function(e,t){return t.replace("mss/","")},shaka.transmuxer.MssTransmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.MssTransmuxer.prototype.transmux=function(e,t,r){if(!r)return Promise.resolve(shaka.util.BufferUtils.toUint8(e));if(!t.mssPrivateData)return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MSS_MISSING_DATA_FOR_TRANSMUXING));try{var n=this.processMediaSegment_(e,t,r);return Promise.resolve(n)}catch(e){return e instanceof shaka.util.Error?Promise.reject(e):Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.MSS_TRANSMUXING_FAILED))}},shaka.transmuxer.MssTransmuxer.prototype.processMediaSegment_=function(e,t,r){var n=(e=this.isoBoxer_.parseBuffer(e)).fetch("tfhd");n.track_ID=t.id+1;var a=e.fetch("tfdt"),i=e.fetch("traf");if(null===a&&((a=this.isoBoxer_.createFullBox("tfdt",i,n)).version=1,a.flags=0,a.baseMediaDecodeTime=Math.floor(r.startTime*t.mssPrivateData.timescale)),t=e.fetch("trun"),(r=e.fetch("tfxd"))&&r._parent.boxes.splice(r._parent.boxes.indexOf(r),1),(r=e.fetch("tfrf"))&&r._parent.boxes.splice(r._parent.boxes.indexOf(r),1),null!==(r=e.fetch("sepiff"))&&(r.type="senc",r.usertype=void 0,null===(a=e.fetch("saio")))){(a=this.isoBoxer_.createFullBox("saio",i)).version=0,a.flags=0,a.entry_count=1,a.offset=[0];var o=this.isoBoxer_.createFullBox("saiz",i);if(o.version=0,o.flags=0,o.sample_count=r.sample_count,o.default_sample_info_size=0,o.sample_info_size=[],2&r.flags)for(a=0;a<r.sample_count;a+=1)o.sample_info_size[a]=10+6*r.entry[a].NumberOfEntries;else o.default_sample_info_size=8}return n.flags&=16777214,n.flags|=131072,t.flags|=1,r=(n=e.fetch("moof")).getLength(),t.data_offset=r+8,null!==(t=e.fetch("saio"))&&(n=this.getBoxOffset_(n,"traf"),i=this.getBoxOffset_(i,"senc"),t.offset[0]=n+i+16),shaka.util.BufferUtils.toUint8(e.write())},shaka.transmuxer.MssTransmuxer.prototype.getBoxOffset_=function(e,t){for(var r=8,n=0;n<e.boxes.length&&e.boxes[n].type!==t;n++)r+=e.boxes[n].size;return r},goog.exportSymbol("shaka.transmuxer.MssTransmuxer",shaka.transmuxer.MssTransmuxer),goog.exportProperty(shaka.transmuxer.MssTransmuxer.prototype,"transmux",shaka.transmuxer.MssTransmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.MssTransmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.MssTransmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.MssTransmuxer.prototype,"convertCodecs",shaka.transmuxer.MssTransmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.MssTransmuxer.prototype,"isSupported",shaka.transmuxer.MssTransmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.MssTransmuxer.prototype,"destroy",shaka.transmuxer.MssTransmuxer.prototype.destroy),shaka.transmuxer.MssTransmuxer.UUID_SENC_=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("mss/audio/mp4",(function(){return new shaka.transmuxer.MssTransmuxer("mss/audio/mp4")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.FALLBACK),shaka.transmuxer.TransmuxerEngine.registerTransmuxer("mss/video/mp4",(function(){return new shaka.transmuxer.MssTransmuxer("mss/video/mp4")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.FALLBACK),shaka.transmuxer.Opus=function(){},shaka.transmuxer.Opus.getAudioConfig=function(e){var t=[];switch(e.channelConfigCode){case 1:case 2:t=[0];break;case 0:t=[255,1,1,0,1];break;case 128:t=[255,2,0,0,1];break;case 3:t=[1,2,1,0,2,1];break;case 4:t=[1,2,2,0,1,2,3];break;case 5:t=[1,3,2,0,4,1,2,3];break;case 6:t=[1,4,2,0,4,1,2,3,5];break;case 7:t=[1,4,2,0,4,1,2,3,5,6];break;case 8:t=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:t=[1,1,2,0,1];break;case 131:t=[1,1,3,0,1,2];break;case 132:t=[1,1,4,0,1,2,3];break;case 133:t=[1,1,5,0,1,2,3,4];break;case 134:t=[1,1,6,0,1,2,3,4,5];break;case 135:t=[1,1,7,0,1,2,3,4,5,6];break;case 136:t=[1,1,8,0,1,2,3,4,5,6,7]}return new Uint8Array([0,e.channelCount,0,0,e.sampleRate>>>24&255,e.sampleRate>>>17&255,e.sampleRate>>>8&255,e.sampleRate>>>0&255,0,0].concat($jscomp.arrayFromIterable(t)))},shaka.transmuxer.Opus.OPUS_AUDIO_SAMPLE_PER_FRAME=960,shaka.transmuxer.TsTransmuxer=function(e){this.originalMimeType_=e,this.frameIndex_=0,this.initSegments=new Map,this.aacTransmuxer_=this.tsParser_=null},shaka.transmuxer.TsTransmuxer.prototype.destroy=function(){this.initSegments.clear(),this.aacTransmuxer_&&this.aacTransmuxer_.destroy()},shaka.transmuxer.TsTransmuxer.prototype.isSupported=function(e,t){var r=shaka.media.Capabilities;if(!this.isTsContainer_(e))return!1;var n=shaka.util.ManifestParserUtils.ContentType,a=shaka.util.MimeUtils,i=e;t&&(i=this.convertCodecs(t,e)),i=a.getCodecs(i),i=a.splitCodecs(i);var o=shaka.util.ManifestParserUtils.guessCodecsSafe(n.AUDIO,i),s=shaka.util.ManifestParserUtils.guessCodecsSafe(n.VIDEO,i);return i=shaka.transmuxer.TsTransmuxer,!(o&&(o=a.getNormalizedCodec(o),!i.SUPPORTED_AUDIO_CODECS_.includes(o))||s&&(a=a.getNormalizedCodec(s),!i.SUPPORTED_VIDEO_CODECS_.includes(a)))&&(t?r.isTypeSupported(this.convertCodecs(t,e)):(t=this.convertCodecs(n.AUDIO,e),e=this.convertCodecs(n.VIDEO,e),r.isTypeSupported(t)||r.isTypeSupported(e)))},shaka.transmuxer.TsTransmuxer.prototype.isTsContainer_=function(e){return"video/mp2t"==e.toLowerCase().split(";")[0]},shaka.transmuxer.TsTransmuxer.prototype.convertCodecs=function(e,t){if(this.isTsContainer_(t)){var r=shaka.util.ManifestParserUtils.ContentType,n=shaka.util.StreamUtils;return t=shaka.util.MimeUtils.getCodecs(t).replace("mp4a.40.34","mp3").split(",").map((function(e){return n.getCorrectAudioCodecs(e,"audio/mp4")})).map(n.getCorrectVideoCodecs).join(","),e==r.AUDIO?'audio/mp4; codecs="'+t+'"':'video/mp4; codecs="'+t+'"'}return t},shaka.transmuxer.TsTransmuxer.prototype.getOriginalMimeType=function(){return this.originalMimeType_},shaka.transmuxer.TsTransmuxer.prototype.transmux=function(e,t,r,n,a){var i=shaka.util.ManifestParserUtils.ContentType,o=shaka.util.Uint8ArrayUtils,s=shaka.util.BufferUtils.toUint8(e);if(a==i.AUDIO&&!shaka.util.TsParser.probe(s)){for(i=(o=shaka.util.Id3Utils.getID3Data(s)).length;i<s.length;i++)if(shaka.transmuxer.MpegAudio.probe(s,i))return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED));for(i=o.length;i<s.length;i++)if(shaka.transmuxer.ADTS.probe(s,i))return this.aacTransmuxer_||(this.aacTransmuxer_=new shaka.transmuxer.AacTransmuxer("audio/aac")),this.aacTransmuxer_.transmux(e,t,r,n,a);return Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED))}this.tsParser_?this.tsParser_.clearData():this.tsParser_=new shaka.util.TsParser,e=this.tsParser_.parse(s),s=[];var l=e.getCodecs();try{var u=null;if(a==i.VIDEO){switch(l.video){case"avc":u=this.getAvcStreamInfo_(e,t,n,r);break;case"hvc":u=this.getHvcStreamInfo_(e,t,n,r)}u&&(s.push(u),u=null)}if(a==i.AUDIO){switch(l.audio){case"aac":u=this.getAacStreamInfo_(e,t,n,r);break;case"ac3":u=this.getAc3StreamInfo_(e,t,n);break;case"ec3":u=this.getEc3StreamInfo_(e,t,n);break;case"mp3":u=this.getMp3StreamInfo_(e,t,n);break;case"opus":u=this.getOpusStreamInfo_(e,t,n)}u&&s.push(u)}}catch(e){return e&&e.code==shaka.util.Error.Code.TRANSMUXING_NO_VIDEO_DATA?Promise.resolve(new Uint8Array([])):Promise.reject(e)}return s.length?(n=new shaka.util.Mp4Generator(s),this.initSegments.has(t.id)?r=this.initSegments.get(t.id):(r=n.initSegment(),this.initSegments.set(t.id,r)),t=n.segmentData(),this.frameIndex_++,t=o.concat(r,t),Promise.resolve(t)):Promise.reject(new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED))},shaka.transmuxer.TsTransmuxer.prototype.getAacStreamInfo_=function(e,t,r,n){for(var a,i=shaka.transmuxer.ADTS,o=shaka.util.TsParser.Timescale,s=[],l=null,u=$jscomp.makeIterator(e.getAudioData()),c=u.next();!c.done;c=u.next()){var d=c.value;if(c=d.data){var p=0;if(!(a=i.parseInfo(c,p)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED);for(t.audioSamplingRate=a.sampleRate,t.channelsCount=a.channelCount,null==l&&null!==d.pts&&(l=d.pts);p<c.length;)if(d=i.parseHeader(c,p)){var h=d.headerLength+d.frameLength;if(p+h<=c.length){var f=c.subarray(p+d.headerLength,p+h);s.push({data:f,size:d.frameLength,duration:i.AAC_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}})}p+=h}else p++}}if(!a||null==l){if(!e.getVideoData().length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED);if(l=n.startTime*o,a=shaka.util.MimeUtils.splitCodecs(t.codecs),!(e=shaka.util.ManifestParserUtils.guessCodecsSafe(shaka.util.ManifestParserUtils.ContentType.AUDIO,a))||!t.channelsCount||!t.audioSamplingRate)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED);if(a={sampleRate:t.audioSamplingRate,channelCount:t.channelsCount,codec:e},!(e=i.getSilentFrame(e,t.channelsCount)))throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED);for(n=l+(n.endTime-n.startTime)*o,u=l;u<n;)s.push({data:e,size:e.byteLength,duration:i.AAC_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),u+=i.AAC_SAMPLES_PER_FRAME/a.sampleRate*o}return o=l/o*(i=a.sampleRate),{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:a.codec,encrypted:t.encrypted&&0<t.drmInfos.length,timescale:i,duration:r,videoNalus:[],audioConfig:new Uint8Array([]),videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:o,samples:s},stream:t}},shaka.transmuxer.TsTransmuxer.prototype.getAc3StreamInfo_=function(e,t,r){for(var n=shaka.transmuxer.Ac3,a=shaka.util.TsParser.Timescale,i=[],o=0,s=new Uint8Array([]),l=null,u=(e=$jscomp.makeIterator(e.getAudioData())).next();!u.done;u=e.next()){var c=u.value;for(u=c.data,null==l&&null!==c.pts&&(l=c.pts),c=0;c<u.length;){var d=n.parseFrame(u,c);if(d){t.audioSamplingRate=d.sampleRate,t.channelsCount=d.channelCount,o=d.sampleRate,s=d.audioConfig;var p=u.subarray(c,c+d.frameLength);i.push({data:p,size:d.frameLength,duration:n.AC3_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),c+=d.frameLength}else c++}}if(0==o||0==s.byteLength||null==l)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED);return n=l/a*o,{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"ac-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:o,duration:r,videoNalus:[],audioConfig:s,videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:n,samples:i},stream:t}},shaka.transmuxer.TsTransmuxer.prototype.getEc3StreamInfo_=function(e,t,r){for(var n=shaka.transmuxer.Ec3,a=shaka.util.TsParser.Timescale,i=[],o=0,s=new Uint8Array([]),l=null,u=(e=$jscomp.makeIterator(e.getAudioData())).next();!u.done;u=e.next()){var c=u.value;for(u=c.data,null==l&&null!==c.pts&&(l=c.pts),c=0;c<u.length;){var d=n.parseFrame(u,c);if(d){t.audioSamplingRate=d.sampleRate,t.channelsCount=d.channelCount,o=d.sampleRate,s=d.audioConfig;var p=u.subarray(c,c+d.frameLength);i.push({data:p,size:d.frameLength,duration:n.EC3_SAMPLES_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),c+=d.frameLength}else c++}}if(0==o||0==s.byteLength||null==l)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED);return n=l/a*o,{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"ec-3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:o,duration:r,videoNalus:[],audioConfig:s,videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:n,samples:i},stream:t}},shaka.transmuxer.TsTransmuxer.prototype.getMp3StreamInfo_=function(e,t,r){for(var n,a=shaka.transmuxer.MpegAudio,i=shaka.util.TsParser.Timescale,o=[],s=null,l=(e=$jscomp.makeIterator(e.getAudioData())).next();!l.done;l=e.next()){var u=l.value;if(l=u.data)for(null==s&&null!==u.pts&&(s=u.pts),u=0;u<l.length;){var c=a.parseHeader(l,u);c?(n||(n=c),u+c.frameLength<=l.length&&o.push({data:l.subarray(u,u+c.frameLength),size:c.frameLength,duration:a.MPEG_AUDIO_SAMPLE_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),u+=c.frameLength):u++}}if(!n||null==s)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED);return i=s/i*(a=n.sampleRate),{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"mp3",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:a,duration:r,videoNalus:[],audioConfig:new Uint8Array([]),videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:i,samples:o},stream:t}},shaka.transmuxer.TsTransmuxer.prototype.getOpusStreamInfo_=function(e,t,r){var n=shaka.transmuxer.Opus,a=shaka.util.TsParser.Timescale,i=[],o=null,s=e.getOpusMetadata();if(!s)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED);for(var l=n.getAudioConfig(s),u=s.sampleRate,c=(e=$jscomp.makeIterator(e.getAudioData())).next();!c.done;c=e.next()){var d=c.value;c=d.data,null==o&&null!==d.pts&&(o=d.pts);for(var p=0;p<c.length;){d=0!=(16&c[p+1]);var h=0!=(8&c[p+1]);p+=2;for(var f=0;255===c[p];)f+=255,p+=1;f+=c[p],p+=1,p+=d?2:0,p+=h?2:0,d=c.slice(p,p+f),i.push({data:d,size:d.byteLength,duration:n.OPUS_AUDIO_SAMPLE_PER_FRAME,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:2,isNonSync:0}}),p+=f}}if(0==l.byteLength||null==o)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED);return t.audioSamplingRate=s.sampleRate,t.channelsCount=s.channelCount,n=o/a*u,{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.AUDIO,codecs:"opus",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:u,duration:r,videoNalus:[],audioConfig:l,videoConfig:new Uint8Array([]),hSpacing:0,vSpacing:0,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:n,samples:i},stream:t}},shaka.transmuxer.TsTransmuxer.prototype.getAvcStreamInfo_=function(e,t,r,n){var a=shaka.transmuxer.H264,i=shaka.util.TsParser.Timescale,o=[],s=null,l=[];if(!(e=e.getVideoData()).length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_NO_VIDEO_DATA);for(var u=0;u<e.length;u++){var c=e[u],d=c.nalus;l.push.apply(l,$jscomp.arrayFromIterable(d)),(d=a.parseFrame(d))&&(null==s&&(s=c.dts),o.push({data:d.data,size:d.data.byteLength,duration:u+1<e.length?(e[u+1].dts||0)-(c.dts||0):1<e.length?(c.dts||0)-(e[u-1].dts||0):(n.endTime-n.startTime)*i,cts:Math.round((c.pts||0)-(c.dts||0)),flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:d.isKeyframe?2:1,isNonSync:d.isKeyframe?0:1}}))}if(!(n=a.parseInfo(l))||null==s)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED);return t.height=n.height,t.width=n.width,{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.VIDEO,codecs:"avc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:i,duration:r,videoNalus:[],audioConfig:new Uint8Array([]),videoConfig:n.videoConfig,hSpacing:n.hSpacing,vSpacing:n.vSpacing,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:s,samples:o},stream:t}},shaka.transmuxer.TsTransmuxer.prototype.getHvcStreamInfo_=function(e,t,r,n){var a=shaka.transmuxer.H265,i=shaka.util.TsParser.Timescale,o=[],s=null,l=[];if(!(e=e.getVideoData()).length)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_NO_VIDEO_DATA);for(var u=0;u<e.length;u++){var c=e[u],d=c.nalus;l.push.apply(l,$jscomp.arrayFromIterable(d)),(d=a.parseFrame(d))&&(null==s&&null!=c.dts&&(s=c.dts),o.push({data:d.data,size:d.data.byteLength,duration:u+1<e.length?(e[u+1].dts||0)-(c.dts||0):1<e.length?(c.dts||0)-(e[u-1].dts||0):(n.endTime-n.startTime)*i,cts:Math.round((c.pts||0)-(c.dts||0)),flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:d.isKeyframe?2:1,isNonSync:d.isKeyframe?0:1}}))}if(!(n=a.parseInfo(l))||null==s)throw new shaka.util.Error(shaka.util.Error.Severity.CRITICAL,shaka.util.Error.Category.MEDIA,shaka.util.Error.Code.TRANSMUXING_FAILED);return t.height=n.height,t.width=n.width,{id:t.id,type:shaka.util.ManifestParserUtils.ContentType.VIDEO,codecs:"hvc1",encrypted:t.encrypted&&0<t.drmInfos.length,timescale:i,duration:r,videoNalus:[],audioConfig:new Uint8Array([]),videoConfig:n.videoConfig,hSpacing:n.hSpacing,vSpacing:n.vSpacing,data:{sequenceNumber:this.frameIndex_,baseMediaDecodeTime:s,samples:o},stream:t}},goog.exportSymbol("shaka.transmuxer.TsTransmuxer",shaka.transmuxer.TsTransmuxer),goog.exportProperty(shaka.transmuxer.TsTransmuxer.prototype,"transmux",shaka.transmuxer.TsTransmuxer.prototype.transmux),goog.exportProperty(shaka.transmuxer.TsTransmuxer.prototype,"getOriginalMimeType",shaka.transmuxer.TsTransmuxer.prototype.getOriginalMimeType),goog.exportProperty(shaka.transmuxer.TsTransmuxer.prototype,"convertCodecs",shaka.transmuxer.TsTransmuxer.prototype.convertCodecs),goog.exportProperty(shaka.transmuxer.TsTransmuxer.prototype,"isSupported",shaka.transmuxer.TsTransmuxer.prototype.isSupported),goog.exportProperty(shaka.transmuxer.TsTransmuxer.prototype,"destroy",shaka.transmuxer.TsTransmuxer.prototype.destroy),shaka.transmuxer.TsTransmuxer.SUPPORTED_AUDIO_CODECS_=["aac","ac-3","ec-3","mp3","opus"],shaka.transmuxer.TsTransmuxer.SUPPORTED_VIDEO_CODECS_=["avc","hevc"],shaka.transmuxer.TransmuxerEngine.registerTransmuxer("video/mp2t",(function(){return new shaka.transmuxer.TsTransmuxer("video/mp2t")}),shaka.transmuxer.TransmuxerEngine.PluginPriority.PREFERRED);var EmeEncryptionSchemePolyfill=function(){};EmeEncryptionSchemePolyfill.install=function(){EmeEncryptionSchemePolyfill.originalRMKSA_?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(EmeEncryptionSchemePolyfill.originalRMKSA_=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=EmeEncryptionSchemePolyfill.probeRMKSA_):console.debug("EmeEncryptionSchemePolyfill: EME not found")},EmeEncryptionSchemePolyfill.probeRMKSA_=function(e,t){var r,n=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(a){return 1==a.nextAddress?(console.assert(n==navigator,'bad "this" for requestMediaKeySystemAccess'),a.yield(EmeEncryptionSchemePolyfill.originalRMKSA_.call(n,e,t),2)):hasEncryptionScheme(r=a.yieldResult)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=EmeEncryptionSchemePolyfill.originalRMKSA_,a.return(r)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=EmeEncryptionSchemePolyfill.polyfillRMKSA_,a.return(EmeEncryptionSchemePolyfill.polyfillRMKSA_.call(n,e,t)))}))},EmeEncryptionSchemePolyfill.polyfillRMKSA_=function(e,t){var r,n,a,i,o,s,l,u,c,d,p=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(h){if(1==h.nextAddress){for(console.assert(p==navigator,'bad "this" for requestMediaKeySystemAccess'),r=guessSupportedScheme(e),n=[],a=$jscomp.makeIterator(t),i=a.next();!i.done;i=a.next())o=i.value,s=EmeEncryptionSchemePolyfill.filterCapabilities_(o.videoCapabilities,r),l=EmeEncryptionSchemePolyfill.filterCapabilities_(o.audioCapabilities,r),o.videoCapabilities&&o.videoCapabilities.length&&!s.length||o.audioCapabilities&&o.audioCapabilities.length&&!l.length||((u=Object.assign({},o)).videoCapabilities=s,u.audioCapabilities=l,n.push(u));if(!n.length)throw(c=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",c.code=DOMException.NOT_SUPPORTED_ERR,c;return h.yield(EmeEncryptionSchemePolyfill.originalRMKSA_.call(p,e,n),2)}return d=h.yieldResult,h.return(new EmeEncryptionSchemePolyfillMediaKeySystemAccess(d,r))}))},EmeEncryptionSchemePolyfill.filterCapabilities_=function(e,t){return e?e.filter((function(e){return!e.encryptionScheme||e.encryptionScheme==t})):e},goog.exportSymbol("EmeEncryptionSchemePolyfill",EmeEncryptionSchemePolyfill),goog.exportProperty(EmeEncryptionSchemePolyfill,"install",EmeEncryptionSchemePolyfill.install);var McEncryptionSchemePolyfill=function(){};McEncryptionSchemePolyfill.install=function(){McEncryptionSchemePolyfill.originalDecodingInfo_?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(McEncryptionSchemePolyfill.originalDecodingInfo_=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=McEncryptionSchemePolyfill.probeDecodingInfo_):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")},McEncryptionSchemePolyfill.probeDecodingInfo_=function(e){var t,r,n,a=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(i){switch(i.nextAddress){case 1:return console.assert(a==navigator.mediaCapabilities,'bad "this" for decodingInfo'),i.yield(McEncryptionSchemePolyfill.originalDecodingInfo_.call(a,e),2);case 2:if(t=i.yieldResult,!e.keySystemConfiguration)return i.return(t);if((r=t.keySystemAccess)&&hasEncryptionScheme(r))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=McEncryptionSchemePolyfill.originalDecodingInfo_,i.return(t);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=McEncryptionSchemePolyfill.polyfillDecodingInfo_,r){i.jumpTo(3);break}return n=t,i.yield(McEncryptionSchemePolyfill.getMediaKeySystemAccess_(e),4);case 4:return n.keySystemAccess=i.yieldResult,i.return(t);case 3:return i.return(McEncryptionSchemePolyfill.polyfillDecodingInfo_.call(a,e))}}))},McEncryptionSchemePolyfill.polyfillDecodingInfo_=function(e){var t,r,n,a,i,o,s,l,u=this;return $jscomp.asyncExecutePromiseGeneratorProgram((function(c){switch(c.nextAddress){case 1:return console.assert(u==navigator.mediaCapabilities,'bad "this" for decodingInfo'),t=null,e.keySystemConfiguration&&(r=e.keySystemConfiguration,n=r.keySystem,a=r.audio&&r.audio.encryptionScheme,i=r.video&&r.video.encryptionScheme,t=guessSupportedScheme(n),o={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},a&&a!=t||i&&i!=t)?c.return(o):c.yield(McEncryptionSchemePolyfill.originalDecodingInfo_.call(u,e),2);case 2:if((s=c.yieldResult).keySystemAccess){s.keySystemAccess=new EmeEncryptionSchemePolyfillMediaKeySystemAccess(s.keySystemAccess,t),c.jumpTo(3);break}if(!e.keySystemConfiguration){c.jumpTo(3);break}return l=s,c.yield(McEncryptionSchemePolyfill.getMediaKeySystemAccess_(e),5);case 5:l.keySystemAccess=c.yieldResult;case 3:return c.return(s)}}))},McEncryptionSchemePolyfill.getMediaKeySystemAccess_=function(e){var t,r;return $jscomp.asyncExecutePromiseGeneratorProgram((function(n){return 1==n.nextAddress?(t=McEncryptionSchemePolyfill.convertToMediaKeySystemConfig_(e),n.yield(navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)):(r=n.yieldResult,n.return(r))}))},McEncryptionSchemePolyfill.convertToMediaKeySystemConfig_=function(e){var t=e.keySystemConfiguration,r=[],n=[];return t.audio&&r.push({robustness:t.audio.robustness||"",contentType:e.audio.contentType}),t.video&&n.push({robustness:t.video.robustness||"",contentType:e.video.contentType}),e={initDataTypes:t.initDataType?[t.initDataType]:[],distinctiveIdentifier:t.distinctiveIdentifier,persistentState:t.persistentState,sessionTypes:t.sessionTypes},r.length&&(e.audioCapabilities=r),n.length&&(e.videoCapabilities=n),e},goog.exportSymbol("McEncryptionSchemePolyfill",McEncryptionSchemePolyfill),goog.exportProperty(McEncryptionSchemePolyfill,"install",McEncryptionSchemePolyfill.install);var EmeEncryptionSchemePolyfillMediaKeySystemAccess=function(e,t){this.mksa_=e,this.scheme_=t,this.keySystem=e.keySystem};function guessSupportedScheme(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function hasEncryptionScheme(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}EmeEncryptionSchemePolyfillMediaKeySystemAccess.prototype.getConfiguration=function(){var e=this.mksa_.getConfiguration();if(e.videoCapabilities)for(var t=$jscomp.makeIterator(e.videoCapabilities),r=t.next();!r.done;r=t.next())r.value.encryptionScheme=this.scheme_;if(e.audioCapabilities)for(r=(t=$jscomp.makeIterator(e.audioCapabilities)).next();!r.done;r=t.next())r.value.encryptionScheme=this.scheme_;return e},EmeEncryptionSchemePolyfillMediaKeySystemAccess.prototype.createMediaKeys=function(){return this.mksa_.createMediaKeys()};var EncryptionSchemePolyfills=function(){};EncryptionSchemePolyfills.install=function(){EmeEncryptionSchemePolyfill.install(),McEncryptionSchemePolyfill.install()},goog.exportSymbol("EncryptionSchemePolyfills",EncryptionSchemePolyfills),goog.exportProperty(EncryptionSchemePolyfills,"install",EncryptionSchemePolyfills.install),void 0!==module&&module.exports&&(module.exports=EncryptionSchemePolyfills)}.call(exportTo,innerGlobal,innerGlobal,void 0),exportTo.shaka)exports[k]=exportTo.shaka[k]})()},701:module=>{"use strict";var e=[];function t(t){for(var r=-1,n=0;n<e.length;n++)if(e[n].identifier===t){r=n;break}return r}function r(r,a){for(var i={},o=[],s=0;s<r.length;s++){var l=r[s],u=a.base?l[0]+a.base:l[0],c=i[u]||0,d="".concat(u," ").concat(c);i[u]=c+1;var p=t(d),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(h);else{var f=n(h,a);a.byIndex=s,e.splice(s,0,{identifier:d,updater:f,references:1})}o.push(d)}return o}function n(e,t){var r=t.domAPI(t);r.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}module.exports=function(n,a){var i=r(n=n||[],a=a||{});return function(n){n=n||[];for(var o=0;o<i.length;o++){var s=t(i[o]);e[s].references--}for(var l=r(n,a),u=0;u<i.length;u++){var c=t(i[u]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}i=l}}},80:module=>{"use strict";var e={};module.exports=function(t,r){var n=function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},182:module=>{"use strict";module.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},850:(module,e,t)=>{"use strict";module.exports=function(e){var r=t.nc;r&&e.setAttribute("nonce",r)}},236:module=>{"use strict";module.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var a=void 0!==r.layer;a&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,a&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},213:module=>{"use strict";module.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},771:module=>{self,module.exports=function(){var e={9063:function(e,t,r){"use strict";r.d(t,{S:function(){return n}});var n={PRE:"preroll",MID:"midroll",POST:"postroll",OVERLAY:"overlay"}},4611:function(e,t,r){"use strict";r.d(t,{J:function(){return n}});var n={AD_CAN_SKIP:"adcanskip",AD_MANIFEST_LOADED:"admanifestloaded",AD_LOADED:"adloaded",AD_STARTED:"adstarted",AD_RESUMED:"adresumed",AD_PAUSED:"adpaused",AD_CLICKED:"adclicked",AD_SKIPPED:"adskipped",AD_COMPLETED:"adcompleted",AD_ERROR:"aderror",ADS_COMPLETED:"adscompleted",ALL_ADS_COMPLETED:"alladscompleted",AD_BREAK_START:"adbreakstart",AD_BREAK_END:"adbreakend",AD_FIRST_QUARTILE:"adfirstquartile",AD_MIDPOINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",USER_CLOSED_AD:"userclosedad",AD_VOLUME_CHANGED:"advolumechanged",AD_MUTED:"admuted",AD_PROGRESS:"adprogress",AD_BUFFERING:"adbuffering",AD_WATERFALLING:"adwaterfalling",AD_WATERFALLING_FAILED:"adwaterfallingfailed",AD_AUTOPLAY_FAILED:"adautoplayfailed"}},8151:function(e,t,r){"use strict";r.d(t,{J:function(){return n}});var n={VAST:"vast",VMAP:"vmap"}},7237:function(e,t,r){"use strict";r.d(t,{J:function(){return n}});var n={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready",FAIRPLAY:"com.apple.fairplay"}},1057:function(e,t,r){"use strict";r.d(t,{_:function(){return i}});var n=r(5671),a=r(3144),i=function(){function e(t){(0,n.Z)(this,e),this._name=t.getName(),this._getEngineDecorator=t.getEngineDecorator.bind(t)}return(0,a.Z)(e,[{key:"getEngineDecorator",value:function(e,t){return this._getEngineDecorator(e,t)}},{key:"getName",value:function(){return this._name}}]),e}()},4779:function(e,t,r){"use strict";r.d(t,{zv:function(){return C},Hl:function(){return P},co:function(){return x}});var n,a=r(5671),i=r(3144),o=r(4942),s=r(4358),l=r(7326),u=r(9340),c=r(2963),d=r(1120),p=r(8171),h=r(8987),f=r(4270),m=r(2114),g=r(2588),y=r(6462),v=r(375),_=r(4821),k=JSON.parse('{"$":"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE="}'),E=(n=function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,null,[{key:"runCapability",value:function(){e._capabilities.autoplay||"boolean"==typeof e._capabilities.autoplay&&"boolean"==typeof e._capabilities.mutedAutoPlay?e._playPromiseResult=Promise.resolve(e._capabilities):(e._vid||(e._vid=_.is.createElement("video"),e._vid.src=k.$,e._vid.setAttribute("playsinline","")),e._playPromiseResult=new Promise((function(t){e._setMuted(!1),e._getPlayPromise().then((function(){return t({autoplay:!0,mutedAutoPlay:!0})})).catch((function(){e._setMuted(!0),e._getPlayPromise().then((function(){return t({autoplay:!1,mutedAutoPlay:!0})})).catch((function(){return t({autoplay:!1,mutedAutoPlay:!1})}))}))})))}},{key:"getCapability",value:function(){return e._playPromiseResult.then((function(t){var r;return t.autoplay?r=Promise.resolve(t):(e.runCapability(),r=e._playPromiseResult),r.then((function(t){return _.c7.mergeDeep(t,e._capabilities)}))}))}},{key:"setCapabilities",value:function(t){e._logger.debug("Set player capabilities",t);var r=t.autoplay,n=t.mutedAutoPlay;"boolean"==typeof r&&(e._capabilities.autoplay=r),"boolean"==typeof n&&(e._capabilities.mutedAutoPlay=n)}},{key:"_getPlayPromise",value:function(){return e._vid.play()||e._forcePromiseReturnValue()}},{key:"_setMuted",value:function(t){t?(e._vid.muted=!0,e._vid.setAttribute("muted","")):(e._vid.muted=!1,e._vid.removeAttribute("muted"))}},{key:"_forcePromiseReturnValue",value:function(){return new Promise((function(t,r){e._vid.addEventListener(m.Rk.ERROR,(function(){r()}));var n=setTimeout((function(){e._logger.debug("Timeout ".concat(500," ms has been reached")),r()}),500);!0===e._vid.paused?(clearTimeout(n),r()):(clearTimeout(n),t())}))}}]),e}(),(0,o.Z)(n,"_logger",(0,s.ZP)("Html5AutoPlayCapability")),(0,o.Z)(n,"_capabilities",{}),n),b=r(962),T=r(9439),A=function(e){(0,u.Z)(s,e);var t,r,n=(t=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(r){var a=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,c.Z)(this,e)});function s(e,t,r){var i;return(0,a.Z)(this,s),i=n.call(this),(0,o.Z)((0,l.Z)(i),"_droppedFramesInterval",null),(0,o.Z)((0,l.Z)(i),"_lastDroppedFrames",0),(0,o.Z)((0,l.Z)(i),"_lastDecodedFrames",0),(0,o.Z)((0,l.Z)(i),"_lastTime",0),(0,o.Z)((0,l.Z)(i),"_currentBitrate",0),i._eventManager=new f.Q,i._mediaSourceAdapter=e,i._config=t,i._videoElement=r,i._mediaSourceAdapter.capabilities.fpsControl?(i._eventManager.listen(i._mediaSourceAdapter,m.nQ.FPS_DROP,(function(e){return i._triggerFPSDrop(e.payload.data)})),(0,c.Z)(i)):(-1===i._getDroppedAndDecodedFrames()[0]?s._logger.debug("Dropped frame watcher is not supported"):i._config.capLevelOnFPSDrop?(s._logger.debug("Initialized capLevelOnFPSDrop = true"),i._init()):s._logger.debug("Not Initialized"),i)}return(0,i.Z)(s,[{key:"_init",value:function(){var e=this;this._eventManager.listen(this._mediaSourceAdapter,m.nQ.VIDEO_TRACK_CHANGED,(function(t){return e._currentBitrate=t.payload.selectedVideoTrack.bandwidth})),this._droppedFramesInterval=setInterval((function(){return e._checkFPS()}),this._config.fpsDroppedFramesInterval)}},{key:"_triggerFPSDrop",value:function(e){this.dispatchEvent(new h.v(m.nQ.FPS_DROP,e))}},{key:"_getDroppedAndDecodedFrames",value:function(){if("function"==typeof this._videoElement.getVideoPlaybackQuality){var e=this._videoElement.getVideoPlaybackQuality();return[e.droppedVideoFrames,e.totalVideoFrames]}return"number"==typeof this._videoElement.webkitDroppedFrameCount&&"number"==typeof this._videoElement.webkitDecodedFrameCount?[this._videoElement.webkitDroppedFrameCount,this._videoElement.webkitDecodedFrameCount]:[-1,-1]}},{key:"_checkFPS",value:function(){var e=this._getDroppedAndDecodedFrames(),t=(0,T.Z)(e,2),r=t[0],n=t[1];try{var a=performance.now();if(n){if(this._lastTime){var i=a-this._lastTime,o=r-this._lastDroppedFrames,l=n-this._lastDecodedFrames,u=1e3*o/i;u>0&&(s._logger.debug("checkFPS : droppedFPS/decodedFPS:"+u/(1e3*l/i)),o>this._config.fpsDroppedMonitoringThreshold*l&&(this._mediaSourceAdapter.setMaxBitrate(this._currentBitrate-1),this._triggerFPSDrop({currentDropped:o,currentDecoded:l,totalDroppedFrames:u})))}this._lastTime=a,this._lastDroppedFrames=r,this._lastDecodedFrames=n}}catch(e){s._logger.error("Error occur while trying to check dropFrames: ",e)}}},{key:"destroy",value:function(){this._droppedFramesInterval&&clearInterval(this._droppedFramesInterval),this._droppedFramesInterval=null,this._eventManager.destroy()}}]),s}(p.H);(0,o.Z)(A,"_logger",(0,s.ZP)("droppedFramesWatcher"));var S=function(e){(0,u.Z)(s,e);var t,r,n=(t=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(r){var a=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,c.Z)(this,e)});function s(e,t,r){var i;return(0,a.Z)(this,s),i=n.call(this),(0,o.Z)((0,l.Z)(i),"_reset",!1),i._eventManager=new f.Q,i._canLoadMediaSourceAdapterPromise=Promise.resolve(),i._createVideoElement(r),i._init(e,t),i}return(0,i.Z)(s,[{key:"restore",value:function(e,t){this.reset(),this._init(e,t)}},{key:"reset",value:function(){var e=this;this._reset||(this._reset=!0,this._eventManager.removeAll(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=void 0),this._canLoadMediaSourceAdapterPromise=new Promise((function(t,r){var n=e._mediaSourceAdapter?e._mediaSourceAdapter.destroy():Promise.resolve();e._el&&e._el.src?n.then((function(){_.is.setAttribute(e._el,"src",""),_.is.removeAttribute(e._el,"src"),t()}),r):n.then(t,r)})),this._mediaSourceAdapter=null)}},{key:"destroy",value:function(){this.detach(),this._el&&(this.pause(),_.is.removeAttribute(this._el,"src"),_.is.removeChild(this._el.parentNode,this._el)),this._eventManager.destroy(),g.Z.destroy(),this._droppedFramesWatcher&&(this._droppedFramesWatcher.destroy(),this._droppedFramesWatcher=void 0),this._mediaSourceAdapter&&(this._mediaSourceAdapter.destroy(),this._mediaSourceAdapter=null)}},{key:"id",get:function(){return s.id}},{key:"attachMediaSource",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.attachMediaSource()}},{key:"detachMediaSource",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.detachMediaSource()}},{key:"attach",value:function(){var e=this;Object.keys(m.Rk).forEach((function(t){[m.Rk.ERROR,m.Rk.WAITING].includes(m.Rk[t])||e._eventManager.listen(e._el,m.Rk[t],(function(){return e.dispatchEvent(new h.v(m.Rk[t]))}))})),this._eventManager.listen(this._el,m.Rk.ERROR,(function(){return e._handleVideoError()})),this._eventManager.listen(this._el,m.Rk.WAITING,(function(){return e._handleWaiting()})),this._handleMetadataTrackEvents(),this._eventManager.listen(this._el.textTracks,"addtrack",(function(t){y.PZ.isNativeTextTrack(t.track)&&e.dispatchEvent(new h.v(m.nQ.TEXT_TRACK_ADDED,{track:t.track}))}));var t=this._mediaSourceAdapter;t&&(this._eventManager.listen(t,m.nQ.VIDEO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.AUDIO_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.TEXT_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.IMAGE_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.TEXT_CUE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.TRACKS_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.Rk.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.Rk.TIME_UPDATE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.Rk.PLAYING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.Rk.WAITING,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,m.nQ.TIMED_METADATA_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(t,"hlsFragParsingMetadata",(function(t){return e.dispatchEvent(t)})),this._droppedFramesWatcher&&this._eventManager.listen(this._droppedFramesWatcher,m.nQ.FPS_DROP,(function(t){return e.dispatchEvent(t)})))}},{key:"detach",value:function(){var e=this;Object.keys(m.Rk).forEach((function(t){e._eventManager.unlisten(e._el,m.Rk[t])})),this._mediaSourceAdapter&&(this._eventManager.unlisten(this._mediaSourceAdapter,m.nQ.VIDEO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,m.nQ.AUDIO_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,m.nQ.TEXT_TRACK_CHANGED),this._eventManager.unlisten(this._mediaSourceAdapter,m.nQ.TEXT_CUE_CHANGED))}},{key:"getVideoElement",value:function(){return this._el}},{key:"selectVideoTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectVideoTrack(e)}},{key:"selectAudioTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectAudioTrack(e)}},{key:"selectTextTrack",value:function(e){this._removeCueChangeListeners(),this._mediaSourceAdapter&&this._mediaSourceAdapter.selectTextTrack(e),this.resetAllCues(),this._addCueChangeListener()}},{key:"selectImageTrack",value:function(e){this._mediaSourceAdapter&&this._mediaSourceAdapter.selectImageTrack(e)}},{key:"hideTextTrack",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.hideTextTrack(),this._removeCueChangeListeners()}},{key:"enableAdaptiveBitrate",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.enableAdaptiveBitrate()}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isAdaptiveBitrateEnabled()}},{key:"applyABRRestriction",value:function(e){if(this._mediaSourceAdapter)return this._mediaSourceAdapter.applyABRRestriction(e)}},{key:"seekToLiveEdge",value:function(){this._mediaSourceAdapter&&this._mediaSourceAdapter.seekToLiveEdge()}},{key:"isOnLiveEdge",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isOnLiveEdge()}},{key:"getStartTimeOfDvrWindow",value:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.getStartTimeOfDvrWindow():0}},{key:"isLive",value:function(){return!!this._mediaSourceAdapter&&this._mediaSourceAdapter.isLive()}},{key:"play",value:function(){var e=this,t=this._el.play();return t&&t.catch((function(t){return e.dispatchEvent(new h.v(m.nQ.PLAY_FAILED,{error:t}))})),t}},{key:"pause",value:function(){return this._el.pause()}},{key:"load",value:function(e){var t=this;return this._el.load(),this._canLoadMediaSourceAdapterPromise.then((function(){return t._mediaSourceAdapter?t._mediaSourceAdapter.load(e):Promise.resolve({})})).catch((function(e){return t.dispatchEvent(new h.v(m.Rk.ERROR,e)),Promise.reject(e)}))}},{key:"enterPictureInPicture",value:function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof this._el.requestPictureInPicture?this._el.requestPictureInPicture().catch((function(t){e.dispatchEvent(new h.v(m.Rk.ERROR,new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.PLAYER,b.Z.Code.ENTER_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&(this._el.webkitSetPresentationMode("picture-in-picture"),setTimeout((function(){return e.dispatchEvent(new h.v(m.Rk.ENTER_PICTURE_IN_PICTURE))}),0))}catch(e){this.dispatchEvent(new h.v(m.Rk.ERROR,new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.PLAYER,b.Z.Code.ENTER_PICTURE_IN_PICTURE_FAILED,e)))}}},{key:"exitPictureInPicture",value:function(){var e=this;try{document.pictureInPictureEnabled&&"function"==typeof document.exitPictureInPicture&&this._el===document.pictureInPictureElement?document.exitPictureInPicture().catch((function(t){e.dispatchEvent(new h.v(m.Rk.ERROR,new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.PLAYER,b.Z.Code.EXIT_PICTURE_IN_PICTURE_FAILED,t)))})):"function"==typeof this._el.webkitSetPresentationMode&&this._el.webkitSetPresentationMode("inline")}catch(e){this.dispatchEvent(new h.v(m.Rk.ERROR,new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.PLAYER,b.Z.Code.EXIT_PICTURE_IN_PICTURE_FAILED,e)))}}},{key:"isPictureInPictureSupported",value:function(){return"function"==typeof this._el.webkitSupportsPresentationMode?this._el.webkitSupportsPresentationMode("picture-in-picture"):!!document.pictureInPictureEnabled}},{key:"getThumbnail",value:function(e){return this._mediaSourceAdapter?this._mediaSourceAdapter.getThumbnail(e):null}},{key:"src",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.src:""},set:function(e){this._mediaSourceAdapter&&(this._mediaSourceAdapter.src=e)}},{key:"currentTime",get:function(){return this._el?this._el.currentTime:0},set:function(e){this._el&&(this._el.currentTime=e)}},{key:"duration",get:function(){return this._el.duration}},{key:"liveDuration",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.liveDuration:-1}},{key:"volume",get:function(){return this._el.volume},set:function(e){this._el.volume=e}},{key:"paused",get:function(){return this._el.paused}},{key:"seeking",get:function(){return this._el.seeking}},{key:"seekable",get:function(){return this._el.seekable}},{key:"played",get:function(){return this._el.played}},{key:"buffered",get:function(){return this._el.buffered}},{key:"muted",get:function(){return this._el.muted},set:function(e){this._el.muted=e}},{key:"defaultMuted",get:function(){return this._el.defaultMuted}},{key:"poster",get:function(){return this._el.poster},set:function(e){this._el.poster=e}},{key:"preload",get:function(){return this._el.preload},set:function(e){this._el.preload=e}},{key:"autoplay",get:function(){return this._el.autoplay},set:function(e){this._el.autoplay=e}},{key:"loop",get:function(){return this._el.loop},set:function(e){this._el.loop=e}},{key:"controls",get:function(){return this._el.controls},set:function(e){this._el.controls=e}},{key:"playbackRate",get:function(){return this._el.playbackRate},set:function(e){this._el.playbackRate=e}},{key:"defaultPlaybackRate",get:function(){return this._el.defaultPlaybackRate},set:function(e){this._el.defaultPlaybackRate=e}},{key:"ended",get:function(){return this._el.ended}},{key:"error",get:function(){return this._el.error}},{key:"networkState",get:function(){return this._el.networkState}},{key:"readyState",get:function(){return this._el.readyState}},{key:"videoHeight",get:function(){return this._el.videoHeight}},{key:"videoWidth",get:function(){return this._el.videoWidth}},{key:"playsinline",get:function(){return""===this._el.getAttribute("playsinline")},set:function(e){e?this._el.setAttribute("playsinline",""):this._el.removeAttribute("playsinline")}},{key:"crossOrigin",get:function(){return this._el.getAttribute("crossorigin")},set:function(e){"string"==typeof e?this._el.setAttribute("crossorigin",e):this._el.removeAttribute("crossorigin")}},{key:"playbackRates",get:function(){return s.PLAYBACK_RATES}},{key:"isInPictureInPicture",get:function(){return!!document.pictureInPictureElement&&null!==document.pictureInPictureElement&&this._el===document.pictureInPictureElement||!!this._el.webkitPresentationMode&&"picture-in-picture"===this._el.webkitPresentationMode}},{key:"_init",value:function(e,t){this._config=t,this._reset=!1,this._loadMediaSourceAdapter(e),this.attach()}},{key:"_createVideoElement",value:function(e){this._el=s.videoElementStore[e]||_.is.createElement("video"),this._el.id=_.RO.uniqueId(5),this._el.controls=!1}},{key:"_loadMediaSourceAdapter",value:function(e){this._mediaSourceAdapter=g.Z.getMediaSourceAdapter(this.getVideoElement(),e,this._config),this._mediaSourceAdapter&&(this._droppedFramesWatcher=new A(this._mediaSourceAdapter,this._config.abr,this._el))}},{key:"_addCueChangeListener",value:function(){var e=this,t=Array.from(this._el.textTracks).find((function(e){return y.PZ.isNativeTextTrack(e)&&e.mode!==y.PZ.MODE.DISABLED}));t&&this._eventManager.listen(t,"cuechange",(function(t){return e._onCueChange(t)}))}},{key:"_removeCueChangeListeners",value:function(){var e=this;Array.from(this._el.textTracks).filter((function(e){return!y.PZ.isMetaDataTrack(e)})).forEach((function(t){e._eventManager.unlisten(t,"cuechange")}))}},{key:"_onCueChange",value:function(e){var t=e.currentTarget.activeCues,r=(0,y.z6)(t);this.dispatchEvent(new h.v(m.nQ.TEXT_CUE_CHANGED,{cues:r}))}},{key:"resetAllCues",value:function(){var e=Array.from(this._el.textTracks).find((function(e){return y.PZ.isNativeTextTrack(e)&&e.mode!==y.PZ.MODE.DISABLED}));if(e)for(var t=0;t<e.cues.length;t++)e.cues[t].hasBeenReset=!0}},{key:"_handleVideoError",value:function(){if(this._el.error){var e=this._el.error.code;if(e!==MediaError.MEDIA_ERR_ABORTED){var t=this._getMsExtendedError(),r=this._el.error.message;if(this._mediaSourceAdapter&&!this._mediaSourceAdapter.handleMediaError(this._el.error)){var n=new b.Z(b.Z.Severity.CRITICAL,b.Z.Category.MEDIA,b.Z.Code.VIDEO_ERROR,{code:e,extended:t,message:r});this.dispatchEvent(new h.v(m.Rk.ERROR,n))}}}}},{key:"_handleWaiting",value:function(){var e=this,t=!1;this._eventManager.listenOnce(this._el,m.Rk.PLAYING,(function(){return t=!0})),setTimeout((function(){t||e.dispatchEvent(new h.v(m.Rk.WAITING))}),200)}},{key:"_getMsExtendedError",value:function(){var e=this._el.error.msExtendedCode;return e&&(e<0&&(e+=Math.pow(2,32)),e=e.toString(16)),e}},{key:"_handleMetadataTrackEvents",value:function(){var e=this,t=function(t){t.mode=y.PZ.MODE.HIDDEN,e._eventManager.listen(t,"cuechange",(function(){var t=[];Array.from(e._el.textTracks).forEach((function(e){y.PZ.isMetaDataTrack(e)&&(t=t.concat((0,y.z6)(e.activeCues)))})),t=t.sort((function(e,t){return e.startTime-t.startTime})),e.dispatchEvent(new h.v(m.nQ.TIMED_METADATA,{cues:t})),e.dispatchEvent(new h.v(m.nQ.TIMED_METADATA_CHANGE,{cues:t.map((function(e){return(0,v.cP)(e)}))}))}))};Array.from(this._el.textTracks).forEach((function(e){y.PZ.isMetaDataTrack(e)&&t(e)})),this._eventManager.listen(this._el.textTracks,"addtrack",(function(e){y.PZ.isMetaDataTrack(e.track)&&t(e.track)})),this._eventManager.listen(this._el.textTracks,"change",(function(){Array.from(e._el.textTracks).forEach((function(e){y.PZ.isMetaDataTrack(e)&&e.mode!==y.PZ.MODE.HIDDEN&&(e.mode=y.PZ.MODE.HIDDEN)}))}))}},{key:"targetBuffer",get:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.targetBuffer:NaN}},{key:"availableBuffer",get:function(){var e=0;if(this.buffered)for(var t=0;t<this.buffered.length;t++)this.buffered.start(t)<=this._el.currentTime&&this._el.currentTime<=this.buffered.end(t)&&(e=this.buffered.end(t)-this._el.currentTime);return e}},{key:"addTextTrack",value:function(e,t,r){return this._el.addTextTrack(e,t,r)}},{key:"getNativeTextTracks",value:function(){return Array.from(this._el.textTracks)}},{key:"getDrmInfo",value:function(){return this._mediaSourceAdapter?this._mediaSourceAdapter.getDrmInfo():null}}],[{key:"isSupported",value:function(){try{var e=_.is.createElement("video");return e.volume=.5,!!e.canPlayType}catch(e){return!1}}},{key:"createEngine",value:function(e,t,r){return new this(e,t,r)}},{key:"canPlaySource",value:function(e,t,r){return g.Z.canPlaySource(e,t,r)}},{key:"runCapabilities",value:function(){s._capabilities.forEach((function(e){return e.runCapability()}))}},{key:"getCapabilities",value:function(){var e=[];return s._capabilities.forEach((function(t){return e.push(t.getCapability())})),Promise.all(e).then((function(e){var t={};return e.forEach((function(e){return Object.assign(t,e)})),(0,o.Z)({},s.id,t)}))}},{key:"setCapabilities",value:function(e){s._capabilities.forEach((function(t){return t.setCapabilities(e)}))}},{key:"prepareVideoElement",value:function(e){if(!s.videoElementStore[e]){s._logger.debug("Create the video element for playing ".concat(e));var t=_.is.createElement("video");s.videoElementStore[e]=t}s._logger.debug("Prepare the video element for playing ".concat(e)),s.videoElementStore[e].load()}}]),s}(p.H);(0,o.Z)(S,"_logger",(0,s.ZP)("Html5")),(0,o.Z)(S,"_capabilities",[E]),(0,o.Z)(S,"id","html5"),(0,o.Z)(S,"videoElementStore",{}),(0,o.Z)(S,"PLAYBACK_RATES",[.5,1,1.5,2]);var C=function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,null,[{key:"register",value:function(t,r){t&&!e._engineProviders[t]?(e._logger.debug("Engine <".concat(t,"> has been registered successfully")),e._engineProviders[t]=r):e._logger.debug("Engine <".concat(t,"> is already registered, do not register again"))}},{key:"unRegister",value:function(t){e._engineProviders[t]&&(e._logger.debug("Unregistered <".concat(t,"> Engine")),delete e._engineProviders[t])}},{key:"getEngines",value:function(){return Object.keys(e._engineProviders).map((function(t){return e._engineProviders[t]}))}},{key:"destroy",value:function(){e._engineProviders={}}}]),e}();(0,o.Z)(C,"_logger",(0,s.ZP)("EngineProvider")),(0,o.Z)(C,"_engineProviders",{}),S.isSupported()&&C.register(S.id,S);var P=C.register,x=C.unRegister},488:function(e,t,r){"use strict";r.d(t,{r:function(){return n}});var n={HTML5:"html5",FLASH:"flash",SILVERLIGHT:"silverlight",CAST:"cast",YOUTUBE:"youtube",IMAGE:"image"}},6145:function(e,t,r){"use strict";r.d(t,{X:function(){return n}});var n={ANONYMOUS:"anonymous",USE_CREDENTIALS:"use-credentials"}},4651:function(e,t,r){"use strict";r.d(t,{Z:function(){return E}});var n,a=r(5671),i=r(3144),o=r(7326),s=r(9340),l=r(2963),u=r(1120),c=r(4942),d=r(8987),p=r(8171),h=r(962),f=r(2114),m=r(4358),g=r(4877),y=r(7812),v=r(6462),_=r(4270),k=r(2983),E=function(e){(0,s.Z)(p,e);var t,r,n=(t=p,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var a=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function p(e,t){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,a.Z)(this,p),r=n.call(this),(0,c.Z)((0,o.Z)(r),"_capabilities",{fpsControl:!1}),r._videoElement=e,r._sourceObj=t,r._config=i,r._onDurationChanged=function(){r.isLive()&&r._videoElement.paused&&r._trigger(f.Rk.TIME_UPDATE)},r._eventManager=new _.Q,r._handleLiveTimeUpdate(),r}return(0,i.Z)(p,[{key:"destroy",value:function(){return this._sourceObj=void 0,this._config={},this.disableNativeTextTracks(),this._videoElement.removeEventListener(f.Rk.DURATION_CHANGE,this._onDurationChanged),this._eventManager.destroy(),Promise.resolve()}},{key:"_onTrackChanged",value:function(e){e instanceof g.Z?(p._logger.debug("Video track changed",e),this._trigger(f.nQ.VIDEO_TRACK_CHANGED,{selectedVideoTrack:e})):e instanceof y.Z?(p._logger.debug("Audio track changed",e),this._trigger(f.nQ.AUDIO_TRACK_CHANGED,{selectedAudioTrack:e})):e instanceof v.ZP?(p._logger.debug("Text track changed",e),this._trigger(f.nQ.TEXT_TRACK_CHANGED,{selectedTextTrack:e})):e instanceof k.Z&&(p._logger.debug("Image track changed",e),this._trigger(f.nQ.IMAGE_TRACK_CHANGED,{selectedImageTrack:e}))}},{key:"_trigger",value:function(e,t){this.dispatchEvent(new d.v(e,t))}},{key:"load",value:function(){return p._throwNotImplementedError("load")}},{key:"selectVideoTrack",value:function(e){return p._throwNotImplementedError("selectVideoTrack")}},{key:"selectAudioTrack",value:function(e){p._throwNotImplementedError("selectAudioTrack")}},{key:"selectTextTrack",value:function(e){p._throwNotImplementedError("selectTextTrack")}},{key:"selectImageTrack",value:function(e){}},{key:"hideTextTrack",value:function(){p._throwNotImplementedError("hideTextTrack")}},{key:"enableAdaptiveBitrate",value:function(){p._throwNotImplementedError("enableAdaptiveBitrate")}},{key:"isAdaptiveBitrateEnabled",value:function(){return p._throwNotImplementedError("isAdaptiveBitrateEnabled")}},{key:"applyABRRestriction",value:function(e){return p._throwNotImplementedError("applyABRRestriction")}},{key:"_getLiveEdge",value:function(){return p._throwNotImplementedError("_getLiveEdge")}},{key:"seekToLiveEdge",value:function(){p._throwNotImplementedError("seekToLiveEdge")}},{key:"isLive",value:function(){return p._throwNotImplementedError("isLive")}},{key:"isOnLiveEdge",value:function(){return 0===this.getSegmentDuration()||this.liveDuration-this._videoElement.currentTime<=2*this.getSegmentDuration()}},{key:"setMaxBitrate",value:function(e){}},{key:"attachMediaSource",value:function(){}},{key:"detachMediaSource",value:function(){}},{key:"_handleLiveTimeUpdate",value:function(){this._videoElement.addEventListener(f.Rk.DURATION_CHANGE,this._onDurationChanged)}},{key:"disableNativeTextTracks",value:function(){Array.from(this._videoElement.textTracks).forEach((function(e){v.ZP.isNativeTextTrack(e)&&!v.ZP.isExternalTrack(e)&&(e.mode=v.ZP.MODE.DISABLED)}))}},{key:"handleMediaError",value:function(e){return!1}},{key:"getStartTimeOfDvrWindow",value:function(){return p._throwNotImplementedError("getStartTimeOfDvrWindow")}},{key:"getThumbnail",value:function(e){return null}},{key:"getSegmentDuration",value:function(){return p._throwNotImplementedError("getSegmentDuration")}},{key:"liveDuration",get:function(){return p._throwNotImplementedError("liveDuration")}},{key:"src",get:function(){return this._loadPromise&&this._sourceObj?this._sourceObj.url:""},set:function(e){!this._loadPromise&&this._sourceObj&&(this._sourceObj.url=e)}},{key:"capabilities",get:function(){return this._capabilities}},{key:"targetBuffer",get:function(){return NaN}},{key:"getDrmInfo",value:function(){return null}}],[{key:"isSupported",value:function(){return!0}},{key:"isMSESupported",value:function(){var e=MediaSource||window.WebKitMediaSource;return!!e&&"function"==typeof e.isTypeSupported}},{key:"canPlayType",value:function(e,t){return p._throwNotImplementedError("static canPlayType")}},{key:"_throwNotImplementedError",value:function(e){throw new h.Z(h.Z.Severity.CRITICAL,h.Z.Category.PLAYER,h.Z.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,e)}}]),p}(p.H);n=E,(0,c.Z)(E,"id","BaseAdapter"),(0,c.Z)(E,"getLogger",m.ZP),(0,c.Z)(E,"_logger",n.getLogger(n.id))},2588:function(e,t,r){"use strict";r.d(t,{Z:function(){return U},L:function(){return j}});var n=r(5671),a=r(3144),i=r(4942),o=r(3433),s=r(7326),l=r(1752),u=r(9340),c=r(2963),d=r(1120),p=r(2114),h=r(4877),f=r(7812),m=r(6462),g=r(6975),y=r(4651);function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _,k=r(1177),E=r(4821),b=r(7237),T=r(4358),A=(0,T.ZP)("FairPlay"),S=function(){function e(){(0,n.Z)(this,e)}return(0,a.Z)(e,null,[{key:"isConfigured",value:function(e,t){return b.J.FAIRPLAY===t.keySystem&&!!e.find((function(e){return e.scheme===t.keySystem}))}},{key:"canPlayDrm",value:function(e){var t=e.some((function(e){return e.scheme===b.J.FAIRPLAY}))&&!!window.WebKitMediaKeys;return A.debug("Can play DRM scheme of: ".concat(b.J.FAIRPLAY," is ").concat(t.toString())),t}},{key:"setDrmPlayback",value:function(e,t){A.debug("Sets drm playback");var r=t.find((function(e){return e.scheme===b.J.FAIRPLAY}));r&&(e.licenseUrl=r.licenseUrl,e.certificate=r.certificate)}}]),e}(),C=r(2069),P=r(962),x=JSON.parse('{"heartbeatTimeout":30000}'),w=r(9439),I=r(4270),M="com.apple.fps.1_0",R={NEED_KEY:"webkitneedkey",KEY_MESSAGE:"webkitkeymessage",KEY_ADDED:"webkitkeyadded",KEY_ERROR:"webkitkeyerror"},D=function(){function e(t,r,a,o){var s=this;(0,n.Z)(this,e),(0,i.Z)(this,"_logger",(0,T.ZP)("FairPlayDrmHandler")),(0,i.Z)(this,"_retryLicenseRequest",4),(0,i.Z)(this,"_defaultConfig",{licenseUrl:"",certificate:"",network:{responseFilter:function(t,r){var n={};try{var a=new DataView(r.data),i=(new TextDecoder).decode(a).trim();n=JSON.parse(i)}catch(e){return void s._onError(P.Z.Code.BAD_FAIRPLAY_RESPONSE,{error:e,responseText:r.data})}var o=e._validateResponse(n);o.valid?r.data=e._base64DecodeUint8Array(n.ckc):s._onError(P.Z.Code.BAD_FAIRPLAY_RESPONSE,o)}}}),this._config=E.c7.mergeDeep({},this._defaultConfig,r),this._errorCallback=a,this._drmResponseCallback=o,this._videoElement=t,this._onWebkitNeedKeyHandler=function(e){return s._onWebkitNeedKey(e)},this._eventManager=new I.Q,this._eventManager.listen(this._videoElement,R.NEED_KEY,this._onWebkitNeedKeyHandler)}return(0,a.Z)(e,[{key:"_onWebkitNeedKey",value:function(t){var r=this;this._logger.debug("Webkit need key triggered");var n=t.target,a=t.initData,i=e._extractContentId(a),o=e._base64DecodeUint8Array(this._config.certificate);if(a=e._concatInitDataIdAndCertificate(a,i,o),!n.webkitKeys){var s=this._selectKeySystem();this._logger.debug("Sets media keys"),n.webkitSetMediaKeys(new WebKitMediaKeys(s))}n.webkitKeys||this._onError(P.Z.Code.COULD_NOT_CREATE_MEDIA_KEYS),this._logger.debug("Creates session"),this._keySession=n.webkitKeys.createSession("video/mp4",a),this._keySession||this._onError(P.Z.Code.COULD_NOT_CREATE_KEY_SESSION),this._keySession.contentId=i,this._eventManager.listen(this._keySession,R.KEY_MESSAGE,(function(e){return r._onWebkitKeyMessage(e)})),this._eventManager.listen(this._keySession,R.KEY_ADDED,(function(){return r._onWebkitKeyAdded()})),this._eventManager.listen(this._keySession,R.KEY_ERROR,(function(e){return r._onWebkitKeyError(e)}))}},{key:"getDrmInfo",value:function(){var e=this._config;return{certificate:e.certificate,licenseUrl:e.licenseUrl,scheme:b.J.FAIRPLAY}}},{key:"destroy",value:function(){this._eventManager.destroy(),this._keySession.close(),this._keySession=null}},{key:"_onWebkitKeyMessage",value:function(t){var r=this;this._logger.debug("Webkit key message triggered");var n=t.message,a=new XMLHttpRequest;a.responseType="arraybuffer",this._eventManager.listenOnce(a,"load",(function(e){return r._licenseRequestLoaded(e)}));var i,o={url:this._config.licenseUrl,body:e._base64EncodeUint8Array(n),headers:{}},s=this._config.network.requestFilter;if(s){this._logger.debug("Apply request filter");try{i=s(g.x.LICENSE,o)}catch(e){i=Promise.reject(e)}}(i=i||Promise.resolve(o)).then((function(e){a.open("POST",e.url,!0);var t=!0;e.headers&&Object.entries(e.headers).forEach((function(e){var r=(0,w.Z)(e,2),n=r[0],i=r[1];"string"==typeof i&&a.setRequestHeader(n,i),t&&(t="content-type"!==n.toLowerCase())})),"boolean"==typeof e.withCredentials&&(a.withCredentials=e.withCredentials),t&&a.setRequestHeader("Content-type","application/json"),r._logger.debug("Ready for license request"),a.onerror=function(){r._onError(P.Z.Code.LICENSE_REQUEST_FAILED,{status:a.status,responseText:a.responseText})},r._licenseRequestTime=Date.now(),a.send(e.body)})).catch((function(e){r._errorCallback(new P.Z(P.Z.Severity.CRITICAL,P.Z.Category.NETWORK,P.Z.Code.REQUEST_FILTER_ERROR,e)),r.destroy()}))}},{key:"_onWebkitKeyAdded",value:function(){this._logger.debug("Decryption key was added to session")}},{key:"_onWebkitKeyError",value:function(e){this._logger.error("A decryption key error was encountered",e),this._retryLicenseRequest<=0&&this._onError(P.Z.Code.LICENSE_REQUEST_FAILED,e.target.error),this._retryLicenseRequest--}},{key:"_licenseRequestLoaded",value:function(e){var t=this;this._logger.debug("License request loaded");var r=e.target;if(r.status>299)this._onError(P.Z.Code.LICENSE_REQUEST_FAILED,{status:r.status,error:r.responseText});else{if(this._drmResponseCallback){var n=Date.now()-this._licenseRequestTime;this._drmResponseCallback({licenseTime:n/1e3,scheme:b.J.FAIRPLAY})}var a,i=r.responseURL,o=r.response,s={url:i,originalUrl:this._config.licenseUrl,data:o,headers:E.eV.convertHeadersToDictionary(r.getAllResponseHeaders())};this._logger.debug("Apply response filter");try{a=this._config.network.responseFilter(g.x.LICENSE,s)}catch(e){a=Promise.reject(e)}(a=a||Promise.resolve(s)).then((function(e){t._keySession.update(e.data)})).catch((function(e){t._errorCallback(new P.Z(P.Z.Severity.CRITICAL,P.Z.Category.NETWORK,P.Z.Code.RESPONSE_FILTER_ERROR,e)),t.destroy()}))}}},{key:"_onError",value:function(e,t){this._errorCallback(new P.Z(P.Z.Severity.CRITICAL,P.Z.Category.DRM,e,t))}},{key:"_selectKeySystem",value:function(){var e=null;return WebKitMediaKeys.isTypeSupported(M,"video/mp4")?e=M:this._logger.warn("Key System not supported"),e}}],[{key:"_validateResponse",value:function(e){return e.message&&e.message.indexOf("error")>0||null===e.reference||500===e.status_code?{valid:!1,details:"internal server error"}:""===e.ckc?{valid:!1,details:"ckc is missing"}:{valid:!0}}},{key:"_extractContentId",value:function(t){var r=document.createElement("a");return r.href=e._arrayToString(t),r.hostname}},{key:"_arrayToString",value:function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))}},{key:"_base64DecodeUint8Array",value:function(e){for(var t=window.atob(e),r=t.length,n=new Uint8Array(new ArrayBuffer(r)),a=0;a<r;a++)n[a]=t.charCodeAt(a);return n}},{key:"_concatInitDataIdAndCertificate",value:function(t,r,n){"string"==typeof r&&(r=e._stringToArray(r));var a=0,i=new ArrayBuffer(t.byteLength+4+r.byteLength+4+n.byteLength),o=new DataView(i);new Uint8Array(i,a,t.byteLength).set(t),a+=t.byteLength,o.setUint32(a,r.byteLength,!0),a+=4;var s=new Uint8Array(i,a,r.byteLength);return s.set(r),a+=s.byteLength,o.setUint32(a,n.byteLength,!0),a+=4,new Uint8Array(i,a,n.byteLength).set(n),new Uint8Array(i,0,i.byteLength)}},{key:"_stringToArray",value:function(e){for(var t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),n=0,a=e.length;n<a;n++)r[n]=e.charCodeAt(n);return r}},{key:"_base64EncodeUint8Array",value:function(e){for(var t,r,n,a,i,o,s,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;c<e.length;)a=(t=e[c++])>>2,i=(3&t)<<4|(r=c<e.length?e[c++]:Number.NaN)>>4,o=(15&r)<<2|(n=c<e.length?e[c++]:Number.NaN)>>6,s=63&n,isNaN(r)?o=s=64:isNaN(n)&&(s=64),u+=l.charAt(a)+l.charAt(i)+l.charAt(o)+l.charAt(s);return u}}]),e}();function O(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}(0,i.Z)(D,"WebkitEvents",R),D.WebkitEvents=R;var N=function(e){(0,u.Z)(_,e);var t,r,y=(t=_,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,d.Z)(t);if(r){var a=(0,d.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,c.Z)(this,e)});function _(e,t,r){var a;return(0,n.Z)(this,_),a=y.call(this,e,t,r),(0,i.Z)((0,s.Z)(a),"_lastTimeUpdate",0),(0,i.Z)((0,s.Z)(a),"_waitingEventTriggered",!1),(0,i.Z)((0,s.Z)(a),"_segmentDuration",0),(0,i.Z)((0,s.Z)(a),"_startTimeOfDvrWindow",0),(0,i.Z)((0,s.Z)(a),"_mediaErrorRecoveryAttempts",0),(0,i.Z)((0,s.Z)(a),"_lastTimeDetach",NaN),(0,i.Z)((0,s.Z)(a),"_startTimeAttach",NaN),(0,i.Z)((0,s.Z)(a),"_nativeTextTracksMap",{}),(0,i.Z)((0,s.Z)(a),"_captionsHidden",!1),_._logger.debug("Creating adapter"),a._config=E.c7.mergeDeep({},x,a._config),a._progressiveSources=r.progressiveSources,a._liveEdge=0,a._setStarTimeOfDvrWindowInterval(),a}return(0,a.Z)(_,[{key:"_dispatchErrorCallback",value:function(e){this._trigger(p.Rk.ERROR,e)}},{key:"_dispatchDRMLicenseLoaded",value:function(e){this._trigger(p.nQ.DRM_LICENSE_LOADED,e)}},{key:"_maybeSetDrmPlayback",value:function(){var e=this;if(_._drmProtocol&&this._sourceObj&&this._sourceObj.drmData){var t={licenseUrl:"",certificate:"",network:this._config.network};_._drmProtocol.setDrmPlayback(t,this._sourceObj.drmData),this._drmHandler=new D(this._videoElement,t,(function(t){return e._dispatchErrorCallback(t)}),(function(t){return e._dispatchDRMLicenseLoaded(t)}))}}},{key:"_setProgressiveSource",value:function(){var e=function(e,t,r){var n=null;if(r&&e){var a,i=[],o=1/0,s=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(e);try{for(s.s();!(a=s.n()).done;){var l=a.value,u=Math.abs(l.width-t);u<o?(o=u,i=[l]):u===o&&i.push(l)}}catch(e){s.e(e)}finally{s.f()}for(var c=t/r,d=i,p=1/0,h=0,f=i;h<f.length;h++){var m=f[h];if(m.height){var g=Math.abs(m.width/m.height-c);g<p?(p=g,d=[m]):g===p&&d.push(m)}}for(var y=0,_=0,k=d;_<k.length;_++){var E=k[_];(E.bandwidth>y||!E.bandwidth)&&(y=E.bandwidth||y,n=E)}}return n}(this._progressiveSources,this._videoElement.offsetWidth,this._videoElement.offsetHeight);e&&(this._sourceObj=e)}},{key:"_isProgressivePlayback",value:function(){return!!this._sourceObj&&_._progressiveMimeTypes.includes(this._sourceObj.mimetype.toLowerCase())}},{key:"load",value:function(e){var t=this;return this._maybeSetDrmPlayback(),this._loadPromise||(this._loadPromise=new Promise((function(r,n){t._lastTimeUpdate=e||0;var a="number"==typeof e?e:-1,i=t._startTimeAttach||a;t._loadPromiseReject=n,t._eventManager.listenOnce(t._videoElement,p.Rk.LOADED_DATA,(function(){return t._onLoadedData(r,i)})),t._eventManager.listenOnce(t._videoElement,p.Rk.PLAYING,(function(){return t._onPlaying(i)})),t._eventManager.listen(t._videoElement,p.Rk.TIME_UPDATE,(function(){return t._onTimeUpdate()})),t._eventManager.listen(t._videoElement,p.Rk.PLAY,(function(){return t._resetHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,p.Rk.PAUSE,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,p.Rk.ENDED,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,p.Rk.ABORT,(function(){return t._clearHeartbeatTimeout()})),t._eventManager.listen(t._videoElement,p.Rk.SEEKED,(function(){return t._syncCurrentTime()})),t._eventManager.listen(t._videoElement,p.Rk.WAITING,(function(){return t._waitingEventTriggered=!0})),t._eventManager.listen(t._videoElement,p.Rk.PLAYING,(function(){return t._waitingEventTriggered=!1})),t._eventManager.listen(window,"focus",(function(){setTimeout((function(){C.Z.isIOS&&(t._videoElement.currentTime=t._videoElement.currentTime>.1?t._videoElement.currentTime-.1:0),t._syncCurrentTime()}),1e3)})),t._isProgressivePlayback()&&t._setProgressiveSource(),t._sourceObj&&t._sourceObj.url?t._setSrc().then((function(){t._trigger(p.nQ.ABR_MODE_CHANGED,{mode:t._isProgressivePlayback()?"manual":"auto"}),t._videoElement.load()})):t._videoElement.load()}))),this._loadPromise}},{key:"_handleDecodeError",value:function(e){var t=this;_._logger.debug("handleDecodeError",e);var r=this._videoElement.currentTime,n=this._getActivePKAudioTrack(),a=this._getActivePKTextTrack();this._videoElement.load(),this._eventManager.listenOnce(this._videoElement,p.Rk.PLAYING,(function(){t._mediaErrorRecoveryAttempts=0})),this._eventManager.listenOnce(this._videoElement,p.Rk.CAN_PLAY,(function(){_._logger.debug("CAN_PLAY"),t._videoElement.currentTime=r,t._videoElement.play(),t._videoElement.pause(),n&&t.selectAudioTrack(n),a?t.selectTextTrack(a):t.disableNativeTextTracks()}))}},{key:"handleMediaError",value:function(e){return this._loadPromiseReject?(this._loadPromiseReject(new P.Z(P.Z.Severity.CRITICAL,P.Z.Category.MEDIA,P.Z.Code.NATIVE_ADAPTER_LOAD_FAILED,e)),!0):!!(e&&e.code===MediaError.MEDIA_ERR_DECODE&&(this._mediaErrorRecoveryAttempts++,this._mediaErrorRecoveryAttempts<=3))&&(this._handleDecodeError(e),!0)}},{key:"attachMediaSource",value:function(){this._startTimeAttach=this._lastTimeDetach,this._lastTimeDetach=NaN}},{key:"detachMediaSource",value:function(){this._lastTimeDetach=this._videoElement.currentTime,this._videoElement&&this._videoElement.src&&(E.is.setAttribute(this._videoElement,"src",""),E.is.removeAttribute(this._videoElement,"src")),this._loadPromise=void 0}},{key:"_setSrc",value:function(){var e,t=this,r={url:this._sourceObj?this._sourceObj.url:"",body:null,headers:{}};if("function"==typeof E.c7.getPropertyPath(this._config,"network.requestFilter"))try{_._logger.debug("Apply request filter"),e=this._config.network.requestFilter(g.x.MANIFEST,r)}catch(t){e=Promise.reject(t)}return(e=e||Promise.resolve(r)).then((function(e){if(t._config.useSourceTag){var r,n=document.createElement("source"),a=(null===(r=t._sourceObj)||void 0===r?void 0:r.mimetype.toLowerCase())||"";if(n.setAttribute("src",e.url),n.setAttribute("type",a),t._config.useMediaOptionAttribute){var i={};if(t._config.mediaOptionAttribute&&(i=t._config.mediaOptionAttribute),t._config.abrEwmaDefaultEstimate){var o={start:t._config.abrEwmaDefaultEstimate};E.c7.createPropertyPath(i,"option.adaptiveStreaming.bps",o)}_._logger.debug("Setting mediaOption -",i);var s=encodeURI(JSON.stringify(i));n.setAttribute("type",a+";mediaOption="+s)}t._videoElement.appendChild(n)}else t._videoElement.src=e.url})).catch((function(e){t._trigger(p.Rk.ERROR,new P.Z(P.Z.Severity.CRITICAL,P.Z.Category.NETWORK,P.Z.Code.REQUEST_FILTER_ERROR,e))})),e}},{key:"_onPlaying",value:function(e){this.isLive()&&this._setStartTime(e)}},{key:"_onLoadedData",value:function(e,t){var r=this,n=function(){r._playerTracks=r._getParsedTracks(),r._addNativeAudioTrackChangeListener(),r._addNativeTextTrackChangeListener(),r._addNativeTextTrackAddedListener(),_._logger.debug("The source has been loaded successfully"),r._loadPromiseReject=void 0,e({tracks:r._playerTracks}),r.isLive()&&r._handleLiveDurationChange()};void 0!==t&&t>-1&&(this._videoElement.currentTime=t),this._videoElement.textTracks.length>0?n():this._eventManager.listenOnce(this._videoElement,p.Rk.CAN_PLAY,n.bind(this)),this._startTimeAttach=NaN}},{key:"_setStartTime",value:function(e){"number"==typeof e&&e>-1&&(this._videoElement.currentTime=e)}},{key:"_onTimeUpdate",value:function(){this._videoElement.paused||(this._videoElement.currentTime>this._lastTimeUpdate?(this._waitingEventTriggered&&(this._waitingEventTriggered=!1,this._trigger(p.Rk.PLAYING)),this._resetHeartbeatTimeout()):this._videoElement.currentTime<this._lastTimeUpdate?this._syncCurrentTime():(this._waitingEventTriggered=!0,this._trigger(p.Rk.WAITING))),this._handleVideoTracksChange()}},{key:"_syncCurrentTime",value:function(){this._lastTimeUpdate=this._videoElement.currentTime}},{key:"_resetHeartbeatTimeout",value:function(){var e=this;this._lastTimeUpdate=this._videoElement.currentTime,this._clearHeartbeatTimeout(),this._heartbeatTimeoutId=setTimeout((function(){e._clearHeartbeatTimeout(),e._trigger(p.Rk.ERROR,new P.Z(P.Z.Severity.CRITICAL,P.Z.Category.NETWORK,P.Z.Code.TIMEOUT,"The player exceeded max buffer time of ".concat(e._config.heartbeatTimeout," ms. No progress has been done during this time.")))}),this._config.heartbeatTimeout)}},{key:"_clearHeartbeatTimeout",value:function(){this._heartbeatTimeoutId&&(clearTimeout(this._heartbeatTimeoutId),this._heartbeatTimeoutId=void 0)}},{key:"_handleVideoTracksChange",value:function(){if(!this._isProgressivePlayback()){var e=this._videoElement,t=e.videoHeight,r=e.videoWidth,n=e.videoTracks;if(!this._videoDimensions||t!==this._videoDimensions.videoHeight||r!==this._videoDimensions.videoWidth){this._videoDimensions={videoHeight:t,videoWidth:r};var a={language:"",height:t,width:r,active:!0,index:Array.from(n).findIndex((function(e){return e.selected}))};this._onTrackChanged(new h.Z(a))}}}},{key:"destroy",value:function(){var e=this;return _._logger.debug("destroy"),new Promise((function(t,r){e._maybeRemoveSourceTag(),(0,l.Z)((0,d.Z)(_.prototype),"destroy",e).call(e).then((function(){e._drmHandler&&e._drmHandler.destroy(),e._waitingEventTriggered=!1,e._progressiveSources=[],e._loadPromise=void 0,e._nativeTextTracksMap={},e._loadPromiseReject=void 0,e._liveEdge=0,e._lastTimeUpdate=0,e._lastTimeDetach=NaN,e._startTimeAttach=NaN,e._videoDimensions=void 0,e._clearHeartbeatTimeout(),clearInterval(e._startTimeOfDvrWindowInterval),e._liveDurationChangeInterval&&(clearInterval(e._liveDurationChangeInterval),e._liveDurationChangeInterval=void 0),t()}),(function(){return r}))}))}},{key:"_maybeRemoveSourceTag",value:function(){if(this._config.useSourceTag&&this._videoElement){var e=this._videoElement.firstChild;e&&(e.setAttribute("src",""),e.removeAttribute("src"),this._videoElement.removeChild(e))}}},{key:"_getParsedTracks",value:function(){var e=this._getParsedVideoTracks(),t=this._getParsedAudioTracks(),r=this._getParsedTextTracks();return[].concat((0,o.Z)(e),(0,o.Z)(t),(0,o.Z)(r))}},{key:"_getParsedVideoTracks",value:function(){return this._isProgressivePlayback()?this._getParsedProgressiveVideoTracks():this._getParsedAdaptiveVideoTracks()}},{key:"_getParsedProgressiveVideoTracks",value:function(){var e=this._progressiveSources,t=[];if(e)for(var r=0;r<e.length;r++){var n={id:e[r].id,bandwidth:e[r].bandwidth,width:e[r].width,height:e[r].height,active:!!this._sourceObj&&e[r].id===this._sourceObj.id,index:r};t.push(new h.Z(n))}return t}},{key:"_getParsedAdaptiveVideoTracks",value:function(){var e=this._videoElement.videoTracks,t=[];if(e)for(var r=0;r<e.length;r++){var n={id:e[r].id,active:e[r].selected,label:e[r].label,language:e[r].language,index:r};t.push(new h.Z(n))}return t}},{key:"_getParsedAudioTracks",value:function(){var e=this._videoElement.audioTracks,t=[];if(e)for(var r=0;r<e.length;r++){var n={id:e[r].id,active:e[r].enabled,label:e[r].label,language:e[r].language,index:r};t.push(new f.Z(n))}return t}},{key:"_getParsedTextTracks",value:function(){var e=[this._config.captionsTextTrack1Label,this._config.captionsTextTrack2Label],t=[this._config.captionsTextTrack1LanguageCode,this._config.captionsTextTrack2LanguageCode],r=this._videoElement.textTracks,n=[];if(r){for(var a=0;a<r.length;a++)if(!m.ZP.isExternalTrack(r[a])){var i={kind:r[a].kind,active:r[a].mode===m.ZP.MODE.SHOWING,label:r[a].label,language:r[a].language,available:!0};if(i.kind===m.ZP.KIND.SUBTITLES){var o=new m.ZP(i);n.push(o),this._nativeTextTracksMap[o.index]=r[a]}else if(i.kind===m.ZP.KIND.CAPTIONS&&this._config.enableCEA708Captions){i.label=i.label||e.shift(),i.language=i.language||t.shift(),i.available=this._captionsHidden;var s=new m.ZP(i);n.push(s),this._nativeTextTracksMap[s.index]=r[a]}}this._captionsHidden||this._maybeShow708Captions()}return n}},{key:"_maybeShow708Captions",value:function(){var e=this,t=Array.from(this._videoElement.textTracks).filter((function(e){return e.kind===m.ZP.KIND.CAPTIONS})),r=t.find((function(e){return e.mode===m.ZP.MODE.SHOWING||e.mode===m.ZP.MODE.HIDDEN}))||t[0];r&&(r.mode=m.ZP.MODE.HIDDEN,this._captionsHidden=!0,this._eventManager.listenOnce(r,"cuechange",(function(){e._getPKTextTracks().forEach((function(e){return(e.available=!0)&&(e.mode=m.ZP.MODE.DISABLED)})),e._trigger(p.nQ.TRACKS_CHANGED,{tracks:e._playerTracks})})))}},{key:"selectVideoTrack",value:function(e){this._isProgressivePlayback()?this._selectProgressiveVideoTrack(e):this.selectAdaptiveVideoTrack(e)}},{key:"_selectProgressiveVideoTrack",value:function(e){var t=this,r=this._progressiveSources;if(e instanceof h.Z&&r&&r[e.index]){var n=this._videoElement.currentTime,a=this._videoElement.paused;e.active=!0,this._sourceObj=r[e.index],this._eventManager.listenOnce(this._videoElement,p.Rk.LOADED_DATA,(function(){"Android Browser"===C.Z.browser.name?(t._eventManager.listenOnce(t._videoElement,p.Rk.DURATION_CHANGE,(function(){t._videoElement.currentTime=n})),t._eventManager.listenOnce(t._videoElement,p.Rk.SEEKED,(function(){t._onTrackChanged(e),a&&t._videoElement.pause()})),t._videoElement.play()):(t._eventManager.listenOnce(t._videoElement,p.Rk.SEEKED,(function(){t._onTrackChanged(e)})),t._videoElement.currentTime=n,a||t._videoElement.play())})),this._setSrc()}}},{key:"selectAdaptiveVideoTrack",value:function(e){var t=this._videoElement.videoTracks;e instanceof h.Z&&t&&t[e.index]&&(this._disableVideoTracks(),t[e.index].selected=!0,this._onTrackChanged(e))}},{key:"selectAudioTrack",value:function(e){_._logger.debug("selectAudioTrack");var t=this._videoElement.audioTracks;e instanceof f.Z&&t&&t[e.index]&&(this._removeNativeAudioTrackChangeListener(),this._switchAudioTrack(e.index),this._onTrackChanged(e),this._addNativeAudioTrackChangeListener())}},{key:"_removeNativeAudioTrackChangeListener",value:function(){this._videoElement.audioTracks&&this._eventManager.unlisten(this._videoElement.audioTracks,"change")}},{key:"_addNativeAudioTrackChangeListener",value:function(){var e=this;this._videoElement.audioTracks&&this._eventManager.listen(this._videoElement.audioTracks,"change",(function(){return e._onNativeAudioTrackChange()}))}},{key:"_getPKAudioTracks",value:function(){return this._playerTracks.filter((function(e){return e instanceof f.Z}))}},{key:"_getActivePKAudioTrack",value:function(){return this._getPKAudioTracks().find((function(e){return!0===e.active}))}},{key:"_onNativeAudioTrackChange",value:function(){var e=this,t=function(){for(var t=0;t<e._videoElement.audioTracks.length;t++)if(e._videoElement.audioTracks[t].enabled)return t;return-1}(),r=this._getActivePKAudioTrack(),n=r?r.index:-1;if(t!==n){var a=this._getPKAudioTracks().find((function(e){return e.index===t}));a&&(_._logger.debug("Native selection of track, update the player audio track ("+n+" -> "+t+")"),this._onTrackChanged(a))}}},{key:"selectTextTrack",value:function(e){if(e instanceof m.ZP&&m.ZP.isNativeTextTrack(e)){this._removeNativeTextTrackChangeListener();var t=this._nativeTextTracksMap[e.index];t&&(this.disableNativeTextTracks(),t.mode=this._getDisplayTextTrackModeString(),this._onTrackChanged(e),this._addNativeTextTrackChangeListener())}}},{key:"_removeNativeTextTrackChangeListener",value:function(){this._videoElement.textTracks&&this._eventManager.unlisten(this._videoElement.textTracks,"change")}},{key:"_addNativeTextTrackChangeListener",value:function(){var e=this;this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"change",(function(){return e._onNativeTextTrackChange()}))}},{key:"_getPKTextTracks",value:function(){return this._playerTracks.filter((function(e){return e instanceof m.ZP}))}},{key:"_getActivePKTextTrack",value:function(){return this._getPKTextTracks().find((function(e){return!0===e.active}))}},{key:"_onNativeTextTrackChange",value:function(){var e=this,t=this._getPKTextTracks(),r=t.find((function(e){return"off"===e.language})),n=function(){for(var t in e._nativeTextTracksMap)if(e._getDisplayTextTrackModeString()===e._nativeTextTracksMap[t].mode)return Number(t);return-1}(),a=this._getActivePKTextTrack(),i=a?a.index:-1;if(n!==i)if(-1===n)r&&(_._logger.debug("Native selection of track, update the player text track ("+i+" -> off)"),this._onTrackChanged(r));else{var o=t.find((function(e){return e.index===n}));o&&(_._logger.debug("Native selection of track, update the player text track ("+i+" -> "+n+")"),this._onTrackChanged(o))}}},{key:"_getDisplayTextTrackModeString",value:function(){return this._config.displayTextTrack?m.ZP.MODE.SHOWING:m.ZP.MODE.HIDDEN}},{key:"_addNativeTextTrackAddedListener",value:function(){var e=this;!this._config.displayTextTrack&&this._videoElement.textTracks&&this._eventManager.listen(this._videoElement.textTracks,"addtrack",(function(){return e._onNativeTextTrackAdded()}))}},{key:"_onNativeTextTrackAdded",value:function(){this._playerTracks=this._getParsedTracks(),this._trigger(p.nQ.TRACKS_CHANGED,{tracks:this._playerTracks})}},{key:"hideTextTrack",value:function(){this.disableNativeTextTracks()}},{key:"enableAdaptiveBitrate",value:function(){_._logger.warn("Enabling adaptive bitrate is not supported for native playback")}},{key:"isAdaptiveBitrateEnabled",value:function(){return!this._isProgressivePlayback()}},{key:"applyABRRestriction",value:function(e){E.c7.createPropertyPath(this._config,"abr.restrictions",e),this._maybeApplyAbrRestrictions(e)}},{key:"_maybeApplyAbrRestrictions",value:function(e){if(this._isProgressivePlayback()){var t=this._playerTracks.filter((function(e){return e instanceof h.Z})),r=(0,k.u)(t,e);!r.find((function(e){return e.active}))&&r.length?this.selectVideoTrack(r[0]):_._logger.warn("Invalid restrictions, there are not tracks within the restriction range")}}},{key:"_disableVideoTracks",value:function(){var e=this._videoElement.videoTracks;if(e)for(var t=0;t<e.length;t++)e[t].selected=!1}},{key:"_switchAudioTrack",value:function(e){_._logger.debug("_switchAudioTracks");var t=this._videoElement.audioTracks;if(t)for(var r=0;r<t.length;r++)t[r].enabled=r===e}},{key:"_getLiveEdge",value:function(){return this._videoElement.seekable.length?this._videoElement.seekable.end(this._videoElement.seekable.length-1):this._videoElement.buffered.length?this._videoElement.buffered.end(this._videoElement.buffered.length-1):this._videoElement.duration}},{key:"liveDuration",get:function(){return this._getLiveEdge()}},{key:"seekToLiveEdge",value:function(){try{this._videoElement.currentTime=this._getLiveEdge()}catch(e){return}}},{key:"getSegmentDuration",value:function(){return this._segmentDuration}},{key:"isLive",value:function(){return this._videoElement.duration===1/0}},{key:"_handleLiveDurationChange",value:function(){var e=this;this._liveDurationChangeInterval=setInterval((function(){e._calculateSegmentDuration();var t=e._getLiveEdge();e._liveEdge!==t&&(e._liveEdge=t,e._videoElement.dispatchEvent(new Event(p.Rk.DURATION_CHANGE)))}),1e3)}},{key:"_calculateSegmentDuration",value:function(){if(this._videoElement.seekable.length>0&&0===this._videoElement.seekable.start(0)){var e=this._videoElement,t=e.buffered,r=e.seekable;t.length&&r.length&&(this._segmentDuration=(t.end(t.length-1)-r.end(r.length-1))/3)}else{var n=this._getLiveEdge();this._liveEdge&&this._liveEdge!==n&&(this._segmentDuration=n-this._liveEdge)}}},{key:"_getStartTimeOfDvrWindow",value:function(){return this.isLive()&&this._videoElement.seekable.length?this._videoElement.seekable.start(0):0}},{key:"getStartTimeOfDvrWindow",value:function(){return this._startTimeOfDvrWindow}},{key:"_setStarTimeOfDvrWindowInterval",value:function(){var e=this;this._startTimeOfDvrWindowInterval=setInterval((function(){var t=e._segmentDuration;!e._waitingEventTriggered&&e._getStartTimeOfDvrWindow()&&t&&Math.abs(e._getStartTimeOfDvrWindow()-e._startTimeOfDvrWindow)<=2*t?e._startTimeOfDvrWindow+=1:e._startTimeOfDvrWindow=e._getStartTimeOfDvrWindow()}),1e3)}},{key:"getDrmInfo",value:function(){return this._drmHandler?this._drmHandler.getDrmInfo():null}}],[{key:"canPlayType",value:function(e){var t=!1;return"string"==typeof e&&(t=!!_.TEST_VIDEO.canPlayType(e.toLowerCase())),_._logger.debug("canPlayType result for mimeType:"+e+" is "+t.toString()),t}},{key:"canPlayDrm",value:function(e,t){_._drmProtocol=null;var r,n=O(_._drmProtocols);try{for(n.s();!(r=n.n()).done;){var a=r.value;if(a.isConfigured(e,t)){_._drmProtocol=a;break}}}catch(e){n.e(e)}finally{n.f()}if(!_._drmProtocol){var i,o=O(_._drmProtocols);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.canPlayDrm(e)&&(_._drmProtocol=s)}}catch(e){o.e(e)}finally{o.f()}}return!!_._drmProtocol}},{key:"createAdapter",value:function(e,t,r){_._logger.debug("createAdapter");var n={displayTextTrack:!1,progressiveSources:[]};if(E.c7.hasPropertyPath(r,"text.useNativeTextTrack")&&(n.displayTextTrack=E.c7.getPropertyPath(r,"text.useNativeTextTrack")),E.c7.hasPropertyPath(r,"sources.progressive")&&(n.progressiveSources=E.c7.getPropertyPath(r,"sources.progressive")),E.c7.hasPropertyPath(r,"text")&&(n.enableCEA708Captions=r.text.enableCEA708Captions,n.captionsTextTrack1Label=r.text.captionsTextTrack1Label,n.captionsTextTrack1LanguageCode=r.text.captionsTextTrack1LanguageCode,n.captionsTextTrack2Label=r.text.captionsTextTrack2Label,n.captionsTextTrack2LanguageCode=r.text.captionsTextTrack2LanguageCode),E.c7.hasPropertyPath(r,"playback")&&E.c7.hasPropertyPath(r.playback,"options.html5.native")&&E.c7.mergeDeep(n,r.playback.options.html5.native),E.c7.hasPropertyPath(r,"abr")){var a=r.abr;a.defaultBandwidthEstimate&&(n.abrEwmaDefaultEstimate=a.defaultBandwidthEstimate),a.restrictions&&E.c7.createPropertyPath(n,"abr.restrictions",a.restrictions)}return n.network=r.network,new this(e,t,n)}}]),_}(y.Z);_=N,(0,i.Z)(N,"id","NativeAdapter"),(0,i.Z)(N,"_logger",y.Z.getLogger(_.id)),(0,i.Z)(N,"TEST_VIDEO",E.is.createElement("video")),(0,i.Z)(N,"_drmProtocols",[S]),(0,i.Z)(N,"_drmProtocol",null),(0,i.Z)(N,"_progressiveMimeTypes",["video/mp4","audio/mp3"]);var U=function(){function e(){(0,n.Z)(this,e)}return(0,a.Z)(e,null,[{key:"register",value:function(t){t&&(e._mediaSourceAdapters.includes(t)?e._logger.debug("Adapter <".concat(t.id,"> is already registered, do not register again")):(e._logger.debug("Adapter <".concat(t.id,"> has been registered successfully")),e._mediaSourceAdapters.push(t)))}},{key:"unRegister",value:function(t){var r=e._mediaSourceAdapters.indexOf(t);r>-1&&(e._logger.debug("Unregistered <".concat(t.id,"> adapter")),e._mediaSourceAdapters.splice(r,1))}},{key:"canPlaySource",value:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;e._orderMediaSourceAdapters(r);var a=e._mediaSourceAdapters;if(t&&t.mimetype)for(var i=0;i<a.length;i++)if(a[i].canPlayType(t.mimetype)&&(!t.drmData||a[i].canPlayDrm(t.drmData,n)))return e._selectedAdapter=a[i],e._logger.debug("Selected adapter is <".concat(e._selectedAdapter.id,">")),!0;return!1}},{key:"_orderMediaSourceAdapters",value:function(t){e._mediaSourceAdapters=e._mediaSourceAdapters.filter((function(e){return"NativeAdapter"!==e.id})),t?e._mediaSourceAdapters.unshift(N):e._mediaSourceAdapters.push(N)}},{key:"getMediaSourceAdapter",value:function(t,r,n){return t&&r&&n?(e._selectedAdapter||e.canPlaySource(r,!0,n.drm),e._selectedAdapter?e._selectedAdapter.createAdapter(t,r,n):null):null}},{key:"destroy",value:function(){e._selectedAdapter=null}}]),e}();(0,i.Z)(U,"_logger",(0,T.ZP)("MediaSourceProvider")),(0,i.Z)(U,"_mediaSourceAdapters",[N]),(0,i.Z)(U,"_selectedAdapter",null);var j=U.register},7300:function(e,t,r){"use strict";r.d(t,{j:function(){return n}});var n={DASH:"dash",HLS:"hls",PROGRESSIVE:"progressive",IMAGE:"image"}},8143:function(e,t,r){"use strict";r.d(t,{B:function(){return n}});var n={TRUE:!0,FALSE:!1,IN_VIEW:"inview"}},2806:function(e,t,r){"use strict";r.d(t,{D:function(){return n}});var n={VOD:"Vod",LIVE:"Live",AUDIO:"Audio",IMAGE:"Image",UNKNOWN:"Unknown"}},3336:function(e,t,r){"use strict";r.d(t,{H:function(){return n}});var n={HLS:["application/x-mpegurl","application/vnd.apple.mpegurl"],DASH:["application/dash+xml"],PROGRESSIVE:["video/mp4"],SMOOTH_STREAMING:["application/vnd.ms-sstr+xml"]}},6975:function(e,t,r){"use strict";r.d(t,{x:function(){return n}});var n={MANIFEST:0,SEGMENT:1,LICENSE:2}},3323:function(e,t,r){"use strict";r.d(t,{z:function(){return n}});var n={NONE:"none",ANY:"any",NATURAL:"natural",LANDSCAPE:"landscape",PORTRAIT:"portrait",PORTRAIT_PRIMARY:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary",LANDSCAPE_PRIMARY:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary"}},962:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var n=r(3144),a=r(5671),i=r(4942),o=r(4358),s={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,LIVE_MANIFEST_REFRESH_ERROR:1008,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_CREATE_TEXT_CUE:2009,DASH_ADAPTER_ERROR_PARSE_ISSUE:2010,UNKNOWN_FILE_TYPE:2011,UNKNOWN_LANGUAGE:2012,INVALID_VTT_THUMBNAILS_FILE:2013,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,HLS_FATAL_MEDIA_ERROR:3018,HLS_FRAG_PARSING_ERROR:3019,HLS_BUFFER_APPEND_ISSUE:3020,HLS_BUFFER_APPENDING_ISSUE:3021,NATIVE_ADAPTER_LOAD_FAILED:3022,HLS_BUFFER_STALLED_ERROR:3023,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_LIVE_CONTENT_NOT_SUPPORTED:4029,HLSJS_CANNOT_PARSE:4030,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,BAD_FAIRPLAY_RESPONSE:6015,COULD_NOT_CREATE_MEDIA_KEYS:6016,COULD_NOT_CREATE_KEY_SESSION:6017,LOAD_INTERRUPTED:7e3,BITRATE_SWITCH_ISSUE:7001,LOAD_FAILED:7002,RUNTIME_ERROR_NOT_REGISTERED_PLUGIN:7003,RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED:7004,RUNTIME_ERROR_NOT_VALID_HANDLER:7005,NO_SOURCE_PROVIDED:7006,NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE:7007,ENTER_PICTURE_IN_PICTURE_FAILED:7008,EXIT_PICTURE_IN_PICTURE_FAILED:7009,PLUGIN_LOAD_FAILED:7010,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,CONTENT_UNSUPPORTED_BY_BROWSER:9009,CANNOT_ADD_ITEM:9010,DOWNLOAD_FAILED:9011,COULD_NOT_GET_INFO_FROM_MEDIA_PROVIDER:9012,ENTRY_DOES_NOT_EXIST:9013,PAUSE_FAILED:9014,RESUME_FAILED:9015,RENEW_LICENSE_FAILED:9016,ENTRY_ALREADY_EXISTS:9017,REMOVE_FAILED:9018,CAST_LOAD_MEDIA_FAILED:10001,CAST_CUSTOM_MESSAGE_PARSING_ERROR:10002,CAST_EDIT_TRACKS_INFO_ERROR:10003,VR_NOT_SUPPORTED:11e3};Object.assign(s,{XML_PARSING_ERROR:8100,VAST_SCHEMA_VALIDATION_ERROR:8101,VAST_RESPONSE_VERSION_NOT_SUPPORTED:8102,TRAFFICKING_ERROR:8200,VAST_UNEXPECTED_LINEARITY:8201,VAST_UNEXPECTED_DURATION_ERROR:8202,VAST_UNEXPECTED_SIZE_ERROR:8203,VAST_WRAPPER_ERROR:8300,VAST_URI_ERROR:8301,VAST_TOO_MANY_REDIRECTS:8302,NO_ADS_VAST_RESPONSE:8303,GENERAL_LINEAR_ERROR:8400,FILE_NOT_FOUND:8401,VAST_MEDIA_LOAD_TIMEOUT:8402,MEDIA_FILE_NOT_FOUND:8403,MEDIA_FILE_DISPLAY_ERROR:8405,MEZZANINE_FILE_NOT_PROVIDED:8406,MEZZANINE_DOWNLOADED_FOR_THE_FIRST_TIME:8407,VAST_RESPONSE_AD_REJECTED:8408,CREATIVE_WAS_NOT_EXECUTED:8409,CODE_REFERENCED_NOT_EXECUTED:8410,GENERAL_NON_LINEAR_AD_ERROR:8500,NON_LINEAR_CREATIVE_DIMENSIONS_NOT_ALIGN_ERROR:8501,NON_LINEAR_FETCH_ERROR:8502,NON_LINEAR_RESOURCE_NOT_FOUND:8503,GENERAL_COMPANION_ADS_ERROR:8600,COMPANION_DIMENSIONS_NOT_FIT:8601,COMPANION_CANNOT_BE_DISPLAY:8602,COMPANION_CANNOT_BE_FETCHED:8603,COMPANION_TYPE_NOT_FOUND:8604,AD_UNDEFINED_ERROR:8900,GENERAL_VPAID_ERROR:8901});var l="Error",u=(0,n.Z)((function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,a.Z)(this,e),this.severity=t,this.category=r,this.code=n,this.data=i,(0,o.ZO)(l)!==o.in.OFF&&e._logger.error("Category:".concat(r," | Code:").concat(n," |"),i)}));(0,i.Z)(u,"Severity",{RECOVERABLE:1,CRITICAL:2}),(0,i.Z)(u,"Category",{NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,ADS:8,STORAGE:9,CAST:10,VR:11}),(0,i.Z)(u,"Code",s),(0,i.Z)(u,"_logger",(0,o.ZP)(l))},4270:function(e,t,r){"use strict";r.d(t,{Q:function(){return s}});var n=r(5671),a=r(3144),i=r(9021);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s=function(){function e(){(0,n.Z)(this,e),this._bindingMap=new i.MultiMap}return(0,a.Z)(e,[{key:"destroy",value:function(){return this.removeAll(),this._bindingMap=null,Promise.resolve()}},{key:"listenOnce",value:function(e,t,r,n){var a=this;this.listen(e,t,(function n(i){a.unlisten(e,t,n),r.call(a,i)}),n)}},{key:"listen",value:function(e,t,r,n){var a=new l(e,t,r,n);this._bindingMap&&this._bindingMap.push(t,a)}},{key:"unlisten",value:function(e,t,r){if(this._bindingMap)for(var n=this._bindingMap.get(t),a=0;a<n.length;++a){var i=n[a];i.target!==e||i.listener!==r&&r||(i.unlisten(),this._bindingMap&&this._bindingMap.remove(t,i))}}},{key:"removeAll",value:function(){if(this._bindingMap){var e,t=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw i}}}}(this._bindingMap.getAll());try{for(t.s();!(e=t.n()).done;)e.value.unlisten()}catch(e){t.e(e)}finally{t.f()}this._bindingMap&&this._bindingMap.clear()}}}]),e}(),l=function(){function e(t,r,a,i){(0,n.Z)(this,e),this.target=t,this.type=r,this.listener=a,this.options=i,this.target.addEventListener(r,a,!1)}return(0,a.Z)(e,[{key:"unlisten",value:function(){this.target&&(this.target.removeEventListener(this.type,this.listener,this.options),this.target=null,this.listener=null,this.options=null)}}]),e}()},2114:function(e,t,r){"use strict";r.d(t,{Rk:function(){return s},nQ:function(){return l},tw:function(){return u}});var n=r(4942),a=r(4611);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var s={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture",PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},l={MEDIA_LOADED:"medialoaded",PLAYER_RESET:"playerreset",PLAYER_DESTROY:"playerdestroy",ENTER_FULLSCREEN:"enterfullscreen",EXIT_FULLSCREEN:"exitfullscreen",PLAY_FAILED:"playfailed",AUTOPLAY_FAILED:"autoplayfailed",FALLBACK_TO_MUTED_AUTOPLAY:"fallbacktomutedautoplay",CHANGE_SOURCE_STARTED:"changesourcestarted",CHANGE_SOURCE_ENDED:"changesourceended",MUTE_CHANGE:"mutechange",VIDEO_TRACK_CHANGED:"videotrackchanged",AUDIO_TRACK_CHANGED:"audiotrackchanged",TEXT_TRACK_CHANGED:"texttrackchanged",IMAGE_TRACK_CHANGED:"imagetrackchanged",TEXT_TRACK_ADDED:"texttrackadded",TEXT_CUE_CHANGED:"textcuechanged",TRACKS_CHANGED:"trackschanged",ABR_MODE_CHANGED:"abrmodechanged",PLAYER_STATE_CHANGED:"playerstatechanged",PLAYBACK_START:"playbackstart",FIRST_PLAY:"firstplay",FIRST_PLAYING:"firstplaying",PLAYBACK_ENDED:"playbackended",SOURCE_SELECTED:"sourceselected",TEXT_STYLE_CHANGED:"textstylechanged",MEDIA_RECOVERED:"mediarecovered",VR_STEREO_MODE_CHANGED:"vrstereomodechanged",FPS_DROP:"fpsdrop",BOOKMARK_ERROR:"bookmarkerror",CONCURRENCY_LIMIT:"concurrencylimit",RESIZE:"resize",TIMED_METADATA:"timedmetadata",TIMED_METADATA_CHANGE:"timedmetadatachange",TIMED_METADATA_ADDED:"timedmetadataadded",FRAG_LOADED:"fragloaded",MANIFEST_LOADED:"manifestloaded",USER_GESTURE:"usergesture",DRM_LICENSE_LOADED:"drmlicenseloaded",SOURCE_URL_SWITCHED:"sourceurlswitched"},u=o(o(o({},s),l),a.J)},8171:function(e,t,r){"use strict";r.d(t,{H:function(){return s}});var n=r(5671),a=r(3144),i=r(9021),o=r(4358),s=function(){function e(){(0,n.Z)(this,e),this._listeners=new i.MultiMap,this.dispatchTarget=this,this.__logger=(0,o.jl)("FakeEventTarget")}return(0,a.Z)(e,[{key:"addEventListener",value:function(e,t){this._listeners.push(e,t)}},{key:"removeEventListener",value:function(e,t){this._listeners.remove(e,t)}},{key:"dispatchEvent",value:function(e){for(var t=this._listeners.get(e.type)||[],r=0;r<t.length;++r){e.target=this.dispatchTarget,e.currentTarget=this.dispatchTarget;var n=t[r];try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(t){this.__logger.error("Error occurred when handling event: ".concat(e.type,"."),t)}if(e.stopped)break}return e.defaultPrevented}}]),e}()},8987:function(e,t,r){"use strict";r.d(t,{v:function(){return i}});var n=r(5671),a=r(3144),i=function(){function e(t,r){(0,n.Z)(this,e),this.bubbles=!1,this.cancelable=!1,this.defaultPrevented=!1,this.timeStamp=window.performance?window.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.currentTarget=null,this.target=null,this.stopped=!1,this.payload=r}return(0,a.Z)(e,[{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.stopped=!0}},{key:"stopPropagation",value:function(){}}]),e}()},902:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(5671),a=r(3144),i=function(){function e(){(0,n.Z)(this,e)}return(0,a.Z)(e,[{key:"callNext",value:function(e){e&&e()}}]),e}()},4649:function(e,t,r){"use strict";r.d(t,{Z:function(){return at}});var n=r(9439),a=r(5671),i=r(3144),o=r(7326),s=r(9340),l=r(2963),u=r(1120),c=r(4942),d=r(2069),p=r(4270),h=r(4821),f=function(){function e(){(0,a.Z)(this,e),this._createEl()}return(0,i.Z)(e,[{key:"setSrc",value:function(e){e&&(this._posterUrl=e,h.is.setStyle(this._el,"background-image",'url("'.concat(this._posterUrl,'")')),this.hide())}},{key:"src",get:function(){return this._posterUrl}},{key:"getElement",value:function(){return this._el}},{key:"_createEl",value:function(){if(!this._el){var e=this._el=h.is.createElement("div");h.is.setAttribute(e,"id",h.RO.uniqueId(5)),h.is.setAttribute(e,"tabindex","-1")}}},{key:"_removeEl",value:function(){this._el&&h.is.removeChild(this._el.parentNode||void 0,this._el)}},{key:"show",value:function(){h.is.setStyle(this._el,"display","")}},{key:"hide",value:function(){h.is.setStyle(this._el,"display","none")}},{key:"reset",value:function(){this._posterUrl="",h.is.setStyle(this._el,"background-image","")}},{key:"destroy",value:function(){this.reset(),this._removeEl()}}]),e}(),m=r(8987),g=r(8171),y=r(2114),v=function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,null,[{key:"language",get:function(){var e;return(e=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language)&&e.match("-")&&(e=e.split("-")[0]),e}}]),e}(),_=r(4358),k=r(4919),E=r(9769),b=r(962),T=function(){function e(t){var r,n,i,o,s,l,u=this;(0,a.Z)(this,e),(0,c.Z)(this,"_transitions",(l={},(0,c.Z)(l,E.Y.IDLE,(r={},(0,c.Z)(r,y.Rk.LOAD_START,(function(){return u._updateState(E.Y.LOADING)})),(0,c.Z)(r,y.Rk.PLAY,(function(){return u._updateState(E.Y.BUFFERING)})),(0,c.Z)(r,y.Rk.SEEKED,(function(){return u._updateState(E.Y.PAUSED)})),r)),(0,c.Z)(l,E.Y.LOADING,(n={},(0,c.Z)(n,y.Rk.LOADED_METADATA,(function(){return u._updateState(E.Y.PAUSED)})),(0,c.Z)(n,y.Rk.ERROR,(function(e){return e.payload.severity===b.Z.Severity.CRITICAL&&u._updateState(E.Y.IDLE)})),(0,c.Z)(n,y.Rk.SEEKED,(function(){u._prevState&&u._prevState.type===E.Y.PLAYING&&u._updateState(E.Y.PLAYING)})),n)),(0,c.Z)(l,E.Y.PAUSED,(i={},(0,c.Z)(i,y.Rk.PLAY,(function(){return u._updateState(E.Y.PLAYING)})),(0,c.Z)(i,y.Rk.PLAYING,(function(){return u._updateState(E.Y.PLAYING)})),(0,c.Z)(i,y.Rk.ENDED,(function(){return u._updateState(E.Y.IDLE)})),i)),(0,c.Z)(l,E.Y.PLAYING,(o={},(0,c.Z)(o,y.Rk.PAUSE,(function(){return u._updateState(E.Y.PAUSED)})),(0,c.Z)(o,y.Rk.WAITING,(function(){u._player.seeking?u._updateState(E.Y.LOADING):(u._updateState(E.Y.BUFFERING),u._lastWaitingTime=u._player.currentTime)})),(0,c.Z)(o,y.Rk.ENDED,(function(){return u._updateState(E.Y.IDLE)})),(0,c.Z)(o,y.Rk.ERROR,(function(e){return e.payload.severity===b.Z.Severity.CRITICAL&&u._updateState(E.Y.IDLE)})),o)),(0,c.Z)(l,E.Y.BUFFERING,(s={},(0,c.Z)(s,y.Rk.PLAYING,(function(){return u._updateState(E.Y.PLAYING)})),(0,c.Z)(s,y.Rk.PAUSE,(function(){return u._updateState(E.Y.PAUSED)})),(0,c.Z)(s,y.Rk.TIME_UPDATE,(function(){"IE"===d.Z.browser.name&&u._player.currentTime!==u._lastWaitingTime&&u._prevState&&u._prevState.type===E.Y.PLAYING&&(u._lastWaitingTime=null,u._updateState(E.Y.PLAYING))})),s)),l)),this._player=t,this._logger=(0,_.ZP)("StateManager"),this._eventManager=new p.Q,this._history=[],this._prevState=null,this._curState=new k.Z(E.Y.IDLE),this._attachListeners()}return(0,i.Z)(e,[{key:"_attachListeners",value:function(){this._eventManager.listen(this._player,y.Rk.ERROR,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.ENDED,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.PLAY,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.LOAD_START,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.PLAYING,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.LOADED_METADATA,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.PAUSE,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.WAITING,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.SEEKED,this._doTransition.bind(this)),this._eventManager.listen(this._player,y.Rk.TIME_UPDATE,this._doTransition.bind(this))}},{key:"_doTransition",value:function(e){(e.type!==y.Rk.TIME_UPDATE||this._curState===E.Y.BUFFERING&&e.type===y.Rk.TIME_UPDATE)&&this._logger.debug("Do transition request",e.type);var t=this._transitions[this._curState.type];"function"==typeof t[e.type]&&t[e.type](e)}},{key:"_updateState",value:function(e){this._curState.type!==e&&(this._curState.duration=Date.now()/1e3,this._history.push(this._curState),this._prevState=this._curState,this._curState=new k.Z(e),this._logger.debug("Switch player state: from ".concat(this._prevState.type," to ").concat(this._curState.type)),this._dispatchEvent())}},{key:"_dispatchEvent",value:function(){var e=new m.v(y.nQ.PLAYER_STATE_CHANGED,{oldState:this._prevState,newState:this._curState});this._player.dispatchEvent(e)}},{key:"destroy",value:function(){this._history=[],this._eventManager.destroy()}},{key:"reset",value:function(){this._history=[]}},{key:"currentState",get:function(){return this._curState}},{key:"previousState",get:function(){return this._prevState}},{key:"history",get:function(){return this._history}}]),e}(),A=r(8413),S=r(4877),C=r(7812),P=r(6462),x=r(6234),w={"":!0,up:!0};function I(e){return"number"==typeof e&&e>=0&&e<=100}var M,R=function(){function e(){(0,a.Z)(this,e),(0,c.Z)(this,"_width",100),(0,c.Z)(this,"_lines",3),(0,c.Z)(this,"_regionAnchorX",0),(0,c.Z)(this,"_regionAnchorY",100),(0,c.Z)(this,"_viewportAnchorX",0),(0,c.Z)(this,"_viewportAnchorY",100),(0,c.Z)(this,"_scroll","")}return(0,i.Z)(e,[{key:"width",get:function(){return this._width},set:function(e){if(!I(e))throw new Error("Width must be between 0 and 100.");this._width=e}},{key:"scroll",get:function(){return this._scroll},set:function(e){var t=function(e){return"string"==typeof e&&!!w[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");this._scroll=t}},{key:"viewportAnchorY",get:function(){return this._viewportAnchorY},set:function(e){if(!I(e))throw new Error("ViewportAnchorY must be between 0 and 100.");this._viewportAnchorY=e}},{key:"viewportAnchorX",get:function(){return this._viewportAnchorX},set:function(e){if(!I(e))throw new Error("ViewportAnchorX must be between 0 and 100.");this._viewportAnchorX=e}},{key:"regionAnchorX",get:function(){return this._regionAnchorX},set:function(e){if(!I(e))throw new Error("RegionAnchorY must be between 0 and 100.");this._regionAnchorX=e}},{key:"lines",get:function(){return this._lines},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");this._lines=e}},{key:"regionAnchorY",get:function(){return this._regionAnchorY},set:function(e){if(!I(e))throw new Error("RegionAnchorX must be between 0 and 100.");this._regionAnchorY=e}}]),e}();function D(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+(0|n)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}M="undefined"!=typeof window&&window.VTTRegion?window.VTTRegion:R;var O={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},L={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},N={v:"title",lang:"lang"},U={rt:"ruby"};function j(){this.values=q(null)}function B(e,t,r,n){var a=n?e.split(n):[e];for(var i in a)if("string"==typeof a[i]){var o=a[i].split(r);2===o.length&&t(o[0],o[1])}}function F(e,t,r){var n=e;function a(){var t=D(e);if(null===t)throw new Y(Y.Errors.BadTimeStamp,"Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function i(){e=e.replace(/^\s+/,"")}if(i(),t.startTime=a(),i(),"--\x3e"!==e.substr(0,3))throw new Y(Y.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.substr(3),i(),t.endTime=a(),i(),function(e,t){var n=new j;B(e,(function(e,t){switch(e){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===t){n.set(e,r[a].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),o=i[0];n.integer(e,o),n.percent(e,o)&&n.set("snapToLines",!1),n.alt(e,o,["auto"]),2===i.length&&n.alt("lineAlign",i[1],["start","center","end"]);break;case"position":i=t.split(","),n.percent(e,i[0]),2===i.length&&n.alt("positionAlign",i[1],["start","center","end"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start","center","end","left","right"])}}),/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical",""),t.line=n.get("line",t.line||"auto"),t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100);try{t.align=n.get("align","center")}catch(e){t.align=n.get("align","middle")}t.position=n.get("position",t.position||"auto"),t.positionAlign=n.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}j.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var V=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function H(e){for(var t=0;t<V.length;t++){var r=V[t];if(e>=r[0]&&e<=r[1])return!0}return!1}var G=function(e){(0,s.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var a=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function o(e,t,r){var i;(0,a.Z)(this,o),i=n.call(this);var s="undefined"!=typeof navigator&&/MSIE\s8\.0/.test(navigator.userAgent);"undefined"!=typeof WebVTTSet&&(WebVTTSet.fontSet,WebVTTSet.backgroundSet,WebVTTSet.edgeSet),i.cue=t,i.cueDiv=function(e,t){function r(){if(!t)return null;var e,r=t.match(/^([^<]*)(<[^>]+>?)?/);return e=r[1]?r[1]:r[2],t=t.substr(e.length),e}function n(e){return O[e]}function a(e){for(var t;t=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(t[0],n);return e}function i(e,t){return!U[t.localName]||U[t.localName]===e.localName}function o(t,r){var n=L[t];if(!n)return null;var a=e.document.createElement(n),i=N[t];return i&&r&&(a[i]=r.trim()),a}for(var s,l=e.document.createElement("div"),u=l,c=[];null!==(s=r());)if("<"!==s[0])u.appendChild(e.document.createTextNode(a(s)));else{if("/"===s[1]){c.length&&c[c.length-1]===s.substr(2).replace(">","")&&(c.pop(),u=u.parentNode);continue}var d=D(s.substr(1,s.length-2)),p=void 0;if(d){p=e.document.createProcessingInstruction("timestamp",d),u.appendChild(p);continue}var h=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!h)continue;if(!(p=o(h[1],h[3])))continue;if(!i(u,p))continue;h[2]&&(p.className=h[2].substr(1).replace("."," ")),c.push(h[1]),u.appendChild(p),u=p}return l}(e,t.text);var l={color:r.color,backgroundColor:r.backgroundColor,textShadow:r.textShadow,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};s||(l.writingMode=""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",l.unicodeBidi="plaintext"),i.applyStyles(l,i.cueDiv),i.div=e.document.createElement("div"),l={textAlign:"middle"===t.align?"center":t.align,font:r.font,whiteSpace:"pre-line",position:"absolute"},s||(l.direction=function(e){var t=[],r="";if(!e||!e.childNodes)return"ltr";function n(e,t){for(var r=t.childNodes.length-1;r>=0;r--)e.push(t.childNodes[r])}function a(e){if(!e||!e.length)return null;var t=e.pop(),r=t.textContent||t.innerText;if(r){var i=r.match(/^.*(\n|\r)/);return i?(e.length=0,i[0]):r}return"ruby"===t.tagName?a(e):t.childNodes?(n(e,t),a(e)):void 0}for(n(t,e);r=a(t);)for(var i=0;i<r.length;i++)if(H(r.charCodeAt(i)))return"rtl";return"ltr"}(i.cueDiv),l.writingMode=""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),i.applyStyles(l),i.div.appendChild(i.cueDiv);var u=0;switch(t.positionAlign||t.align){case"start":case"left":case"line-left":u=t.position;break;case"center":u=t.position-t.size/2;break;case"end":case"right":case"line-right":u=t.position-t.size}return""===t.vertical?i.applyStyles({left:i.formatStyle(u,"%"),width:i.formatStyle(Math.min(t.size,100-u)||t.size,"%")}):i.applyStyles({top:i.formatStyle(u,"%"),height:i.formatStyle(Math.min(t.size,100-u)||t.size,"%")}),i.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})},i}return(0,i.Z)(o)}(function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,[{key:"applyStyles",value:function(e,t){for(var r in t=t||this.div,e)e.hasOwnProperty(r)&&(t.style[r]=e[r])}},{key:"formatStyle",value:function(e,t){return 0===e?0:e+t}}]),e}()),$=function(){function e(t){var r,n,i,o,s;(0,a.Z)(this,e),(0,c.Z)(this,"overlaps",(function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top})),t.div&&(n=t.div.offsetHeight,i=t.div.offsetWidth,o=t.div.offsetTop,s=(s=t.div.childNodes)&&(s=s[0])&&s.getClientRects&&s.getClientRects(),t=t.div.getBoundingClientRect(),r=s?Math.max(s[0]&&s[0].height||0,t.height/s.length):0),this.left=t.left,this.right=t.right,this.top=t.top||o,this.height=t.height||n,this.bottom=t.bottom||o+(t.height||n),this.width=t.width||i,this.lineHeight=r||t.lineHeight||13}return(0,i.Z)(e,[{key:"move",value:function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}}},{key:"overlapsAny",value:function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1}},{key:"within",value:function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right}},{key:"overlapsOppositeAxis",value:function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}}},{key:"intersectPercentage",value:function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)}},{key:"toCSSCompatValues",value:function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}}}],[{key:"getSimpleBoxPosition",value:function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,r=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,n=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||n,height:e.height||t,bottom:e.bottom||n+(e.height||t),width:e.width||r}}}]),e}();function K(e,t,r,n){var a=new $(t),i=t.cue,o=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,r=t.textTrackList,n=0,a=0;a<r.length&&r[a]!==t;a++)r[a].mode===P.ZP.MODE.SHOWING&&n++;return-1*++n}(i),s=[];if(i.snapToLines){var l;switch(i.vertical){case"":s=["+y","-y"],l="height";break;case"rl":s=["+x","-x"],l="width";break;case"lr":s=["-x","+x"],l="width"}var u=a.lineHeight,c=u*Math.round(o),d=r[l]+u,p=s[0];Math.abs(c)>d&&(c=c<0?-1:1,c*=Math.ceil(d/u)*u),o<0&&(c+=""===i.vertical?r.height:r.width,s=s.reverse()),a.move(p,c)}else{var h=a.lineHeight/r.height*100;switch(i.lineAlign){case"center":o-=h/2;break;case"end":o-=h}switch(i.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")})}s=["+y","-x","+x","-y"],a=new $(t)}var f=function(e,t){for(var a,i=new $(e),o=1,s=0;s<t.length;s++){for(;e.overlapsOppositeAxis(r,t[s])||e.within(r)&&e.overlapsAny(n);)e.move(t[s]);if(e.within(r))return e;var l=e.intersectPercentage(r);o>l&&(a=new $(e),o=l),e=new $(i)}return a||i}(a,s);t.move(f.toCSSCompatValues(r))}var W=function(e,t){this.window=e,this.state="INITIAL",this.buffer="",this.decoder=t||new TextDecoder("utf8"),this.regionList=[]},z=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},q=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function Y(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}Y.prototype=q(Error.prototype),Y.prototype.constructor=Y,Y.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},W.prototype={reportOrThrowError:function(e){if(!(e instanceof Y))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function r(){for(var e=t.buffer,r=0;r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var n=e.substr(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.substr(r),n}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var n;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(n=r()).match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new Y(Y.Errors.BadSignature);t.state="HEADER"}for(var i=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(i?i=!1:n=r(),t.state){case"HEADER":/:/.test(n)?B(n,(function(e,r){"Region"===e&&function(e){var r=new j;if(B(e,(function(e,t){switch(e){case"id":r.set(e,t);break;case"width":r.percent(e,t);break;case"lines":r.integer(e,t);break;case"regionanchor":case"viewportanchor":var n=t.split(",");if(2!==n.length)break;var a=new j;if(a.percent("x",n[0]),a.percent("y",n[1]),!a.has("x")||!a.has("y"))break;r.set(e+"X",a.get("x")),r.set(e+"Y",a.get("y"));break;case"scroll":r.alt(e,t,["up"])}}),/=/,/\s/),r.has("id")){var n=new M;n.width=r.get("width",100),n.lines=r.get("lines",3),n.regionAnchorX=r.get("regionanchorX",0),n.regionAnchorY=r.get("regionanchorY",100),n.viewportAnchorX=r.get("viewportanchorX",0),n.viewportAnchorY=r.get("viewportanchorY",100),n.scroll=r.get("scroll",""),t.onregion&&t.onregion(n),t.regionList.push({id:r.get("id"),region:n})}}(r)}),/:/):n||(t.state="ID");continue;case"NOTE":n||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){t.state="NOTE";break}if(!n)continue;if(t.cue=new VTTCue(0,0,""),t.state="CUE",-1===n.indexOf("--\x3e")){t.cue.id=n;continue}case"CUE":try{F(n,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var o=-1!==n.indexOf("--\x3e");if(!n||o&&(i=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=n;continue;case"BADCUE":n||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new Y(Y.Errors.BadSignature)}catch(t){e.reportOrThrowError(t)}return e.onflush&&e.onflush(),this}};var X=r(5856),Z=r(7300),Q=r(488),J=r(2806),ee=r(6820),te=r(6145),re=r(3433),ne=r(9654),ae=function(){function e(t){(0,a.Z)(this,e),this._actions=t,this._middlewares=new ne.k,this._logger=(0,_.ZP)("Middleware")}return(0,i.Z)(e,[{key:"use",value:function(e){for(var t in this._actions){var r=this._actions[t];"function"==typeof e[r]&&(this._logger.debug("Register <".concat(e.id,"> for action ").concat(r)),this._middlewares.push(r,e[r].bind(e)))}}},{key:"run",value:function(e,t){var r=this;this._logger.debug("Start middleware chain for action "+e);for(var n=this._middlewares.get(e),a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];this._executeMiddleware(n,(function(){r._logger.debug("Finish middleware chain for action "+e),t.apply(void 0,arguments)}),i)}},{key:"_executeMiddleware",value:function(e,t,r){var n=r,a=function(e,t,r){var a;null!=t&&t.length&&(n=t),null!==(a=n)&&void 0!==a&&a.length?e.apply(void 0,(0,re.Z)(n).concat([r])):e(r)},i=e.reduceRight((function(e,t){return function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];a(t,n,e)}}),(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];a(t,r)}));i()}}]),e}(),ie=function(){function e(){(0,a.Z)(this,e),this._middleware=new ae(e.Actions)}return(0,i.Z)(e,[{key:"use",value:function(e){this._middleware.use(e)}},{key:"load",value:function(t){this._middleware.run(e.Actions.LOAD,t)}},{key:"play",value:function(t){this._middleware.run(e.Actions.PLAY,t)}},{key:"pause",value:function(t){this._middleware.run(e.Actions.PAUSE,t)}},{key:"setCurrentTime",value:function(t,r){this._middleware.run(e.Actions.SET_CURRENT_TIME,r,t)}}]),e}();(0,c.Z)(ie,"Actions",{LOAD:"load",PLAY:"play",PAUSE:"pause",SET_CURRENT_TIME:"setCurrentTime"});var oe=r(3323),se={log:{level:"ERROR"},text:{enableCEA708Captions:!0,useNativeTextTrack:!1,forceCenter:!1,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es"},playback:{audioLanguage:"",textLanguage:"",volume:1,playsinline:!0,preload:"none",autoplay:!1,loop:!1,autopause:!1,allowMutedAutoPlay:!0,muted:!1,pictureInPicture:!0,options:{html5:{hls:{},dash:{},native:{}}},preferNative:{hls:!1,dash:!1},inBrowserFullscreen:!1,screenLockOrientionMode:oe.z.NONE,playAdsWithMSE:!1,streamPriority:[{engine:"html5",format:"hls"},{engine:"html5",format:"dash"},{engine:"html5",format:"progressive"},{engine:"flash",format:"hls"}]},streaming:{forceBreakStall:!1},abr:{enabled:!0,fpsDroppedFramesInterval:5e3,fpsDroppedMonitoringThreshold:.2,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,restrictions:{minHeight:0,maxHeight:1/0,minWidth:0,maxWidth:1/0,minBitrate:0,maxBitrate:1/0}},drm:{keySystem:""},network:{maxStaleLevelReloads:20}},le={options:{},metadata:{}},ue=r(3379),ce=r.n(ue),de=r(7795),pe=r.n(de),he=r(569),fe=r.n(he),me=r(3565),ge=r.n(me),ye=r(9216),ve=r.n(ye),_e=r(4589),ke=r.n(_e),Ee=r(7774),be={};be.styleTagTransform=ke(),be.setAttributes=ge(),be.insert=fe().bind(null,"head"),be.domAPI=pe(),be.insertStyleElement=ve(),ce()(Ee.Z,be),Ee.Z&&Ee.Z.locals&&Ee.Z.locals;var Te=r(4779),Ae="srt",Se="vtt",Ce=function(e){(0,s.Z)(d,e);var t,r,n=(t=d,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var a=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function d(e){var t;return(0,a.Z)(this,d),t=n.call(this),(0,c.Z)((0,o.Z)(t),"_externalCueIndex",0),(0,c.Z)((0,o.Z)(t),"_textTrackModel",{}),(0,c.Z)((0,o.Z)(t),"_activeTextCues",[]),(0,c.Z)((0,o.Z)(t),"_isTextTrackActive",!1),(0,c.Z)((0,o.Z)(t),"_lastTimeUpdate",0),t._player=e,t._eventManager=new p.Q,t}return(0,i.Z)(d,[{key:"hideTextTrack",value:function(){this._player.config.text.useNativeTextTrack?(this._removeCueChangeListeners(),this._resetExternalNativeTextTrack()):this._isTextTrackActive&&(this._eventManager.unlisten(this._player,y.Rk.TIME_UPDATE),this.dispatchEvent(new m.v(y.nQ.TEXT_CUE_CHANGED,{cues:[]})),this._resetCurrentTrack())}},{key:"getExternalTracks",value:function(e){var t=this,r=this._player.sources.captions;if(!r)return[];this._player.config.text.useNativeTextTrack&&this._addNativeTextTrack();var n=e.filter((function(e){return e instanceof P.ZP})),a=[];return r.forEach((function(e){if(e.language){var r=t._createTextTrack(e);t._maybeAddTrack(r,e,n,a)}else{var i=new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.UNKNOWN_LANGUAGE,{caption:e});t.dispatchEvent(new m.v(y.Rk.ERROR,i))}})),a}},{key:"_maybeAddTrack",value:function(e,t,r,n){var a=r.find((function(e){return e.available&&A.Z.langComparer(t.language,e.language)}));a?d._logger.warn("duplicated language, taking the inband option. Language: ",a.language):(n.push(e),this._updateTextTracksModel(t))}},{key:"_createTextTrack",value:function(e){return new P.ZP({active:!!e.default,kind:P.ZP.KIND.SUBTITLES,label:e.label,language:e.language,external:!0})}},{key:"_updateTextTracksModel",value:function(e){this._textTrackModel[e.language]={cuesStatus:1,cues:[],url:e.url,type:e.type}}},{key:"selectTextTrack",value:function(e){var t=this;this._textTrackModel[e.language]&&(3===this._textTrackModel[e.language].cuesStatus?this._selectTextTrack(e):1===this._textTrackModel[e.language].cuesStatus&&this._downloadAndParseCues(e).then((function(){t._textTrackModel[e.language].cuesStatus=3,t._selectTextTrack(e)})).catch((function(e){return t.dispatchEvent(new m.v(y.Rk.ERROR,e))})))}},{key:"_selectTextTrack",value:function(e){this.hideTextTrack(),this._player.config.text.useNativeTextTrack?(this._addCuesToNativeTextTrack(this._textTrackModel[e.language].cues),this._addCueChangeListener()):this._setTextTrack(e),e.active=!0,this.dispatchEvent(new m.v(y.nQ.TEXT_TRACK_CHANGED,{selectedTextTrack:e}))}},{key:"resetAllCues",value:function(){for(var e in this._textTrackModel)this._textTrackModel[e].cues.forEach((function(e){e.hasBeenReset=!0}))}},{key:"_addCueChangeListener",value:function(){var e=this,t=this._player.getVideoElement();if(t&&t.textTracks){var r=Array.from(t.textTracks).find((function(e){return P.ZP.isNativeTextTrack(e)&&e.mode===P.ZP.MODE.SHOWING}));r&&this._eventManager.listen(r,"cuechange",(function(t){return e._onCueChange(t)}))}}},{key:"_removeCueChangeListeners",value:function(){var e=this._player.getVideoElement();if(e&&e.textTracks)for(var t=0;t<e.textTracks.length;t++)this._eventManager.unlisten(e.textTracks[t],"cuechange")}},{key:"_onCueChange",value:function(e){var t=e.currentTarget.activeCues,r=(0,P.z6)(t);this.dispatchEvent(new m.v(y.nQ.TEXT_CUE_CHANGED,{cues:r}))}},{key:"reset",value:function(){this._resetCurrentTrack(),this._textTrackModel={},this._resetExternalNativeTextTrack(),this._eventManager.removeAll()}},{key:"destroy",value:function(){this._textTrackModel={},this._eventManager.destroy(),this._activeTextCues=[]}},{key:"_resetCurrentTrack",value:function(){this._activeTextCues=[],this._isTextTrackActive=!1,this._maybeSetExternalCueIndex()}},{key:"_getCuesString",value:function(e){var t=this;return new Promise((function(r,n){var a=t._textTrackModel[e.language],i=a.type||t._getFileType(a.url);[Ae,Se].includes(i)||(t._textTrackModel[e.language].cuesStatus=1,n(new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.UNKNOWN_FILE_TYPE,{captionType:i}))),h.eV.execute(a.url,{},"GET").then((function(e){r(i===Ae?t._convertSrtToVtt(e):e)})).catch((function(){t._textTrackModel[e.language].cuesStatus=1,n(new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.HTTP_ERROR,{url:a.url}))}))}))}},{key:"_parseCues",value:function(e){return new Promise((function(t,r){var n=new W(window,z()),a=[];n.oncue=function(e){a.push(e)},n.onflush=function(){d._logger.debug("finished parsing external cues"),t(a)},n.parse(e),n.flush(),n.onparsingerror((function(e){return r(e)}))}))}},{key:"_convertSrtToVtt",value:function(e){var t=e.replace(/(\d\d:\d\d:\d\d),(\d\d\d) --> (\d\d:\d\d:\d\d),(\d\d\d)/g,(function(e,t,r,n,a){return"".concat(t,".").concat(r," --\x3e ").concat(n,".").concat(a)}));return"WEBVTT\n\n".concat(t)}},{key:"_downloadAndParseCues",value:function(e){var t=this;return this._textTrackModel[e.language].cuesStatus=2,new Promise((function(r,n){t._getCuesString(e).then((function(e){return t._parseCues(e)})).then((function(n){t._textTrackModel[e.language].cues=n,r()})).catch((function(e){return n(e)}))}))}},{key:"_getFileType",value:function(e){return e.split(/[#?]/)[0].split(".").pop().trim()}},{key:"_handleCaptionOnTimeUpdate",value:function(e){var t=this._player.currentTime;if(t){var r=!1;this._hadSeeked()&&(this._activeTextCues=[],r=this._maybeSetExternalCueIndex());var n=this._maybeRemoveActiveCues(),a=this._maybeAddToActiveCues(e);(r||a||n)&&this.dispatchEvent(new m.v(y.nQ.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._lastTimeUpdate=t}}},{key:"_hadSeeked",value:function(){return!!this._player.currentTime&&Math.abs(this._player.currentTime-this._lastTimeUpdate)>1}},{key:"_maybeRemoveActiveCues",value:function(){var e=this._player.currentTime;if(!e)return!1;var t=this._activeTextCues.filter((function(t){return t.startTime<e&&e<t.endTime})),r=this._activeTextCues.length!==t.length;return this._activeTextCues=t,r}},{key:"_maybeAddToActiveCues",value:function(e){var t=this._player.currentTime;if(!t)return!1;for(var r=!1,n=this._textTrackModel[e.language].cues;this._externalCueIndex<n.length&&t>n[this._externalCueIndex].startTime;)t<n[this._externalCueIndex].endTime&&this._activeTextCues.push(n[this._externalCueIndex]),this._externalCueIndex++,r=!0;return r}},{key:"_maybeSetExternalCueIndex",value:function(){var e=this._player._getTextTracks().find((function(e){return e.active&&e.external}));if(e&&e.external){for(var t=this._textTrackModel[e.language]?this._textTrackModel[e.language].cues:[],r=0;r<t.length&&!(t[r].startTime<this._player.currentTime&&this._player.currentTime<t[r].endTime)&&!(t[r].endTime>this._player.currentTime&&t[r].startTime>this._player.currentTime);r++);return this._externalCueIndex=r,!0}return!1}},{key:"_resetExternalNativeTextTrack",value:function(){var e=this._player.getVideoElement();if(e&&e.textTracks){var t=Array.from(e.textTracks).find((function(e){return!!e&&P.ZP.isExternalTrack(e)}));t&&(t.cues&&Object.values(t.cues).forEach((function(e){return t.removeCue(e)})),t.mode=P.ZP.MODE.DISABLED)}}},{key:"_addCuesToNativeTextTrack",value:function(e){var t=this._player.getVideoElement();if(t&&t.textTracks){var r=Array.from(t.textTracks).find((function(e){return!!e&&P.ZP.isExternalTrack(e)}));r&&(r.mode=P.ZP.MODE.SHOWING,void 0===VTTCue?this._convertCues(e).forEach((function(e){return r.addCue(e)})):e.forEach((function(e){return r.addCue(e)})))}}},{key:"_convertCues",value:function(e){return e.map((function(e){return new TextTrackCue(e.startTime,e.endTime,e.text)}))}},{key:"_addNativeTextTrack",value:function(){var e=this._player.getVideoElement();e&&e.textTracks&&(Array.from(e.textTracks).findIndex((function(e){return!!e&&P.ZP.isExternalTrack(e)}))>-1?this._resetExternalNativeTextTrack():e.addTextTrack(P.ZP.KIND.SUBTITLES,P.ZP.EXTERNAL_TRACK_ID,P.ZP.EXTERNAL_TRACK_ID))}},{key:"_setTextTrack",value:function(e){var t=this;this._player.config.text.useNativeTextTrack||(this._isTextTrackActive=!0,d._logger.debug("External text track changed",e),this._activeTextCues=[],this._externalCueIndex=0,this.dispatchEvent(new m.v(y.nQ.TEXT_CUE_CHANGED,{cues:this._activeTextCues})),this._eventManager.listen(this._player,y.Rk.TIME_UPDATE,(function(){return t._handleCaptionOnTimeUpdate(e)})))}}]),d}(g.H);(0,c.Z)(Ce,"_logger",(0,_.ZP)("ExternalCaptionsHandler"));var Pe=r(9063),xe=r(8151),we=r(9021),Ie="playkit-in-browser-fullscreen-mode",Me=function(){function e(t){(0,a.Z)(this,e),(0,c.Z)(this,"_isElementInFullscreen",!1),(0,c.Z)(this,"_isScreenLocked",!1),(0,c.Z)(this,"_isScreenOrientationSupport",!!screen&&!!screen.orientation&&"function"==typeof screen.orientation.unlock&&"function"==typeof screen.orientation.lock),(0,c.Z)(this,"_isFullscreenEventDispatched",!1),this._player=t,this._isInBrowserFullscreen=!1,this._eventManager=new p.Q}return(0,i.Z)(e,[{key:"_isNativeDocumentFullscreen",value:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}},{key:"_isIOSFullscreen",value:function(){var e="function"==typeof this._player.getVideoElement?this._player.getVideoElement():null;return"iOS"===this._player.env.os.name&&!!e&&("fullscreen"===e.webkitPresentationMode||!e.webkitPresentationMode&&e.webkitDisplayingFullscreen)}},{key:"isFullscreen",value:function(){return this._isNativeDocumentFullscreen()&&this._isElementInFullscreen||this._isIOSFullscreen()||this._isInBrowserFullscreen}},{key:"enterFullscreen",value:function(e){if(!this.isFullscreen()){this.registerFullScreenEvents();var t=e&&h.is.getElementById(e),r=this._player.config.playback;if(t||(t=this._player.getView()),"iOS"===this._player.env.os.name)if(r.inBrowserFullscreen&&r.playsinline||this._player.engineType===Q.r.YOUTUBE)this._enterInBrowserFullscreen(t);else{var n=this._player.getVideoElement();n&&"function"==typeof n.webkitEnterFullScreen&&(this._player.isInPictureInPicture()?(setTimeout((function(){return n.webkitEnterFullScreen()}),1e3),this._player.exitPictureInPicture()):n.webkitEnterFullScreen())}else this._requestFullscreen(t)}}},{key:"exitFullscreen",value:function(){if(this.isFullscreen())if("iOS"===this._player.env.os.name)if(this._isInBrowserFullscreen||this._player.engineType===Q.r.YOUTUBE)this._exitInBrowserFullscreen();else{var e=this._player.getVideoElement();e&&"function"==typeof e.webkitExitFullscreen&&e.webkitExitFullscreen()}else this._requestExitFullscreen()}},{key:"_nativeEnterFullScreen",value:function(e){return"function"==typeof e.requestFullscreen?e.requestFullscreen():"function"==typeof e.mozRequestFullScreen?e.mozRequestFullScreen():"function"==typeof e.webkitRequestFullScreen?e.webkitRequestFullScreen():"function"==typeof e.msRequestFullscreen?e.msRequestFullscreen():void 0}},{key:"_requestFullscreen",value:function(e){var t=this;this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),Promise.resolve(this._nativeEnterFullScreen(e)).then((function(){t._isElementInFullscreen=!0;var e=h.c7.getPropertyPath(t._player,"config.playback.screenLockOrientionMode"),r=e!==oe.z.NONE&&Object.values(oe.z).includes(e);t._isScreenOrientationSupport&&r&&screen.orientation.lock(e).then((function(){return t._isScreenLocked=!0})).catch((function(){return t._isScreenLocked=!1}))}),(function(){}))}},{key:"_nativeExitFullScreen",value:function(){return"function"==typeof document.exitFullscreen?document.exitFullscreen():"function"==typeof document.webkitExitFullscreen?document.webkitExitFullscreen():"function"==typeof document.mozCancelFullScreen?document.mozCancelFullScreen():"function"==typeof document.msExitFullscreen?document.msExitFullscreen():void 0}},{key:"_requestExitFullscreen",value:function(){var e=this;Promise.resolve(this._nativeExitFullScreen()).then((function(){e._isElementInFullscreen=!1,e._isScreenOrientationSupport&&e._isScreenLocked&&(screen.orientation.unlock(),e._isScreenLocked=!1)}),(function(){}))}},{key:"_enterInBrowserFullscreen",value:function(e){this._player.isInPictureInPicture()&&this._player.exitPictureInPicture(),h.is.addClassName(e,Ie),this._isInBrowserFullscreen=!0,this._fullscreenEnterHandler(),this._player.dispatchEvent(new m.v(this._player.Event.RESIZE))}},{key:"_exitInBrowserFullscreen",value:function(){var e=h.is.getElementBySelector("."+Ie);e&&h.is.removeClassName(e,Ie),this._isInBrowserFullscreen=!1,this._fullscreenExitHandler(),this._player.dispatchEvent(new m.v(this._player.Event.RESIZE))}},{key:"registerFullScreenEvents",value:function(){var e=this;"iOS"===this._player.env.os.name?this._handleIosFullscreen():(this._eventManager.listen(document,"webkitfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"mozfullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"fullscreenchange",(function(){return e._fullscreenChangeHandler()})),this._eventManager.listen(document,"MSFullscreenChange",(function(){return e._fullscreenChangeHandler()})))}},{key:"_handleIosFullscreen",value:function(){var e=this,t=function(){var t=e._player.getVideoElement();t&&(e._eventManager.listen(t,"webkitbeginfullscreen",(function(){return e._fullscreenEnterHandler()})),e._eventManager.listen(t,"webkitendfullscreen",(function(){return e._fullscreenExitHandler()})))};this._player.getVideoElement()?t():this._eventManager.listenOnce(this._player,this._player.Event.SOURCE_SELECTED,(function(){return t()}))}},{key:"_fullscreenChangeHandler",value:function(){this.isFullscreen()?this._fullscreenEnterHandler():this._fullscreenExitHandler()}},{key:"_fullscreenEnterHandler",value:function(){this.isFullscreen()&&!this._isFullscreenEventDispatched&&(this._isFullscreenEventDispatched=!0,this._player.dispatchEvent(new m.v(this._player.Event.ENTER_FULLSCREEN)))}},{key:"_fullscreenExitHandler",value:function(){!this.isFullscreen()&&this._isFullscreenEventDispatched&&(this._isFullscreenEventDispatched=!1,this._eventManager.removeAll(),this._player.dispatchEvent(new m.v(this._player.Event.EXIT_FULLSCREEN)))}},{key:"destroy",value:function(){this._eventManager.destroy()}}]),e}(),Re=r(1752),De=function(e){(0,s.Z)(c,e);var t,r,n=(t=c,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var a=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function c(e,t){var r,i;return(0,a.Z)(this,c),(i=n.call(this))._eventManager=new p.Q,i._pluginDecorators=t.createDecorators(e,(0,Re.Z)((r=(0,o.Z)(i),(0,u.Z)(c.prototype)),"dispatchEvent",r).bind((0,o.Z)(i))),Object.values(y.tw).forEach((function(t){return i._eventManager.listen(e,t,(function(e){return i.dispatchEvent(e)}))})),(0,l.Z)(i,new Proxy(e,{get:function(e,t){"destroy"===t&&i._destroy();var r,n=i._pluginDecorators.find((function(e){return e.active}));return(r="addEventListener"===t||"removeEventListener"===t?(0,o.Z)(i):n&&t in n?n:e)[t]&&"function"==typeof r[t].bind?r[t].bind(r):r[t]},set:function(e,t,r){var n=i._pluginDecorators.find((function(e){return t in e&&e.active}));return n&&t in n?n[t]=r:e[t]=r,!0}}))}return(0,i.Z)(c,[{key:"dispatchEvent",value:function(e){var t=this._pluginDecorators.find((function(e){return e.active}));return t&&t.dispatchEvent?t.dispatchEvent(e):(0,Re.Z)((0,u.Z)(c.prototype),"dispatchEvent",this).call(this,e)}},{key:"_destroy",value:function(){this._pluginDecorators=[],this._eventManager.destroy()}},{key:"active",get:function(){return!0}}]),c}(g.H),Oe=r(8143),Le=r(2983),Ne=function(){function e(){(0,a.Z)(this,e),(0,c.Z)(this,"_decoratorProviders",new Map),(0,c.Z)(this,"_logger",(0,_.ZP)("EngineDecoratorManager"))}return(0,i.Z)(e,[{key:"register",value:function(e){this._decoratorProviders.has(e.getName())?this._logger.warn("decorator already registered for ".concat(e.getName())):this._decoratorProviders.set(e.getName(),e)}},{key:"createDecorators",value:function(e,t){return this._logger.debug("decorators created for ".concat(Array.from(this._decoratorProviders.keys()).toString())),Array.from(this._decoratorProviders.values(),(function(r){return r.getEngineDecorator(e,t)}))}},{key:"destroy",value:function(){this._logger.debug("decorators destroyed"),this._decoratorProviders.clear()}}]),e}(),Ue=r(1177);function je(e,t,r,n,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function Be(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){je(i,n,a,o,s,"next",e)}function s(e){je(i,n,a,o,s,"throw",e)}o(void 0)}))}}var Fe=r(4687),Ve=r.n(Fe),He=r(5590);function Ge(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return $e(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$e(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function $e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ke(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ke(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ze=/#wh=/i,qe=/#xywh=/i,Ye=new RegExp("^/[^/].+"),Xe=function(e){(0,s.Z)(E,e);var t,r,d,f,g,v,_,k=(v=E,_=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,u.Z)(v);if(_){var r=(0,u.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,l.Z)(this,e)});function E(){var e;return(0,a.Z)(this,E),e=k.call(this),(0,c.Z)((0,o.Z)(e),"_cues",[]),e._eventManager=new p.Q,e}return(0,i.Z)(E,[{key:"load",value:(g=Be(Ve().mark((function e(t){return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return E._logger.debug("start loading the vtt thumbnails"),e.next=5,this._downloadAndParseCues(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"getThumbnail",value:function(e){var t=this._findCue(e,this._cues);if(t){var r=t.imgUrl,n=t.size,a=t.coordinates;a=a||{x:0,y:0};var i=We(We({url:r},n=n||this._naturalImgSize),a);return new He.F(i)}return null}},{key:"isUsingVttThumbnails",value:function(){var e;return!(null===(e=this._cues)||void 0===e||!e.length)}},{key:"_downloadAndParseCues",value:(f=Be(Ve().mark((function e(t){var r,n;return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._downloadVttFile(t);case 3:return r=e.sent,e.next=6,this._processVtt(r);case 6:return n=e.sent,e.next=9,this._formatIntoThumbnailCues(n,t);case 9:this._cues=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.dispatchEvent(new m.v(y.Rk.ERROR,e.t0));case 15:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e){return f.apply(this,arguments)})},{key:"_downloadVttFile",value:(d=Be(Ve().mark((function e(t){return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.eV.execute(t.vttUrl,{},"GET");case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.HTTP_ERROR,e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(e){return d.apply(this,arguments)})},{key:"_processVtt",value:(r=Be(Ve().mark((function e(t){return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n=new W(window,z()),a=[];n.oncue=function(e){a.push(e)},n.onflush=function(){E._logger.debug("finished parsing thumbnails cues"),e(a)},n.parse(t),n.flush(),n.onparsingerror((function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"_formatIntoThumbnailCues",value:(t=Be(Ve().mark((function e(t,r){var n,a,i,o,s,l;return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.validateThumbnailsVTTFormat(t)){e.next=4;break}throw new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"invalid thumbnail vtt format",vttUrl:r.vttUrl});case 4:return n=this._extractCueMetadata(t[0],r),e.next=7,this.validateImgUrl(n.imgUrl);case 7:if(e.sent){e.next=11;break}throw new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"failed loading the image - invalid image url",imgUrl:n.imgUrl});case 11:return e.next=13,this.extractImgNaturalDimensions(n.imgUrl);case 13:this._naturalImgSize=e.sent,a=[],i=Ge(t);try{for(i.s();!(o=i.n()).done;)s=o.value,l=this._extractCueMetadata(s,r),a.push(l)}catch(e){i.e(e)}finally{i.f()}return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"validateThumbnailsVTTFormat",value:function(e){return e.length&&e[0]instanceof VTTCue}},{key:"extractImgNaturalDimensions",value:function(e){var t=this;return new Promise((function(r){var n=new Image;n.src=e,t._eventManager.listenOnce(n,"load",(function(){r({height:n.naturalHeight,width:n.naturalWidth})})),t._eventManager.listenOnce(n,"error",(function(){return r(null)}))}))}},{key:"validateImgUrl",value:function(e){var t=this;return new Promise((function(r){var n=new Image;n.src=e,t._eventManager.listenOnce(n,"load",(function(){r(!0)})),t._eventManager.listenOnce(n,"error",(function(){return r(!1)}))}))}},{key:"_extractCueMetadata",value:function(e,t){var r,a=e.startTime,i=e.endTime,o=e.text,s=t.vttUrl.substring(0,t.vttUrl.lastIndexOf("/")),l=ze.test(o),u=qe.test(o),c=!1,d=null,p=null;if(l){var h=o.split(ze);r=(0,n.Z)(h,1)[0],E._logger.warn('vtt thumbnails in "'.concat(ze,'" form - is supported but the width and height options are ignored and The images will be displayed in their natural dimensions')),c=void 0!==r}else if(u){var f=o.split(qe),m=(0,n.Z)(f,2);r=m[0];var g=m[1].split(",").map(Number),y=(0,n.Z)(g,4),v=y[0],_=y[1],k=y[2],T=y[3];d={x:v,y:_},p={width:k,height:T},c=[v,_,k,T,r].every((function(e){return void 0!==e}))}else r=o,c=!!o;if(0!==r.indexOf("http://")&&0!==r.indexOf("https://")&&(r=Ye.test(r)?r.substring(1):r,r="".concat(s,"/").concat(r)),c)return{startTime:a,endTime:i,imgUrl:r,size:p,coordinates:d};throw new b.Z(b.Z.Severity.RECOVERABLE,b.Z.Category.TEXT,b.Z.Code.INVALID_VTT_THUMBNAILS_FILE,{message:"error while parsing the vtt cues - invalid cue",parsedCue:{startTime:a,endTime:i,options:o}})}},{key:"_findCue",value:function(e,t){for(var r=0,n=t.length-1;r<=n;){var a=Math.floor((r+n)/2),i=t[a];if(e>=i.startTime&&e<i.endTime)return t[a];e<i.startTime?n=a-1:r=a+1}return null}},{key:"reset",value:function(){this._cues=[],this._eventManager.removeAll(),this._naturalImgSize={}}},{key:"destroy",value:function(){this.reset(),this._eventManager.destroy()}}]),E}(g.H);function Ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}(0,c.Z)(Xe,"_logger",(0,_.ZP)("ExternalThumbnailsHandler"));var et="playkit-engine",tt="playkit-subtitles-style",rt="auto",nt="off",at=function(e){(0,s.Z)(k,e);var t,r,g=(t=k,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var a=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function k(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.Z)(this,k),e=g.call(this),(0,c.Z)((0,o.Z)(e),"_sources",{}),(0,c.Z)((0,o.Z)(e),"_activeTextCues",[]),(0,c.Z)((0,o.Z)(e),"_textDisplaySettings",{}),(0,c.Z)((0,o.Z)(e),"_playbackAttributesState",{muted:void 0,volume:void 0,rate:void 0,videoTrack:void 0,audioLanguage:"",textLanguage:"",captionsDisplay:void 0}),(0,c.Z)((0,o.Z)(e),"_hasUserInteracted",!1),(0,c.Z)((0,o.Z)(e),"_isOnLiveEdge",!1),(0,c.Z)((0,o.Z)(e),"_shouldLoadAfterAttach",!1),e._setConfigLogLevel(t),e._playerId=h.RO.uniqueId(5),e._prepareVideoElement(),k.runCapabilities(),e._env=d.Z,e._tracks=[],e._firstPlay=!0,e._loadingMedia=!1,e._loading=!1,e._playbackStart=!1,e._firstPlaying=!1,e._reset=!0,e._destroyed=!1,e._fallbackToMutedAutoPlay=!1,e._config=k._defaultConfig,e._sources=h.c7.copyDeep(le),e._eventManager=new p.Q,e._posterManager=new f,e._stateManager=new T((0,o.Z)(e)),e._resizeWatcher=new we.ResizeWatcher,e._playbackMiddleware=new ie,e._textStyle=new x.Z,e._createReadyPromise(),e._createPlayerContainer(),e._appendDomElements(),e._externalCaptionsHandler=new Ce((0,o.Z)(e)),e._externalThumbnailsHandler=new Xe,e._fullscreenController=new Me((0,o.Z)(e)),e.configure(t),e}return(0,i.Z)(k,[{key:"configure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setConfigLogLevel(e),h.c7.mergeDeep(this._config,e),this._applyTextTrackConfig(e),this._applyABRRestriction(e)}},{key:"setSourcesMetadata",value:function(e){this._sources&&(this._sources.metadata||(this._sources.metadata={}),h.c7.mergeDeep(this._sources.metadata,e))}},{key:"setSources",value:function(e){this._hasSources(e)?(this.reset(),h.c7.mergeDeep(this._sources,e),this._resizeWatcher.init(h.is.getElementById(this._playerId)),k._logger.debug("Change source started"),this.dispatchEvent(new m.v(y.nQ.CHANGE_SOURCE_STARTED)),this._reset=!1,this._selectEngineByPriority()?(this.dispatchEvent(new m.v(y.nQ.SOURCE_SELECTED,{selectedSource:this._sources[this._streamType]})),this._attachMedia(),this._handlePlaybackOptions(),this._posterManager.setSrc(this._sources.poster),this._handleDimensions(),this._handlePreload(),this._handleAutoPlay(),k._logger.debug("Change source ended"),this.dispatchEvent(new m.v(y.nQ.CHANGE_SOURCE_ENDED))):(k._logger.warn("No playable engines was found to play the given sources"),this.dispatchEvent(new m.v(y.Rk.ERROR,new b.Z(b.Z.Severity.CRITICAL,b.Z.Category.PLAYER,b.Z.Code.NO_ENGINE_FOUND_TO_PLAY_THE_SOURCE,"No Engine Found To Play The Source"))))):h.c7.mergeDeep(this._sources,e)}},{key:"ready",value:function(){return this._readyPromise?this._readyPromise:Promise.resolve()}},{key:"load",value:function(){var e=this;this.src?k._logger.debug("The source has already been loaded. load request ignored"):this._playbackMiddleware.load((function(){e._engine?e._load():e._eventManager.listenOnce(e,y.nQ.SOURCE_SELECTED,(function(){return e._load()}))}))}},{key:"play",value:function(e){var t=this;e&&e.programmatic?this._autoPlay():(this._playbackStart||(this._playbackStart=!0,this.dispatchEvent(new m.v(y.nQ.PLAYBACK_START)),this.src||this._prepareVideoElement(),this.load()),this._engine?this._playbackMiddleware.play((function(){return t._play()})):this._loadingMedia?this._playbackMiddleware.play((function(){return t._playAfterAsyncMiddleware()})):this.dispatchEvent(new m.v(y.Rk.ERROR,new b.Z(b.Z.Severity.CRITICAL,b.Z.Category.PLAYER,b.Z.Code.NO_SOURCE_PROVIDED,"No Source Provided"))))}},{key:"pause",value:function(){this._engine&&this._playbackMiddleware.pause(this._pause.bind(this))}},{key:"getView",value:function(){return this._el}},{key:"getVideoElement",value:function(){if(this._engine)return this._engine.getVideoElement()}},{key:"videoHeight",get:function(){return this._engine?this._engine.videoHeight:null}},{key:"videoWidth",get:function(){return this._engine?this._engine.videoWidth:null}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._reset||(this.pause(),this._externalCaptionsHandler.reset(),this._externalThumbnailsHandler.reset(),this._posterManager.reset(),this._stateManager.reset(),this._sources=h.c7.copyDeep(le),this._activeTextCues=[],this._updateTextDisplay([]),this._tracks=[],P.PZ.reset(),this._resetStateFlags(),this._engineType="",this._streamType="",this._pendingSelectedVideoTrack=void 0,this._engine&&this._engine.reset(),this.showBlackCover(),this._reset=!0,this.dispatchEvent(new m.v(y.nQ.PLAYER_RESET,{isChangeMedia:e})),this._eventManager.removeAll(),this._resizeWatcher.init(h.is.getElementById(this._playerId)),this._createReadyPromise(),this._isOnLiveEdge=!1,this._shouldLoadAfterAttach=!1)}},{key:"destroy",value:function(){this._destroyed||(this._externalCaptionsHandler.destroy(),this._posterManager.destroy(),this._stateManager.destroy(),this._fullscreenController.destroy(),this._activeTextCues=[],this._textDisplaySettings={},this._config={},this._tracks=[],this._engineType="",this._streamType="",this._readyPromise=void 0,this._pendingSelectedVideoTrack=void 0,this._resetStateFlags(),this._playbackAttributesState={},this._engine&&this._engine.destroy(),this._engineDecoratorManager&&this._engineDecoratorManager.destroy(),this._resizeWatcher.destroy(),this._el&&h.is.removeChild(this._el.parentNode,this._el),this._destroyed=!0,this.dispatchEvent(new m.v(y.nQ.PLAYER_DESTROY)),this._eventManager.destroy())}},{key:"hideBlackCover",value:function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="hidden")}},{key:"showBlackCover",value:function(){this._blackCoverEl&&(this._blackCoverEl.style.visibility="visible")}},{key:"attachMediaSource",value:function(){var e=this;this._engine&&(this._shouldLoadAfterAttach=!0,this._engine.attachMediaSource(),this._eventManager.listenOnce(this,y.Rk.CAN_PLAY,(function(){"number"==typeof e._playbackAttributesState.rate&&(e.playbackRate=e._playbackAttributesState.rate)})))}},{key:"detachMediaSource",value:function(){this._engine&&(this.pause(),this.hideTextTrack(),this._shouldLoadAfterAttach=!1,this._createReadyPromise(),this._engine.detachMediaSource())}},{key:"registerEngineDecoratorProvider",value:function(e){this._engineDecoratorManager||(this._engineDecoratorManager=new Ne),e&&this._engineDecoratorManager.register(e)}},{key:"buffered",get:function(){return this._engine?this._engine.buffered:null}},{key:"stats",get:function(){var e={targetBuffer:NaN,availableBuffer:NaN};return this._engine&&(e.targetBuffer=this._engine.targetBuffer,e.availableBuffer=this._engine.availableBuffer),e}},{key:"currentTime",get:function(){return this._engine?this._engine.currentTime:null},set:function(e){this._playbackMiddleware.setCurrentTime(e,this._setCurrentTime.bind(this))}},{key:"duration",get:function(){return this._engine?this._engine.duration:null}},{key:"liveDuration",get:function(){return this._engine?this._engine.liveDuration:null}},{key:"volume",get:function(){return this._engine?this._engine.volume:null},set:function(e){if(this._engine&&(h.Mr.isFloat(e)||0===e||1===e)){var t=e;t<0&&(t=0),t>1&&(t=1),this._engine.volume=t}}},{key:"paused",get:function(){return this._engine?this._engine.paused:null}},{key:"seeking",get:function(){return this._engine?this._engine.seeking:null}},{key:"playsinline",get:function(){return this._engine?this._engine.playsinline:null},set:function(e){this._engine&&(this._engine.playsinline=e)}},{key:"muted",get:function(){return this._engine?this._engine.muted:null},set:function(e){this._engine&&(this._engine.muted=e,this.dispatchEvent(new m.v(y.nQ.MUTE_CHANGE,{mute:e})),!1===e&&(this._fallbackToMutedAutoPlay=e))}},{key:"src",get:function(){return this._engine?this._engine.src:null}},{key:"dimensions",get:function(){return{width:this._el.clientWidth,height:this._el.clientHeight}},set:function(e){var t=this._getTargetElement();if(!e||h.c7.isEmptyObject(e))this._aspectRatio=null,t.style.width=null,t.style.height=null;else{var r=h.c7.mergeDeep(this.dimensions,e),n=r.height,a=r.width;t.style.width="number"==typeof a?"".concat(a,"px"):a,t.style.height="number"==typeof n?"".concat(n,"px"):n,this._calcRatio(t,e)}}},{key:"_getTargetElement",value:function(){return h.is.getElementById(this._config.targetId)}},{key:"poster",get:function(){return this._posterManager.src}},{key:"playbackRate",get:function(){return this._engine?this._engine.playbackRate:null},set:function(e){this._engine&&(this._engine.playbackRate=e)}},{key:"playbackRates",get:function(){return this._playbackRates?this._playbackRates:this._engine?this._engine.playbackRates:[]}},{key:"defaultPlaybackRate",get:function(){return this._engine?this._engine.defaultPlaybackRate:1}},{key:"engineType",get:function(){return this._engineType}},{key:"streamType",get:function(){return this._streamType}},{key:"env",get:function(){return this._env}},{key:"config",get:function(){return h.c7.mergeDeep({},this._config)}},{key:"sources",get:function(){return h.c7.mergeDeep({},this._sources)}},{key:"hasUserInteracted",get:function(){return this._hasUserInteracted}},{key:"loadingMedia",set:function(e){this._loadingMedia=e}},{key:"crossOrigin",get:function(){return this._engine?this._engine.crossOrigin:null},set:function(e){this._engine&&(this._engine.crossOrigin=e)}},{key:"ended",get:function(){return this._engine?this._engine.ended:null}},{key:"playbackMiddleware",get:function(){return this._playbackMiddleware}},{key:"posterManager",get:function(){return this._posterManager}},{key:"isLive",value:function(){return!(this._sources.type===J.D.VOD||!(this._sources.type===J.D.LIVE||this._engine&&this._engine.isLive()))}},{key:"isAudio",value:function(){return this._sources.type===J.D.AUDIO}},{key:"isOnLiveEdge",value:function(){return this._engine&&"function"==typeof this._engine.isOnLiveEdge?this._engine.isOnLiveEdge():this._isOnLiveEdge}},{key:"isDvr",value:function(){return this.isLive()&&this._sources.dvr}},{key:"seekToLiveEdge",value:function(){this._engine&&this.isLive()&&(this._engine.seekToLiveEdge(),this._isOnLiveEdge=!0)}},{key:"getStartTimeOfDvrWindow",value:function(){return this._engine?this._engine.getStartTimeOfDvrWindow():0}},{key:"getTracks",value:function(e){switch(e){case X.V.VIDEO:return h.c7.copyDeep(this._getVideoTracks());case X.V.AUDIO:return h.c7.copyDeep(this._getAudioTracks());case X.V.TEXT:return h.c7.copyDeep(this._getTextTracks());case X.V.IMAGE:return h.c7.copyDeep(this._getImageTracks());default:return h.c7.copyDeep(this._tracks)}}},{key:"getActiveTracks",value:function(){return h.c7.copyDeep({video:this._getVideoTracks().find((function(e){return e.active})),audio:this._getAudioTracks().find((function(e){return e.active})),text:this._getTextTracks().find((function(e){return e.active}))})}},{key:"selectTrack",value:function(e){this._engine&&(e instanceof S.Z?(this._playbackAttributesState.videoTrack=e,this._stateManager.currentState.type===E.Y.IDLE?this._pendingSelectedVideoTrack=e:this._engine.selectVideoTrack(e)):e instanceof C.Z?this._engine.selectAudioTrack(e):e instanceof P.PZ?(this._resetTextDisplay(),e.language===nt?(this.hideTextTrack(),this._externalCaptionsHandler.hideTextTrack(),this._playbackAttributesState.captionsDisplay=!1):e.external?(this._engine.hideTextTrack(),this._externalCaptionsHandler.selectTextTrack(e)):(this._externalCaptionsHandler.hideTextTrack(),this._engine.selectTextTrack(e))):e instanceof Le.Z&&this._engine.selectImageTrack(e))}},{key:"hideTextTrack",value:function(){if(this._engine){this._engine.hideTextTrack(),this._resetTextDisplay();var e=this._getTextTracks(),t=e.find((function(e){return!0===e.active}));t&&t.external&&this._externalCaptionsHandler.hideTextTrack(),e.map((function(e){return e.active=!1}));var r=e.find((function(e){return e.language===nt}));r&&(r.active=!0,this.dispatchEvent(new m.v(y.nQ.TEXT_TRACK_CHANGED,{selectedTextTrack:r}))),this._playbackAttributesState.captionsDisplay=!1}}},{key:"showTextTrack",value:function(){var e=this._getTextTracks(),t=this._playbackAttributesState.textLanguage||this._getLanguage(e,rt,e.find((function(e){return e.default})));this._setDefaultTrack(e,t)}},{key:"addTextTrack",value:function(e,t,r){if(this._engine&&"function"==typeof this._engine.addTextTrack)return this._engine.addTextTrack(e,t,r)}},{key:"getNativeTextTracks",value:function(){return this._engine&&"function"==typeof this._engine.getNativeTextTracks?this._engine.getNativeTextTracks():[]}},{key:"enableAdaptiveBitrate",value:function(){this._engine&&this._engine.enableAdaptiveBitrate(),this._playbackAttributesState.videoTrack=void 0}},{key:"isAdaptiveBitrateEnabled",value:function(){return!!this._engine&&this._engine.isAdaptiveBitrateEnabled()}},{key:"_applyABRRestriction",value:function(e){if(h.c7.hasPropertyPath(e,"abr.restrictions")&&this._engine&&this._tracks.length){var t=this._config.abr.restrictions,r=this._tracks.filter((function(e){return e instanceof S.Z})),n=(0,Ue.u)(r,t);if(n.length){var a=this._tracks.filter((function(e){return e instanceof S.Z&&e.available}));(a.length!==n.length||!a.every((function(e,t){return e.bandwidth===n[t].bandwidth})))&&(this._engine.applyABRRestriction(t),this._tracks.forEach((function(e){!n.includes(e)&&e instanceof S.Z?(e.available=!1,e.active=!1):e.available=!0})),this.getActiveTracks().video||(n[0].active=!0),this.dispatchEvent(new m.v(y.nQ.TRACKS_CHANGED,{tracks:this._tracks.filter((function(e){return e.available}))})))}else k._logger.warn("Invalid restriction, Nothing has changed values do not meet the restriction")}}},{key:"_applyTextTrackConfig",value:function(e){if(h.c7.hasPropertyPath(e,"text.textTrackDisplaySetting")||h.c7.getPropertyPath(e,"text.forceCenter")){var t={};h.c7.hasPropertyPath(this._config,"text.textTrackDisplaySetting")&&(t=h.c7.mergeDeep(t,this._config.text.textTrackDisplaySetting)),h.c7.getPropertyPath(this._config,"text.forceCenter")&&(t=h.c7.mergeDeep(t,{position:"auto",align:"center",size:"100"})),this.setTextDisplaySettings(t)}try{h.c7.hasPropertyPath(e,"text.textStyle")&&(this.textStyle=x.Z.fromJson(this._config.text.textStyle))}catch(e){k._logger.warn(e)}}},{key:"getThumbnail",value:function(e){return this._externalThumbnailsHandler.isUsingVttThumbnails()?this._externalThumbnailsHandler.getThumbnail(e):this._engine?this._engine.getThumbnail(e):null}},{key:"setTextDisplaySettings",value:function(e){this._textDisplaySettings=h.c7.mergeDeep(this._textDisplaySettings,e),this._updateCueDisplaySettings();for(var t=0;t<this._activeTextCues.length;t++)this._activeTextCues[t].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)}},{key:"textDisplaySetting",get:function(){return h.c7.copyDeep(this._textDisplaySettings)}},{key:"textStyle",get:function(){return this._textStyle.clone()},set:function(e){if(!(e instanceof x.Z))throw new Error("Style must be instance of TextStyle");var t=h.is.getElementBySelector(".".concat(this._playerId,".").concat(tt));t||(t=h.is.createElement("style"),h.is.addClassName(t,this._playerId),h.is.addClassName(t,tt),h.is.appendChild(document.head,t));for(var r=t.sheet;r.cssRules.length;)r.deleteRule(0);try{this._textStyle=e,this._config.text.useNativeTextTrack?r.insertRule("#".concat(this._playerId," video.").concat(et,"::cue { ").concat(e.toCSS()," }"),0):this._engine&&(this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay(this._activeTextCues)),this.dispatchEvent(new m.v(y.nQ.TEXT_STYLE_CHANGED))}catch(e){k._logger.error(e.message)}}},{key:"isFullscreen",value:function(){return this._fullscreenController.isFullscreen()}},{key:"notifyEnterFullscreen",value:function(){this.isFullscreen()&&this.dispatchEvent(new m.v(y.nQ.ENTER_FULLSCREEN))}},{key:"notifyExitFullscreen",value:function(){this.isFullscreen()||this.dispatchEvent(new m.v(y.nQ.EXIT_FULLSCREEN))}},{key:"enterFullscreen",value:function(e){this._fullscreenController.enterFullscreen(e)}},{key:"exitFullscreen",value:function(){this._fullscreenController.exitFullscreen()}},{key:"enterPictureInPicture",value:function(){this.isFullscreen()&&this.exitFullscreen(),this._engine&&!this._engine.isInPictureInPicture&&this._engine.enterPictureInPicture()}},{key:"exitPictureInPicture",value:function(){this._engine&&this._engine.isInPictureInPicture&&this._engine.exitPictureInPicture()}},{key:"isInPictureInPicture",value:function(){return!!this._engine&&this._engine.isInPictureInPicture}},{key:"isPictureInPictureSupported",value:function(){return!!this._config.playback.pictureInPicture&&this._engine.isPictureInPictureSupported()}},{key:"isVr",value:function(){return!!this._sources.vr}},{key:"getLogLevel",value:function(e){return(0,_.ZO)(e)}},{key:"setLogLevel",value:function(e,t){(0,_.Ub)(e,t)}},{key:"getDrmInfo",value:function(){return this._engine.getDrmInfo()}},{key:"_resetTextDisplay",value:function(){this._activeTextCues=[],this._updateTextDisplay([])}},{key:"_prepareVideoElement",value:function(){var e=this;Te.zv.getEngines().forEach((function(t){t.prepareVideoElement(e._playerId)}))}},{key:"_setConfigLogLevel",value:function(e){e.log&&e.log.level&&_.in[e.log.level]&&(0,_.Ub)(_.in[e.log.level]),e.log&&"function"==typeof e.log.handler&&(0,_.hs)(e.log.handler)}},{key:"_hasSources",value:function(e){return!!e&&!!Object.values(Z.j).find((function(t){return e[t]&&e[t].length>0}))}},{key:"_createPlayerContainer",value:function(){var e=this._el=h.is.createElement("div");h.is.addClassName(e,"playkit-container"),h.is.setAttribute(e,"id",this._playerId),h.is.setAttribute(e,"tabindex","-1")}},{key:"_appendEngineEl",value:function(){if(this._el){var e=this._engine.getVideoElement(),t="".concat(et);h.is.addClassName(e,t);var r="".concat(et,"-").concat(this._engine.id);h.is.addClassName(e,r),h.is.prependTo(e,this._el),"youtube"===this._engine.id&&(this._el.style.zIndex="1")}}},{key:"_appendDomElements",value:function(){this._blackCoverEl=h.is.createElement("div"),h.is.addClassName(this._blackCoverEl,"playkit-black-cover"),h.is.appendChild(this._el,this._blackCoverEl);var e=this._posterManager.getElement();h.is.addClassName(e,"playkit-poster"),h.is.appendChild(this._el,e),this._textDisplayEl=h.is.createElement("div"),h.is.addClassName(this._textDisplayEl,"playkit-subtitles"),h.is.appendChild(this._el,this._textDisplayEl)}},{key:"_createReadyPromise",value:function(){var e=this;this._readyPromise=new Promise((function(t,r){e._eventManager.listenOnce(e,y.nQ.TRACKS_CHANGED,(function(){e.dispatchEvent(new m.v(y.nQ.MEDIA_LOADED)),e._handlePlaybackRate(),t()})),e._eventManager.listen(e,y.Rk.ERROR,(function(e){e.payload.severity===b.Z.Severity.CRITICAL&&r()}))})).catch((function(){}))}},{key:"_handlePlaybackRate",value:function(){"number"==typeof this._playbackAttributesState.rate?this.playbackRate=this._playbackAttributesState.rate:"number"==typeof this._config.playback.playbackRate&&(this.playbackRate=this._config.playback.playbackRate)}},{key:"_selectEngineByPriority",value:function(){var e,t=this,r=this._config.playback.streamPriority,n=this._config.playback.preferNative,a=this._sources,i=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Je(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Je(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(r);try{var o,s=function(){var r=e.value,i="string"==typeof r.engine?r.engine.toLowerCase():"",o="string"==typeof r.format?r.format.toLowerCase():"",s=Te.zv.getEngines().find((function(e){return e.id===i}));if(s){var l=a[o];if(l&&l.length>0){var u=l[0];if(s.canPlaySource(u,n[o],t._config.drm))return k._logger.debug("Source selected: ",l),t._loadEngine(s,u),t._engineType=i,t._streamType=o,{v:!0}}}};for(i.s();!(e=i.n()).done;)if(o=s())return o.v}catch(e){i.e(e)}finally{i.f()}return!1}},{key:"_loadEngine",value:function(e,t){this._engine?this._engine.id===e.id?this._engine.restore(t,Qe(Qe({},this._config),{},{sources:this._sources})):(this._engine.destroy(),this._createEngine(e,t),this._appendEngineEl()):(this._createEngine(e,t),this._appendEngineEl())}},{key:"_createEngine",value:function(e,t){var r=e.createEngine(t,Qe(Qe({},this._config),{},{sources:this._sources}),this._playerId);this._engine=this._engineDecoratorManager?new De(r,this._engineDecoratorManager):r}},{key:"_attachMedia",value:function(){var e=this;if(this._engine){Object.keys(y.Rk).forEach((function(t){e._eventManager.listen(e._engine,y.Rk[t],(function(t){return e.dispatchEvent(t)}))})),this._eventManager.listen(this._engine,y.Rk.SEEKING,(function(){e.isLive()&&(e._isOnLiveEdge=!(!e.duration||!e.currentTime)&&e.currentTime>=e.duration-1&&!e.paused)})),this._eventManager.listen(this._engine,y.nQ.MEDIA_RECOVERED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.IMAGE_TRACK_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.TEXT_TRACK_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.VIDEO_TRACK_CHANGED,(function(t){return e._markActiveTrack(t.payload.selectedVideoTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.AUDIO_TRACK_CHANGED,(function(t){e.ready().then((function(){return e._playbackAttributesState.audioLanguage=t.payload.selectedAudioTrack.language})),e._markActiveTrack(t.payload.selectedAudioTrack),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._engine,y.nQ.TRACKS_CHANGED,(function(t){return e._onTracksChanged(t)})),this._eventManager.listen(this._engine,y.nQ.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._engine,y.nQ.ABR_MODE_CHANGED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.TIMED_METADATA,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.TIMED_METADATA_CHANGE,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.TIMED_METADATA_ADDED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.PLAY_FAILED,(function(t){e._onPlayFailed(t),e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.FPS_DROP,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.FRAG_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.DRM_LICENSE_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.MANIFEST_LOADED,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._engine,y.nQ.MEDIA_RECOVERED,(function(){return e._handleRecovered()})),this._eventManager.listen(this,y.Rk.PLAY,this._onPlay.bind(this)),this._eventManager.listen(this,y.Rk.PAUSE,this._onPause.bind(this)),this._eventManager.listen(this,y.Rk.PLAYING,this._onPlaying.bind(this)),this._eventManager.listen(this,y.Rk.ENDED,this._onEnded.bind(this)),this._eventManager.listen(this,y.nQ.MUTE_CHANGE,(function(t){var r;e._playbackAttributesState.muted=(null===(r=t.payload)||void 0===r?void 0:r.mute)||e.muted})),this._eventManager.listen(this,y.Rk.VOLUME_CHANGE,(function(){e._playbackAttributesState.volume=e.volume})),this._eventManager.listen(this,y.Rk.RATE_CHANGE,(function(){e._playbackAttributesState.rate=e.playbackRate})),this._eventManager.listen(this,y.nQ.ENTER_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this,y.nQ.EXIT_FULLSCREEN,(function(){return e._resetTextCuesAndReposition()})),this._eventManager.listen(this._resizeWatcher,y.nQ.RESIZE,(function(t){e._resetTextCuesAndReposition(),e.dispatchEvent(t)})),this._eventManager.listen(this._externalCaptionsHandler,y.nQ.TEXT_CUE_CHANGED,(function(t){return e._onCueChange(t)})),this._eventManager.listen(this._externalCaptionsHandler,y.nQ.TEXT_TRACK_CHANGED,(function(t){return e._onTextTrackChanged(t)})),this._eventManager.listen(this._externalCaptionsHandler,y.Rk.ERROR,(function(t){return e.dispatchEvent(t)})),this._eventManager.listen(this._externalThumbnailsHandler,y.Rk.ERROR,(function(t){return e.dispatchEvent(t)}));var t=h.is.getElementBySelector("#".concat(this.config.targetId));t&&this._eventManager.listen(t,"click",(function(){e._hasUserInteracted=!0,e.dispatchEvent(new m.v(y.nQ.USER_GESTURE))}),{capture:!0})}}},{key:"_handleRecovered",value:function(){this._stateManager.currentState.type===E.Y.PLAYING&&this.play()}},{key:"_onTextTrackChanged",value:function(e){var t=this;this.ready().then((function(){return t._playbackAttributesState.textLanguage=e.payload.selectedTextTrack.language})),this._markActiveTrack(e.payload.selectedTextTrack),this.dispatchEvent(e)}},{key:"_resetTextCuesAndReposition",value:function(){this._engine.resetAllCues(),this._externalCaptionsHandler.resetAllCues(),this._updateTextDisplay([]);for(var e=0;e<this._activeTextCues.length;e++)this._activeTextCues[e].hasBeenReset=!0;this._updateTextDisplay(this._activeTextCues)}},{key:"_handlePlaybackOptions",value:function(){if(this._config.playback=this._config.playback||{},"boolean"==typeof this._playbackAttributesState.muted?this.muted=this._playbackAttributesState.muted:"boolean"==typeof this._config.playback.muted&&(this.muted=this._config.playback.muted),"number"==typeof this._playbackAttributesState.volume?this.volume=this._playbackAttributesState.volume:"number"==typeof this._config.playback.volume&&(this.volume=this._config.playback.volume),"boolean"==typeof this._config.playback.playsinline&&(this.playsinline=this._config.playback.playsinline),"string"==typeof this._config.playback.crossOrigin&&(this.crossOrigin=this._config.playback.crossOrigin),Array.isArray(this._config.playback.playbackRates)){var e=this._config.playback.playbackRates.filter((function(e,t,r){return e>0&&e<=16&&r.indexOf(e)===t})).sort((function(e,t){return e-t}));e&&(this._playbackRates=e)}}},{key:"_handlePreload",value:function(){"auto"!==this._config.playback.preload||this._config.playback.autoplay||this.load()}},{key:"_autoPlay",value:function(){var e=this,t=this._config.playback.allowMutedAutoPlay;k.getCapabilities(this.engineType).then((function(s){s.autoplay?n():s.mutedAutoPlay?r()&&!e._fallbackToMutedAutoPlay?a():t?i():o():o()}));var r=function(){k._logger.debug("Checking muted value");var t="boolean"==typeof e._playbackAttributesState.muted&&e._playbackAttributesState.muted||"boolean"==typeof e._config.playback.muted&&e._config.playback.muted||e.muted;return k._logger.debug("Muted value is:",t),t},n=function(){k._logger.debug("Start autoplay"),e._fallbackToMutedAutoPlay&&(e._fallbackToMutedAutoPlay=!1,e.muted=!1),e.play()},a=function(){k._logger.debug("Start muted autoplay"),e.play()},i=function(){k._logger.debug("Fallback to muted autoplay"),e._fallbackToMutedAutoPlay=!0,e.muted=!0,e.dispatchEvent(new m.v(y.nQ.FALLBACK_TO_MUTED_AUTOPLAY)),e.play()},o=function(){k._logger.warn("Autoplay failed, pause player"),e._posterManager.show(),e.load(),e.dispatchEvent(new m.v(y.nQ.AUTOPLAY_FAILED))}}},{key:"_handleAutoPlay",value:function(){(this.isAudio()||this._config.playback.autoplay!==Oe.B.TRUE)&&this._posterManager.show(),this._config.playback.autoplay===Oe.B.TRUE&&this._autoPlay()}},{key:"_playAfterAsyncMiddleware",value:function(){var e=this;this._engine?this._play():this._eventManager.listenOnce(this,y.nQ.SOURCE_SELECTED,(function(){return e._play()}))}},{key:"_load",value:function(){var e=this;if(this._engine&&!this.src&&!this._loading){this._loading=!0;var t=this._sources.startTime;this._engine.load(t).then((function(r){e.isLive()&&(-1===t||Number(t)>=Number(e.duration))&&(e._isOnLiveEdge=!0),e._updateTracks(r.tracks),e.dispatchEvent(new m.v(y.nQ.TRACKS_CHANGED,{tracks:e._tracks})),e.sources.thumbnails&&e._externalThumbnailsHandler.load(e.sources.thumbnails)})).finally((function(){e._loading=!1,e._reset=!1}))}}},{key:"_handleDimensions",value:function(){var e=this.config.dimensions;h.c7.isObject(e)&&!h.c7.isEmptyObject(e)&&(this.dimensions=e)}},{key:"_play",value:function(){var e=this;this._shouldLoadAfterAttach&&(this._load(),this._shouldLoadAfterAttach=!1),this.ready().then((function(){e._shouldPlayerSeekToLiveEdge()&&e.seekToLiveEdge(),e._engine.play()}))}},{key:"_shouldPlayerSeekToLiveEdge",value:function(){if(this.isLive()){var e=!this.isDvr()||"number"==typeof this.currentTime&&this.currentTime<0;return this._firstPlay?!!this.src&&!this.isOnLiveEdge()&&void 0===this._sources.startTime:e}return!1}},{key:"_pause",value:function(){this._engine.pause()}},{key:"_setCurrentTime",value:function(e){if(this._engine&&h.Mr.isNumber(e)){var t=e;e<0&&(t=0);var r=this.isLive()?this._engine.duration:this._engine.duration-.1;t>r&&(t=r),this._engine.currentTime=t}}},{key:"_onPause",value:function(){this._isOnLiveEdge=!1}},{key:"_onPlay",value:function(){this._firstPlay&&(this._firstPlay=!1,this.dispatchEvent(new m.v(y.nQ.FIRST_PLAY)),this.hideBlackCover(),"number"==typeof this._playbackAttributesState.rate&&(this.playbackRate=this._playbackAttributesState.rate))}},{key:"_onPlaying",value:function(){this._firstPlaying||(this._firstPlaying=!0,this.isAudio()||this._posterManager.hide(),this.dispatchEvent(new m.v(y.nQ.FIRST_PLAYING))),this._engine&&this._pendingSelectedVideoTrack&&(this._engine.selectVideoTrack(this._pendingSelectedVideoTrack),this._pendingSelectedVideoTrack=void 0)}},{key:"_onPlayFailed",value:function(e){this._firstPlay&&this._config.playback.autoplay&&(this._posterManager.show(),this.dispatchEvent(new m.v(y.nQ.AUTOPLAY_FAILED,e.payload)))}},{key:"_onEnded",value:function(){this.paused||this._pause()}},{key:"_resetStateFlags",value:function(){this._loading=!1,this._firstPlay=!0,this._loadingMedia=!1,this._playbackStart=!1,this._firstPlaying=!1}},{key:"_calcRatio",value:function(e,t){if(void 0!==t.ratio&&(this._aspectRatio=t.ratio),this._aspectRatio){var r=this._aspectRatio.split(":").map((function(e){return Number(e)})),a=(0,n.Z)(r,2),i=a[0],o=a[1];if(t.width||!t.width&&!t.height){var s=o/i*e.clientWidth;e.style.height="".concat(s,"px")}else if(t.height&&!t.width){var l=i/o*e.clientHeight;e.style.width="".concat(l,"px")}}}},{key:"_onTracksChanged",value:function(e){this._updateTracks(e.payload.tracks),this.dispatchEvent(e)}},{key:"_updateTracks",value:function(e){k._logger.debug("Tracks changed",e),this._tracks=null==e?void 0:e.concat(this._externalCaptionsHandler.getExternalTracks(e)),this._applyABRRestriction(this._config),this._addTextTrackOffOption(),this._maybeSetTracksLabels(),this._setDefaultTracks()}},{key:"_getTracksByType",value:function(e){return this._tracks.reduce((function(t,r){return r instanceof e&&r.available&&t.push(r),t}),[])}},{key:"_getImageTracks",value:function(){return this._getTracksByType(Le.Z)}},{key:"_getTextTracks",value:function(){return this._getTracksByType(P.PZ)}},{key:"_getVideoTracks",value:function(){return this._getTracksByType(S.Z)}},{key:"_getAudioTracks",value:function(){return this._getTracksByType(C.Z)}},{key:"_markActiveTrack",value:function(e){var t;if(e instanceof S.Z?t=this._getVideoTracks():e instanceof C.Z?t=this._getAudioTracks():e instanceof P.PZ&&(t=this._getTextTracks()),t)for(var r=0;r<t.length;r++)t[r].active=e.index===t[r].index}},{key:"_onCueChange",value:function(e){k._logger.debug("Text cue changed",e.payload.cues);try{this._activeTextCues=e.payload.cues.filter((function(e,t,r){var n=r[t-1];return!n||!(e.startTime===n.startTime&&e.endTime===n.endTime&&e.text.trim()===n.text.trim())}))}catch(t){this._activeTextCues=e.payload.cues}this._updateCueDisplaySettings(),this._updateTextDisplay(this._activeTextCues),this.dispatchEvent(e)}},{key:"_updateCueDisplaySettings",value:function(){for(var e=this._activeTextCues,t=this._textDisplaySettings,r=0;r<e.length;r++){var n=e[r];for(var a in t)t[a]&&(n[a]=t[a])}}},{key:"_updateTextDisplay",value:function(e){this._config.text.useNativeTextTrack||this._config.text.useShakaTextTrackDisplay||function(e,t,r,n){if(!e||!t||!r)return null;for(;r.firstChild;)r.removeChild(r.firstChild);var a=e.document.createElement("div");if(a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.top="0",a.style.bottom="0",a.style.margin="1.5%",r.appendChild(a),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var i=[],o=$.getSimpleBoxPosition(a),s=o.height<o.width?o.height:o.width,l={font:Math.round(.058*s*100)/100*1*n.implicitFontScale+"px "+n.fontFamily,color:x.Z.toRGBA(n.fontColor,n.fontOpacity),backgroundColor:x.Z.toRGBA(n.backgroundColor,n.backgroundOpacity),textShadow:n.getTextShadow()};!function(){for(var r,n,s=0;s<t.length;s++)n=t[s],r=new G(e,n,l),a.appendChild(r.div),K(0,r,o,i),n.displayState=r.div,i.push($.getSimpleBoxPosition(r))}()}else for(var u=0;u<t.length;u++)a.appendChild(t[u].displayState)}(window,e,this._textDisplayEl,this._textStyle)}},{key:"_addTextTrackOffOption",value:function(){var e=this._getTextTracks();e&&e.length&&this._tracks.push(new P.PZ({active:!1,kind:P.PZ.KIND.SUBTITLES,label:"Off",language:nt}))}},{key:"_setDefaultTracks",value:function(){var e=this.getActiveTracks(),t=this._getTextTracks().find((function(e){return e.default})),r=this.config.playback,n=this._getTextTracks().find((function(e){return P.PZ.langComparer(nt,e.language)})),a=this._getLanguage(this._getTextTracks(),r.textLanguage,t),i=!this._playbackAttributesState.textLanguage||this.config.disableUserCache?a:this._playbackAttributesState.textLanguage,o=this._playbackAttributesState.audioLanguage||this._getLanguage(this._getAudioTracks(),r.audioLanguage,e.audio);r.captionsDisplay?i===r.textLanguage?this._setDefaultTrack(this._getTextTracks(),i,n,r.additionalTextLanguage):this._setDefaultTrack(this._getTextTracks(),i,n):(this._playbackAttributesState.textLanguage=a,this._setDefaultTrack(this._getTextTracks(),nt,n)),o===r.audioLanguage?this._setDefaultTrack(this._getAudioTracks(),o,e.audio,r.additionalAudioLanguage):this._setDefaultTrack(this._getAudioTracks(),o,e.audio),this._setDefaultVideoTrack()}},{key:"_getLanguage",value:function(e,t,r){var n=t;if(n===rt){var a=e.find((function(e){return A.Z.langComparer(v.language,e.language)}));a?n=a.language:r&&r.language!==nt?n=r.language:e&&e.length>0&&(n=e[0].language)}return n}},{key:"_setDefaultTrack",value:function(e,t,r,n){var a=this,i=function(e){a.selectTrack(e),a._markActiveTrack(e)},o=e.find((function(e){return A.Z.langComparer(t,e.language,n,!0)}));if(o)i(o);else{var s=e.find((function(e){return A.Z.langComparer(t,e.language,n,!1)}));s?i(s):r&&!r.active&&this.selectTrack(r)}}},{key:"_setDefaultVideoTrack",value:function(){var e=this,t=this._getVideoTracks().sort((function(e,t){return t.bandwidth-e.bandwidth})),r=t.find((function(t){var r;return t.label&&t.label===(null===(r=e._playbackAttributesState.videoTrack)||void 0===r?void 0:r.label)}));r||(r=t.find((function(t){var r;return t.height&&t.height===(null===(r=e._playbackAttributesState.videoTrack)||void 0===r?void 0:r.height)}))),r&&this.selectTrack(r)}},{key:"_maybeSetTracksLabels",value:function(){var e=this._config.customLabels;if(e)for(var t in e){if(!Object.prototype.hasOwnProperty.call(e,t))return;switch(t){case"qualities":this._setTracksCustomLabels(this._getVideoTracks(),e[t]);break;case"audio":this._setTracksCustomLabels(this._getAudioTracks(),e[t]);break;case"captions":this._setTracksCustomLabels(this._getTextTracks(),e[t])}}}},{key:"_setTracksCustomLabels",value:function(e,t){e.forEach((function(e){var r=t(h.c7.copyDeep(e));r&&(e.label=r)}))}},{key:"Event",get:function(){return y.tw}},{key:"TextStyle",get:function(){return x.Z}},{key:"State",get:function(){return E.Y}},{key:"Track",get:function(){return X.V}},{key:"LogLevelType",get:function(){return _.hX}},{key:"LogLevel",get:function(){return _.in}},{key:"AbrMode",get:function(){return ee.n}},{key:"MediaType",get:function(){return J.D}},{key:"StreamType",get:function(){return Z.j}},{key:"EngineType",get:function(){return Q.r}},{key:"CorsType",get:function(){return te.X}},{key:"AdBreakType",get:function(){return Pe.S}},{key:"AdTagType",get:function(){return xe.J}},{key:"Error",get:function(){return b.Z}}],[{key:"runCapabilities",value:function(){k._logger.debug("Running player capabilities"),Te.zv.getEngines().forEach((function(e){return e.runCapabilities()}))}},{key:"getCapabilities",value:function(e){k._logger.debug("Get player capabilities",e);var t=[];return Te.zv.getEngines().forEach((function(e){return t.push(e.getCapabilities())})),Promise.all(t).then((function(t){var r={};return t.forEach((function(e){return Object.assign(r,e)})),e?r[e]:r}))}},{key:"setCapabilities",value:function(e,t){k._logger.debug("Set player capabilities",e,t);var r=Te.zv.getEngines().find((function(t){return t.id===e}));r&&r.setCapabilities(t)}},{key:"_defaultConfig",get:function(){return h.c7.copyDeep(se)}}]),k}(g.H);(0,c.Z)(at,"_logger",(0,_.ZP)("Player"))},9769:function(e,t,r){"use strict";r.d(t,{Y:function(){return n}});var n={IDLE:"idle",LOADING:"loading",PLAYING:"playing",PAUSED:"paused",BUFFERING:"buffering"}},4919:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(5671),a=r(3144),i=function(){function e(t){(0,n.Z)(this,e),this.type=t,this._duration=0,this._timestamp=Date.now()/1e3}return(0,a.Z)(e,[{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e-this._timestamp}}]),e}()},5590:function(e,t,r){"use strict";r.d(t,{F:function(){return i}});var n=r(5671),a=r(3144),i=function(){function e(t){(0,n.Z)(this,e);var r=t.url,a=t.width,i=t.height,o=t.x,s=t.y;this._url=r,this._width=a,this._height=i,this._x=o,this._y=s}return(0,a.Z)(e,[{key:"url",get:function(){return this._url}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}}]),e}()},6820:function(e,t,r){"use strict";r.d(t,{n:function(){return n}});var n={MANUAL:"manual",AUTO:"auto"}},7812:function(e,t,r){"use strict";var n=r(3144),a=r(5671),i=r(9340),o=r(2963),s=r(1120),l=function(e){(0,i.Z)(u,e);var t,r,l=(t=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(r){var a=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,o.Z)(this,e)});function u(){return(0,a.Z)(this,u),l.apply(this,arguments)}return(0,n.Z)(u)}(r(8413).Z);t.Z=l},2983:function(e,t,r){"use strict";var n=r(5671),a=r(3144),i=r(9340),o=r(2963),s=r(1120),l=function(e){(0,i.Z)(u,e);var t,r,l=(t=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(r){var a=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,o.Z)(this,e)});function u(e){var t;(0,n.Z)(this,u),t=l.call(this,e);var r=e.url,a=e.width,i=e.height,o=e.duration,s=e.rows,c=e.cols,d=e.customData;return t._url=r,t._width=a,t._height=i,t._duration=o,t._customData=d,t._rows=s||1,t._cols=c||1,t}return(0,a.Z)(u,[{key:"url",get:function(){return this._url}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"duration",get:function(){return this._duration}},{key:"rows",get:function(){return this._rows}},{key:"cols",get:function(){return this._cols}},{key:"customData",get:function(){return this._customData}},{key:"sliceWidth",get:function(){return this._width/this._cols}},{key:"sliceHeight",get:function(){return this._height/this._rows}}]),u}(r(8413).Z);t.Z=l},6234:function(e,t,r){"use strict";var n=r(5671),a=r(3144),i=r(4942),o=function(){function e(){(0,n.Z)(this,e),(0,i.Z)(this,"_fontSizeIndex",2),(0,i.Z)(this,"fontFamily",e.FontFamily.SANS_SERIF),(0,i.Z)(this,"fontColor",e.StandardColors.WHITE),(0,i.Z)(this,"fontOpacity",e.StandardOpacities.OPAQUE),(0,i.Z)(this,"backgroundColor",e.StandardColors.BLACK),(0,i.Z)(this,"backgroundOpacity",e.StandardOpacities.OPAQUE),(0,i.Z)(this,"fontEdge",e.EdgeStyles.NONE)}return(0,a.Z)(e,[{key:"fontSize",get:function(){return e.FontSizes[this._fontSizeIndex].label},set:function(t){var r=e.FontSizes.findIndex((function(e){return e.label===t}));-1!==r&&(this._fontSizeIndex=r)}},{key:"fontScale",get:function(){return e.FontSizes[this._fontSizeIndex].value},set:function(t){var r=e.FontSizes.findIndex((function(e){return e.value===t}));-1!==r&&(this._fontSizeIndex=r)}},{key:"getTextShadow",value:function(){for(var t=[],r=0;r<this.fontEdge.length;r++){var n=this.fontEdge[r].slice(0,3),a=this.fontEdge[r].slice(3,6);t.push(e.toRGBA(n,this.fontOpacity)+" "+a.join("px ")+"px")}return t.join(",")}},{key:"toCSS",value:function(){var t=[];return t.push("font-family: "+this.fontFamily),t.push("color: "+e.toRGBA(this.fontColor,this.fontOpacity)),t.push("background-color: "+e.toRGBA(this.backgroundColor,this.backgroundOpacity)),t.push("text-shadow: "+this.getTextShadow()),t.join("!important; ")}},{key:"clone",value:function(){return e.fromJson(e.toJson(this))}},{key:"isEqual",value:function(t){return JSON.stringify(e.toJson(this))===JSON.stringify(e.toJson(t))}},{key:"implicitFontScale",get:function(){return.25*e.FontSizes[this._fontSizeIndex].value+1}}],[{key:"toRGBA",value:function(e,t){return"rgba("+e.concat(t).join(",")+")"}},{key:"fromJson",value:function(t){var r=function(e,t){return null!=e?e:t},n=new e;return n.fontEdge=r(t.fontEdge,n.fontEdge),n.fontSize=r(t.fontSize,n.fontSize),n.fontScale=r(t.fontScale,n.fontScale),n.fontColor=r(t.fontColor,n.fontColor),n.fontOpacity=r(t.fontOpacity,n.fontOpacity),n.backgroundColor=r(t.backgroundColor,n.backgroundColor),n.backgroundOpacity=r(t.backgroundOpacity,n.backgroundOpacity),n.fontFamily=r(t.fontFamily,n.fontFamily),n}},{key:"toJson",value:function(e){return{fontEdge:e.fontEdge,fontSize:e.fontSize,fontScale:e.fontScale,fontColor:e.fontColor,fontOpacity:e.fontOpacity,backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity,fontFamily:e.fontFamily}}}]),e}();(0,i.Z)(o,"FontFamily",{ARIAL:"Arial",HELVETICA:"Helvetica",VERDANA:"Verdana",SANS_SERIF:"sans-serif"}),(0,i.Z)(o,"StandardColors",{WHITE:[255,255,255],BLACK:[0,0,0],RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]}),(0,i.Z)(o,"StandardOpacities",{OPAQUE:1,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0}),(0,i.Z)(o,"EdgeStyles",{NONE:[],RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]}),(0,i.Z)(o,"FontSizes",[{value:-2,label:"50%"},{value:-1,label:"75%"},{value:0,label:"100%"},{value:2,label:"200%"},{value:3,label:"300%"},{value:4,label:"400%"}]),t.Z=o},6462:function(e,t,r){"use strict";r.d(t,{PZ:function(){return p},ZP:function(){return p},z6:function(){return h}});var n=r(5671),a=r(3144),i=r(9340),o=r(2963),s=r(1120),l=r(4942),u=r(8413),c=r(962);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var p=function(e){(0,i.Z)(u,e);var t,r,l=(t=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(r){var a=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,o.Z)(this,e)});function u(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.Z)(this,u),(e=l.call(this,t))._label=e.label||e.language,e._kind=t.kind,e._external=t.external,e._index=u._generateIndex(),e._default=t.default||!1,e}return(0,a.Z)(u,[{key:"mode",get:function(){return this._mode},set:function(e){this._mode=e}},{key:"kind",get:function(){return this._kind}},{key:"external",get:function(){return this._external}},{key:"default",get:function(){return this._default}}],[{key:"_generateIndex",value:function(){return u._tracksCount++}},{key:"reset",value:function(){u._tracksCount=0}},{key:"isMetaDataTrack",value:function(e){return e&&e.kind===u.KIND.METADATA}},{key:"isNativeTextTrack",value:function(e){return e&&[u.KIND.SUBTITLES,u.KIND.CAPTIONS].includes(e.kind)}},{key:"isExternalTrack",value:function(e){return e&&[e.language,e.label].includes(u.EXTERNAL_TRACK_ID)}}]),u}(u.Z);function h(e){var t,r=[],n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(VTTCue&&a instanceof VTTCue||window.DataCue&&a instanceof window.DataCue)r.push(a);else if(TextTrackCue&&a instanceof TextTrackCue)try{r.push(new VTTCue(a.startTime,a.endTime,a.text))}catch(e){new c.Z(c.Z.Severity.RECOVERABLE,c.Z.Category.TEXT,c.Z.Code.UNABLE_TO_CREATE_TEXT_CUE,e)}}}catch(e){n.e(e)}finally{n.f()}return r}(0,l.Z)(p,"MODE",{DISABLED:"disabled",SHOWING:"showing",HIDDEN:"hidden"}),(0,l.Z)(p,"KIND",{METADATA:"metadata",SUBTITLES:"subtitles",CAPTIONS:"captions"}),(0,l.Z)(p,"EXTERNAL_TRACK_ID","playkit-external-track"),(0,l.Z)(p,"_tracksCount",0)},375:function(e,t,r){"use strict";r.d(t,{D:function(){return i},PC:function(){return o},cP:function(){return s}});var n=r(3144),a=r(5671),i=(0,n.Z)((function e(t,r,n,i,o){(0,a.Z)(this,e),this.startTime=t,this.endTime=r,this.id=n,this.type=i,this.metadata=o}));function o(e){try{var t=e.startTime,r=e.endTime,n=e.id,a=e.type,i=e.metadata,o=new VTTCue(t,r,""),s={key:a,data:i};return o.id=n,o.value=s,o}catch(e){return null}}function s(e){if(e){var t=e.startTime,r=e.endTime,n=e.id;if(l(e)){var a=l(e),o=a.type,s=a.metadata;return new i(t,r,n,o,s)}}return null}function l(e){if(e&&"value"in e&&e.value){var t=e.type,r=e.value,n=e.track,a=r.key,o=r.data,s="org.id3"===t||"id3"===(n&&n.label),l=Object.values(i.TYPE).find((function(e){return e===a}));return l||(l=s?i.TYPE.ID3:i.TYPE.CUSTOM),{type:l,metadata:s||!o?r:o}}return null}i.TYPE={ID3:"id3",EMSG:"emsg",CUE_POINT:"cuepoint",CUSTOM:"custom"}},5856:function(e,t,r){"use strict";r.d(t,{V:function(){return n}});var n={VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image"}},8413:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(5671),a=r(3144),i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,n.Z)(this,e),this._id=t.id,this._active=t.active,this._label=t.label,this._language=t.language,this._index=t.index,this._available="boolean"!=typeof t.available||t.available,this.clone=e.clone.bind(null,this)}return(0,a.Z)(e,[{key:"id",get:function(){return this._id}},{key:"active",get:function(){return this._active},set:function(e){this._active=e}},{key:"label",get:function(){return this._label},set:function(e){this._label=e}},{key:"language",get:function(){return this._language}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"available",get:function(){return this._available},set:function(e){this._available=e}}],[{key:"langComparer",value:function(e,t,r,n){try{return e=e.toLowerCase(),t=t.toLowerCase(),r&&(r=r.toLowerCase()),n?e===t||r===t:!!e&&(e.startsWith(t)||t.startsWith(e))}catch(e){return!1}}},{key:"clone",value:function(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)}}]),e}()},4877:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(5671),a=r(3144),i=r(9340),o=r(2963),s=r(1120),l=function(e){(0,i.Z)(u,e);var t,r,l=(t=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,s.Z)(t);if(r){var a=(0,s.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,o.Z)(this,e)});function u(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.Z)(this,u),(e=l.call(this,t))._bandwidth=t.bandwidth,e._width=t.width,e._height=t.height,e._label=t.label?t.label:e._height?e._height+"p":void 0,e}return(0,a.Z)(u,[{key:"bandwidth",get:function(){return this._bandwidth}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]),u}(r(8413).Z)},9150:function(e,t,r){"use strict";r.r(t),r.d(t,{TrackType:function(){return n.V}});var n=r(5856),a=r(5901),i={};for(var o in a)["default","TrackType"].indexOf(o)<0&&(i[o]=function(e){return a[e]}.bind(0,o));r.d(t,i)},2069:function(e,t,r){"use strict";var n,a=r(2238),i=r.n(a),o=/^.*(web0s).*(smarttv).*$/i,s=/^.*(smart-tv).*(tizen).*$/i,l=/^.*(vidaa).*(smarttv).*$/i,u=[[s],[[i().BROWSER.NAME,"SAMSUNG_TV_BROWSER"],[i().BROWSER.MAJOR,""],[i().BROWSER.VERSION,""]]],c=[[o],[i().OS.NAME],[l],[i().OS.NAME]],d=[[o],[[i().DEVICE.VENDOR,"LG"],[i().DEVICE.TYPE,i().DEVICE.SMARTTV]],[s],[[i().DEVICE.VENDOR,"SAMSUNG"],[i().DEVICE.TYPE,i().DEVICE.SMARTTV]],[l],[[i().DEVICE.VENDOR,"HISENSE"],[i().DEVICE.TYPE,i().DEVICE.SMARTTV]],[/^.*(smart-tv|smarttv).*$/i],[[i().DEVICE.TYPE,i().DEVICE.SMARTTV]]],p=[[/(edg)\/((\d+)?[\w.]+)/i],[[i().BROWSER.NAME,"Edge"],i().BROWSER.VERSION,i().BROWSER.MAJOR]],h=[].concat(p,u),f=new(i())(void 0,{browser:h,device:d,os:c}).getResult();f.isConsole=f.device.type===i().DEVICE.CONSOLE,f.isSmartTV=f.device.type===i().DEVICE.SMARTTV,f.isMobile=f.device.type===i().DEVICE.MOBILE,f.isTablet=f.device.type===i().DEVICE.TABLET,f.isWearable=f.device.type===i().DEVICE.WEARABLE,f.isEmbedded=f.device.type===i().DEVICE.EMBEDDED,f.isIPadOS="Mac OS"===f.os.name&&"ontouchend"in document,f.isSafari=Boolean(null===(n=f.browser.name)||void 0===n?void 0:n.includes("Safari")),f.isIOS="iOS"===f.os.name,f.isMacOS="Mac OS"===f.os.name,t.Z=f},9021:function(e,t,r){"use strict";r.r(t),r.d(t,{Dom:function(){return n.is},Generator:function(){return n.RO},Http:function(){return n.eV},MultiMap:function(){return m.k},Number:function(){return n.Mr},Object:function(){return n.c7},ResizeWatcher:function(){return h},String:function(){return n.Ld},VERSION:function(){return n.q4},binarySearch:function(){return g}});var n=r(4821),a=r(4942),i=r(5671),o=r(3144),s=r(9340),l=r(2963),u=r(1120),c=r(8987),d=r(8171),p=r(2114),h=function(e){(0,s.Z)(a,e);var t,r,n=(t=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,u.Z)(t);if(r){var a=(0,u.Z)(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return(0,l.Z)(this,e)});function a(){return(0,i.Z)(this,a),n.call(this)}return(0,o.Z)(a,[{key:"destroy",value:function(){this._observer&&this._observer.disconnect(),this._observer=void 0,this._el=void 0}},{key:"init",value:function(e){this._observer||(this._el=e,window.ResizeObserver?this._createNativeObserver():this._createIframeObserver(),this._el instanceof HTMLElement&&this._observer&&this._observer.observe(this._el))}},{key:"_createNativeObserver",value:function(){var e=this;this._observer=new ResizeObserver((function(t){t.forEach((function(){e._triggerResize()}))}))}},{key:"_createIframeObserver",value:function(){this._observer=new f(this._triggerResize.bind(this))}},{key:"_triggerResize",value:function(){this.dispatchEvent(new c.v(p.nQ.RESIZE))}}]),a}(d.H),f=function(){function e(t){(0,i.Z)(this,e),(0,a.Z)(this,"_observersStore",{}),this._onChangeCallback=t}return(0,o.Z)(e,[{key:"observe",value:function(e){var t=this,r=this._createIframe(),n=e.getAttribute("id");this._observersStore[n]=r,e.appendChild(r),r.contentWindow.onresize=function(){return t._onChangeCallback()}}},{key:"disconnect",value:function(){for(var e in this._observersStore){var t=document.getElementById(e),r=this._observersStore[e];r.onresize=null,t&&(t.removeChild(r),delete this._observersStore[t.getAttribute("id")])}}},{key:"_createIframe",value:function(){var e=document.createElement("iframe");return e.className="playkit-size-iframe",e}}]),e}(),m=r(9654);function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 1};if(0===e.length||1===e.length&&0!==t(e[0]))return null;var r=Math.floor(e.length/2);return 0===t(e[r])?e[r]:t(e[r])>0?g(e.slice(0,r),t):g(e.slice(r+1),t)}},4358:function(e,t,r){"use strict";r.d(t,{Ub:function(){return c},ZO:function(){return u},hX:function(){return o},hs:function(){return s},in:function(){return i},jl:function(){return l}});var n=r(5901),a=r.n(n),i={DEBUG:a().DEBUG,INFO:a().INFO,TIME:a().TIME,WARN:a().WARN,ERROR:a().ERROR,OFF:a().OFF,TRACE:a().TRACE},o={};function s(e){a().setHandler((function(t,r){return e(t,r)}))}function l(e){return e?a().get(e):a()}function u(e){return l(e).getLevel()}function c(e,t){l(t).setLevel(e)}Object.keys(i).forEach((function(e){o[e]=e})),a().useDefaults({defaultLevel:a().ERROR}),t.ZP=l},9654:function(e,t,r){"use strict";r.d(t,{k:function(){return o}});var n=r(5671),a=r(3144);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o=function(){function e(){(0,n.Z)(this,e),this._map=new Map}return(0,a.Z)(e,[{key:"push",value:function(e,t){if(this._map.has(e)){var r=this._map.get(e);Array.isArray(r)&&(r.push(t),this._map.set(e,r))}else this._map.set(e,[t])}},{key:"set",value:function(e,t){this._map.set(e,t)}},{key:"has",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){var t=this._map.get(e);return t?t.slice():[]}},{key:"getAll",value:function(){var e,t=[],r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw o}}}}(this._map.values());try{for(r.s();!(e=r.n()).done;){var n=e.value;t=t.concat(n)}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"remove",value:function(e,t){if(this._map.has(e)){var r=this._map.get(e);if(Array.isArray(r)){for(var n=0;n<r.length;++n)r[n]===t&&(r.splice(n,1),--n);0===r.length&&this._map.delete(e)}}}},{key:"keys",value:function(){return this._map.keys()}},{key:"clear",value:function(){this._map.clear()}}]),e}()},1177:function(e,t,r){"use strict";function n(e,t){var r=function(e,t){var r=1/0,n=function(e,t,n){return e>=(t||0)&&e<=(n||r)},a=t.maxHeight,i=t.minHeight,o=t.maxWidth,s=t.minWidth;if(0!==i||0!==s||a!==r||o!==r)return e.filter((function(e){return n(e.height,i,a)})).filter((function(e){return n(e.width,s,o)}));var l=t.maxBitrate,u=t.minBitrate;return 0!==u||l!==r?e.filter((function(e){return n(e.bandwidth,u,l)})):e}(e,t);return r.length?r:[]}r.d(t,{u:function(){return n}})},4821:function(e,t,r){"use strict";r.d(t,{is:function(){return g},RO:function(){return m},eV:function(){return y},Mr:function(){return p},c7:function(){return f},Ld:function(){return h},q4:function(){return v}});var n=r(3878),a=r(9199),i=r(181),o=r(5267),s=r(4942),l=r(1002),u=r(962),c="responseFormat=jsonp&callback=";function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var p={isNumber:function(e){return Number(e)===e},isInt:function(e){return this.isNumber(e)&&e%1==0},isFloat:function(e){return this.isNumber(e)&&e%1!=0}},h={capitlize:function(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)},endsWith:function(e,t){return"string"==typeof e&&"string"==typeof t&&-1!==e.indexOf(t,e.length-t.length)}},f={merge:function(e){var t,r={},n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;Object.assign(r,a)}}catch(e){n.e(e)}finally{n.f()}return r},isObject:function(e){return e&&"object"===(0,l.Z)(e)&&!Array.isArray(e)},isClassInstance:function(e){return e&&e.constructor&&e.constructor.name&&"Object"!==e.constructor.name},mergeDeep:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(!r.length)return e;var a=r.shift();if(this.isObject(e)&&this.isObject(a))for(var i in a)this.isObject(a[i])&&!this.isClassInstance(a[i])?(e[i]||Object.assign(e,(0,s.Z)({},i,{})),this.mergeDeep(e[i],a[i])):Object.assign(e,(0,s.Z)({},i,a[i]));return this.mergeDeep.apply(this,[e].concat(r))},copyDeep:function(e){var t,r=this;return Array.isArray(e)?(t=e.length>0?e.slice(0):[]).forEach((function(e,n){("object"===(0,l.Z)(e)||Array.isArray(e)&&e.length>0)&&(t[n]=r.copyDeep(e))})):null!==e&&"object"===(0,l.Z)(e)?e.clone&&"function"==typeof e.clone?t=e.clone():(t=Object.assign({__proto__:e.__proto__},e),Object.keys(t).forEach((function(e){("object"===(0,l.Z)(t[e])||Array.isArray(t[e])&&t[e].length>0)&&(t[e]=r.copyDeep(t[e]))}))):t=e,t},isEmptyObject:function(e){for(var t in e)if(Object.hasOwnProperty.call(e,t))return!1;return!0},getPropertyPath:function(e,t){return t.split(".").reduce((function(e,t){return null==e?e:e[t]}),e)},hasPropertyPath:function(e,t){if(!t)return!1;for(var r=t.split("."),n=0;n<r.length;n++){var a=r[n];if(!e||!Object.hasOwnProperty.call(e,a))return!1;e=e[a]}return!0},createPropertyPath:function(e,t){for(var r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=t.split("."),u=e;l.length>1;){var c=(r=l,(0,n.Z)(r)||(0,a.Z)(r)||(0,i.Z)(r)||(0,o.Z)()),d=c[0];l=c.slice(1),void 0===u[d]&&(u[d]={}),u=u[d]}return u[l[0]]=s,e},deletePropertyPath:function(e,t){if(e&&t){for(var r=t.split("."),n=0;n<r.length-1;n++)if(void 0===(e=e[r[n]]))return;delete e[r.pop()]}},defer:function(){var e,t,r=new Promise((function(r,n){e=r,t=n}));return r.resolve=e,r.reject=t,r},bind:function(e,t){return function(){t.apply(e,arguments)}}},m={uniqueId:function(e){var t=2+(!e||e<0?0:e-2);return"_"+Math.random().toString(36).slice(2,2+t)},guid:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},g={addClassName:function(e,t){e&&(e.classList?e.classList.add(t):g.hasClassName(e,t)||(e.className+=t))},removeClassName:function(e,t){e&&(e.classList?e.classList.remove(t):g.hasClassName(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ").replace(/^\s+|\s+$/g,"")))},hasClassName:function(e,t){return e&&e.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},setAttribute:function(e,t,r){e.setAttribute(t,r)},removeAttribute:function(e,t){e.removeAttribute(t)},setStyle:function(e,t,r){void 0!==e.style.getPropertyValue(t)&&e.style.setProperty(t,r)},appendChild:function(e,t){e&&t&&e.appendChild&&e.appendChild(t)},removeChild:function(e,t){e&&t&&e.removeChild&&e.removeChild(t)},prependTo:function(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},getElementById:function(e){return document.getElementById(e)},getElementsByTagName:function(e){return document.getElementsByTagName(e)},createElement:function(e){return document.createElement(e)},loadStyleSheetAsync:function(e){var t=this;return new Promise((function(r,n){var a=!1,i=t.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,i.async=!0,i.onload=i.onreadystatechange=function(){a||this.readyState&&"complete"!==this.readyState||(a=!0,r(this))},i.onerror=i.onabort=n,g.appendChild(document.head,i)}))},loadScriptAsync:function(e){var t=this;return new Promise((function(r,n){var a=!1,i=document.getElementsByTagName("script")[0],o=t.createElement("script");o.type="text/javascript",o.src=e,o.async=!0,o.onload=o.onreadystatechange=function(){a||this.readyState&&"complete"!==this.readyState||(a=!0,r(this))},o.onerror=o.onabort=n,i&&i.parentNode&&i.parentNode.insertBefore(o,i)}))},getElementBySelector:function(e){try{return document.querySelector(e)}catch(e){return}},insertBefore:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{return e.insertBefore(t,r)}catch(e){return null}}},y={protocol:/^(https?:)/i.test(document.location.protocol)?document.location.protocol:"https:",execute:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=new XMLHttpRequest;return new Promise((function(s,l){o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status)try{var e=JSON.parse(o.responseText);s(e)}catch(e){s(o.responseText)}else l(o.responseText)},o.open(r,e),n&&n.forEach((function(e,t){o.setRequestHeader(t,e)})),a&&(o.timeout=a),i&&(o.ontimeout=function(e){i(),l(e)}),o.send(t)}))},jsonp:function(e,t,r){var n,a=(r=r||{}).timeout?r.timeout:5e3,i=document.createElement("script"),o="jsonpcallback"+Math.round(Date.now()+1000001*Math.random()),s=e,l=function(){i&&i.parentNode&&i.parentNode.removeChild(i),window[o]=function(){},n&&clearTimeout(n)};return new Promise((function(r,d){a&&(n=setTimeout((function(){l(),d(new u.Z(u.Z.Severity.CRITICAL,u.Z.Category.NETWORK,u.Z.Code.TIMEOUT,e))}),a)),window[o]=function(n){var a=t(n,e);l(),r(a)},s.match(/\?/)?s+="&"+c+o:s+="?"+c+o,i.type="text/javascript",i.src=s,document.getElementsByTagName("head")[0].appendChild(i)}))},convertHeadersToDictionary:function(e){var t={};try{e.trim().split(/[\r\n]+/).forEach((function(e){var r=e.split(": "),n=r.shift().toLowerCase(),a=r.join(": ");t[n]=a}))}catch(e){}return t}},v={compare:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=(r=f.merge([{lexicographical:!1,zeroExtend:!0},r])).lexicographical,a=r.zeroExtend,i=(e||"0").split("."),o=(t||"0").split("."),s=function(e){return(n?/^\d+[A-Za-zαß]*$/:/^\d+[A-Za-zαß]?$/).test(e)},l=function(e){return e.map((function(e){var t=/[A-Za-zαß]/.exec(e);return Number(t?e.replace(t[0],"."+e.charCodeAt(t.index)):e)}))};if(!i.every(s)||!o.every(s))return NaN;if(a){for(;i.length<o.length;)i.push("0");for(;o.length<i.length;)o.push("0")}n||(i=l(i),o=l(o));for(var u=0;u<i.length;++u){if(o.length===u)return 1;if(i[u]!==o[u])return i[u]>o[u]?1:-1}return i.length!==o.length?-1:0}}},7774:function(e,t,r){"use strict";var n=r(7537),a=r.n(n),i=r(3645),o=r.n(i)()(a());o.push([e.id,".playkit-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  color: #fff;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.playkit-engine {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  object-fit: contain;\n}\n\n.playkit-engine video::-webkit-media-controls-panel,\n.playkit-engine video::-webkit-media-controls-panel-container,\n.playkit-engine video::-webkit-media-controls-start-playback-button,\n.playkit-engine video::-webkit-media-controls-play-button {\n  display: none;\n  -webkit-appearance: none;\n}\n\n.playkit-poster {\n  position: absolute;\n  display: block;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-size: contain;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-color: var(--playkit-player-background-color);\n  pointer-events: none;\n}\n\n.playkit-subtitles {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  pointer-events: none;\n  margin-bottom: 5px;\n}\n\n.playkit-black-cover {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: black;\n  pointer-events: none;\n}\n\n.playkit-size-iframe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  border: 0;\n  z-index: -100;\n}\n\n.playkit-in-browser-fullscreen-mode {\n  width: 100% !important;\n  height: 100% !important;\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  /*added for blocking element with fixed position which could be on the top of the player */\n  z-index: 999999 !important;\n}\n","",{version:3,sources:["webpack://./src/assets/style.css"],names:[],mappings:"AAAA;EACE,kBAAkB;EAClB,WAAW;EACX,YAAY;EACZ,WAAW;EACX,aAAa;EACb,2BAA2B;EAC3B,yBAAyB;EACzB,sBAAsB;EACtB,qBAAqB;EACrB,iBAAiB;EACjB,wCAAwC;AAC1C;;AAEA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,MAAM;EACN,OAAO;EACP,mBAAmB;AACrB;;AAEA;;;;EAIE,aAAa;EACb,wBAAwB;AAC1B;;AAEA;EACE,kBAAkB;EAClB,cAAc;EACd,MAAM;EACN,SAAS;EACT,OAAO;EACP,QAAQ;EACR,wBAAwB;EACxB,kCAAkC;EAClC,4BAA4B;EAC5B,wDAAwD;EACxD,oBAAoB;AACtB;;AAEA;EACE,kBAAkB;EAClB,MAAM;EACN,SAAS;EACT,QAAQ;EACR,OAAO;EACP,oBAAoB;EACpB,kBAAkB;AACpB;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,YAAY;EACZ,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,WAAW;EACX,YAAY;EACZ,kBAAkB;EAClB,SAAS;EACT,aAAa;AACf;;AAEA;EACE,sBAAsB;EACtB,uBAAuB;EACvB,0BAA0B;EAC1B,iBAAiB;EACjB,kBAAkB;EAClB,0FAA0F;EAC1F,0BAA0B;AAC5B",sourcesContent:[".playkit-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  color: #fff;\n  outline: none;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.playkit-engine {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  object-fit: contain;\n}\n\n.playkit-engine video::-webkit-media-controls-panel,\n.playkit-engine video::-webkit-media-controls-panel-container,\n.playkit-engine video::-webkit-media-controls-start-playback-button,\n.playkit-engine video::-webkit-media-controls-play-button {\n  display: none;\n  -webkit-appearance: none;\n}\n\n.playkit-poster {\n  position: absolute;\n  display: block;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-size: contain;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-color: var(--playkit-player-background-color);\n  pointer-events: none;\n}\n\n.playkit-subtitles {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  pointer-events: none;\n  margin-bottom: 5px;\n}\n\n.playkit-black-cover {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: black;\n  pointer-events: none;\n}\n\n.playkit-size-iframe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  border: 0;\n  z-index: -100;\n}\n\n.playkit-in-browser-fullscreen-mode {\n  width: 100% !important;\n  height: 100% !important;\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  /*added for blocking element with fixed position which could be on the top of the player */\n  z-index: 999999 !important;\n}\n"],sourceRoot:""}]),t.Z=o},3645:function(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,a,i){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(n)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(o[l]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);n&&o[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),r&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=r):c[2]=r),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),t.push(c))}},t}},7537:function(e){"use strict";e.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(a," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},5901:function(e,t,r){var n,a;!function(i){"use strict";var o,s={VERSION:"1.6.1"},l={},u=function(e,t){return function(){return t.apply(e,arguments)}},c=function(){var e,t,r=arguments,n=r[0];for(t=1;t<r.length;t++)for(e in r[t])!(e in n)&&r[t].hasOwnProperty(e)&&(n[e]=r[t][e]);return n},d=function(e,t){return{value:e,name:t}};s.TRACE=d(1,"TRACE"),s.DEBUG=d(2,"DEBUG"),s.INFO=d(3,"INFO"),s.TIME=d(4,"TIME"),s.WARN=d(5,"WARN"),s.ERROR=d(8,"ERROR"),s.OFF=d(99,"OFF");var p=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};p.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(s.TRACE,arguments)},debug:function(){this.invoke(s.DEBUG,arguments)},info:function(){this.invoke(s.INFO,arguments)},warn:function(){this.invoke(s.WARN,arguments)},error:function(){this.invoke(s.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"end"])},invoke:function(e,t){o&&this.enabledFor(e)&&o(t,c({level:e},this.context))}};var h,f=new p({filterLevel:s.OFF});(h=s).enabledFor=u(f,f.enabledFor),h.trace=u(f,f.trace),h.debug=u(f,f.debug),h.time=u(f,f.time),h.timeEnd=u(f,f.timeEnd),h.info=u(f,f.info),h.warn=u(f,f.warn),h.error=u(f,f.error),h.log=h.info,s.setHandler=function(e){o=e},s.setLevel=function(e){for(var t in f.setLevel(e),l)l.hasOwnProperty(t)&&l[t].setLevel(e)},s.getLevel=function(){return f.getLevel()},s.get=function(e){return l[e]||(l[e]=new p(c({name:e},f.context)))},s.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},r=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(n,a){n=Array.prototype.slice.call(n);var i,o=console.log;a.level===s.TIME?(i=(a.name?"["+a.name+"] ":"")+n[0],"start"===n[1]?console.time?console.time(i):t[i]=(new Date).getTime():console.timeEnd?console.timeEnd(i):r(o,[i+": "+((new Date).getTime()-t[i])+"ms"])):(a.level===s.WARN&&console.warn?o=console.warn:a.level===s.ERROR&&console.error?o=console.error:a.level===s.INFO&&console.info?o=console.info:a.level===s.DEBUG&&console.debug?o=console.debug:a.level===s.TRACE&&console.trace&&(o=console.trace),e.formatter(n,a),r(o,n))}},s.useDefaults=function(e){s.setLevel(e&&e.defaultLevel||s.DEBUG),s.setHandler(s.createDefaultHandler(e))},s.setDefaults=s.useDefaults,void 0===(a="function"==typeof(n=s)?n.call(t,r,t,e):n)||(e.exports=a)}()},3379:function(e){"use strict";var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var i={},o=[],s=0;s<e.length;s++){var l=e[s],u=n.base?l[0]+n.base:l[0],c=i[u]||0,d="".concat(u," ").concat(c);i[u]=c+1;var p=r(d),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var f=a(h,n);n.byIndex=s,t.splice(s,0,{identifier:d,updater:f,references:1})}o.push(d)}return o}function a(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,a){var i=n(e=e||[],a=a||{});return function(e){e=e||[];for(var o=0;o<i.length;o++){var s=r(i[o]);t[s].references--}for(var l=n(e,a),u=0;u<i.length;u++){var c=r(i[u]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}i=l}}},569:function(e){"use strict";var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},9216:function(e){"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:function(e,t,r){"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},7795:function(e){"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var a=void 0!==r.layer;a&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,a&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:function(e){"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},2238:function(e,t,r){var n;!function(a,i){"use strict";var o="function",s="undefined",l="object",u="string",c="major",d="model",p="name",h="type",f="vendor",m="version",g="architecture",y="console",v="mobile",_="tablet",k="smarttv",E="wearable",b="embedded",T="Amazon",A="Apple",S="ASUS",C="BlackBerry",P="Browser",x="Chrome",w="Firefox",I="Google",M="Huawei",R="LG",D="Microsoft",O="Motorola",L="Opera",N="Samsung",U="Sharp",j="Sony",B="Xiaomi",F="Zebra",V="Facebook",H="Chromium OS",G="Mac OS",$=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},K=function(e,t){return typeof e===u&&-1!==W(t).indexOf(W(e))},W=function(e){return e.toLowerCase()},z=function(e,t){if(typeof e===u)return e=e.replace(/^\s\s*/,""),typeof t===s?e:e.substring(0,500)},q=function(e,t){for(var r,n,a,s,u,c,d=0;d<t.length&&!u;){var p=t[d],h=t[d+1];for(r=n=0;r<p.length&&!u&&p[r];)if(u=p[r++].exec(e))for(a=0;a<h.length;a++)c=u[++n],typeof(s=h[a])===l&&s.length>0?2===s.length?typeof s[1]==o?this[s[0]]=s[1].call(this,c):this[s[0]]=s[1]:3===s.length?typeof s[1]!==o||s[1].exec&&s[1].test?this[s[0]]=c?c.replace(s[1],s[2]):i:this[s[0]]=c?s[1].call(this,c,s[2]):i:4===s.length&&(this[s[0]]=c?s[3].call(this,c.replace(s[1],s[2])):i):this[s]=c||i;d+=2}},Y=function(e,t){for(var r in t)if(typeof t[r]===l&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(K(t[r][n],e))return"?"===r?i:r}else if(K(t[r],e))return"?"===r?i:r;return e},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Z={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[m,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[m,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,m],[/opios[\/ ]+([\w\.]+)/i],[m,[p,L+" Mini"]],[/\bopr\/([\w\.]+)/i],[m,[p,L]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[m,[p,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[p,m],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[m,[p,"UC"+P]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[m,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[m,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[m,[p,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[m,[p,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[m,[p,"Smart Lenovo "+P]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure "+P],m],[/\bfocus\/([\w\.]+)/i],[m,[p,w+" Focus"]],[/\bopt\/([\w\.]+)/i],[m,[p,L+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[m,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[m,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[m,[p,L+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[m,[p,"MIUI "+P]],[/fxios\/([-\w\.]+)/i],[m,[p,w]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 "+P]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1 "+P],m],[/samsungbrowser\/([\w\.]+)/i],[m,[p,N+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],m],[/metasr[\/ ]?([\d\.]+)/i],[m,[p,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[p,"Sogou Mobile"],m],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[p,m],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,V],m],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[p,m],[/\bgsa\/([\w\.]+) .*safari\//i],[m,[p,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[m,[p,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[m,[p,x+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,x+" WebView"],m],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[m,[p,"Android "+P]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,m],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[m,[p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[m,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[m,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[p,m],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],m],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[m,[p,w+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[p,m],[/(cobalt)\/([\w\.]+)/i],[p,[m,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,W]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,"",W]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,W]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[f,N],[h,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[d,[f,N],[h,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[f,A],[h,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[f,A],[h,_]],[/(macintosh);/i],[d,[f,A]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[f,U],[h,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[f,M],[h,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[f,M],[h,v]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[d,/_/g," "],[f,B],[h,v]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[f,B],[h,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[f,"OPPO"],[h,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[f,"Vivo"],[h,v]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[f,"Realme"],[h,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[f,O],[h,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[f,O],[h,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[f,R],[h,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[f,R],[h,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[f,"Lenovo"],[h,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[f,"Nokia"],[h,v]],[/(pixel c)\b/i],[d,[f,I],[h,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[f,I],[h,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[f,j],[h,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[f,j],[h,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[f,"OnePlus"],[h,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[f,T],[h,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[f,T],[h,v]],[/(playbook);[-\w\),; ]+(rim)/i],[d,f,[h,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[f,C],[h,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[f,S],[h,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[f,S],[h,v]],[/(nexus 9)/i],[d,[f,"HTC"],[h,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[f,[d,/_/g," "],[h,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[f,"Acer"],[h,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[f,"Meizu"],[h,v]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[f,"Ulefone"],[h,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,d,[h,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,d,[h,_]],[/(surface duo)/i],[d,[f,D],[h,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[f,"Fairphone"],[h,v]],[/(u304aa)/i],[d,[f,"AT&T"],[h,v]],[/\bsie-(\w*)/i],[d,[f,"Siemens"],[h,v]],[/\b(rct\w+) b/i],[d,[f,"RCA"],[h,_]],[/\b(venue[\d ]{2,7}) b/i],[d,[f,"Dell"],[h,_]],[/\b(q(?:mv|ta)\w+) b/i],[d,[f,"Verizon"],[h,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[f,"Barnes & Noble"],[h,_]],[/\b(tm\d{3}\w+) b/i],[d,[f,"NuVision"],[h,_]],[/\b(k88) b/i],[d,[f,"ZTE"],[h,_]],[/\b(nx\d{3}j) b/i],[d,[f,"ZTE"],[h,v]],[/\b(gen\d{3}) b.+49h/i],[d,[f,"Swiss"],[h,v]],[/\b(zur\d{3}) b/i],[d,[f,"Swiss"],[h,_]],[/\b((zeki)?tb.*\b) b/i],[d,[f,"Zeki"],[h,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],d,[h,_]],[/\b(ns-?\w{0,9}) b/i],[d,[f,"Insignia"],[h,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[f,"NextBook"],[h,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],d,[h,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],d,[h,v]],[/\b(ph-1) /i],[d,[f,"Essential"],[h,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[f,"Envizen"],[h,_]],[/\b(trio[-\w\. ]+) b/i],[d,[f,"MachSpeed"],[h,_]],[/\btu_(1491) b/i],[d,[f,"Rotor"],[h,_]],[/(shield[\w ]+) b/i],[d,[f,"Nvidia"],[h,_]],[/(sprint) (\w+)/i],[f,d,[h,v]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[f,D],[h,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[f,F],[h,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[f,F],[h,v]],[/smart-tv.+(samsung)/i],[f,[h,k]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[f,N],[h,k]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,R],[h,k]],[/(apple) ?tv/i],[f,[d,A+" TV"],[h,k]],[/crkey/i],[[d,x+"cast"],[f,I],[h,k]],[/droid.+aft(\w+)( bui|\))/i],[d,[f,T],[h,k]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[f,U],[h,k]],[/(bravia[\w ]+)( bui|\))/i],[d,[f,j],[h,k]],[/(mitv-\w{5}) bui/i],[d,[f,B],[h,k]],[/Hbbtv.*(technisat) (.*);/i],[f,d,[h,k]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[f,z],[d,z],[h,k]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,k]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,d,[h,y]],[/droid.+; (shield) bui/i],[d,[f,"Nvidia"],[h,y]],[/(playstation [345portablevi]+)/i],[d,[f,j],[h,y]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[f,D],[h,y]],[/((pebble))app/i],[f,d,[h,E]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[f,A],[h,E]],[/droid.+; (glass) \d/i],[d,[f,I],[h,E]],[/droid.+; (wt63?0{2,3})\)/i],[d,[f,F],[h,E]],[/(quest( 2| pro)?)/i],[d,[f,V],[h,E]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[h,b]],[/(aeobc)\b/i],[d,[f,T],[h,b]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[h,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[h,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,v]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[m,[p,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[m,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[p,m],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[m,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,m],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[p,[m,Y,X]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[m,Y,X],[p,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[m,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,G],[m,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[m,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,m],[/\(bb(10);/i],[m,[p,C]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[m,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[m,[p,w+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[m,[p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[m,[p,"watchOS"]],[/crkey\/([\d\.]+)/i],[m,[p,x+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[p,H],m],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,m],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],m],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[p,m]]},Q=function(e,t){if(typeof e===l&&(t=e,e=i),!(this instanceof Q))return new Q(e,t).getResult();var r=typeof a!==s&&a.navigator?a.navigator:i,n=e||(r&&r.userAgent?r.userAgent:""),y=r&&r.userAgentData?r.userAgentData:i,k=t?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(Z,t):Z,E=r&&r.userAgent==n;return this.getBrowser=function(){var e,t={};return t[p]=i,t[m]=i,q.call(t,n,k.browser),t[c]=typeof(e=t[m])===u?e.replace(/[^\d\.]/g,"").split(".")[0]:i,E&&r&&r.brave&&typeof r.brave.isBrave==o&&(t[p]="Brave"),t},this.getCPU=function(){var e={};return e[g]=i,q.call(e,n,k.cpu),e},this.getDevice=function(){var e={};return e[f]=i,e[d]=i,e[h]=i,q.call(e,n,k.device),E&&!e[h]&&y&&y.mobile&&(e[h]=v),E&&"Macintosh"==e[d]&&r&&typeof r.standalone!==s&&r.maxTouchPoints&&r.maxTouchPoints>2&&(e[d]="iPad",e[h]=_),e},this.getEngine=function(){var e={};return e[p]=i,e[m]=i,q.call(e,n,k.engine),e},this.getOS=function(){var e={};return e[p]=i,e[m]=i,q.call(e,n,k.os),E&&!e[p]&&y&&"Unknown"!=y.platform&&(e[p]=y.platform.replace(/chrome os/i,H).replace(/macos/i,G)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===u&&e.length>500?z(e,500):e,this},this.setUA(n),this};Q.VERSION="1.0.37",Q.BROWSER=$([p,m,c]),Q.CPU=$([g]),Q.DEVICE=$([d,f,h,y,v,k,_,E,b]),Q.ENGINE=Q.OS=$([p,m]),typeof t!==s?(e.exports&&(t=e.exports=Q),t.UAParser=Q):r.amdO?(n=function(){return Q}.call(t,r,t,e))===i||(e.exports=n):typeof a!==s&&(a.UAParser=Q);var J=typeof a!==s&&(a.jQuery||a.Zepto);if(J&&!J.ua){var ee=new Q;J.ua=ee.getResult(),J.ua.get=function(){return ee.getUA()},J.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var r in t)J.ua[r]=t[r]}}}("object"==typeof window?window:this)},7061:function(e,t,r){var n=r(8698).default;function a(){"use strict";e.exports=a=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var t,r={},i=Object.prototype,o=i.hasOwnProperty,s=Object.defineProperty||function(e,t,r){e[t]=r.value},l="function"==typeof Symbol?Symbol:{},u=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",d=l.toStringTag||"@@toStringTag";function p(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(t){p=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var a=t&&t.prototype instanceof k?t:k,i=Object.create(a.prototype),o=new D(n||[]);return s(i,"_invoke",{value:w(e,r,o)}),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}r.wrap=h;var m="suspendedStart",g="suspendedYield",y="executing",v="completed",_={};function k(){}function E(){}function b(){}var T={};p(T,u,(function(){return this}));var A=Object.getPrototypeOf,S=A&&A(A(O([])));S&&S!==i&&o.call(S,u)&&(T=S);var C=b.prototype=k.prototype=Object.create(T);function P(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(a,i,s,l){var u=f(e[a],e,i);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==n(d)&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,l)}),(function(e){r("throw",e,s,l)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return r("throw",e,s,l)}))}l(u.arg)}var a;s(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}})}function w(e,r,n){var a=m;return function(i,o){if(a===y)throw new Error("Generator is already running");if(a===v){if("throw"===i)throw o;return{value:t,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var l=I(s,n);if(l){if(l===_)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===m)throw a=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=y;var u=f(e,r,n);if("normal"===u.type){if(a=n.done?v:g,u.arg===_)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=v,n.method="throw",n.arg=u.arg)}}}function I(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var i=f(a,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,_;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,_):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function O(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function r(){for(;++a<e.length;)if(o.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(n(e)+" is not iterable")}return E.prototype=b,s(C,"constructor",{value:b,configurable:!0}),s(b,"constructor",{value:E,configurable:!0}),E.displayName=p(b,d,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===E||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,p(e,d,"GeneratorFunction")),e.prototype=Object.create(C),e},r.awrap=function(e){return{__await:e}},P(x.prototype),p(x.prototype,c,(function(){return this})),r.AsyncIterator=x,r.async=function(e,t,n,a,i){void 0===i&&(i=Promise);var o=new x(h(e,t,n,a),i);return r.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},P(C),p(C,d,"Generator"),p(C,u,(function(){return this})),p(C,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=O,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,a){return s.type="throw",s.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var l=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;R(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:O(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),_}},r}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4687:function(e,t,r){var n=r(7061)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},907:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{Z:function(){return n}})},3878:function(e,t,r){"use strict";function n(e){if(Array.isArray(e))return e}r.d(t,{Z:function(){return n}})},7326:function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,{Z:function(){return n}})},5671:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,{Z:function(){return n}})},3144:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(9142);function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(0,n.Z)(a.key),a)}}function i(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}},4942:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(9142);function a(e,t,r){return(t=(0,n.Z)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},1752:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(1120);function a(){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,n.Z)(e)););return e}(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},a.apply(this,arguments)}},1120:function(e,t,r){"use strict";function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}r.d(t,{Z:function(){return n}})},9340:function(e,t,r){"use strict";function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)}r.d(t,{Z:function(){return a}})},9199:function(e,t,r){"use strict";function n(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}r.d(t,{Z:function(){return n}})},5267:function(e,t,r){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.d(t,{Z:function(){return n}})},2963:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(1002),a=r(7326);function i(e,t){if(t&&("object"===(0,n.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,a.Z)(e)}},9439:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(3878),a=r(181),i=r(5267);function o(e,t){return(0,n.Z)(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||(0,a.Z)(e,t)||(0,i.Z)()}},3433:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(907),a=r(9199),i=r(181);function o(e){return function(e){if(Array.isArray(e))return(0,n.Z)(e)}(e)||(0,a.Z)(e)||(0,i.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},9142:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(1002);function a(e){var t=function(e,t){if("object"!==(0,n.Z)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!==(0,n.Z)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===(0,n.Z)(t)?t:String(t)}},1002:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{Z:function(){return n}})},181:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(907);function a(e,t){if(e){if("string"==typeof e)return(0,n.Z)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.Z)(e,t):void 0}}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={id:n,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.amdO={},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nc=void 0;var n={};return function(){"use strict";r.r(n),r.d(n,{AbrMode:function(){return S.n},AdBreakType:function(){return M.S},AdEventType:function(){return D.J},AdTagType:function(){return R.J},AudioTrack:function(){return p.Z},AutoPlayType:function(){return L.B},BaseMediaSourceAdapter:function(){return t.Z},BaseMiddleware:function(){return s.Z},CorsType:function(){return P.X},CustomEventType:function(){return A.nQ},DrmScheme:function(){return x.J},EngineDecoratorProvider:function(){return i._},EngineType:function(){return b.r},Env:function(){return g.Z},Error:function(){return v.Z},EventManager:function(){return B.Q},EventType:function(){return A.tw},FakeEvent:function(){return j.v},FakeEventTarget:function(){return F.H},Html5EventType:function(){return A.Rk},ImageTrack:function(){return c.Z},LogLevel:function(){return C.in},LogLevelType:function(){return C.hX},MediaType:function(){return T.D},MimeType:function(){return w.H},NAME:function(){return K},PKTextTrack:function(){return h.PZ},Player:function(){return e.Z},RequestType:function(){return I.x},ScreenOrientationType:function(){return O.z},State:function(){return l.Z},StateType:function(){return _.Y},StreamType:function(){return E.j},TextStyle:function(){return m.Z},TextTrack:function(){return h.ZP},ThumbnailInfo:function(){return N.F},TimedMetadata:function(){return f.D},Track:function(){return u.Z},TrackType:function(){return k.V},Utils:function(){return y},VERSION:function(){return $},VideoTrack:function(){return d.Z},createTextTrackCue:function(){return f.PC},createTimedMetadata:function(){return f.cP},filterTracksByRestriction:function(){return U.u},getCapabilities:function(){return z},getLogLevel:function(){return C.ZO},getLogger:function(){return C.ZP},loadPlayer:function(){return W},registerEngine:function(){return o.Hl},registerMediaSourceAdapter:function(){return a.L},setCapabilities:function(){return q},setLogHandler:function(){return C.hs},setLogLevel:function(){return C.Ub},unRegisterEngine:function(){return o.co},utils:function(){return y}});var e=r(4649),t=r(4651),a=r(2588),i=r(1057),o=r(4779),s=r(902),l=r(4919),u=r(8413),c=r(2983),d=r(4877),p=r(7812),h=r(6462),f=r(375),m=r(6234),g=r(2069),y=r(9021),v=r(962),_=r(9769),k=r(5856),E=r(7300),b=r(488),T=r(2806),A=r(2114),S=r(6820),C=r(4358),P=r(6145),x=r(7237),w=r(3336),I=r(6975),M=r(9063),R=r(8151),D=r(4611),O=r(3323),L=r(8143),N=r(5590),U=r(1177),j=r(8987),B=r(4270),F=r(8171),V=r(9150),H={};for(var G in V)["default","loadPlayer","registerMediaSourceAdapter","BaseMediaSourceAdapter","BaseMiddleware","Track","VideoTrack","AudioTrack","TextTrack","PKTextTrack","ImageTrack","TextStyle","TimedMetadata","createTextTrackCue","createTimedMetadata","Utils","utils","Error","FakeEvent","EventManager","FakeEventTarget","VERSION","NAME","Env","State","getCapabilities","setCapabilities","EngineDecoratorProvider","registerEngine","unRegisterEngine","AdBreakType","AdTagType","AdEventType","filterTracksByRestriction","Html5EventType","CustomEventType","EventType","StateType","TrackType","EngineType","MediaType","StreamType","AbrMode","LogLevelType","CorsType","DrmScheme","MimeType","RequestType","ScreenOrientationType","AutoPlayType","ThumbnailInfo","getLogger","LogLevel","getLogLevel","setLogLevel","setLogHandler","Player"].indexOf(G)<0&&(H[G]=function(e){return V[e]}.bind(0,G));r.d(n,H);var $="0.84.4",K="@playkit-js/playkit-js";function W(t){return new e.Z(t||{})}var z=e.Z.getCapabilities,q=e.Z.setCapabilities;n.default=W}(),n}()}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var module=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e](module,module.exports,__webpack_require__),module.loaded=!0,module.exports}__webpack_require__.n=module=>{var e=module&&module.__esModule?()=>module.default:()=>module;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=module=>(module.paths=[],module.children||(module.children=[]),module),__webpack_require__.nc=void 0;var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Ad:()=>Yi,AdBreak:()=>Ji,BasePlugin:()=>ae,KALTURA_PLAYER_START_TIME_QS:()=>Mt,KalturaPlayer:()=>Fa,LocalStorageManager:()=>rt,PLAYER_NAME:()=>eo,PLAYER_TYPE:()=>to,SessionStorageManager:()=>Et,VERSION:()=>ro,cast:()=>$i,core:()=>f,getPlayer:()=>Ga,getPlayers:()=>Ha,playlist:()=>Ki,providers:()=>g,registerPlugin:()=>de,setup:()=>za,ui:()=>m});var e=__webpack_require__(701),t=__webpack_require__.n(e),r=__webpack_require__(236),n=__webpack_require__.n(r),a=__webpack_require__(80),i=__webpack_require__.n(a),o=__webpack_require__(850),s=__webpack_require__.n(o),l=__webpack_require__(182),u=__webpack_require__.n(l),c=__webpack_require__(213),d=__webpack_require__.n(c),p=__webpack_require__(129),h={};h.styleTagTransform=d(),h.setAttributes=s(),h.insert=i().bind(null,"head"),h.domAPI=n(),h.insertStyleElement=u();t()(p.Z,h);p.Z&&p.Z.locals&&p.Z.locals;var f=__webpack_require__(538),m=__webpack_require__(693),g=__webpack_require__(859);__webpack_require__(305),__webpack_require__(644);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,k(n.key),n)}}function _(e,t,r){return(t=k(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e){var t=function(e,t){if("object"!=y(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==y(t)?t:String(t)}var E=function(){function e(t,r){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),_(this,"_disabled",!1),this._player=t;var a=r.ui;if(a.disable){this._disabled=!0;var i=document.getElementById(a.targetId);i&&i.appendChild(t.getView())}else this._uiManager=new m.UIManager(t,a),a.customPreset||window.kalturaCustomPreset?this._uiManager.buildCustomUI(a.customPreset||window.kalturaCustomPreset):this._uiManager.buildDefaultUI(),this._handleVr(r.plugins),this._handleExternalCSS(a);return new Proxy(this,{get:function(e,t){return n._disabled?function(){}:e[t]}})}var t,r,n;return t=e,r=[{key:"destroy",value:function(){this._uiManager.destroy()}},{key:"reset",value:function(){this._resetErrorState()}},{key:"setConfig",value:function(e,t){this._uiManager.setConfig(e,t)}},{key:"addComponent",value:function(e){return this._uiManager.addComponent(e)}},{key:"removeComponent",value:function(e){var t={label:"Remove_".concat(e.removeComponent),get:m.Components.Remove,presets:e.presets,area:e.area||e.container,replaceComponent:e.removeComponent};return this._uiManager.addComponent(t)}},{key:"store",get:function(){return this._uiManager.store}},{key:"registerManager",value:function(e,t){this._player.registerService(e,t)}},{key:"getManager",value:function(e){return this._player.getService(e)}},{key:"hasManager",value:function(e){return this._player.hasService(e)}},{key:"setLoadingSpinnerState",value:function(e){this.setConfig({show:e},"loading")}},{key:"_resetErrorState",value:function(){this.setConfig({hasError:!1},"engine")}},{key:"_handleExternalCSS",value:function(t){t.css&&f.Utils.Dom.loadStyleSheetAsync(t.css).then((function(){e._logger.debug("external css was loaded successfully")}),(function(){e._logger.error("external css failed to load")}))}},{key:"_handleVr",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.vr&&!e.vr.disable&&this._setStereoConfig(e.vr)}},{key:"_setStereoConfig",value:function(e){(e.toggleStereo||(f.Env.isMobile||f.Env.isTablet)&&!1!==e.toggleStereo)&&this.setConfig(f.Utils.Object.mergeDeep({},{vrStereoMode:!!e.startInStereo}),"vrStereo")}}],r&&v(t.prototype,r),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function A(e,t,r){return(t=S(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e){var t=function(e,t){if("object"!=b(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==b(t)?t:String(t)}_(E,"_logger",(0,f.getLogger)("UIWrapper"));var C=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),A(this,"_prebid",null),this._loadPromise=f.Utils.Object.defer(),this._loadPromise.catch((function(){return e._logger.warn("Prebid SDK failed to load")})),t?(this._config=t,this._loadPrebidSDKLib(this._config.libUrl).then((function(){r._isPrebidSDKLibLoaded()?(r._prebid=window.pbjs,r._loadPromise.resolve()):r._loadPromise.reject()})).catch((function(){r._loadPromise.reject()}))):this._loadPromise.reject()}var t,r,n;return t=e,(r=[{key:"_isPrebidSDKLibLoaded",value:function(){return window.pbjs&&window.pbjs.que}},{key:"_loadPrebidSDKLib",value:function(e){return this._isPrebidSDKLibLoaded()?Promise.resolve():f.Utils.Dom.loadScriptAsync(e)}},{key:"_load",value:function(t){var r=this;return new Promise((function(n,a){r._loadPromise.then((function(){var i=setTimeout(a,t.timeout||4e3);r._prebid.que.push((function(){r._prebid.addAdUnits(t.adUnit),t.options&&r._prebid.setConfig(t.options),r._prebid.requestBids({bidsBackHandler:function(o){if(e._logger.debug("returned bids",o),clearTimeout(i),t.params){var s={};t.adUnit&&(s.adUnit=t.adUnit),s.params=t.params;var l=r._prebid.adServers.dfp.buildVideoUrl(s);n([{vastUrl:l}])}else try{var u=o[t.adUnit.code||Object.keys(o)[0]].bids;n(u)}catch(e){a()}}})}))})).catch(a)}))}},{key:"load",value:function(e){return this._load(e||this._config)}}])&&T(t.prototype,r),n&&T(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function w(e,t,r){return t=M(t),function(e,t){if(t&&("object"===P(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return R(e)}(e,I()?Reflect.construct(t,r||[],M(e).constructor):t.apply(e,r))}function I(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(I=function(){return!!e})()}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e,t){return D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},D(e,t)}function O(e){var t=function(e,t){if("object"!=P(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==P(t)?t:String(t)}A(C,"_logger",(0,f.getLogger)("PrebidManager"));var L=function(e){function t(e){var r,n,a,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=w(this,t),n=R(r),i="AdLayoutMiddleware",(a=O(a="id"))in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i,r._context=e,r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D(e,t)}(t,e),r=t,(n=[{key:"load",value:function(e){var t=this;this._context.prerollReady.then((function(){return t.callNext(e)}))}},{key:"play",value:function(e){var t=this;this._context.prerollReady.then((function(){return t.callNext(e)}))}}])&&x(r.prototype,n),a&&x(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}(f.BaseMiddleware);function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function U(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,W(n.key),n)}}function V(e,t,r){return t=G(t),function(e,t){if(t&&("object"===N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,H()?Reflect.construct(t,r||[],G(e).constructor):t.apply(e,r))}function H(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(H=function(){return!!e})()}function G(e){return G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},G(e)}function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}function K(e,t,r){return(t=W(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W(e){var t=function(e,t){if("object"!=N(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==N(t)?t:String(t)}var z=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=V(this,t))._player=e,n._eventManager=new f.EventManager,n._liveEventManager=new f.EventManager,n._adsPluginControllers=r,n._prebidManager=new C(n._player.config.advertising&&n._player.config.advertising.prebid),n._init(),n}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(t,e),r=t,n=[{key:"allAdsCompleted",get:function(){return this._allAdsCompleted}},{key:"isAdPlaying",value:function(){return this.isAdBreak()&&this._isAdPlaying}},{key:"isAdBreak",value:function(){return!!this._adBreak}},{key:"getAdBreaksLayout",value:function(){return this._adBreaksLayout}},{key:"getAdBreak",value:function(){return this._adBreak}},{key:"getAd",value:function(){return this._ad}},{key:"skipAd",value:function(){var e=this._adsPluginControllers.find((function(e){return e.active}));e&&e.skipAd()}},{key:"playAdNow",value:function(e){var r=this;if(this.isAdBreak())t._logger.warn("Tried to call playAdNow during an ad break");else{var n=Promise.all(e.map((function(e){return r._getPrebidAds(e)})));this._playAdBreak({position:this._player.currentTime||0,ads:e,played:!1,loadedPromise:n})}}},{key:"getMiddleware",value:function(){return this._middleware?this._middleware:this._middleware=new L(this)}},{key:"_init",value:function(){this._initMembers(),this._addBindings()}},{key:"_initMembers",value:function(){this._allAdsCompleted=!0,this._adBreaksLayout=[],this._adBreak=void 0,this._ad=void 0,this._adPlayed=!1,this._snapback=0,this._adIsLoading=!1,this._isAdPlaying=!1,this._liveSeeking=!1}},{key:"_addBindings",value:function(){var e=this;this._eventManager.listen(this._player,f.CustomEventType.SOURCE_SELECTED,(function(){return e._handleConfiguredAdBreaks()})),this._eventManager.listen(this._player,f.AdEventType.AD_MANIFEST_LOADED,(function(t){return e._onAdManifestLoaded(t)})),this._eventManager.listen(this._player,f.AdEventType.AD_BREAK_START,(function(t){return e._onAdBreakStart(t)})),this._eventManager.listen(this._player,f.AdEventType.AD_LOADED,(function(){return e._onAdLoaded()})),this._eventManager.listen(this._player,f.AdEventType.AD_STARTED,(function(t){return e._onAdStarted(t)})),this._eventManager.listen(this._player,f.AdEventType.AD_COMPLETED,(function(){return e._isAdPlaying=!1})),this._eventManager.listen(this._player,f.AdEventType.AD_BREAK_END,(function(){return e._onAdBreakEnd()})),this._eventManager.listen(this._player,f.AdEventType.ADS_COMPLETED,(function(){return e._onAdsCompleted()})),this._eventManager.listen(this._player,f.AdEventType.AD_ERROR,(function(t){return e._onAdError(t)})),this._eventManager.listen(this._player,f.CustomEventType.PLAYER_RESET,(function(){return e._reset()})),this._eventManager.listen(this._player,f.CustomEventType.PLAYER_DESTROY,(function(){return e._destroy()})),this._eventManager.listenOnce(this._player,f.Html5EventType.ENDED,(function(){return e._onEnded()})),this._eventManager.listenOnce(this._player,f.CustomEventType.PLAYBACK_ENDED,(function(){return e._onPlaybackEnded()})),this._eventManager.listen(this._player,f.AdEventType.AD_RESUMED,(function(){return e._isAdPlaying=!0})),this._eventManager.listen(this._player,f.AdEventType.AD_PAUSED,(function(){return e._isAdPlaying=!1}))}},{key:"_handleConfiguredAdBreaks",value:function(){var e=this,t=this._player.config.advertising.playAdsAfterTime||this._player.config.sources.startTime;this._configAdBreaks=this._player.config.advertising.adBreaks.filter((function(e){return("number"==typeof e.every||"number"==typeof e.position||"number"==typeof e.percentage)&&e.ads.length})).map((function(r){e._validateOneTimeConfig(r);var n=r.position;0===r.percentage&&(n=0),100===r.percentage&&(n=-1),r.every&&(n=r.every);var a=e._player.isLive()?n<t:n<=t;return{position:n,percentage:r.percentage,every:r.every,ads:r.ads.slice(),played:-1<n&&a}})),this._configAdBreaks.length?(this._dispatchAdManifestLoaded(),this._handlePrebidAdConfig(),this._handleConfiguredPreroll(),this._eventManager.listenOnce(this._player,f.Html5EventType.DURATION_CHANGE,(function(){e._player.isLive()?e._eventManager.listenOnce(e._player,f.Html5EventType.SEEKING,(function(){e._pushNextAdsForLive(e._configAdBreaks,(function(t){return e._player.currentTime+t.every})),e._attachLiveSeekedHandler()})):e._handleEveryAndPercentage(),e._configAdBreaks.sort((function(e,t){return e.position-t.position})),e._configAdBreaks.some((function(e){return e.position>0}))&&e._handleConfiguredMidrolls()}))):this.prerollReady=Promise.resolve()}},{key:"_validateOneTimeConfig",value:function(e){"number"==typeof e.position&&("number"==typeof e.percentage&&(t._logger.warn("Validate ad break - ignore percentage ".concat(e.percentage," as position ").concat(e.position," configured")),delete e.percentage),"number"==typeof e.every&&(t._logger.warn("Validate ad break - ignore every ".concat(e.every," as position ").concat(e.position," configured")),delete e.every)),"number"==typeof e.percentage&&"number"==typeof e.every&&(t._logger.warn("Validate ad break - ignore every ".concat(e.every," as percentage ").concat(e.percentage," configured")),delete e.every)}},{key:"_dispatchAdManifestLoaded",value:function(){var e=this,r=Array.from(new Set(this._configAdBreaks.map((function(e){return e.every&&e.every+"s"||"number"==typeof e.percentage&&e.percentage+"%"||e.position}))));t._logger.debug(f.AdEventType.AD_MANIFEST_LOADED,r),this._player.dispatchEvent(new f.FakeEvent(f.AdEventType.AD_MANIFEST_LOADED,{adBreaksPosition:r})),this._player.hasService("timeline")&&this._player.config.advertising.showAdBreakCuePoint&&r.forEach((function(t){e._player.getService("timeline").addCuePoint(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){K(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({time:-1!==t?t:1/0},e._player.config.advertising.adBreakCuePointStyle))}))}},{key:"_handlePrebidAdConfig",value:function(){var e=this;this._prebidManager&&this._configAdBreaks.filter((function(e){return!e.played})).map((function(t){var r=Promise.all(t.ads.map((function(t){return e._getPrebidAds(t)})));t.loadedPromise=r,r.then((function(e){return t.ads=e}))}))}},{key:"_getPrebidAds",value:function(e){var t=this;return new Promise((function(r){if(e.prebid&&t._prebidManager){var n=f.Utils.Object.mergeDeep({},e.prebid,t._player.config.advertising.prebid);t._prebidManager.load(n).then((function(t){var n=t.map((function(e){return e&&e.vastUrl}));e.url=n.concat(e.url),r(e)})).catch((function(){r(e)}))}else r(e)}))}},{key:"_handleConfiguredPreroll",value:function(){var e=this._configAdBreaks.filter((function(e){return 0===e.position&&!e.played})),t=this._mergeAdBreaks(e);this.prerollReady=t&&t.loadedPromise?t.loadedPromise:Promise.resolve(),t&&this._playAdBreak(t)}},{key:"_handleEveryAndPercentage",value:function(){var e=this;this._configAdBreaks.forEach((function(t){if(e._player.duration&&t.every)for(var r=2*t.every;r<=e._player.duration;)e._configAdBreaks.push({position:r,ads:t.ads,played:!1,loadedPromise:Promise.resolve()}),r+=t.every;else e._player.duration&&t.percentage&&!t.position&&(t.position=Math.floor(e._player.duration*t.percentage/100))}))}},{key:"_attachLiveSeekedHandler",value:function(){var e=this;this._eventManager.listenOnce(this._player,f.CustomEventType.FIRST_PLAYING,(function(){e._eventManager.listen(e._player,f.Html5EventType.SEEKING,(function(){e._liveSeeking=!0})),e._eventManager.listen(e._player,f.Html5EventType.SEEKED,(function(){e._liveSeeking=!1,e._pushNextAdsForLive(e._configAdBreaks,(function(t){return e._player.currentTime+t.every}))}))}))}},{key:"_pushNextAdsForLive",value:function(e,r){this._liveEventManager.removeAll();var n=[];e.forEach((function(e){if(![-1,0].includes(e.position)){var a=e.every,i=e.ads,o={every:a,position:r(e),ads:i,played:!1,loadedPromise:Promise.resolve()};t._logger.debug("Pushing next ad for live",o),n.push(o)}})),n.length&&(this._configAdBreaks=[].concat(n,U(this._configAdBreaks.filter((function(e){return-1===e.position})))))}},{key:"_handleConfiguredMidrolls",value:function(){var e=this;this._eventManager.listen(this._player,f.Html5EventType.TIME_UPDATE,(function(){if(!e._player.paused&&!e._liveSeeking){var r=e._configAdBreaks.filter((function(t){return!t.played&&e._player.currentTime&&t.position<=e._player.currentTime&&t.position>e._snapback}));if(r.length){var n=r[r.length-1].position,a=r.filter((function(e){return e.position===n}));e._player.isLive()?!e._player.isDvr()||e._player.isOnLiveEdge()&&e._player.config.advertising.returnToLive?e._handleReturnToLive(a):e._pushNextAdsForLive(a,(function(t){return(e._player.isOnLiveEdge()?e._player.currentTime:t.position)+t.every})):(e._snapback=n,t._logger.debug("Set snapback value ".concat(e._snapback)),e._eventManager.listen(e._player,f.Html5EventType.SEEKED,(function(){var r=e._configAdBreaks.findIndex((function(t){return t.played&&"number"==typeof e._player.currentTime&&e._player.currentTime<t.position}));r>0&&!e._configAdBreaks[r-1].played&&(e._snapback=0,t._logger.debug("Reset snapback value"))})));var i=e._mergeAdBreaks(a);i&&e._playAdBreak(i)}}}))}},{key:"_handleReturnToLive",value:function(e){var t=this;this._liveEventManager.listenOnce(this._player,f.AdEventType.AD_ERROR,(function(){t._pushNextAdsForLive(e,(function(e){return(t._player.isOnLiveEdge()?t._player.currentTime:e.position)+e.every}))})),this._liveEventManager.listenOnce(this._player,f.AdEventType.AD_BREAK_END,(function(){t._player.seekToLiveEdge()}))}},{key:"_playAdBreak",value:function(e){var r=this._adsPluginControllers.find((function(e){return"function"==typeof e.playAdNow}));r?(e.played=!0,this._adIsLoading=!0,t._logger.debug("Playing ad break positioned in ".concat(e.position)),e.loadedPromise.then((function(){return r.playAdNow(e.ads)}))):t._logger.warn("No ads plugin registered")}},{key:"_onAdManifestLoaded",value:function(e){this._adBreaksLayout=Array.from(new Set(this._adBreaksLayout.concat(e.payload.adBreaksPosition))).sort(),this._allAdsCompleted=!1}},{key:"_onAdBreakStart",value:function(e){this._adBreak=e.payload.adBreak}},{key:"_onAdLoaded",value:function(){this._adIsLoading=!1}},{key:"_onAdStarted",value:function(e){this._ad=e.payload.ad,this._adPlayed=!0,this._isAdPlaying=!0}},{key:"_onAdBreakEnd",value:function(){this._adBreak=void 0,this._ad=void 0}},{key:"_onAdsCompleted",value:function(){this._adsPluginControllers.every((function(e){return e.done}))&&this._configAdBreaks.every((function(e){return e.played}))&&(this._allAdsCompleted=!0,t._logger.debug(f.AdEventType.ALL_ADS_COMPLETED),this.dispatchEvent(new f.FakeEvent(f.AdEventType.ALL_ADS_COMPLETED)))}},{key:"_onAdError",value:function(e){this._adIsLoading=!1,e.payload.severity===f.Error.Severity.CRITICAL&&(this._isAdPlaying=!1,this._adsPluginControllers.every((function(e){return e.done}))&&this._configAdBreaks.every((function(e){return e.played}))&&(this._allAdsCompleted=!0,this._adPlayed&&(t._logger.debug(f.AdEventType.ALL_ADS_COMPLETED),this.dispatchEvent(new f.FakeEvent(f.AdEventType.ALL_ADS_COMPLETED)))))}},{key:"_isBumper",value:function(e){return"bumper"===e.name}},{key:"_onEnded",value:function(){var e=this;if(!this._adIsLoading){var t=this._adsPluginControllers.find((function(t){return e._isBumper(t)})),r=this._adsPluginControllers.find((function(t){return!e._isBumper(t)&&!t.done})),n=t&&"function"==typeof t.onPlaybackEnded?function(){return t.onPlaybackEnded()}:function(){return Promise.resolve()},a=r&&"function"==typeof r.onPlaybackEnded?function(){return r.onPlaybackEnded()}:function(){return Promise.resolve()};this._adBreaksLayout.includes(-1)||this._adBreaksLayout.includes("100%")||(this._allAdsCompleted=!0),n().finally((function(){a().finally((function(){return e._handleConfiguredPostroll()}))}))}}},{key:"_onPlaybackEnded",value:function(){this._configAdBreaks.forEach((function(e){return e.played=!0}))}},{key:"_handleConfiguredPostroll",value:function(){var e=this._configAdBreaks.filter((function(e){return!e.played&&-1===e.position}));if(e.length){var t=this._mergeAdBreaks(e);t&&this._playAdBreak(t)}this._configAdBreaks.forEach((function(e){return e.played=!0}))}},{key:"_reset",value:function(){this._eventManager.removeAll(),this._liveEventManager.removeAll(),this._init()}},{key:"_destroy",value:function(){this._adsPluginControllers=[],this._eventManager.destroy(),this._liveEventManager.destroy()}},{key:"_mergeAdBreaks",value:function(e){if(e.length)return e.forEach((function(e){return e.played=!0})),{position:e[0].position,ads:e.reduce((function(e,t){return e.concat(t.ads)}),[]),played:!1,loadedPromise:Promise.all(e.map((function(e){return e.loadedPromise})))}}}],n&&F(r.prototype,n),a&&F(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}(f.FakeEventTarget);function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X(n.key),n)}}function X(e){var t=function(e,t){if("object"!=q(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==q(t)?t:String(t)}K(z,"_logger",(0,f.getLogger)("AdsController"));var Z=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._pluginManager=t}var t,r,n;return t=e,(r=[{key:"getAdsControllers",value:function(){return Object.values(this._pluginManager.getAll()).filter((function(e){return"function"==typeof e.getAdsController})).map((function(e){return e.getAdsController()}))}}])&&Y(t.prototype,r),n&&Y(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){re(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ne(n.key),n)}}function re(e,t,r){return(t=ne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ne(e){var t=function(e,t){if("object"!=Q(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Q(t)?t:String(t)}var ae=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.player=r,this.eventManager=new f.EventManager,this.logger=(0,f.getLogger)(f.Utils.String.capitlize(this.name)),this.config=ee(ee({},this.constructor.defaultConfig),n)}var t,r,n;return t=e,r=[{key:"getConfig",value:function(e){return e?f.Utils.Object.copyDeep(this.config[e]):f.Utils.Object.copyDeep(this.config)}},{key:"ready",get:function(){return Promise.resolve()}},{key:"updateConfig",value:function(e){f.Utils.Object.mergeDeep(this.config,e)}},{key:"loadMedia",value:function(){}},{key:"open",value:function(){throw new f.Error(f.Error.Severity.CRITICAL,f.Error.Category.PLAYER,f.Error.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,"showOverlay()")}},{key:"destroy",value:function(){this.eventManager.destroy()}},{key:"reset",value:function(){}},{key:"getName",value:function(){return this.name}},{key:"dispatchEvent",value:function(e,t){this.logger.debug("Fire event: "+e,t),this.player.dispatchEvent(new f.FakeEvent(e,t))}}],n=[{key:"isValid",value:function(){throw new f.Error(f.Error.Severity.CRITICAL,f.Error.Category.PLAYER,f.Error.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,"isValid()")}}],r&&te(t.prototype,r),n&&te(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function oe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,le(n.key),n)}}function se(e,t,r){return(t=le(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function le(e){var t=function(e,t){if("object"!=ie(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ie(t)?t:String(t)}re(ae,"defaultConfig",{});var ue="registeredpluginslistevent",ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),se(this,"_plugins",{}),se(this,"_isDisabledPluginMap",new Map)}var t,r,n;return t=e,r=[{key:"load",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e._registry.has(t))throw e._logger.warn("Plugin <".concat(t,"> loading failed, plugin is not registered")),new f.Error(f.Error.Severity.RECOVERABLE,f.Error.Category.PLAYER,f.Error.Code.RUNTIME_ERROR_NOT_REGISTERED_PLUGIN,t);var a=e._registry.get(t);"boolean"==typeof n.disable&&this._isDisabledPluginMap.set(t,n.disable);var i=!!this._isDisabledPluginMap.get(t),o=!!a&&a.isValid();if(a&&o&&!i){try{this._plugins[t]=new a(t,r,n)}catch(e){throw new f.Error(f.Error.Severity.RECOVERABLE,f.Error.Category.PLAYER,f.Error.Code.PLUGIN_LOAD_FAILED,e)}return this._isDisabledPluginMap.set(t,!1),e._logger.debug("Plugin <".concat(t,"> has been loaded")),!0}return e._logger.debug("Plugin <".concat(t,"> isn't loaded, isValid()=").concat(o.toString(),", disabled=").concat(i.toString())),!1}},{key:"getRegisterdPluginsList",value:function(){return Array.from(e._registry.keys())}},{key:"loadMedia",value:function(){var e=this;Object.keys(this._plugins).forEach((function(t){return e._plugins[t].loadMedia()}))}},{key:"destroy",value:function(){var e=this;Object.keys(this._plugins).forEach((function(t){e._plugins[t].destroy(),delete e._plugins[t]}))}},{key:"reset",value:function(){var e=this;Object.keys(this._plugins).forEach((function(t){return e._plugins[t].reset()}))}},{key:"get",value:function(e){return this._plugins[e]}},{key:"getAll",value:function(){return this._plugins}}],n=[{key:"register",value:function(t,r){return"function"==typeof r&&r.prototype instanceof ae?e._registry.has(t)?(e._logger.debug("Plugin <".concat(t,"> is already registered, do not register again")),!1):(e._registry.set(t,r),e._logger.debug("Plugin <".concat(t,"> has been registered successfully")),!0):(e._logger.error("Plugin <".concat(t,"> registration failed, plugin is not an instance of BasePlugin")),!1)}},{key:"unRegister",value:function(t){e._registry.has(t)&&(e._registry.delete(t),e._logger.debug("Unregistered <".concat(t,"> plugin.")))}}],r&&oe(t.prototype,r),n&&oe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();se(ce,"_logger",(0,f.getLogger)("PluginManager")),se(ce,"_registry",new Map);var de=ce.register;function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function he(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fe(n.key),n)}}function fe(e){var t=function(e,t){if("object"!=pe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pe(t)?t:String(t)}function me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ge(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ge(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ye={youbora:{playerVersion:"{{pVersion}}",playerName:"{{pName}}",entryId:"{{entryId}}",entryName:"{{entryName}}",entryType:"{{entryType}}",sessionId:"{{sessionId}}",uiConfId:"{{uiConfId}}"},googleAnalytics:{entryId:"{{entryId}}",entryName:"{{entryName}}",uiConfId:"{{uiConfId}}",partnerId:"{{partnerId}}"},ottAnalytics:{entryId:"{{entryId}}",ks:"{{ks}}",isAnonymous:"{{isAnonymous}}",partnerId:"{{partnerId}}",serviceUrl:"{{serviceUrl}}"},ima:{playerVersion:"{{pVersion}}",playerName:"{{pName}}"},kava:{playerVersion:"{{pVersion}}",playerName:"{{pName}}",partnerId:"{{partnerId}}",playlistId:"{{playlistId}}",entryId:"{{entryId}}",entryType:"{{entryType}}",sessionId:"{{sessionId}}",ks:"{{ks}}",uiConfId:"{{uiConfId}}",referrer:"{{referrer}}",encodedReferrer:"{{encodedReferrer}}",serviceUrl:"{{analyticsServiceUrl}}"},comscore:{playerVersion:"{{pVersion}}"},vr:{rootElement:"{{domRootElementId}}"},share:{partnerId:"{{partnerId}}",uiConfId:"{{uiConfId}}",entryId:"{{entryId}}",embedBaseUrl:"{{embedBaseUrl}}",embedWidth:"{{embedWidth}}",embedHeight:"{{embedHeight}}"}},ve=new RegExp("{{.*}}"),_e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(t).reduce((function(t,r){var n=me(r,2),a=n[0],i=n[1];return f.Utils.Object.isObject(i)?t[a]=e(i):"string"==typeof i&&ve.test(i)?t[a]=i:t[a]=void 0,t}),{})},ke=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(t).reduce((function(t,r){var n=me(r,2),a=n[0],i=n[1];return f.Utils.Object.isObject(i)?t[a]=e(i):i&&(t[a]=i),t}),{})};function Ee(e){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ee(e)}function be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xe(n.key),n)}}function Te(e,t,r){return t=Se(t),function(e,t){if(t&&("object"===Ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ce(e)}(e,Ae()?Reflect.construct(t,r||[],Se(e).constructor):t.apply(e,r))}function Ae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ae=function(){return!!e})()}function Se(e){return Se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Se(e)}function Ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pe(e,t){return Pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pe(e,t)}function xe(e){var t=function(e,t){if("object"!=Ee(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ee(t)?t:String(t)}var we=function(e){function t(){var e,r,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=Te(this,t),r=Ce(e),a={ottAnalytics:{}},(n=xe(n="_ovpPluginsConfig"))in r?Object.defineProperty(r,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[n]=a,e._config=f.Utils.Object.mergeDeep({},e._basePluginsConfig,e._ovpPluginsConfig),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pe(e,t)}(t,e),r=t,n&&be(r.prototype,n),a&&be(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,a}(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._basePluginsConfig=f.Utils.Object.copyDeep(ye)}var t,r,n;return t=e,(r=[{key:"get",value:function(){return this._config}},{key:"set",value:function(e){if(e){var t=_e(e);this._config=ke(f.Utils.Object.mergeDeep(this._config,t))}}},{key:"reset",value:function(){this._config=f.Utils.Object.copyDeep(ye)}}])&&he(t.prototype,r),n&&he(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}());const Ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var r,n=e;for(var a in t){var i=void 0!==t[a]&&null!==t[a]?t[a]:"";"string"==typeof i&&i.indexOf('"')>-1&&(i=i.replace(/"/g,'\\"')),r=new RegExp("{{"+a+"}}","g"),n=n.replace(r,i)}return n}catch(e){return""}};function Me(e,t){var r=function(e){var t=document.createElement("a");return t.href=e,t.hostname},n=r(t),a=!1,i="",o="";return e&&(e.flavors&&Array.isArray(e.flavors)?(i=(a=1===e.flavors.length)&&r(e.flavors[0].url),o=e.flavors[0].url):e.result&&(a=!0,i=r(e.result.url),o=e.result.url)),a&&n!==i?o:t}function Re(e,t){var r,n={};if((null==t||null===(r=t.sources)||void 0===r?void 0:r.type)===f.MediaType.LIVE&&("IE"===f.Env.browser.name||"Chromecast"===f.Env.device.model)){var a=f.Utils.Object.getPropertyPath(e,"sources.options.forceRedirectExternalStreams"),i=f.Utils.Object.getPropertyPath(t,"sources.options.forceRedirectExternalStreams");"boolean"!=typeof a&&"boolean"!=typeof i&&f.Utils.Object.mergeDeep(n,{sources:{options:{forceRedirectExternalStreams:!0}}})}return f.Utils.Object.mergeDeep(n,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=f.Utils.Object.getPropertyPath(e,"sources.options.redirectExternalStreamsHandler"),a=f.Utils.Object.getPropertyPath(t,"sources.options.redirectExternalStreamsHandler");return"function"!=typeof n&&"function"!=typeof a&&f.Utils.Object.mergeDeep(r,{sources:{options:{redirectExternalStreamsHandler:Me}}}),r}(e,t))}var De={INITIAL_CONFIG_REQUIRED:"Must provide initial providers config",PARTNER_ID_REQUIRED:"Must provide partner id",TARGET_ID_REQUIRED:"Must provide target id",DOM_ELEMENT_WITH_TARGET_ID_REQUIRED:"Must provide DOM element with id of: ",TARGET_ID_ALREADY_USED:"The target id provided is already in use. Id: "};function Oe(e){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oe(e)}function Le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ne(n.key),n)}}function Ne(e){var t=function(e,t){if("object"!=Oe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Oe(t)?t:String(t)}var Ue,je,Be,Fe="@playkit-js/kaltura-player-js_",Ve=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"isStorageAvailable",value:function(e){if("undefined"==typeof Storage)return!1;try{return e.setItem("test","test"),e.removeItem("test"),!0}catch(e){return!1}}},{key:"getStorageSize",value:function(e){return Object.keys(e).filter((function(e){return e.startsWith(Fe)})).length}},{key:"setItem",value:function(t,r,n){e._validateKey(t);try{e._logger.debug("Sets item for key: "+t,r),n.setItem(Fe+t,r)}catch(t){e._isQuotaExceeded(t)?e._logger.error("Quota exceeded: "+t.message):e._logger.error(t.message)}}},{key:"getItem",value:function(t,r){e._validateKey(t);var n=null;try{return"string"==typeof(n=r.getItem(Fe+t))?JSON.parse(n):null}catch(e){return n}}},{key:"_isQuotaExceeded",value:function(e){var t=!1;if(e)if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else-2147024882===e.number&&(t=!0);return t}},{key:"_validateKey",value:function(e){if("string"!=typeof e||0===e.length)throw new Error("Invalid key")}}],(r=null)&&Le(t.prototype,r),n&&Le(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function He(e){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(e)}function Ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,We(n.key),n)}}function Ke(e,t,r){return t&&$e(e.prototype,t),r&&$e(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function We(e){var t=function(e,t){if("object"!=He(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=He(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==He(t)?t:String(t)}Ue=Ve,je="_logger",Be=(0,f.getLogger)("StorageWrapper"),(je=Ne(je))in Ue?Object.defineProperty(Ue,je,{value:Be,enumerable:!0,configurable:!0,writable:!0}):Ue[je]=Be;var ze=function(){function e(){Ge(this,e),this.storageManagers=[]}return Ke(e,[{key:"addManager",value:function(e){this.storageManagers.push(e)}}],[{key:"getInstance",value:function(){return null===this.instance&&(this.instance=new e),this.instance}}]),e}();!function(e,t,r){(t=We(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(ze,"instance",null);var qe=function(){function e(){Ge(this,e)}return Ke(e,null,[{key:"init",value:function(e){this._logger=(0,f.getLogger)(e),ze.getInstance().addManager(this)}},{key:"attachAll",value:function(e){ze.getInstance().storageManagers.forEach((function(t){t.isStorageAvailable()&&t.attach(e)}))}},{key:"setStorageConfig",value:function(e){ze.getInstance().storageManagers.forEach((function(t){t.isStorageAvailable()&&t.hasStorage()&&f.Utils.Object.mergeDeep(e,t.getStorageConfig())}))}},{key:"isStorageAvailable",value:function(){return Ve.isStorageAvailable(this.getStorageObject())}},{key:"hasStorage",value:function(){var e=this.getStorageSize(),t=0!==e;return t?this._logger.debug("Storage found with size of ",e):this._logger.debug("No storage found"),t}},{key:"setItem",value:function(e,t){Ve.setItem(e,t,this.getStorageObject())}},{key:"getItem",value:function(e){return Ve.getItem(e,this.getStorageObject())}},{key:"getStorageSize",value:function(){return Ve.getStorageSize(this.getStorageObject())}},{key:"getStorageConfig",value:function(){var e=this._getExistingValues(),t=this._buildStorageConfig(e);return this._logger.debug("Gets storage config",t),t}},{key:"_getExistingValues",value:function(){var e=this,t={};return Object.keys(this.StorageKeys).forEach((function(r){var n=e.StorageKeys[r],a=e.getItem(n);null!=a&&(t[n]=a)})),t}},{key:"_buildStorageConfig",value:function(e){var t=f.Utils.Object.mergeDeep({},e);return delete t.textStyle,{playback:t}}},{key:"getStorageObject",value:function(){throw new f.Error(f.Error.Severity.CRITICAL,f.Error.Category.PLAYER,f.Error.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,"getStorageObject()")}},{key:"attach",value:function(e){throw new f.Error(f.Error.Severity.CRITICAL,f.Error.Category.PLAYER,f.Error.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,"attach()")}},{key:"initialize",value:function(){throw new f.Error(f.Error.Severity.CRITICAL,f.Error.Category.PLAYER,f.Error.Code.RUNTIME_ERROR_METHOD_NOT_IMPLEMENTED,"initialize()")}}]),e}();function Ye(e){return Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(e)}function Xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tt(n.key),n)}}function Ze(e,t,r){return t=Je(t),function(e,t){if(t&&("object"===Ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Qe()?Reflect.construct(t,r||[],Je(e).constructor):t.apply(e,r))}function Qe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Qe=function(){return!!e})()}function Je(e){return Je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Je(e)}function et(e,t){return et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},et(e,t)}function tt(e){var t=function(e,t){if("object"!=Ye(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ye(t)?t:String(t)}var rt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ze(this,t,arguments)}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&et(e,t)}(t,e),r=t,a=[{key:"initialize",value:function(){this.init(this.name)}},{key:"getStorageObject",value:function(){return localStorage}},{key:"attach",value:function(e){var t=this;this._logger.debug("Attach local storage");var r=new f.EventManager;r.listen(e,e.Event.UI.USER_CLICKED_MUTE,(function(){e.isCasting()||t.setItem(t.StorageKeys.MUTED,e.muted)})),r.listen(e,e.Event.UI.USER_CLICKED_UNMUTE,(function(){e.isCasting()||t.setItem(t.StorageKeys.MUTED,e.muted)})),r.listen(e,e.Event.UI.USER_CHANGED_VOLUME,(function(){e.isCasting()||(t.setItem(t.StorageKeys.MUTED,!e.volume),t.setItem(t.StorageKeys.VOLUME,e.volume))})),r.listen(e,e.Event.UI.USER_SELECTED_AUDIO_TRACK,(function(e){var r=e.payload.audioTrack;t.setItem(t.StorageKeys.AUDIO_LANG,r.language)})),r.listen(e,e.Event.UI.USER_SELECTED_CAPTION_TRACK,(function(e){var r=e.payload.captionTrack;"off"!==r.language?(t.setItem(t.StorageKeys.TEXT_LANG,r.language),t.setItem(t.StorageKeys.CAPTIONS_DISPLAY,!0)):t.setItem(t.StorageKeys.CAPTIONS_DISPLAY,!1)}));var n=function(){r.listenOnce(e,e.Event.Core.TEXT_TRACK_CHANGED,(function(e){var r=e.payload.selectedTextTrack;"off"!==r.language?(t.setItem(t.StorageKeys.TEXT_LANG,r.language),t.setItem(t.StorageKeys.CAPTIONS_DISPLAY,!0)):t.setItem(t.StorageKeys.CAPTIONS_DISPLAY,!1)}))};r.listen(e,e.Event.UI.USER_SHOWED_CAPTIONS,n),r.listen(e,e.Event.UI.USER_HID_CAPTIONS,n),r.listen(e,e.Event.UI.USER_SELECTED_CAPTIONS_STYLE,(function(e){try{var r=JSON.stringify(e.payload.captionsStyle);t.setItem(t.StorageKeys.TEXT_STYLE,r)}catch(e){t._logger.error(e.message)}})),r.listen(e,e.Event.Core.PLAYER_DESTROY,(function(){return r.destroy()}))}},{key:"getPlayerTextStyle",value:function(){return this.getItem(this.StorageKeys.TEXT_STYLE)}}],(n=null)&&Xe(r.prototype,n),a&&Xe(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}(qe);function nt(e){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nt(e)}function at(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function it(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,st(n.key),n)}}function ot(e,t,r){return t&&it(e.prototype,t),r&&it(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function st(e){var t=function(e,t){if("object"!=nt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==nt(t)?t:String(t)}!function(e,t,r){(t=tt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(rt,"StorageKeys",{MUTED:"muted",VOLUME:"volume",AUDIO_LANG:"audioLanguage",TEXT_LANG:"textLanguage",CAPTIONS_DISPLAY:"captionsDisplay",TEXT_STYLE:"textStyle"});var lt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};at(this,e),t.observedThresholds=t.observedThresholds||pt,t.playerThreshold="number"==typeof t.playerThreshold?t.playerThreshold:ht,this._config=t,this._eventManager=new f.EventManager,this._targetsObserved=new f.Utils.MultiMap;var r={threshold:t.observedThresholds.map((function(e){return e/100}))};this._observer=new window.IntersectionObserver(this._intersectionChangedHandler.bind(this),r),this._initTabVisibility()}return ot(e,[{key:"_intersectionChangedHandler",value:function(e){var t=this;e.forEach((function(e){t._targetsObserved.get(e.target).forEach((function(t){var r=e.intersectionRatio>=t.threshold;t.lastIntersectionRatio=e.intersectionRatio,r!==t.lastVisible&&(t.lastVisible=r,t.listener(r,ut.VIEWPORT))}))}))}},{key:"_handleTabVisibilityChange",value:function(){var e=this;this._isTabVisible=!document[this._visibilityTabHiddenAttr],this._targetsObserved.getAll().forEach((function(t){t.lastVisible&&t.listener(e._isTabVisible,ut.TAB)}))}},{key:"_initTabVisibility",value:function(){void 0!==document.hidden&&(this._visibilityTabHiddenAttr="hidden",this._visibilityTabChangeEventName="visibilitychange"),this._visibilityTabHiddenAttr&&this._visibilityTabChangeEventName&&(this._eventManager.listen(document,this._visibilityTabChangeEventName,this._handleTabVisibilityChange.bind(this)),this._isTabVisible=!document[this._visibilityTabHiddenAttr])}},{key:"observe",value:function(e,t,r){if(this._observer){var n="number"==typeof r?r:this._config.playerThreshold,a=new ct(n/100,t);if(this._targetsObserved.has(e)){var i=this._targetsObserved.get(e)[0].lastIntersectionRatio;void 0!==i&&(a.lastIntersectionRatio=i,a.listener(this._isTabVisible&&i>=a.threshold,ut.VIEWPORT))}else this._observer.observe(e);this._targetsObserved.push(e,a)}}},{key:"unObserve",value:function(e,t){this._observer&&(this._targetsObserved.remove(e,t),this._targetsObserved.has(e)||this._observer.unobserve(e))}},{key:"destroy",value:function(){this._observer&&(this._eventManager.destroy(),this._observer.disconnect(),this._targetsObserved.clear())}}]),e}(),ut={VIEWPORT:"viewport",TAB:"tab"},ct=ot((function e(t,r){at(this,e),this.threshold=t,this.listener=r})),dt="visibilitychange",pt=[0,10,20,30,40,50,60,70,80,90,100],ht=50;function ft(e){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ft(e)}function mt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kt(n.key),n)}}function gt(e,t,r){return t=vt(t),function(e,t){if(t&&("object"===ft(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,yt()?Reflect.construct(t,r||[],vt(e).constructor):t.apply(e,r))}function yt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(yt=function(){return!!e})()}function vt(e){return vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vt(e)}function _t(e,t){return _t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_t(e,t)}function kt(e){var t=function(e,t){if("object"!=ft(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ft(t)?t:String(t)}var Et=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),gt(this,t,arguments)}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_t(e,t)}(t,e),r=t,a=[{key:"initialize",value:function(){this.init(this.name)}},{key:"getStorageObject",value:function(){return sessionStorage}},{key:"attach",value:function(e){var t=this;this._logger.debug("Attach session storage"),(new f.EventManager).listen(e,e.Event.UI.USER_SELECTED_SPEED,(function(){e.isCasting()||t.setItem(t.StorageKeys.PLAYBACK_RATE,e.playbackRate)}))}}],(n=null)&&mt(r.prototype,n),a&&mt(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}(qe);function bt(e){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bt(e)}function Tt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,At(n.key),n)}}function At(e){var t=function(e,t){if("object"!=bt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=bt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bt(t)?t:String(t)}!function(e,t,r){(t=kt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Et,"StorageKeys",{PLAYBACK_RATE:"playbackRate"});var St=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"init",value:function(){e._value="".concat(f.Utils.Generator.guid(),":").concat(f.Utils.Generator.guid())}},{key:"next",value:function(){if(!e._value)return this.init(),e._value;var t=e._value,r=/:((?:[a-z0-9]|-)*)/i.exec(t);return r&&r[1]&&(e._value=t.replace(r[1],f.Utils.Generator.guid())),t}}],(r=null)&&Tt(t.prototype,r),n&&Tt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e,t,r){(t=At(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(St,"_value","");var xt=[],wt="kaltura-player-container",It="debugKalturaPlayer",Mt="kalturaStartTime",Rt="kalturaSeekFrom",Dt="kalturaClipTo",Ot=2504201,Lt="https://analytics.kaltura.com/api_v3/index.php?service=analytics&action=trackEvent&apiVersion=3.3.0&format=1&eventType=1&partnerId=".concat(Ot,"&entryId=1_3bwzbc9o&&eventIndex=1&position=0");function Nt(e){if(!e)throw new Error(De.INITIAL_CONFIG_REQUIRED);!function(e){if(!e)throw new Error(De.TARGET_ID_REQUIRED);var t=document.getElementById(e);if(!t)throw new Error(De.DOM_ELEMENT_WITH_TARGET_ID_REQUIRED+e);if(t.getElementsByClassName(wt).length>0)throw new Error(De.TARGET_ID_ALREADY_USED+e)}(e.targetId)}function Ut(e){f.Utils.Object.getPropertyPath(e,"ui.log")||f.Utils.Object.createPropertyPath(e,"ui.log",{}),f.Utils.Object.getPropertyPath(e,"provider.log")||f.Utils.Object.createPropertyPath(e,"provider.log",{}),f.Utils.Object.getPropertyPath(e,"log")||f.Utils.Object.createPropertyPath(e,"log",{}),e.log&&"function"==typeof e.log.handler&&((0,f.setLogHandler)(e.log.handler),e.ui.log.handler=e.provider.log.handler=e.log.handler);var t=f.LogLevel.ERROR;!e.log||!0!==window.DEBUG_KALTURA_PLAYER&&""!==jt(It)?e.log&&e.log.level&&f.LogLevel[e.log.level]&&(t=f.LogLevel[e.log.level]):(t=f.LogLevel.DEBUG,e.log.level=f.LogLevel.DEBUG.name),e.ui.log.level=e.provider.log.level=t.name,(0,f.setLogLevel)(t)}function jt(e){var t;window.URLSearchParams?t=new URLSearchParams(window.location.search).get(e):t=function(e){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search),r=location.search.indexOf(e)>-1;return null===t?r?"":null:decodeURIComponent(t[1].replace(/\+/g," "))}(e);return t}function Bt(){return window.__kalturaplayerdata||{}}function Ft(e){var t=function(e){var t=document.createElement("div");t.id=f.Utils.Generator.uniqueId(5),t.className=wt,t.setAttribute("tabindex","-1");var r=document.getElementById(e);return r&&t&&r.appendChild(t),t.id}(e.targetId),r={targetId:e.targetId,provider:{partnerId:e.provider.partnerId},ui:{targetId:t},plugins:{},advertising:{adBreaks:[]},viewability:{observedThresholds:pt,playerThreshold:ht}};if(f.Utils.Object.mergeDeep(r,e),!e.provider.ignoreServerConfig){var n=f.Utils.Object.copyDeep(Bt());delete n.productVersion,r=f.Utils.Object.mergeDeep({},Vt(n),r)}return function(e){if(f.Env.isMacOS&&f.Env.isSafari||f.Env.isIOS){"boolean"!=typeof f.Utils.Object.getPropertyPath(e,"playback.preferNative.hls")&&f.Utils.Object.mergeDeep(e,{playback:{preferNative:{hls:!0}}})}}(r),function(e){if(f.Env.isMacOS&&f.Env.isSafari||f.Env.isIOS){"boolean"!=typeof f.Utils.Object.getPropertyPath(e,"text.useNativeTextTrack")&&f.Utils.Object.mergeDeep(e,{text:{useNativeTextTrack:!0}})}}(r),function(e){f.Utils.Object.getPropertyPath(e,"plugins.kava")}(r),function(e){if(f.Env.isSmartTV){if((0,f.setCapabilities)(f.EngineType.HTML5,{autoplay:!0}),function(e){var t=f.Utils.Object.getPropertyPath(e,"playback.playAdsWithMSE");"boolean"!=typeof t&&(e=f.Utils.Object.createPropertyPath(e,"playback.playAdsWithMSE",!0));var r=f.Utils.Object.getPropertyPath(e,"plugins.ima.disableMediaPreload"),n=f.Utils.Object.getPropertyPath(e,"plugins.bumper.disableMediaPreload");e.plugins&&e.plugins.ima&&"boolean"!=typeof r&&(e=f.Utils.Object.createPropertyPath(e,"plugins.ima.disableMediaPreload",!0));e.plugins&&e.plugins.bumper&&"boolean"!=typeof n&&(e=f.Utils.Object.createPropertyPath(e,"plugins.bumper.disableMediaPreload",!0))}(e),function(e){var t=f.Utils.Object.getPropertyPath(e,"playback.options.html5.hls.liveSyncDurationCount");"boolean"!=typeof t&&f.Env.isSafari&&(e=f.Utils.Object.createPropertyPath(e,"playback.options.html5.hls.liveSyncDurationCount",2))}(e),e.plugins&&e.plugins.ima){var t=f.Utils.Object.getPropertyPath(e,"plugins.ima.forceReloadMediaAfterAds"),r=f.Utils.Object.getPropertyPath(e,"plugins.ima.delayInitUntilSourceSelected");"boolean"!=typeof t&&(e=f.Utils.Object.createPropertyPath(e,"plugins.ima.forceReloadMediaAfterAds",!0)),"boolean"!=typeof r&&(e=f.Utils.Object.createPropertyPath(e,"plugins.ima.delayInitUntilSourceSelected",!0))}if(e.plugins&&e.plugins.youbora)"number"!=typeof f.Utils.Object.getPropertyPath(e,"plugins.youbora.playheadMonitorInterval")&&(e=f.Utils.Object.createPropertyPath(e,"plugins.youbora.playheadMonitorInterval",2e3));"boolean"!=typeof f.Utils.Object.getPropertyPath(e,"streaming.lowLatencyMode")&&(e=f.Utils.Object.createPropertyPath(e,"streaming.lowLatencyMode",!1))}}(r),function(e){if("Edge"===f.Env.browser.name){f.Utils.Object.getPropertyPath(e,"drm.keySystem")||(e="Windows"===f.Env.os.name?f.Utils.Object.createPropertyPath(e,"drm.keySystem",f.DrmScheme.PLAYREADY):f.Utils.Object.createPropertyPath(e,"drm.keySystem",f.DrmScheme.WIDEVINE))}}(r),function(e){if(f.Env.isIOS&&e.plugins&&e.plugins.ima&&!e.plugins.ima.disable){var t=f.Utils.Object.getPropertyPath(e,"playback.playsinline"),r=f.Utils.Object.getPropertyPath(e,"plugins.ima.disableMediaPreload");!1===t&&"boolean"!=typeof r&&f.Utils.Object.createPropertyPath(e,"plugins.ima.disableMediaPreload",!0)}}(r),function(e){if(e.plugins&&e.plugins.imadai&&!e.plugins.imadai.disable){"boolean"!=typeof f.Utils.Object.getPropertyPath(e,"playback.options.html5.hls.autoStartLoad")&&f.Utils.Object.mergeDeep(e,{playback:{options:{html5:{hls:{autoStartLoad:!1}}}}})}}(r),function(e){var t=f.Utils.Object.getPropertyPath(e,"plugins.bumper"),r=f.Utils.Object.getPropertyPath(e,"plugins.imadai");if(t){var n={};"boolean"!=typeof t.playOnMainVideoTag&&(f.Env.isSmartTV||f.Env.isIOS&&e.playback&&!1===e.playback.playsinline)&&(n.playOnMainVideoTag=!0),r&&!r.disable&&(Array.isArray(t.position)||(n.position=[0]),"boolean"!=typeof t.disableMediaPreload&&(n.disableMediaPreload=!0)),f.Utils.Object.mergeDeep(e,{plugins:{bumper:n}})}}(r),function(e){var t=f.Utils.Object.getPropertyPath(e,"plugins.vr");if(t&&!t.disable){"boolean"!=typeof f.Utils.Object.getPropertyPath(e,"playback.inBrowserFullscreen")&&f.Utils.Object.mergeDeep(e,{playback:{inBrowserFullscreen:!0}})}}(r),function(e){if(f.Env.isIOS){var t=!1!==f.Utils.Object.getPropertyPath(e,"playback.playsinline");f.Utils.Object.hasPropertyPath(e,"plugins.airplay")?(0,f.setCapabilities)(f.EngineType.HTML5,{autoplay:!1,mutedAutoPlay:t}):"iPhone"!==f.Env.device.model||t||(0,f.setCapabilities)(f.EngineType.HTML5,{autoplay:!1,mutedAutoPlay:!1})}}(r),r}function Vt(e){return function(){if(e.player){xt.push({level:"warn",msg:"Path config.player will be deprecated soon. Please update your config structure as describe here: ".concat("https://github.com/kaltura/kaltura-player-js/blob/master/docs/configuration.md")});var t=f.Utils.Object.copyDeep(e.player);delete e.player,f.Utils.Object.mergeDeep(e,t)}}(),[["duration","sources.duration"],["type","sources.type"],["dvr","sources.dvr"],["id","sources.id"],["name","metadata.name"],["metadata.poster","sources.poster"],["metadata","sources.metadata"],["logLevel","log.level"],["ui.components.fullscreen.inBrowserFullscreenForIOS","playback.inBrowserFullscreen"],["playback.enableCEA708Captions","text.enableCEA708Captions"],["playback.useNativeTextTrack","text.useNativeTextTrack"],["playback.options.html5.dash.useShakaTextTrackDisplay","text.useShakaTextTrackDisplay"],["playback.captionsTextTrack1Label","text.captionsTextTrack1Label"],["playback.captionsTextTrack1LanguageCode","text.captionsTextTrack1LanguageCode"],["playback.captionsTextTrack2Label","text.captionsTextTrack2Label"],["playback.captionsTextTrack2LanguageCode","text.captionsTextTrack2LanguageCode"],["plugins.visibility.threshold","viewability.playerThreshold"],["plugins.visibility.floating","plugins.floating"],["playback.startTime","sources.startTime"]].forEach((function(t){return function(t,r){if(f.Utils.Object.hasPropertyPath(e,t))if(xt.push({level:"warn",msg:"Path config.player.".concat(t," will be deprecated soon. Please update your config structure as describe here: ").concat("https://github.com/kaltura/kaltura-player-js/blob/master/docs/configuration.md")}),f.Utils.Object.hasPropertyPath(e,r))f.Utils.Object.deletePropertyPath(e,t);else{var n=f.Utils.Object.getPropertyPath(e,t),a=f.Utils.Object.createPropertyPath({},r,n);f.Utils.Object.mergeDeep(e,a),f.Utils.Object.deletePropertyPath(e,t)}}(t[0],t[1])})),e}function Ht(e,t,r){var n=e.config.playback,a=!1;return n.streamPriority.forEach((function(e){e.engine===t&&(a=!0)})),a||n.streamPriority.push({engine:t,format:r}),n}function Gt(e){var t=e&&e.progressive;return!(!t||!t[0]||"video/youtube"!==t[0].mimetype)}function $t(e){var t=e&&e.image;return!(!t||!t[0])}function Kt(e){var t=e&&e.document;return!(!t||!t[0])}function Wt(e,t){var r={},n={};return f.Utils.Object.isObject(e)&&Object.entries(e).forEach((function(e){var a=Ct(e,2),i=a[0],o=a[1];r[i]={},n[i]={},Object.entries(o).forEach((function(e){var a=Ct(e,2),o=a[0],s=a[1],l=f.Utils.Object.getPropertyPath(t[i],o);r[i][o]=l||s,n[i][o]=l}))})),[r,n]}var zt="playSessionId=",qt="referrer=",Yt="uiConfId=",Xt="clientTag=html5:v",Zt="kaltura.com",Qt="custom_data=",Jt="signature=",er="seekFrom=",tr="clipTo=";function rr(e,t){var r,n,a;e.config.session&&e.config.session.id?function(e,t){var r,n,a=null===(r=t.sources)||void 0===r?void 0:r.id;if(null!=e&&null!==(n=e.playlist)&&void 0!==n&&null!==(n=n.items)&&void 0!==n&&n.length){if(a){var i;if(null!==(i=e.sessionIdCache)&&void 0!==i&&i.get(a)){var o;nr(t,null===(o=e.sessionIdCache)||void 0===o?void 0:o.get(a))}else{var s,l=St.next();null===(s=e.sessionIdCache)||void 0===s||s.set(a,l),nr(t,l)}}}else nr(t,St.next())}(e,t):(function(e){nr(e,St.next())}(t),null!=e&&null!==(r=e.playlist)&&void 0!==r&&null!==(r=r.items)&&void 0!==r&&r.length&&null!==(n=t.sources)&&void 0!==n&&n.id&&(null===(a=e.sessionIdCache)||void 0===a||a.set(t.sources.id,t.session.id)))}function nr(e,t){e.session=e.session||{},e.session.id=t}function ar(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zt;if(r){var a,i=new RegExp(n+"((?:[a-z0-9]|-)*:(?:[a-z0-9]|-)*)","i").exec(t);if(i&&i[1])null!=e&&null!==(a=e.playlist)&&void 0!==a&&null!==(a=a.items)&&void 0!==a&&a.length||(t=t.replace(i[1],r));else t+=sr(t)+n+r}return t}function ir(){var e;try{e=window.parent.document.URL}catch(t){e=window.originalRequestReferrer||document.referrer}return e}function or(e){if(-1===e.indexOf(qt)){var t=btoa(ir().substr(0,1e3));e+=sr(e)+qt+t}return e}function sr(e){return-1===e.indexOf("?")?"?":"&"}function lr(e,t){return-1===e.indexOf(Xt)&&(e+=sr(e)+Xt+(t||"3.17.21")),e}function ur(e,t){var r=f.Utils.Object.getPropertyPath(t,"seekFrom"),n=f.Utils.Object.getPropertyPath(t,"clipTo");return"number"==typeof r&&-1===e.indexOf(er)&&(e+=sr(e)+er+1e3*r),"number"==typeof n&&-1===e.indexOf(tr)&&(e+=sr(e)+tr+1e3*n),e}function cr(e,t){var r;rr(e,t);var n=t.sources,a=t.session&&t.session.id,i=null===(r=Bt())||void 0===r?void 0:r.productVersion;Object.values(f.StreamType).forEach((function(r){n[r]&&n[r].forEach((function(r){"string"==typeof r.url&&r.url.toLowerCase().indexOf("playmanifest/")>-1&&!r.localSource&&(r.url=ar(e,r.url,a),r.url=or(r.url),r.url=lr(r.url,i),r.url=ur(r.url,n)),r.drmData&&r.drmData.length&&r.drmData.forEach((function(r){"string"==typeof r.licenseUrl&&[Zt,Qt,Jt].every((function(e){return r.licenseUrl.includes(e)}))&&(r.licenseUrl=ar(e,r.licenseUrl,a,"sessionId="),r.licenseUrl=lr(r.licenseUrl,i),r.licenseUrl=or(r.licenseUrl),r.licenseUrl=function(e,t){var r=f.Utils.Object.getPropertyPath(t,"provider.uiConfId");return-1===e.indexOf(Yt)&&"number"==typeof r&&(e+=sr(e)+Yt+r),e}(r.licenseUrl,t))}))}))}))}function dr(e){return dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dr(e)}function pr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hr(n.key),n)}}function hr(e){var t=function(e,t){if("object"!=dr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=dr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==dr(t)?t:String(t)}function fr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var gr=(0,f.getLogger)("PluginsConfig"),yr=function(e){return("number"==typeof e||"function"==typeof e||"string"==typeof e||"boolean"==typeof e||f.Utils.Object.isClassInstance(e))&&!ve.test(e.toString())},vr=function(e){return f.Utils.Object.isObject(e)&&"function"!=typeof e&&!f.Utils.Object.isClassInstance(e)},_r=function(e){return e.map((function(e){if(vr(e)){var t=kr(e);return f.Utils.Object.isEmptyObject(t)?null:t}return yr(e)?e:null})).filter((function(e){return null!==e}))},kr=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(t).reduce((function(t,r){var n=fr(r,2),a=n[0],i=n[1];return vr(i)?t[a]=e(i):Array.isArray(i)?t[a]=_r(i):yr(i)&&(t[a]=i),t}),{})};var Er=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._pluginConfigStore=new we}var t,r,n;return t=e,r=[{key:"evaluatePluginsConfig",value:function(e,t){if(e){this._pluginConfigStore.set(e);var r=function(e){var t,r={pVersion:(null===(t=Bt())||void 0===t?void 0:t.productVersion)||"3.17.21",pName:"@playkit-js/kaltura-player-js"};if(e.targetId&&(r.domRootElementId=e.targetId),e.provider&&e.provider.env){r.serviceUrl=e.provider.env.serviceUrl;var n=f.Utils.Object.getPropertyPath(e,"provider.env.analyticsServiceUrl");n&&(r.analyticsServiceUrl="".concat(n,"/api_v3/index.php")),r.serviceUrl&&(r.embedBaseUrl=r.serviceUrl.replace("api_v3",""))}var a,i={referrer:ir(),encodedReferrer:(a=ir(),encodeURIComponent(a))};e.provider&&f.Utils.Object.mergeDeep(i,{ks:e.provider.ks,uiConfId:e.provider.uiConfId,partnerId:e.provider.partnerId}),e.session&&f.Utils.Object.mergeDeep(i,{sessionId:e.session.id,ks:e.session.ks,isAnonymous:e.session.isAnonymous,uiConfId:e.session.uiConfId,partnerId:e.session.partnerId}),e.sources&&f.Utils.Object.mergeDeep(i,{entryId:e.sources.id,entryName:e.sources.metadata&&e.sources.metadata.name,entryType:e.sources.type}),e.playlist&&f.Utils.Object.mergeDeep(i,{playlistId:e.playlist.id}),Object.keys(i).forEach((function(e){void 0===i[e]&&delete i[e]})),f.Utils.Object.mergeDeep(r,i);var o=e.uiConfData;return o&&(r.embedWidth=o.width,r.embedHeight=o.height),r}(t),n=f.Utils.Object.mergeDeep({},this._pluginConfigStore.get(),e),a=function(e){var t,r;e=(r=e)?r.replace(/\\n/g,"\\n").replace(/\\'/g,"\\'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f").replace(/[\u0000-\u0019]+/g,""):"";try{t=JSON.parse(e,(function(e){try{return JSON.parse(this[e])}catch(t){return this[e]}}))}catch(e){gr.error("An error occurred while formatting config string.",e),t={}}return t}(Ie(JSON.stringify(n),r));!function(e,t){var r=kr(t),n=kr(e);n&&r&&Object.keys(e).forEach((function(t){e&&e[t]&&(e[t]=f.Utils.Object.mergeDeep({},r[t],n[t]))}))}(e,a)}}}],r&&pr(t.prototype,r),n&&pr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function br(e){return br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},br(e)}function Tr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ir(n.key),n)}}function Ar(e,t,r){return t=Cr(t),function(e,t){if(t&&("object"===br(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Pr(e)}(e,Sr()?Reflect.construct(t,r||[],Cr(e).constructor):t.apply(e,r))}function Sr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Sr=function(){return!!e})()}function Cr(e){return Cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Cr(e)}function Pr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xr(e,t){return xr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xr(e,t)}function wr(e,t,r){return(t=Ir(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ir(e){var t=function(e,t){if("object"!=br(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=br(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==br(t)?t:String(t)}var Mr=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),wr(Pr(r=Ar(this,t)),"id","PluginReadinessMiddleware"),r._plugins=e,t._logger.debug("plugins readiness",r._plugins),r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xr(e,t)}(t,e),r=t,(n=[{key:"load",value:function(e){this._checkNextSettle(0,e)}},{key:"_checkNextSettle",value:function(e,t){e<this._plugins.length?this._checkSettle(e,t):this.callNext(t)}},{key:"_checkSettle",value:function(e,r){var n=this;(this._plugins[e].ready?this._plugins[e].ready:Promise.resolve()).then((function(){t._logger.debug("plugin ".concat(n._plugins[e].name," ready promise resolved")),n._checkNextSettle(e+1,r)})).catch((function(){t._logger.debug("plugin ".concat(n._plugins[e].name," ready promise rejected")),n._checkNextSettle(e+1,r)}))}},{key:"play",value:function(e){this._checkNextSettle(0,e)}}])&&Tr(r.prototype,n),a&&Tr(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}(f.BaseMiddleware);function Rr(e){return Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rr(e)}function Dr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Or(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dr(Object(r),!0).forEach((function(t){Nr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Lr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ur(n.key),n)}}function Nr(e,t,r){return(t=Ur(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ur(e){var t=function(e,t){if("object"!=Rr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Rr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Rr(t)?t:String(t)}wr(Mr,"_logger",(0,f.getLogger)("PluginReadinessMiddleware"));var jr={thumbsWidth:164,thumbsHeight:92,thumbsSlices:100},Br=/.*\/p\/\d+\/(?:[a-zA-Z]+\/\d+\/)*thumbnail\/entry_id\/\w+\/.*\d+/,Fr=function(){function e(t,r,n){var a=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Nr(this,"_isUsingKalturaThumbnail",(function(){return!(!a._thumbnailConfig||!a._thumbnailConfig.thumbsSprite)})),Nr(this,"_convertKalturaThumbnailToThumbnailInfo",(function(e){if(a._thumbnailConfig){var t=a._thumbnailConfig,r=t.thumbsSprite,n=t.thumbsWidth,i=t.thumbsSlices,o=a._player.duration/i,s={x:Math.floor(e/o)*n,y:0,url:r,height:a._thumbsHeight,width:n};return new f.ThumbnailInfo(s)}return null})),Nr(this,"_buildKalturaThumbnailConfig",(function(e,t){var r,n=f.Utils.Object.getPropertyPath(e,"components.seekbar"),i=t.sources&&t.sources.poster,o=t.sources&&t.sources.type===f.MediaType.VOD,s=a._player.shouldAddKs(t)?null===(r=t.session)||void 0===r?void 0:r.ks:"",l=f.Utils.Object.mergeDeep(jr,n);return Or({thumbsSprite:o?a._getThumbSlicesUrl(i,s,l):""},l)})),Nr(this,"_maybeCutThumbnail",(function(e){var t=f.Utils.Object.getPropertyPath(a._player.config.sources,"seekFrom"),r=f.Utils.Object.getPropertyPath(a._player.config.sources,"clipTo"),n=e;return"number"==typeof t&&(n+="/start_sec/".concat(t)),"number"==typeof r&&(n+="/end_sec/".concat(r)),n})),Nr(this,"_getThumbSlicesUrl",(function(e,t,r){if("string"==typeof e&&Br.test(e))try{var n=Or({thumbnailUrl:e},r),i=Ie("{{thumbnailUrl}}/width/{{thumbsWidth}}/vid_slices/{{thumbsSlices}}",n),o=a._maybeCutThumbnail(i);return t?o+"/ks/".concat(t):o}catch(e){return""}return""})),this._player=t,this._thumbnailConfig=this._buildKalturaThumbnailConfig(r,n),this._eventManager=new f.EventManager,this._isUsingKalturaThumbnail()){var i,o=new Image;this._eventManager.listenOnce(o,"load",(function(){a._thumbsHeight=o.naturalHeight})),o.src=(null===(i=this._thumbnailConfig)||void 0===i?void 0:i.thumbsSprite)||""}}var t,r,n;return t=e,(r=[{key:"destroy",value:function(){this._eventManager.destroy()}},{key:"getThumbnail",value:function(e){return this._isUsingKalturaThumbnail()?this._convertKalturaThumbnailToThumbnailInfo(e):this._player._localPlayer.getThumbnail(e)}},{key:"getKalturaThumbnailConfig",value:function(){return this._thumbnailConfig}}])&&Lr(t.prototype,r),n&&Lr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Vr(e){return Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vr(e)}function Hr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gr(n.key),n)}}function Gr(e){var t=function(e,t){if("object"!=Vr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Vr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Vr(t)?t:String(t)}var $r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t}var t,r,n;return t=e,(r=[{key:"_addTextTrack",value:function(){this._textTrack=this._player.addTextTrack(f.PKTextTrack.KIND.METADATA,"CuePoints")}},{key:"_getMetadataTracks",value:function(){return this._player.getNativeTextTracks().filter((function(e){return e.kind===f.PKTextTrack.KIND.METADATA&&e.cues}))}},{key:"_createTextTrackCue",value:function(e){var t=e.startTime,r=e.endTime,n=e.id,a=e.metadata;return(0,f.createTextTrackCue)({startTime:t,endTime:r,id:n,type:f.TimedMetadata.TYPE.CUE_POINT,metadata:a})}},{key:"_cuesSorter",value:function(e,t){return e.startTime-t.startTime}},{key:"getAllCuePoints",value:function(){return this._getMetadataTracks().reduce((function(e,t){return e.concat(Array.from(t.cues).map((function(e){return(0,f.createTimedMetadata)(e)})))}),[]).sort(this._cuesSorter)}},{key:"getActiveCuePoints",value:function(){return this._getMetadataTracks().reduce((function(e,t){return e.concat(Array.from(t.activeCues).map((function(e){return(0,f.createTimedMetadata)(e)})))}),[]).sort(this._cuesSorter)}},{key:"_getTextTrackCueById",value:function(e){var t=null;return this._getMetadataTracks().some((function(r){return t=r.cues.getCueById(e)})),t}},{key:"_removeTextTrackCue",value:function(e){try{var t;null===(t=e.track)||void 0===t||t.removeCue(e)}catch(e){}}},{key:"addCuePoints",value:function(e){var t=this;this._player.ready().then((function(){t._textTrack||t._addTextTrack();var r=[];e.forEach((function(e){var n,a=t._createTextTrackCue(e),i=t._getTextTrackCueById(e.id);i&&t._removeTextTrackCue(i),null===(n=t._textTrack)||void 0===n||n.addCue(a),r.push((0,f.createTimedMetadata)(a))})),t._player.dispatchEvent(new f.FakeEvent(f.EventType.TIMED_METADATA_ADDED,{cues:r}))}))}},{key:"_clearAllTextTrackCues",value:function(){var e=this;this._getMetadataTracks().forEach((function(t){for(;t.cues.length;)e._removeTextTrackCue(t.cues[0])}))}},{key:"reset",value:function(){this._clearAllTextTrackCues()}},{key:"destroy",value:function(){this.reset()}}])&&Hr(t.prototype,r),n&&Hr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Kr(e){return Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kr(e)}function Wr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zr(n.key),n)}}function zr(e){var t=function(e,t){if("object"!=Kr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Kr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Kr(t)?t:String(t)}var qr=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,r){(t=zr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"_servicesRegistry",new Map),e._logger=(0,f.getLogger)("ServiceProvider"),this._eventManager=new f.EventManager,this._eventManager.listen(t,t.Event.Core.PLAYER_RESET,(function(){return r.reset()}))}var t,r,n;return t=e,(r=[{key:"register",value:function(t,r){this._servicesRegistry.has(t)?e._logger.debug("".concat(t," service already exists")):(this._servicesRegistry.set(t,r),e._logger.debug("".concat(t," service registered")))}},{key:"get",value:function(e){return this._servicesRegistry.get(e)}},{key:"has",value:function(e){return this._servicesRegistry.has(e)}},{key:"reset",value:function(){this._servicesRegistry.forEach((function(e){return"function"==typeof e.reset&&e.reset()}))}},{key:"destroy",value:function(){this._servicesRegistry.forEach((function(e){return"function"==typeof e.destroy&&e.destroy()})),this._eventManager.removeAll(),this._servicesRegistry.clear()}}])&&Wr(t.prototype,r),n&&Wr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Yr="kaltura-player",Xr={PLAYLIST_LOADED:"".concat(Yr,"-playlistloaded"),PLAYLIST_ITEM_CHANGED:"".concat(Yr,"-playlistitemchanged"),PLAYLIST_ENDED:"".concat(Yr,"-playlistended")};function Zr(e){return Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zr(e)}function Qr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jr(n.key),n)}}function Jr(e){var t=function(e,t){if("object"!=Zr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Zr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Zr(t)?t:String(t)}var en=["hls","dash","progressive","image","document"],tn=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._sources=t,this._config=r,this._index=n}var t,r,n;return t=e,(r=[{key:"updateSources",value:function(e){this._sources=f.Utils.Object.mergeDeep({},e)}},{key:"updatePlugins",value:function(e){this._plugins=f.Utils.Object.copyDeep(e)}},{key:"sources",get:function(){var e=this;return en.forEach((function(t){e._sources&&e._sources[t]&&0===e._sources[t].length&&delete e._sources[t]})),this._sources}},{key:"config",get:function(){return this._config}},{key:"plugins",get:function(){return this._plugins||{}}},{key:"index",get:function(){return this._index}},{key:"isPlayable",value:function(){var e=this;return!!en.find((function(t){return e._sources&&e._sources[t]&&e._sources[t].length}))}}])&&Qr(t.prototype,r),n&&Qr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function rn(e){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rn(e)}function nn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,an(n.key),n)}}function an(e){var t=function(e,t){if("object"!=rn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=rn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==rn(t)?t:String(t)}var on=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id="",this._metadata={name:"",description:""},this._poster="",this._items=[],this._activeItemIndex=-1}var t,r,n;return t=e,(r=[{key:"configure",value:function(e,t){var r=this;this._id=e.id?e.id:this._id,this._poster=e.poster?e.poster:this._poster,this._metadata=e.metadata?e.metadata:this._metadata,e.items&&(this._items=[],e.items.forEach((function(e,n){if(e.sources){var a=f.Utils.Object.mergeDeep({},t),i=e.sources.options||{};e.sources.options=f.Utils.Object.mergeDeep(a,i)}r._items.push(new tn(e.sources,e.config,n))})))}},{key:"updateItemSources",value:function(e,t){this._items[e].updateSources(t)}},{key:"updateItemPlugins",value:function(e,t){this._items[e].updatePlugins(t)}},{key:"id",get:function(){return this._id}},{key:"items",get:function(){return this._items}},{key:"metadata",get:function(){return this._metadata}},{key:"poster",get:function(){return this._poster}},{key:"current",get:function(){return this._items[this._activeItemIndex]||null}},{key:"getNext",value:function(e){var t=e?(this._activeItemIndex+1)%this._items.length:this._activeItemIndex+1;return this._items[t]||null}},{key:"prev",get:function(){return this._items[this._activeItemIndex-1]||null}},{key:"activeItemIndex",set:function(e){this._activeItemIndex=e}}])&&nn(t.prototype,r),n&&nn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function sn(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ln(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ln(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function ln(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function un(e){return un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},un(e)}function cn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dn(n.key),n)}}function dn(e){var t=function(e,t){if("object"!=un(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=un(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==un(t)?t:String(t)}var pn=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._player=t,this._eventManager=new f.EventManager,this._playlist=new on,this._options={autoContinue:!0,loop:!1,imageDuration:5,documentDuration:10},this._countdown={duration:10,showing:!0},this._mediaInfoList=[],this._playerOptions=r,this._appPluginConfig={}}var t,r,n;return t=e,(r=[{key:"configure",value:function(e,t){if(e&&(this._playlist.configure(e,f.Utils.Object.getPropertyPath(this._player.sources,"options")),f.Utils.Object.mergeDeep(this._options,e.options),f.Utils.Object.mergeDeep(this._countdown,e.countdown),e.items&&e.items.find((function(e){return!!e.sources})))){var r;this._mediaInfoList=e.items.map((function(e,r){return t&&t.entries&&"object"===un(t.entries[r])?t.entries[r]:{entryId:e.sources.id}})),this._player.dispatchEvent(new f.FakeEvent(Xr.PLAYLIST_LOADED,{playlist:this})),this._addBindings();var n=null===(r=e.options)||void 0===r?void 0:r.startAtEntryId,a=!1;if(n&&"string"==typeof n){var i=this._playlist.items.find((function(e){return e.sources.id===n}));i&&(a=!0,this.playItem(i.index))}a||this.playNext()}}},{key:"load",value:function(e,t,r){var n=this._getMergedPlaylistData(e,t);this.configure(n,r)}},{key:"reset",value:function(){this._eventManager.removeAll(),this._playlist=new on,this._mediaInfoList=[]}},{key:"playNext",value:function(){e._logger.debug("playNext");var t=this._playlist.getNext(!0);t&&this._setItem(t)}},{key:"playPrev",value:function(){e._logger.debug("playPrev");var t=this._playlist.prev;t&&this._setItem(t)}},{key:"playItem",value:function(t){e._logger.debug("playItem(".concat(t,")"));var r=this._playlist.items[t];r&&this._setItem(r)}},{key:"items",get:function(){return this._playlist.items}},{key:"current",get:function(){return this._playlist.current}},{key:"next",get:function(){return this._playlist.getNext(this._options.loop)}},{key:"prev",get:function(){return this._playlist.prev}},{key:"id",get:function(){return this._playlist.id}},{key:"metadata",get:function(){return this._playlist.metadata}},{key:"poster",get:function(){return this._playlist.poster}},{key:"countdown",get:function(){if(this._playlist.current&&this._playlist.current.config){var e={duration:10,showing:!0};return f.Utils.Object.mergeDeep(e,this._countdown,this._playlist.current.config.countdown),e}return this._countdown}},{key:"options",get:function(){return this._options}},{key:"_getMergedPlaylistData",value:function(e,t){var r=this;return{id:e.id,metadata:e.metadata,poster:e.poster,options:t?t.options:this._options,countdown:t?t.countdown:this.countdown,items:e.items.map((function(e,n){var a,i=f.Utils.Object.copyDeep(e);return i.sources.mediaEntryType=null==e||null===(a=e.sources)||void 0===a?void 0:a.type,["sources.dvr","sources.type"].forEach((function(e){f.Utils.Object.deletePropertyPath(i,e)})),f.Utils.Object.mergeDeep(i.sources,t&&t.items&&t.items[n]&&t.items[n].sources),Array.isArray(i.sources.poster)&&r._player.updateKalturaPoster(i.sources,e.sources,r._player.dimensions),{sources:i.sources,config:t&&t.items&&t.items[n]&&t.items[n].config}}))}}},{key:"_addBindings",value:function(){var e=this;this._eventManager.listen(this._player,this._player.Event.Core.PLAYBACK_ENDED,(function(){return e._onPlaybackEnded()})),this._eventManager.listen(this._player,this._player.Event.Core.CHANGE_SOURCE_STARTED,(function(){return e._onChangeSourceStarted()}))}},{key:"_onPlaybackEnded",value:function(){var e=this._playlist.getNext(!1);e||this._player.dispatchEvent(new f.FakeEvent(Xr.PLAYLIST_ENDED)),!this._playerOptions.ui.disable&&this.countdown.showing||(e&&this._options.autoContinue||this._options.loop)&&this.playNext()}},{key:"_onChangeSourceStarted",value:function(){this._player.isImage()?this._player.configure({sources:{duration:this._options.imageDuration}}):this._player.isDocument()&&this._player.configure({sources:{duration:this._options.documentDuration}})}},{key:"_setItem",value:function(t){var r,n,a=this,i=t.index;e._logger.debug("Playing item number ".concat(i),t);var o,s={loop:!1};this._playlist.current&&(this._player._playbackStart?s.autoplay=!0:s.autoplay=!(null===(o=this._playerOptions.playback)||void 0===o||!o.autoplay)),this._player.configure({playback:s}),this._playlist.activeItemIndex=i;var l=[];if((null===(r=this._playlist.items[i-1])||void 0===r?void 0:r.sources.type)===f.MediaType.VOD&&l.push(this.prepareEntry(i-1)),(null===(n=this._playlist.items[i+1])||void 0===n?void 0:n.sources.type)===f.MediaType.VOD&&l.push(this.prepareEntry(i+1)),Promise.all(l).then((function(e){var t,r=[],n=sn(e);try{for(n.s();!(t=n.n()).done;){var i,o=t.value;null!==(i=o.sources.dash)&&void 0!==i&&i.length&&(r=r.concat(o.sources.dash.map((function(e){return e.url}))))}}catch(e){n.e(e)}finally{n.f()}a._player.setCachedUrls(r)})),t.isPlayable()){var u,c;this._resetProviderPluginsConfig();var d=Wt(t.plugins,this._player.config.plugins),p=d[0];this._appPluginConfig=d[1];var h={session:this._player.config.session,plugins:p,sources:t.sources};return this._player.setMedia(h),this._player.dispatchEvent(new f.FakeEvent(Xr.PLAYLIST_ITEM_CHANGED,{index:i,activeItem:t,entryId:(null===(u=this._mediaInfoList[i])||void 0===u?void 0:u.entryId)||(null===(c=t.sources)||void 0===c?void 0:c.id)})),Promise.resolve()}if(this._mediaInfoList[i]){this._resetProviderPluginsConfig();var m={sources:t.sources};return this._player.setMedia(m),this._player.loadMedia(this._mediaInfoList[i]).then((function(e){var r;a._playlist.updateItemSources(i,e.sources),a._playlist.updateItemPlugins(i,e.plugins);var n,o=null===(r=a._player.sessionIdCache)||void 0===r?void 0:r.get(e.sources.id);o||(o=St.next(),null===(n=a._player.sessionIdCache)||void 0===n||n.set(e.sources.id,o)),e.sources.dash=e.sources.dash.map((function(t){return t.url=ar(a._player,t.url,o),t.url=or(t.url),t.url=lr(t.url,e.productVersion),t.url=ur(t.url,e.sources),t})),a._player.dispatchEvent(new f.FakeEvent(Xr.PLAYLIST_ITEM_CHANGED,{index:i,activeItem:t,entryId:a._mediaInfoList[i].entryId}))}))}return Promise.reject()}},{key:"_resetProviderPluginsConfig",value:function(){this._player.configure({plugins:this._appPluginConfig}),this._appPluginConfig={}}},{key:"destroy",value:function(){this._eventManager.destroy()}},{key:"prepareEntry",value:function(e){var t=this;return this._playlist.items[e].isPlayable()?Promise.resolve({sources:this._playlist.items[e].sources}):this._player.provider.getMediaConfig(this._mediaInfoList[e]).then((function(r){var n,a=f.Utils.Object.copyDeep(r);t._playlist.updateItemSources(e,a.sources),t._playlist.updateItemPlugins(e,a.plugins);var i,o=null===(n=t._player.sessionIdCache)||void 0===n?void 0:n.get(a.sources.id);return o||(o=St.next(),null===(i=t._player.sessionIdCache)||void 0===i||i.set(a.sources.id,o)),a.sources.dash=a.sources.dash.map((function(e){return e.url=ar(t._player,e.url,o),e.url=or(e.url),e.url=lr(e.url,a.productVersion),e.url=ur(e.url,a.sources),e})),Promise.resolve(a)}))}}])&&cn(t.prototype,r),n&&cn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function hn(e){return hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hn(e)}function fn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gn(n.key),n)}}function mn(e,t,r){return t&&fn(e.prototype,t),r&&fn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gn(e){var t=function(e,t){if("object"!=hn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=hn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==hn(t)?t:String(t)}!function(e,t,r){(t=dn(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(pn,"_logger",(0,f.getLogger)("PlaylistManager"));var yn=mn((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.textStyle=t.textStyle,this.mediaInfo=t.getMediaInfo(),this.mediaConfig=t.getMediaConfig(),this.advertising=t.config.plugins&&t.config.plugins.ima,this.config=f.Utils.Object.mergeDeep({},t.config,{sources:{startTime:vn(t)},playback:{autoplay:0===t.currentTime||!t.paused,audioLanguage:_n(f.TrackType.AUDIO,t),textLanguage:_n(f.TrackType.TEXT,t)}})}));function vn(e){return e.isLive()?e.isDvr()?e.duration-e.currentTime<e.config.cast.dvrThreshold||!e.currentTime?-1:e.currentTime:-1:!e.isCasting()&&!e.currentTime&&e.config.sources.startTime>-1?e.config.sources.startTime:e.currentTime}function _n(e,t){var r=t.getActiveTracks();if(r[e])return r[e].language;try{return t.config.playback["".concat(e,"Language")]}catch(e){return null}}var kn="kaltura-player",En={CAST_SESSION_START_FAILED:"".concat(kn,"-castsessionstartfailed"),CAST_SESSION_STARTING:"".concat(kn,"-castsessionstarting"),CAST_SESSION_STARTED:"".concat(kn,"-castsessionstarted"),CAST_SESSION_ENDING:"".concat(kn,"-castsessionending"),CAST_SESSION_ENDED:"".concat(kn,"-castsessionended"),CAST_AVAILABLE:"".concat(kn,"-castavailable")};function bn(e){return bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bn(e)}function Tn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sn(n.key),n)}}function An(e,t,r){return t&&Tn(e.prototype,t),r&&Tn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sn(e){var t=function(e,t){if("object"!=bn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=bn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bn(t)?t:String(t)}var Cn=An((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getPlayerSnapshot=Dn.bind(t),this.getUIWrapper=Ln.bind(t),this.onRemoteDeviceAvailable=Mn.bind(t),this.onRemoteDeviceConnected=xn.bind(t),this.onRemoteDeviceDisconnected=In.bind(t),this.onRemoteDeviceConnecting=Pn.bind(t),this.onRemoteDeviceDisconnecting=wn.bind(t),this.onRemoteDeviceConnectFailed=Rn.bind(t),this.getPlayerSelectedSource=On.bind(t)}));function Pn(){Cn._logger.debug("onRemoteDeviceConnecting"),this.dispatchEvent(new f.FakeEvent(En.CAST_SESSION_STARTING))}function xn(e){var t=this;Cn._logger.debug("onRemoteDeviceConnected",e);var r=e.player,n=e.ui,a=e.session;this._eventManager.removeAll(),Object.values(f.EventType).forEach((function(e){return t._eventManager.listen(r,e,(function(e){return t.dispatchEvent(e)}))}));var i=this.config;n&&f.Utils.Object.mergeDeep(i,{ui:{customPreset:n.uis}}),this.configure({playback:{muted:this.muted,volume:this.volume}}),this._localPlayer.reset(),this._uiWrapper.destroy(),this._remotePlayer=r,this._uiWrapper=new E(this,i),this.dispatchEvent(new f.FakeEvent(En.CAST_SESSION_STARTED,{session:a}))}function wn(){Cn._logger.debug("onRemoteDeviceDisconnecting"),this.dispatchEvent(new f.FakeEvent(En.CAST_SESSION_ENDING))}function In(e){var t=this;Cn._logger.debug("onRemoteDeviceDisconnected",e);var r=e.player,n=e.snapshot;if(this._remotePlayer&&this._remotePlayer===r&&(this._eventManager.removeAll(),Nn.call(this,n),n)){this.dispatchEvent(new f.FakeEvent(En.CAST_SESSION_ENDED));var a,i=this.config,o=!n.config.playback.autoplay,s=n.mediaInfo,l=n.mediaConfig;n.config.playback.autoplay=!0,Un.call(this,n.config),this._eventManager.listenOnce(this,this.Event.Core.CHANGE_SOURCE_ENDED,(function(){jn.call(t,n.config.sources)})),s?a=this.loadMedia(s):l&&(a=Promise.resolve(),this.setMedia(l)),a&&a.then((function(){t._eventManager.listenOnce(t,t.Event.Core.FIRST_PLAYING,(function(){t.textStyle=n.textStyle,Un.call(t,i),Bn.call(t,n.config.playback),o&&t.pause()}))}))}}function Mn(e){Cn._logger.debug("onRemoteDeviceAvailable",e);var t=e.player,r=e.available;this.dispatchEvent(new f.FakeEvent(En.CAST_AVAILABLE,{type:t.type,available:r}))}function Rn(){Cn._logger.debug("onRemoteDeviceConnectFailed"),this.dispatchEvent(new f.FakeEvent(En.CAST_SESSION_START_FAILED))}function Dn(){var e=new yn(this);return Cn._logger.debug("getPlayerSnapshot",e),e}function On(){var e=this._sourceSelected,t=null!=e&&e.url?e.url:window.sessionStorage.getItem("sourceUrl");return window.sessionStorage.setItem("sourceUrl",t),Cn._logger.debug("getPlayerSelectedSource",t),t}function Ln(){return Cn._logger.debug("getUIWrapper"),this._uiWrapper}function Nn(e){var t=this;this._uiWrapper.destroy();var r=this._localPlayer.config;if(r.plugins&&r.plugins.ima){var n={};if(r.cast.advertising&&r.cast.advertising.vast){if(e.config.sources.startTime>0){var a=r.plugins.ima.adTagUrl;n={adTagUrl:""},this._eventManager.listen(this,f.EventType.FIRST_PLAYING,(function(){return t.configure({plugins:{ima:{adTagUrl:a}}})}))}}else n={delayInitUntilSourceSelected:!0};f.Utils.Object.mergeDeep(r,{plugins:{ima:n}}),this._localPlayer.destroy(),this._remotePlayer=null,this._localPlayer=(0,f.loadPlayer)(r)}else this._remotePlayer=null;Object.values(f.EventType).forEach((function(e){return t._eventManager.listen(t._localPlayer,e,(function(e){return t.dispatchEvent(e)}))})),this._uiWrapper=new E(this,this.config),this._uiWrapper.setConfig({isCastAvailable:this.isCastAvailable()},"engine")}function Un(e){var t=e.sources.startTime,r=e.playback.autoplay;this.configure({sources:{startTime:t},playback:{autoplay:r}})}function jn(e){var t;if(null!==(t=e.captions)&&void 0!==t&&t.length){var r=e.captions;this.configure({sources:{captions:r}})}}function Bn(e){if(e.audioLanguage){var t=this.getTracks(f.TrackType.AUDIO).find((function(t){return t.language===e.audioLanguage}));this.selectTrack(t)}if(e.textLanguage){var r=this.getTracks(f.TrackType.TEXT).find((function(t){return t.language===e.textLanguage}));this.selectTrack(r)}}function Fn(e){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fn(e)}function Vn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gn(n.key),n)}}function Hn(e,t,r){return(t=Gn(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gn(e){var t=function(e,t){if("object"!=Fn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Fn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fn(t)?t:String(t)}!function(e,t,r){(t=Sn(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Cn,"_logger",(0,f.getLogger)("RemoteControl"));var $n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Hn(this,"_remotePlayers",new Map)}var t,r,n;return t=e,n=[{key:"register",value:function(t,r){"function"==typeof r?e._registry.has(t)?e._logger.debug("Remote player of type ".concat(t," is already registered")):(e._logger.debug("Register remote player of type ".concat(t)),e._registry.set(t,r)):e._logger.debug("remote player must be instance of BaseRemotePlayer")}}],(r=[{key:"load",value:function(t,r){var n=this;e._registry.forEach((function(a,i){e._logger.debug("Load remote player of type ".concat(i));var o=new a(t,new Cn(r),r.config.targetId);n._remotePlayers.set(i,o)}))}},{key:"startCasting",value:function(t){e._logger.debug("Start casting");var r=this._getRemotePlayer(t);return r?r.startCasting():Promise.reject()}},{key:"isCastAvailable",value:function(t){var r=this._getRemotePlayer(t);return!!r&&(e._logger.debug("isCastAvailable: ".concat(r.isCastAvailable())),r.isCastAvailable())}},{key:"destroy",value:function(){var e=this._remotePlayers;Array.from(e.values()).forEach((function(e){return e.destroy()}))}},{key:"setIsCastInitiator",value:function(e,t){var r=this._getRemotePlayer(e);r&&(r.isCastInitiator=t)}},{key:"_getRemotePlayer",value:function(e){var t=this._remotePlayers;return e&&t.get(e)?t.get(e):t.size>0?Array.from(t.values())[0]:void 0}}])&&Vn(t.prototype,r),n&&Vn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Kn(e){return Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kn(e)}function Wn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||qn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zn(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=qn(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function qn(e,t){if(e){if("string"==typeof e)return Yn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yn(e,t):void 0}}function Yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xn(){Xn=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,o=Object.create(i.prototype),s=new I(n||[]);return a(o,"_invoke",{value:C(e,r,s)}),o}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var p="suspendedStart",h="suspendedYield",f="executing",m="completed",g={};function y(){}function v(){}function _(){}var k={};u(k,o,(function(){return this}));var E=Object.getPrototypeOf,b=E&&E(E(M([])));b&&b!==r&&n.call(b,o)&&(k=b);var T=_.prototype=y.prototype=Object.create(k);function A(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(a,i,o,s){var l=d(e[a],e,i);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==Kn(c)&&n.call(c,"__await")?t.resolve(c.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(c).then((function(e){u.value=e,o(u)}),(function(e){return r("throw",e,o,s)}))}s(l.arg)}var i;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return i=i?i.then(a,a):a()}})}function C(t,r,n){var a=p;return function(i,o){if(a===f)throw new Error("Generator is already running");if(a===m){if("throw"===i)throw o;return{value:e,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var l=P(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===p)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=f;var u=d(t,r,n);if("normal"===u.type){if(a=n.done?m:h,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=m,n.method="throw",n.arg=u.arg)}}}function P(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=d(a,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var o=i.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function M(t){if(t||""===t){var r=t[o];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Kn(t)+" is not iterable")}return v.prototype=_,a(T,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:v,configurable:!0}),v.displayName=u(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,u(e,l,"GeneratorFunction")),e.prototype=Object.create(T),e},t.awrap=function(e){return{__await:e}},A(S.prototype),u(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var o=new S(c(e,r,n,a),i);return t.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},A(T),u(T,l,"Generator"),u(T,o,(function(){return this})),u(T,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=M,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(w),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),w(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;w(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:M(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function Zn(e,t,r,n,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function Qn(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){Zn(i,n,a,o,s,"next",e)}function s(e){Zn(i,n,a,o,s,"throw",e)}o(void 0)}))}}Hn($n,"_registry",new Map),Hn($n,"_logger",(0,f.getLogger)("RemotePlayerManager"));var Jn='video/mp4;codecs="avc1.42E01E"',ea=[["widevine","com.widevine.alpha"],["playready","com.microsoft.playready"],["fairplay","com.apple.fps"]],ta='video/mp4; codecs="hvc1.1.6.L150.90"',ra=1920,na=1080,aa=12e5,ia=30,oa=(0,f.getLogger)("MediaCapabilities"),sa={SUPPORTED:1,NOT_SUPPORTED:0,MAYBE_SUPPORTED:-1};function la(){return(la=Qn(Xn().mark((function e(t){var r,n,a;return Xn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,oa.debug("Starting to get media capabilities..."),e.next=4,da(t);case 4:return n=e.sent,e.next=7,ua();case 7:return a=e.sent,r=Object.assign({},n,a),oa.debug("Finished getting media capabilities ",{mediaCapabilities:r}),e.abrupt("return",r);case 13:return e.prev=13,e.t0=e.catch(0),oa.debug("There was a problem with getting the media capabilities, ",e.t0.message),r={isHEVCSupported:sa.NOT_SUPPORTED,isPowerEfficient:sa.NOT_SUPPORTED,isDRMSupported:sa.NOT_SUPPORTED,supportedDRMs:[]},oa.debug("Returning media capabilities defaults ",{mediaCapabilities:r}),e.abrupt("return",r);case 19:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function ua(){return ca.apply(this,arguments)}function ca(){return(ca=Qn(Xn().mark((function e(){var t,r,n,a,i,o,s,l;return Xn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={isDRMSupported:sa.MAYBE_SUPPORTED,supportedDRMs:[]},navigator.requestMediaKeySystemAccess){e.next=3;break}return e.abrupt("return",t);case 3:r=[{initDataTypes:["cenc"],videoCapabilities:[{contentType:Jn}]}],n=new Map(ea),a=zn(n),e.prev=6,a.s();case 8:if((i=a.n()).done){e.next=21;break}return o=Wn(i.value,2),s=o[0],l=o[1],e.prev=10,e.next=13,navigator.requestMediaKeySystemAccess(l,r);case 13:t.supportedDRMs.push(s),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(10),oa.debug(l+" not supported ("+e.t0.name+": "+e.t0.message+").");case 19:e.next=8;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(6),a.e(e.t1);case 26:return e.prev=26,a.f(),e.finish(26);case 29:return t.isDRMSupported=t.supportedDRMs.length>0?sa.SUPPORTED:sa.NOT_SUPPORTED,e.abrupt("return",t);case 31:case"end":return e.stop()}}),e,null,[[6,23,26,29],[10,16]])})))).apply(this,arguments)}function da(e){return pa.apply(this,arguments)}function pa(){return(pa=Qn(Xn().mark((function e(t){var r,n,a;return Xn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={isHEVCSupported:sa.MAYBE_SUPPORTED,isPowerEfficient:sa.MAYBE_SUPPORTED},navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo){e.next=3;break}return e.abrupt("return",r);case 3:return n={type:"media-source",video:{contentType:ta,width:(null==t?void 0:t.width)||ra,height:(null==t?void 0:t.height)||na,bitrate:(null==t?void 0:t.bitrate)||aa,framerate:(null==t?void 0:t.framerate)||ia}},e.prev=4,e.next=7,navigator.mediaCapabilities.decodingInfo(n);case 7:a=e.sent,r.isHEVCSupported=a.supported?sa.SUPPORTED:sa.NOT_SUPPORTED,r.isPowerEfficient=a.powerEfficient?sa.SUPPORTED:sa.NOT_SUPPORTED,e.next=17;break;case 12:e.prev=12,e.t0=e.catch(4),oa.debug("Failed to get the media capabilities from navigator. ("+e.t0.name+": "+e.t0.message+")."),r.isHEVCSupported=sa.MAYBE_SUPPORTED,r.isPowerEfficient=sa.MAYBE_SUPPORTED;case 17:return e.abrupt("return",r);case 18:case"end":return e.stop()}}),e,null,[[4,12]])})))).apply(this,arguments)}const ha=function(e){return la.apply(this,arguments)};function fa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ma(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ma(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ma(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ga=function(e){return 2===e.category},ya=function(e){return 2001===e.code},va=[[function(e){return ga(e)&&ya(e)&&function(e){var t,r;return(null===(t=e.data)||void 0===t?void 0:t.messages)&&"SESSION_RESTRICTED"===(null===(r=e.data)||void 0===r?void 0:r.messages[0].code)}(e)},f.Error.Category.MEDIA_UNAVAILABLE],[function(e){return ga(e)&&ya(e)&&function(e){var t,r;return(null===(t=e.data)||void 0===t?void 0:t.messages)&&"COUNTRY_RESTRICTED"===(null===(r=e.data)||void 0===r?void 0:r.messages[0].code)}(e)},f.Error.Category.GEO_LOCATION],[function(e){return ga(e)&&function(e){return 2002===e.code}(e)},f.Error.Category.MEDIA_NOT_READY]];const _a=function(e){return fa(va.find((function(t){return t[0](e)}))||[],2)[1]||f.Error.Category.PLAYER};function ka(e){return ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ka(e)}function Ea(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ba(n.key),n)}}function ba(e){var t=function(e,t){if("object"!=ka(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ka(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ka(t)?t:String(t)}var Ta=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,r){(t=ba(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"cache",new Map)}var t,r,n;return t=e,r=[{key:"set",value:function(e,t){this.cache.set(e,t)}},{key:"get",value:function(e){return this.cache.get(e)}},{key:"clear",value:function(){this.cache.clear()}}],r&&Ea(t.prototype,r),n&&Ea(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Aa(e){return Aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Aa(e)}function Sa(e){return function(e){if(Array.isArray(e))return Ca(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ca(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ca(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ca(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pa(Object(r),!0).forEach((function(t){ja(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pa(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function wa(){wa=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,o=Object.create(i.prototype),s=new I(n||[]);return a(o,"_invoke",{value:C(e,r,s)}),o}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var p="suspendedStart",h="suspendedYield",f="executing",m="completed",g={};function y(){}function v(){}function _(){}var k={};u(k,o,(function(){return this}));var E=Object.getPrototypeOf,b=E&&E(E(M([])));b&&b!==r&&n.call(b,o)&&(k=b);var T=_.prototype=y.prototype=Object.create(k);function A(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(a,i,o,s){var l=d(e[a],e,i);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==Aa(c)&&n.call(c,"__await")?t.resolve(c.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(c).then((function(e){u.value=e,o(u)}),(function(e){return r("throw",e,o,s)}))}s(l.arg)}var i;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return i=i?i.then(a,a):a()}})}function C(t,r,n){var a=p;return function(i,o){if(a===f)throw new Error("Generator is already running");if(a===m){if("throw"===i)throw o;return{value:e,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var l=P(s,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===p)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=f;var u=d(t,r,n);if("normal"===u.type){if(a=n.done?m:h,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=m,n.method="throw",n.arg=u.arg)}}}function P(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=d(a,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var o=i.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function M(t){if(t||""===t){var r=t[o];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Aa(t)+" is not iterable")}return v.prototype=_,a(T,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:v,configurable:!0}),v.displayName=u(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,u(e,l,"GeneratorFunction")),e.prototype=Object.create(T),e},t.awrap=function(e){return{__await:e}},A(S.prototype),u(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var o=new S(c(e,r,n,a),i);return t.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},A(T),u(T,l,"Generator"),u(T,o,(function(){return this})),u(T,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=M,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(w),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),w(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;w(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:M(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function Ia(e,t,r,n,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function Ma(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){Ia(i,n,a,o,s,"next",e)}function s(e){Ia(i,n,a,o,s,"throw",e)}o(void 0)}))}}function Ra(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ba(n.key),n)}}function Da(e,t,r){return t=La(t),function(e,t){if(t&&("object"===Aa(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Na(e)}(e,Oa()?Reflect.construct(t,r||[],La(e).constructor):t.apply(e,r))}function Oa(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Oa=function(){return!!e})()}function La(e){return La=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},La(e)}function Na(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ua(e,t){return Ua=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ua(e,t)}function ja(e,t,r){return(t=Ba(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ba(e){var t=function(e,t){if("object"!=Aa(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Aa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Aa(t)?t:String(t)}var Fa=function(e){function t(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ja(Na(r=Da(this,t)),"_eventManager",new f.EventManager),ja(Na(r),"_mediaInfo",null),ja(Na(r),"_remotePlayer",null),ja(Na(r),"_pluginManager",new ce),ja(Na(r),"_pluginsConfig",{}),ja(Na(r),"_reset",!0),ja(Na(r),"_firstPlay",!0),ja(Na(r),"_sourceSelected",null),ja(Na(r),"_appPluginConfig",{}),ja(Na(r),"_thumbnailManager",null),ja(Na(r),"_isVisible",!1),ja(Na(r),"_autoPaused",!1),ja(Na(r),"_sessionIdCache",null);var n=e.sources,a=e.plugins;r._sessionIdCache=new Ta,r._configEvaluator=new Er,r._configEvaluator.evaluatePluginsConfig(a,e),r._playbackStart=!1;var i=f.Utils.Object.mergeDeep({},e);delete i.plugins,delete i.sources,r._localPlayer=(0,f.loadPlayer)(i),r._controllerProvider=new Z(r._pluginManager),r._viewabilityManager=new lt(r.config.viewability),r._serviceProvider=new qr(Na(r)),r._uiWrapper=new E(Na(r),f.Utils.Object.mergeDeep(e,{ui:{logger:{getLogger:f.getLogger,LogLevel:f.LogLevel}}})),r._cuepointManager=new $r(Na(r)),r._provider=new g.Provider(f.Utils.Object.mergeDeep(e.provider,{logger:{getLogger:f.getLogger,LogLevel:f.LogLevel},referrer:window.originalRequestReferrer}),"3.17.21"),r._playlistManager=new pn(Na(r),e),Object.values(f.EventType).forEach((function(e){return r._eventManager.listen(r._localPlayer,e,(function(e){return r.dispatchEvent(e)}))})),r._addBindings();var o=f.Utils.Object.mergeDeep({},e.playlist,{items:null});return r._playlistManager.configure(o),r.configure({plugins:a}),r._playlistManager.configure({items:e.playlist&&e.playlist.items||[]}),r._remotePlayerManager=new $n,r._localPlayer.setSources(n||{}),r}var r,n,a,i,o,s,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ua(e,t)}(t,e),r=t,n=[{key:"loadMedia",value:(l=Ma(wa().mark((function e(r,n){var a,i,o,s,l;return wa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._logger.debug("loadMedia",r),this._mediaInfo=r,this.reset(),this._localPlayer.loadingMedia=!0,this._uiWrapper.setLoadingSpinnerState(!0),e.prev=5,e.next=8,this._provider.getMediaConfig(r);case 8:return a=e.sent,i=f.Utils.Object.copyDeep(a),n&&(i.sources=i.sources||{},i.sources=f.Utils.Object.mergeDeep(i.sources,n)),o=Wt(i.plugins,this.config.plugins),i.plugins=o[0],this._appPluginConfig=o[1],this.configure(Re({sources:this.sources},i)),this.setMedia(i),e.abrupt("return",i);case 19:throw e.prev=19,e.t0=e.catch(5),s=_a(e.t0),l=new f.Error(f.Error.Severity.CRITICAL,s,f.Error.Code.LOAD_FAILED,e.t0),this._localPlayer.dispatchEvent(new f.FakeEvent(f.EventType.ERROR,l)),e.t0;case 25:case"end":return e.stop()}}),e,this,[[5,19]])}))),function(e,t){return l.apply(this,arguments)})},{key:"setMedia",value:function(e){var r;t._logger.debug("setMedia",e),this.reset(!0);var n=f.Utils.Object.copyDeep(e),a=f.Utils.Object.mergeDeep({},n.sources,this._localPlayer.sources);n.sources.type===f.MediaType.VOD&&(null===(r=this._localPlayer.sources.mediaEntryType)||void 0===r?void 0:r.toString())===f.MediaType.LIVE&&(a.id=n.sources.id,a.duration=n.sources.duration),delete n.sources,f.Utils.Object.mergeDeep(n.session,this._localPlayer.config.session),n.plugins=n.plugins||{},Object.keys(this._pluginsConfig).forEach((function(e){n.plugins[e]=n.plugins[e]||{}})),this.configure({session:e.session}),Gt(a)||$t(a)||Kt(a)?this._thumbnailManager=null:this._thumbnailManager=new Fr(this,this.config.ui,e),this.updateKalturaPoster(a,e.sources,this._localPlayer.dimensions),cr(this,xa(xa({},n),{},{sources:a}));var i=function(e,t){return t&&Gt(t)?Ht(e,"youtube","progressive"):t&&$t(t)?Ht(e,"image","image"):t&&Kt(t)?Ht(e,"document","document"):null}(this,a);i&&(n.playback=i),this.configure(xa(xa({},n),{},{sources:a})),this._configureInformationForDevice(e)}},{key:"loadPlaylist",value:(s=Ma(wa().mark((function e(r,n){var a,i;return wa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._logger.debug("loadPlaylist",r),this._uiWrapper.setLoadingSpinnerState(!0),e.prev=2,e.next=5,this._provider.getPlaylistConfig(r);case 5:return a=e.sent,this.setPlaylist(a,n),e.abrupt("return",a);case 10:throw e.prev=10,e.t0=e.catch(2),i=new f.Error(f.Error.Severity.CRITICAL,f.Error.Category.PLAYER,f.Error.Code.LOAD_FAILED,e.t0),this._localPlayer.dispatchEvent(new f.FakeEvent(f.EventType.ERROR,i)),e.t0;case 15:case"end":return e.stop()}}),e,this,[[2,10]])}))),function(e,t){return s.apply(this,arguments)})},{key:"loadPlaylistByEntryList",value:(o=Ma(wa().mark((function e(r,n){var a,i;return wa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._logger.debug("loadPlaylistByEntryList",r),this._uiWrapper.setLoadingSpinnerState(!0),e.prev=2,e.next=5,this._provider.getEntryListConfig(r);case 5:return a=e.sent,this.setPlaylist(a,n,r),e.abrupt("return",a);case 10:throw e.prev=10,e.t0=e.catch(2),i=new f.Error(f.Error.Severity.CRITICAL,f.Error.Category.PLAYER,f.Error.Code.LOAD_FAILED,e.t0),this._localPlayer.dispatchEvent(new f.FakeEvent(f.EventType.ERROR,i)),e.t0;case 15:case"end":return e.stop()}}),e,this,[[2,10]])}))),function(e,t){return o.apply(this,arguments)})},{key:"setPlaylist",value:function(e,r,n){t._logger.debug("setPlaylist",e);var a={playlist:e,plugins:{}};Object.keys(this._pluginsConfig).forEach((function(e){a.plugins[e]={}})),this._configEvaluator.evaluatePluginsConfig(a.plugins,a),this._configureOrLoadPlugins(a.plugins),this._playlistManager.load(e,r,n)}},{key:"configure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Vt(e);var t=f.Utils.Object.mergeDeep({},this.config,e);this._configEvaluator.evaluatePluginsConfig(e.plugins,t),this._configureOrLoadPlugins(e.plugins);var r=f.Utils.Object.mergeDeep({},e);if(delete r.plugins,r.sources){var n=r.sources;delete r.sources,this._localPlayer.configure(r),this._localPlayer.setSources(n||{})}else this._localPlayer.configure(r);e.ui&&this._uiWrapper.setConfig(t.ui),e.playlist&&this._playlistManager.configure(e.playlist)}},{key:"updateKalturaPoster",value:function(e,t,r){var n;!function(e,t,r,n){var a=e.poster,i=t.poster,o=r.width,s=r.height;"string"==typeof a&&Br.test(a)&&a===i&&(e.poster="".concat(a,"/height/").concat(s,"/width/").concat(o).concat(n?"/ks/".concat(n):"")),t.poster=e.poster||""}(e,t,r,this.shouldAddKs()?null===(n=this.config)||void 0===n||null===(n=n.session)||void 0===n?void 0:n.ks:"")}},{key:"shouldAddKs",value:function(e){var t,r;return!(null===(t=this.config)||void 0===t||null===(t=t.provider)||void 0===t||!t.loadThumbnailWithKs||!1!==(null===(r=e||this.config)||void 0===r||null===(r=r.session)||void 0===r?void 0:r.isAnonymous))}},{key:"getMediaInfo",value:function(){return f.Utils.Object.copyDeep(this._mediaInfo)}},{key:"getDrmInfo",value:function(){return this._localPlayer.getDrmInfo()}},{key:"getMediaConfig",value:function(){var e={sources:this._localPlayer.sources,plugins:this._pluginsConfig};return f.Utils.Object.copyDeep(e)}},{key:"setSourcesMetadata",value:function(e){this._localPlayer.setSourcesMetadata(e)}},{key:"ready",value:function(){return this._localPlayer.ready()}},{key:"load",value:function(){this._localPlayer.load()}},{key:"play",value:function(){this._localPlayer.play()}},{key:"pause",value:function(){this._localPlayer.pause()}},{key:"getView",value:function(){return this._localPlayer.getView()}},{key:"getVideoElement",value:function(){return this._localPlayer.getVideoElement()}},{key:"reset",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._reset||(this._reset=!0,this._firstPlay=!0,this._sourceSelected=null,this._attachEventManager&&this._attachEventManager.removeAll(),this._uiWrapper.reset(),this._resetProviderPluginsConfig(),this._pluginManager.reset(),this._cuepointManager.reset(),this._localPlayer.reset(t),null===(e=this._thumbnailManager)||void 0===e||e.destroy())}},{key:"destroy",value:function(){var e,t,r=this.config.ui.targetId;this._reset=!0,this._playbackStart=!1,this._firstPlay=!0,this._uiWrapper.destroy(),this._pluginManager.destroy(),this._cuepointManager.destroy(),this._playlistManager.destroy(),this._localPlayer.destroy(),this._eventManager.destroy(),null===(e=this._thumbnailManager)||void 0===e||e.destroy(),this._viewabilityManager.destroy(),this._remotePlayerManager.destroy(),this._pluginsConfig={};var n=document.getElementById(r);n&&n.parentNode&&f.Utils.Dom.removeChild(n.parentNode,n),null===(t=this._sessionIdCache)||void 0===t||t.clear()}},{key:"isLive",value:function(){return this._localPlayer.isLive()}},{key:"isOnLiveEdge",value:function(){return this._localPlayer.isOnLiveEdge()}},{key:"isDvr",value:function(){return this._localPlayer.isDvr()}},{key:"isUntimedImg",value:function(){return $t(this.sources)&&!("number"==typeof this.config.sources.duration&&this.config.sources.duration>0)}},{key:"isUntimedDocument",value:function(){return Kt(this.sources)&&!("number"==typeof this.config.sources.duration&&this.config.sources.duration>0)}},{key:"isImage",value:function(){return $t(this.sources)}},{key:"isDocument",value:function(){return Kt(this.sources)}},{key:"isAudio",value:function(){return this._localPlayer.isAudio()}},{key:"seekToLiveEdge",value:function(){this._localPlayer.seekToLiveEdge()}},{key:"getStartTimeOfDvrWindow",value:function(){return this._localPlayer.getStartTimeOfDvrWindow()}},{key:"getTracks",value:function(e){return this._localPlayer.getTracks(e)}},{key:"getActiveTracks",value:function(){return this._localPlayer.getActiveTracks()}},{key:"selectTrack",value:function(e){this._localPlayer.selectTrack(e)}},{key:"hideTextTrack",value:function(){this._localPlayer.hideTextTrack()}},{key:"showTextTrack",value:function(){this._localPlayer.showTextTrack()}},{key:"enableAdaptiveBitrate",value:function(){this._localPlayer.enableAdaptiveBitrate()}},{key:"isAdaptiveBitrateEnabled",value:function(){return this._localPlayer.isAdaptiveBitrateEnabled()}},{key:"setTextDisplaySettings",value:function(e){this._localPlayer.setTextDisplaySettings(e)}},{key:"textDisplaySetting",get:function(){return this._localPlayer.textDisplaySetting}},{key:"isFullscreen",value:function(){return this._localPlayer.isFullscreen()}},{key:"notifyEnterFullscreen",value:function(){this._localPlayer.notifyEnterFullscreen()}},{key:"notifyExitFullscreen",value:function(){this._localPlayer.notifyExitFullscreen()}},{key:"enterFullscreen",value:function(e){var t=e||this.config.ui.targetId;this._localPlayer.enterFullscreen(t)}},{key:"exitFullscreen",value:function(){this._localPlayer.exitFullscreen()}},{key:"enterPictureInPicture",value:function(){this._localPlayer.enterPictureInPicture()}},{key:"exitPictureInPicture",value:function(){this._localPlayer.exitPictureInPicture()}},{key:"isInPictureInPicture",value:function(){return this._localPlayer.isInPictureInPicture()}},{key:"isPictureInPictureSupported",value:function(){return this._localPlayer.isPictureInPictureSupported()}},{key:"getLogLevel",value:function(e){return this._localPlayer.getLogLevel(e)}},{key:"startCasting",value:function(e){var t=this;return this.setIsCastInitiator(e,!0),new Promise((function(r,n){t.remotePlayerManager.startCasting(e).then(r).catch((function(){t.setIsCastInitiator(e,!1),n()}))}))}},{key:"setIsCastInitiator",value:function(e,t){this._remotePlayerManager.setIsCastInitiator(e,t)}},{key:"isCastAvailable",value:function(e){return this._remotePlayerManager.isCastAvailable(e)}},{key:"getCastSession",value:function(){return null}},{key:"stopCasting",value:function(){}},{key:"isCasting",value:function(){return!1}},{key:"isVr",value:function(){return this._localPlayer.isVr()}},{key:"toggleVrStereoMode",value:function(){var e=this._pluginManager.get("vr");e&&"function"==typeof e.toggleVrStereoMode&&e.toggleVrStereoMode()}},{key:"isInVrStereoMode",value:function(){var e=this._pluginManager.get("vr");return!(!e||"function"!=typeof e.isInStereoMode)&&e.isInStereoMode()}},{key:"setLogLevel",value:function(e,t){this._localPlayer.setLogLevel(e,t)}},{key:"getThumbnail",value:function(e){if(!e){if(isNaN(this.currentTime))return null;e=this.currentTime}return e=this.isLive()?e+this.getStartTimeOfDvrWindow():e,this._thumbnailManager?this._thumbnailManager.getThumbnail(e):null}},{key:"textStyle",get:function(){return this._localPlayer.textStyle},set:function(e){this._localPlayer.textStyle=e}},{key:"buffered",get:function(){return this._localPlayer.buffered}},{key:"stats",get:function(){return this._localPlayer.stats}},{key:"currentTime",get:function(){return this._localPlayer.currentTime},set:function(e){this._localPlayer.currentTime=e}},{key:"duration",get:function(){return this._localPlayer.duration}},{key:"liveDuration",get:function(){return this._localPlayer.liveDuration}},{key:"normalizedCurrentTime",get:function(){return this.isLive()?this.currentTime-this.getStartTimeOfDvrWindow():this.currentTime},set:function(e){this.isLive()?this.currentTime=e+this.getStartTimeOfDvrWindow():this.currentTime=e}},{key:"normalizedDuration",get:function(){return this.isLive()?this.liveDuration-this.getStartTimeOfDvrWindow():this.duration}},{key:"volume",get:function(){return this._localPlayer.volume},set:function(e){this._localPlayer.volume=e}},{key:"paused",get:function(){return this._localPlayer.paused}},{key:"seeking",get:function(){return this._localPlayer.seeking}},{key:"playsinline",get:function(){return this._localPlayer.playsinline},set:function(e){this._localPlayer.playsinline=e}},{key:"muted",get:function(){return this._localPlayer.muted},set:function(e){this._localPlayer.muted=e}},{key:"src",get:function(){return this._localPlayer.src}},{key:"videoHeight",get:function(){return this._localPlayer.videoHeight}},{key:"videoWidth",get:function(){return this._localPlayer.videoWidth}},{key:"dimensions",get:function(){return this._localPlayer.dimensions},set:function(e){this._localPlayer.dimensions=e}},{key:"poster",get:function(){return this._localPlayer.poster}},{key:"ended",get:function(){return this._localPlayer.ended}},{key:"playbackRate",get:function(){return this._localPlayer.playbackRate},set:function(e){this._localPlayer.playbackRate=e}},{key:"playbackRates",get:function(){return this._localPlayer.playbackRates}},{key:"defaultPlaybackRate",get:function(){return this._localPlayer.defaultPlaybackRate}},{key:"engineType",get:function(){return this._localPlayer.engineType}},{key:"streamType",get:function(){return this._localPlayer.streamType}},{key:"env",get:function(){return this._localPlayer.env}},{key:"selectedSource",get:function(){return this._sourceSelected}},{key:"sources",get:function(){return xa({},this._localPlayer.sources)}},{key:"config",get:function(){return xa(xa({},this._localPlayer.config),{},{plugins:this._pluginsConfig,sources:this._localPlayer.sources})}},{key:"hasUserInteracted",get:function(){return this._localPlayer.hasUserInteracted}},{key:"loadingMedia",set:function(e){this._localPlayer.loadingMedia=e}},{key:"ads",get:function(){return this._adsController}},{key:"plugins",get:function(){return this._pluginManager.getAll()}},{key:"provider",get:function(){return this._provider}},{key:"ui",get:function(){return this._uiWrapper}},{key:"playlist",get:function(){return this._playlistManager}},{key:"Event",get:function(){return xa({Cast:En,Core:f.EventType,Playlist:Xr,UI:m.EventType,VISIBILITY_CHANGE:dt,REGISTERED_PLUGINS_LIST_EVENT:ue},f.EventType)}},{key:"TextStyle",get:function(){return this._localPlayer.TextStyle}},{key:"ViewabilityType",get:function(){return ut}},{key:"State",get:function(){return this._localPlayer.State}},{key:"Track",get:function(){return this._localPlayer.Track}},{key:"LogLevelType",get:function(){return this._localPlayer.LogLevelType}},{key:"LogLevel",get:function(){return this._localPlayer.LogLevel}},{key:"AbrMode",get:function(){return this._localPlayer.AbrMode}},{key:"MediaType",get:function(){return this._localPlayer.MediaType}},{key:"StreamType",get:function(){return this._localPlayer.StreamType}},{key:"EngineType",get:function(){return this._localPlayer.EngineType}},{key:"Error",get:function(){return this._localPlayer.Error}},{key:"_configureInformationForDevice",value:function(e){var t;if(navigator.mediaSession){var r,n="string"==typeof(t=e.sources.poster)?t:Array.isArray(t)&&t.length>0?t[0]:"";navigator.mediaSession.metadata=new MediaMetadata({title:(null===(r=e.sources.metadata)||void 0===r?void 0:r.name)||"",artwork:n?[{src:n}]:[]})}}},{key:"_addBindings",value:function(){var e=this;this._eventManager.listen(this,f.EventType.CHANGE_SOURCE_STARTED,(function(){return e._onChangeSourceStarted()})),this._eventManager.listen(this,f.EventType.CHANGE_SOURCE_ENDED,(function(){return e._onChangeSourceEnded()})),this._eventManager.listen(this,f.EventType.PLAYER_RESET,(function(){return e._onPlayerReset()})),this._eventManager.listen(this,f.EventType.ENDED,(function(){return e._onEnded()})),this._eventManager.listen(this,f.EventType.FIRST_PLAY,(function(){return e._firstPlay=!1})),this._eventManager.listen(this,f.EventType.SOURCE_SELECTED,(function(t){return e._sourceSelected=t.payload.selectedSource[0]})),this._eventManager.listen(this,f.EventType.PLAYBACK_ENDED,(function(){return e._onPlaybackEnded()})),this._eventManager.listen(this,f.EventType.PLAYBACK_START,(function(){e._playbackStart=!0})),this._eventManager.listen(this,f.AdEventType.AD_AUTOPLAY_FAILED,(function(t){return e._onAdAutoplayFailed(t)})),this._eventManager.listen(this,f.AdEventType.AD_STARTED,(function(){return e._onAdStarted()})),this.config.playback.playAdsWithMSE&&(this._attachEventManager=new f.EventManager,this._eventManager.listen(this,f.AdEventType.AD_LOADED,(function(t){var r=t.payload.ad;r&&r.linear&&1===r.position&&!r.inStream&&e.src?(e._attachEventManager.listenOnce(e,f.AdEventType.AD_BREAK_START,(function(){return e.detachMediaSource()})),e._attachEventManager.listenOnce(e,f.AdEventType.AD_BREAK_END,(function(){return e.attachMediaSource()})),e._attachEventManager.listenOnce(e,f.AdEventType.AD_ERROR,(function(){return e.attachMediaSource()}))):e._attachEventManager.removeAll()}))),this._eventManager.listen(this,f.EventType.ERROR,(function(t){t.payload.severity===f.Error.Severity.CRITICAL&&(e._reset=!1)}))}},{key:"_onChangeSourceEnded",value:function(){f.Utils.Object.getPropertyPath(this.config,"ui.targetId")?this._viewabilityManager.observe(document.getElementById(this.config.ui.targetId),this._handleVisibilityChange.bind(this)):t._logger.warn("Cannot observe visibility change without config.ui.targetId")}},{key:"_onPlayerReset",value:function(){this._playbackStart=!1,f.Utils.Object.getPropertyPath(this.config,"ui.targetId")&&this._viewabilityManager.unObserve(document.getElementById(this.config.ui.targetId),this._handleVisibilityChange.bind(this))}},{key:"_onChangeSourceStarted",value:function(){this._configureOrLoadPlugins(this._pluginsConfig),this.reset(),this._pluginManager.loadMedia(),this._reset=!1,this.dispatchEvent(new f.FakeEvent(ue,this._pluginManager.getRegisterdPluginsList()))}},{key:"_onEnded",value:function(){var e=this;setTimeout((function(){e._adsController&&!e._adsController.allAdsCompleted?e._eventManager.listenOnce(e._adsController,f.AdEventType.ALL_ADS_COMPLETED,(function(){e.dispatchEvent(new f.FakeEvent(f.EventType.PLAYBACK_ENDED))})):e.dispatchEvent(new f.FakeEvent(f.EventType.PLAYBACK_ENDED))}))}},{key:"_onPlaybackEnded",value:function(){this.config.playback.loop&&(this.currentTime=0,this.play())}},{key:"_onAdStarted",value:function(){this._firstPlay&&(this._localPlayer.posterManager.hide(),this._localPlayer.hideBlackCover())}},{key:"_onAdAutoplayFailed",value:function(e){this._firstPlay&&this.config.playback.autoplay&&(this._localPlayer.posterManager.show(),this.dispatchEvent(new f.FakeEvent(f.EventType.AUTOPLAY_FAILED,e.payload)))}},{key:"_configureOrLoadPlugins",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=[],n=[],a=[];Object.keys(t).forEach((function(i){var o=e._pluginManager.get(i);if(o)o.updateConfig(t[i]),t[i]=o.getConfig();else if(e._sourceSelected)delete t[i];else{try{e._pluginManager.load(i,e,t[i])}catch(t){e.dispatchEvent(new f.FakeEvent(f.Error.Code.ERROR,t))}var s=e._pluginManager.get(i);s&&(a.push(s),t[i]=s.getConfig(),"function"==typeof s.getMiddlewareImpl&&("bumper"===s.name?r.push(s.getMiddlewareImpl()):r.unshift(s.getMiddlewareImpl())),"function"==typeof s.getUIComponents&&n.push.apply(n,Sa(s.getUIComponents()||[])),"function"==typeof s.getEngineDecorator&&e._localPlayer.registerEngineDecoratorProvider(new f.EngineDecoratorProvider(s)))}})),n.forEach((function(t){return e._uiWrapper.addComponent(t)})),this._pluginReadinessMiddleware||(this._pluginReadinessMiddleware=new Mr(a),this._localPlayer.playbackMiddleware.use(this._pluginReadinessMiddleware)),this._maybeCreateAdsController(),r.forEach((function(t){return e._localPlayer.playbackMiddleware.use(t)})),f.Utils.Object.mergeDeep(this._pluginsConfig,t)}},{key:"_maybeCreateAdsController",value:function(){var e=this;if(!this._adsController){var t=this._controllerProvider.getAdsControllers();t.length&&(this._adsController=new z(this,t),this._localPlayer.playbackMiddleware.use(this._adsController.getMiddleware()),this._eventManager.listen(this._adsController,f.AdEventType.ALL_ADS_COMPLETED,(function(t){e.dispatchEvent(t)})))}}},{key:"attachMediaSource",value:function(){this._localPlayer.attachMediaSource()}},{key:"detachMediaSource",value:function(){this._localPlayer.detachMediaSource()}},{key:"_resetProviderPluginsConfig",value:function(){this.configure({plugins:this._appPluginConfig}),this._appPluginConfig={}}},{key:"crossOrigin",get:function(){return this._localPlayer.crossOrigin},set:function(e){this._localPlayer.crossOrigin=e}},{key:"isVisible",get:function(){return this._isVisible}},{key:"viewabilityManager",get:function(){return this._viewabilityManager}},{key:"_handleVisibilityChange",value:function(e){this._isVisible=e,this.dispatchEvent(new f.FakeEvent(dt,{visible:this._isVisible})),this.config.playback.autoplay===f.AutoPlayType.IN_VIEW&&this._isVisible&&!this._playbackStart&&this._localPlayer.play({programmatic:!0}),!0===this.config.playback.autopause&&this._handleAutoPause(e)}},{key:"_handleAutoPause",value:function(e){var t=!this.paused||this._adsController&&this._adsController.isAdPlaying(),r=!this.isInPictureInPicture()&&this._playbackStart&&t;e?this._autoPaused&&(this.paused&&this.play(),this._autoPaused=!1):r&&(this.pause(),this._autoPaused=!0)}},{key:"getService",value:function(e){return this._serviceProvider.get(e)}},{key:"hasService",value:function(e){return this._serviceProvider.has(e)}},{key:"registerService",value:function(e,t){this._serviceProvider.register(e,t)}},{key:"cuePointManager",get:function(){return this._cuepointManager}},{key:"addTextTrack",value:function(e,t){return this._localPlayer.addTextTrack(e,t)}},{key:"getNativeTextTracks",value:function(){return this._localPlayer.getNativeTextTracks()}},{key:"remotePlayerManager",get:function(){return this._remotePlayerManager}},{key:"getMediaCapabilities",value:(i=Ma(wa().mark((function e(t){return wa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ha(t));case 1:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"setCachedUrls",value:function(e){this.config.playback.enableCachedUrls&&this._localPlayer.setCachedUrls(e)}},{key:"sessionIdCache",get:function(){return this._sessionIdCache}}],n&&Ra(r.prototype,n),a&&Ra(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}(f.FakeEventTarget);ja(Fa,"_logger",(0,f.getLogger)("KalturaPlayer"+f.Utils.Generator.uniqueId(5)));var Va={};function Ha(){return Va}function Ga(e){return Va[e]?Va[e]:null}var $a=["_remotePlayer","_listeners","_uiWrapper"],Ka={get:function(e,t){if("destroy"===t){var r=e.config.targetId;delete Va[r]}return t in f.FakeEventTarget.prototype||$a.includes(t)?e[t]:e._remotePlayer&&t in e._remotePlayer?e._remotePlayer[t]:e[t]},set:function(e,t,r){return e._remotePlayer&&!$a.includes(t)?t in e._remotePlayer&&(e._remotePlayer[t]=r):e[t]=r,!0}},Wa=function(e){var t=new Fa(e),r=new Proxy(t,Ka);return Va[e.targetId]=r,r};function za(e){!function(e){!1!==f.Utils.Object.getPropertyPath(e,"log.playerVersion")&&((0,f.setLogLevel)(f.LogLevel.INFO),(0,f.getLogger)().log("%c ".concat("@playkit-js/kaltura-player-js"," ").concat("3.17.21"),"color: #ff98f9;  font-size: large"),(0,f.getLogger)().log("%c For more details see ".concat("https://github.com/kaltura/kaltura-player-js"),"color: #ff98f9;"))}(e),Nt(e=Vt(e));var t=Ft(e);!function(e){var t,r=e.provider,n=null===(t=Bt())||void 0===t?void 0:t.productVersion;if(!r.partnerId||r.partnerId===Ot){var a={url:Lt,mimetype:""};a.url=function(e,t){return t&&(e+="&clientVer=".concat(t)),e}(a.url,n),a.url=or(a.url),a.url=lr(a.url,n),a.url=ar(null,a.url,St.next()),navigator.sendBeacon&&navigator.sendBeacon(a.url)}}(t),Ut(t),function(e){var t=parseFloat(jt(Mt));isNaN(t)||f.Utils.Object.createPropertyPath(e,"sources.startTime",t)}(t),function(e){var t=parseFloat(jt(Rt));isNaN(t)||f.Utils.Object.createPropertyPath(e,"sources.seekFrom",t);var r=parseFloat(jt(Dt));isNaN(r)||f.Utils.Object.createPropertyPath(e,"sources.clipTo",r)}(t),xt.forEach((function(e){return(0,f.getLogger)("KalturaPlayer:Setup")[e.level](e.msg)})),rt.initialize(),Et.initialize(),function(e){e.disableUserCache||qe.setStorageConfig(e)}(t);var r=Wa(t);return function(e){if(!e.config.disableUserCache&&rt.isStorageAvailable()){var t=rt.getPlayerTextStyle();t&&(e.textStyle=f.Utils.Object.mergeDeep(new f.TextStyle,t))}}(r),function(e){qe.attachAll(e)}(r),function(e,t){e.cast&&t.remotePlayerManager.load(e.cast,t)}(t,r),function(e){if(f.Env.isIOS||f.Env.isIPadOS){var t=function t(){e.removeEventListener(e.Event.UI.UI_CLICKED,t),(0,f.setCapabilities)(f.EngineType.HTML5,{autoplay:!0})};e.addEventListener(e.Event.SOURCE_SELECTED,(function r(){e.removeEventListener(e.Event.SOURCE_SELECTED,r),e.addEventListener(e.Event.UI.UI_CLICKED,t)}))}}(r),r}function qa(e){return qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qa(e)}function Ya(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xa(n.key),n)}}function Xa(e){var t=function(e,t){if("object"!=qa(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=qa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qa(t)?t:String(t)}var Za=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t,this._friendlyName=r,this._resuming=n}var t,r,n;return t=e,(r=[{key:"deviceFriendlyName",get:function(){return this._friendlyName}},{key:"id",get:function(){return this._id}},{key:"resuming",get:function(){return this._resuming}}])&&Ya(t.prototype,r),n&&Ya(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Qa(e){return Qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qa(e)}function Ja(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oi(n.key),n)}}function ei(e,t,r){return t=ri(t),function(e,t){if(t&&("object"===Qa(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ni(e)}(e,ti()?Reflect.construct(t,r||[],ri(e).constructor):t.apply(e,r))}function ti(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ti=function(){return!!e})()}function ri(e){return ri=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ri(e)}function ni(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ai(e,t){return ai=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ai(e,t)}function ii(e,t,r){return(t=oi(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oi(e){var t=function(e,t){if("object"!=Qa(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Qa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qa(t)?t:String(t)}var si=function(e){function t(e,r,n){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ii(ni(a=ei(this,t)),"_isCastInitiator",!1),a._playerConfig={},t._logger=(0,f.getLogger)(e),a._remoteControl=n,a._castConfig=f.Utils.Object.mergeDeep({},a.constructor.defaultConfig,r),a._eventManager=new f.EventManager,t._logger.debug("Initialized"),a}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ai(e,t)}(t,e),r=t,a=[{key:"isSupported",value:function(){return!0}}],(n=[{key:"loadMedia",value:function(e){return Promise.resolve()}},{key:"setMedia",value:function(e){}},{key:"getMediaInfo",value:function(){}},{key:"getMediaConfig",value:function(){}},{key:"configure",value:function(){}},{key:"ready",value:function(){return Promise.resolve()}},{key:"load",value:function(){}},{key:"play",value:function(){}},{key:"pause",value:function(){}},{key:"reset",value:function(){}},{key:"destroy",value:function(){}},{key:"isLive",value:function(){return!1}},{key:"isDvr",value:function(){return!1}},{key:"seekToLiveEdge",value:function(){}},{key:"getStartTimeOfDvrWindow",value:function(){return 0}},{key:"getTracks",value:function(e){return[]}},{key:"getActiveTracks",value:function(){return{audio:void 0,video:void 0,text:void 0}}},{key:"selectTrack",value:function(e){}},{key:"hideTextTrack",value:function(){}},{key:"enableAdaptiveBitrate",value:function(){}},{key:"isAdaptiveBitrateEnabled",value:function(){return!0}},{key:"setTextDisplaySettings",value:function(e){}},{key:"startCasting",value:function(){return Promise.reject("startCasting method was not overridden")}},{key:"stopCasting",value:function(){}},{key:"isCasting",value:function(){return!0}},{key:"isCastAvailable",value:function(){return!0}},{key:"getCastSession",value:function(){return new Za("","")}},{key:"isVr",value:function(){return!1}},{key:"toggleVrStereoMode",value:function(){}},{key:"isInVrStereoMode",value:function(){return!1}},{key:"ads",get:function(){return null}},{key:"textStyle",get:function(){return new f.TextStyle},set:function(e){}},{key:"buffered",get:function(){return[]}},{key:"currentTime",get:function(){return 0},set:function(e){}},{key:"duration",get:function(){return 0}},{key:"liveDuration",get:function(){return NaN}},{key:"volume",get:function(){return 1},set:function(e){}},{key:"paused",get:function(){return!1}},{key:"ended",get:function(){return!1}},{key:"seeking",get:function(){return!1}},{key:"muted",get:function(){return!1},set:function(e){}},{key:"src",get:function(){return""}},{key:"poster",get:function(){return""}},{key:"playbackRate",get:function(){return 1},set:function(e){}},{key:"engineType",get:function(){return""}},{key:"streamType",get:function(){return""}},{key:"type",get:function(){return t.Type}},{key:"config",get:function(){return this._playerConfig}},{key:"isCastInitiator",get:function(){return this._isCastInitiator},set:function(e){this._isCastInitiator=e}}])&&Ja(r.prototype,n),a&&Ja(r,a),Object.defineProperty(r,"prototype",{writable:!1}),t}(f.FakeEventTarget);function li(e,t,r){return t=ci(t),function(e,t){if(t&&("object"===hi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ui()?Reflect.construct(t,r||[],ci(e).constructor):t.apply(e,r))}function ui(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ui=function(){return!!e})()}function ci(e){return ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ci(e)}function di(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pi(e,t)}function pi(e,t){return pi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pi(e,t)}function hi(e){return hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hi(e)}function fi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yi(n.key),n)}}function gi(e,t,r){return t&&mi(e.prototype,t),r&&mi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yi(e){var t=function(e,t){if("object"!=hi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=hi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==hi(t)?t:String(t)}ii(si,"defaultConfig",{}),ii(si,"Type","BaseRemotePlayer");var vi=function(){function e(t){fi(this,e),this._player=t}return gi(e,[{key:"player",get:function(){return this._player}}]),e}(),_i=function(e){function t(e,r,n){var a;return fi(this,t),(a=li(this,t,[e]))._session=r,n&&(a._ui=n),a}return di(t,e),gi(t,[{key:"ui",get:function(){return this._ui}},{key:"session",get:function(){return this._session}}]),t}(vi),ki=function(e){function t(e,r){var n;return fi(this,t),(n=li(this,t,[e]))._snapshot=r,n}return di(t,e),gi(t,[{key:"snapshot",get:function(){return this._snapshot}}]),t}(vi),Ei=function(e){function t(e,r){var n;return fi(this,t),(n=li(this,t,[e]))._available=r,n}return di(t,e),gi(t,[{key:"available",get:function(){return this._available}}]),t}(vi);function bi(e){return bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bi(e)}function Ti(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ai(n.key),n)}}function Ai(e){var t=function(e,t){if("object"!=bi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=bi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bi(t)?t:String(t)}var Si=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,r){(t=Ai(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"_uis",[{template:function(e){return t.idleUI(e)},condition:function(e){return e.engine.isIdle}},{template:function(e){return t.errorUI(e)},condition:function(e){return e.engine.hasError}},{template:function(e){return t.adsUI(e)},condition:function(e){return e.engine.adBreak}},{template:function(e){return t.liveUI(e)},condition:function(e){return e.engine.isLive}},{template:function(e){return t.playbackUI(e)}}])}var t,r,n;return t=e,(r=[{key:"playbackUI",value:function(e){return m.Presets.playbackUI(e)}},{key:"idleUI",value:function(e){return m.Presets.idleUI(e)}},{key:"adsUI",value:function(e){return m.Presets.adsUI(e)}},{key:"liveUI",value:function(e){return m.Presets.liveUI(e)}},{key:"errorUI",value:function(e){return m.Presets.errorUI(e)}},{key:"uis",get:function(){return this._uis}}])&&Ti(t.prototype,r),n&&Ti(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ci(e){return Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ci(e)}function Pi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xi(n.key),n)}}function xi(e){var t=function(e,t){if("object"!=Ci(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ci(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ci(t)?t:String(t)}var wi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"toCastTextStyle",value:function(t){if(window.chrome&&window.chrome.cast){var r=new window.chrome.cast.media.TextTrackStyle;return r.fontFamily=t.fontFamily,r.backgroundColor=e.rgbToHex(t.backgroundColor),r.foregroundColor=e.rgbToHex(t.fontColor),r.fontScale=Number.parseFloat(t.fontSize)/100,r}return{}}},{key:"toPlayerTextStyle",value:function(t){var r=new f.TextStyle;return r.fontFamily=t.fontFamily,r.fontSize=100*t.fontScale+"%",r.fontColor=e.hexToRGB(t.foregroundColor),r.backgroundColor=e.hexToRGB(t.backgroundColor),r}},{key:"rgbToHex",value:function(e){var t="#"+("0"+parseInt(e[0],10).toString(16)).slice(-2)+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2);if(e[3]){var r=e[3];r=Math.round(100*r)/100,t+=(Math.round(255*r)+65536).toString(16).substr(-2).toUpperCase()}else t+="FF";return t.toUpperCase()}},{key:"hexToRGB",value:function(e){for(var t=[],r=(e=e.slice(1)).match(/.{1,2}/g),n=0;n<3;n++){var a=r&&r[n];a&&t.push(parseInt(a,16))}return t}}],(r=null)&&Pi(t.prototype,r),n&&Pi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ii(e){return Ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ii(e)}function Mi(e,t,r){return t=Di(t),function(e,t){if(t&&("object"===Ii(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ri()?Reflect.construct(t,r||[],Di(e).constructor):t.apply(e,r))}function Ri(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ri=function(){return!!e})()}function Di(e){return Di=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Di(e)}function Oi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Li(e,t)}function Li(e,t){return Li=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Li(e,t)}function Ni(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ji(n.key),n)}}function Ui(e,t,r){return t&&Ni(e.prototype,t),r&&Ni(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ji(e){var t=function(e,t){if("object"!=Ii(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ii(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ii(t)?t:String(t)}function Bi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Fi={ACTION:"action",EVENT:"event"},Vi=Ui((function e(t){Bi(this,e),this.type=t})),Hi=function(e){function t(e,r){var n;return Bi(this,t),(n=Mi(this,t,[Fi.EVENT])).event=e,n.payload=r,n}return Oi(t,e),Ui(t)}(Vi),Gi=function(e){function t(e,r){var n;return Bi(this,t),(n=Mi(this,t,[Fi.ACTION])).action=e,n.args=r,n}return Oi(t,e),Ui(t)}(Vi),$i={registerRemotePlayer:$n.register,PlayerSnapshot:yn,RemoteControl:Cn,RemoteSession:Za,BaseRemotePlayer:si,RemoteConnectedPayload:_i,RemoteDisconnectedPayload:ki,RemoteAvailablePayload:Ei,RemotePlayerUI:Si,CastEventType:En,RemotePlayerType:{CHROMECAST:"chromecast"},TextStyleConverter:wi,CustomEventMessage:Hi,CustomActionMessage:Gi,CustomMessageType:Fi,CustomActionType:{SKIP_AD:"skipAd"},CustomMessage:Vi},Ki={PlaylistEventType:Xr};function Wi(e){return Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wi(e)}function zi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qi(n.key),n)}}function qi(e){var t=function(e,t){if("object"!=Wi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Wi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Wi(t)?t:String(t)}var Yi=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t,this._system=r.system,this._url=r.url,this._contentType=r.contentType,this._title=r.title,this._position=r.position,this._duration=r.duration,this._clickThroughUrl=r.clickThroughUrl,this._posterUrl=r.posterUrl,this._skipOffset=r.skipOffset,this._linear=r.linear,this._width=r.width||0,this._height=r.height||0,this._bitrate=r.bitrate||0,this._bumper=r.bumper,this._inStream=r.inStream||!1,this._vpaid=r.vpaid||!1,this._streamId=r.streamId||"",this._wrapperAdIds=r.wrapperAdIds,this._wrapperCreativeIds=r.wrapperCreativeIds,this._wrapperAdSystems=r.wrapperAdSystems}var t,r,n;return t=e,(r=[{key:"id",get:function(){return this._id}},{key:"system",get:function(){return this._system}},{key:"contentType",get:function(){return this._contentType}},{key:"url",get:function(){return this._url}},{key:"title",get:function(){return this._title}},{key:"position",get:function(){return this._position}},{key:"duration",get:function(){return this._duration}},{key:"clickThroughUrl",get:function(){return this._clickThroughUrl}},{key:"posterUrl",get:function(){return this._posterUrl}},{key:"skipOffset",get:function(){return this._skipOffset}},{key:"linear",get:function(){return this._linear}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"bitrate",get:function(){return this._bitrate}},{key:"bumper",get:function(){return this._bumper}},{key:"inStream",get:function(){return this._inStream}},{key:"skippable",get:function(){return!!(this.skipOffset&&this.skipOffset>0)}},{key:"vpaid",get:function(){return this._vpaid}},{key:"streamId",get:function(){return this._streamId}},{key:"wrapperAdIds",get:function(){return this._wrapperAdIds}},{key:"wrapperCreativeIds",get:function(){return this._wrapperCreativeIds}},{key:"wrapperAdSystems",get:function(){return this._wrapperAdSystems}},{key:"toJSON",value:function(){return{id:this.id,system:this.system,url:this.url,contentType:this.contentType,title:this.title,position:this.position,duration:this.duration,clickThroughUrl:this.clickThroughUrl,posterUrl:this.posterUrl,skipOffset:this.skipOffset,linear:this.linear,skippable:this.skippable,width:this.width,height:this.height,bitrate:this.bitrate,bumper:this.bumper,inStream:this.inStream,vpaid:this.vpaid}}}])&&zi(t.prototype,r),n&&zi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Xi(e){return Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xi(e)}function Zi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qi(n.key),n)}}function Qi(e){var t=function(e,t){if("object"!=Xi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Xi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Xi(t)?t:String(t)}var Ji=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._type=t.type,this._position=t.position,this._numAds=t.numAds}var t,r,n;return t=e,(r=[{key:"type",get:function(){return this._type}},{key:"position",get:function(){return this._position}},{key:"numAds",get:function(){return this._numAds}},{key:"toJSON",value:function(){return{type:this.type,position:this.position,numAds:this.numAds}}}])&&Zi(t.prototype,r),n&&Zi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();f.Ad=Yi,f.AdBreak=Ji,f.BasePlugin=ae,f.registerPlugin=de;var eo="@playkit-js/kaltura-player-js",to="ovp",ro="3.17.21"})(),__webpack_exports__})()));
//# sourceMappingURL=kaltura-ovp-player.js.map
